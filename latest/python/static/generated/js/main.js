(function(e){var t={};function r(n){if(t[n]){return t[n].exports}var a=t[n]={i:n,l:false,exports:{}};e[n].call(a.exports,a,a.exports,r);a.l=true;return a.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:n})}};r.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};r.t=function(e,t){if(t&1)e=r(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var n=Object.create(null);r.r(n);Object.defineProperty(n,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=1202)})({10:function(e,t){if(typeof Object.create==="function"){e.exports=function e(t,r){if(r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}}else{e.exports=function e(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype;t.prototype=new n;t.prototype.constructor=t}}}},106:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return showCellOutput});__webpack_require__.d(__webpack_exports__,"a",function(){return render});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(197);var react_dom__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);var _registry__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(51);var dangerously_set_inner_html_index__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(481);var _newLineProcessor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(198);var _newLineProcessor__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_newLineProcessor__WEBPACK_IMPORTED_MODULE_4__);var ansi_up_ansi_up__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(482);var ansi_up_ansi_up__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(ansi_up_ansi_up__WEBPACK_IMPORTED_MODULE_5__);var _cellsBounds_mjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(483);const CELL_TYPES=Object.freeze({CODE:"code",MARKDOWN:"markdown",RAW:"raw"});const EXECUTION_COUNT=Object.freeze({IN:"execution_in",OUT:"execution_out"});function initializeMathJax(){MathJax.Hub.Queue(["Typeset",MathJax.Hub])}function scrollToCell(e){if(e&&e.props&&e.myRef.current&&e.props.focused&&e.props.scrollParameters){const t=JSON.parse(e.props.scrollParameters);if(t.cellDistanceFromTheTop==null||isNaN(t.cellDistanceFromTheTop)){return}e.myRef.current.scrollIntoView();const r=e.myRef.current.getBoundingClientRect();const n=r.top>1?r.top:0;window.scrollBy(0,-1*(t.cellDistanceFromTheTop-n))}}function unifyCellData(e){return Array.isArray(e)?e.join(""):e}class ScrollParameters{constructor(e,t){this.cellIndex=e;this.cellDistanceFromTheTop=t}}class Notebook extends react__WEBPACK_IMPORTED_MODULE_0___default.a.Component{constructor(e){super(e);this.cellBounds=new _cellsBounds_mjs__WEBPACK_IMPORTED_MODULE_6__["a"](e.javaApi);this.cellBounds.start();this.stateToSettingsMap=Object.entries({showSource:"showSourcesInPreview",syncScrolling:"autoscrollFromSource"});const t={notebook:e.notebook,scrollParameters:new ScrollParameters};if(e.settings){for(const[r,n]of this.stateToSettingsMap){const a=e.settings[n];t[r]=a===undefined?true:a}}this.state=t;this.updateNotebookByEvent=this.updateNotebookByEvent.bind(this);e.jsApi.updateNotebookByEvent=this.updateNotebookByEvent;this.handleSettingsChangedEvent=this.handleSettingsChangedEvent.bind(this);e.jsApi.settingsChanged=this.handleSettingsChangedEvent;this.handleCellFocus=this.handleCellFocus.bind(this);this.scrollToCell=this.scrollToCell.bind(this);e.jsApi.scrollToCell=this.scrollToCell}updateNotebookByEvent(e){this.setState({notebook:typeof e==="string"?JSON.parse(e):e})}handleSettingsChangedEvent(e){for(const[t,r]of this.stateToSettingsMap){if(e.hasOwnProperty(r)){this.setState({[t]:e[r]})}}}handleCellFocus(e){if(this.props.offscreenMode){return}const t=this;const r=e;return function(){const r=e.props.index;const n=e.myRef.current.offsetTop-window.scrollY;window.onscroll=function(){if(document.hasFocus()){const e=document.activeElement.offsetTop-window.scrollY;frontendGateway.javaApi.focusChanged(r,e)}};t.scrollToCell(r,null);frontendGateway.javaApi.focusChanged(r,n)}}scrollToCell(e,t){if(isNaN(e)){return}this.setState({scrollParameters:new ScrollParameters(e,t)})}render(){try{initializeMathJax()}catch(e){}return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"notebook"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cells,{cells:this.state.notebook.cells,offscreenMode:this.props.offscreenMode,showSource:this.state.showSource,syncScrolling:this.state.syncScrolling,scrollParameters:this.state.scrollParameters,cellBounds:this.cellBounds,handleCellFocus:this.handleCellFocus}))}}class Cells extends react__WEBPACK_IMPORTED_MODULE_0___default.a.Component{render(){return this.props.cells.map((e,t)=>{const r=this.props.scrollParameters.cellIndex===t;const n=this.props.syncScrolling&&r?JSON.stringify(this.props.scrollParameters):null;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,{key:t,cellId:t,cell:e,cellType:e.cell_type,index:t,offscreenMode:this.props.offscreenMode,focused:r,cellBounds:this.props.cellBounds,scrollParameters:n,showSource:this.props.showSource,handleCellFocus:this.props.handleCellFocus})})}}const renderedByPyCharm=["image/svg+xml","image/jpeg","image/png","image/jpg","text/markdown"];class Cell extends react__WEBPACK_IMPORTED_MODULE_0___default.a.PureComponent{isPyCharmOutput(e){const t=e.data;if(t===undefined){return false}const r=Object.keys(t);if(r.length===0){return false}for(let e of r){if(renderedByPyCharm.indexOf(e)>-1){return true}}if(r.length===1&&r[0]==="text/plain"){return true}return false}constructor(e){super(e);this.myRef=react__WEBPACK_IMPORTED_MODULE_0___default.a.createRef();this.cellId=e.cellId}displayExecutionCount(e,t){let r=e!==null&&!isNaN(e)&&e>=0;return r||t}isExecuting(e){return e.metadata&&e.metadata.pycharm&&e.metadata.pycharm.is_executing||false}componentDidMount(){this.props.cellBounds.addCell(this.props.cellId,this.myRef.current)}componentWillUnmount(){this.props.cellBounds.removeCell(this.props.cellId,this.myRef.current)}render(){const e=this.props.cell;let t=e.outputs||[];if(this.props.offscreenMode){t=t.filter(e=>!this.isPyCharmOutput(e))}const r=this.props.cellType;const n=this.props.cellHeader;const a=this.props.showSource||r!==CELL_TYPES.CODE;const i=unifyCellData(e.source);const o=r===CELL_TYPES.CODE;const s=e.execution_count;const l=this.isExecuting(e);scrollToCell(this);const u=this.props.offscreenMode===true;const c=u?"":this.props.focused?"focused cell_container":"cell_container";return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{ref:this.myRef,tabIndex:"-1",className:c,onFocus:this.props.handleCellFocus.call(null,this)},!u&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellHeader,{cellHeader:n}),!u&&a&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_flex_container cell_source_wrapper"+(o?" cell_with_code_wrapper":"")},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_digits"},this.displayExecutionCount(s,l)&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellExecutionCount,{executionCount:s,executionCountType:EXECUTION_COUNT.IN,isExecuting:l})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_data"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"data_wrapper"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellSource,{cellSource:i,cellType:r})))),r===CELL_TYPES.CODE&&(t&&t.length>0?t.map((e,t)=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellOutput,{key:t,cellId:this.cellId,offscreenMode:u,outputJson:JSON.stringify(e)})):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellOutput,{offscreenMode:u})))}}class CellHeader extends react__WEBPACK_IMPORTED_MODULE_0___default.a.PureComponent{render(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"cell_header"},this.props.cellHeader)}}class CellExecutionCount extends react__WEBPACK_IMPORTED_MODULE_0___default.a.PureComponent{render(){const e=this.props.isExecuting;const t=this.props.executionCountType;const r=e?"*":this.props.executionCount||"";let n=r.toString().trim();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:["execution_count_box",t.valueOf()].join(" ")},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"execution_count"+(n.length>3?" many_digits":"")},n))}getExecutionCount(e,t){if(t){return"*"}return e}}class CellSource extends react__WEBPACK_IMPORTED_MODULE_0___default.a.PureComponent{createMarkdown(e){const t=/(?:\\begin([\s\S]*?)\\end(.*))|(?:\$(.*)\$)/g;const r=/[\\`*_{}\[\]()#+\-.!]/g;const n=e.replace(t,function(e,t,n,a){if(t){return"\\begin"+t.replace(r,e=>"\\"+e)+"\\end"+n}if(a){return"$"+a.replace(r,e=>"\\"+e)+"$"}});const a=marked(n);return{__html:a}}render(){const e=unifyCellData(this.props.cellSource);if(this.props.cellType===CELL_TYPES.MARKDOWN){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("article",{className:"cell cell_output markdown-body",dangerouslySetInnerHTML:this.createMarkdown(e)})}else{return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"cell cell_source cell_code"},e+"\n")}}}class CellOutput extends react__WEBPACK_IMPORTED_MODULE_0___default.a.PureComponent{constructor(e){super(e);this.jsQueue=[];this.cellId=e.cellId}createErrorElement(e){const t=new ansi_up_ansi_up__WEBPACK_IMPORTED_MODULE_5___default.a;t.use_classes=true;return e.map((e,r)=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",{key:r,dangerouslySetInnerHTML:{__html:t.ansi_to_html(e)}}))}componentDidMount(){this.processJsQueue()}componentDidUpdate(){this.processJsQueue()}componentWillUnmount(){this.jsQueue=[]}processJsQueue(){try{this.jsQueue.forEach(c=>typeof c==="string"?eval(c):c.call())}catch(e){console.error(e);console.error(this.jsQueue)}this.jsQueue=[]}valueWithEmptyIndex(e){if(this.props.offscreenMode===true){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"data_wrapper"},e)}return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_flex_container cell_result_wrapper"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_digits"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_data"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"data_wrapper"},e)))}createRichOutput(e){const t=e.data.hasOwnProperty("image/png")?"image/png":e.data.hasOwnProperty("image/jpeg")?"image/jpeg":null;if(t){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("img",{src:"data:"+t+";base64,"+unifyCellData(e.data[t])})}if(e.data.hasOwnProperty("image/svg+xml")){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{dangerouslySetInnerHTML:{__html:unifyCellData(e.data["image/svg+xml"])}})}const r=_registry__WEBPACK_IMPORTED_MODULE_2__["a"].getFunctionForOutput(e.data,this.cellId);if(r!==undefined){const e=[];const t=r.call();if("afterRenderUnsafe"in t){if(!frontendGateway.trusted){console.warn("Skipping JS");e.push(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("strong",{key:"errorMessage"},"Notebook is not trusted, JavaScript hasn't been executed"))}else{const e=t.afterRenderUnsafe;this.jsQueue.push(e)}}if(t.afterRenderSafe){this.jsQueue.push(t.afterRenderSafe)}e.push(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__["Fragment"],{key:"data"},t.result));return e}if(e.data.hasOwnProperty("application/json")){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,JSON.stringify(unifyCellData(e.data["application/json"]),null,"\n"))}if(e.data.hasOwnProperty("text/html")){const t=unifyCellData(e.data["text/html"]);if(t.indexOf("script")!==-1){if(frontendGateway.trusted){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(dangerously_set_inner_html_index__WEBPACK_IMPORTED_MODULE_3__["a"],{className:"markdown-body",html:t})}console.warn("Although HTML may contain scripts, it is launched in save mode because document not trusted")}return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:t}})}if(e.data.hasOwnProperty("text/latex")){this.jsQueue.push(initializeMathJax);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,unifyCellData(e.data["text/latex"]))}if(e.data.hasOwnProperty("text/markdown")){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:unifyCellData(e.data["text/markdown"])}})}if(e.data.hasOwnProperty("text/plain")){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"console_text"},unifyCellData(Object(_newLineProcessor__WEBPACK_IMPORTED_MODULE_4__["processNewLines"])(e.data["text/plain"])))}console.warn("Unknown type of "+Object.keys(e.data));return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"system"},"Output type is currently not supported")}render(){const e=this.props.outputJson;if(e===undefined){return this.valueWithEmptyIndex(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"cell"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"system"})))}const t=this.props.offscreenMode===true;if(t){if(e.indexOf("dtype:")!==-1||e.indexOf("dataframe")!==-1){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null)}}const r=JSON.parse(e);switch(r.output_type){case"stream":if(t)return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null);return this.valueWithEmptyIndex(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"cell cell_output console_text"},Object(_newLineProcessor__WEBPACK_IMPORTED_MODULE_4__["processNewLines"])(r.text)));case"display_data":return this.valueWithEmptyIndex(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("section",{className:"cell cell_output"},this.createRichOutput(r)));case"execute_result":return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_flex_container cell_result_wrapper"},!t&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_digits"},r.hasOwnProperty("execution_count")&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellExecutionCount,{executionCount:r.execution_count,executionCountType:EXECUTION_COUNT.OUT})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"cell_data"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"data_wrapper"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("section",{className:"cell cell_output "},this.createRichOutput(r)))));case"error":if(!t){const e=this.createErrorElement(r.traceback);return this.valueWithEmptyIndex(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("section",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"cell cell_output console_text"},e)))}else return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null);default:return this.valueWithEmptyIndex(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("pre",{className:"cell cell_output console_text"},"Unknown output type: "+r.output_type))}}}function showCellOutput(e,t,r){react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render(t.map((e,t)=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{key:t,className:"output_widget"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(CellOutput,{outputJson:JSON.stringify(e)}))),e,r)}function render(e,t,r){if(r.offscreenMode){const e=document.styleSheets;e[e.length-1].insertRule(".cell_output, .system, .execution_out .execution_count, #notebook { padding:0px!important;}")}return react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Notebook,{notebook:e,offscreenMode:r.offscreenMode,settings:r.jsApi.initialSettings,jsApi:r.jsApi,javaApi:r.javaApi}),t)}},12:function(e,t,r){var n=r(19);var a=n.Buffer;function i(e,t){for(var r in e){t[r]=e[r]}}if(a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow){e.exports=n}else{i(n,t);t.Buffer=o}function o(e,t,r){return a(e,t,r)}i(a,o);o.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return a(e,t,r)};o.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var n=a(e);if(t!==undefined){if(typeof r==="string"){n.fill(t,r)}else{n.fill(t)}}else{n.fill(0)}return n};o.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return a(e)};o.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n.SlowBuffer(e)}},1202:function(e,t,r){"use strict";r.r(t);var n=r(56);var a=r(106);var i=r(51);i["a"].registerType("application/vnd.bokehjs_load.v0+json",e=>({afterRenderUnsafe:e}));var o=r(8);var s=r.n(o);var l=r(484);var u=r.n(l);i["a"].registerType("application/vnd.plotly.v1+json",e=>({result:s.a.createElement(u.a,{data:e.data,layout:e.layout})}));var c=r(129);var f=r(80);Object.assign(window,{frontendGateway:n["a"]});window.registry=i["a"];window.addEventListener("load",()=>{v.windowLoaded=true;if(v.mainCalled){g(v.testData)}},false);window.addEventListener("DOMContentLoaded",()=>{window.document.body.addEventListener("click",h)});window.main=(e=>{v.testData=e;v.mainCalled=true;if(v.windowLoaded){g(e)}});window.jcefMain=((e,t,r,n)=>{d(t);const a=window.frontendGateway;a.trusted=r==="true";a.offscreenMode=n==="true";function i(){document.getElementById("jb-notebook-virtual-space").style.display="none"}const o=(e,t)=>{switch(e){case"setOneCell":{i();const e=()=>{Object(f["a"])(e=>{a.javaApi.reportSize(e)})};_(t,e);break}case"init":{if(a.offscreenMode){i()}a.notebook=t;main();break}case"isNotebookTrusted":{a.trusted=t;break}case"notebookChanged":{a.jsApi.updateNotebookByEvent(t);break}case"settingsChanged":{a.jsApi.settingsChanged(t);break}case"scrollPreview":{a.jsApi.scrollToCell(t.cellIndex,t.cellDistanceFromTheTop);break}case y:{a.jsApi.onMessageFromKernel(t);break}default:{console.log("UNKNOWN MESSAGE")}}};new x(a,e,o)});function h(e){let t=e.target;while(t){if(t.href){const r=new URL(t.href);p(r);e.stopPropagation();e.preventDefault();break}else{t=t.parentNode}}}function p(e){if(e.href.includes(window.location.href,0)){const t=e.hash;console.warn("Internal references are not yes supported: "+t);return}if(e.protocol==="http:"||e.protocol==="https:"){n["a"].javaApi.openUrl(e.href);return}console.warn("URLs of this type are currently unsupported: "+e.href)}function d(e){const t=document.getElementsByTagName("head")[0];const r=e.endsWith(".css");if(!r&&!e.endsWith(".js")){throw new Error(`Can't include ${e}`)}const n=document.createElement(r?"link":"script");if(r){n.href=e;n.type="text/css";n.rel="stylesheet"}else{n.src=e;n.type="text/javascript";n.language="javascript"}t.append(n)}const v={testData:undefined,windowLoaded:false,mainCalled:false,applicationStarted:false};function m(){const e=document.getElementById("root");if(!e){throw new Error("No root element")}return e}function g(e){if(v.applicationStarted){return}v.applicationStarted=true;const t=document.getElementById("wait");if(t){t.remove()}const r=n["a"].notebook;let o=r!==undefined?typeof r==="string"?JSON.parse(r):r:null;if(e!==undefined){console.log("Using test data");o=e}try{const e=Promise.all(i["a"].initListeners.map(e=>e(o)));e.then(()=>{if(o!==null){const e=m();Object(a["a"])(o,e,n["a"])}}).catch(e=>console.error(e))}catch(e){console.warn("Failed to load because of exception");console.error(e)}}const y="messageToJupyter";class x{constructor(e,t,r){this.messagesBeforeSocket=[];let n=0;this.frontendGateway=e;e.javaApi.log=this._onLogBeforeConnection;e.javaApi.reportSize=(e=>{this.send("reportSize",{size:e})});e.javaApi.reportCellTopHeight=(e=>{this.send("reportCellTopHeight",{data:e})});e.javaApi.sendCommMessageToKernel=((e,t,r,a)=>{const i=String(n++);this.send(y,{commId:e,messageType:t,data:JSON.parse(r),cellId:a,fakeMessageId:i});return String(i)});e.javaApi.focusChanged=((e,t)=>{this.send("focusChanged",{cellIndex:e,cellDistanceFromTheTop:t})});this.socket=new WebSocket(t);this.socket.addEventListener("open",e=>{this._patchLogging()});this.socket.addEventListener("message",e=>{const t=JSON.parse(e.data);r(t.type,t.data)})}send(e,t){this.socket.send(JSON.stringify({type:e,data:t}))}_sendLog(e,t){this.send("log",{highSeverity:e,message:t})}_onLogBeforeConnection(e,t){this.messagesBeforeSocket.push({highSeverity:e,message:t})}_patchLogging(){this.frontendGateway.javaApi.log=((e,t)=>{this._sendLog(e,t)});this.messagesBeforeSocket.forEach(e=>this._sendLog(e.highSeverity,e.message));this.messagesBeforeSocket=undefined;const e=(e,t,r)=>{const n=console[e];console[e]=function(...e){if(e.length===0){return}const a=e[0];if(a instanceof ReferenceError||a instanceof TypeError){r._sendLog(t,`${a}: ${a.stack}`)}for(const n of e){r._sendLog(t,String(n))}n(a)}};const t={log:false,debug:false,info:false,warn:false,error:true,exception:true};Object.entries(t).forEach(([t,r])=>e(t,r,this))}}function _(e,t){Object(a["b"])(m(),e,t)}},129:function(e,t,r){"use strict";r.d(t,"b",function(){return u});r.d(t,"a",function(){return c});var n=r(56);var a=r(66);var i=r.n(a);const o={};const s={};a["instance"].addGlobalListener(e=>{switch(e.header.msg_type){case"comm_open":l(e);break;case"comm_msg":o[e.content.comm_id]._message_from_kernel_arrived(e);break;case"comm_close":o[e.content.comm_id]._close_com(e);break}});function l(e){const t=e.content.target_name;const r=new c(t,e.content.comm_id,true);const n=s[t];if(n===undefined){console.error(`Unknown target ${t}`);r.close();return}n(r,e)}const u=(e,t)=>{s[e]=t};class c{constructor(e,t,r){this.comm_id=t;this.target_name=e;this.msg_listener=null;this.close_listener=null;this.msg_queue=[];this.openedInKernel=r||false;this.openedInFrontEnd=true;o[t]=this}_message_from_kernel_arrived(e){if(this.msg_listener!==null){this.msg_listener(e).catch(console.error)}else{this.msg_queue.push(e)}}_close_com(e){if(this.close_listener){this.close_listener(e)}this.close_listener=null;this.msg_listener=null;this.msg_queue=null;this.openedInKernel=false;this.openedInFrontEnd=false;delete o[this.comm_id]}open(e,t,r,n){if(this.openedInKernel){throw new Error("Already opened")}this._send_to_kernel("comm_open",e,t);this.openedInKernel=true}send(e,t,r,n){if(!this.openedInKernel){throw new Error("Open kernel part first")}if(!this.openedInFrontEnd){return}this._send_to_kernel("comm_msg",e,t,t.pycharmCellId)}close(e,t,r,n){this._send_to_kernel("comm_close",e,t);this._close_com()}_send_to_kernel(e,t,r,i){const o=JSON.stringify(t||{});let s=n["a"].javaApi.sendCommMessageToKernel(this.comm_id,e,o,i);if(s!==undefined){if(r){a["instance"].subscribe(s,r,true)}}}on_msg(e){if(!this.openedInFrontEnd){return}this.msg_listener=e;this.msg_queue.forEach(e=>this._message_from_kernel_arrived(e));this.msg_queue=[]}on_close(e){this.close_listener=e}}},132:function(e,t,r){"use strict";
/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(42),a="function"===typeof Symbol&&Symbol.for,i=a?Symbol.for("react.element"):60103,o=a?Symbol.for("react.portal"):60106,s=a?Symbol.for("react.fragment"):60107,l=a?Symbol.for("react.strict_mode"):60108,u=a?Symbol.for("react.profiler"):60114,c=a?Symbol.for("react.provider"):60109,f=a?Symbol.for("react.context"):60110,h=a?Symbol.for("react.forward_ref"):60112,p=a?Symbol.for("react.suspense"):60113,d=a?Symbol.for("react.memo"):60115,v=a?Symbol.for("react.lazy"):60116,m="function"===typeof Symbol&&Symbol.iterator;function g(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x={};function _(e,t,r){this.props=e;this.context=t;this.refs=x;this.updater=r||y}_.prototype.isReactComponent={};_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(g(85));this.updater.enqueueSetState(this,e,t,"setState")};_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b(){}b.prototype=_.prototype;function w(e,t,r){this.props=e;this.context=t;this.refs=x;this.updater=r||y}var T=w.prototype=new b;T.constructor=w;n(T,_.prototype);T.isPureReactComponent=!0;var k={current:null},A=Object.prototype.hasOwnProperty,M={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var n,a={},o=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)A.call(t,n)&&!M.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)void 0===a[n]&&(a[n]=l[n]);return{$$typeof:i,type:e,key:o,ref:s,props:a,_owner:k.current}}function S(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}function L(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}var I=/\/+/g,O=[];function P(e,t,r,n){if(O.length){var a=O.pop();a.result=e;a.keyPrefix=t;a.func=r;a.context=n;a.count=0;return a}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function D(e){e.result=null;e.keyPrefix=null;e.func=null;e.context=null;e.count=0;10>O.length&&O.push(e)}function R(e,t,r,n){var a=typeof e;if("undefined"===a||"boolean"===a)e=null;var s=!1;if(null===e)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case i:case o:s=!0}}if(s)return r(n,e,""===t?"."+N(e,0):t),1;s=0;t=""===t?".":t+":";if(Array.isArray(e))for(var l=0;l<e.length;l++){a=e[l];var u=t+N(a,l);s+=R(a,u,r,n)}else if(null===e||"object"!==typeof e?u=null:(u=m&&e[m]||e["@@iterator"],u="function"===typeof u?u:null),"function"===typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)a=a.value,u=t+N(a,l++),s+=R(a,u,r,n);else if("object"===a)throw r=""+e,Error(g(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return s}function z(e,t,r){return null==e?0:R(e,"",t,r)}function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?L(e.key):t.toString(36)}function F(e,t){e.func.call(e.context,t,e.count++)}function B(e,t,r){var n=e.result,a=e.keyPrefix;e=e.func.call(e.context,t,e.count++);Array.isArray(e)?j(e,n,r,function(e){return e}):null!=e&&(C(e)&&(e=S(e,a+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(I,"$&/")+"/")+r)),n.push(e))}function j(e,t,r,n,a){var i="";null!=r&&(i=(""+r).replace(I,"$&/")+"/");t=P(t,i,n,a);z(e,B,t);D(t)}var U={current:null};function H(){var e=U.current;if(null===e)throw Error(g(321));return e}var V={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:k,IsSomeRendererActing:{current:!1},assign:n};t.Children={map:function(e,t,r){if(null==e)return e;var n=[];j(e,n,null,t,r);return n},forEach:function(e,t,r){if(null==e)return e;t=P(null,null,t,r);z(e,F,t);D(t)},count:function(e){return z(e,function(){return null},null)},toArray:function(e){var t=[];j(e,t,null,function(e){return e});return t},only:function(e){if(!C(e))throw Error(g(143));return e}};t.Component=_;t.Fragment=s;t.Profiler=u;t.PureComponent=w;t.StrictMode=l;t.Suspense=p;t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V;t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error(g(267,e));var a=n({},e.props),o=e.key,s=e.ref,l=e._owner;if(null!=t){void 0!==t.ref&&(s=t.ref,l=k.current);void 0!==t.key&&(o=""+t.key);if(e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)A.call(t,c)&&!M.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var f=0;f<c;f++)u[f]=arguments[f+2];a.children=u}return{$$typeof:i,type:e.type,key:o,ref:s,props:a,_owner:l}};t.createContext=function(e,t){void 0===t&&(t=null);e={$$typeof:f,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null};e.Provider={$$typeof:c,_context:e};return e.Consumer=e};t.createElement=E;t.createFactory=function(e){var t=E.bind(null,e);t.type=e;return t};t.createRef=function(){return{current:null}};t.forwardRef=function(e){return{$$typeof:h,render:e}};t.isValidElement=C;t.lazy=function(e){return{$$typeof:v,_ctor:e,_status:-1,_result:null}};t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}};t.useCallback=function(e,t){return H().useCallback(e,t)};t.useContext=function(e,t){return H().useContext(e,t)};t.useDebugValue=function(){};t.useEffect=function(e,t){return H().useEffect(e,t)};t.useImperativeHandle=function(e,t,r){return H().useImperativeHandle(e,t,r)};t.useLayoutEffect=function(e,t){return H().useLayoutEffect(e,t)};t.useMemo=function(e,t){return H().useMemo(e,t)};t.useReducer=function(e,t,r){return H().useReducer(e,t,r)};t.useRef=function(e){return H().useRef(e)};t.useState=function(e){return H().useState(e)};t.version="16.13.1"},133:function(e,t,r){"use strict";t.createDocument=function(){return{nodeName:"#document",quirksMode:false,childNodes:[]}};t.createDocumentFragment=function(){return{nodeName:"#document-fragment",quirksMode:false,childNodes:[]}};t.createElement=function(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}};t.createCommentNode=function(e){return{nodeName:"#comment",data:e,parentNode:null}};var n=function(e){return{nodeName:"#text",value:e,parentNode:null}};var a=t.appendChild=function(e,t){e.childNodes.push(t);t.parentNode=e};var i=t.insertBefore=function(e,t,r){var n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t);t.parentNode=e};t.setTemplateContent=function(e,t){e.content=t};t.getTemplateContent=function(e){return e.content};t.setDocumentType=function(e,t,r,n){var i=null;for(var o=0;o<e.childNodes.length;o++){if(e.childNodes[o].nodeName==="#documentType"){i=e.childNodes[o];break}}if(i){i.name=t;i.publicId=r;i.systemId=n}else{a(e,{nodeName:"#documentType",name:t,publicId:r,systemId:n})}};t.setQuirksMode=function(e){e.quirksMode=true};t.isQuirksMode=function(e){return e.quirksMode};t.detachNode=function(e){if(e.parentNode){var t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1);e.parentNode=null}};t.insertText=function(e,t){if(e.childNodes.length){var r=e.childNodes[e.childNodes.length-1];if(r.nodeName==="#text"){r.value+=t;return}}a(e,n(t))};t.insertTextBefore=function(e,t,r){var a=e.childNodes[e.childNodes.indexOf(r)-1];if(a&&a.nodeName==="#text")a.value+=t;else i(e,n(t),r)};t.adoptAttributes=function(e,t){var r=[];for(var n=0;n<e.attrs.length;n++)r.push(e.attrs[n].name);for(var a=0;a<t.length;a++){if(r.indexOf(t[a].name)===-1)e.attrs.push(t[a])}};t.getFirstChild=function(e){return e.childNodes[0]};t.getChildNodes=function(e){return e.childNodes};t.getParentNode=function(e){return e.parentNode};t.getAttrList=function(e){return e.attrs};t.getTagName=function(e){return e.tagName};t.getNamespaceURI=function(e){return e.namespaceURI};t.getTextNodeContent=function(e){return e.value};t.getCommentNodeContent=function(e){return e.data};t.getDocumentTypeNodeName=function(e){return e.name};t.getDocumentTypeNodePublicId=function(e){return e.publicId};t.getDocumentTypeNodeSystemId=function(e){return e.systemId};t.isTextNode=function(e){return e.nodeName==="#text"};t.isCommentNode=function(e){return e.nodeName==="#comment"};t.isDocumentTypeNode=function(e){return e.nodeName==="#documentType"};t.isElementNode=function(e){return!!e.tagName}},134:function(e,t,r){"use strict";var n="html",a="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",i=["+//silmaril//dtd html pro v0r11 19970101//en","-//advasoft ltd//dtd html 3.0 aswedit + extensions//en","-//as//dtd html 3.0 aswedit + extensions//en","-//ietf//dtd html 2.0 level 1//en","-//ietf//dtd html 2.0 level 2//en","-//ietf//dtd html 2.0 strict level 1//en","-//ietf//dtd html 2.0 strict level 2//en","-//ietf//dtd html 2.0 strict//en","-//ietf//dtd html 2.0//en","-//ietf//dtd html 2.1e//en","-//ietf//dtd html 3.0//en","-//ietf//dtd html 3.0//en//","-//ietf//dtd html 3.2 final//en","-//ietf//dtd html 3.2//en","-//ietf//dtd html 3//en","-//ietf//dtd html level 0//en","-//ietf//dtd html level 0//en//2.0","-//ietf//dtd html level 1//en","-//ietf//dtd html level 1//en//2.0","-//ietf//dtd html level 2//en","-//ietf//dtd html level 2//en//2.0","-//ietf//dtd html level 3//en","-//ietf//dtd html level 3//en//3.0","-//ietf//dtd html strict level 0//en","-//ietf//dtd html strict level 0//en//2.0","-//ietf//dtd html strict level 1//en","-//ietf//dtd html strict level 1//en//2.0","-//ietf//dtd html strict level 2//en","-//ietf//dtd html strict level 2//en//2.0","-//ietf//dtd html strict level 3//en","-//ietf//dtd html strict level 3//en//3.0","-//ietf//dtd html strict//en","-//ietf//dtd html strict//en//2.0","-//ietf//dtd html strict//en//3.0","-//ietf//dtd html//en","-//ietf//dtd html//en//2.0","-//ietf//dtd html//en//3.0","-//metrius//dtd metrius presentational//en","-//microsoft//dtd internet explorer 2.0 html strict//en","-//microsoft//dtd internet explorer 2.0 html//en","-//microsoft//dtd internet explorer 2.0 tables//en","-//microsoft//dtd internet explorer 3.0 html strict//en","-//microsoft//dtd internet explorer 3.0 html//en","-//microsoft//dtd internet explorer 3.0 tables//en","-//netscape comm. corp.//dtd html//en","-//netscape comm. corp.//dtd strict html//en","-//o'reilly and associates//dtd html 2.0//en","-//o'reilly and associates//dtd html extended 1.0//en","-//spyglass//dtd html 2.0 extended//en","-//sq//dtd html 2.0 hotmetal + extensions//en","-//sun microsystems corp.//dtd hotjava html//en","-//sun microsystems corp.//dtd hotjava strict html//en","-//w3c//dtd html 3 1995-03-24//en","-//w3c//dtd html 3.2 draft//en","-//w3c//dtd html 3.2 final//en","-//w3c//dtd html 3.2//en","-//w3c//dtd html 3.2s draft//en","-//w3c//dtd html 4.0 frameset//en","-//w3c//dtd html 4.0 transitional//en","-//w3c//dtd html experimental 19960712//en","-//w3c//dtd html experimental 970421//en","-//w3c//dtd w3 html//en","-//w3o//dtd w3 html 3.0//en","-//w3o//dtd w3 html 3.0//en//","-//webtechs//dtd mozilla html 2.0//en","-//webtechs//dtd mozilla html//en"],o=["-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],s=["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"];function l(e){var t=e.indexOf('"')!==-1?"'":'"';return t+e+t}t.isQuirks=function(e,t,r){if(e!==n)return true;if(r&&r.toLowerCase()===a)return true;if(t!==null){t=t.toLowerCase();if(s.indexOf(t)>-1)return true;var l=i;if(r===null)l=l.concat(o);for(var u=0;u<l.length;u++){if(t.indexOf(l[u])===0)return true}}return false};t.serializeContent=function(e,t,r){var n="!DOCTYPE ";if(e)n+=e;if(t!==null)n+=" PUBLIC "+l(t);else if(r!==null)n+=" SYSTEM";if(r!==null)n+=" "+l(r);return n}},135:function(e,t,r){"use strict";e.exports=function e(t,r){r=r||{};return[t,r].reduce(function(e,t){Object.keys(t).forEach(function(r){e[r]=t[r]});return e},{})}},136:function(e,t){t.read=function(e,t,r,n,a){var i,o;var s=a*8-n-1;var l=(1<<s)-1;var u=l>>1;var c=-7;var f=r?a-1:0;var h=r?-1:1;var p=e[t+f];f+=h;i=p&(1<<-c)-1;p>>=-c;c+=s;for(;c>0;i=i*256+e[t+f],f+=h,c-=8){}o=i&(1<<-c)-1;i>>=-c;c+=n;for(;c>0;o=o*256+e[t+f],f+=h,c-=8){}if(i===0){i=1-u}else if(i===l){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,n);i=i-u}return(p?-1:1)*o*Math.pow(2,i-n)};t.write=function(e,t,r,n,a,i){var o,s,l;var u=i*8-a-1;var c=(1<<u)-1;var f=c>>1;var h=a===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=n?0:i-1;var d=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;o=c}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+f>=1){t+=h/l}else{t+=h*Math.pow(2,1-f)}if(t*l>=2){o++;l/=2}if(o+f>=c){s=0;o=c}else if(o+f>=1){s=(t*l-1)*Math.pow(2,a);o=o+f}else{s=t*Math.pow(2,f-1)*Math.pow(2,a);o=0}}for(;a>=8;e[r+p]=s&255,p+=d,s/=256,a-=8){}o=o<<a|s;u+=a;for(;u>0;e[r+p]=o&255,p+=d,o/=256,u-=8){}e[r+p-d]|=v*128}},137:function(e,t){},138:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=r(12).Buffer;var i=r(139);function o(e,t,r){e.copy(t,r)}e.exports=function(){function e(){n(this,e);this.head=null;this.tail=null;this.length=0}e.prototype.push=function e(t){var r={data:t,next:null};if(this.length>0)this.tail.next=r;else this.head=r;this.tail=r;++this.length};e.prototype.unshift=function e(t){var r={data:t,next:this.head};if(this.length===0)this.tail=r;this.head=r;++this.length};e.prototype.shift=function e(){if(this.length===0)return;var t=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return t};e.prototype.clear=function e(){this.head=this.tail=null;this.length=0};e.prototype.join=function e(t){if(this.length===0)return"";var r=this.head;var n=""+r.data;while(r=r.next){n+=t+r.data}return n};e.prototype.concat=function e(t){if(this.length===0)return a.alloc(0);if(this.length===1)return this.head.data;var r=a.allocUnsafe(t>>>0);var n=this.head;var i=0;while(n){o(n.data,r,i);i+=n.data.length;n=n.next}return r};return e}();if(i&&i.inspect&&i.inspect.custom){e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e}}},139:function(e,t){},14:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){if(typeof window==="object")r=window}e.exports=r},140:function(e,t,r){(function(e,t){(function(e,r){"use strict";if(e.setImmediate){return}var n=1;var a={};var i=false;var o=e.document;var s;function l(e){if(typeof e!=="function"){e=new Function(""+e)}var t=new Array(arguments.length-1);for(var r=0;r<t.length;r++){t[r]=arguments[r+1]}var i={callback:e,args:t};a[n]=i;s(n);return n++}function u(e){delete a[e]}function c(e){var t=e.callback;var n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n);break}}function f(e){if(i){setTimeout(f,0,e)}else{var t=a[e];if(t){i=true;try{c(t)}finally{u(e);i=false}}}}function h(){s=function(e){t.nextTick(function(){f(e)})}}function p(){if(e.postMessage&&!e.importScripts){var t=true;var r=e.onmessage;e.onmessage=function(){t=false};e.postMessage("","*");e.onmessage=r;return t}}function d(){var t="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===e&&typeof r.data==="string"&&r.data.indexOf(t)===0){f(+r.data.slice(t.length))}};if(e.addEventListener){e.addEventListener("message",r,false)}else{e.attachEvent("onmessage",r)}s=function(r){e.postMessage(t+r,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;f(t)};s=function(t){e.port2.postMessage(t)}}function m(){var e=o.documentElement;s=function(t){var r=o.createElement("script");r.onreadystatechange=function(){f(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r)}}function g(){s=function(e){setTimeout(f,0,e)}}var y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e;if({}.toString.call(e.process)==="[object process]"){h()}else if(p()){d()}else if(e.MessageChannel){v()}else if(o&&"onreadystatechange"in o.createElement("script")){m()}else{g()}y.setImmediate=l;y.clearImmediate=u})(typeof self==="undefined"?typeof e==="undefined"?this:e:self)}).call(this,r(14),r(17))},141:function(e,t,r){(function(t){e.exports=r;function r(e,t){if(n("noDeprecation")){return e}var r=false;function a(){if(!r){if(n("throwDeprecation")){throw new Error(t)}else if(n("traceDeprecation")){console.trace(t)}else{console.warn(t)}r=true}return e.apply(this,arguments)}return a}function n(e){try{if(!t.localStorage)return false}catch(e){return false}var r=t.localStorage[e];if(null==r)return false;return String(r).toLowerCase()==="true"}}).call(this,r(14))},142:function(e,t,r){"use strict";e.exports=i;var n=r(88);var a=Object.create(r(35));a.inherits=r(10);a.inherits(i,n);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}i.prototype._transform=function(e,t,r){r(null,e)}},143:function(e,t,r){e.exports=r(59)},144:function(e,t,r){e.exports=r(28)},145:function(e,t,r){e.exports=r(58).Transform},146:function(e,t,r){e.exports=r(58).PassThrough},147:function(e,t){e.exports=function e(t){return t&&typeof t==="object"&&typeof t.copy==="function"&&typeof t.fill==="function"&&typeof t.readUInt8==="function"}},148:function(e,t){if(typeof Object.create==="function"){e.exports=function e(t,r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}else{e.exports=function e(t,r){t.super_=r;var n=function(){};n.prototype=r.prototype;t.prototype=new n;t.prototype.constructor=t}}},17:function(e,t){var r=e.exports={};var n;var a;function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=i}}catch(e){n=i}try{if(typeof clearTimeout==="function"){a=clearTimeout}else{a=o}}catch(e){a=o}})();function s(e){if(n===setTimeout){return setTimeout(e,0)}if((n===i||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function l(e){if(a===clearTimeout){return clearTimeout(e)}if((a===o||!a)&&clearTimeout){a=clearTimeout;return clearTimeout(e)}try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}var u=[];var c=false;var f;var h=-1;function p(){if(!c||!f){return}c=false;if(f.length){u=f.concat(u)}else{h=-1}if(u.length){d()}}function d(){if(c){return}var e=s(p);c=true;var t=u.length;while(t){f=u;u=[];while(++h<t){if(f){f[h].run()}}h=-1;t=u.length}f=null;c=false;l(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}u.push(new v(e,t));if(u.length===1&&!c){s(d)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function m(){}r.on=m;r.addListener=m;r.once=m;r.off=m;r.removeListener=m;r.removeAllListeners=m;r.emit=m;r.prependListener=m;r.prependOnceListener=m;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},19:function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=r(79);var a=r(136);var i=r(85);t.Buffer=u;t.SlowBuffer=x;t.INSPECT_MAX_BYTES=50;u.TYPED_ARRAY_SUPPORT=e.TYPED_ARRAY_SUPPORT!==undefined?e.TYPED_ARRAY_SUPPORT:o();t.kMaxLength=s();function o(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42&&typeof e.subarray==="function"&&e.subarray(1,1).byteLength===0}catch(e){return false}}function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function l(e,t){if(s()<t){throw new RangeError("Invalid typed array length")}if(u.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=u.prototype}else{if(e===null){e=new u(t)}e.length=t}return e}function u(e,t,r){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u)){return new u(e,t,r)}if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return p(this,e)}return c(this,e,t,r)}u.poolSize=8192;u._augment=function(e){e.__proto__=u.prototype;return e};function c(e,t,r,n){if(typeof t==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&t instanceof ArrayBuffer){return m(e,t,r,n)}if(typeof t==="string"){return d(e,t,r)}return g(e,t)}u.from=function(e,t,r){return c(null,e,t,r)};if(u.TYPED_ARRAY_SUPPORT){u.prototype.__proto__=Uint8Array.prototype;u.__proto__=Uint8Array;if(typeof Symbol!=="undefined"&&Symbol.species&&u[Symbol.species]===u){Object.defineProperty(u,Symbol.species,{value:null,configurable:true})}}function f(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be a number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function h(e,t,r,n){f(t);if(t<=0){return l(e,t)}if(r!==undefined){return typeof n==="string"?l(e,t).fill(r,n):l(e,t).fill(r)}return l(e,t)}u.alloc=function(e,t,r){return h(null,e,t,r)};function p(e,t){f(t);e=l(e,t<0?0:y(t)|0);if(!u.TYPED_ARRAY_SUPPORT){for(var r=0;r<t;++r){e[r]=0}}return e}u.allocUnsafe=function(e){return p(null,e)};u.allocUnsafeSlow=function(e){return p(null,e)};function d(e,t,r){if(typeof r!=="string"||r===""){r="utf8"}if(!u.isEncoding(r)){throw new TypeError('"encoding" must be a valid string encoding')}var n=_(t,r)|0;e=l(e,n);var a=e.write(t,r);if(a!==n){e=e.slice(0,a)}return e}function v(e,t){var r=t.length<0?0:y(t.length)|0;e=l(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function m(e,t,r,n){t.byteLength;if(r<0||t.byteLength<r){throw new RangeError("'offset' is out of bounds")}if(t.byteLength<r+(n||0)){throw new RangeError("'length' is out of bounds")}if(r===undefined&&n===undefined){t=new Uint8Array(t)}else if(n===undefined){t=new Uint8Array(t,r)}else{t=new Uint8Array(t,r,n)}if(u.TYPED_ARRAY_SUPPORT){e=t;e.__proto__=u.prototype}else{e=v(e,t)}return e}function g(e,t){if(u.isBuffer(t)){var r=y(t.length)|0;e=l(e,r);if(e.length===0){return e}t.copy(e,0,0,r);return e}if(t){if(typeof ArrayBuffer!=="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t){if(typeof t.length!=="number"||te(t.length)){return l(e,0)}return v(e,t)}if(t.type==="Buffer"&&i(t.data)){return v(e,t.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(e){if(e>=s()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+s().toString(16)+" bytes")}return e|0}function x(e){if(+e!=e){e=0}return u.alloc(+e)}u.isBuffer=function e(t){return!!(t!=null&&t._isBuffer)};u.compare=function e(t,r){if(!u.isBuffer(t)||!u.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var a=r.length;for(var i=0,o=Math.min(n,a);i<o;++i){if(t[i]!==r[i]){n=t[i];a=r[i];break}}if(n<a)return-1;if(a<n)return 1;return 0};u.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};u.concat=function e(t,r){if(!i(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return u.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var a=u.allocUnsafe(r);var o=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s)){throw new TypeError('"list" argument must be an Array of Buffers')}s.copy(a,o);o+=s.length}return a};function _(e,t){if(u.isBuffer(e)){return e.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return $(e).length;default:if(n)return K(e).length;t=(""+t).toLowerCase();n=true}}}u.byteLength=_;function b(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return N(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return z(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}u.prototype._isBuffer=true;function w(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}u.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){w(this,r,r+1)}return this};u.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){w(this,r,r+3);w(this,r+1,r+2)}return this};u.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){w(this,r,r+7);w(this,r+1,r+6);w(this,r+2,r+5);w(this,r+3,r+4)}return this};u.prototype.toString=function e(){var t=this.length|0;if(t===0)return"";if(arguments.length===0)return O(this,0,t);return b.apply(this,arguments)};u.prototype.equals=function e(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return u.compare(this,t)===0};u.prototype.inspect=function e(){var r="";var n=t.INSPECT_MAX_BYTES;if(this.length>0){r=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)r+=" ... "}return"<Buffer "+r+">"};u.prototype.compare=function e(t,r,n,a,i){if(!u.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(a===undefined){a=0}if(i===undefined){i=this.length}if(r<0||n>t.length||a<0||i>this.length){throw new RangeError("out of range index")}if(a>=i&&r>=n){return 0}if(a>=i){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;a>>>=0;i>>>=0;if(this===t)return 0;var o=i-a;var s=n-r;var l=Math.min(o,s);var c=this.slice(a,i);var f=t.slice(r,n);for(var h=0;h<l;++h){if(c[h]!==f[h]){o=c[h];s=f[h];break}}if(o<s)return-1;if(s<o)return 1;return 0};function T(e,t,r,n,a){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(isNaN(r)){r=a?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(a)return-1;else r=e.length-1}else if(r<0){if(a)r=0;else return-1}if(typeof t==="string"){t=u.from(t,n)}if(u.isBuffer(t)){if(t.length===0){return-1}return k(e,t,r,n,a)}else if(typeof t==="number"){t=t&255;if(u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(a){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return k(e,[t],r,n,a)}throw new TypeError("val must be string, number or Buffer")}function k(e,t,r,n,a){var i=1;var o=e.length;var s=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}i=2;o/=2;s/=2;r/=2}}function l(e,t){if(i===1){return e[t]}else{return e.readUInt16BE(t*i)}}var u;if(a){var c=-1;for(u=r;u<o;u++){if(l(e,u)===l(t,c===-1?0:u-c)){if(c===-1)c=u;if(u-c+1===s)return c*i}else{if(c!==-1)u-=u-c;c=-1}}}else{if(r+s>o)r=o-s;for(u=r;u>=0;u--){var f=true;for(var h=0;h<s;h++){if(l(e,u+h)!==l(t,h)){f=false;break}}if(f)return u}}return-1}u.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};u.prototype.indexOf=function e(t,r,n){return T(this,t,r,n,true)};u.prototype.lastIndexOf=function e(t,r,n){return T(this,t,r,n,false)};function A(e,t,r,n){r=Number(r)||0;var a=e.length-r;if(!n){n=a}else{n=Number(n);if(n>a){n=a}}var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");if(n>i/2){n=i/2}for(var o=0;o<n;++o){var s=parseInt(t.substr(o*2,2),16);if(isNaN(s))return o;e[r+o]=s}return o}function M(e,t,r,n){return ee(K(t,e.length-r),e,r,n)}function E(e,t,r,n){return ee(J(t),e,r,n)}function S(e,t,r,n){return E(e,t,r,n)}function C(e,t,r,n){return ee($(t),e,r,n)}function L(e,t,r,n){return ee(Q(t,e.length-r),e,r,n)}u.prototype.write=function e(t,r,n,a){if(r===undefined){a="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){a=r;n=this.length;r=0}else if(isFinite(r)){r=r|0;if(isFinite(n)){n=n|0;if(a===undefined)a="utf8"}else{a=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var i=this.length-r;if(n===undefined||n>i)n=i;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!a)a="utf8";var o=false;for(;;){switch(a){case"hex":return A(this,t,r,n);case"utf8":case"utf-8":return M(this,t,r,n);case"ascii":return E(this,t,r,n);case"latin1":case"binary":return S(this,t,r,n);case"base64":return C(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase();o=true}}};u.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function O(e,t,r){r=Math.min(e.length,r);var n=[];var a=t;while(a<r){var i=e[a];var o=null;var s=i>239?4:i>223?3:i>191?2:1;if(a+s<=r){var l,u,c,f;switch(s){case 1:if(i<128){o=i}break;case 2:l=e[a+1];if((l&192)===128){f=(i&31)<<6|l&63;if(f>127){o=f}}break;case 3:l=e[a+1];u=e[a+2];if((l&192)===128&&(u&192)===128){f=(i&15)<<12|(l&63)<<6|u&63;if(f>2047&&(f<55296||f>57343)){o=f}}break;case 4:l=e[a+1];u=e[a+2];c=e[a+3];if((l&192)===128&&(u&192)===128&&(c&192)===128){f=(i&15)<<18|(l&63)<<12|(u&63)<<6|c&63;if(f>65535&&f<1114112){o=f}}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;n.push(o>>>10&1023|55296);o=56320|o&1023}n.push(o);a+=s}return D(n)}var P=4096;function D(e){var t=e.length;if(t<=P){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=P))}return r}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a){n+=String.fromCharCode(e[a]&127)}return n}function z(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a){n+=String.fromCharCode(e[a])}return n}function N(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var a="";for(var i=t;i<r;++i){a+=Z(e[i])}return a}function F(e,t,r){var n=e.slice(t,r);var a="";for(var i=0;i<n.length;i+=2){a+=String.fromCharCode(n[i]+n[i+1]*256)}return a}u.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var a;if(u.TYPED_ARRAY_SUPPORT){a=this.subarray(t,r);a.__proto__=u.prototype}else{var i=r-t;a=new u(i,undefined);for(var o=0;o<i;++o){a[o]=this[o+t]}}return a};function B(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)B(t,r,this.length);var a=this[t];var i=1;var o=0;while(++o<r&&(i*=256)){a+=this[t+o]*i}return a};u.prototype.readUIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n){B(t,r,this.length)}var a=this[t+--r];var i=1;while(r>0&&(i*=256)){a+=this[t+--r]*i}return a};u.prototype.readUInt8=function e(t,r){if(!r)B(t,1,this.length);return this[t]};u.prototype.readUInt16LE=function e(t,r){if(!r)B(t,2,this.length);return this[t]|this[t+1]<<8};u.prototype.readUInt16BE=function e(t,r){if(!r)B(t,2,this.length);return this[t]<<8|this[t+1]};u.prototype.readUInt32LE=function e(t,r){if(!r)B(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};u.prototype.readUInt32BE=function e(t,r){if(!r)B(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};u.prototype.readIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)B(t,r,this.length);var a=this[t];var i=1;var o=0;while(++o<r&&(i*=256)){a+=this[t+o]*i}i*=128;if(a>=i)a-=Math.pow(2,8*r);return a};u.prototype.readIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n)B(t,r,this.length);var a=r;var i=1;var o=this[t+--a];while(a>0&&(i*=256)){o+=this[t+--a]*i}i*=128;if(o>=i)o-=Math.pow(2,8*r);return o};u.prototype.readInt8=function e(t,r){if(!r)B(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};u.prototype.readInt16LE=function e(t,r){if(!r)B(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function e(t,r){if(!r)B(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function e(t,r){if(!r)B(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};u.prototype.readInt32BE=function e(t,r){if(!r)B(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};u.prototype.readFloatLE=function e(t,r){if(!r)B(t,4,this.length);return a.read(this,t,true,23,4)};u.prototype.readFloatBE=function e(t,r){if(!r)B(t,4,this.length);return a.read(this,t,false,23,4)};u.prototype.readDoubleLE=function e(t,r){if(!r)B(t,8,this.length);return a.read(this,t,true,52,8)};u.prototype.readDoubleBE=function e(t,r){if(!r)B(t,8,this.length);return a.read(this,t,false,52,8)};function j(e,t,r,n,a,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function e(t,r,n,a){t=+t;r=r|0;n=n|0;if(!a){var i=Math.pow(2,8*n)-1;j(this,t,r,n,i,0)}var o=1;var s=0;this[r]=t&255;while(++s<n&&(o*=256)){this[r+s]=t/o&255}return r+n};u.prototype.writeUIntBE=function e(t,r,n,a){t=+t;r=r|0;n=n|0;if(!a){var i=Math.pow(2,8*n)-1;j(this,t,r,n,i,0)}var o=n-1;var s=1;this[r+o]=t&255;while(--o>=0&&(s*=256)){this[r+o]=t/s&255}return r+n};u.prototype.writeUInt8=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,1,255,0);if(!u.TYPED_ARRAY_SUPPORT)t=Math.floor(t);this[r]=t&255;return r+1};function U(e,t,r,n){if(t<0)t=65535+t+1;for(var a=0,i=Math.min(e.length-r,2);a<i;++a){e[r+a]=(t&255<<8*(n?a:1-a))>>>(n?a:1-a)*8}}u.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{U(this,t,r,true)}return r+2};u.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{U(this,t,r,false)}return r+2};function H(e,t,r,n){if(t<0)t=4294967295+t+1;for(var a=0,i=Math.min(e.length-r,4);a<i;++a){e[r+a]=t>>>(n?a:3-a)*8&255}}u.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255}else{H(this,t,r,true)}return r+4};u.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{H(this,t,r,false)}return r+4};u.prototype.writeIntLE=function e(t,r,n,a){t=+t;r=r|0;if(!a){var i=Math.pow(2,8*n-1);j(this,t,r,n,i-1,-i)}var o=0;var s=1;var l=0;this[r]=t&255;while(++o<n&&(s*=256)){if(t<0&&l===0&&this[r+o-1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+n};u.prototype.writeIntBE=function e(t,r,n,a){t=+t;r=r|0;if(!a){var i=Math.pow(2,8*n-1);j(this,t,r,n,i-1,-i)}var o=n-1;var s=1;var l=0;this[r+o]=t&255;while(--o>=0&&(s*=256)){if(t<0&&l===0&&this[r+o+1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+n};u.prototype.writeInt8=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,1,127,-128);if(!u.TYPED_ARRAY_SUPPORT)t=Math.floor(t);if(t<0)t=255+t+1;this[r]=t&255;return r+1};u.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{U(this,t,r,true)}return r+2};u.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{U(this,t,r,false)}return r+2};u.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,4,2147483647,-2147483648);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24}else{H(this,t,r,true)}return r+4};u.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)j(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{H(this,t,r,false)}return r+4};function V(e,t,r,n,a,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function G(e,t,r,n,i){if(!i){V(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}a.write(e,t,r,n,23,4);return r+4}u.prototype.writeFloatLE=function e(t,r,n){return G(this,t,r,true,n)};u.prototype.writeFloatBE=function e(t,r,n){return G(this,t,r,false,n)};function q(e,t,r,n,i){if(!i){V(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}a.write(e,t,r,n,52,8);return r+8}u.prototype.writeDoubleLE=function e(t,r,n){return q(this,t,r,true,n)};u.prototype.writeDoubleBE=function e(t,r,n){return q(this,t,r,false,n)};u.prototype.copy=function e(t,r,n,a){if(!n)n=0;if(!a&&a!==0)a=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(a>0&&a<n)a=n;if(a===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");if(a>this.length)a=this.length;if(t.length-r<a-n){a=t.length-r+n}var i=a-n;var o;if(this===t&&n<r&&r<a){for(o=i-1;o>=0;--o){t[o+r]=this[o+n]}}else if(i<1e3||!u.TYPED_ARRAY_SUPPORT){for(o=0;o<i;++o){t[o+r]=this[o+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,n+i),r)}return i};u.prototype.fill=function e(t,r,n,a){if(typeof t==="string"){if(typeof r==="string"){a=r;r=0;n=this.length}else if(typeof n==="string"){a=n;n=this.length}if(t.length===1){var i=t.charCodeAt(0);if(i<256){t=i}}if(a!==undefined&&typeof a!=="string"){throw new TypeError("encoding must be a string")}if(typeof a==="string"&&!u.isEncoding(a)){throw new TypeError("Unknown encoding: "+a)}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var o;if(typeof t==="number"){for(o=r;o<n;++o){this[o]=t}}else{var s=u.isBuffer(t)?t:K(new u(t,a).toString());var l=s.length;for(o=0;o<n-r;++o){this[o+r]=s[o%l]}}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function W(e){e=X(e).replace(Y,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function X(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function Z(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function K(e,t){t=t||Infinity;var r;var n=e.length;var a=null;var i=[];for(var o=0;o<n;++o){r=e.charCodeAt(o);if(r>55295&&r<57344){if(!a){if(r>56319){if((t-=3)>-1)i.push(239,191,189);continue}else if(o+1===n){if((t-=3)>-1)i.push(239,191,189);continue}a=r;continue}if(r<56320){if((t-=3)>-1)i.push(239,191,189);a=r;continue}r=(a-55296<<10|r-56320)+65536}else if(a){if((t-=3)>-1)i.push(239,191,189)}a=null;if(r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return i}function J(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function Q(e,t){var r,n,a;var i=[];for(var o=0;o<e.length;++o){if((t-=2)<0)break;r=e.charCodeAt(o);n=r>>8;a=r%256;i.push(a);i.push(n)}return i}function $(e){return n.toByteArray(W(e))}function ee(e,t,r,n){for(var a=0;a<n;++a){if(a+r>=t.length||a>=e.length)break;t[a+r]=e[a]}return a}function te(e){return e!==e}}).call(this,r(14))},197:function(e,t,r){"use strict";function n(){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__==="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=="function"){return}if(false){}try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}if(true){n();e.exports=r(532)}else{}},198:function(e,t,r){"use strict";function n(e){const t=[];let r=false;let n=0;let a=0;if(Array.isArray(e)){e=e.join("")}function i(e){if(n>=t.length){t.push(e)}else{t[n]=e}n++}for(const t of e.split("")){const e=t==="\r";if(e){r=true}else if(t==="\n"){if(r){i("\r")}a=n+1;r=false}else{if(r){n=a;r=false}}if(!e){i(t)}}if(r){t.push("\r")}return t.join("")}e.exports={processNewLines:n}},20:function(e,t,r){(function(e){var n=typeof e!=="undefined"&&e||typeof self!=="undefined"&&self||window;var a=Function.prototype.apply;t.setTimeout=function(){return new i(a.call(setTimeout,n,arguments),clearTimeout)};t.setInterval=function(){return new i(a.call(setInterval,n,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(e){if(e){e.close()}};function i(e,t){this._id=e;this._clearFn=t}i.prototype.unref=i.prototype.ref=function(){};i.prototype.close=function(){this._clearFn.call(n,this._id)};t.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};t.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;if(t>=0){e._idleTimeoutId=setTimeout(function t(){if(e._onTimeout)e._onTimeout()},t)}};r(140);t.setImmediate=typeof self!=="undefined"&&self.setImmediate||typeof e!=="undefined"&&e.setImmediate||this&&this.setImmediate;t.clearImmediate=typeof self!=="undefined"&&self.clearImmediate||typeof e!=="undefined"&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(14))},201:function(e,t,r){"use strict";var n=r(82),a=r(202),i=r(539),o=r(540),s=r(133),l=r(134),u=r(203),c=r(135),f=r(83),h=r(68);var p=h.TAG_NAMES,d=h.NAMESPACES,v=h.ATTRS;var m={locationInfo:false,treeAdapter:s};var g="hidden";var y=8,x=3;var _="INITIAL_MODE",b="BEFORE_HTML_MODE",w="BEFORE_HEAD_MODE",T="IN_HEAD_MODE",k="AFTER_HEAD_MODE",A="IN_BODY_MODE",M="TEXT_MODE",E="IN_TABLE_MODE",S="IN_TABLE_TEXT_MODE",C="IN_CAPTION_MODE",L="IN_COLUMN_GROUP_MODE",I="IN_TABLE_BODY_MODE",O="IN_ROW_MODE",P="IN_CELL_MODE",D="IN_SELECT_MODE",R="IN_SELECT_IN_TABLE_MODE",z="IN_TEMPLATE_MODE",N="AFTER_BODY_MODE",F="IN_FRAMESET_MODE",B="AFTER_FRAMESET_MODE",j="AFTER_AFTER_BODY_MODE",U="AFTER_AFTER_FRAMESET_MODE";var H={};H[p.TR]=O;H[p.TBODY]=H[p.THEAD]=H[p.TFOOT]=I;H[p.CAPTION]=C;H[p.COLGROUP]=L;H[p.TABLE]=E;H[p.BODY]=A;H[p.FRAMESET]=F;var V={};V[p.CAPTION]=V[p.COLGROUP]=V[p.TBODY]=V[p.TFOOT]=V[p.THEAD]=E;V[p.COL]=L;V[p.TR]=I;V[p.TD]=V[p.TH]=O;var G={};G[_]={};G[_][n.CHARACTER_TOKEN]=G[_][n.NULL_CHARACTER_TOKEN]=oe;G[_][n.WHITESPACE_CHARACTER_TOKEN]=$;G[_][n.COMMENT_TOKEN]=ee;G[_][n.DOCTYPE_TOKEN]=ie;G[_][n.START_TAG_TOKEN]=G[_][n.END_TAG_TOKEN]=G[_][n.EOF_TOKEN]=oe;G[b]={};G[b][n.CHARACTER_TOKEN]=G[b][n.NULL_CHARACTER_TOKEN]=ue;G[b][n.WHITESPACE_CHARACTER_TOKEN]=$;G[b][n.COMMENT_TOKEN]=ee;G[b][n.DOCTYPE_TOKEN]=$;G[b][n.START_TAG_TOKEN]=se;G[b][n.END_TAG_TOKEN]=le;G[b][n.EOF_TOKEN]=ue;G[w]={};G[w][n.CHARACTER_TOKEN]=G[w][n.NULL_CHARACTER_TOKEN]=he;G[w][n.WHITESPACE_CHARACTER_TOKEN]=$;G[w][n.COMMENT_TOKEN]=ee;G[w][n.DOCTYPE_TOKEN]=$;G[w][n.START_TAG_TOKEN]=ce;G[w][n.END_TAG_TOKEN]=fe;G[w][n.EOF_TOKEN]=he;G[T]={};G[T][n.CHARACTER_TOKEN]=G[T][n.NULL_CHARACTER_TOKEN]=ve;G[T][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[T][n.COMMENT_TOKEN]=ee;G[T][n.DOCTYPE_TOKEN]=$;G[T][n.START_TAG_TOKEN]=pe;G[T][n.END_TAG_TOKEN]=de;G[T][n.EOF_TOKEN]=ve;G[k]={};G[k][n.CHARACTER_TOKEN]=G[k][n.NULL_CHARACTER_TOKEN]=ye;G[k][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[k][n.COMMENT_TOKEN]=ee;G[k][n.DOCTYPE_TOKEN]=$;G[k][n.START_TAG_TOKEN]=me;G[k][n.END_TAG_TOKEN]=ge;G[k][n.EOF_TOKEN]=ye;G[A]={};G[A][n.CHARACTER_TOKEN]=_e;G[A][n.NULL_CHARACTER_TOKEN]=$;G[A][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[A][n.COMMENT_TOKEN]=ee;G[A][n.DOCTYPE_TOKEN]=$;G[A][n.START_TAG_TOKEN]=et;G[A][n.END_TAG_TOKEN]=ht;G[A][n.EOF_TOKEN]=pt;G[M]={};G[M][n.CHARACTER_TOKEN]=G[M][n.NULL_CHARACTER_TOKEN]=G[M][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[M][n.COMMENT_TOKEN]=G[M][n.DOCTYPE_TOKEN]=G[M][n.START_TAG_TOKEN]=$;G[M][n.END_TAG_TOKEN]=dt;G[M][n.EOF_TOKEN]=vt;G[E]={};G[E][n.CHARACTER_TOKEN]=G[E][n.NULL_CHARACTER_TOKEN]=G[E][n.WHITESPACE_CHARACTER_TOKEN]=mt;G[E][n.COMMENT_TOKEN]=ee;G[E][n.DOCTYPE_TOKEN]=$;G[E][n.START_TAG_TOKEN]=At;G[E][n.END_TAG_TOKEN]=Mt;G[E][n.EOF_TOKEN]=pt;G[S]={};G[S][n.CHARACTER_TOKEN]=Ct;G[S][n.NULL_CHARACTER_TOKEN]=$;G[S][n.WHITESPACE_CHARACTER_TOKEN]=St;G[S][n.COMMENT_TOKEN]=G[S][n.DOCTYPE_TOKEN]=G[S][n.START_TAG_TOKEN]=G[S][n.END_TAG_TOKEN]=G[S][n.EOF_TOKEN]=Lt;G[C]={};G[C][n.CHARACTER_TOKEN]=_e;G[C][n.NULL_CHARACTER_TOKEN]=$;G[C][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[C][n.COMMENT_TOKEN]=ee;G[C][n.DOCTYPE_TOKEN]=$;G[C][n.START_TAG_TOKEN]=It;G[C][n.END_TAG_TOKEN]=Ot;G[C][n.EOF_TOKEN]=pt;G[L]={};G[L][n.CHARACTER_TOKEN]=G[L][n.NULL_CHARACTER_TOKEN]=Rt;G[L][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[L][n.COMMENT_TOKEN]=ee;G[L][n.DOCTYPE_TOKEN]=$;G[L][n.START_TAG_TOKEN]=Pt;G[L][n.END_TAG_TOKEN]=Dt;G[L][n.EOF_TOKEN]=pt;G[I]={};G[I][n.CHARACTER_TOKEN]=G[I][n.NULL_CHARACTER_TOKEN]=G[I][n.WHITESPACE_CHARACTER_TOKEN]=mt;G[I][n.COMMENT_TOKEN]=ee;G[I][n.DOCTYPE_TOKEN]=$;G[I][n.START_TAG_TOKEN]=zt;G[I][n.END_TAG_TOKEN]=Nt;G[I][n.EOF_TOKEN]=pt;G[O]={};G[O][n.CHARACTER_TOKEN]=G[O][n.NULL_CHARACTER_TOKEN]=G[O][n.WHITESPACE_CHARACTER_TOKEN]=mt;G[O][n.COMMENT_TOKEN]=ee;G[O][n.DOCTYPE_TOKEN]=$;G[O][n.START_TAG_TOKEN]=Ft;G[O][n.END_TAG_TOKEN]=Bt;G[O][n.EOF_TOKEN]=pt;G[P]={};G[P][n.CHARACTER_TOKEN]=_e;G[P][n.NULL_CHARACTER_TOKEN]=$;G[P][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[P][n.COMMENT_TOKEN]=ee;G[P][n.DOCTYPE_TOKEN]=$;G[P][n.START_TAG_TOKEN]=jt;G[P][n.END_TAG_TOKEN]=Ut;G[P][n.EOF_TOKEN]=pt;G[D]={};G[D][n.CHARACTER_TOKEN]=ne;G[D][n.NULL_CHARACTER_TOKEN]=$;G[D][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[D][n.COMMENT_TOKEN]=ee;G[D][n.DOCTYPE_TOKEN]=$;G[D][n.START_TAG_TOKEN]=Ht;G[D][n.END_TAG_TOKEN]=Vt;G[D][n.EOF_TOKEN]=pt;G[R]={};G[R][n.CHARACTER_TOKEN]=ne;G[R][n.NULL_CHARACTER_TOKEN]=$;G[R][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[R][n.COMMENT_TOKEN]=ee;G[R][n.DOCTYPE_TOKEN]=$;G[R][n.START_TAG_TOKEN]=Gt;G[R][n.END_TAG_TOKEN]=qt;G[R][n.EOF_TOKEN]=pt;G[z]={};G[z][n.CHARACTER_TOKEN]=_e;G[z][n.NULL_CHARACTER_TOKEN]=$;G[z][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[z][n.COMMENT_TOKEN]=ee;G[z][n.DOCTYPE_TOKEN]=$;G[z][n.START_TAG_TOKEN]=Yt;G[z][n.END_TAG_TOKEN]=Wt;G[z][n.EOF_TOKEN]=Xt;G[N]={};G[N][n.CHARACTER_TOKEN]=G[N][n.NULL_CHARACTER_TOKEN]=Jt;G[N][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[N][n.COMMENT_TOKEN]=te;G[N][n.DOCTYPE_TOKEN]=$;G[N][n.START_TAG_TOKEN]=Zt;G[N][n.END_TAG_TOKEN]=Kt;G[N][n.EOF_TOKEN]=ae;G[F]={};G[F][n.CHARACTER_TOKEN]=G[F][n.NULL_CHARACTER_TOKEN]=$;G[F][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[F][n.COMMENT_TOKEN]=ee;G[F][n.DOCTYPE_TOKEN]=$;G[F][n.START_TAG_TOKEN]=Qt;G[F][n.END_TAG_TOKEN]=$t;G[F][n.EOF_TOKEN]=ae;G[B]={};G[B][n.CHARACTER_TOKEN]=G[B][n.NULL_CHARACTER_TOKEN]=$;G[B][n.WHITESPACE_CHARACTER_TOKEN]=ne;G[B][n.COMMENT_TOKEN]=ee;G[B][n.DOCTYPE_TOKEN]=$;G[B][n.START_TAG_TOKEN]=er;G[B][n.END_TAG_TOKEN]=tr;G[B][n.EOF_TOKEN]=ae;G[j]={};G[j][n.CHARACTER_TOKEN]=nr;G[j][n.NULL_CHARACTER_TOKEN]=nr;G[j][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[j][n.COMMENT_TOKEN]=re;G[j][n.DOCTYPE_TOKEN]=$;G[j][n.START_TAG_TOKEN]=rr;G[j][n.END_TAG_TOKEN]=nr;G[j][n.EOF_TOKEN]=ae;G[U]={};G[U][n.CHARACTER_TOKEN]=G[U][n.NULL_CHARACTER_TOKEN]=$;G[U][n.WHITESPACE_CHARACTER_TOKEN]=xe;G[U][n.COMMENT_TOKEN]=re;G[U][n.DOCTYPE_TOKEN]=$;G[U][n.START_TAG_TOKEN]=ar;G[U][n.END_TAG_TOKEN]=$;G[U][n.EOF_TOKEN]=ae;var q=e.exports=function(e){this.options=c(m,e);this.treeAdapter=this.options.treeAdapter;this.pendingScript=null;if(this.options.locationInfo)o.assign(this)};q.prototype.parse=function(e){var t=this.treeAdapter.createDocument();this._bootstrap(t,null);this.tokenizer.write(e,true);this._runParsingLoop(null,null);return t};q.prototype.parseFragment=function(e,t){if(!t)t=this.treeAdapter.createElement(p.TEMPLATE,d.HTML,[]);var r=this.treeAdapter.createElement("documentmock",d.HTML,[]);this._bootstrap(r,t);if(this.treeAdapter.getTagName(t)===p.TEMPLATE)this._pushTmplInsertionMode(z);this._initTokenizerForFragmentParsing();this._insertFakeRootElement();this._resetInsertionMode();this._findFormInFragmentContext();this.tokenizer.write(e,true);this._runParsingLoop(null,null);var n=this.treeAdapter.getFirstChild(r),a=this.treeAdapter.createDocumentFragment();this._adoptNodes(n,a);return a};q.prototype._bootstrap=function(e,t){this.tokenizer=new n(this.options);this.stopped=false;this.insertionMode=_;this.originalInsertionMode="";this.document=e;this.fragmentContext=t;this.headElement=null;this.formElement=null;this.openElements=new a(this.document,this.treeAdapter);this.activeFormattingElements=new i(this.treeAdapter);this.tmplInsertionModeStack=[];this.tmplInsertionModeStackTop=-1;this.currentTmplInsertionMode=null;this.pendingCharacterTokens=[];this.hasNonWhitespacePendingCharacterToken=false;this.framesetOk=true;this.skipNextNewLine=false;this.fosterParentingEnabled=false};q.prototype._runParsingLoop=function(e,t){while(!this.stopped){this._setupTokenizerCDATAMode();var r=this.tokenizer.getNextToken();if(r.type===n.HIBERNATION_TOKEN)break;if(this.skipNextNewLine){this.skipNextNewLine=false;if(r.type===n.WHITESPACE_CHARACTER_TOKEN&&r.chars[0]==="\n"){if(r.chars.length===1)continue;r.chars=r.chars.substr(1)}}this._processInputToken(r);if(t&&this.pendingScript)break}if(t&&this.pendingScript){var a=this.pendingScript;this.pendingScript=null;t(a);return}if(e)e()};q.prototype._setupTokenizerCDATAMode=function(){var e=this._getAdjustedCurrentElement();this.tokenizer.allowCDATA=e&&e!==this.document&&this.treeAdapter.getNamespaceURI(e)!==d.HTML&&!this._isIntegrationPoint(e)};q.prototype._switchToTextParsing=function(e,t){this._insertElement(e,d.HTML);this.tokenizer.state=t;this.originalInsertionMode=this.insertionMode;this.insertionMode=M};q.prototype._getAdjustedCurrentElement=function(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current};q.prototype._findFormInFragmentContext=function(){var e=this.fragmentContext;do{if(this.treeAdapter.getTagName(e)===p.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}while(e)};q.prototype._initTokenizerForFragmentParsing=function(){if(this.treeAdapter.getNamespaceURI(this.fragmentContext)===d.HTML){var e=this.treeAdapter.getTagName(this.fragmentContext);if(e===p.TITLE||e===p.TEXTAREA)this.tokenizer.state=n.MODE.RCDATA;else if(e===p.STYLE||e===p.XMP||e===p.IFRAME||e===p.NOEMBED||e===p.NOFRAMES||e===p.NOSCRIPT)this.tokenizer.state=n.MODE.RAWTEXT;else if(e===p.SCRIPT)this.tokenizer.state=n.MODE.SCRIPT_DATA;else if(e===p.PLAINTEXT)this.tokenizer.state=n.MODE.PLAINTEXT}};q.prototype._setDocumentType=function(e){this.treeAdapter.setDocumentType(this.document,e.name,e.publicId,e.systemId)};q.prototype._attachElementToTree=function(e){if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{var t=this.openElements.currentTmplContent||this.openElements.current;this.treeAdapter.appendChild(t,e)}};q.prototype._appendElement=function(e,t){var r=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(r)};q.prototype._insertElement=function(e,t){var r=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(r);this.openElements.push(r)};q.prototype._insertFakeElement=function(e){var t=this.treeAdapter.createElement(e,d.HTML,[]);this._attachElementToTree(t);this.openElements.push(t)};q.prototype._insertTemplate=function(e){var t=this.treeAdapter.createElement(e.tagName,d.HTML,e.attrs),r=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(t,r);this._attachElementToTree(t);this.openElements.push(t)};q.prototype._insertFakeRootElement=function(){var e=this.treeAdapter.createElement(p.HTML,d.HTML,[]);this.treeAdapter.appendChild(this.openElements.current,e);this.openElements.push(e)};q.prototype._appendCommentNode=function(e,t){var r=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,r)};q.prototype._insertCharacters=function(e){if(this._shouldFosterParentOnInsertion())this._fosterParentText(e.chars);else{var t=this.openElements.currentTmplContent||this.openElements.current;this.treeAdapter.insertText(t,e.chars)}};q.prototype._adoptNodes=function(e,t){while(true){var r=this.treeAdapter.getFirstChild(e);if(!r)break;this.treeAdapter.detachNode(r);this.treeAdapter.appendChild(t,r)}};q.prototype._shouldProcessTokenInForeignContent=function(e){var t=this._getAdjustedCurrentElement();if(!t||t===this.document)return false;var r=this.treeAdapter.getNamespaceURI(t);if(r===d.HTML)return false;if(this.treeAdapter.getTagName(t)===p.ANNOTATION_XML&&r===d.MATHML&&e.type===n.START_TAG_TOKEN&&e.tagName===p.SVG)return false;var a=e.type===n.CHARACTER_TOKEN||e.type===n.NULL_CHARACTER_TOKEN||e.type===n.WHITESPACE_CHARACTER_TOKEN,i=e.type===n.START_TAG_TOKEN&&e.tagName!==p.MGLYPH&&e.tagName!==p.MALIGNMARK;if((i||a)&&this._isIntegrationPoint(t,d.MATHML))return false;if((e.type===n.START_TAG_TOKEN||a)&&this._isIntegrationPoint(t,d.HTML))return false;return e.type!==n.EOF_TOKEN};q.prototype._processToken=function(e){G[this.insertionMode][e.type](this,e)};q.prototype._processTokenInBodyMode=function(e){G[A][e.type](this,e)};q.prototype._processTokenInForeignContent=function(e){if(e.type===n.CHARACTER_TOKEN)or(this,e);else if(e.type===n.NULL_CHARACTER_TOKEN)ir(this,e);else if(e.type===n.WHITESPACE_CHARACTER_TOKEN)ne(this,e);else if(e.type===n.COMMENT_TOKEN)ee(this,e);else if(e.type===n.START_TAG_TOKEN)sr(this,e);else if(e.type===n.END_TAG_TOKEN)lr(this,e)};q.prototype._processInputToken=function(e){if(this._shouldProcessTokenInForeignContent(e))this._processTokenInForeignContent(e);else this._processToken(e)};q.prototype._isIntegrationPoint=function(e,t){var r=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e),a=this.treeAdapter.getAttrList(e);return u.isIntegrationPoint(r,n,a,t)};q.prototype._reconstructActiveFormattingElements=function(){var e=this.activeFormattingElements.length;if(e){var t=e,r=null;do{t--;r=this.activeFormattingElements.entries[t];if(r.type===i.MARKER_ENTRY||this.openElements.contains(r.element)){t++;break}}while(t>0);for(var n=t;n<e;n++){r=this.activeFormattingElements.entries[n];this._insertElement(r.token,this.treeAdapter.getNamespaceURI(r.element));r.element=this.openElements.current}}};q.prototype._closeTableCell=function(){this.openElements.generateImpliedEndTags();this.openElements.popUntilTableCellPopped();this.activeFormattingElements.clearToLastMarker();this.insertionMode=O};q.prototype._closePElement=function(){this.openElements.generateImpliedEndTagsWithExclusion(p.P);this.openElements.popUntilTagNamePopped(p.P)};q.prototype._resetInsertionMode=function(){for(var e=this.openElements.stackTop,t=false;e>=0;e--){var r=this.openElements.items[e];if(e===0){t=true;if(this.fragmentContext)r=this.fragmentContext}var n=this.treeAdapter.getTagName(r),a=H[n];if(a){this.insertionMode=a;break}else if(!t&&(n===p.TD||n===p.TH)){this.insertionMode=P;break}else if(!t&&n===p.HEAD){this.insertionMode=T;break}else if(n===p.SELECT){this._resetInsertionModeForSelect(e);break}else if(n===p.TEMPLATE){this.insertionMode=this.currentTmplInsertionMode;break}else if(n===p.HTML){this.insertionMode=this.headElement?k:w;break}else if(t){this.insertionMode=A;break}}};q.prototype._resetInsertionModeForSelect=function(e){if(e>0){for(var t=e-1;t>0;t--){var r=this.openElements.items[t],n=this.treeAdapter.getTagName(r);if(n===p.TEMPLATE)break;else if(n===p.TABLE){this.insertionMode=R;return}}}this.insertionMode=D};q.prototype._pushTmplInsertionMode=function(e){this.tmplInsertionModeStack.push(e);this.tmplInsertionModeStackTop++;this.currentTmplInsertionMode=e};q.prototype._popTmplInsertionMode=function(){this.tmplInsertionModeStack.pop();this.tmplInsertionModeStackTop--;this.currentTmplInsertionMode=this.tmplInsertionModeStack[this.tmplInsertionModeStackTop]};q.prototype._isElementCausesFosterParenting=function(e){var t=this.treeAdapter.getTagName(e);return t===p.TABLE||t===p.TBODY||t===p.TFOOT||t===p.THEAD||t===p.TR};q.prototype._shouldFosterParentOnInsertion=function(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.current)};q.prototype._findFosterParentingLocation=function(){var e={parent:null,beforeElement:null};for(var t=this.openElements.stackTop;t>=0;t--){var r=this.openElements.items[t],n=this.treeAdapter.getTagName(r),a=this.treeAdapter.getNamespaceURI(r);if(n===p.TEMPLATE&&a===d.HTML){e.parent=this.treeAdapter.getTemplateContent(r);break}else if(n===p.TABLE){e.parent=this.treeAdapter.getParentNode(r);if(e.parent)e.beforeElement=r;else e.parent=this.openElements.items[t-1];break}}if(!e.parent)e.parent=this.openElements.items[0];return e};q.prototype._fosterParentElement=function(e){var t=this._findFosterParentingLocation();if(t.beforeElement)this.treeAdapter.insertBefore(t.parent,e,t.beforeElement);else this.treeAdapter.appendChild(t.parent,e)};q.prototype._fosterParentText=function(e){var t=this._findFosterParentingLocation();if(t.beforeElement)this.treeAdapter.insertTextBefore(t.parent,e,t.beforeElement);else this.treeAdapter.insertText(t.parent,e)};q.prototype._isSpecialElement=function(e){var t=this.treeAdapter.getTagName(e),r=this.treeAdapter.getNamespaceURI(e);return h.SPECIAL_ELEMENTS[r][t]};function Y(e,t){var r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);if(r){if(!e.openElements.contains(r.element)){e.activeFormattingElements.removeEntry(r);r=null}else if(!e.openElements.hasInScope(t.tagName))r=null}else ft(e,t);return r}function W(e,t){var r=null;for(var n=e.openElements.stackTop;n>=0;n--){var a=e.openElements.items[n];if(a===t.element)break;if(e._isSpecialElement(a))r=a}if(!r){e.openElements.popUntilElementPopped(t.element);e.activeFormattingElements.removeEntry(t)}return r}function X(e,t,r){var n=t,a=e.openElements.getCommonAncestor(t);for(var i=0,o=a;o!==r;i++,o=a){a=e.openElements.getCommonAncestor(o);var s=e.activeFormattingElements.getElementEntry(o),l=s&&i>=x,u=!s||l;if(u){if(l)e.activeFormattingElements.removeEntry(s);e.openElements.remove(o)}else{o=Z(e,s);if(n===t)e.activeFormattingElements.bookmark=s;e.treeAdapter.detachNode(n);e.treeAdapter.appendChild(o,n);n=o}}return n}function Z(e,t){var r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);e.openElements.replace(t.element,n);t.element=n;return n}function K(e,t,r){if(e._isElementCausesFosterParenting(t))e._fosterParentElement(r);else{var n=e.treeAdapter.getTagName(t),a=e.treeAdapter.getNamespaceURI(t);if(n===p.TEMPLATE&&a===d.HTML)t=e.treeAdapter.getTemplateContent(t);e.treeAdapter.appendChild(t,r)}}function J(e,t,r){var n=e.treeAdapter.getNamespaceURI(r.element),a=r.token,i=e.treeAdapter.createElement(a.tagName,n,a.attrs);e._adoptNodes(t,i);e.treeAdapter.appendChild(t,i);e.activeFormattingElements.insertElementAfterBookmark(i,r.token);e.activeFormattingElements.removeEntry(r);e.openElements.remove(r.element);e.openElements.insertAfter(t,i)}function Q(e,t){var r;for(var n=0;n<y;n++){r=Y(e,t,r);if(!r)break;var a=W(e,r);if(!a)break;e.activeFormattingElements.bookmark=r;var i=X(e,a,r.element),o=e.openElements.getCommonAncestor(r.element);e.treeAdapter.detachNode(i);K(e,o,i);J(e,a,r)}}function $(){}function ee(e,t){e._appendCommentNode(t,e.openElements.currentTmplContent||e.openElements.current)}function te(e,t){e._appendCommentNode(t,e.openElements.items[0])}function re(e,t){e._appendCommentNode(t,e.document)}function ne(e,t){e._insertCharacters(t)}function ae(e){e.stopped=true}function ie(e,t){e._setDocumentType(t);if(t.forceQuirks||l.isQuirks(t.name,t.publicId,t.systemId))e.treeAdapter.setQuirksMode(e.document);e.insertionMode=b}function oe(e,t){e.treeAdapter.setQuirksMode(e.document);e.insertionMode=b;e._processToken(t)}function se(e,t){if(t.tagName===p.HTML){e._insertElement(t,d.HTML);e.insertionMode=w}else ue(e,t)}function le(e,t){var r=t.tagName;if(r===p.HTML||r===p.HEAD||r===p.BODY||r===p.BR)ue(e,t)}function ue(e,t){e._insertFakeRootElement();e.insertionMode=w;e._processToken(t)}function ce(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.HEAD){e._insertElement(t,d.HTML);e.headElement=e.openElements.current;e.insertionMode=T}else he(e,t)}function fe(e,t){var r=t.tagName;if(r===p.HEAD||r===p.BODY||r===p.HTML||r===p.BR)he(e,t)}function he(e,t){e._insertFakeElement(p.HEAD);e.headElement=e.openElements.current;e.insertionMode=T;e._processToken(t)}function pe(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.BASE||r===p.BASEFONT||r===p.BGSOUND||r===p.LINK||r===p.META)e._appendElement(t,d.HTML);else if(r===p.TITLE)e._switchToTextParsing(t,n.MODE.RCDATA);else if(r===p.NOSCRIPT||r===p.NOFRAMES||r===p.STYLE)e._switchToTextParsing(t,n.MODE.RAWTEXT);else if(r===p.SCRIPT)e._switchToTextParsing(t,n.MODE.SCRIPT_DATA);else if(r===p.TEMPLATE){e._insertTemplate(t,d.HTML);e.activeFormattingElements.insertMarker();e.framesetOk=false;e.insertionMode=z;e._pushTmplInsertionMode(z)}else if(r!==p.HEAD)ve(e,t)}function de(e,t){var r=t.tagName;if(r===p.HEAD){e.openElements.pop();e.insertionMode=k}else if(r===p.BODY||r===p.BR||r===p.HTML)ve(e,t);else if(r===p.TEMPLATE&&e.openElements.tmplCount>0){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(p.TEMPLATE);e.activeFormattingElements.clearToLastMarker();e._popTmplInsertionMode();e._resetInsertionMode()}}function ve(e,t){e.openElements.pop();e.insertionMode=k;e._processToken(t)}function me(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.BODY){e._insertElement(t,d.HTML);e.framesetOk=false;e.insertionMode=A}else if(r===p.FRAMESET){e._insertElement(t,d.HTML);e.insertionMode=F}else if(r===p.BASE||r===p.BASEFONT||r===p.BGSOUND||r===p.LINK||r===p.META||r===p.NOFRAMES||r===p.SCRIPT||r===p.STYLE||r===p.TEMPLATE||r===p.TITLE){e.openElements.push(e.headElement);pe(e,t);e.openElements.remove(e.headElement)}else if(r!==p.HEAD)ye(e,t)}function ge(e,t){var r=t.tagName;if(r===p.BODY||r===p.HTML||r===p.BR)ye(e,t);else if(r===p.TEMPLATE)de(e,t)}function ye(e,t){e._insertFakeElement(p.BODY);e.insertionMode=A;e._processToken(t)}function xe(e,t){e._reconstructActiveFormattingElements();e._insertCharacters(t)}function _e(e,t){e._reconstructActiveFormattingElements();e._insertCharacters(t);e.framesetOk=false}function be(e,t){if(e.openElements.tmplCount===0)e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function we(e,t){var r=e.openElements.tryPeekProperlyNestedBodyElement();if(r&&e.openElements.tmplCount===0){e.framesetOk=false;e.treeAdapter.adoptAttributes(r,t.attrs)}}function Te(e,t){var r=e.openElements.tryPeekProperlyNestedBodyElement();if(e.framesetOk&&r){e.treeAdapter.detachNode(r);e.openElements.popAllUpToHtmlElement();e._insertElement(t,d.HTML);e.insertionMode=F}}function ke(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();e._insertElement(t,d.HTML)}function Ae(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();var r=e.openElements.currentTagName;if(r===p.H1||r===p.H2||r===p.H3||r===p.H4||r===p.H5||r===p.H6)e.openElements.pop();e._insertElement(t,d.HTML)}function Me(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();e._insertElement(t,d.HTML);e.skipNextNewLine=true;e.framesetOk=false}function Ee(e,t){var r=e.openElements.tmplCount>0;if(!e.formElement||r){if(e.openElements.hasInButtonScope(p.P))e._closePElement();e._insertElement(t,d.HTML);if(!r)e.formElement=e.openElements.current}}function Se(e,t){e.framesetOk=false;var r=t.tagName;for(var n=e.openElements.stackTop;n>=0;n--){var a=e.openElements.items[n],i=e.treeAdapter.getTagName(a),o=null;if(r===p.LI&&i===p.LI)o=p.LI;else if((r===p.DD||r===p.DT)&&(i===p.DD||i===p.DT))o=i;if(o){e.openElements.generateImpliedEndTagsWithExclusion(o);e.openElements.popUntilTagNamePopped(o);break}if(i!==p.ADDRESS&&i!==p.DIV&&i!==p.P&&e._isSpecialElement(a))break}if(e.openElements.hasInButtonScope(p.P))e._closePElement();e._insertElement(t,d.HTML)}function Ce(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();e._insertElement(t,d.HTML);e.tokenizer.state=n.MODE.PLAINTEXT}function Le(e,t){if(e.openElements.hasInScope(p.BUTTON)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(p.BUTTON)}e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.framesetOk=false}function Ie(e,t){var r=e.activeFormattingElements.getElementEntryInScopeWithTagName(p.A);if(r){Q(e,t);e.openElements.remove(r.element);e.activeFormattingElements.removeEntry(r)}e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.activeFormattingElements.pushElement(e.openElements.current,t)}function Oe(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.activeFormattingElements.pushElement(e.openElements.current,t)}function Pe(e,t){e._reconstructActiveFormattingElements();if(e.openElements.hasInScope(p.NOBR)){Q(e,t);e._reconstructActiveFormattingElements()}e._insertElement(t,d.HTML);e.activeFormattingElements.pushElement(e.openElements.current,t)}function De(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.activeFormattingElements.insertMarker();e.framesetOk=false}function Re(e,t){if(!e.treeAdapter.isQuirksMode(e.document)&&e.openElements.hasInButtonScope(p.P))e._closePElement();e._insertElement(t,d.HTML);e.framesetOk=false;e.insertionMode=E}function ze(e,t){e._reconstructActiveFormattingElements();e._appendElement(t,d.HTML);e.framesetOk=false}function Ne(e,t){e._reconstructActiveFormattingElements();e._appendElement(t,d.HTML);var r=n.getTokenAttr(t,v.TYPE);if(!r||r.toLowerCase()!==g)e.framesetOk=false}function Fe(e,t){e._appendElement(t,d.HTML)}function Be(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();if(e.openElements.currentTagName===p.MENUITEM)e.openElements.pop();e._appendElement(t,d.HTML);e.framesetOk=false}function je(e,t){t.tagName=p.IMG;ze(e,t)}function Ue(e,t){e._insertElement(t,d.HTML);e.skipNextNewLine=true;e.tokenizer.state=n.MODE.RCDATA;e.originalInsertionMode=e.insertionMode;e.framesetOk=false;e.insertionMode=M}function He(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();e._reconstructActiveFormattingElements();e.framesetOk=false;e._switchToTextParsing(t,n.MODE.RAWTEXT)}function Ve(e,t){e.framesetOk=false;e._switchToTextParsing(t,n.MODE.RAWTEXT)}function Ge(e,t){e._switchToTextParsing(t,n.MODE.RAWTEXT)}function qe(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.framesetOk=false;if(e.insertionMode===E||e.insertionMode===C||e.insertionMode===I||e.insertionMode===O||e.insertionMode===P)e.insertionMode=R;else e.insertionMode=D}function Ye(e,t){if(e.openElements.currentTagName===p.OPTION)e.openElements.pop();e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML)}function We(e,t){if(e.openElements.hasInScope(p.RUBY))e.openElements.generateImpliedEndTags();e._insertElement(t,d.HTML)}function Xe(e,t){if(e.openElements.hasInScope(p.RUBY))e.openElements.generateImpliedEndTagsWithExclusion(p.RTC);e._insertElement(t,d.HTML)}function Ze(e,t){if(e.openElements.currentTagName===p.MENUITEM)e.openElements.pop();e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML)}function Ke(e,t){if(e.openElements.hasInButtonScope(p.P))e._closePElement();if(e.openElements.currentTagName===p.MENUITEM)e.openElements.pop();e._insertElement(t,d.HTML)}function Je(e,t){e._reconstructActiveFormattingElements();u.adjustTokenMathMLAttrs(t);u.adjustTokenXMLAttrs(t);if(t.selfClosing)e._appendElement(t,d.MATHML);else e._insertElement(t,d.MATHML)}function Qe(e,t){e._reconstructActiveFormattingElements();u.adjustTokenSVGAttrs(t);u.adjustTokenXMLAttrs(t);if(t.selfClosing)e._appendElement(t,d.SVG);else e._insertElement(t,d.SVG)}function $e(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML)}function et(e,t){var r=t.tagName;switch(r.length){case 1:if(r===p.I||r===p.S||r===p.B||r===p.U)Oe(e,t);else if(r===p.P)ke(e,t);else if(r===p.A)Ie(e,t);else $e(e,t);break;case 2:if(r===p.DL||r===p.OL||r===p.UL)ke(e,t);else if(r===p.H1||r===p.H2||r===p.H3||r===p.H4||r===p.H5||r===p.H6)Ae(e,t);else if(r===p.LI||r===p.DD||r===p.DT)Se(e,t);else if(r===p.EM||r===p.TT)Oe(e,t);else if(r===p.BR)ze(e,t);else if(r===p.HR)Be(e,t);else if(r===p.RB)We(e,t);else if(r===p.RT||r===p.RP)Xe(e,t);else if(r!==p.TH&&r!==p.TD&&r!==p.TR)$e(e,t);break;case 3:if(r===p.DIV||r===p.DIR||r===p.NAV)ke(e,t);else if(r===p.PRE)Me(e,t);else if(r===p.BIG)Oe(e,t);else if(r===p.IMG||r===p.WBR)ze(e,t);else if(r===p.XMP)He(e,t);else if(r===p.SVG)Qe(e,t);else if(r===p.RTC)We(e,t);else if(r!==p.COL)$e(e,t);break;case 4:if(r===p.HTML)be(e,t);else if(r===p.BASE||r===p.LINK||r===p.META)pe(e,t);else if(r===p.BODY)we(e,t);else if(r===p.MAIN)ke(e,t);else if(r===p.FORM)Ee(e,t);else if(r===p.CODE||r===p.FONT)Oe(e,t);else if(r===p.NOBR)Pe(e,t);else if(r===p.AREA)ze(e,t);else if(r===p.MATH)Je(e,t);else if(r===p.MENU)Ke(e,t);else if(r!==p.HEAD)$e(e,t);break;case 5:if(r===p.STYLE||r===p.TITLE)pe(e,t);else if(r===p.ASIDE)ke(e,t);else if(r===p.SMALL)Oe(e,t);else if(r===p.TABLE)Re(e,t);else if(r===p.EMBED)ze(e,t);else if(r===p.INPUT)Ne(e,t);else if(r===p.PARAM||r===p.TRACK)Fe(e,t);else if(r===p.IMAGE)je(e,t);else if(r!==p.FRAME&&r!==p.TBODY&&r!==p.TFOOT&&r!==p.THEAD)$e(e,t);break;case 6:if(r===p.SCRIPT)pe(e,t);else if(r===p.CENTER||r===p.FIGURE||r===p.FOOTER||r===p.HEADER||r===p.HGROUP)ke(e,t);else if(r===p.BUTTON)Le(e,t);else if(r===p.STRIKE||r===p.STRONG)Oe(e,t);else if(r===p.APPLET||r===p.OBJECT)De(e,t);else if(r===p.KEYGEN)ze(e,t);else if(r===p.SOURCE)Fe(e,t);else if(r===p.IFRAME)Ve(e,t);else if(r===p.SELECT)qe(e,t);else if(r===p.OPTION)Ye(e,t);else $e(e,t);break;case 7:if(r===p.BGSOUND)pe(e,t);else if(r===p.DETAILS||r===p.ADDRESS||r===p.ARTICLE||r===p.SECTION||r===p.SUMMARY)ke(e,t);else if(r===p.LISTING)Me(e,t);else if(r===p.MARQUEE)De(e,t);else if(r===p.NOEMBED)Ge(e,t);else if(r!==p.CAPTION)$e(e,t);break;case 8:if(r===p.BASEFONT)pe(e,t);else if(r===p.MENUITEM)Ze(e,t);else if(r===p.FRAMESET)Te(e,t);else if(r===p.FIELDSET)ke(e,t);else if(r===p.TEXTAREA)Ue(e,t);else if(r===p.TEMPLATE)pe(e,t);else if(r===p.NOSCRIPT)Ge(e,t);else if(r===p.OPTGROUP)Ye(e,t);else if(r!==p.COLGROUP)$e(e,t);break;case 9:if(r===p.PLAINTEXT)Ce(e,t);else $e(e,t);break;case 10:if(r===p.BLOCKQUOTE||r===p.FIGCAPTION)ke(e,t);else $e(e,t);break;default:$e(e,t)}}function tt(e){if(e.openElements.hasInScope(p.BODY))e.insertionMode=N}function rt(e,t){if(e.openElements.hasInScope(p.BODY)){e.insertionMode=N;e._processToken(t)}}function nt(e,t){var r=t.tagName;if(e.openElements.hasInScope(r)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(r)}}function at(e){var t=e.openElements.tmplCount>0,r=e.formElement;if(!t)e.formElement=null;if((r||t)&&e.openElements.hasInScope(p.FORM)){e.openElements.generateImpliedEndTags();if(t)e.openElements.popUntilTagNamePopped(p.FORM);else e.openElements.remove(r)}}function it(e){if(!e.openElements.hasInButtonScope(p.P))e._insertFakeElement(p.P);e._closePElement()}function ot(e){if(e.openElements.hasInListItemScope(p.LI)){e.openElements.generateImpliedEndTagsWithExclusion(p.LI);e.openElements.popUntilTagNamePopped(p.LI)}}function st(e,t){var r=t.tagName;if(e.openElements.hasInScope(r)){e.openElements.generateImpliedEndTagsWithExclusion(r);e.openElements.popUntilTagNamePopped(r)}}function lt(e){if(e.openElements.hasNumberedHeaderInScope()){e.openElements.generateImpliedEndTags();e.openElements.popUntilNumberedHeaderPopped()}}function ut(e,t){var r=t.tagName;if(e.openElements.hasInScope(r)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(r);e.activeFormattingElements.clearToLastMarker()}}function ct(e){e._reconstructActiveFormattingElements();e._insertFakeElement(p.BR);e.openElements.pop();e.framesetOk=false}function ft(e,t){var r=t.tagName;for(var n=e.openElements.stackTop;n>0;n--){var a=e.openElements.items[n];if(e.treeAdapter.getTagName(a)===r){e.openElements.generateImpliedEndTagsWithExclusion(r);e.openElements.popUntilElementPopped(a);break}if(e._isSpecialElement(a))break}}function ht(e,t){var r=t.tagName;switch(r.length){case 1:if(r===p.A||r===p.B||r===p.I||r===p.S||r===p.U)Q(e,t);else if(r===p.P)it(e,t);else ft(e,t);break;case 2:if(r===p.DL||r===p.UL||r===p.OL)nt(e,t);else if(r===p.LI)ot(e,t);else if(r===p.DD||r===p.DT)st(e,t);else if(r===p.H1||r===p.H2||r===p.H3||r===p.H4||r===p.H5||r===p.H6)lt(e,t);else if(r===p.BR)ct(e,t);else if(r===p.EM||r===p.TT)Q(e,t);else ft(e,t);break;case 3:if(r===p.BIG)Q(e,t);else if(r===p.DIR||r===p.DIV||r===p.NAV)nt(e,t);else ft(e,t);break;case 4:if(r===p.BODY)tt(e,t);else if(r===p.HTML)rt(e,t);else if(r===p.FORM)at(e,t);else if(r===p.CODE||r===p.FONT||r===p.NOBR)Q(e,t);else if(r===p.MAIN||r===p.MENU)nt(e,t);else ft(e,t);break;case 5:if(r===p.ASIDE)nt(e,t);else if(r===p.SMALL)Q(e,t);else ft(e,t);break;case 6:if(r===p.CENTER||r===p.FIGURE||r===p.FOOTER||r===p.HEADER||r===p.HGROUP)nt(e,t);else if(r===p.APPLET||r===p.OBJECT)ut(e,t);else if(r===p.STRIKE||r===p.STRONG)Q(e,t);else ft(e,t);break;case 7:if(r===p.ADDRESS||r===p.ARTICLE||r===p.DETAILS||r===p.SECTION||r===p.SUMMARY)nt(e,t);else if(r===p.MARQUEE)ut(e,t);else ft(e,t);break;case 8:if(r===p.FIELDSET)nt(e,t);else if(r===p.TEMPLATE)de(e,t);else ft(e,t);break;case 10:if(r===p.BLOCKQUOTE||r===p.FIGCAPTION)nt(e,t);else ft(e,t);break;default:ft(e,t)}}function pt(e,t){if(e.tmplInsertionModeStackTop>-1)Xt(e,t);else e.stopped=true}function dt(e,t){if(t.tagName===p.SCRIPT)e.pendingScript=e.openElements.current;e.openElements.pop();e.insertionMode=e.originalInsertionMode}function vt(e,t){e.openElements.pop();e.insertionMode=e.originalInsertionMode;e._processToken(t)}function mt(e,t){var r=e.openElements.currentTagName;if(r===p.TABLE||r===p.TBODY||r===p.TFOOT||r===p.THEAD||r===p.TR){e.pendingCharacterTokens=[];e.hasNonWhitespacePendingCharacterToken=false;e.originalInsertionMode=e.insertionMode;e.insertionMode=S;e._processToken(t)}else Et(e,t)}function gt(e,t){e.openElements.clearBackToTableContext();e.activeFormattingElements.insertMarker();e._insertElement(t,d.HTML);e.insertionMode=C}function yt(e,t){e.openElements.clearBackToTableContext();e._insertElement(t,d.HTML);e.insertionMode=L}function xt(e,t){e.openElements.clearBackToTableContext();e._insertFakeElement(p.COLGROUP);e.insertionMode=L;e._processToken(t)}function _t(e,t){e.openElements.clearBackToTableContext();e._insertElement(t,d.HTML);e.insertionMode=I}function bt(e,t){e.openElements.clearBackToTableContext();e._insertFakeElement(p.TBODY);e.insertionMode=I;e._processToken(t)}function wt(e,t){if(e.openElements.hasInTableScope(p.TABLE)){e.openElements.popUntilTagNamePopped(p.TABLE);e._resetInsertionMode();e._processToken(t)}}function Tt(e,t){var r=n.getTokenAttr(t,v.TYPE);if(r&&r.toLowerCase()===g)e._appendElement(t,d.HTML);else Et(e,t)}function kt(e,t){if(!e.formElement&&e.openElements.tmplCount===0){e._insertElement(t,d.HTML);e.formElement=e.openElements.current;e.openElements.pop()}}function At(e,t){var r=t.tagName;switch(r.length){case 2:if(r===p.TD||r===p.TH||r===p.TR)bt(e,t);else Et(e,t);break;case 3:if(r===p.COL)xt(e,t);else Et(e,t);break;case 4:if(r===p.FORM)kt(e,t);else Et(e,t);break;case 5:if(r===p.TABLE)wt(e,t);else if(r===p.STYLE)pe(e,t);else if(r===p.TBODY||r===p.TFOOT||r===p.THEAD)_t(e,t);else if(r===p.INPUT)Tt(e,t);else Et(e,t);break;case 6:if(r===p.SCRIPT)pe(e,t);else Et(e,t);break;case 7:if(r===p.CAPTION)gt(e,t);else Et(e,t);break;case 8:if(r===p.COLGROUP)yt(e,t);else if(r===p.TEMPLATE)pe(e,t);else Et(e,t);break;default:Et(e,t)}}function Mt(e,t){var r=t.tagName;if(r===p.TABLE){if(e.openElements.hasInTableScope(p.TABLE)){e.openElements.popUntilTagNamePopped(p.TABLE);e._resetInsertionMode()}}else if(r===p.TEMPLATE)de(e,t);else if(r!==p.BODY&&r!==p.CAPTION&&r!==p.COL&&r!==p.COLGROUP&&r!==p.HTML&&r!==p.TBODY&&r!==p.TD&&r!==p.TFOOT&&r!==p.TH&&r!==p.THEAD&&r!==p.TR)Et(e,t)}function Et(e,t){var r=e.fosterParentingEnabled;e.fosterParentingEnabled=true;e._processTokenInBodyMode(t);e.fosterParentingEnabled=r}function St(e,t){e.pendingCharacterTokens.push(t)}function Ct(e,t){e.pendingCharacterTokens.push(t);e.hasNonWhitespacePendingCharacterToken=true}function Lt(e,t){var r=0;if(e.hasNonWhitespacePendingCharacterToken){for(;r<e.pendingCharacterTokens.length;r++)Et(e,e.pendingCharacterTokens[r])}else{for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r])}e.insertionMode=e.originalInsertionMode;e._processToken(t)}function It(e,t){var r=t.tagName;if(r===p.CAPTION||r===p.COL||r===p.COLGROUP||r===p.TBODY||r===p.TD||r===p.TFOOT||r===p.TH||r===p.THEAD||r===p.TR){if(e.openElements.hasInTableScope(p.CAPTION)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(p.CAPTION);e.activeFormattingElements.clearToLastMarker();e.insertionMode=E;e._processToken(t)}}else et(e,t)}function Ot(e,t){var r=t.tagName;if(r===p.CAPTION||r===p.TABLE){if(e.openElements.hasInTableScope(p.CAPTION)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(p.CAPTION);e.activeFormattingElements.clearToLastMarker();e.insertionMode=E;if(r===p.TABLE)e._processToken(t)}}else if(r!==p.BODY&&r!==p.COL&&r!==p.COLGROUP&&r!==p.HTML&&r!==p.TBODY&&r!==p.TD&&r!==p.TFOOT&&r!==p.TH&&r!==p.THEAD&&r!==p.TR)ht(e,t)}function Pt(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.COL)e._appendElement(t,d.HTML);else if(r===p.TEMPLATE)pe(e,t);else Rt(e,t)}function Dt(e,t){var r=t.tagName;if(r===p.COLGROUP){if(e.openElements.currentTagName===p.COLGROUP){e.openElements.pop();e.insertionMode=E}}else if(r===p.TEMPLATE)de(e,t);else if(r!==p.COL)Rt(e,t)}function Rt(e,t){if(e.openElements.currentTagName===p.COLGROUP){e.openElements.pop();e.insertionMode=E;e._processToken(t)}}function zt(e,t){var r=t.tagName;if(r===p.TR){e.openElements.clearBackToTableBodyContext();e._insertElement(t,d.HTML);e.insertionMode=O}else if(r===p.TH||r===p.TD){e.openElements.clearBackToTableBodyContext();e._insertFakeElement(p.TR);e.insertionMode=O;e._processToken(t)}else if(r===p.CAPTION||r===p.COL||r===p.COLGROUP||r===p.TBODY||r===p.TFOOT||r===p.THEAD){if(e.openElements.hasTableBodyContextInTableScope()){e.openElements.clearBackToTableBodyContext();e.openElements.pop();e.insertionMode=E;e._processToken(t)}}else At(e,t)}function Nt(e,t){var r=t.tagName;if(r===p.TBODY||r===p.TFOOT||r===p.THEAD){if(e.openElements.hasInTableScope(r)){e.openElements.clearBackToTableBodyContext();e.openElements.pop();e.insertionMode=E}}else if(r===p.TABLE){if(e.openElements.hasTableBodyContextInTableScope()){e.openElements.clearBackToTableBodyContext();e.openElements.pop();e.insertionMode=E;e._processToken(t)}}else if(r!==p.BODY&&r!==p.CAPTION&&r!==p.COL&&r!==p.COLGROUP||r!==p.HTML&&r!==p.TD&&r!==p.TH&&r!==p.TR)Mt(e,t)}function Ft(e,t){var r=t.tagName;if(r===p.TH||r===p.TD){e.openElements.clearBackToTableRowContext();e._insertElement(t,d.HTML);e.insertionMode=P;e.activeFormattingElements.insertMarker()}else if(r===p.CAPTION||r===p.COL||r===p.COLGROUP||r===p.TBODY||r===p.TFOOT||r===p.THEAD||r===p.TR){if(e.openElements.hasInTableScope(p.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=I;e._processToken(t)}}else At(e,t)}function Bt(e,t){var r=t.tagName;if(r===p.TR){if(e.openElements.hasInTableScope(p.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=I}}else if(r===p.TABLE){if(e.openElements.hasInTableScope(p.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=I;e._processToken(t)}}else if(r===p.TBODY||r===p.TFOOT||r===p.THEAD){if(e.openElements.hasInTableScope(r)||e.openElements.hasInTableScope(p.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=I;e._processToken(t)}}else if(r!==p.BODY&&r!==p.CAPTION&&r!==p.COL&&r!==p.COLGROUP||r!==p.HTML&&r!==p.TD&&r!==p.TH)Mt(e,t)}function jt(e,t){var r=t.tagName;if(r===p.CAPTION||r===p.COL||r===p.COLGROUP||r===p.TBODY||r===p.TD||r===p.TFOOT||r===p.TH||r===p.THEAD||r===p.TR){if(e.openElements.hasInTableScope(p.TD)||e.openElements.hasInTableScope(p.TH)){e._closeTableCell();e._processToken(t)}}else et(e,t)}function Ut(e,t){var r=t.tagName;if(r===p.TD||r===p.TH){if(e.openElements.hasInTableScope(r)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(r);e.activeFormattingElements.clearToLastMarker();e.insertionMode=O}}else if(r===p.TABLE||r===p.TBODY||r===p.TFOOT||r===p.THEAD||r===p.TR){if(e.openElements.hasInTableScope(r)){e._closeTableCell();e._processToken(t)}}else if(r!==p.BODY&&r!==p.CAPTION&&r!==p.COL&&r!==p.COLGROUP&&r!==p.HTML)ht(e,t)}function Ht(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.OPTION){if(e.openElements.currentTagName===p.OPTION)e.openElements.pop();e._insertElement(t,d.HTML)}else if(r===p.OPTGROUP){if(e.openElements.currentTagName===p.OPTION)e.openElements.pop();if(e.openElements.currentTagName===p.OPTGROUP)e.openElements.pop();e._insertElement(t,d.HTML)}else if(r===p.INPUT||r===p.KEYGEN||r===p.TEXTAREA||r===p.SELECT){if(e.openElements.hasInSelectScope(p.SELECT)){e.openElements.popUntilTagNamePopped(p.SELECT);e._resetInsertionMode();if(r!==p.SELECT)e._processToken(t)}}else if(r===p.SCRIPT||r===p.TEMPLATE)pe(e,t)}function Vt(e,t){var r=t.tagName;if(r===p.OPTGROUP){var n=e.openElements.items[e.openElements.stackTop-1],a=n&&e.treeAdapter.getTagName(n);if(e.openElements.currentTagName===p.OPTION&&a===p.OPTGROUP)e.openElements.pop();if(e.openElements.currentTagName===p.OPTGROUP)e.openElements.pop()}else if(r===p.OPTION){if(e.openElements.currentTagName===p.OPTION)e.openElements.pop()}else if(r===p.SELECT&&e.openElements.hasInSelectScope(p.SELECT)){e.openElements.popUntilTagNamePopped(p.SELECT);e._resetInsertionMode()}else if(r===p.TEMPLATE)de(e,t)}function Gt(e,t){var r=t.tagName;if(r===p.CAPTION||r===p.TABLE||r===p.TBODY||r===p.TFOOT||r===p.THEAD||r===p.TR||r===p.TD||r===p.TH){e.openElements.popUntilTagNamePopped(p.SELECT);e._resetInsertionMode();e._processToken(t)}else Ht(e,t)}function qt(e,t){var r=t.tagName;if(r===p.CAPTION||r===p.TABLE||r===p.TBODY||r===p.TFOOT||r===p.THEAD||r===p.TR||r===p.TD||r===p.TH){if(e.openElements.hasInTableScope(r)){e.openElements.popUntilTagNamePopped(p.SELECT);e._resetInsertionMode();e._processToken(t)}}else Vt(e,t)}function Yt(e,t){var r=t.tagName;if(r===p.BASE||r===p.BASEFONT||r===p.BGSOUND||r===p.LINK||r===p.META||r===p.NOFRAMES||r===p.SCRIPT||r===p.STYLE||r===p.TEMPLATE||r===p.TITLE)pe(e,t);else{var n=V[r]||A;e._popTmplInsertionMode();e._pushTmplInsertionMode(n);e.insertionMode=n;e._processToken(t)}}function Wt(e,t){if(t.tagName===p.TEMPLATE)de(e,t)}function Xt(e,t){if(e.openElements.tmplCount>0){e.openElements.popUntilTagNamePopped(p.TEMPLATE);e.activeFormattingElements.clearToLastMarker();e._popTmplInsertionMode();e._resetInsertionMode();e._processToken(t)}else e.stopped=true}function Zt(e,t){if(t.tagName===p.HTML)et(e,t);else Jt(e,t)}function Kt(e,t){if(t.tagName===p.HTML){if(!e.fragmentContext)e.insertionMode=j}else Jt(e,t)}function Jt(e,t){e.insertionMode=A;e._processToken(t)}function Qt(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.FRAMESET)e._insertElement(t,d.HTML);else if(r===p.FRAME)e._appendElement(t,d.HTML);else if(r===p.NOFRAMES)pe(e,t)}function $t(e,t){if(t.tagName===p.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()){e.openElements.pop();if(!e.fragmentContext&&e.openElements.currentTagName!==p.FRAMESET)e.insertionMode=B}}function er(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.NOFRAMES)pe(e,t)}function tr(e,t){if(t.tagName===p.HTML)e.insertionMode=U}function rr(e,t){if(t.tagName===p.HTML)et(e,t);else nr(e,t)}function nr(e,t){e.insertionMode=A;e._processToken(t)}function ar(e,t){var r=t.tagName;if(r===p.HTML)et(e,t);else if(r===p.NOFRAMES)pe(e,t)}function ir(e,t){t.chars=f.REPLACEMENT_CHARACTER;e._insertCharacters(t)}function or(e,t){e._insertCharacters(t);e.framesetOk=false}function sr(e,t){if(u.causesExit(t)&&!e.fragmentContext){while(e.treeAdapter.getNamespaceURI(e.openElements.current)!==d.HTML&&!e._isIntegrationPoint(e.openElements.current))e.openElements.pop();e._processToken(t)}else{var r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);if(n===d.MATHML)u.adjustTokenMathMLAttrs(t);else if(n===d.SVG){u.adjustTokenSVGTagName(t);u.adjustTokenSVGAttrs(t)}u.adjustTokenXMLAttrs(t);if(t.selfClosing)e._appendElement(t,n);else e._insertElement(t,n)}}function lr(e,t){for(var r=e.openElements.stackTop;r>0;r--){var n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===d.HTML){e._processToken(t);break}if(e.treeAdapter.getTagName(n).toLowerCase()===t.tagName){e.openElements.popUntilElementPopped(n);break}}}},202:function(e,t,r){"use strict";var n=r(68);var a=n.TAG_NAMES,i=n.NAMESPACES;function o(e){switch(e.length){case 1:return e===a.P;case 2:return e===a.RB||e===a.RP||e===a.RT||e===a.DD||e===a.DT||e===a.LI;case 3:return e===a.RTC;case 6:return e===a.OPTION;case 8:return e===a.OPTGROUP||e===a.MENUITEM}return false}function s(e,t){switch(e.length){case 2:if(e===a.TD||e===a.TH)return t===i.HTML;else if(e===a.MI||e===a.MO||e===a.MN||e===a.MS)return t===i.MATHML;break;case 4:if(e===a.HTML)return t===i.HTML;else if(e===a.DESC)return t===i.SVG;break;case 5:if(e===a.TABLE)return t===i.HTML;else if(e===a.MTEXT)return t===i.MATHML;else if(e===a.TITLE)return t===i.SVG;break;case 6:return(e===a.APPLET||e===a.OBJECT)&&t===i.HTML;case 7:return(e===a.CAPTION||e===a.MARQUEE)&&t===i.HTML;case 8:return e===a.TEMPLATE&&t===i.HTML;case 13:return e===a.FOREIGN_OBJECT&&t===i.SVG;case 14:return e===a.ANNOTATION_XML&&t===i.MATHML}return false}var l=e.exports=function(e,t){this.stackTop=-1;this.items=[];this.current=e;this.currentTagName=null;this.currentTmplContent=null;this.tmplCount=0;this.treeAdapter=t};l.prototype._indexOf=function(e){var t=-1;for(var r=this.stackTop;r>=0;r--){if(this.items[r]===e){t=r;break}}return t};l.prototype._isInTemplate=function(){return this.currentTagName===a.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===i.HTML};l.prototype._updateCurrentElement=function(){this.current=this.items[this.stackTop];this.currentTagName=this.current&&this.treeAdapter.getTagName(this.current);this.currentTmplContent=this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):null};l.prototype.push=function(e){this.items[++this.stackTop]=e;this._updateCurrentElement();if(this._isInTemplate())this.tmplCount++};l.prototype.pop=function(){this.stackTop--;if(this.tmplCount>0&&this._isInTemplate())this.tmplCount--;this._updateCurrentElement()};l.prototype.replace=function(e,t){var r=this._indexOf(e);this.items[r]=t;if(r===this.stackTop)this._updateCurrentElement()};l.prototype.insertAfter=function(e,t){var r=this._indexOf(e)+1;this.items.splice(r,0,t);if(r===++this.stackTop)this._updateCurrentElement()};l.prototype.popUntilTagNamePopped=function(e){while(this.stackTop>-1){var t=this.currentTagName,r=this.treeAdapter.getNamespaceURI(this.current);this.pop();if(t===e&&r===i.HTML)break}};l.prototype.popUntilElementPopped=function(e){while(this.stackTop>-1){var t=this.current;this.pop();if(t===e)break}};l.prototype.popUntilNumberedHeaderPopped=function(){while(this.stackTop>-1){var e=this.currentTagName,t=this.treeAdapter.getNamespaceURI(this.current);this.pop();if(e===a.H1||e===a.H2||e===a.H3||e===a.H4||e===a.H5||e===a.H6&&t===i.HTML)break}};l.prototype.popUntilTableCellPopped=function(){while(this.stackTop>-1){var e=this.currentTagName,t=this.treeAdapter.getNamespaceURI(this.current);this.pop();if(e===a.TD||e===a.TH&&t===i.HTML)break}};l.prototype.popAllUpToHtmlElement=function(){this.stackTop=0;this._updateCurrentElement()};l.prototype.clearBackToTableContext=function(){while(this.currentTagName!==a.TABLE&&this.currentTagName!==a.TEMPLATE&&this.currentTagName!==a.HTML||this.treeAdapter.getNamespaceURI(this.current)!==i.HTML)this.pop()};l.prototype.clearBackToTableBodyContext=function(){while(this.currentTagName!==a.TBODY&&this.currentTagName!==a.TFOOT&&this.currentTagName!==a.THEAD&&this.currentTagName!==a.TEMPLATE&&this.currentTagName!==a.HTML||this.treeAdapter.getNamespaceURI(this.current)!==i.HTML)this.pop()};l.prototype.clearBackToTableRowContext=function(){while(this.currentTagName!==a.TR&&this.currentTagName!==a.TEMPLATE&&this.currentTagName!==a.HTML||this.treeAdapter.getNamespaceURI(this.current)!==i.HTML)this.pop()};l.prototype.remove=function(e){for(var t=this.stackTop;t>=0;t--){if(this.items[t]===e){this.items.splice(t,1);this.stackTop--;this._updateCurrentElement();break}}};l.prototype.tryPeekProperlyNestedBodyElement=function(){var e=this.items[1];return e&&this.treeAdapter.getTagName(e)===a.BODY?e:null};l.prototype.contains=function(e){return this._indexOf(e)>-1};l.prototype.getCommonAncestor=function(e){var t=this._indexOf(e);return--t>=0?this.items[t]:null};l.prototype.isRootHtmlElementCurrent=function(){return this.stackTop===0&&this.currentTagName===a.HTML};l.prototype.hasInScope=function(e){for(var t=this.stackTop;t>=0;t--){var r=this.treeAdapter.getTagName(this.items[t]),n=this.treeAdapter.getNamespaceURI(this.items[t]);if(r===e&&n===i.HTML)return true;if(s(r,n))return false}return true};l.prototype.hasNumberedHeaderInScope=function(){for(var e=this.stackTop;e>=0;e--){var t=this.treeAdapter.getTagName(this.items[e]),r=this.treeAdapter.getNamespaceURI(this.items[e]);if((t===a.H1||t===a.H2||t===a.H3||t===a.H4||t===a.H5||t===a.H6)&&r===i.HTML)return true;if(s(t,r))return false}return true};l.prototype.hasInListItemScope=function(e){for(var t=this.stackTop;t>=0;t--){var r=this.treeAdapter.getTagName(this.items[t]),n=this.treeAdapter.getNamespaceURI(this.items[t]);if(r===e&&n===i.HTML)return true;if((r===a.UL||r===a.OL)&&n===i.HTML||s(r,n))return false}return true};l.prototype.hasInButtonScope=function(e){for(var t=this.stackTop;t>=0;t--){var r=this.treeAdapter.getTagName(this.items[t]),n=this.treeAdapter.getNamespaceURI(this.items[t]);if(r===e&&n===i.HTML)return true;if(r===a.BUTTON&&n===i.HTML||s(r,n))return false}return true};l.prototype.hasInTableScope=function(e){for(var t=this.stackTop;t>=0;t--){var r=this.treeAdapter.getTagName(this.items[t]),n=this.treeAdapter.getNamespaceURI(this.items[t]);if(n!==i.HTML)continue;if(r===e)return true;if(r===a.TABLE||r===a.TEMPLATE||r===a.HTML)return false}return true};l.prototype.hasTableBodyContextInTableScope=function(){for(var e=this.stackTop;e>=0;e--){var t=this.treeAdapter.getTagName(this.items[e]),r=this.treeAdapter.getNamespaceURI(this.items[e]);if(r!==i.HTML)continue;if(t===a.TBODY||t===a.THEAD||t===a.TFOOT)return true;if(t===a.TABLE||t===a.HTML)return false}return true};l.prototype.hasInSelectScope=function(e){for(var t=this.stackTop;t>=0;t--){var r=this.treeAdapter.getTagName(this.items[t]),n=this.treeAdapter.getNamespaceURI(this.items[t]);if(n!==i.HTML)continue;if(r===e)return true;if(r!==a.OPTION&&r!==a.OPTGROUP)return false}return true};l.prototype.generateImpliedEndTags=function(){while(o(this.currentTagName))this.pop()};l.prototype.generateImpliedEndTagsWithExclusion=function(e){while(o(this.currentTagName)&&this.currentTagName!==e)this.pop()}},203:function(e,t,r){"use strict";var n=r(82),a=r(68);var i=a.TAG_NAMES,o=a.NAMESPACES,s=a.ATTRS;var l={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"};var u="definitionurl",c="definitionURL",f={attributename:"attributeName",attributetype:"attributeType",basefrequency:"baseFrequency",baseprofile:"baseProfile",calcmode:"calcMode",clippathunits:"clipPathUnits",diffuseconstant:"diffuseConstant",edgemode:"edgeMode",filterunits:"filterUnits",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",limitingconeangle:"limitingConeAngle",markerheight:"markerHeight",markerunits:"markerUnits",markerwidth:"markerWidth",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",numoctaves:"numOctaves",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",refx:"refX",refy:"refY",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",specularconstant:"specularConstant",specularexponent:"specularExponent",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stitchtiles:"stitchTiles",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textlength:"textLength",viewbox:"viewBox",viewtarget:"viewTarget",xchannelselector:"xChannelSelector",ychannelselector:"yChannelSelector",zoomandpan:"zoomAndPan"},h={"xlink:actuate":{prefix:"xlink",name:"actuate",namespace:o.XLINK},"xlink:arcrole":{prefix:"xlink",name:"arcrole",namespace:o.XLINK},"xlink:href":{prefix:"xlink",name:"href",namespace:o.XLINK},"xlink:role":{prefix:"xlink",name:"role",namespace:o.XLINK},"xlink:show":{prefix:"xlink",name:"show",namespace:o.XLINK},"xlink:title":{prefix:"xlink",name:"title",namespace:o.XLINK},"xlink:type":{prefix:"xlink",name:"type",namespace:o.XLINK},"xml:base":{prefix:"xml",name:"base",namespace:o.XML},"xml:lang":{prefix:"xml",name:"lang",namespace:o.XML},"xml:space":{prefix:"xml",name:"space",namespace:o.XML},xmlns:{prefix:"",name:"xmlns",namespace:o.XMLNS},"xmlns:xlink":{prefix:"xmlns",name:"xlink",namespace:o.XMLNS}};var p=t.SVG_TAG_NAMES_ADJUSTMENT_MAP={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient",textpath:"textPath"};var d={};d[i.B]=true;d[i.BIG]=true;d[i.BLOCKQUOTE]=true;d[i.BODY]=true;d[i.BR]=true;d[i.CENTER]=true;d[i.CODE]=true;d[i.DD]=true;d[i.DIV]=true;d[i.DL]=true;d[i.DT]=true;d[i.EM]=true;d[i.EMBED]=true;d[i.H1]=true;d[i.H2]=true;d[i.H3]=true;d[i.H4]=true;d[i.H5]=true;d[i.H6]=true;d[i.HEAD]=true;d[i.HR]=true;d[i.I]=true;d[i.IMG]=true;d[i.LI]=true;d[i.LISTING]=true;d[i.MENU]=true;d[i.META]=true;d[i.NOBR]=true;d[i.OL]=true;d[i.P]=true;d[i.PRE]=true;d[i.RUBY]=true;d[i.S]=true;d[i.SMALL]=true;d[i.SPAN]=true;d[i.STRONG]=true;d[i.STRIKE]=true;d[i.SUB]=true;d[i.SUP]=true;d[i.TABLE]=true;d[i.TT]=true;d[i.U]=true;d[i.UL]=true;d[i.VAR]=true;t.causesExit=function(e){var t=e.tagName;var r=t===i.FONT&&(n.getTokenAttr(e,s.COLOR)!==null||n.getTokenAttr(e,s.SIZE)!==null||n.getTokenAttr(e,s.FACE)!==null);return r?true:d[t]};t.adjustTokenMathMLAttrs=function(e){for(var t=0;t<e.attrs.length;t++){if(e.attrs[t].name===u){e.attrs[t].name=c;break}}};t.adjustTokenSVGAttrs=function(e){for(var t=0;t<e.attrs.length;t++){var r=f[e.attrs[t].name];if(r)e.attrs[t].name=r}};t.adjustTokenXMLAttrs=function(e){for(var t=0;t<e.attrs.length;t++){var r=h[e.attrs[t].name];if(r){e.attrs[t].prefix=r.prefix;e.attrs[t].name=r.name;e.attrs[t].namespace=r.namespace}}};t.adjustTokenSVGTagName=function(e){var t=p[e.tagName];if(t)e.tagName=t};function v(e,t){return t===o.MATHML&&(e===i.MI||e===i.MO||e===i.MN||e===i.MS||e===i.MTEXT)}function m(e,t,r){if(t===o.MATHML&&e===i.ANNOTATION_XML){for(var n=0;n<r.length;n++){if(r[n].name===s.ENCODING){var a=r[n].value.toLowerCase();return a===l.TEXT_HTML||a===l.APPLICATION_XML}}}return t===o.SVG&&(e===i.FOREIGN_OBJECT||e===i.DESC||e===i.TITLE)}t.isIntegrationPoint=function(e,t,r,n){if((!n||n===o.HTML)&&m(e,t,r))return true;if((!n||n===o.MATHML)&&v(e,t))return true;return false}},204:function(e,t,r){"use strict";var n=r(133),a=r(134),i=r(135),o=r(68);var s=o.TAG_NAMES,l=o.NAMESPACES;var u={treeAdapter:n};var c=/&/g,f=/\u00a0/g,h=/"/g,p=/</g,d=/>/g;var v=e.exports=function(e,t){this.options=i(u,t);this.treeAdapter=this.options.treeAdapter;this.html="";this.startNode=e};v.escapeString=function(e,t){e=e.replace(c,"&amp;").replace(f,"&nbsp;");if(t)e=e.replace(h,"&quot;");else{e=e.replace(p,"&lt;").replace(d,"&gt;")}return e};v.prototype.serialize=function(){this._serializeChildNodes(this.startNode);return this.html};v.prototype._serializeChildNodes=function(e){var t=this.treeAdapter.getChildNodes(e);if(t){for(var r=0,n=t.length;r<n;r++){var a=t[r];if(this.treeAdapter.isElementNode(a))this._serializeElement(a);else if(this.treeAdapter.isTextNode(a))this._serializeTextNode(a);else if(this.treeAdapter.isCommentNode(a))this._serializeCommentNode(a);else if(this.treeAdapter.isDocumentTypeNode(a))this._serializeDocumentTypeNode(a)}}};v.prototype._serializeElement=function(e){var t=this.treeAdapter.getTagName(e),r=this.treeAdapter.getNamespaceURI(e);this.html+="<"+t;this._serializeAttributes(e);this.html+=">";if(t!==s.AREA&&t!==s.BASE&&t!==s.BASEFONT&&t!==s.BGSOUND&&t!==s.BR&&t!==s.BR&&t!==s.COL&&t!==s.EMBED&&t!==s.FRAME&&t!==s.HR&&t!==s.IMG&&t!==s.INPUT&&t!==s.KEYGEN&&t!==s.LINK&&t!==s.MENUITEM&&t!==s.META&&t!==s.PARAM&&t!==s.SOURCE&&t!==s.TRACK&&t!==s.WBR){if(t===s.PRE||t===s.TEXTAREA||t===s.LISTING){var n=this.treeAdapter.getFirstChild(e);if(n&&this.treeAdapter.isTextNode(n)){var a=this.treeAdapter.getTextNodeContent(n);if(a[0]==="\n")this.html+="\n"}}var i=t===s.TEMPLATE&&r===l.HTML?this.treeAdapter.getTemplateContent(e):e;this._serializeChildNodes(i);this.html+="</"+t+">"}};v.prototype._serializeAttributes=function(e){var t=this.treeAdapter.getAttrList(e);for(var r=0,n=t.length;r<n;r++){var a=t[r],i=v.escapeString(a.value,true);this.html+=" ";if(!a.namespace)this.html+=a.name;else if(a.namespace===l.XML)this.html+="xml:"+a.name;else if(a.namespace===l.XMLNS){if(a.name!=="xmlns")this.html+="xmlns:";this.html+=a.name}else if(a.namespace===l.XLINK)this.html+="xlink:"+a.name;else this.html+=a.namespace+":"+a.name;this.html+='="'+i+'"'}};v.prototype._serializeTextNode=function(e){var t=this.treeAdapter.getTextNodeContent(e),r=this.treeAdapter.getParentNode(e),n=void 0;if(r&&this.treeAdapter.isElementNode(r))n=this.treeAdapter.getTagName(r);if(n===s.STYLE||n===s.SCRIPT||n===s.XMP||n===s.IFRAME||n===s.NOEMBED||n===s.NOFRAMES||n===s.PLAINTEXT||n===s.NOSCRIPT)this.html+=t;else this.html+=v.escapeString(t,false)};v.prototype._serializeCommentNode=function(e){this.html+="\x3c!--"+this.treeAdapter.getCommentNodeContent(e)+"--\x3e"};v.prototype._serializeDocumentTypeNode=function(e){var t=this.treeAdapter.getDocumentTypeNodeName(e),r=this.treeAdapter.getDocumentTypeNodePublicId(e),n=this.treeAdapter.getDocumentTypeNodeSystemId(e);this.html+="<"+a.serializeContent(t,r,n)+">"}},28:function(e,t,r){"use strict";var n=r(43);var a=Object.keys||function(e){var t=[];for(var r in e){t.push(r)}return t};e.exports=f;var i=Object.create(r(35));i.inherits=r(10);var o=r(84);var s=r(59);i.inherits(f,o);{var l=a(s.prototype);for(var u=0;u<l.length;u++){var c=l[u];if(!f.prototype[c])f.prototype[c]=s.prototype[c]}}function f(e){if(!(this instanceof f))return new f(e);o.call(this,e);s.call(this,e);if(e&&e.readable===false)this.readable=false;if(e&&e.writable===false)this.writable=false;this.allowHalfOpen=true;if(e&&e.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",h)}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:false,get:function(){return this._writableState.highWaterMark}});function h(){if(this.allowHalfOpen||this._writableState.ended)return;n.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(f.prototype,"destroyed",{get:function(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function(e){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=e;this._writableState.destroyed=e}});f.prototype._destroy=function(e,t){this.push(null);this.end();n.nextTick(t,e)}},35:function(e,t,r){(function(e){function r(e){if(Array.isArray){return Array.isArray(e)}return m(e)==="[object Array]"}t.isArray=r;function n(e){return typeof e==="boolean"}t.isBoolean=n;function a(e){return e===null}t.isNull=a;function i(e){return e==null}t.isNullOrUndefined=i;function o(e){return typeof e==="number"}t.isNumber=o;function s(e){return typeof e==="string"}t.isString=s;function l(e){return typeof e==="symbol"}t.isSymbol=l;function u(e){return e===void 0}t.isUndefined=u;function c(e){return m(e)==="[object RegExp]"}t.isRegExp=c;function f(e){return typeof e==="object"&&e!==null}t.isObject=f;function h(e){return m(e)==="[object Date]"}t.isDate=h;function p(e){return m(e)==="[object Error]"||e instanceof Error}t.isError=p;function d(e){return typeof e==="function"}t.isFunction=d;function v(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}t.isPrimitive=v;t.isBuffer=e.isBuffer;function m(e){return Object.prototype.toString.call(e)}}).call(this,r(19).Buffer)},42:function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols;var a=Object.prototype.hasOwnProperty;var i=Object.prototype.propertyIsEnumerable;function o(e){if(e===null||e===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(e)}function s(){try{if(!Object.assign){return false}var e=new String("abc");e[5]="de";if(Object.getOwnPropertyNames(e)[0]==="5"){return false}var t={};for(var r=0;r<10;r++){t["_"+String.fromCharCode(r)]=r}var n=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if(n.join("")!=="0123456789"){return false}var a={};"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e});if(Object.keys(Object.assign({},a)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(e){return false}}e.exports=s()?Object.assign:function(e,t){var r;var s=o(e);var l;for(var u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r){if(a.call(r,c)){s[c]=r[c]}}if(n){l=n(r);for(var f=0;f<l.length;f++){if(i.call(r,l[f])){s[l[f]]=r[l[f]]}}}}return s}},43:function(e,t,r){"use strict";(function(t){if(typeof t==="undefined"||!t.version||t.version.indexOf("v0.")===0||t.version.indexOf("v1.")===0&&t.version.indexOf("v1.8.")!==0){e.exports={nextTick:r}}else{e.exports=t}function r(e,r,n,a){if(typeof e!=="function"){throw new TypeError('"callback" argument must be a function')}var i=arguments.length;var o,s;switch(i){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function t(){e.call(null,r)});case 3:return t.nextTick(function t(){e.call(null,r,n)});case 4:return t.nextTick(function t(){e.call(null,r,n,a)});default:o=new Array(i-1);s=0;while(s<o.length){o[s++]=arguments[s]}return t.nextTick(function t(){e.apply(null,o)})}}}).call(this,r(17))},481:function(e,t,r){"use strict";const n=r(535);const a=r(547);const i=r(8);const o=r(548).v4;const s=!!(document&&window);const l=e=>{if(e.tagName&&e.tagName==="script"){return(e.childNodes||[]).map(e=>e.value)}return a((e.childNodes||[]).map(l))};class u extends i.Component{constructor(e,t){super(e,t);this.state=this.initialState(e)}clean(){if(!this.state.id||!s){return}const e=document.getElementById(this.state.id);if(!e){return}while(e.hasChildNodes()){e.removeChild(e.lastChild)}}parse(e){const t=(e||{}).html;if(!t||typeof t!=="string"){return}return l(n.parseFragment(t))}initialState(e){return{id:(this.state||{}).id||o(),scripts:this.parse(e)}}shouldComponentUpdate(e){return this.props.html!==e.html}componentWillReceiveProps(e){if(this.props.html===e.html){return}this.clean();this.setState(this.initialState(e))}componentDidMount(){this.componentDidUpdate()}componentDidUpdate(){const e=(this.state||{}).scripts||[];var t=e.map(e=>{return new Function("require",e)}).forEach(e=>{return e()})}render(){if(typeof this.props.html!=="string"){return null}return i.createElement("div",{id:this.state.id,dangerouslySetInnerHTML:{__html:this.props.html}})}}t["a"]=u},482:function(e,t,r){var n,a,i;(function(r,o){if(true){!(a=[t],n=o,i=typeof n==="function"?n.apply(t,a):n,i!==undefined&&(e.exports=i))}else{var s}})(this,function(e){"use strict";var t=this&&this.__makeTemplateObject||function(e,t){if(Object.defineProperty){Object.defineProperty(e,"raw",{value:t})}else{e.raw=t}return e};var r;(function(e){e[e["EOS"]=0]="EOS";e[e["Text"]=1]="Text";e[e["Incomplete"]=2]="Incomplete";e[e["ESC"]=3]="ESC";e[e["Unknown"]=4]="Unknown";e[e["SGR"]=5]="SGR";e[e["OSCURL"]=6]="OSCURL"})(r||(r={}));var n=function(){function e(){this.VERSION="4.0.4";this.setup_palettes();this._use_classes=false;this._escape_for_html=true;this.bold=false;this.fg=this.bg=null;this._buffer="";this._url_whitelist={http:1,https:1}}Object.defineProperty(e.prototype,"use_classes",{get:function(){return this._use_classes},set:function(e){this._use_classes=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"escape_for_html",{get:function(){return this._escape_for_html},set:function(e){this._escape_for_html=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"url_whitelist",{get:function(){return this._url_whitelist},set:function(e){this._url_whitelist=e},enumerable:true,configurable:true});e.prototype.setup_palettes=function(){var e=this;this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]];this.palette_256=[];this.ansi_colors.forEach(function(t){t.forEach(function(t){e.palette_256.push(t)})});var t=[0,95,135,175,215,255];for(var r=0;r<6;++r){for(var n=0;n<6;++n){for(var a=0;a<6;++a){var i={rgb:[t[r],t[n],t[a]],class_name:"truecolor"};this.palette_256.push(i)}}}var o=8;for(var s=0;s<24;++s,o+=10){var l={rgb:[o,o,o],class_name:"truecolor"};this.palette_256.push(l)}};e.prototype.escape_txt_for_html=function(e){return e.replace(/[&<>]/gm,function(e){if(e==="&")return"&amp;";if(e==="<")return"&lt;";if(e===">")return"&gt;"})};e.prototype.append_buffer=function(e){var t=this._buffer+e;this._buffer=t};e.prototype.get_next_packet=function(){var e={kind:r.EOS,text:"",url:""};var n=this._buffer.length;if(n==0)return e;var o=this._buffer.indexOf("");if(o==-1){e.kind=r.Text;e.text=this._buffer;this._buffer="";return e}if(o>0){e.kind=r.Text;e.text=this._buffer.slice(0,o);this._buffer=this._buffer.slice(o);return e}if(o==0){if(n==1){e.kind=r.Incomplete;return e}var s=this._buffer.charAt(1);if(s!="["&&s!="]"){e.kind=r.ESC;e.text=this._buffer.slice(0,1);this._buffer=this._buffer.slice(1);return e}if(s=="["){if(!this._csi_regex){this._csi_regex=a(t(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          [                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          [                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-:])              # anything illegal\n                        )\n                    "],["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]))}var l=this._buffer.match(this._csi_regex);if(l===null){e.kind=r.Incomplete;return e}if(l[4]){e.kind=r.ESC;e.text=this._buffer.slice(0,1);this._buffer=this._buffer.slice(1);return e}if(l[1]!=""||l[3]!="m")e.kind=r.Unknown;else e.kind=r.SGR;e.text=l[2];var u=l[0].length;this._buffer=this._buffer.slice(u);return e}if(s=="]"){if(n<4){e.kind=r.Incomplete;return e}if(this._buffer.charAt(2)!="8"||this._buffer.charAt(3)!=";"){e.kind=r.ESC;e.text=this._buffer.slice(0,1);this._buffer=this._buffer.slice(1);return e}if(!this._osc_st){this._osc_st=i(t(["\n                        (?:                         # legal sequence\n                          (\\)                    # ESC                           |                           # alternate\n                          ()                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-]                 # anything illegal\n                          |                           # alternate\n                          [\b-]                 # anything illegal\n                          |                           # alternate\n                          [-]                 # anything illegal\n                        )\n                    "],["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]))}this._osc_st.lastIndex=0;{var c=this._osc_st.exec(this._buffer);if(c===null){e.kind=r.Incomplete;return e}if(c[3]){e.kind=r.ESC;e.text=this._buffer.slice(0,1);this._buffer=this._buffer.slice(1);return e}}{var f=this._osc_st.exec(this._buffer);if(f===null){e.kind=r.Incomplete;return e}if(f[3]){e.kind=r.ESC;e.text=this._buffer.slice(0,1);this._buffer=this._buffer.slice(1);return e}}if(!this._osc_regex){this._osc_regex=a(t(["\n                        ^                           # beginning of line\n                                                    #\n                        ]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\)                  # ESC                           |                           # alternate\n                          (?:)                    # BEL (what xterm did)\n                        )\n                        ([!-~]+)              # TEXT capture\n                        ]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\)                  # ESC                           |                           # alternate\n                          (?:)                    # BEL (what xterm did)\n                        )\n                    "],["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x21-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]))}var l=this._buffer.match(this._osc_regex);if(l===null){e.kind=r.ESC;e.text=this._buffer.slice(0,1);this._buffer=this._buffer.slice(1);return e}e.kind=r.OSCURL;e.url=l[1];e.text=l[2];var u=l[0].length;this._buffer=this._buffer.slice(u);return e}}};e.prototype.ansi_to_html=function(e){this.append_buffer(e);var t=[];while(true){var n=this.get_next_packet();if(n.kind==r.EOS||n.kind==r.Incomplete)break;if(n.kind==r.ESC||n.kind==r.Unknown)continue;if(n.kind==r.Text)t.push(this.transform_to_html(this.with_state(n)));else if(n.kind==r.SGR)this.process_ansi(n);else if(n.kind==r.OSCURL)t.push(this.process_hyperlink(n))}return t.join("")};e.prototype.with_state=function(e){return{bold:this.bold,fg:this.fg,bg:this.bg,text:e.text}};e.prototype.process_ansi=function(e){var t=e.text.split(";");while(t.length>0){var r=t.shift();var n=parseInt(r,10);if(isNaN(n)||n===0){this.fg=this.bg=null;this.bold=false}else if(n===1){this.bold=true}else if(n===22){this.bold=false}else if(n===39){this.fg=null}else if(n===49){this.bg=null}else if(n>=30&&n<38){this.fg=this.ansi_colors[0][n-30]}else if(n>=40&&n<48){this.bg=this.ansi_colors[0][n-40]}else if(n>=90&&n<98){this.fg=this.ansi_colors[1][n-90]}else if(n>=100&&n<108){this.bg=this.ansi_colors[1][n-100]}else if(n===38||n===48){if(t.length>0){var a=n===38;var i=t.shift();if(i==="5"&&t.length>0){var o=parseInt(t.shift(),10);if(o>=0&&o<=255){if(a)this.fg=this.palette_256[o];else this.bg=this.palette_256[o]}}if(i==="2"&&t.length>2){var s=parseInt(t.shift(),10);var l=parseInt(t.shift(),10);var u=parseInt(t.shift(),10);if(s>=0&&s<=255&&(l>=0&&l<=255)&&(u>=0&&u<=255)){var c={rgb:[s,l,u],class_name:"truecolor"};if(a)this.fg=c;else this.bg=c}}}}}};e.prototype.transform_to_html=function(e){var t=e.text;if(t.length===0)return t;if(this._escape_for_html)t=this.escape_txt_for_html(t);if(!e.bold&&e.fg===null&&e.bg===null)return t;var r=[];var n=[];var a=e.fg;var i=e.bg;if(e.bold)r.push("font-weight:bold");if(!this._use_classes){if(a)r.push("color:rgb("+a.rgb.join(",")+")");if(i)r.push("background-color:rgb("+i.rgb+")")}else{if(a){if(a.class_name!=="truecolor"){n.push(a.class_name+"-fg")}else{r.push("color:rgb("+a.rgb.join(",")+")")}}if(i){if(i.class_name!=="truecolor"){n.push(i.class_name+"-bg")}else{r.push("background-color:rgb("+i.rgb.join(",")+")")}}}var o="";var s="";if(n.length)o=' class="'+n.join(" ")+'"';if(r.length)s=' style="'+r.join(";")+'"';return"<span"+s+o+">"+t+"</span>"};e.prototype.process_hyperlink=function(e){var t=e.url.split(":");if(t.length<1)return"";if(!this._url_whitelist[t[0]])return"";var r='<a href="'+this.escape_txt_for_html(e.url)+'">'+this.escape_txt_for_html(e.text)+"</a>";return r};return e}();function a(e){var t=[];for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}var n=e.raw[0];var a=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;var i=n.replace(a,"");return new RegExp(i)}function i(e){var t=[];for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}var n=e.raw[0];var a=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;var i=n.replace(a,"");return new RegExp(i,"g")}Object.defineProperty(e,"__esModule",{value:true});e.default=n})},483:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(56);var a=r(80);var i=r(65);class o{constructor(e){this.elements=new Map;this.prevTopHeight=new Map;this.timeout=undefined;this.javaApi=e}start(){this.observer=new i(()=>{this.scheduleRecalculate()})}scheduleRecalculate(){if(this.timeout){clearTimeout(this.timeout)}this.timeout=setTimeout(()=>{this.notify()},500)}notify(){const e=[];for(let[t,r]of this.elements){const n=r.offsetTop;const a=r.offsetHeight;const i=this.prevTopHeight.get(t);if(n===i.top&&a===i.height){continue}if(a>0){e.push({index:t,top:n,height:a})}this.prevTopHeight.set(t,{top:n,height:a})}if(e.length>0){this.javaApi.reportCellTopHeight(e)}}addCell(e,t){this.prevTopHeight.set(e,{top:-1,height:-1});this.elements.set(e,t);this.observer.observe(t);this.scheduleRecalculate()}removeCell(e,t){this.prevTopHeight.delete(e);this.observer.unobserve(t);this.elements.delete(e);this.scheduleRecalculate()}}},484:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=void 0;var n=i(r(550));var a=i(r(554));function i(e){return e&&e.__esModule?e:{default:e}}var o=(0,n["default"])(a["default"]);var s=o;t["default"]=s},51:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var n=r(129);var a=r(66);var i=r.n(a);var o=r(106);class s{constructor(){this.mimeTypes={"application/javascript":e=>({afterRenderUnsafe:String(e)})};this.initListeners=[];this.api={MessageManager:a["instance"],showCellOutput:o["b"],comm:{Comm:n["a"],registerTarget:n["b"]}}}registerType(e,t){this.mimeTypes[String(e)]=t}getFunctionForOutput(e,t){const r=Object.entries(this.mimeTypes).find(([t,r])=>e.hasOwnProperty(String(t)));if(r===undefined){return}const[n,a]=r;return()=>{return a(e[String(n)],e,t)}}}const l=new s},52:function(e,t,r){e.exports=i;var n=r(53).EventEmitter;var a=r(10);a(i,n);i.Readable=r(58);i.Writable=r(143);i.Duplex=r(144);i.Transform=r(145);i.PassThrough=r(146);i.Stream=i;function i(){n.call(this)}i.prototype.pipe=function(e,t){var r=this;function a(t){if(e.writable){if(false===e.write(t)&&r.pause){r.pause()}}}r.on("data",a);function i(){if(r.readable&&r.resume){r.resume()}}e.on("drain",i);if(!e._isStdio&&(!t||t.end!==false)){r.on("end",s);r.on("close",l)}var o=false;function s(){if(o)return;o=true;e.end()}function l(){if(o)return;o=true;if(typeof e.destroy==="function")e.destroy()}function u(e){c();if(n.listenerCount(this,"error")===0){throw e}}r.on("error",u);e.on("error",u);function c(){r.removeListener("data",a);e.removeListener("drain",i);r.removeListener("end",s);r.removeListener("close",l);r.removeListener("error",u);e.removeListener("error",u);r.removeListener("end",c);r.removeListener("close",c);e.removeListener("close",c)}r.on("end",c);r.on("close",c);e.on("close",c);e.emit("pipe",r);return e}},53:function(e,t,r){"use strict";var n=typeof Reflect==="object"?Reflect:null;var a=n&&typeof n.apply==="function"?n.apply:function e(t,r,n){return Function.prototype.apply.call(t,r,n)};var i;if(n&&typeof n.ownKeys==="function"){i=n.ownKeys}else if(Object.getOwnPropertySymbols){i=function e(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}}else{i=function e(t){return Object.getOwnPropertyNames(t)}}function o(e){if(console&&console.warn)console.warn(e)}var s=Number.isNaN||function e(t){return t!==t};function l(){l.init.call(this)}e.exports=l;l.EventEmitter=l;l.prototype._events=undefined;l.prototype._eventsCount=0;l.prototype._maxListeners=undefined;var u=10;function c(e){if(typeof e!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:true,get:function(){return u},set:function(e){if(typeof e!=="number"||e<0||s(e)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".")}u=e}});l.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};l.prototype.setMaxListeners=function e(t){if(typeof t!=="number"||t<0||s(t)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".")}this._maxListeners=t;return this};function f(e){if(e._maxListeners===undefined)return l.defaultMaxListeners;return e._maxListeners}l.prototype.getMaxListeners=function e(){return f(this)};l.prototype.emit=function e(t){var r=[];for(var n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error";var o=this._events;if(o!==undefined)i=i&&o.error===undefined;else if(!i)return false;if(i){var s;if(r.length>0)s=r[0];if(s instanceof Error){throw s}var l=new Error("Unhandled error."+(s?" ("+s.message+")":""));l.context=s;throw l}var u=o[t];if(u===undefined)return false;if(typeof u==="function"){a(u,this,r)}else{var c=u.length;var f=g(u,c);for(var n=0;n<c;++n)a(f[n],this,r)}return true};function h(e,t,r,n){var a;var i;var s;c(r);i=e._events;if(i===undefined){i=e._events=Object.create(null);e._eventsCount=0}else{if(i.newListener!==undefined){e.emit("newListener",t,r.listener?r.listener:r);i=e._events}s=i[t]}if(s===undefined){s=i[t]=r;++e._eventsCount}else{if(typeof s==="function"){s=i[t]=n?[r,s]:[s,r]}else if(n){s.unshift(r)}else{s.push(r)}a=f(e);if(a>0&&s.length>a&&!s.warned){s.warned=true;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");l.name="MaxListenersExceededWarning";l.emitter=e;l.type=t;l.count=s.length;o(l)}}return e}l.prototype.addListener=function e(t,r){return h(this,t,r,false)};l.prototype.on=l.prototype.addListener;l.prototype.prependListener=function e(t,r){return h(this,t,r,true)};function p(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function d(e,t,r){var n={fired:false,wrapFn:undefined,target:e,type:t,listener:r};var a=p.bind(n);a.listener=r;n.wrapFn=a;return a}l.prototype.once=function e(t,r){c(r);this.on(t,d(this,t,r));return this};l.prototype.prependOnceListener=function e(t,r){c(r);this.prependListener(t,d(this,t,r));return this};l.prototype.removeListener=function e(t,r){var n,a,i,o,s;c(r);a=this._events;if(a===undefined)return this;n=a[t];if(n===undefined)return this;if(n===r||n.listener===r){if(--this._eventsCount===0)this._events=Object.create(null);else{delete a[t];if(a.removeListener)this.emit("removeListener",t,n.listener||r)}}else if(typeof n!=="function"){i=-1;for(o=n.length-1;o>=0;o--){if(n[o]===r||n[o].listener===r){s=n[o].listener;i=o;break}}if(i<0)return this;if(i===0)n.shift();else{y(n,i)}if(n.length===1)a[t]=n[0];if(a.removeListener!==undefined)this.emit("removeListener",t,s||r)}return this};l.prototype.off=l.prototype.removeListener;l.prototype.removeAllListeners=function e(t){var r,n,a;n=this._events;if(n===undefined)return this;if(n.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(n[t]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete n[t]}return this}if(arguments.length===0){var i=Object.keys(n);var o;for(a=0;a<i.length;++a){o=i[a];if(o==="removeListener")continue;this.removeAllListeners(o)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}r=n[t];if(typeof r==="function"){this.removeListener(t,r)}else if(r!==undefined){for(a=r.length-1;a>=0;a--){this.removeListener(t,r[a])}}return this};function v(e,t,r){var n=e._events;if(n===undefined)return[];var a=n[t];if(a===undefined)return[];if(typeof a==="function")return r?[a.listener||a]:[a];return r?x(a):g(a,a.length)}l.prototype.listeners=function e(t){return v(this,t,true)};l.prototype.rawListeners=function e(t){return v(this,t,false)};l.listenerCount=function(e,t){if(typeof e.listenerCount==="function"){return e.listenerCount(t)}else{return m.call(e,t)}};l.prototype.listenerCount=m;function m(e){var t=this._events;if(t!==undefined){var r=t[e];if(typeof r==="function"){return 1}else if(r!==undefined){return r.length}}return 0}l.prototype.eventNames=function e(){return this._eventsCount>0?i(this._events):[]};function g(e,t){var r=new Array(t);for(var n=0;n<t;++n)r[n]=e[n];return r}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function x(e){var t=new Array(e.length);for(var r=0;r<t.length;++r){t[r]=e[r].listener||e[r]}return t}},532:function(e,t,r){"use strict";
/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(8),a=r(42),i=r(533);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!n)throw Error(o(227));function s(e,t,r,n,a,i,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(e){this.onError(e)}}var l=!1,u=null,c=!1,f=null,h={onError:function(e){l=!0;u=e}};function p(e,t,r,n,a,i,o,c,f){l=!1;u=null;s.apply(h,arguments)}function d(e,t,r,n,a,i,s,h,d){p.apply(this,arguments);if(l){if(l){var v=u;l=!1;u=null}else throw Error(o(198));c||(c=!0,f=v)}}var v=null,m=null,g=null;function y(e,t,r){var n=e.type||"unknown-event";e.currentTarget=g(r);d(n,t,void 0,e);e.currentTarget=null}var x=null,_={};function b(){if(x)for(var e in _){var t=_[e],r=x.indexOf(e);if(!(-1<r))throw Error(o(96,e));if(!T[r]){if(!t.extractEvents)throw Error(o(97,e));T[r]=t;r=t.eventTypes;for(var n in r){var a=void 0;var i=r[n],s=t,l=n;if(k.hasOwnProperty(l))throw Error(o(99,l));k[l]=i;var u=i.phasedRegistrationNames;if(u){for(a in u)u.hasOwnProperty(a)&&w(u[a],s,l);a=!0}else i.registrationName?(w(i.registrationName,s,l),a=!0):a=!1;if(!a)throw Error(o(98,n,e))}}}}function w(e,t,r){if(A[e])throw Error(o(100,e));A[e]=t;M[e]=t.eventTypes[r].dependencies}var T=[],k={},A={},M={};function E(e){var t=!1,r;for(r in e)if(e.hasOwnProperty(r)){var n=e[r];if(!_.hasOwnProperty(r)||_[r]!==n){if(_[r])throw Error(o(102,r));_[r]=n;t=!0}}t&&b()}var S=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),C=null,L=null,I=null;function O(e){if(e=m(e)){if("function"!==typeof C)throw Error(o(280));var t=e.stateNode;t&&(t=v(t),C(e.stateNode,e.type,t))}}function P(e){L?I?I.push(e):I=[e]:L=e}function D(){if(L){var e=L,t=I;I=L=null;O(e);if(t)for(e=0;e<t.length;e++)O(t[e])}}function R(e,t){return e(t)}function z(e,t,r,n,a){return e(t,r,n,a)}function N(){}var F=R,B=!1,j=!1;function U(){if(null!==L||null!==I)N(),D()}function H(e,t,r){if(j)return e(t,r);j=!0;try{return F(e,t,r)}finally{j=!1,U()}}var V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G=Object.prototype.hasOwnProperty,q={},Y={};function W(e){if(G.call(Y,e))return!0;if(G.call(q,e))return!1;if(V.test(e))return Y[e]=!0;q[e]=!0;return!1}function X(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":if(n)return!1;if(null!==r)return!r.acceptsBooleans;e=e.toLowerCase().slice(0,5);return"data-"!==e&&"aria-"!==e;default:return!1}}function Z(e,t,r,n){if(null===t||"undefined"===typeof t||X(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function K(e,t,r,n,a,i){this.acceptsBooleans=2===t||3===t||4===t;this.attributeName=n;this.attributeNamespace=a;this.mustUseProperty=r;this.propertyName=e;this.type=t;this.sanitizeURL=i}var J={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){J[e]=new K(e,0,!1,e,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];J[t]=new K(t,1,!1,e[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){J[e]=new K(e,2,!1,e.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){J[e]=new K(e,2,!1,e,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){J[e]=new K(e,3,!1,e.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(e){J[e]=new K(e,3,!0,e,null,!1)});["capture","download"].forEach(function(e){J[e]=new K(e,4,!1,e,null,!1)});["cols","rows","size","span"].forEach(function(e){J[e]=new K(e,6,!1,e,null,!1)});["rowSpan","start"].forEach(function(e){J[e]=new K(e,5,!1,e.toLowerCase(),null,!1)});var Q=/[\-:]([a-z])/g;function $(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Q,$);J[t]=new K(t,1,!1,e,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Q,$);J[t]=new K(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Q,$);J[t]=new K(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(e){J[e]=new K(e,1,!1,e.toLowerCase(),null,!1)});J.xlinkHref=new K("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(e){J[e]=new K(e,1,!1,e.toLowerCase(),null,!0)});var ee=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;ee.hasOwnProperty("ReactCurrentDispatcher")||(ee.ReactCurrentDispatcher={current:null});ee.hasOwnProperty("ReactCurrentBatchConfig")||(ee.ReactCurrentBatchConfig={suspense:null});function te(e,t,r,n){var a=J.hasOwnProperty(t)?J[t]:null;var i=null!==a?0===a.type:n?!1:!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1]?!1:!0;i||(Z(t,r,a,n)&&(r=null),n||null===a?W(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3===a.type?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(a=a.type,r=3===a||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var re=/^(.*)[\\\/]/,ne="function"===typeof Symbol&&Symbol.for,ae=ne?Symbol.for("react.element"):60103,ie=ne?Symbol.for("react.portal"):60106,oe=ne?Symbol.for("react.fragment"):60107,se=ne?Symbol.for("react.strict_mode"):60108,le=ne?Symbol.for("react.profiler"):60114,ue=ne?Symbol.for("react.provider"):60109,ce=ne?Symbol.for("react.context"):60110,fe=ne?Symbol.for("react.concurrent_mode"):60111,he=ne?Symbol.for("react.forward_ref"):60112,pe=ne?Symbol.for("react.suspense"):60113,de=ne?Symbol.for("react.suspense_list"):60120,ve=ne?Symbol.for("react.memo"):60115,me=ne?Symbol.for("react.lazy"):60116,ge=ne?Symbol.for("react.block"):60121,ye="function"===typeof Symbol&&Symbol.iterator;function xe(e){if(null===e||"object"!==typeof e)return null;e=ye&&e[ye]||e["@@iterator"];return"function"===typeof e?e:null}function _e(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t();e._result=t;t.then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)})}}function be(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case oe:return"Fragment";case ie:return"Portal";case le:return"Profiler";case se:return"StrictMode";case pe:return"Suspense";case de:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case ce:return"Context.Consumer";case ue:return"Context.Provider";case he:var t=e.render;t=t.displayName||t.name||"";return e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ve:return be(e.type);case ge:return be(e.render);case me:if(e=1===e._status?e._result:null)return be(e)}return null}function we(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var r="";break e;default:var n=e._debugOwner,a=e._debugSource,i=be(e.type);r=null;n&&(r=be(n.type));n=i;i="";a?i=" (at "+a.fileName.replace(re,"")+":"+a.lineNumber+")":r&&(i=" (created by "+r+")");r="\n    in "+(n||"Unknown")+i}t+=r;e=e.return}while(e);return t}function Te(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function ke(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ae(e){var t=ke(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,i=r.set;Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e;i.call(this,e)}});Object.defineProperty(e,t,{enumerable:r.enumerable});return{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null;delete e[t]}}}}function Me(e){e._valueTracker||(e._valueTracker=Ae(e))}function Ee(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue();var n="";e&&(n=ke(e)?e.checked?"true":"false":e.value);e=n;return e!==r?(t.setValue(e),!0):!1}function Se(e,t){var r=t.checked;return a({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Ce(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Te(null!=t.value?t.value:r);e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Le(e,t){t=t.checked;null!=t&&te(e,"checked",t,!1)}function Ie(e,t){Le(e,t);var r=Te(t.value),n=t.type;if(null!=r)if("number"===n){if(0===r&&""===e.value||e.value!=r)e.value=""+r}else e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n){e.removeAttribute("value");return}t.hasOwnProperty("value")?Pe(e,t.type,r):t.hasOwnProperty("defaultValue")&&Pe(e,t.type,Te(t.defaultValue));null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Oe(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue;r||t===e.value||(e.value=t);e.defaultValue=t}r=e.name;""!==r&&(e.name="");e.defaultChecked=!!e._wrapperState.initialChecked;""!==r&&(e.name=r)}function Pe(e,t,r){if("number"!==t||e.ownerDocument.activeElement!==e)null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r)}function De(e){var t="";n.Children.forEach(e,function(e){null!=e&&(t+=e)});return t}function Re(e,t){e=a({children:void 0},t);if(t=De(t.children))e.children=t;return e}function ze(e,t,r,n){e=e.options;if(t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{r=""+Te(r);t=null;for(a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0;n&&(e[a].defaultSelected=!0);return}null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return a({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fe(e,t){var r=t.value;if(null==r){r=t.children;t=t.defaultValue;if(null!=r){if(null!=t)throw Error(o(92));if(Array.isArray(r)){if(!(1>=r.length))throw Error(o(93));r=r[0]}t=r}null==t&&(t="");r=t}e._wrapperState={initialValue:Te(r)}}function Be(e,t){var r=Te(t.value),n=Te(t.defaultValue);null!=r&&(r=""+r,r!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r));null!=n&&(e.defaultValue=""+n)}function je(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Ue={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function He(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ve(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?He(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Ge,qe=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!==Ue.svg||"innerHTML"in e)e.innerHTML=t;else{Ge=Ge||document.createElement("div");Ge.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";for(t=Ge.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ye(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType){r.nodeValue=t;return}}e.textContent=t}function We(e,t){var r={};r[e.toLowerCase()]=t.toLowerCase();r["Webkit"+e]="webkit"+t;r["Moz"+e]="moz"+t;return r}var Xe={animationend:We("Animation","AnimationEnd"),animationiteration:We("Animation","AnimationIteration"),animationstart:We("Animation","AnimationStart"),transitionend:We("Transition","TransitionEnd")},Ze={},Ke={};S&&(Ke=document.createElement("div").style,"AnimationEvent"in window||(delete Xe.animationend.animation,delete Xe.animationiteration.animation,delete Xe.animationstart.animation),"TransitionEvent"in window||delete Xe.transitionend.transition);function Je(e){if(Ze[e])return Ze[e];if(!Xe[e])return e;var t=Xe[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Ke)return Ze[e]=t[r];return e}var Qe=Je("animationend"),$e=Je("animationiteration"),et=Je("animationstart"),tt=Je("transitionend"),rt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nt=new("function"===typeof WeakMap?WeakMap:Map);function at(e){var t=nt.get(e);void 0===t&&(t=new Map,nt.set(e,t));return t}function it(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{t=e,0!==(t.effectTag&1026)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function ot(e){if(13===e.tag){var t=e.memoizedState;null===t&&(e=e.alternate,null!==e&&(t=e.memoizedState));if(null!==t)return t.dehydrated}return null}function st(e){if(it(e)!==e)throw Error(o(188))}function lt(e){var t=e.alternate;if(!t){t=it(e);if(null===t)throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var i=a.alternate;if(null===i){n=a.return;if(null!==n){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return st(a),e;if(i===n)return st(a),t;i=i.sibling}throw Error(o(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,l=a.child;l;){if(l===r){s=!0;r=a;n=i;break}if(l===n){s=!0;n=a;r=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===r){s=!0;r=i;n=a;break}if(l===n){s=!0;n=i;r=a;break}l=l.sibling}if(!s)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}function ut(e){e=lt(e);if(!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return;t=t.sibling}}return null}function ct(e,t){if(null==t)throw Error(o(30));if(null==e)return t;if(Array.isArray(e)){if(Array.isArray(t))return e.push.apply(e,t),e;e.push(t);return e}return Array.isArray(t)?[e].concat(t):[e,t]}function ft(e,t,r){Array.isArray(e)?e.forEach(t,r):e&&t.call(r,e)}var ht=null;function pt(e){if(e){var t=e._dispatchListeners,r=e._dispatchInstances;if(Array.isArray(t))for(var n=0;n<t.length&&!e.isPropagationStopped();n++)y(e,t[n],r[n]);else t&&y(e,t,r);e._dispatchListeners=null;e._dispatchInstances=null;e.isPersistent()||e.constructor.release(e)}}function dt(e){null!==e&&(ht=ct(ht,e));e=ht;ht=null;if(e){ft(e,pt);if(ht)throw Error(o(95));if(c)throw e=f,c=!1,f=null,e}}function vt(e){e=e.target||e.srcElement||window;e.correspondingUseElement&&(e=e.correspondingUseElement);return 3===e.nodeType?e.parentNode:e}function mt(e){if(!S)return!1;e="on"+e;var t=e in document;t||(t=document.createElement("div"),t.setAttribute(e,"return;"),t="function"===typeof t[e]);return t}var gt=[];function yt(e){e.topLevelType=null;e.nativeEvent=null;e.targetInst=null;e.ancestors.length=0;10>gt.length&&gt.push(e)}function xt(e,t,r,n){if(gt.length){var a=gt.pop();a.topLevelType=e;a.eventSystemFlags=n;a.nativeEvent=t;a.targetInst=r;return a}return{topLevelType:e,eventSystemFlags:n,nativeEvent:t,targetInst:r,ancestors:[]}}function _t(e){var t=e.targetInst,r=t;do{if(!r){e.ancestors.push(r);break}var n=r;if(3===n.tag)n=n.stateNode.containerInfo;else{for(;n.return;)n=n.return;n=3!==n.tag?null:n.stateNode.containerInfo}if(!n)break;t=r.tag;5!==t&&6!==t||e.ancestors.push(r);r=jr(n)}while(r);for(r=0;r<e.ancestors.length;r++){t=e.ancestors[r];var a=vt(e.nativeEvent);n=e.topLevelType;var i=e.nativeEvent,o=e.eventSystemFlags;0===r&&(o|=64);for(var s=null,l=0;l<T.length;l++){var u=T[l];u&&(u=u.extractEvents(n,t,i,a,o))&&(s=ct(s,u))}dt(s)}}function bt(e,t,r){if(!r.has(e)){switch(e){case"scroll":nr(t,"scroll",!0);break;case"focus":case"blur":nr(t,"focus",!0);nr(t,"blur",!0);r.set("blur",null);r.set("focus",null);break;case"cancel":case"close":mt(e)&&nr(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===rt.indexOf(e)&&rr(e,t)}r.set(e,null)}}var wt,Tt,kt,At=!1,Mt=[],Et=null,St=null,Ct=null,Lt=new Map,It=new Map,Ot=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Dt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Rt(e,t){var r=at(t);Pt.forEach(function(e){bt(e,t,r)});Dt.forEach(function(e){bt(e,t,r)})}function zt(e,t,r,n,a){return{blockedOn:e,topLevelType:t,eventSystemFlags:r|32,nativeEvent:a,container:n}}function Nt(e,t){switch(e){case"focus":case"blur":Et=null;break;case"dragenter":case"dragleave":St=null;break;case"mouseover":case"mouseout":Ct=null;break;case"pointerover":case"pointerout":Lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Ft(e,t,r,n,a,i){if(null===e||e.nativeEvent!==i)return e=zt(t,r,n,a,i),null!==t&&(t=Ur(t),null!==t&&Tt(t)),e;e.eventSystemFlags|=n;return e}function Bt(e,t,r,n,a){switch(t){case"focus":return Et=Ft(Et,e,t,r,n,a),!0;case"dragenter":return St=Ft(St,e,t,r,n,a),!0;case"mouseover":return Ct=Ft(Ct,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;Lt.set(i,Ft(Lt.get(i)||null,e,t,r,n,a));return!0;case"gotpointercapture":return i=a.pointerId,It.set(i,Ft(It.get(i)||null,e,t,r,n,a)),!0}return!1}function jt(e){var t=jr(e.target);if(null!==t){var r=it(t);if(null!==r)if(t=r.tag,13===t){if(t=ot(r),null!==t){e.blockedOn=t;i.unstable_runWithPriority(e.priority,function(){kt(r)});return}}else if(3===t&&r.stateNode.hydrate){e.blockedOn=3===r.tag?r.stateNode.containerInfo:null;return}}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;var t=sr(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var r=Ur(t);null!==r&&Tt(r);e.blockedOn=t;return!1}return!0}function Ht(e,t,r){Ut(e)&&r.delete(t)}function Vt(){for(At=!1;0<Mt.length;){var e=Mt[0];if(null!==e.blockedOn){e=Ur(e.blockedOn);null!==e&&wt(e);break}var t=sr(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:Mt.shift()}null!==Et&&Ut(Et)&&(Et=null);null!==St&&Ut(St)&&(St=null);null!==Ct&&Ut(Ct)&&(Ct=null);Lt.forEach(Ht);It.forEach(Ht)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function qt(e){function t(t){return Gt(t,e)}if(0<Mt.length){Gt(Mt[0],e);for(var r=1;r<Mt.length;r++){var n=Mt[r];n.blockedOn===e&&(n.blockedOn=null)}}null!==Et&&Gt(Et,e);null!==St&&Gt(St,e);null!==Ct&&Gt(Ct,e);Lt.forEach(t);It.forEach(t);for(r=0;r<Ot.length;r++)n=Ot[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ot.length&&(r=Ot[0],null===r.blockedOn);)jt(r),null===r.blockedOn&&Ot.shift()}var Yt={},Wt=new Map,Xt=new Map,Zt=["abort","abort",Qe,"animationEnd",$e,"animationIteration",et,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",tt,"transitionEnd","waiting","waiting"];function Kt(e,t){for(var r=0;r<e.length;r+=2){var n=e[r],a=e[r+1],i="on"+(a[0].toUpperCase()+a.slice(1));i={phasedRegistrationNames:{bubbled:i,captured:i+"Capture"},dependencies:[n],eventPriority:t};Xt.set(n,t);Wt.set(n,i);Yt[a]=i}}Kt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);Kt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Kt(Zt,2);for(var Jt="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Qt=0;Qt<Jt.length;Qt++)Xt.set(Jt[Qt],0);var $t=i.unstable_UserBlockingPriority,er=i.unstable_runWithPriority,tr=!0;function rr(e,t){nr(t,e,!1)}function nr(e,t,r){var n=Xt.get(t);switch(void 0===n?2:n){case 0:n=ar.bind(null,t,1,e);break;case 1:n=ir.bind(null,t,1,e);break;default:n=or.bind(null,t,1,e)}r?e.addEventListener(t,n,!0):e.addEventListener(t,n,!1)}function ar(e,t,r,n){B||N();var a=or,i=B;B=!0;try{z(a,e,t,r,n)}finally{(B=i)||U()}}function ir(e,t,r,n){er($t,or.bind(null,e,t,r,n))}function or(e,t,r,n){if(tr)if(0<Mt.length&&-1<Pt.indexOf(e))e=zt(null,e,t,r,n),Mt.push(e);else{var a=sr(e,t,r,n);if(null===a)Nt(e,n);else if(-1<Pt.indexOf(e))e=zt(a,e,t,r,n),Mt.push(e);else if(!Bt(a,e,t,r,n)){Nt(e,n);e=xt(e,n,null,t);try{H(_t,e)}finally{yt(e)}}}}function sr(e,t,r,n){r=vt(n);r=jr(r);if(null!==r){var a=it(r);if(null===a)r=null;else{var i=a.tag;if(13===i){r=ot(a);if(null!==r)return r;r=null}else if(3===i){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}e=xt(e,n,r,t);try{H(_t,e)}finally{yt(e)}return null}var lr={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ur=["Webkit","ms","Moz","O"];Object.keys(lr).forEach(function(e){ur.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1);lr[t]=lr[e]})});function cr(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||lr.hasOwnProperty(e)&&lr[e]?(""+t).trim():t+"px"}function fr(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=cr(r,t[r],n);"float"===r&&(r="cssFloat");n?e.setProperty(r,a):e[r]=a}}var hr=a({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pr(e,t){if(t){if(hr[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if(!("object"===typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62,""))}}function dr(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vr=Ue.html;function mr(e,t){e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument;var r=at(e);t=M[t];for(var n=0;n<t.length;n++)bt(t[n],e,r)}function gr(){}function yr(e){e=e||("undefined"!==typeof document?document:void 0);if("undefined"===typeof e)return null;try{return e.activeElement||e.body}catch(t){return e.body}}function xr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _r(e,t){var r=xr(e);e=0;for(var n;r;){if(3===r.nodeType){n=e+r.textContent.length;if(e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=xr(r)}}function br(e,t){return e&&t?e===t?!0:e&&3===e.nodeType?!1:t&&3===t.nodeType?br(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wr(){for(var e=window,t=yr();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(e){r=!1}if(r)e=t.contentWindow;else break;t=yr(e.document)}return t}function Tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var kr="$",Ar="/$",Mr="$?",Er="$!",Sr=null,Cr=null;function Lr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Ir(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Or="function"===typeof setTimeout?setTimeout:void 0,Pr="function"===typeof clearTimeout?clearTimeout:void 0;function Dr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Rr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if(r===kr||r===Er||r===Mr){if(0===t)return e;t--}else r===Ar&&t++}e=e.previousSibling}return null}var zr=Math.random().toString(36).slice(2),Nr="__reactInternalInstance$"+zr,Fr="__reactEventHandlers$"+zr,Br="__reactContainere$"+zr;function jr(e){var t=e[Nr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Br]||r[Nr]){r=t.alternate;if(null!==t.child||null!==r&&null!==r.child)for(e=Rr(e);null!==e;){if(r=e[Nr])return r;e=Rr(e)}return t}e=r;r=e.parentNode}return null}function Ur(e){e=e[Nr]||e[Br];return!e||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Hr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Vr(e){return e[Fr]||null}function Gr(e){do{e=e.return}while(e&&5!==e.tag);return e?e:null}function qr(e,t){var r=e.stateNode;if(!r)return null;var n=v(r);if(!n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!("button"===e||"input"===e||"select"===e||"textarea"===e));e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}function Yr(e,t,r){if(t=qr(e,r.dispatchConfig.phasedRegistrationNames[t]))r._dispatchListeners=ct(r._dispatchListeners,t),r._dispatchInstances=ct(r._dispatchInstances,e)}function Wr(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,r=[];t;)r.push(t),t=Gr(t);for(t=r.length;0<t--;)Yr(r[t],"captured",e);for(t=0;t<r.length;t++)Yr(r[t],"bubbled",e)}}function Xr(e,t,r){e&&r&&r.dispatchConfig.registrationName&&(t=qr(e,r.dispatchConfig.registrationName))&&(r._dispatchListeners=ct(r._dispatchListeners,t),r._dispatchInstances=ct(r._dispatchInstances,e))}function Zr(e){e&&e.dispatchConfig.registrationName&&Xr(e._targetInst,null,e)}function Kr(e){ft(e,Wr)}var Jr=null,Qr=null,$r=null;function en(){if($r)return $r;var e,t=Qr,r=t.length,n,a="value"in Jr?Jr.value:Jr.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return $r=a.slice(e,1<n?1-n:void 0)}function tn(){return!0}function rn(){return!1}function nn(e,t,r,n){this.dispatchConfig=e;this._targetInst=t;this.nativeEvent=r;e=this.constructor.Interface;for(var a in e)e.hasOwnProperty(a)&&((t=e[a])?this[a]=t(r):"target"===a?this.target=n:this[a]=r[a]);this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?tn:rn;this.isPropagationStopped=rn;return this}a(nn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){this.isPersistent=tn},isPersistent:rn,destructor:function(){var e=this.constructor.Interface,t;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=rn;this._dispatchInstances=this._dispatchListeners=null}});nn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};nn.extend=function(e){function t(){}function r(){return n.apply(this,arguments)}var n=this;t.prototype=n.prototype;var i=new t;a(i,r.prototype);r.prototype=i;r.prototype.constructor=r;r.Interface=a({},n.Interface,e);r.extend=n.extend;sn(r);return r};sn(nn);function an(e,t,r,n){if(this.eventPool.length){var a=this.eventPool.pop();this.call(a,e,t,r,n);return a}return new this(e,t,r,n)}function on(e){if(!(e instanceof this))throw Error(o(279));e.destructor();10>this.eventPool.length&&this.eventPool.push(e)}function sn(e){e.eventPool=[];e.getPooled=an;e.release=on}var ln=nn.extend({data:null}),un=nn.extend({data:null}),cn=[9,13,27,32],fn=S&&"CompositionEvent"in window,hn=null;S&&"documentMode"in document&&(hn=document.documentMode);var pn=S&&"TextEvent"in window&&!hn,dn=S&&(!fn||hn&&8<hn&&11>=hn),vn=String.fromCharCode(32),mn={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},gn=!1;function yn(e,t){switch(e){case"keyup":return-1!==cn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function xn(e){e=e.detail;return"object"===typeof e&&"data"in e?e.data:null}var _n=!1;function bn(e,t){switch(e){case"compositionend":return xn(t);case"keypress":if(32!==t.which)return null;gn=!0;return vn;case"textInput":return e=t.data,e===vn&&gn?null:e;default:return null}}function wn(e,t){if(_n)return"compositionend"===e||!fn&&yn(e,t)?(e=en(),$r=Qr=Jr=null,_n=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dn&&"ko"!==t.locale?null:t.data;default:return null}}var Tn={eventTypes:mn,extractEvents:function(e,t,r,n){var a;if(fn)e:{switch(e){case"compositionstart":var i=mn.compositionStart;break e;case"compositionend":i=mn.compositionEnd;break e;case"compositionupdate":i=mn.compositionUpdate;break e}i=void 0}else _n?yn(e,r)&&(i=mn.compositionEnd):"keydown"===e&&229===r.keyCode&&(i=mn.compositionStart);i?(dn&&"ko"!==r.locale&&(_n||i!==mn.compositionStart?i===mn.compositionEnd&&_n&&(a=en()):(Jr=n,Qr="value"in Jr?Jr.value:Jr.textContent,_n=!0)),i=ln.getPooled(i,t,r,n),a?i.data=a:(a=xn(r),null!==a&&(i.data=a)),Kr(i),a=i):a=null;(e=pn?bn(e,r):wn(e,r))?(t=un.getPooled(mn.beforeInput,t,r,n),t.data=e,Kr(t)):t=null;return null===a?t:null===t?a:[a,t]}},kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function An(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!kn[e.type]:"textarea"===t?!0:!1}var Mn={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function En(e,t,r){e=nn.getPooled(Mn.change,e,t,r);e.type="change";P(r);Kr(e);return e}var Sn=null,Cn=null;function Ln(e){dt(e)}function In(e){var t=Hr(e);if(Ee(t))return e}function On(e,t){if("change"===e)return t}var Pn=!1;S&&(Pn=mt("input")&&(!document.documentMode||9<document.documentMode));function Dn(){Sn&&(Sn.detachEvent("onpropertychange",Rn),Cn=Sn=null)}function Rn(e){if("value"===e.propertyName&&In(Cn))if(e=En(Cn,e,vt(e)),B)dt(e);else{B=!0;try{R(Ln,e)}finally{B=!1,U()}}}function zn(e,t,r){"focus"===e?(Dn(),Sn=t,Cn=r,Sn.attachEvent("onpropertychange",Rn)):"blur"===e&&Dn()}function Nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return In(Cn)}function Fn(e,t){if("click"===e)return In(t)}function Bn(e,t){if("input"===e||"change"===e)return In(t)}var jn={eventTypes:Mn,_isInputEventSupported:Pn,extractEvents:function(e,t,r,n){var a=t?Hr(t):window,i=a.nodeName&&a.nodeName.toLowerCase();if("select"===i||"input"===i&&"file"===a.type)var o=On;else if(An(a))if(Pn)o=Bn;else{o=Nn;var s=zn}else(i=a.nodeName)&&"input"===i.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(o=Fn);if(o&&(o=o(e,t)))return En(o,r,n);s&&s(e,a,t);"blur"===e&&(e=a._wrapperState)&&e.controlled&&"number"===a.type&&Pe(a,"number",a.value)}},Un=nn.extend({view:null,detail:null}),Hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hn[e])?!!t[e]:!1}function Gn(){return Vn}var qn=0,Yn=0,Wn=!1,Xn=!1,Zn=Un.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Gn,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=qn;qn=e.screenX;return Wn?"mousemove"===e.type?e.screenX-t:0:(Wn=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Yn;Yn=e.screenY;return Xn?"mousemove"===e.type?e.screenY-t:0:(Xn=!0,0)}}),Kn=Zn.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Jn={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Qn={eventTypes:Jn,extractEvents:function(e,t,r,n,a){var i="mouseover"===e||"pointerover"===e,o="mouseout"===e||"pointerout"===e;if(i&&0===(a&32)&&(r.relatedTarget||r.fromElement)||!o&&!i)return null;i=n.window===n?n:(i=n.ownerDocument)?i.defaultView||i.parentWindow:window;if(o){if(o=t,t=(t=r.relatedTarget||r.toElement)?jr(t):null,null!==t){var s=it(t);if(t!==s||5!==t.tag&&6!==t.tag)t=null}}else o=null;if(o===t)return null;if("mouseout"===e||"mouseover"===e){var l=Zn;var u=Jn.mouseLeave;var c=Jn.mouseEnter;var f="mouse"}else if("pointerout"===e||"pointerover"===e)l=Kn,u=Jn.pointerLeave,c=Jn.pointerEnter,f="pointer";e=null==o?i:Hr(o);i=null==t?i:Hr(t);u=l.getPooled(u,o,r,n);u.type=f+"leave";u.target=e;u.relatedTarget=i;r=l.getPooled(c,t,r,n);r.type=f+"enter";r.target=i;r.relatedTarget=e;n=o;f=t;if(n&&f)e:{l=n;c=f;o=0;for(e=l;e;e=Gr(e))o++;e=0;for(t=c;t;t=Gr(t))e++;for(;0<o-e;)l=Gr(l),o--;for(;0<e-o;)c=Gr(c),e--;for(;o--;){if(l===c||l===c.alternate)break e;l=Gr(l);c=Gr(c)}l=null}else l=null;c=l;for(l=[];n&&n!==c;){o=n.alternate;if(null!==o&&o===c)break;l.push(n);n=Gr(n)}for(n=[];f&&f!==c;){o=f.alternate;if(null!==o&&o===c)break;n.push(f);f=Gr(f)}for(f=0;f<l.length;f++)Xr(l[f],"bubbled",u);for(f=n.length;0<f--;)Xr(n[f],"captured",r);return 0===(a&64)?[u]:[u,r]}};function $n(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t}var ea="function"===typeof Object.is?Object.is:$n,ta=Object.prototype.hasOwnProperty;function ra(e,t){if(ea(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++)if(!ta.call(t,r[n])||!ea(e[r[n]],t[r[n]]))return!1;return!0}var na=S&&"documentMode"in document&&11>=document.documentMode,aa={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},ia=null,oa=null,sa=null,la=!1;function ua(e,t){var r=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;if(la||null==ia||ia!==yr(r))return null;r=ia;"selectionStart"in r&&Tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset});return sa&&ra(sa,r)?null:(sa=r,e=nn.getPooled(aa.select,oa,e,t),e.type="select",e.target=ia,Kr(e),e)}var ca={eventTypes:aa,extractEvents:function(e,t,r,n,a,i){a=i||(n.window===n?n.document:9===n.nodeType?n:n.ownerDocument);if(!(i=!a)){e:{a=at(a);i=M.onSelect;for(var o=0;o<i.length;o++)if(!a.has(i[o])){a=!1;break e}a=!0}i=!a}if(i)return null;a=t?Hr(t):window;switch(e){case"focus":if(An(a)||"true"===a.contentEditable)ia=a,oa=t,sa=null;break;case"blur":sa=oa=ia=null;break;case"mousedown":la=!0;break;case"contextmenu":case"mouseup":case"dragend":return la=!1,ua(r,n);case"selectionchange":if(na)break;case"keydown":case"keyup":return ua(r,n)}return null}},fa=nn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ha=nn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pa=Un.extend({relatedTarget:null});function da(e){var t=e.keyCode;"charCode"in e?(e=e.charCode,0===e&&13===t&&(e=13)):e=t;10===e&&(e=13);return 32<=e||13===e?e:0}var va={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ma={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ga=Un.extend({key:function(e){if(e.key){var t=va[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?(e=da(e),13===e?"Enter":String.fromCharCode(e)):"keydown"===e.type||"keyup"===e.type?ma[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Gn,charCode:function(e){return"keypress"===e.type?da(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?da(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ya=Zn.extend({dataTransfer:null}),xa=Un.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Gn}),_a=nn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ba=Zn.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),wa={eventTypes:Yt,extractEvents:function(e,t,r,n){var a=Wt.get(e);if(!a)return null;switch(e){case"keypress":if(0===da(r))return null;case"keydown":case"keyup":e=ga;break;case"blur":case"focus":e=pa;break;case"click":if(2===r.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Zn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=ya;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=xa;break;case Qe:case $e:case et:e=fa;break;case tt:e=_a;break;case"scroll":e=Un;break;case"wheel":e=ba;break;case"copy":case"cut":case"paste":e=ha;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Kn;break;default:e=nn}t=e.getPooled(a,t,r,n);Kr(t);return t}};if(x)throw Error(o(101));x=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));b();var Ta=Ur;v=Vr;m=Ta;g=Hr;E({SimpleEventPlugin:wa,EnterLeaveEventPlugin:Qn,ChangeEventPlugin:jn,SelectEventPlugin:ca,BeforeInputEventPlugin:Tn});var ka=[],Aa=-1;function Ma(e){0>Aa||(e.current=ka[Aa],ka[Aa]=null,Aa--)}function Ea(e,t){Aa++;ka[Aa]=e.current;e.current=t}var Sa={},Ca={current:Sa},La={current:!1},Ia=Sa;function Oa(e,t){var r=e.type.contextTypes;if(!r)return Sa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a);return a}function Pa(e){e=e.childContextTypes;return null!==e&&void 0!==e}function Da(){Ma(La);Ma(Ca)}function Ra(e,t,r){if(Ca.current!==Sa)throw Error(o(168));Ea(Ca,t);Ea(La,r)}function za(e,t,r){var n=e.stateNode;e=t.childContextTypes;if("function"!==typeof n.getChildContext)return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(o(108,be(t)||"Unknown",i));return a({},r,{},n)}function Na(e){e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sa;Ia=Ca.current;Ea(Ca,e);Ea(La,La.current);return!0}function Fa(e,t,r){var n=e.stateNode;if(!n)throw Error(o(169));r?(e=za(e,t,Ia),n.__reactInternalMemoizedMergedChildContext=e,Ma(La),Ma(Ca),Ea(Ca,e)):Ma(La);Ea(La,r)}var Ba=i.unstable_runWithPriority,ja=i.unstable_scheduleCallback,Ua=i.unstable_cancelCallback,Ha=i.unstable_requestPaint,Va=i.unstable_now,Ga=i.unstable_getCurrentPriorityLevel,qa=i.unstable_ImmediatePriority,Ya=i.unstable_UserBlockingPriority,Wa=i.unstable_NormalPriority,Xa=i.unstable_LowPriority,Za=i.unstable_IdlePriority,Ka={},Ja=i.unstable_shouldYield,Qa=void 0!==Ha?Ha:function(){},$a=null,ei=null,ti=!1,ri=Va(),ni=1e4>ri?Va:function(){return Va()-ri};function ai(){switch(Ga()){case qa:return 99;case Ya:return 98;case Wa:return 97;case Xa:return 96;case Za:return 95;default:throw Error(o(332))}}function ii(e){switch(e){case 99:return qa;case 98:return Ya;case 97:return Wa;case 96:return Xa;case 95:return Za;default:throw Error(o(332))}}function oi(e,t){e=ii(e);return Ba(e,t)}function si(e,t,r){e=ii(e);return ja(e,t,r)}function li(e){null===$a?($a=[e],ei=ja(qa,ci)):$a.push(e);return Ka}function ui(){if(null!==ei){var e=ei;ei=null;Ua(e)}ci()}function ci(){if(!ti&&null!==$a){ti=!0;var e=0;try{var t=$a;oi(99,function(){for(;e<t.length;e++){var r=t[e];do{r=r(!0)}while(null!==r)}});$a=null}catch(t){throw null!==$a&&($a=$a.slice(e+1)),ja(qa,ui),t}finally{ti=!1}}}function fi(e,t,r){r/=10;return 1073741821-(((1073741821-e+t/10)/r|0)+1)*r}function hi(e,t){if(e&&e.defaultProps){t=a({},t);e=e.defaultProps;for(var r in e)void 0===t[r]&&(t[r]=e[r])}return t}var pi={current:null},di=null,vi=null,mi=null;function gi(){mi=vi=di=null}function yi(e){var t=pi.current;Ma(pi);e.type._context._currentValue=t}function xi(e,t){for(;null!==e;){var r=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==r&&r.childExpirationTime<t&&(r.childExpirationTime=t);else if(null!==r&&r.childExpirationTime<t)r.childExpirationTime=t;else break;e=e.return}}function _i(e,t){di=e;mi=vi=null;e=e.dependencies;null!==e&&null!==e.firstContext&&(e.expirationTime>=t&&(Xo=!0),e.firstContext=null)}function bi(e,t){if(mi!==e&&!1!==t&&0!==t){if("number"!==typeof t||1073741823===t)mi=e,t=1073741823;t={context:e,observedBits:t,next:null};if(null===vi){if(null===di)throw Error(o(308));vi=t;di.dependencies={expirationTime:0,firstContext:t,responders:null}}else vi=vi.next=t}return e._currentValue}var wi=!1;function Ti(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function ki(e,t){e=e.updateQueue;t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function Ai(e,t){e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null};return e.next=e}function Mi(e,t){e=e.updateQueue;if(null!==e){e=e.shared;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t);e.pending=t}}function Ei(e,t){var r=e.alternate;null!==r&&ki(r,e);e=e.updateQueue;r=e.baseQueue;null===r?(e.baseQueue=t.next=t,t.next=t):(t.next=r.next,r.next=t)}function Si(e,t,r,n){var i=e.updateQueue;wi=!1;var o=i.baseQueue,s=i.shared.pending;if(null!==s){if(null!==o){var l=o.next;o.next=s.next;s.next=l}o=s;i.shared.pending=null;l=e.alternate;null!==l&&(l=l.updateQueue,null!==l&&(l.baseQueue=s))}if(null!==o){l=o.next;var u=i.baseState,c=0,f=null,h=null,p=null;if(null!==l){var d=l;do{s=d.expirationTime;if(s<n){var v={expirationTime:d.expirationTime,suspenseConfig:d.suspenseConfig,tag:d.tag,payload:d.payload,callback:d.callback,next:null};null===p?(h=p=v,f=u):p=p.next=v;s>c&&(c=s)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:d.suspenseConfig,tag:d.tag,payload:d.payload,callback:d.callback,next:null});Rl(s,d.suspenseConfig);e:{var m=e,g=d;s=t;v=r;switch(g.tag){case 1:m=g.payload;if("function"===typeof m){u=m.call(v,u,s);break e}u=m;break e;case 3:m.effectTag=m.effectTag&-4097|64;case 0:m=g.payload;s="function"===typeof m?m.call(v,u,s):m;if(null===s||void 0===s)break e;u=a({},u,s);break e;case 2:wi=!0}}null!==d.callback&&(e.effectTag|=32,s=i.effects,null===s?i.effects=[d]:s.push(d))}d=d.next;if(null===d||d===l)if(s=i.shared.pending,null===s)break;else d=o.next=s.next,s.next=l,i.baseQueue=o=s,i.shared.pending=null}while(1)}null===p?f=u:p.next=h;i.baseState=f;i.baseQueue=p;zl(c);e.expirationTime=c;e.memoizedState=u}}function Ci(e,t,r){e=t.effects;t.effects=null;if(null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){n.callback=null;n=a;a=r;if("function"!==typeof n)throw Error(o(191,n));n.call(a)}}}var Li=ee.ReactCurrentBatchConfig,Ii=(new n.Component).refs;function Oi(e,t,r,n){t=e.memoizedState;r=r(n,t);r=null===r||void 0===r?t:a({},t,r);e.memoizedState=r;0===e.expirationTime&&(e.updateQueue.baseState=r)}var Pi={isMounted:function(e){return(e=e._reactInternalFiber)?it(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternalFiber;var n=bl(),a=Li.suspense;n=wl(n,e,a);a=Ai(n,a);a.payload=t;void 0!==r&&null!==r&&(a.callback=r);Mi(e,a);Tl(e,n)},enqueueReplaceState:function(e,t,r){e=e._reactInternalFiber;var n=bl(),a=Li.suspense;n=wl(n,e,a);a=Ai(n,a);a.tag=1;a.payload=t;void 0!==r&&null!==r&&(a.callback=r);Mi(e,a);Tl(e,n)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var r=bl(),n=Li.suspense;r=wl(r,e,n);n=Ai(r,n);n.tag=2;void 0!==t&&null!==t&&(n.callback=t);Mi(e,n);Tl(e,r)}};function Di(e,t,r,n,a,i,o){e=e.stateNode;return"function"===typeof e.shouldComponentUpdate?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!ra(r,n)||!ra(a,i):!0}function Ri(e,t,r){var n=!1,a=Sa;var i=t.contextType;"object"===typeof i&&null!==i?i=bi(i):(a=Pa(t)?Ia:Ca.current,n=t.contextTypes,i=(n=null!==n&&void 0!==n)?Oa(e,a):Sa);t=new t(r,i);e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null;t.updater=Pi;e.stateNode=t;t._reactInternalFiber=e;n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i);return t}function zi(e,t,r,n){e=t.state;"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n);"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n);t.state!==e&&Pi.enqueueReplaceState(t,t.state,null)}function Ni(e,t,r,n){var a=e.stateNode;a.props=r;a.state=e.memoizedState;a.refs=Ii;Ti(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=bi(i):(i=Pa(t)?Ia:Ca.current,a.context=Oa(e,i));Si(e,r,a,n);a.state=e.memoizedState;i=t.getDerivedStateFromProps;"function"===typeof i&&(Oi(e,t,i,r),a.state=e.memoizedState);"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Pi.enqueueReplaceState(a,a.state,null),Si(e,r,a,n),a.state=e.memoizedState);"function"===typeof a.componentDidMount&&(e.effectTag|=4)}var Fi=Array.isArray;function Bi(e,t,r){e=r.ref;if(null!==e&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){r=r._owner;if(r){if(1!==r.tag)throw Error(o(309));var n=r.stateNode}if(!n)throw Error(o(147,e));var a=""+e;if(null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a)return t.ref;t=function(e){var t=n.refs;t===Ii&&(t=n.refs={});null===e?delete t[a]:t[a]=e};t._stringRef=a;return t}if("string"!==typeof e)throw Error(o(284));if(!r._owner)throw Error(o(290,e))}return e}function ji(e,t){if("textarea"!==e.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function Ui(e){function t(t,r){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r;r.nextEffect=null;r.effectTag=8}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){e=iu(e,t);e.index=0;e.sibling=null;return e}function i(t,r,n){t.index=n;if(!e)return r;n=t.alternate;if(null!==n)return n=n.index,n<r?(t.effectTag=2,r):n;t.effectTag=2;return r}function s(t){e&&null===t.alternate&&(t.effectTag=2);return t}function l(e,t,r,n){if(null===t||6!==t.tag)return t=lu(r,e.mode,n),t.return=e,t;t=a(t,r);t.return=e;return t}function u(e,t,r,n){if(null!==t&&t.elementType===r.type)return n=a(t,r.props),n.ref=Bi(e,t,r),n.return=e,n;n=ou(r.type,r.key,r.props,null,e.mode,n);n.ref=Bi(e,t,r);n.return=e;return n}function c(e,t,r,n){if(null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation)return t=uu(r,e.mode,n),t.return=e,t;t=a(t,r.children||[]);t.return=e;return t}function f(e,t,r,n,i){if(null===t||7!==t.tag)return t=su(r,e.mode,n,i),t.return=e,t;t=a(t,r);t.return=e;return t}function h(e,t,r){if("string"===typeof t||"number"===typeof t)return t=lu(""+t,e.mode,r),t.return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case ae:return r=ou(t.type,t.key,t.props,null,e.mode,r),r.ref=Bi(e,null,t),r.return=e,r;case ie:return t=uu(t,e.mode,r),t.return=e,t}if(Fi(t)||xe(t))return t=su(t,e.mode,r,null),t.return=e,t;ji(e,t)}return null}function p(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r||"number"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case ae:return r.key===a?r.type===oe?f(e,t,r.props.children,n,a):u(e,t,r,n):null;case ie:return r.key===a?c(e,t,r,n):null}if(Fi(r)||xe(r))return null!==a?null:f(e,t,r,n,null);ji(e,r)}return null}function d(e,t,r,n,a){if("string"===typeof n||"number"===typeof n)return e=e.get(r)||null,l(t,e,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case ae:return e=e.get(null===n.key?r:n.key)||null,n.type===oe?f(t,e,n.props.children,a,n.key):u(t,e,n,a);case ie:return e=e.get(null===n.key?r:n.key)||null,c(t,e,n,a)}if(Fi(n)||xe(n))return e=e.get(r)||null,f(t,e,n,a,null);ji(t,n)}return null}function v(a,o,s,l){for(var u=null,c=null,f=o,v=o=0,m=null;null!==f&&v<s.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var g=p(a,f,s[v],l);if(null===g){null===f&&(f=m);break}e&&f&&null===g.alternate&&t(a,f);o=i(g,o,v);null===c?u=g:c.sibling=g;c=g;f=m}if(v===s.length)return r(a,f),u;if(null===f){for(;v<s.length;v++)f=h(a,s[v],l),null!==f&&(o=i(f,o,v),null===c?u=f:c.sibling=f,c=f);return u}for(f=n(a,f);v<s.length;v++)m=d(f,a,v,s[v],l),null!==m&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),o=i(m,o,v),null===c?u=m:c.sibling=m,c=m);e&&f.forEach(function(e){return t(a,e)});return u}function m(a,s,l,u){var c=xe(l);if("function"!==typeof c)throw Error(o(150));l=c.call(l);if(null==l)throw Error(o(151));for(var f=c=null,v=s,m=s=0,g=null,y=l.next();null!==v&&!y.done;m++,y=l.next()){v.index>m?(g=v,v=null):g=v.sibling;var x=p(a,v,y.value,u);if(null===x){null===v&&(v=g);break}e&&v&&null===x.alternate&&t(a,v);s=i(x,s,m);null===f?c=x:f.sibling=x;f=x;v=g}if(y.done)return r(a,v),c;if(null===v){for(;!y.done;m++,y=l.next())y=h(a,y.value,u),null!==y&&(s=i(y,s,m),null===f?c=y:f.sibling=y,f=y);return c}for(v=n(a,v);!y.done;m++,y=l.next())y=d(v,a,m,y.value,u),null!==y&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=i(y,s,m),null===f?c=y:f.sibling=y,f=y);e&&v.forEach(function(e){return t(a,e)});return c}return function(e,n,i,l){var u="object"===typeof i&&null!==i&&i.type===oe&&null===i.key;u&&(i=i.props.children);var c="object"===typeof i&&null!==i;if(c)switch(i.$$typeof){case ae:e:{c=i.key;for(u=n;null!==u;){if(u.key===c){switch(u.tag){case 7:if(i.type===oe){r(e,u.sibling);n=a(u,i.props.children);n.return=e;e=n;break e}break;default:if(u.elementType===i.type){r(e,u.sibling);n=a(u,i.props);n.ref=Bi(e,u,i);n.return=e;e=n;break e}}r(e,u);break}else t(e,u);u=u.sibling}i.type===oe?(n=su(i.props.children,e.mode,l,i.key),n.return=e,e=n):(l=ou(i.type,i.key,i.props,null,e.mode,l),l.ref=Bi(e,n,i),l.return=e,e=l)}return s(e);case ie:e:{for(u=i.key;null!==n;){if(n.key===u)if(4===n.tag&&n.stateNode.containerInfo===i.containerInfo&&n.stateNode.implementation===i.implementation){r(e,n.sibling);n=a(n,i.children||[]);n.return=e;e=n;break e}else{r(e,n);break}else t(e,n);n=n.sibling}n=uu(i,e.mode,l);n.return=e;e=n}return s(e)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==n&&6===n.tag?(r(e,n.sibling),n=a(n,i),n.return=e,e=n):(r(e,n),n=lu(i,e.mode,l),n.return=e,e=n),s(e);if(Fi(i))return v(e,n,i,l);if(xe(i))return m(e,n,i,l);c&&ji(e,i);if("undefined"===typeof i&&!u)switch(e.tag){case 1:case 0:throw e=e.type,Error(o(152,e.displayName||e.name||"Component"))}return r(e,n)}}var Hi=Ui(!0),Vi=Ui(!1),Gi={},qi={current:Gi},Yi={current:Gi},Wi={current:Gi};function Xi(e){if(e===Gi)throw Error(o(174));return e}function Zi(e,t){Ea(Wi,t);Ea(Yi,e);Ea(qi,Gi);e=t.nodeType;switch(e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ve(null,"");break;default:e=8===e?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ve(t,e)}Ma(qi);Ea(qi,t)}function Ki(){Ma(qi);Ma(Yi);Ma(Wi)}function Ji(e){Xi(Wi.current);var t=Xi(qi.current);var r=Ve(t,e.type);t!==r&&(Ea(Yi,e),Ea(qi,r))}function Qi(e){Yi.current===e&&(Ma(qi),Ma(Yi))}var $i={current:0};function eo(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(r=r.dehydrated,null===r||r.data===Mr||r.data===Er))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(t.effectTag&64))return t}else if(null!==t.child){t.child.return=t;t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return;t=t.sibling}return null}function to(e,t){return{responder:e,props:t}}var ro=ee.ReactCurrentDispatcher,no=ee.ReactCurrentBatchConfig,ao=0,io=null,oo=null,so=null,lo=!1;function uo(){throw Error(o(321))}function co(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ea(e[r],t[r]))return!1;return!0}function fo(e,t,r,n,a,i){ao=i;io=t;t.memoizedState=null;t.updateQueue=null;t.expirationTime=0;ro.current=null===e||null===e.memoizedState?Ro:zo;e=r(n,a);if(t.expirationTime===ao){i=0;do{t.expirationTime=0;if(!(25>i))throw Error(o(301));i+=1;so=oo=null;t.updateQueue=null;ro.current=No;e=r(n,a)}while(t.expirationTime===ao)}ro.current=Do;t=null!==oo&&null!==oo.next;ao=0;so=oo=io=null;lo=!1;if(t)throw Error(o(300));return e}function ho(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===so?io.memoizedState=so=e:so=so.next=e;return so}function po(){if(null===oo){var e=io.alternate;e=null!==e?e.memoizedState:null}else e=oo.next;var t=null===so?io.memoizedState:so.next;if(null!==t)so=t,oo=e;else{if(null===e)throw Error(o(310));oo=e;e={memoizedState:oo.memoizedState,baseState:oo.baseState,baseQueue:oo.baseQueue,queue:oo.queue,next:null};null===so?io.memoizedState=so=e:so=so.next=e}return so}function vo(e,t){return"function"===typeof t?t(e):t}function mo(e){var t=po(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=oo,a=n.baseQueue,i=r.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next;i.next=s}n.baseQueue=a=i;r.pending=null}if(null!==a){a=a.next;n=n.baseState;var l=s=i=null,u=a;do{var c=u.expirationTime;if(c<ao){var f={expirationTime:u.expirationTime,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(s=l=f,i=n):l=l.next=f;c>io.expirationTime&&(io.expirationTime=c,zl(c))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),Rl(c,u.suspenseConfig),n=u.eagerReducer===e?u.eagerState:e(n,u.action);u=u.next}while(null!==u&&u!==a);null===l?i=n:l.next=s;ea(n,t.memoizedState)||(Xo=!0);t.memoizedState=n;t.baseState=i;t.baseQueue=l;r.lastRenderedState=n}return[t.memoizedState,r.dispatch]}function go(e){var t=po(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(null!==a){r.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);ea(i,t.memoizedState)||(Xo=!0);t.memoizedState=i;null===t.baseQueue&&(t.baseState=i);r.lastRenderedState=i}return[i,n]}function yo(e){var t=ho();"function"===typeof e&&(e=e());t.memoizedState=t.baseState=e;e=t.queue={pending:null,dispatch:null,lastRenderedReducer:vo,lastRenderedState:e};e=e.dispatch=Po.bind(null,io,e);return[t.memoizedState,e]}function xo(e,t,r,n){e={tag:e,create:t,destroy:r,deps:n,next:null};t=io.updateQueue;null===t?(t={lastEffect:null},io.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,null===r?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e));return e}function _o(){return po().memoizedState}function bo(e,t,r,n){var a=ho();io.effectTag|=e;a.memoizedState=xo(1|t,r,void 0,void 0===n?null:n)}function wo(e,t,r,n){var a=po();n=void 0===n?null:n;var i=void 0;if(null!==oo){var o=oo.memoizedState;i=o.destroy;if(null!==n&&co(n,o.deps)){xo(t,r,i,n);return}}io.effectTag|=e;a.memoizedState=xo(1|t,r,i,n)}function To(e,t){return bo(516,4,e,t)}function ko(e,t){return wo(516,4,e,t)}function Ao(e,t){return wo(4,2,e,t)}function Mo(e,t){if("function"===typeof t)return e=e(),t(e),function(){t(null)};if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Eo(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null;return wo(4,2,Mo.bind(null,t,e),r)}function So(){}function Co(e,t){ho().memoizedState=[e,void 0===t?null:t];return e}function Lo(e,t){var r=po();t=void 0===t?null:t;var n=r.memoizedState;if(null!==n&&null!==t&&co(t,n[1]))return n[0];r.memoizedState=[e,t];return e}function Io(e,t){var r=po();t=void 0===t?null:t;var n=r.memoizedState;if(null!==n&&null!==t&&co(t,n[1]))return n[0];e=e();r.memoizedState=[e,t];return e}function Oo(e,t,r){var n=ai();oi(98>n?98:n,function(){e(!0)});oi(97<n?97:n,function(){var n=no.suspense;no.suspense=void 0===t?null:t;try{e(!1),r()}finally{no.suspense=n}})}function Po(e,t,r){var n=bl(),a=Li.suspense;n=wl(n,e,a);a={expirationTime:n,suspenseConfig:a,action:r,eagerReducer:null,eagerState:null,next:null};var i=t.pending;null===i?a.next=a:(a.next=i.next,i.next=a);t.pending=a;i=e.alternate;if(e===io||null!==i&&i===io)lo=!0,a.expirationTime=ao,io.expirationTime=ao;else{if(0===e.expirationTime&&(null===i||0===i.expirationTime)&&(i=t.lastRenderedReducer,null!==i))try{var o=t.lastRenderedState,s=i(o,r);a.eagerReducer=i;a.eagerState=s;if(ea(s,o))return}catch(e){}finally{}Tl(e,n)}}var Do={readContext:bi,useCallback:uo,useContext:uo,useEffect:uo,useImperativeHandle:uo,useLayoutEffect:uo,useMemo:uo,useReducer:uo,useRef:uo,useState:uo,useDebugValue:uo,useResponder:uo,useDeferredValue:uo,useTransition:uo},Ro={readContext:bi,useCallback:Co,useContext:bi,useEffect:To,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null;return bo(4,2,Mo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return bo(4,2,e,t)},useMemo:function(e,t){var r=ho();t=void 0===t?null:t;e=e();r.memoizedState=[e,t];return e},useReducer:function(e,t,r){var n=ho();t=void 0!==r?r(t):t;n.memoizedState=n.baseState=t;e=n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t};e=e.dispatch=Po.bind(null,io,e);return[n.memoizedState,e]},useRef:function(e){var t=ho();e={current:e};return t.memoizedState=e},useState:yo,useDebugValue:So,useResponder:to,useDeferredValue:function(e,t){var r=yo(e),n=r[0],a=r[1];To(function(){var r=no.suspense;no.suspense=void 0===t?null:t;try{a(e)}finally{no.suspense=r}},[e,t]);return n},useTransition:function(e){var t=yo(!1),r=t[0];t=t[1];return[Co(Oo.bind(null,t,e),[t,e]),r]}},zo={readContext:bi,useCallback:Lo,useContext:bi,useEffect:ko,useImperativeHandle:Eo,useLayoutEffect:Ao,useMemo:Io,useReducer:mo,useRef:_o,useState:function(){return mo(vo)},useDebugValue:So,useResponder:to,useDeferredValue:function(e,t){var r=mo(vo),n=r[0],a=r[1];ko(function(){var r=no.suspense;no.suspense=void 0===t?null:t;try{a(e)}finally{no.suspense=r}},[e,t]);return n},useTransition:function(e){var t=mo(vo),r=t[0];t=t[1];return[Lo(Oo.bind(null,t,e),[t,e]),r]}},No={readContext:bi,useCallback:Lo,useContext:bi,useEffect:ko,useImperativeHandle:Eo,useLayoutEffect:Ao,useMemo:Io,useReducer:go,useRef:_o,useState:function(){return go(vo)},useDebugValue:So,useResponder:to,useDeferredValue:function(e,t){var r=go(vo),n=r[0],a=r[1];ko(function(){var r=no.suspense;no.suspense=void 0===t?null:t;try{a(e)}finally{no.suspense=r}},[e,t]);return n},useTransition:function(e){var t=go(vo),r=t[0];t=t[1];return[Lo(Oo.bind(null,t,e),[t,e]),r]}},Fo=null,Bo=null,jo=!1;function Uo(e,t){var r=ru(5,null,null,0);r.elementType="DELETED";r.type="DELETED";r.stateNode=t;r.return=e;r.effectTag=8;null!==e.lastEffect?(e.lastEffect.nextEffect=r,e.lastEffect=r):e.firstEffect=e.lastEffect=r}function Ho(e,t){switch(e.tag){case 5:var r=e.type;t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t;return null!==t?(e.stateNode=t,!0):!1;case 6:return t=""===e.pendingProps||3!==t.nodeType?null:t,null!==t?(e.stateNode=t,!0):!1;case 13:return!1;default:return!1}}function Vo(e){if(jo){var t=Bo;if(t){var r=t;if(!Ho(e,t)){t=Dr(r.nextSibling);if(!t||!Ho(e,t)){e.effectTag=e.effectTag&-1025|2;jo=!1;Fo=e;return}Uo(Fo,r)}Fo=e;Bo=Dr(t.firstChild)}else e.effectTag=e.effectTag&-1025|2,jo=!1,Fo=e}}function Go(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fo=e}function qo(e){if(e!==Fo)return!1;if(!jo)return Go(e),jo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Ir(t,e.memoizedProps))for(t=Bo;t;)Uo(e,t),t=Dr(t.nextSibling);Go(e);if(13===e.tag){e=e.memoizedState;e=null!==e?e.dehydrated:null;if(!e)throw Error(o(317));e:{e=e.nextSibling;for(t=0;e;){if(8===e.nodeType){var r=e.data;if(r===Ar){if(0===t){Bo=Dr(e.nextSibling);break e}t--}else r!==kr&&r!==Er&&r!==Mr||t++}e=e.nextSibling}Bo=null}}else Bo=Fo?Dr(e.stateNode.nextSibling):null;return!0}function Yo(){Bo=Fo=null;jo=!1}var Wo=ee.ReactCurrentOwner,Xo=!1;function Zo(e,t,r,n){t.child=null===e?Vi(t,null,r,n):Hi(t,e.child,r,n)}function Ko(e,t,r,n,a){r=r.render;var i=t.ref;_i(t,a);n=fo(e,t,r,n,i,a);if(null!==e&&!Xo)return t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=a&&(e.expirationTime=0),us(e,t,a);t.effectTag|=1;Zo(e,t,n,a);return t.child}function Jo(e,t,r,n,a,i){if(null===e){var o=r.type;if("function"===typeof o&&!nu(o)&&void 0===o.defaultProps&&null===r.compare&&void 0===r.defaultProps)return t.tag=15,t.type=o,Qo(e,t,o,n,a,i);e=ou(r.type,null,n,null,t.mode,i);e.ref=t.ref;e.return=t;return t.child=e}o=e.child;if(a<i&&(a=o.memoizedProps,r=r.compare,r=null!==r?r:ra,r(a,n)&&e.ref===t.ref))return us(e,t,i);t.effectTag|=1;e=iu(o,n);e.ref=t.ref;e.return=t;return t.child=e}function Qo(e,t,r,n,a,i){return null!==e&&ra(e.memoizedProps,n)&&e.ref===t.ref&&(Xo=!1,a<i)?(t.expirationTime=e.expirationTime,us(e,t,i)):es(e,t,r,n,i)}function $o(e,t){var r=t.ref;if(null===e&&null!==r||null!==e&&e.ref!==r)t.effectTag|=128}function es(e,t,r,n,a){var i=Pa(r)?Ia:Ca.current;i=Oa(t,i);_i(t,a);r=fo(e,t,r,n,i,a);if(null!==e&&!Xo)return t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=a&&(e.expirationTime=0),us(e,t,a);t.effectTag|=1;Zo(e,t,r,a);return t.child}function ts(e,t,r,n,a){if(Pa(r)){var i=!0;Na(t)}else i=!1;_i(t,a);if(null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),Ri(t,r,n),Ni(t,r,n,a),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=r.contextType;"object"===typeof u&&null!==u?u=bi(u):(u=Pa(r)?Ia:Ca.current,u=Oa(t,u));var c=r.getDerivedStateFromProps,f="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||l!==u)&&zi(t,o,n,u);wi=!1;var h=t.memoizedState;o.state=h;Si(t,n,o,a);l=t.memoizedState;s!==n||h!==l||La.current||wi?("function"===typeof c&&(Oi(t,r,c,n),l=t.memoizedState),(s=wi||Di(t,r,s,n,h,l,u))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.effectTag|=4)):("function"===typeof o.componentDidMount&&(t.effectTag|=4),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=u,n=s):("function"===typeof o.componentDidMount&&(t.effectTag|=4),n=!1)}else o=t.stateNode,ki(e,t),s=t.memoizedProps,o.props=t.type===t.elementType?s:hi(t.type,s),l=o.context,u=r.contextType,"object"===typeof u&&null!==u?u=bi(u):(u=Pa(r)?Ia:Ca.current,u=Oa(t,u)),c=r.getDerivedStateFromProps,(f="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||l!==u)&&zi(t,o,n,u),wi=!1,l=t.memoizedState,o.state=l,Si(t,n,o,a),h=t.memoizedState,s!==n||l!==h||La.current||wi?("function"===typeof c&&(Oi(t,r,c,n),h=t.memoizedState),(c=wi||Di(t,r,s,n,l,h,u))?(f||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,h,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,h,u)),"function"===typeof o.componentDidUpdate&&(t.effectTag|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=n,t.memoizedState=h),o.props=n,o.state=h,o.context=u,n=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),n=!1);return rs(e,t,r,n,i,a)}function rs(e,t,r,n,a,i){$o(e,t);var o=0!==(t.effectTag&64);if(!n&&!o)return a&&Fa(t,r,!1),us(e,t,i);n=t.stateNode;Wo.current=t;var s=o&&"function"!==typeof r.getDerivedStateFromError?null:n.render();t.effectTag|=1;null!==e&&o?(t.child=Hi(t,e.child,null,i),t.child=Hi(t,null,s,i)):Zo(e,t,s,i);t.memoizedState=n.state;a&&Fa(t,r,!0);return t.child}function ns(e){var t=e.stateNode;t.pendingContext?Ra(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(e,t.context,!1);Zi(e,t.containerInfo)}var as={dehydrated:null,retryTime:0};function is(e,t,r){var n=t.mode,a=t.pendingProps,i=$i.current,o=!1,s;(s=0!==(t.effectTag&64))||(s=0!==(i&2)&&(null===e||null!==e.memoizedState));s?(o=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(i|=1);Ea($i,i&1);if(null===e){void 0!==a.fallback&&Vo(t);if(o){o=a.fallback;a=su(null,n,0,null);a.return=t;if(0===(t.mode&2))for(e=null!==t.memoizedState?t.child.child:t.child,a.child=e;null!==e;)e.return=a,e=e.sibling;r=su(o,n,r,null);r.return=t;a.sibling=r;t.memoizedState=as;t.child=a;return r}n=a.children;t.memoizedState=null;return t.child=Vi(t,null,n,r)}if(null!==e.memoizedState){e=e.child;n=e.sibling;if(o){a=a.fallback;r=iu(e,e.pendingProps);r.return=t;if(0===(t.mode&2)&&(o=null!==t.memoizedState?t.child.child:t.child,o!==e.child))for(r.child=o;null!==o;)o.return=r,o=o.sibling;n=iu(n,a);n.return=t;r.sibling=n;r.childExpirationTime=0;t.memoizedState=as;t.child=r;return n}r=Hi(t,e.child,a.children,r);t.memoizedState=null;return t.child=r}e=e.child;if(o){o=a.fallback;a=su(null,n,0,null);a.return=t;a.child=e;null!==e&&(e.return=a);if(0===(t.mode&2))for(e=null!==t.memoizedState?t.child.child:t.child,a.child=e;null!==e;)e.return=a,e=e.sibling;r=su(o,n,r,null);r.return=t;a.sibling=r;r.effectTag|=2;a.childExpirationTime=0;t.memoizedState=as;t.child=a;return r}t.memoizedState=null;return t.child=Hi(t,e,a.children,r)}function os(e,t){e.expirationTime<t&&(e.expirationTime=t);var r=e.alternate;null!==r&&r.expirationTime<t&&(r.expirationTime=t);xi(e.return,t)}function ss(e,t,r,n,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailExpiration:0,tailMode:a,lastEffect:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailExpiration=0,o.tailMode=a,o.lastEffect=i)}function ls(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;Zo(e,t,n.children,r);n=$i.current;if(0!==(n&2))n=n&1|2,t.effectTag|=64;else{if(null!==e&&0!==(e.effectTag&64))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&os(e,r);else if(19===e.tag)os(e,r);else if(null!==e.child){e.child.return=e;e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return;e=e.sibling}n&=1}Ea($i,n);if(0===(t.mode&2))t.memoizedState=null;else switch(a){case"forwards":r=t.child;for(a=null;null!==r;)e=r.alternate,null!==e&&null===eo(e)&&(a=r),r=r.sibling;r=a;null===r?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null);ss(t,!1,a,r,i,t.lastEffect);break;case"backwards":r=null;a=t.child;for(t.child=null;null!==a;){e=a.alternate;if(null!==e&&null===eo(e)){t.child=a;break}e=a.sibling;a.sibling=r;r=a;a=e}ss(t,!0,r,null,i,t.lastEffect);break;case"together":ss(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function us(e,t,r){null!==e&&(t.dependencies=e.dependencies);var n=t.expirationTime;0!==n&&zl(n);if(t.childExpirationTime<r)return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){e=t.child;r=iu(e,e.pendingProps);t.child=r;for(r.return=t;null!==e.sibling;)e=e.sibling,r=r.sibling=iu(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}var cs,fs,hs,ps;cs=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r;r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return;r=r.sibling}};fs=function(){};hs=function(e,t,r,n,i){var o=e.memoizedProps;if(o!==n){var s=t.stateNode;Xi(qi.current);e=null;switch(r){case"input":o=Se(s,o);n=Se(s,n);e=[];break;case"option":o=Re(s,o);n=Re(s,n);e=[];break;case"select":o=a({},o,{value:void 0});n=a({},n,{value:void 0});e=[];break;case"textarea":o=Ne(s,o);n=Ne(s,n);e=[];break;default:"function"!==typeof o.onClick&&"function"===typeof n.onClick&&(s.onclick=gr)}pr(r,n);var l,u;r=null;for(l in o)if(!n.hasOwnProperty(l)&&o.hasOwnProperty(l)&&null!=o[l])if("style"===l)for(u in s=o[l],s)s.hasOwnProperty(u)&&(r||(r={}),r[u]="");else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(A.hasOwnProperty(l)?e||(e=[]):(e=e||[]).push(l,null));for(l in n){var c=n[l];s=null!=o?o[l]:void 0;if(n.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(u in s)!s.hasOwnProperty(u)||c&&c.hasOwnProperty(u)||(r||(r={}),r[u]="");for(u in c)c.hasOwnProperty(u)&&s[u]!==c[u]&&(r||(r={}),r[u]=c[u])}else r||(e||(e=[]),e.push(l,r)),r=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(e=e||[]).push(l,c)):"children"===l?s===c||"string"!==typeof c&&"number"!==typeof c||(e=e||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(A.hasOwnProperty(l)?(null!=c&&mr(i,l),e||s===c||(e=[])):(e=e||[]).push(l,c))}r&&(e=e||[]).push("style",r);i=e;if(t.updateQueue=i)t.effectTag|=4}};ps=function(e,t,r,n){r!==n&&(t.effectTag|=4)};function ds(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function vs(e,t,r){var n=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return Pa(t.type)&&Da(),null;case 3:return Ki(),Ma(La),Ma(Ca),r=t.stateNode,r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||!qo(t)||(t.effectTag|=4),fs(t),null;case 5:Qi(t);r=Xi(Wi.current);var i=t.type;if(null!==e&&null!=t.stateNode)hs(e,t,i,n,r),e.ref!==t.ref&&(t.effectTag|=128);else{if(!n){if(null===t.stateNode)throw Error(o(166));return null}e=Xi(qi.current);if(qo(t)){n=t.stateNode;i=t.type;var s=t.memoizedProps;n[Nr]=t;n[Fr]=s;switch(i){case"iframe":case"object":case"embed":rr("load",n);break;case"video":case"audio":for(e=0;e<rt.length;e++)rr(rt[e],n);break;case"source":rr("error",n);break;case"img":case"image":case"link":rr("error",n);rr("load",n);break;case"form":rr("reset",n);rr("submit",n);break;case"details":rr("toggle",n);break;case"input":Ce(n,s);rr("invalid",n);mr(r,"onChange");break;case"select":n._wrapperState={wasMultiple:!!s.multiple};rr("invalid",n);mr(r,"onChange");break;case"textarea":Fe(n,s),rr("invalid",n),mr(r,"onChange")}pr(i,s);e=null;for(var l in s)if(s.hasOwnProperty(l)){var u=s[l];"children"===l?"string"===typeof u?n.textContent!==u&&(e=["children",u]):"number"===typeof u&&n.textContent!==""+u&&(e=["children",""+u]):A.hasOwnProperty(l)&&null!=u&&mr(r,l)}switch(i){case"input":Me(n);Oe(n,s,!0);break;case"textarea":Me(n);je(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=gr)}r=e;t.updateQueue=r;null!==r&&(t.effectTag|=4)}else{l=9===r.nodeType?r:r.ownerDocument;e===vr&&(e=He(i));e===vr?"script"===i?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(i,{is:n.is}):(e=l.createElement(i),"select"===i&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,i);e[Nr]=t;e[Fr]=n;cs(e,t,!1,!1);t.stateNode=e;l=dr(i,n);switch(i){case"iframe":case"object":case"embed":rr("load",e);u=n;break;case"video":case"audio":for(u=0;u<rt.length;u++)rr(rt[u],e);u=n;break;case"source":rr("error",e);u=n;break;case"img":case"image":case"link":rr("error",e);rr("load",e);u=n;break;case"form":rr("reset",e);rr("submit",e);u=n;break;case"details":rr("toggle",e);u=n;break;case"input":Ce(e,n);u=Se(e,n);rr("invalid",e);mr(r,"onChange");break;case"option":u=Re(e,n);break;case"select":e._wrapperState={wasMultiple:!!n.multiple};u=a({},n,{value:void 0});rr("invalid",e);mr(r,"onChange");break;case"textarea":Fe(e,n);u=Ne(e,n);rr("invalid",e);mr(r,"onChange");break;default:u=n}pr(i,u);var c=u;for(s in c)if(c.hasOwnProperty(s)){var f=c[s];"style"===s?fr(e,f):"dangerouslySetInnerHTML"===s?(f=f?f.__html:void 0,null!=f&&qe(e,f)):"children"===s?"string"===typeof f?("textarea"!==i||""!==f)&&Ye(e,f):"number"===typeof f&&Ye(e,""+f):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(A.hasOwnProperty(s)?null!=f&&mr(r,s):null!=f&&te(e,s,f,l))}switch(i){case"input":Me(e);Oe(e,n,!1);break;case"textarea":Me(e);je(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Te(n.value));break;case"select":e.multiple=!!n.multiple;r=n.value;null!=r?ze(e,!!n.multiple,r,!1):null!=n.defaultValue&&ze(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof u.onClick&&(e.onclick=gr)}Lr(i,n)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)ps(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));r=Xi(Wi.current);Xi(qi.current);qo(t)?(r=t.stateNode,n=t.memoizedProps,r[Nr]=t,r.nodeValue!==n&&(t.effectTag|=4)):(r=(9===r.nodeType?r:r.ownerDocument).createTextNode(n),r[Nr]=t,t.stateNode=r)}return null;case 13:Ma($i);n=t.memoizedState;if(0!==(t.effectTag&64))return t.expirationTime=r,t;r=null!==n;n=!1;null===e?void 0!==t.memoizedProps.fallback&&qo(t):(i=e.memoizedState,n=null!==i,r||null===i||(i=e.child.sibling,null!==i&&(s=t.firstEffect,null!==s?(t.firstEffect=i,i.nextEffect=s):(t.firstEffect=t.lastEffect=i,i.nextEffect=null),i.effectTag=8)));if(r&&!n&&0!==(t.mode&2))if(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==($i.current&1))tl===qs&&(tl=Xs);else{if(tl===qs||tl===Xs)tl=Zs;0!==ol&&null!==Qs&&(hu(Qs,el),pu(Qs,ol))}if(r||n)t.effectTag|=4;return null;case 4:return Ki(),fs(t),null;case 10:return yi(t),null;case 17:return Pa(t.type)&&Da(),null;case 19:Ma($i);n=t.memoizedState;if(null===n)return null;i=0!==(t.effectTag&64);s=n.rendering;if(null===s)if(i)ds(n,!1);else{if(tl!==qs||null!==e&&0!==(e.effectTag&64))for(s=t.child;null!==s;){e=eo(s);if(null!==e){t.effectTag|=64;ds(n,!1);i=e.updateQueue;null!==i&&(t.updateQueue=i,t.effectTag|=4);null===n.lastEffect&&(t.firstEffect=null);t.lastEffect=n.lastEffect;for(n=t.child;null!==n;)i=n,s=r,i.effectTag&=2,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,e=i.alternate,null===e?(i.childExpirationTime=0,i.expirationTime=s,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null):(i.childExpirationTime=e.childExpirationTime,i.expirationTime=e.expirationTime,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,s=e.dependencies,i.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),n=n.sibling;Ea($i,$i.current&1|2);return t.child}s=s.sibling}}else{if(!i)if(e=eo(s),null!==e){if(t.effectTag|=64,i=!0,r=e.updateQueue,null!==r&&(t.updateQueue=r,t.effectTag|=4),ds(n,!0),null===n.tail&&"hidden"===n.tailMode&&!s.alternate)return t=t.lastEffect=n.lastEffect,null!==t&&(t.nextEffect=null),null}else 2*ni()-n.renderingStartTime>n.tailExpiration&&1<r&&(t.effectTag|=64,i=!0,ds(n,!1),t.expirationTime=t.childExpirationTime=r-1);n.isBackwards?(s.sibling=t.child,t.child=s):(r=n.last,null!==r?r.sibling=s:t.child=s,n.last=s)}return null!==n.tail?(0===n.tailExpiration&&(n.tailExpiration=ni()+500),r=n.tail,n.rendering=r,n.tail=r.sibling,n.lastEffect=t.lastEffect,n.renderingStartTime=ni(),r.sibling=null,t=$i.current,Ea($i,i?t&1|2:t&1),r):null}throw Error(o(156,t.tag))}function ms(e){switch(e.tag){case 1:Pa(e.type)&&Da();var t=e.effectTag;return t&4096?(e.effectTag=t&-4097|64,e):null;case 3:Ki();Ma(La);Ma(Ca);t=e.effectTag;if(0!==(t&64))throw Error(o(285));e.effectTag=t&-4097|64;return e;case 5:return Qi(e),null;case 13:return Ma($i),t=e.effectTag,t&4096?(e.effectTag=t&-4097|64,e):null;case 19:return Ma($i),null;case 4:return Ki(),null;case 10:return yi(e),null;default:return null}}function gs(e,t){return{value:e,source:t,stack:we(t)}}var ys="function"===typeof WeakSet?WeakSet:Set;function xs(e,t){var r=t.source,n=t.stack;null===n&&null!==r&&(n=we(r));null!==r&&be(r.type);t=t.value;null!==e&&1===e.tag&&be(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function _s(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Xl(e,t)}}function bs(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(t){Xl(e,t)}else t.current=null}function ws(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(t.effectTag&256&&null!==e){var r=e.memoizedProps,n=e.memoizedState;e=t.stateNode;t=e.getSnapshotBeforeUpdate(t.elementType===t.type?r:hi(t.type,r),n);e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(o(163))}function Ts(e,t){t=t.updateQueue;t=null!==t?t.lastEffect:null;if(null!==t){var r=t=t.next;do{if((r.tag&e)===e){var n=r.destroy;r.destroy=void 0;void 0!==n&&n()}r=r.next}while(r!==t)}}function ks(e,t){t=t.updateQueue;t=null!==t?t.lastEffect:null;if(null!==t){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function As(e,t,r){switch(r.tag){case 0:case 11:case 15:case 22:ks(3,r);return;case 1:e=r.stateNode;if(r.effectTag&4)if(null===t)e.componentDidMount();else{var n=r.elementType===r.type?t.memoizedProps:hi(r.type,t.memoizedProps);e.componentDidUpdate(n,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}t=r.updateQueue;null!==t&&Ci(r,t,e);return;case 3:t=r.updateQueue;if(null!==t){e=null;if(null!==r.child)switch(r.child.tag){case 5:e=r.child.stateNode;break;case 1:e=r.child.stateNode}Ci(r,t,e)}return;case 5:e=r.stateNode;null===t&&r.effectTag&4&&Lr(r.type,r.memoizedProps)&&e.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===r.memoizedState&&(r=r.alternate,null!==r&&(r=r.memoizedState,null!==r&&(r=r.dehydrated,null!==r&&qt(r))));return;case 19:case 17:case 20:case 21:return}throw Error(o(163))}function Ms(e,t,r){"function"===typeof $l&&$l(t);switch(t.tag){case 0:case 11:case 14:case 15:case 22:e=t.updateQueue;if(null!==e&&(e=e.lastEffect,null!==e)){var n=e.next;oi(97<r?97:r,function(){var e=n;do{var r=e.destroy;if(void 0!==r){var a=t;try{r()}catch(e){Xl(a,e)}}e=e.next}while(e!==n)})}break;case 1:bs(t);r=t.stateNode;"function"===typeof r.componentWillUnmount&&_s(t,r);break;case 5:bs(t);break;case 4:Os(e,t,r)}}function Es(e){var t=e.alternate;e.return=null;e.child=null;e.memoizedState=null;e.updateQueue=null;e.dependencies=null;e.alternate=null;e.firstEffect=null;e.lastEffect=null;e.pendingProps=null;e.memoizedProps=null;e.stateNode=null;null!==t&&Es(t)}function Ss(e){return 5===e.tag||3===e.tag||4===e.tag}function Cs(e){e:{for(var t=e.return;null!==t;){if(Ss(t)){var r=t;break e}t=t.return}throw Error(o(160))}t=r.stateNode;switch(r.tag){case 5:var n=!1;break;case 3:t=t.containerInfo;n=!0;break;case 4:t=t.containerInfo;n=!0;break;default:throw Error(o(161))}r.effectTag&16&&(Ye(t,""),r.effectTag&=-17);e:t:for(r=e;;){for(;null===r.sibling;){if(null===r.return||Ss(r.return)){r=null;break e}r=r.return}r.sibling.return=r.return;for(r=r.sibling;5!==r.tag&&6!==r.tag&&18!==r.tag;){if(r.effectTag&2)continue t;if(null===r.child||4===r.tag)continue t;else r.child.return=r,r=r.child}if(!(r.effectTag&2)){r=r.stateNode;break e}}n?Ls(e,r,t):Is(e,r,t)}function Ls(e,t,r){var n=e.tag,a=5===n||6===n;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,null!==r&&void 0!==r||null!==t.onclick||(t.onclick=gr));else if(4!==n&&(e=e.child,null!==e))for(Ls(e,t,r),e=e.sibling;null!==e;)Ls(e,t,r),e=e.sibling}function Is(e,t,r){var n=e.tag,a=5===n||6===n;if(a)e=a?e.stateNode:e.stateNode.instance,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&(e=e.child,null!==e))for(Is(e,t,r),e=e.sibling;null!==e;)Is(e,t,r),e=e.sibling}function Os(e,t,r){for(var n=t,a=!1,i,s;;){if(!a){a=n.return;e:for(;;){if(null===a)throw Error(o(160));i=a.stateNode;switch(a.tag){case 5:s=!1;break e;case 3:i=i.containerInfo;s=!0;break e;case 4:i=i.containerInfo;s=!0;break e}a=a.return}a=!0}if(5===n.tag||6===n.tag){e:for(var l=e,u=n,c=r,f=u;;)if(Ms(l,f,c),null!==f.child&&4!==f.tag)f.child.return=f,f=f.child;else{if(f===u)break e;for(;null===f.sibling;){if(null===f.return||f.return===u)break e;f=f.return}f.sibling.return=f.return;f=f.sibling}s?(l=i,u=n.stateNode,8===l.nodeType?l.parentNode.removeChild(u):l.removeChild(u)):i.removeChild(n.stateNode)}else if(4===n.tag){if(null!==n.child){i=n.stateNode.containerInfo;s=!0;n.child.return=n;n=n.child;continue}}else if(Ms(e,n,r),null!==n.child){n.child.return=n;n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return;4===n.tag&&(a=!1)}n.sibling.return=n.return;n=n.sibling}}function Ps(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:Ts(3,t);return;case 1:return;case 5:var r=t.stateNode;if(null!=r){var n=t.memoizedProps,a=null!==e?e.memoizedProps:n;e=t.type;var i=t.updateQueue;t.updateQueue=null;if(null!==i){r[Fr]=n;"input"===e&&"radio"===n.type&&null!=n.name&&Le(r,n);dr(e,a);t=dr(e,n);for(a=0;a<i.length;a+=2){var s=i[a],l=i[a+1];"style"===s?fr(r,l):"dangerouslySetInnerHTML"===s?qe(r,l):"children"===s?Ye(r,l):te(r,s,l,t)}switch(e){case"input":Ie(r,n);break;case"textarea":Be(r,n);break;case"select":t=r._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!n.multiple,e=n.value,null!=e?ze(r,!!n.multiple,e,!1):t!==!!n.multiple&&(null!=n.defaultValue?ze(r,!!n.multiple,n.defaultValue,!0):ze(r,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(o(162));t.stateNode.nodeValue=t.memoizedProps;return;case 3:t=t.stateNode;t.hydrate&&(t.hydrate=!1,qt(t.containerInfo));return;case 12:return;case 13:r=t;null===t.memoizedState?n=!1:(n=!0,r=t.child,ll=ni());if(null!==r)e:for(e=r;;){if(5===e.tag)i=e.stateNode,n?(i=i.style,"function"===typeof i.setProperty?i.setProperty("display","none","important"):i.display="none"):(i=e.stateNode,a=e.memoizedProps.style,a=void 0!==a&&null!==a&&a.hasOwnProperty("display")?a.display:null,i.style.display=cr("display",a));else if(6===e.tag)e.stateNode.nodeValue=n?"":e.memoizedProps;else if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){i=e.child.sibling;i.return=e;e=i;continue}else if(null!==e.child){e.child.return=e;e=e.child;continue}if(e===r)break;for(;null===e.sibling;){if(null===e.return||e.return===r)break e;e=e.return}e.sibling.return=e.return;e=e.sibling}Ds(t);return;case 19:Ds(t);return;case 17:return}throw Error(o(163))}function Ds(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new ys);t.forEach(function(t){var n=Kl.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}var Rs="function"===typeof WeakMap?WeakMap:Map;function zs(e,t,r){r=Ai(r,null);r.tag=3;r.payload={element:null};var n=t.value;r.callback=function(){fl||(fl=!0,hl=n);xs(e,t)};return r}function Ns(e,t,r){r=Ai(r,null);r.tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){xs(e,t);return n(a)}}var i=e.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(r.callback=function(){"function"!==typeof n&&(null===pl?pl=new Set([this]):pl.add(this),xs(e,t));var r=t.stack;this.componentDidCatch(t.value,{componentStack:null!==r?r:""})});return r}var Fs=Math.ceil,Bs=ee.ReactCurrentDispatcher,js=ee.ReactCurrentOwner,Us=0,Hs=8,Vs=16,Gs=32,qs=0,Ys=1,Ws=2,Xs=3,Zs=4,Ks=5,Js=Us,Qs=null,$s=null,el=0,tl=qs,rl=null,nl=1073741823,al=1073741823,il=null,ol=0,sl=!1,ll=0,ul=500,cl=null,fl=!1,hl=null,pl=null,dl=!1,vl=null,ml=90,gl=null,yl=0,xl=null,_l=0;function bl(){return(Js&(Vs|Gs))!==Us?1073741821-(ni()/10|0):0!==_l?_l:_l=1073741821-(ni()/10|0)}function wl(e,t,r){t=t.mode;if(0===(t&2))return 1073741823;var n=ai();if(0===(t&4))return 99===n?1073741823:1073741822;if((Js&Vs)!==Us)return el;if(null!==r)e=fi(e,r.timeoutMs|0||5e3,250);else switch(n){case 99:e=1073741823;break;case 98:e=fi(e,150,100);break;case 97:case 96:e=fi(e,5e3,250);break;case 95:e=2;break;default:throw Error(o(326))}null!==Qs&&e===el&&--e;return e}function Tl(e,t){if(50<yl)throw yl=0,xl=null,Error(o(185));e=kl(e,t);if(null!==e){var r=ai();1073741823===t?(Js&Hs)!==Us&&(Js&(Vs|Gs))===Us?Sl(e):(Ml(e),Js===Us&&ui()):Ml(e);(Js&4)===Us||98!==r&&99!==r||(null===gl?gl=new Map([[e,t]]):(r=gl.get(e),(void 0===r||r>t)&&gl.set(e,t)))}}function kl(e,t){e.expirationTime<t&&(e.expirationTime=t);var r=e.alternate;null!==r&&r.expirationTime<t&&(r.expirationTime=t);var n=e.return,a=null;if(null===n&&3===e.tag)a=e.stateNode;else for(;null!==n;){r=n.alternate;n.childExpirationTime<t&&(n.childExpirationTime=t);null!==r&&r.childExpirationTime<t&&(r.childExpirationTime=t);if(null===n.return&&3===n.tag){a=n.stateNode;break}n=n.return}null!==a&&(Qs===a&&(zl(t),tl===Zs&&hu(a,el)),pu(a,t));return a}function Al(e){var t=e.lastExpiredTime;if(0!==t)return t;t=e.firstPendingTime;if(!fu(e,t))return t;var r=e.lastPingedTime;e=e.nextKnownPendingLevel;e=r>e?r:e;return 2>=e&&t!==e?0:e}function Ml(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=li(Sl.bind(null,e));else{var t=Al(e),r=e.callbackNode;if(0===t)null!==r&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var n=bl();1073741823===t?n=99:1===t||2===t?n=95:(n=10*(1073741821-t)-10*(1073741821-n),n=0>=n?99:250>=n?98:5250>=n?97:95);if(null!==r){var a=e.callbackPriority;if(e.callbackExpirationTime===t&&a>=n)return;r!==Ka&&Ua(r)}e.callbackExpirationTime=t;e.callbackPriority=n;t=1073741823===t?li(Sl.bind(null,e)):si(n,El.bind(null,e),{timeout:10*(1073741821-t)-ni()});e.callbackNode=t}}}function El(e,t){_l=0;if(t)return t=bl(),du(e,t),Ml(e),null;var r=Al(e);if(0!==r){t=e.callbackNode;if((Js&(Vs|Gs))!==Us)throw Error(o(327));ql();e===Qs&&r===el||Ol(e,r);if(null!==$s){var n=Js;Js|=Vs;var a=Dl();do{try{Fl();break}catch(t){Pl(e,t)}}while(1);gi();Js=n;Bs.current=a;if(tl===Ys)throw t=rl,Ol(e,r),hu(e,r),Ml(e),t;if(null===$s)switch(a=e.finishedWork=e.current.alternate,e.finishedExpirationTime=r,n=tl,Qs=null,n){case qs:case Ys:throw Error(o(345));case Ws:du(e,2<r?2:r);break;case Xs:hu(e,r);n=e.lastSuspendedTime;r===n&&(e.nextKnownPendingLevel=Ul(a));if(1073741823===nl&&(a=ll+ul-ni(),10<a)){if(sl){var i=e.lastPingedTime;if(0===i||i>=r){e.lastPingedTime=r;Ol(e,r);break}}i=Al(e);if(0!==i&&i!==r)break;if(0!==n&&n!==r){e.lastPingedTime=n;break}e.timeoutHandle=Or(Hl.bind(null,e),a);break}Hl(e);break;case Zs:hu(e,r);n=e.lastSuspendedTime;r===n&&(e.nextKnownPendingLevel=Ul(a));if(sl&&(a=e.lastPingedTime,0===a||a>=r)){e.lastPingedTime=r;Ol(e,r);break}a=Al(e);if(0!==a&&a!==r)break;if(0!==n&&n!==r){e.lastPingedTime=n;break}1073741823!==al?n=10*(1073741821-al)-ni():1073741823===nl?n=0:(n=10*(1073741821-nl)-5e3,a=ni(),r=10*(1073741821-r)-a,n=a-n,0>n&&(n=0),n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Fs(n/1960))-n,r<n&&(n=r));if(10<n){e.timeoutHandle=Or(Hl.bind(null,e),n);break}Hl(e);break;case Ks:if(1073741823!==nl&&null!==il){i=nl;var s=il;n=s.busyMinDurationMs|0;0>=n?n=0:(a=s.busyDelayMs|0,i=ni()-(10*(1073741821-i)-(s.timeoutMs|0||5e3)),n=i<=a?0:a+n-i);if(10<n){hu(e,r);e.timeoutHandle=Or(Hl.bind(null,e),n);break}}Hl(e);break;default:throw Error(o(329))}Ml(e);if(e.callbackNode===t)return El.bind(null,e)}}return null}function Sl(e){var t=e.lastExpiredTime;t=0!==t?t:1073741823;if((Js&(Vs|Gs))!==Us)throw Error(o(327));ql();e===Qs&&t===el||Ol(e,t);if(null!==$s){var r=Js;Js|=Vs;var n=Dl();do{try{Nl();break}catch(t){Pl(e,t)}}while(1);gi();Js=r;Bs.current=n;if(tl===Ys)throw r=rl,Ol(e,t),hu(e,t),Ml(e),r;if(null!==$s)throw Error(o(261));e.finishedWork=e.current.alternate;e.finishedExpirationTime=t;Qs=null;Hl(e);Ml(e)}return null}function Cl(){if(null!==gl){var e=gl;gl=null;e.forEach(function(e,t){du(t,e);Ml(t)});ui()}}function Ll(e,t){var r=Js;Js|=1;try{return e(t)}finally{Js=r,Js===Us&&ui()}}function Il(e,t){var r=Js;Js&=-2;Js|=Hs;try{return e(t)}finally{Js=r,Js===Us&&ui()}}function Ol(e,t){e.finishedWork=null;e.finishedExpirationTime=0;var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,Pr(r));if(null!==$s)for(r=$s.return;null!==r;){var n=r;switch(n.tag){case 1:n=n.type.childContextTypes;null!==n&&void 0!==n&&Da();break;case 3:Ki();Ma(La);Ma(Ca);break;case 5:Qi(n);break;case 4:Ki();break;case 13:Ma($i);break;case 19:Ma($i);break;case 10:yi(n)}r=r.return}Qs=e;$s=iu(e.current,null);el=t;tl=qs;rl=null;al=nl=1073741823;il=null;ol=0;sl=!1}function Pl(e,t){do{try{gi();ro.current=Do;if(lo)for(var r=io.memoizedState;null!==r;){var n=r.queue;null!==n&&(n.pending=null);r=r.next}ao=0;so=oo=io=null;lo=!1;if(null===$s||null===$s.return)return tl=Ys,rl=t,$s=null;e:{var a=e,i=$s.return,o=$s,s=t;t=el;o.effectTag|=2048;o.firstEffect=o.lastEffect=null;if(null!==s&&"object"===typeof s&&"function"===typeof s.then){var l=s;if(0===(o.mode&2)){var u=o.alternate;u?(o.updateQueue=u.updateQueue,o.memoizedState=u.memoizedState,o.expirationTime=u.expirationTime):(o.updateQueue=null,o.memoizedState=null)}var c=0!==($i.current&1),f=i;do{var h;if(h=13===f.tag){var p=f.memoizedState;if(null!==p)h=null!==p.dehydrated?!0:!1;else{var d=f.memoizedProps;h=void 0===d.fallback?!1:!0!==d.unstable_avoidThisFallback?!0:c?!1:!0}}if(h){var v=f.updateQueue;if(null===v){var m=new Set;m.add(l);f.updateQueue=m}else v.add(l);if(0===(f.mode&2)){f.effectTag|=64;o.effectTag&=-2981;if(1===o.tag)if(null===o.alternate)o.tag=17;else{var g=Ai(1073741823,null);g.tag=2;Mi(o,g)}o.expirationTime=1073741823;break e}s=void 0;o=t;var y=a.pingCache;null===y?(y=a.pingCache=new Rs,s=new Set,y.set(l,s)):(s=y.get(l),void 0===s&&(s=new Set,y.set(l,s)));if(!s.has(o)){s.add(o);var x=Zl.bind(null,a,l,o);l.then(x,x)}f.effectTag|=4096;f.expirationTime=t;break e}f=f.return}while(null!==f);s=Error((be(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+we(o))}tl!==Ks&&(tl=Ws);s=gs(s,o);f=i;do{switch(f.tag){case 3:l=s;f.effectTag|=4096;f.expirationTime=t;var _=zs(f,l,t);Ei(f,_);break e;case 1:l=s;var b=f.type,w=f.stateNode;if(0===(f.effectTag&64)&&("function"===typeof b.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===pl||!pl.has(w)))){f.effectTag|=4096;f.expirationTime=t;var T=Ns(f,l,t);Ei(f,T);break e}}f=f.return}while(null!==f)}$s=jl($s)}catch(e){t=e;continue}break}while(1)}function Dl(){var e=Bs.current;Bs.current=Do;return null===e?Do:e}function Rl(e,t){e<nl&&2<e&&(nl=e);null!==t&&e<al&&2<e&&(al=e,il=t)}function zl(e){e>ol&&(ol=e)}function Nl(){for(;null!==$s;)$s=Bl($s)}function Fl(){for(;null!==$s&&!Ja();)$s=Bl($s)}function Bl(e){var t=Jl(e.alternate,e,el);e.memoizedProps=e.pendingProps;null===t&&(t=jl(e));js.current=null;return t}function jl(e){$s=e;do{var t=$s.alternate;e=$s.return;if(0===($s.effectTag&2048)){t=vs(t,$s,el);if(1===el||1!==$s.childExpirationTime){for(var r=0,n=$s.child;null!==n;){var a=n.expirationTime,i=n.childExpirationTime;a>r&&(r=a);i>r&&(r=i);n=n.sibling}$s.childExpirationTime=r}if(null!==t)return t;null!==e&&0===(e.effectTag&2048)&&(null===e.firstEffect&&(e.firstEffect=$s.firstEffect),null!==$s.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=$s.firstEffect),e.lastEffect=$s.lastEffect),1<$s.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=$s:e.firstEffect=$s,e.lastEffect=$s))}else{t=ms($s);if(null!==t)return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}t=$s.sibling;if(null!==t)return t;$s=e}while(null!==$s);tl===qs&&(tl=Ks);return null}function Ul(e){var t=e.expirationTime;e=e.childExpirationTime;return t>e?t:e}function Hl(e){var t=ai();oi(99,Vl.bind(null,e,t));return null}function Vl(e,t){do{ql()}while(null!==vl);if((Js&(Vs|Gs))!==Us)throw Error(o(327));var r=e.finishedWork,n=e.finishedExpirationTime;if(null===r)return null;e.finishedWork=null;e.finishedExpirationTime=0;if(r===e.current)throw Error(o(177));e.callbackNode=null;e.callbackExpirationTime=0;e.callbackPriority=90;e.nextKnownPendingLevel=0;var a=Ul(r);e.firstPendingTime=a;n<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:n<=e.firstSuspendedTime&&(e.firstSuspendedTime=n-1);n<=e.lastPingedTime&&(e.lastPingedTime=0);n<=e.lastExpiredTime&&(e.lastExpiredTime=0);e===Qs&&($s=Qs=null,el=0);1<r.effectTag?null!==r.lastEffect?(r.lastEffect.nextEffect=r,a=r.firstEffect):a=r:a=r.firstEffect;if(null!==a){var i=Js;Js|=Gs;js.current=null;Sr=tr;var s=wr();if(Tr(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&0!==u.rangeCount){l=u.anchorNode;var c=u.anchorOffset,f=u.focusNode;u=u.focusOffset;try{l.nodeType,f.nodeType}catch(e){l=null;break e}var h=0,p=-1,d=-1,v=0,m=0,g=s,y=null;t:for(;;){for(var x;;){g!==l||0!==c&&3!==g.nodeType||(p=h+c);g!==f||0!==u&&3!==g.nodeType||(d=h+u);3===g.nodeType&&(h+=g.nodeValue.length);if(null===(x=g.firstChild))break;y=g;g=x}for(;;){if(g===s)break t;y===l&&++v===c&&(p=h);y===f&&++m===u&&(d=h);if(null!==(x=g.nextSibling))break;g=y;y=g.parentNode}g=x}l=-1===p||-1===d?null:{start:p,end:d}}else l=null}l=l||{start:0,end:0}}else l=null;Cr={activeElementDetached:null,focusedElem:s,selectionRange:l};tr=!1;cl=a;do{try{Gl()}catch(e){if(null===cl)throw Error(o(330));Xl(cl,e);cl=cl.nextEffect}}while(null!==cl);cl=a;do{try{for(s=e,l=t;null!==cl;){var _=cl.effectTag;_&16&&Ye(cl.stateNode,"");if(_&128){var b=cl.alternate;if(null!==b){var w=b.ref;null!==w&&("function"===typeof w?w(null):w.current=null)}}switch(_&1038){case 2:Cs(cl);cl.effectTag&=-3;break;case 6:Cs(cl);cl.effectTag&=-3;Ps(cl.alternate,cl);break;case 1024:cl.effectTag&=-1025;break;case 1028:cl.effectTag&=-1025;Ps(cl.alternate,cl);break;case 4:Ps(cl.alternate,cl);break;case 8:c=cl,Os(s,c,l),Es(c)}cl=cl.nextEffect}}catch(e){if(null===cl)throw Error(o(330));Xl(cl,e);cl=cl.nextEffect}}while(null!==cl);w=Cr;b=wr();_=w.focusedElem;l=w.selectionRange;if(b!==_&&_&&_.ownerDocument&&br(_.ownerDocument.documentElement,_)){null!==l&&Tr(_)&&(b=l.start,w=l.end,void 0===w&&(w=b),"selectionStart"in _?(_.selectionStart=b,_.selectionEnd=Math.min(w,_.value.length)):(w=(b=_.ownerDocument||document)&&b.defaultView||window,w.getSelection&&(w=w.getSelection(),c=_.textContent.length,s=Math.min(l.start,c),l=void 0===l.end?s:Math.min(l.end,c),!w.extend&&s>l&&(c=l,l=s,s=c),c=_r(_,s),f=_r(_,l),c&&f&&(1!==w.rangeCount||w.anchorNode!==c.node||w.anchorOffset!==c.offset||w.focusNode!==f.node||w.focusOffset!==f.offset)&&(b=b.createRange(),b.setStart(c.node,c.offset),w.removeAllRanges(),s>l?(w.addRange(b),w.extend(f.node,f.offset)):(b.setEnd(f.node,f.offset),w.addRange(b))))));b=[];for(w=_;w=w.parentNode;)1===w.nodeType&&b.push({element:w,left:w.scrollLeft,top:w.scrollTop});"function"===typeof _.focus&&_.focus();for(_=0;_<b.length;_++)w=b[_],w.element.scrollLeft=w.left,w.element.scrollTop=w.top}tr=!!Sr;Cr=Sr=null;e.current=r;cl=a;do{try{for(_=e;null!==cl;){var T=cl.effectTag;T&36&&As(_,cl.alternate,cl);if(T&128){b=void 0;var k=cl.ref;if(null!==k){var A=cl.stateNode;switch(cl.tag){case 5:b=A;break;default:b=A}"function"===typeof k?k(b):k.current=b}}cl=cl.nextEffect}}catch(e){if(null===cl)throw Error(o(330));Xl(cl,e);cl=cl.nextEffect}}while(null!==cl);cl=null;Qa();Js=i}else e.current=r;if(dl)dl=!1,vl=e,ml=t;else for(cl=a;null!==cl;)t=cl.nextEffect,cl.nextEffect=null,cl=t;t=e.firstPendingTime;0===t&&(pl=null);1073741823===t?e===xl?yl++:(yl=0,xl=e):yl=0;"function"===typeof Ql&&Ql(r.stateNode,n);Ml(e);if(fl)throw fl=!1,e=hl,hl=null,e;if((Js&Hs)!==Us)return null;ui();return null}function Gl(){for(;null!==cl;){var e=cl.effectTag;0!==(e&256)&&ws(cl.alternate,cl);0===(e&512)||dl||(dl=!0,si(97,function(){ql();return null}));cl=cl.nextEffect}}function ql(){if(90!==ml){var e=97<ml?97:ml;ml=90;return oi(e,Yl)}}function Yl(){if(null===vl)return!1;var e=vl;vl=null;if((Js&(Vs|Gs))!==Us)throw Error(o(331));var t=Js;Js|=Gs;for(e=e.current.firstEffect;null!==e;){try{var r=e;if(0!==(r.effectTag&512))switch(r.tag){case 0:case 11:case 15:case 22:Ts(5,r),ks(5,r)}}catch(t){if(null===e)throw Error(o(330));Xl(e,t)}r=e.nextEffect;e.nextEffect=null;e=r}Js=t;ui();return!0}function Wl(e,t,r){t=gs(r,t);t=zs(e,t,1073741823);Mi(e,t);e=kl(e,1073741823);null!==e&&Ml(e)}function Xl(e,t){if(3===e.tag)Wl(e,e,t);else for(var r=e.return;null!==r;){if(3===r.tag){Wl(r,e,t);break}else if(1===r.tag){var n=r.stateNode;if("function"===typeof r.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===pl||!pl.has(n))){e=gs(t,e);e=Ns(r,e,1073741823);Mi(r,e);r=kl(r,1073741823);null!==r&&Ml(r);break}}r=r.return}}function Zl(e,t,r){var n=e.pingCache;null!==n&&n.delete(t);Qs===e&&el===r?tl===Zs||tl===Xs&&1073741823===nl&&ni()-ll<ul?Ol(e,el):sl=!0:fu(e,r)&&(t=e.lastPingedTime,0!==t&&t<r||(e.lastPingedTime=r,Ml(e)))}function Kl(e,t){var r=e.stateNode;null!==r&&r.delete(t);t=0;0===t&&(t=bl(),t=wl(t,e,null));e=kl(e,t);null!==e&&Ml(e)}var Jl;Jl=function(e,t,r){var n=t.expirationTime;if(null!==e){var a=t.pendingProps;if(e.memoizedProps!==a||La.current)Xo=!0;else{if(n<r){Xo=!1;switch(t.tag){case 3:ns(t);Yo();break;case 5:Ji(t);if(t.mode&4&&1!==r&&a.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:Pa(t.type)&&Na(t);break;case 4:Zi(t,t.stateNode.containerInfo);break;case 10:n=t.memoizedProps.value;a=t.type._context;Ea(pi,a._currentValue);a._currentValue=n;break;case 13:if(null!==t.memoizedState){n=t.child.childExpirationTime;if(0!==n&&n>=r)return is(e,t,r);Ea($i,$i.current&1);t=us(e,t,r);return null!==t?t.sibling:null}Ea($i,$i.current&1);break;case 19:n=t.childExpirationTime>=r;if(0!==(e.effectTag&64)){if(n)return ls(e,t,r);t.effectTag|=64}a=t.memoizedState;null!==a&&(a.rendering=null,a.tail=null);Ea($i,$i.current);if(!n)return null}return us(e,t,r)}Xo=!1}}else Xo=!1;t.expirationTime=0;switch(t.tag){case 2:n=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2);e=t.pendingProps;a=Oa(t,Ca.current);_i(t,r);a=fo(null,t,n,e,a,r);t.effectTag|=1;if("object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){t.tag=1;t.memoizedState=null;t.updateQueue=null;if(Pa(n)){var i=!0;Na(t)}else i=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null;Ti(t);var s=n.getDerivedStateFromProps;"function"===typeof s&&Oi(t,n,s,e);a.updater=Pi;t.stateNode=a;a._reactInternalFiber=t;Ni(t,n,e,r);t=rs(null,t,n,!0,i,r)}else t.tag=0,Zo(null,t,a,r),t=t.child;return t;case 16:e:{a=t.elementType;null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2);e=t.pendingProps;_e(a);if(1!==a._status)throw a._result;a=a._result;t.type=a;i=t.tag=au(a);e=hi(a,e);switch(i){case 0:t=es(null,t,a,e,r);break e;case 1:t=ts(null,t,a,e,r);break e;case 11:t=Ko(null,t,a,e,r);break e;case 14:t=Jo(null,t,a,hi(a.type,e),n,r);break e}throw Error(o(306,a,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:hi(n,a),es(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:hi(n,a),ts(e,t,n,a,r);case 3:ns(t);n=t.updateQueue;if(null===e||null===n)throw Error(o(282));n=t.pendingProps;a=t.memoizedState;a=null!==a?a.element:null;ki(e,t);Si(t,n,null,r);n=t.memoizedState.element;if(n===a)Yo(),t=us(e,t,r);else{if(a=t.stateNode.hydrate)Bo=Dr(t.stateNode.containerInfo.firstChild),Fo=t,a=jo=!0;if(a)for(r=Vi(t,null,n,r),t.child=r;r;)r.effectTag=r.effectTag&-3|1024,r=r.sibling;else Zo(e,t,n,r),Yo();t=t.child}return t;case 5:return Ji(t),null===e&&Vo(t),n=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,s=a.children,Ir(n,a)?s=null:null!==i&&Ir(n,i)&&(t.effectTag|=16),$o(e,t),t.mode&4&&1!==r&&a.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Zo(e,t,s,r),t=t.child),t;case 6:return null===e&&Vo(t),null;case 13:return is(e,t,r);case 4:return Zi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Hi(t,null,n,r):Zo(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:hi(n,a),Ko(e,t,n,a,r);case 7:return Zo(e,t,t.pendingProps,r),t.child;case 8:return Zo(e,t,t.pendingProps.children,r),t.child;case 12:return Zo(e,t,t.pendingProps.children,r),t.child;case 10:e:{n=t.type._context;a=t.pendingProps;s=t.memoizedProps;i=a.value;var l=t.type._context;Ea(pi,l._currentValue);l._currentValue=i;if(null!==s)if(l=s.value,i=ea(l,i)?0:("function"===typeof n._calculateChangedBits?n._calculateChangedBits(l,i):1073741823)|0,0===i){if(s.children===a.children&&!La.current){t=us(e,t,r);break e}}else for(l=t.child,null!==l&&(l.return=t);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===n&&0!==(c.observedBits&i)){1===l.tag&&(c=Ai(r,null),c.tag=2,Mi(l,c));l.expirationTime<r&&(l.expirationTime=r);c=l.alternate;null!==c&&c.expirationTime<r&&(c.expirationTime=r);xi(l.return,r);u.expirationTime<r&&(u.expirationTime=r);break}c=c.next}}else s=10===l.tag?l.type===t.type?null:l.child:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===t){s=null;break}l=s.sibling;if(null!==l){l.return=s.return;s=l;break}s=s.return}l=s}Zo(e,t,a.children,r);t=t.child}return t;case 9:return a=t.type,i=t.pendingProps,n=i.children,_i(t,r),a=bi(a,i.unstable_observedBits),n=n(a),t.effectTag|=1,Zo(e,t,n,r),t.child;case 14:return a=t.type,i=hi(a,t.pendingProps),i=hi(a.type,i),Jo(e,t,a,i,n,r);case 15:return Qo(e,t,t.type,t.pendingProps,n,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:hi(n,a),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,Pa(n)?(e=!0,Na(t)):e=!1,_i(t,r),Ri(t,n,a),Ni(t,n,a,r),rs(null,t,n,!0,e,r);case 19:return ls(e,t,r)}throw Error(o(156,t.tag))};var Ql=null,$l=null;function eu(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var r=t.inject(e);Ql=function(e){try{t.onCommitFiberRoot(r,e,void 0,64===(e.current.effectTag&64))}catch(e){}};$l=function(e){try{t.onCommitFiberUnmount(r,e)}catch(e){}}}catch(e){}return!0}function tu(e,t,r,n){this.tag=e;this.key=r;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=t;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=n;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function ru(e,t,r,n){return new tu(e,t,r,n)}function nu(e){e=e.prototype;return!(!e||!e.isReactComponent)}function au(e){if("function"===typeof e)return nu(e)?1:0;if(void 0!==e&&null!==e){e=e.$$typeof;if(e===he)return 11;if(e===ve)return 14}return 2}function iu(e,t){var r=e.alternate;null===r?(r=ru(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.effectTag=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null);r.childExpirationTime=e.childExpirationTime;r.expirationTime=e.expirationTime;r.child=e.child;r.memoizedProps=e.memoizedProps;r.memoizedState=e.memoizedState;r.updateQueue=e.updateQueue;t=e.dependencies;r.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders};r.sibling=e.sibling;r.index=e.index;r.ref=e.ref;return r}function ou(e,t,r,n,a,i){var s=2;n=e;if("function"===typeof e)nu(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case oe:return su(r.children,a,i,t);case fe:s=8;a|=7;break;case se:s=8;a|=1;break;case le:return e=ru(12,r,t,a|8),e.elementType=le,e.type=le,e.expirationTime=i,e;case pe:return e=ru(13,r,t,a),e.type=pe,e.elementType=pe,e.expirationTime=i,e;case de:return e=ru(19,r,t,a),e.elementType=de,e.expirationTime=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case ue:s=10;break e;case ce:s=9;break e;case he:s=11;break e;case ve:s=14;break e;case me:s=16;n=null;break e;case ge:s=22;break e}throw Error(o(130,null==e?e:typeof e,""))}t=ru(s,r,t,a);t.elementType=e;t.type=n;t.expirationTime=i;return t}function su(e,t,r,n){e=ru(7,e,n,t);e.expirationTime=r;return e}function lu(e,t,r){e=ru(6,e,null,t);e.expirationTime=r;return e}function uu(e,t,r){t=ru(4,null!==e.children?e.children:[],e.key,t);t.expirationTime=r;t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation};return t}function cu(e,t,r){this.tag=t;this.current=null;this.containerInfo=e;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=r;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function fu(e,t){var r=e.firstSuspendedTime;e=e.lastSuspendedTime;return 0!==r&&r>=t&&e<=t}function hu(e,t){var r=e.firstSuspendedTime,n=e.lastSuspendedTime;r<t&&(e.firstSuspendedTime=t);if(n>t||0===r)e.lastSuspendedTime=t;t<=e.lastPingedTime&&(e.lastPingedTime=0);t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function pu(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var r=e.firstSuspendedTime;0!==r&&(t>=r?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function du(e,t){var r=e.lastExpiredTime;if(0===r||r>t)e.lastExpiredTime=t}function vu(e,t,r,n){var a=t.current,i=bl(),s=Li.suspense;i=wl(i,a,s);e:if(r){r=r._reactInternalFiber;t:{if(it(r)!==r||1!==r.tag)throw Error(o(170));var l=r;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(Pa(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(o(171))}if(1===r.tag){var u=r.type;if(Pa(u)){r=za(r,u,l);break e}}r=l}else r=Sa;null===t.context?t.context=r:t.pendingContext=r;t=Ai(i,s);t.payload={element:e};n=void 0===n?null:n;null!==n&&(t.callback=n);Mi(a,t);Tl(a,i);return i}function mu(e){e=e.current;if(!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function gu(e,t){e=e.memoizedState;null!==e&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function yu(e,t){gu(e,t);(e=e.alternate)&&gu(e,t)}function xu(e,t,r){r=null!=r&&!0===r.hydrate;var n=new cu(e,t,r),a=ru(3,null,null,2===t?7:1===t?3:0);n.current=a;a.stateNode=n;Ti(a);e[Br]=n.current;r&&0!==t&&Rt(e,9===e.nodeType?e:e.ownerDocument);this._internalRoot=n}xu.prototype.render=function(e){vu(e,this._internalRoot,null,null)};xu.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;vu(null,e,null,function(){t[Br]=null})};function _u(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function bu(e,t){t||(t=e?9===e.nodeType?e.documentElement:e.firstChild:null,t=!(!t||1!==t.nodeType||!t.hasAttribute("data-reactroot")));if(!t)for(var r;r=e.lastChild;)e.removeChild(r);return new xu(e,0,t?{hydrate:!0}:void 0)}function wu(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i._internalRoot;if("function"===typeof a){var s=a;a=function(){var e=mu(o);s.call(e)}}vu(t,o,e,a)}else{i=r._reactRootContainer=bu(r,n);o=i._internalRoot;if("function"===typeof a){var l=a;a=function(){var e=mu(o);l.call(e)}}Il(function(){vu(t,o,e,a)})}return mu(o)}function Tu(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ie,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}wt=function(e){if(13===e.tag){var t=fi(bl(),150,100);Tl(e,t);yu(e,t)}};Tt=function(e){13===e.tag&&(Tl(e,3),yu(e,3))};kt=function(e){if(13===e.tag){var t=bl();t=wl(t,e,null);Tl(e,t);yu(e,t)}};C=function(e,t,r){switch(t){case"input":Ie(e,r);t=r.name;if("radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]');for(t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Vr(n);if(!a)throw Error(o(90));Ee(n);Ie(n,a)}}}break;case"textarea":Be(e,r);break;case"select":t=r.value,null!=t&&ze(e,!!r.multiple,t,!1)}};R=Ll;z=function(e,t,r,n,a){var i=Js;Js|=4;try{return oi(98,e.bind(null,t,r,n,a))}finally{Js=i,Js===Us&&ui()}};N=function(){(Js&(1|Vs|Gs))===Us&&(Cl(),ql())};F=function(e,t){var r=Js;Js|=2;try{return e(t)}finally{Js=r,Js===Us&&ui()}};function ku(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!_u(t))throw Error(o(200));return Tu(e,t,null,r)}var Au={Events:[Ur,Hr,Vr,E,k,Kr,function(e){ft(e,Zr)},P,D,or,dt,ql,{current:!1}]};(function(e){var t=e.findFiberByHostInstance;return eu(a({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ee.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){e=ut(e);return null===e?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:jr,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"});t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Au;t.createPortal=ku;t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw Error(o(268,Object.keys(e)))}e=ut(t);e=null===e?null:e.stateNode;return e};t.flushSync=function(e,t){if((Js&(Vs|Gs))!==Us)throw Error(o(187));var r=Js;Js|=1;try{return oi(99,e.bind(null,t))}finally{Js=r,ui()}};t.hydrate=function(e,t,r){if(!_u(t))throw Error(o(200));return wu(null,e,t,!0,r)};t.render=function(e,t,r){if(!_u(t))throw Error(o(200));return wu(null,e,t,!1,r)};t.unmountComponentAtNode=function(e){if(!_u(e))throw Error(o(40));return e._reactRootContainer?(Il(function(){wu(null,null,e,!1,function(){e._reactRootContainer=null;e[Br]=null})}),!0):!1};t.unstable_batchedUpdates=Ll;t.unstable_createPortal=function(e,t){return ku(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!_u(r))throw Error(o(200));if(null==e||void 0===e._reactInternalFiber)throw Error(o(38));return wu(e,t,r,!1,n)};t.version="16.13.1"},533:function(e,t,r){"use strict";if(true){e.exports=r(534)}else{}},534:function(e,t,r){"use strict";
/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n,a,i,o,s;if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,u=null,c=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e);l=null}catch(e){throw setTimeout(c,0),e}},f=Date.now();t.unstable_now=function(){return Date.now()-f};n=function(e){null!==l?setTimeout(n,0,e):(l=e,setTimeout(c,0))};a=function(e,t){u=setTimeout(e,t)};i=function(){clearTimeout(u)};o=function(){return!1};s=t.unstable_forceFrameRate=function(){}}else{var h=window.performance,p=window.Date,d=window.setTimeout,v=window.clearTimeout;if("undefined"!==typeof console){var m=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills");"function"!==typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof h&&"function"===typeof h.now)t.unstable_now=function(){return h.now()};else{var g=p.now();t.unstable_now=function(){return p.now()-g}}var y=!1,x=null,_=-1,b=5,w=0;o=function(){return t.unstable_now()>=w};s=function(){};t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):b=0<e?Math.floor(1e3/e):5};var T=new MessageChannel,k=T.port2;T.port1.onmessage=function(){if(null!==x){var e=t.unstable_now();w=e+b;try{x(!0,e)?k.postMessage(null):(y=!1,x=null)}catch(e){throw k.postMessage(null),e}}else y=!1};n=function(e){x=e;y||(y=!0,k.postMessage(null))};a=function(e,r){_=d(function(){e(t.unstable_now())},r)};i=function(){v(_);_=-1}}function A(e,t){var r=e.length;e.push(t);e:for(;;){var n=r-1>>>1,a=e[n];if(void 0!==a&&0<S(a,t))e[n]=t,e[r]=a,r=n;else break e}}function M(e){e=e[0];return void 0===e?null:e}function E(e){var t=e[0];if(void 0!==t){var r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length;n<a;){var i=2*(n+1)-1,o=e[i],s=i+1,l=e[s];if(void 0!==o&&0>S(o,r))void 0!==l&&0>S(l,o)?(e[n]=l,e[s]=r,n=s):(e[n]=o,e[i]=r,n=i);else if(void 0!==l&&0>S(l,r))e[n]=l,e[s]=r,n=s;else break e}}return t}return null}function S(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}var C=[],L=[],I=1,O=null,P=3,D=!1,R=!1,z=!1;function N(e){for(var t=M(L);null!==t;){if(null===t.callback)E(L);else if(t.startTime<=e)E(L),t.sortIndex=t.expirationTime,A(C,t);else break;t=M(L)}}function F(e){z=!1;N(e);if(!R)if(null!==M(C))R=!0,n(B);else{var t=M(L);null!==t&&a(F,t.startTime-e)}}function B(e,r){R=!1;z&&(z=!1,i());D=!0;var n=P;try{N(r);for(O=M(C);null!==O&&(!(O.expirationTime>r)||e&&!o());){var s=O.callback;if(null!==s){O.callback=null;P=O.priorityLevel;var l=s(O.expirationTime<=r);r=t.unstable_now();"function"===typeof l?O.callback=l:O===M(C)&&E(C);N(r)}else E(C);O=M(C)}if(null!==O)var u=!0;else{var c=M(L);null!==c&&a(F,c.startTime-r);u=!1}return u}finally{O=null,P=n,D=!1}}function j(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var U=s;t.unstable_IdlePriority=5;t.unstable_ImmediatePriority=1;t.unstable_LowPriority=4;t.unstable_NormalPriority=3;t.unstable_Profiling=null;t.unstable_UserBlockingPriority=2;t.unstable_cancelCallback=function(e){e.callback=null};t.unstable_continueExecution=function(){R||D||(R=!0,n(B))};t.unstable_getCurrentPriorityLevel=function(){return P};t.unstable_getFirstCallbackNode=function(){return M(C)};t.unstable_next=function(e){switch(P){case 1:case 2:case 3:var t=3;break;default:t=P}var r=P;P=t;try{return e()}finally{P=r}};t.unstable_pauseExecution=function(){};t.unstable_requestPaint=U;t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=P;P=e;try{return t()}finally{P=r}};t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();if("object"===typeof o&&null!==o){var l=o.delay;l="number"===typeof l&&0<l?s+l:s;o="number"===typeof o.timeout?o.timeout:j(e)}else o=j(e),l=s;o=l+o;e={id:I++,callback:r,priorityLevel:e,startTime:l,expirationTime:o,sortIndex:-1};l>s?(e.sortIndex=l,A(L,e),null===M(C)&&e===M(L)&&(z?i():z=!0,a(F,l-s))):(e.sortIndex=o,A(C,e),R||D||(R=!0,n(B)));return e};t.unstable_shouldYield=function(){var e=t.unstable_now();N(e);var r=M(C);return r!==O&&null!==O&&null!==r&&null!==r.callback&&r.startTime<=e&&r.expirationTime<O.expirationTime||o()};t.unstable_wrapCallback=function(e){var t=P;return function(){var r=P;P=t;try{return e.apply(this,arguments)}finally{P=r}}}},535:function(e,t,r){"use strict";var n=r(201),a=r(204);t.parse=function e(t,r){var a=new n(r);return a.parse(t)};t.parseFragment=function e(t,r,a){if(typeof t==="string"){a=r;r=t;t=null}var i=new n(a);return i.parseFragment(r,t)};t.serialize=function(e,t){var r=new a(e,t);return r.serialize()};t.treeAdapters={default:r(133),htmlparser2:r(541)};t.ParserStream=r(542);t.SerializerStream=r(543);t.SAXParser=r(544)},536:function(e,t,r){"use strict";var n=r(83);var a=n.CODE_POINTS;function i(e,t){return e>=55296&&e<=56319&&t>=56320&&t<=57343}function o(e,t){return(e-55296)*1024+9216+t}var s=1<<16;var l=e.exports=function(){this.html=null;this.pos=-1;this.lastGapPos=-1;this.lastCharPos=-1;this.droppedBufferSize=0;this.gapStack=[];this.skipNextNewLine=false;this.lastChunkWritten=false;this.endOfChunkHit=false;this.bufferWaterline=s};Object.defineProperty(l.prototype,"sourcePos",{get:function(){return this.droppedBufferSize+this.pos}});l.prototype.dropParsedChunk=function(){if(this.pos>this.bufferWaterline){this.lastCharPos-=this.pos;this.droppedBufferSize+=this.pos;this.html=this.html.substring(this.pos);this.pos=0;this.lastGapPos=-1;this.gapStack=[]}};l.prototype._addGap=function(){this.gapStack.push(this.lastGapPos);this.lastGapPos=this.pos};l.prototype._processHighRangeCodePoint=function(e){if(this.pos!==this.lastCharPos){var t=this.html.charCodeAt(this.pos+1);if(i(e,t)){this.pos++;e=o(e,t);this._addGap()}}else if(!this.lastChunkWritten){this.endOfChunkHit=true;return a.EOF}return e};l.prototype.write=function(e,t){if(this.html)this.html+=e;else this.html=e;this.lastCharPos=this.html.length-1;this.endOfChunkHit=false;this.lastChunkWritten=t};l.prototype.insertHtmlAtCurrentPos=function(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1,this.html.length);this.lastCharPos=this.html.length-1;this.endOfChunkHit=false};l.prototype.advance=function(){this.pos++;if(this.pos>this.lastCharPos){if(!this.lastChunkWritten)this.endOfChunkHit=true;return a.EOF}var e=this.html.charCodeAt(this.pos);if(this.skipNextNewLine&&e===a.LINE_FEED){this.skipNextNewLine=false;this._addGap();return this.advance()}if(e===a.CARRIAGE_RETURN){this.skipNextNewLine=true;return a.LINE_FEED}this.skipNextNewLine=false;return e>=55296?this._processHighRangeCodePoint(e):e};l.prototype.retreat=function(){if(this.pos===this.lastGapPos){this.lastGapPos=this.gapStack.pop();this.pos--}this.pos--}},537:function(e,t,r){"use strict";var n=r(83);var a=n.CODE_POINTS;t.assign=function(e){var t=Object.getPrototypeOf(e),r=-1,n=-1,i=1,o=false,s=[0],l=0,u=-1,c=1;function f(e){e.location={line:i,col:n,startOffset:r,endOffset:-1}}e._consume=function(){var e=t._consume.call(this);if(o){o=false;c++;s.push(this.preprocessor.sourcePos);l=this.preprocessor.sourcePos}if(e===a.LINE_FEED)o=true;u=this.preprocessor.sourcePos-l+1;return e};e._unconsume=function(){t._unconsume.call(this);o=false;while(l>this.preprocessor.sourcePos&&s.length>1){l=s.pop();c--}u=this.preprocessor.sourcePos-l+1};e._createStartTagToken=function(){t._createStartTagToken.call(this);f(this.currentToken)};e._createEndTagToken=function(){t._createEndTagToken.call(this);f(this.currentToken)};e._createCommentToken=function(){t._createCommentToken.call(this);f(this.currentToken)};e._createDoctypeToken=function(e){t._createDoctypeToken.call(this,e);f(this.currentToken)};e._createCharacterToken=function(e,r){t._createCharacterToken.call(this,e,r);f(this.currentCharacterToken)};e._createAttr=function(e){t._createAttr.call(this,e);this.currentAttrLocation={line:c,col:u,startOffset:this.preprocessor.sourcePos,endOffset:-1}};e._leaveAttrName=function(e){t._leaveAttrName.call(this,e);this._attachCurrentAttrLocationInfo()};e._leaveAttrValue=function(e){t._leaveAttrValue.call(this,e);this._attachCurrentAttrLocationInfo()};e._attachCurrentAttrLocationInfo=function(){this.currentAttrLocation.endOffset=this.preprocessor.sourcePos;if(!this.currentToken.location.attrs)this.currentToken.location.attrs={};this.currentToken.location.attrs[this.currentAttr.name]=this.currentAttrLocation};e._emitCurrentToken=function(){if(this.currentCharacterToken)this.currentCharacterToken.location.endOffset=this.currentToken.location.startOffset;this.currentToken.location.endOffset=this.preprocessor.sourcePos+1;t._emitCurrentToken.call(this)};e._emitCurrentCharacterToken=function(){if(this.currentCharacterToken&&this.currentCharacterToken.location.endOffset===-1)this.currentCharacterToken.location.endOffset=this.preprocessor.sourcePos;t._emitCurrentCharacterToken.call(this)};Object.keys(t.MODE).map(function(e){return t.MODE[e]}).forEach(function(a){e[a]=function(e){r=this.preprocessor.sourcePos;i=c;n=u;t[a].call(this,e)}})}},538:function(e,t,r){"use strict";e.exports={65:{l:{69:{l:{108:{l:{105:{l:{103:{l:{59:{c:[198]}},c:[198]}}}}}}},77:{l:{80:{l:{59:{c:[38]}},c:[38]}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[193]}},c:[193]}}}}}}}}},98:{l:{114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[258]}}}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[194]}},c:[194]}}}}},121:{l:{59:{c:[1040]}}}}},102:{l:{114:{l:{59:{c:[120068]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[192]}},c:[192]}}}}}}}}},108:{l:{112:{l:{104:{l:{97:{l:{59:{c:[913]}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[256]}}}}}}}}},110:{l:{100:{l:{59:{c:[10835]}}}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[260]}}}}}}},112:{l:{102:{l:{59:{c:[120120]}}}}}}},112:{l:{112:{l:{108:{l:{121:{l:{70:{l:{117:{l:{110:{l:{99:{l:{116:{l:{105:{l:{111:{l:{110:{l:{59:{c:[8289]}}}}}}}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{110:{l:{103:{l:{59:{c:[197]}},c:[197]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119964]}}}}},115:{l:{105:{l:{103:{l:{110:{l:{59:{c:[8788]}}}}}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[195]}},c:[195]}}}}}}}}},117:{l:{109:{l:{108:{l:{59:{c:[196]}},c:[196]}}}}}}},66:{l:{97:{l:{99:{l:{107:{l:{115:{l:{108:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8726]}}}}}}}}}}}}}}},114:{l:{118:{l:{59:{c:[10983]}}},119:{l:{101:{l:{100:{l:{59:{c:[8966]}}}}}}}}}}},99:{l:{121:{l:{59:{c:[1041]}}}}},101:{l:{99:{l:{97:{l:{117:{l:{115:{l:{101:{l:{59:{c:[8757]}}}}}}}}}}},114:{l:{110:{l:{111:{l:{117:{l:{108:{l:{108:{l:{105:{l:{115:{l:{59:{c:[8492]}}}}}}}}}}}}}}}}},116:{l:{97:{l:{59:{c:[914]}}}}}}},102:{l:{114:{l:{59:{c:[120069]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120121]}}}}}}},114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[728]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8492]}}}}}}},117:{l:{109:{l:{112:{l:{101:{l:{113:{l:{59:{c:[8782]}}}}}}}}}}}}},67:{l:{72:{l:{99:{l:{121:{l:{59:{c:[1063]}}}}}}},79:{l:{80:{l:{89:{l:{59:{c:[169]}},c:[169]}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[262]}}}}}}}}},112:{l:{59:{c:[8914]},105:{l:{116:{l:{97:{l:{108:{l:{68:{l:{105:{l:{102:{l:{102:{l:{101:{l:{114:{l:{101:{l:{110:{l:{116:{l:{105:{l:{97:{l:{108:{l:{68:{l:{59:{c:[8517]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},121:{l:{108:{l:{101:{l:{121:{l:{115:{l:{59:{c:[8493]}}}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[268]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[199]}},c:[199]}}}}}}},105:{l:{114:{l:{99:{l:{59:{c:[264]}}}}}}},111:{l:{110:{l:{105:{l:{110:{l:{116:{l:{59:{c:[8752]}}}}}}}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[266]}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{108:{l:{97:{l:{59:{c:[184]}}}}}}}}}}},110:{l:{116:{l:{101:{l:{114:{l:{68:{l:{111:{l:{116:{l:{59:{c:[183]}}}}}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[8493]}}}}},104:{l:{105:{l:{59:{c:[935]}}}}},105:{l:{114:{l:{99:{l:{108:{l:{101:{l:{68:{l:{111:{l:{116:{l:{59:{c:[8857]}}}}}}},77:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[8854]}}}}}}}}}}},80:{l:{108:{l:{117:{l:{115:{l:{59:{c:[8853]}}}}}}}}},84:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8855]}}}}}}}}}}}}}}}}}}}}},108:{l:{111:{l:{99:{l:{107:{l:{119:{l:{105:{l:{115:{l:{101:{l:{67:{l:{111:{l:{110:{l:{116:{l:{111:{l:{117:{l:{114:{l:{73:{l:{110:{l:{116:{l:{101:{l:{103:{l:{114:{l:{97:{l:{108:{l:{59:{c:[8754]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{101:{l:{67:{l:{117:{l:{114:{l:{108:{l:{121:{l:{68:{l:{111:{l:{117:{l:{98:{l:{108:{l:{101:{l:{81:{l:{117:{l:{111:{l:{116:{l:{101:{l:{59:{c:[8221]}}}}}}}}}}}}}}}}}}}}}}},81:{l:{117:{l:{111:{l:{116:{l:{101:{l:{59:{c:[8217]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},111:{l:{108:{l:{111:{l:{110:{l:{59:{c:[8759]},101:{l:{59:{c:[10868]}}}}}}}}},110:{l:{103:{l:{114:{l:{117:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8801]}}}}}}}}}}}}},105:{l:{110:{l:{116:{l:{59:{c:[8751]}}}}}}},116:{l:{111:{l:{117:{l:{114:{l:{73:{l:{110:{l:{116:{l:{101:{l:{103:{l:{114:{l:{97:{l:{108:{l:{59:{c:[8750]}}}}}}}}}}}}}}}}}}}}}}}}}}},112:{l:{102:{l:{59:{c:[8450]}}},114:{l:{111:{l:{100:{l:{117:{l:{99:{l:{116:{l:{59:{c:[8720]}}}}}}}}}}}}}}},117:{l:{110:{l:{116:{l:{101:{l:{114:{l:{67:{l:{108:{l:{111:{l:{99:{l:{107:{l:{119:{l:{105:{l:{115:{l:{101:{l:{67:{l:{111:{l:{110:{l:{116:{l:{111:{l:{117:{l:{114:{l:{73:{l:{110:{l:{116:{l:{101:{l:{103:{l:{114:{l:{97:{l:{108:{l:{59:{c:[8755]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},114:{l:{111:{l:{115:{l:{115:{l:{59:{c:[10799]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119966]}}}}}}},117:{l:{112:{l:{59:{c:[8915]},67:{l:{97:{l:{112:{l:{59:{c:[8781]}}}}}}}}}}}}},68:{l:{68:{l:{59:{c:[8517]},111:{l:{116:{l:{114:{l:{97:{l:{104:{l:{100:{l:{59:{c:[10513]}}}}}}}}}}}}}}},74:{l:{99:{l:{121:{l:{59:{c:[1026]}}}}}}},83:{l:{99:{l:{121:{l:{59:{c:[1029]}}}}}}},90:{l:{99:{l:{121:{l:{59:{c:[1039]}}}}}}},97:{l:{103:{l:{103:{l:{101:{l:{114:{l:{59:{c:[8225]}}}}}}}}},114:{l:{114:{l:{59:{c:[8609]}}}}},115:{l:{104:{l:{118:{l:{59:{c:[10980]}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[270]}}}}}}}}},121:{l:{59:{c:[1044]}}}}},101:{l:{108:{l:{59:{c:[8711]},116:{l:{97:{l:{59:{c:[916]}}}}}}}}},102:{l:{114:{l:{59:{c:[120071]}}}}},105:{l:{97:{l:{99:{l:{114:{l:{105:{l:{116:{l:{105:{l:{99:{l:{97:{l:{108:{l:{65:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[180]}}}}}}}}}}},68:{l:{111:{l:{116:{l:{59:{c:[729]}}},117:{l:{98:{l:{108:{l:{101:{l:{65:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[733]}}}}}}}}}}}}}}}}}}}}}}},71:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[96]}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[732]}}}}}}}}}}}}}}}}}}}}}}}}}}},109:{l:{111:{l:{110:{l:{100:{l:{59:{c:[8900]}}}}}}}}}}},102:{l:{102:{l:{101:{l:{114:{l:{101:{l:{110:{l:{116:{l:{105:{l:{97:{l:{108:{l:{68:{l:{59:{c:[8518]}}}}}}}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120123]}}}}},116:{l:{59:{c:[168]},68:{l:{111:{l:{116:{l:{59:{c:[8412]}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8784]}}}}}}}}}}}}},117:{l:{98:{l:{108:{l:{101:{l:{67:{l:{111:{l:{110:{l:{116:{l:{111:{l:{117:{l:{114:{l:{73:{l:{110:{l:{116:{l:{101:{l:{103:{l:{114:{l:{97:{l:{108:{l:{59:{c:[8751]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},68:{l:{111:{l:{116:{l:{59:{c:[168]}}},119:{l:{110:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8659]}}}}}}}}}}}}}}}}}}},76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8656]}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8660]}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{59:{c:[10980]}}}}}}}}}}}}},111:{l:{110:{l:{103:{l:{76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10232]}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10234]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10233]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8658]}}}}}}}}}}},84:{l:{101:{l:{101:{l:{59:{c:[8872]}}}}}}}}}}}}}}}}},85:{l:{112:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8657]}}}}}}}}}}},68:{l:{111:{l:{119:{l:{110:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8661]}}}}}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{114:{l:{116:{l:{105:{l:{99:{l:{97:{l:{108:{l:{66:{l:{97:{l:{114:{l:{59:{c:[8741]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},119:{l:{110:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8595]},66:{l:{97:{l:{114:{l:{59:{c:[10515]}}}}}}},85:{l:{112:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8693]}}}}}}}}}}}}}}}}}}}}}}}}},66:{l:{114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[785]}}}}}}}}}}},76:{l:{101:{l:{102:{l:{116:{l:{82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10576]}}}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10590]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8637]},66:{l:{97:{l:{114:{l:{59:{c:[10582]}}}}}}}}}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{84:{l:{101:{l:{101:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10591]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8641]},66:{l:{97:{l:{114:{l:{59:{c:[10583]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{59:{c:[8868]},65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8615]}}}}}}}}}}}}}}}}},97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8659]}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119967]}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[272]}}}}}}}}}}}}},69:{l:{78:{l:{71:{l:{59:{c:[330]}}}}},84:{l:{72:{l:{59:{c:[208]}},c:[208]}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[201]}},c:[201]}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[282]}}}}}}}}},105:{l:{114:{l:{99:{l:{59:{c:[202]}},c:[202]}}}}},121:{l:{59:{c:[1069]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[278]}}}}}}},102:{l:{114:{l:{59:{c:[120072]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[200]}},c:[200]}}}}}}}}},108:{l:{101:{l:{109:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8712]}}}}}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[274]}}}}}}},112:{l:{116:{l:{121:{l:{83:{l:{109:{l:{97:{l:{108:{l:{108:{l:{83:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[9723]}}}}}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{114:{l:{121:{l:{83:{l:{109:{l:{97:{l:{108:{l:{108:{l:{83:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[9643]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[280]}}}}}}},112:{l:{102:{l:{59:{c:[120124]}}}}}}},112:{l:{115:{l:{105:{l:{108:{l:{111:{l:{110:{l:{59:{c:[917]}}}}}}}}}}}}},113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10869]},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8770]}}}}}}}}}}}}}}},105:{l:{108:{l:{105:{l:{98:{l:{114:{l:{105:{l:{117:{l:{109:{l:{59:{c:[8652]}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8496]}}}}},105:{l:{109:{l:{59:{c:[10867]}}}}}}},116:{l:{97:{l:{59:{c:[919]}}}}},117:{l:{109:{l:{108:{l:{59:{c:[203]}},c:[203]}}}}},120:{l:{105:{l:{115:{l:{116:{l:{115:{l:{59:{c:[8707]}}}}}}}}},112:{l:{111:{l:{110:{l:{101:{l:{110:{l:{116:{l:{105:{l:{97:{l:{108:{l:{69:{l:{59:{c:[8519]}}}}}}}}}}}}}}}}}}}}}}}}},70:{l:{99:{l:{121:{l:{59:{c:[1060]}}}}},102:{l:{114:{l:{59:{c:[120073]}}}}},105:{l:{108:{l:{108:{l:{101:{l:{100:{l:{83:{l:{109:{l:{97:{l:{108:{l:{108:{l:{83:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[9724]}}}}}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{114:{l:{121:{l:{83:{l:{109:{l:{97:{l:{108:{l:{108:{l:{83:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[9642]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120125]}}}}},114:{l:{65:{l:{108:{l:{108:{l:{59:{c:[8704]}}}}}}}}},117:{l:{114:{l:{105:{l:{101:{l:{114:{l:{116:{l:{114:{l:{102:{l:{59:{c:[8497]}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8497]}}}}}}}}},71:{l:{74:{l:{99:{l:{121:{l:{59:{c:[1027]}}}}}}},84:{l:{59:{c:[62]}},c:[62]},97:{l:{109:{l:{109:{l:{97:{l:{59:{c:[915]},100:{l:{59:{c:[988]}}}}}}}}}}},98:{l:{114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[286]}}}}}}}}}}},99:{l:{101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[290]}}}}}}}}},105:{l:{114:{l:{99:{l:{59:{c:[284]}}}}}}},121:{l:{59:{c:[1043]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[288]}}}}}}},102:{l:{114:{l:{59:{c:[120074]}}}}},103:{l:{59:{c:[8921]}}},111:{l:{112:{l:{102:{l:{59:{c:[120126]}}}}}}},114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8805]},76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8923]}}}}}}}}}}}}}}}}}}},70:{l:{117:{l:{108:{l:{108:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8807]}}}}}}}}}}}}}}}}}}},71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[10914]}}}}}}}}}}}}}}},76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8823]}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10878]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8819]}}}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119970]}}}}}}},116:{l:{59:{c:[8811]}}}}},72:{l:{65:{l:{82:{l:{68:{l:{99:{l:{121:{l:{59:{c:[1066]}}}}}}}}}}},97:{l:{99:{l:{101:{l:{107:{l:{59:{c:[711]}}}}}}},116:{l:{59:{c:[94]}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[292]}}}}}}}}},102:{l:{114:{l:{59:{c:[8460]}}}}},105:{l:{108:{l:{98:{l:{101:{l:{114:{l:{116:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8459]}}}}}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[8461]}}}}},114:{l:{105:{l:{122:{l:{111:{l:{110:{l:{116:{l:{97:{l:{108:{l:{76:{l:{105:{l:{110:{l:{101:{l:{59:{c:[9472]}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8459]}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[294]}}}}}}}}}}},117:{l:{109:{l:{112:{l:{68:{l:{111:{l:{119:{l:{110:{l:{72:{l:{117:{l:{109:{l:{112:{l:{59:{c:[8782]}}}}}}}}}}}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8783]}}}}}}}}}}}}}}}}}}},73:{l:{69:{l:{99:{l:{121:{l:{59:{c:[1045]}}}}}}},74:{l:{108:{l:{105:{l:{103:{l:{59:{c:[306]}}}}}}}}},79:{l:{99:{l:{121:{l:{59:{c:[1025]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[205]}},c:[205]}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[206]}},c:[206]}}}}},121:{l:{59:{c:[1048]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[304]}}}}}}},102:{l:{114:{l:{59:{c:[8465]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[204]}},c:[204]}}}}}}}}},109:{l:{59:{c:[8465]},97:{l:{99:{l:{114:{l:{59:{c:[298]}}}}},103:{l:{105:{l:{110:{l:{97:{l:{114:{l:{121:{l:{73:{l:{59:{c:[8520]}}}}}}}}}}}}}}}}},112:{l:{108:{l:{105:{l:{101:{l:{115:{l:{59:{c:[8658]}}}}}}}}}}}}},110:{l:{116:{l:{59:{c:[8748]},101:{l:{103:{l:{114:{l:{97:{l:{108:{l:{59:{c:[8747]}}}}}}}}},114:{l:{115:{l:{101:{l:{99:{l:{116:{l:{105:{l:{111:{l:{110:{l:{59:{c:[8898]}}}}}}}}}}}}}}}}}}}}},118:{l:{105:{l:{115:{l:{105:{l:{98:{l:{108:{l:{101:{l:{67:{l:{111:{l:{109:{l:{109:{l:{97:{l:{59:{c:[8291]}}}}}}}}}}},84:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8290]}}}}}}}}}}}}}}}}}}}}}}}}}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[302]}}}}}}},112:{l:{102:{l:{59:{c:[120128]}}}}},116:{l:{97:{l:{59:{c:[921]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8464]}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[296]}}}}}}}}}}},117:{l:{107:{l:{99:{l:{121:{l:{59:{c:[1030]}}}}}}},109:{l:{108:{l:{59:{c:[207]}},c:[207]}}}}}}},74:{l:{99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[308]}}}}}}},121:{l:{59:{c:[1049]}}}}},102:{l:{114:{l:{59:{c:[120077]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120129]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119973]}}}}},101:{l:{114:{l:{99:{l:{121:{l:{59:{c:[1032]}}}}}}}}}}},117:{l:{107:{l:{99:{l:{121:{l:{59:{c:[1028]}}}}}}}}}}},75:{l:{72:{l:{99:{l:{121:{l:{59:{c:[1061]}}}}}}},74:{l:{99:{l:{121:{l:{59:{c:[1036]}}}}}}},97:{l:{112:{l:{112:{l:{97:{l:{59:{c:[922]}}}}}}}}},99:{l:{101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[310]}}}}}}}}},121:{l:{59:{c:[1050]}}}}},102:{l:{114:{l:{59:{c:[120078]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120130]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119974]}}}}}}}}},76:{l:{74:{l:{99:{l:{121:{l:{59:{c:[1033]}}}}}}},84:{l:{59:{c:[60]}},c:[60]},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[313]}}}}}}}}},109:{l:{98:{l:{100:{l:{97:{l:{59:{c:[923]}}}}}}}}},110:{l:{103:{l:{59:{c:[10218]}}}}},112:{l:{108:{l:{97:{l:{99:{l:{101:{l:{116:{l:{114:{l:{102:{l:{59:{c:[8466]}}}}}}}}}}}}}}}}},114:{l:{114:{l:{59:{c:[8606]}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[317]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[315]}}}}}}}}},121:{l:{59:{c:[1051]}}}}},101:{l:{102:{l:{116:{l:{65:{l:{110:{l:{103:{l:{108:{l:{101:{l:{66:{l:{114:{l:{97:{l:{99:{l:{107:{l:{101:{l:{116:{l:{59:{c:[10216]}}}}}}}}}}}}}}}}}}}}}}},114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8592]},66:{l:{97:{l:{114:{l:{59:{c:[8676]}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8646]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},67:{l:{101:{l:{105:{l:{108:{l:{105:{l:{110:{l:{103:{l:{59:{c:[8968]}}}}}}}}}}}}}}},68:{l:{111:{l:{117:{l:{98:{l:{108:{l:{101:{l:{66:{l:{114:{l:{97:{l:{99:{l:{107:{l:{101:{l:{116:{l:{59:{c:[10214]}}}}}}}}}}}}}}}}}}}}}}},119:{l:{110:{l:{84:{l:{101:{l:{101:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10593]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8643]},66:{l:{97:{l:{114:{l:{59:{c:[10585]}}}}}}}}}}}}}}}}}}}}}}}}}}},70:{l:{108:{l:{111:{l:{111:{l:{114:{l:{59:{c:[8970]}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8596]}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10574]}}}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{59:{c:[8867]},65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8612]}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10586]}}}}}}}}}}}}}}}}},114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[8882]},66:{l:{97:{l:{114:{l:{59:{c:[10703]}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8884]}}}}}}}}}}}}}}}}}}}}}}}}}}},85:{l:{112:{l:{68:{l:{111:{l:{119:{l:{110:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10577]}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10592]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8639]},66:{l:{97:{l:{114:{l:{59:{c:[10584]}}}}}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8636]},66:{l:{97:{l:{114:{l:{59:{c:[10578]}}}}}}}}}}}}}}}}}}},97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8656]}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8660]}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{115:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[8922]}}}}}}}}}}}}}}}}}}}}}}}}},70:{l:{117:{l:{108:{l:{108:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8806]}}}}}}}}}}}}}}}}}}},71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[8822]}}}}}}}}}}}}}}},76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[10913]}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10877]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8818]}}}}}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120079]}}}}},108:{l:{59:{c:[8920]},101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8666]}}}}}}}}}}}}}}}}}}},109:{l:{105:{l:{100:{l:{111:{l:{116:{l:{59:{c:[319]}}}}}}}}}}},111:{l:{110:{l:{103:{l:{76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10229]}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10231]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10230]}}}}}}}}}}}}}}}}}}}}},108:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10232]}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10234]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10233]}}}}}}}}}}}}}}}}}}}}}}}}},112:{l:{102:{l:{59:{c:[120131]}}}}},119:{l:{101:{l:{114:{l:{76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8601]}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8600]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8466]}}}}},104:{l:{59:{c:[8624]}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[321]}}}}}}}}}}},116:{l:{59:{c:[8810]}}}}},77:{l:{97:{l:{112:{l:{59:{c:[10501]}}}}},99:{l:{121:{l:{59:{c:[1052]}}}}},101:{l:{100:{l:{105:{l:{117:{l:{109:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8287]}}}}}}}}}}}}}}}}}}},108:{l:{108:{l:{105:{l:{110:{l:{116:{l:{114:{l:{102:{l:{59:{c:[8499]}}}}}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120080]}}}}},105:{l:{110:{l:{117:{l:{115:{l:{80:{l:{108:{l:{117:{l:{115:{l:{59:{c:[8723]}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120132]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8499]}}}}}}},117:{l:{59:{c:[924]}}}}},78:{l:{74:{l:{99:{l:{121:{l:{59:{c:[1034]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[323]}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[327]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[325]}}}}}}}}},121:{l:{59:{c:[1053]}}}}},101:{l:{103:{l:{97:{l:{116:{l:{105:{l:{118:{l:{101:{l:{77:{l:{101:{l:{100:{l:{105:{l:{117:{l:{109:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8203]}}}}}}}}}}}}}}}}}}}}}}},84:{l:{104:{l:{105:{l:{99:{l:{107:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8203]}}}}}}}}}}}}}}},110:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8203]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{114:{l:{121:{l:{84:{l:{104:{l:{105:{l:{110:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8203]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{116:{l:{101:{l:{100:{l:{71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[8811]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},76:{l:{101:{l:{115:{l:{115:{l:{76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8810]}}}}}}}}}}}}}}}}}}}}}}}}},119:{l:{76:{l:{105:{l:{110:{l:{101:{l:{59:{c:[10]}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120081]}}}}},111:{l:{66:{l:{114:{l:{101:{l:{97:{l:{107:{l:{59:{c:[8288]}}}}}}}}}}},110:{l:{66:{l:{114:{l:{101:{l:{97:{l:{107:{l:{105:{l:{110:{l:{103:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[160]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},112:{l:{102:{l:{59:{c:[8469]}}}}},116:{l:{59:{c:[10988]},67:{l:{111:{l:{110:{l:{103:{l:{114:{l:{117:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8802]}}}}}}}}}}}}}}}}},117:{l:{112:{l:{67:{l:{97:{l:{112:{l:{59:{c:[8813]}}}}}}}}}}}}},68:{l:{111:{l:{117:{l:{98:{l:{108:{l:{101:{l:{86:{l:{101:{l:{114:{l:{116:{l:{105:{l:{99:{l:{97:{l:{108:{l:{66:{l:{97:{l:{114:{l:{59:{c:[8742]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},69:{l:{108:{l:{101:{l:{109:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8713]}}}}}}}}}}}}},113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8800]},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8770,824]}}}}}}}}}}}}}}}}}}},120:{l:{105:{l:{115:{l:{116:{l:{115:{l:{59:{c:[8708]}}}}}}}}}}}}},71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[8815]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8817]}}}}}}}}}}},70:{l:{117:{l:{108:{l:{108:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8807,824]}}}}}}}}}}}}}}}}}}},71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[8811,824]}}}}}}}}}}}}}}},76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8825]}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10878,824]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8821]}}}}}}}}}}}}}}}}}}}}}}}}},72:{l:{117:{l:{109:{l:{112:{l:{68:{l:{111:{l:{119:{l:{110:{l:{72:{l:{117:{l:{109:{l:{112:{l:{59:{c:[8782,824]}}}}}}}}}}}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8783,824]}}}}}}}}}}}}}}}}}}},76:{l:{101:{l:{102:{l:{116:{l:{84:{l:{114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[8938]},66:{l:{97:{l:{114:{l:{59:{c:[10703,824]}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8940]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{115:{l:{59:{c:[8814]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8816]}}}}}}}}}}},71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[8824]}}}}}}}}}}}}}}},76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8810,824]}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10877,824]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8820]}}}}}}}}}}}}}}}}}}},78:{l:{101:{l:{115:{l:{116:{l:{101:{l:{100:{l:{71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{71:{l:{114:{l:{101:{l:{97:{l:{116:{l:{101:{l:{114:{l:{59:{c:[10914,824]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},76:{l:{101:{l:{115:{l:{115:{l:{76:{l:{101:{l:{115:{l:{115:{l:{59:{c:[10913,824]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},80:{l:{114:{l:{101:{l:{99:{l:{101:{l:{100:{l:{101:{l:{115:{l:{59:{c:[8832]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10927,824]}}}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8928]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},82:{l:{101:{l:{118:{l:{101:{l:{114:{l:{115:{l:{101:{l:{69:{l:{108:{l:{101:{l:{109:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8716]}}}}}}}}}}}}}}}}}}}}}}}}}}},105:{l:{103:{l:{104:{l:{116:{l:{84:{l:{114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[8939]},66:{l:{97:{l:{114:{l:{59:{c:[10704,824]}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8941]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},83:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{83:{l:{117:{l:{98:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8847,824]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8930]}}}}}}}}}}}}}}}}}}},112:{l:{101:{l:{114:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8848,824]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8931]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},117:{l:{98:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8834,8402]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8840]}}}}}}}}}}}}}}}}}}},99:{l:{99:{l:{101:{l:{101:{l:{100:{l:{115:{l:{59:{c:[8833]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10928,824]}}}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8929]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8831,824]}}}}}}}}}}}}}}}}}}}}}}},112:{l:{101:{l:{114:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8835,8402]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8841]}}}}}}}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8769]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8772]}}}}}}}}}}},70:{l:{117:{l:{108:{l:{108:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8775]}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8777]}}}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{114:{l:{116:{l:{105:{l:{99:{l:{97:{l:{108:{l:{66:{l:{97:{l:{114:{l:{59:{c:[8740]}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119977]}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[209]}},c:[209]}}}}}}}}},117:{l:{59:{c:[925]}}}}},79:{l:{69:{l:{108:{l:{105:{l:{103:{l:{59:{c:[338]}}}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[211]}},c:[211]}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[212]}},c:[212]}}}}},121:{l:{59:{c:[1054]}}}}},100:{l:{98:{l:{108:{l:{97:{l:{99:{l:{59:{c:[336]}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120082]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[210]}},c:[210]}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[332]}}}}}}},101:{l:{103:{l:{97:{l:{59:{c:[937]}}}}}}},105:{l:{99:{l:{114:{l:{111:{l:{110:{l:{59:{c:[927]}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120134]}}}}}}},112:{l:{101:{l:{110:{l:{67:{l:{117:{l:{114:{l:{108:{l:{121:{l:{68:{l:{111:{l:{117:{l:{98:{l:{108:{l:{101:{l:{81:{l:{117:{l:{111:{l:{116:{l:{101:{l:{59:{c:[8220]}}}}}}}}}}}}}}}}}}}}}}},81:{l:{117:{l:{111:{l:{116:{l:{101:{l:{59:{c:[8216]}}}}}}}}}}}}}}}}}}}}}}}}}}},114:{l:{59:{c:[10836]}}},115:{l:{99:{l:{114:{l:{59:{c:[119978]}}}}},108:{l:{97:{l:{115:{l:{104:{l:{59:{c:[216]}},c:[216]}}}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[213]}},c:[213]}}}}},109:{l:{101:{l:{115:{l:{59:{c:[10807]}}}}}}}}}}},117:{l:{109:{l:{108:{l:{59:{c:[214]}},c:[214]}}}}},118:{l:{101:{l:{114:{l:{66:{l:{97:{l:{114:{l:{59:{c:[8254]}}}}},114:{l:{97:{l:{99:{l:{101:{l:{59:{c:[9182]}}},107:{l:{101:{l:{116:{l:{59:{c:[9140]}}}}}}}}}}}}}}},80:{l:{97:{l:{114:{l:{101:{l:{110:{l:{116:{l:{104:{l:{101:{l:{115:{l:{105:{l:{115:{l:{59:{c:[9180]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},80:{l:{97:{l:{114:{l:{116:{l:{105:{l:{97:{l:{108:{l:{68:{l:{59:{c:[8706]}}}}}}}}}}}}}}},99:{l:{121:{l:{59:{c:[1055]}}}}},102:{l:{114:{l:{59:{c:[120083]}}}}},104:{l:{105:{l:{59:{c:[934]}}}}},105:{l:{59:{c:[928]}}},108:{l:{117:{l:{115:{l:{77:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[177]}}}}}}}}}}}}}}}}},111:{l:{105:{l:{110:{l:{99:{l:{97:{l:{114:{l:{101:{l:{112:{l:{108:{l:{97:{l:{110:{l:{101:{l:{59:{c:[8460]}}}}}}}}}}}}}}}}}}}}}}},112:{l:{102:{l:{59:{c:[8473]}}}}}}},114:{l:{59:{c:[10939]},101:{l:{99:{l:{101:{l:{100:{l:{101:{l:{115:{l:{59:{c:[8826]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10927]}}}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8828]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8830]}}}}}}}}}}}}}}}}}}}}}}},105:{l:{109:{l:{101:{l:{59:{c:[8243]}}}}}}},111:{l:{100:{l:{117:{l:{99:{l:{116:{l:{59:{c:[8719]}}}}}}}}},112:{l:{111:{l:{114:{l:{116:{l:{105:{l:{111:{l:{110:{l:{59:{c:[8759]},97:{l:{108:{l:{59:{c:[8733]}}}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119979]}}}}},105:{l:{59:{c:[936]}}}}}}},81:{l:{85:{l:{79:{l:{84:{l:{59:{c:[34]}},c:[34]}}}}},102:{l:{114:{l:{59:{c:[120084]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[8474]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119980]}}}}}}}}},82:{l:{66:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10512]}}}}}}}}},69:{l:{71:{l:{59:{c:[174]}},c:[174]}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[340]}}}}}}}}},110:{l:{103:{l:{59:{c:[10219]}}}}},114:{l:{114:{l:{59:{c:[8608]},116:{l:{108:{l:{59:{c:[10518]}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[344]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[342]}}}}}}}}},121:{l:{59:{c:[1056]}}}}},101:{l:{59:{c:[8476]},118:{l:{101:{l:{114:{l:{115:{l:{101:{l:{69:{l:{108:{l:{101:{l:{109:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8715]}}}}}}}}}}}}},113:{l:{117:{l:{105:{l:{108:{l:{105:{l:{98:{l:{114:{l:{105:{l:{117:{l:{109:{l:{59:{c:[8651]}}}}}}}}}}}}}}}}}}}}}}},85:{l:{112:{l:{69:{l:{113:{l:{117:{l:{105:{l:{108:{l:{105:{l:{98:{l:{114:{l:{105:{l:{117:{l:{109:{l:{59:{c:[10607]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[8476]}}}}},104:{l:{111:{l:{59:{c:[929]}}}}},105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{110:{l:{103:{l:{108:{l:{101:{l:{66:{l:{114:{l:{97:{l:{99:{l:{107:{l:{101:{l:{116:{l:{59:{c:[10217]}}}}}}}}}}}}}}}}}}}}}}},114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8594]},66:{l:{97:{l:{114:{l:{59:{c:[8677]}}}}}}},76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8644]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},67:{l:{101:{l:{105:{l:{108:{l:{105:{l:{110:{l:{103:{l:{59:{c:[8969]}}}}}}}}}}}}}}},68:{l:{111:{l:{117:{l:{98:{l:{108:{l:{101:{l:{66:{l:{114:{l:{97:{l:{99:{l:{107:{l:{101:{l:{116:{l:{59:{c:[10215]}}}}}}}}}}}}}}}}}}}}}}},119:{l:{110:{l:{84:{l:{101:{l:{101:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10589]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8642]},66:{l:{97:{l:{114:{l:{59:{c:[10581]}}}}}}}}}}}}}}}}}}}}}}}}}}},70:{l:{108:{l:{111:{l:{111:{l:{114:{l:{59:{c:[8971]}}}}}}}}}}},84:{l:{101:{l:{101:{l:{59:{c:[8866]},65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8614]}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10587]}}}}}}}}}}}}}}}}},114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[8883]},66:{l:{97:{l:{114:{l:{59:{c:[10704]}}}}}}},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8885]}}}}}}}}}}}}}}}}}}}}}}}}}}},85:{l:{112:{l:{68:{l:{111:{l:{119:{l:{110:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10575]}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10588]}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8638]},66:{l:{97:{l:{114:{l:{59:{c:[10580]}}}}}}}}}}}}}}}}}}}}}}},86:{l:{101:{l:{99:{l:{116:{l:{111:{l:{114:{l:{59:{c:[8640]},66:{l:{97:{l:{114:{l:{59:{c:[10579]}}}}}}}}}}}}}}}}}}},97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8658]}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[8477]}}}}},117:{l:{110:{l:{100:{l:{73:{l:{109:{l:{112:{l:{108:{l:{105:{l:{101:{l:{115:{l:{59:{c:[10608]}}}}}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8667]}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8475]}}}}},104:{l:{59:{c:[8625]}}}}},117:{l:{108:{l:{101:{l:{68:{l:{101:{l:{108:{l:{97:{l:{121:{l:{101:{l:{100:{l:{59:{c:[10740]}}}}}}}}}}}}}}}}}}}}}}},83:{l:{72:{l:{67:{l:{72:{l:{99:{l:{121:{l:{59:{c:[1065]}}}}}}}}},99:{l:{121:{l:{59:{c:[1064]}}}}}}},79:{l:{70:{l:{84:{l:{99:{l:{121:{l:{59:{c:[1068]}}}}}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[346]}}}}}}}}}}},99:{l:{59:{c:[10940]},97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[352]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[350]}}}}}}}}},105:{l:{114:{l:{99:{l:{59:{c:[348]}}}}}}},121:{l:{59:{c:[1057]}}}}},102:{l:{114:{l:{59:{c:[120086]}}}}},104:{l:{111:{l:{114:{l:{116:{l:{68:{l:{111:{l:{119:{l:{110:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8595]}}}}}}}}}}}}}}}}}}},76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8592]}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8594]}}}}}}}}}}}}}}}}}}}}},85:{l:{112:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8593]}}}}}}}}}}}}}}}}}}}}}}},105:{l:{103:{l:{109:{l:{97:{l:{59:{c:[931]}}}}}}}}},109:{l:{97:{l:{108:{l:{108:{l:{67:{l:{105:{l:{114:{l:{99:{l:{108:{l:{101:{l:{59:{c:[8728]}}}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120138]}}}}}}},113:{l:{114:{l:{116:{l:{59:{c:[8730]}}}}},117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[9633]},73:{l:{110:{l:{116:{l:{101:{l:{114:{l:{115:{l:{101:{l:{99:{l:{116:{l:{105:{l:{111:{l:{110:{l:{59:{c:[8851]}}}}}}}}}}}}}}}}}}}}}}}}},83:{l:{117:{l:{98:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8847]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8849]}}}}}}}}}}}}}}}}}}},112:{l:{101:{l:{114:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8848]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8850]}}}}}}}}}}}}}}}}}}}}}}}}}}},85:{l:{110:{l:{105:{l:{111:{l:{110:{l:{59:{c:[8852]}}}}}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119982]}}}}}}},116:{l:{97:{l:{114:{l:{59:{c:[8902]}}}}}}},117:{l:{98:{l:{59:{c:[8912]},115:{l:{101:{l:{116:{l:{59:{c:[8912]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8838]}}}}}}}}}}}}}}}}}}},99:{l:{99:{l:{101:{l:{101:{l:{100:{l:{115:{l:{59:{c:[8827]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[10928]}}}}}}}}}}},83:{l:{108:{l:{97:{l:{110:{l:{116:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8829]}}}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8831]}}}}}}}}}}}}}}}}}}}}},104:{l:{84:{l:{104:{l:{97:{l:{116:{l:{59:{c:[8715]}}}}}}}}}}}}},109:{l:{59:{c:[8721]}}},112:{l:{59:{c:[8913]},101:{l:{114:{l:{115:{l:{101:{l:{116:{l:{59:{c:[8835]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8839]}}}}}}}}}}}}}}}}}}}}},115:{l:{101:{l:{116:{l:{59:{c:[8913]}}}}}}}}}}}}},84:{l:{72:{l:{79:{l:{82:{l:{78:{l:{59:{c:[222]}},c:[222]}}}}}}},82:{l:{65:{l:{68:{l:{69:{l:{59:{c:[8482]}}}}}}}}},83:{l:{72:{l:{99:{l:{121:{l:{59:{c:[1035]}}}}}}},99:{l:{121:{l:{59:{c:[1062]}}}}}}},97:{l:{98:{l:{59:{c:[9]}}},117:{l:{59:{c:[932]}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[356]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[354]}}}}}}}}},121:{l:{59:{c:[1058]}}}}},102:{l:{114:{l:{59:{c:[120087]}}}}},104:{l:{101:{l:{114:{l:{101:{l:{102:{l:{111:{l:{114:{l:{101:{l:{59:{c:[8756]}}}}}}}}}}}}},116:{l:{97:{l:{59:{c:[920]}}}}}}},105:{l:{99:{l:{107:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8287,8202]}}}}}}}}}}}}}}},110:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8201]}}}}}}}}}}}}}}}}},105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8764]},69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8771]}}}}}}}}}}},70:{l:{117:{l:{108:{l:{108:{l:{69:{l:{113:{l:{117:{l:{97:{l:{108:{l:{59:{c:[8773]}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8776]}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120139]}}}}}}},114:{l:{105:{l:{112:{l:{108:{l:{101:{l:{68:{l:{111:{l:{116:{l:{59:{c:[8411]}}}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119983]}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[358]}}}}}}}}}}}}},85:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[218]}},c:[218]}}}}}}},114:{l:{114:{l:{59:{c:[8607]},111:{l:{99:{l:{105:{l:{114:{l:{59:{c:[10569]}}}}}}}}}}}}}}},98:{l:{114:{l:{99:{l:{121:{l:{59:{c:[1038]}}}}},101:{l:{118:{l:{101:{l:{59:{c:[364]}}}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[219]}},c:[219]}}}}},121:{l:{59:{c:[1059]}}}}},100:{l:{98:{l:{108:{l:{97:{l:{99:{l:{59:{c:[368]}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120088]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[217]}},c:[217]}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[362]}}}}}}}}},110:{l:{100:{l:{101:{l:{114:{l:{66:{l:{97:{l:{114:{l:{59:{c:[95]}}}}},114:{l:{97:{l:{99:{l:{101:{l:{59:{c:[9183]}}},107:{l:{101:{l:{116:{l:{59:{c:[9141]}}}}}}}}}}}}}}},80:{l:{97:{l:{114:{l:{101:{l:{110:{l:{116:{l:{104:{l:{101:{l:{115:{l:{105:{l:{115:{l:{59:{c:[9181]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},105:{l:{111:{l:{110:{l:{59:{c:[8899]},80:{l:{108:{l:{117:{l:{115:{l:{59:{c:[8846]}}}}}}}}}}}}}}}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[370]}}}}}}},112:{l:{102:{l:{59:{c:[120140]}}}}}}},112:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8593]},66:{l:{97:{l:{114:{l:{59:{c:[10514]}}}}}}},68:{l:{111:{l:{119:{l:{110:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8645]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},68:{l:{111:{l:{119:{l:{110:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8597]}}}}}}}}}}}}}}}}}}},69:{l:{113:{l:{117:{l:{105:{l:{108:{l:{105:{l:{98:{l:{114:{l:{105:{l:{117:{l:{109:{l:{59:{c:[10606]}}}}}}}}}}}}}}}}}}}}}}},84:{l:{101:{l:{101:{l:{59:{c:[8869]},65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8613]}}}}}}}}}}}}}}}}},97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8657]}}}}}}}}}}},100:{l:{111:{l:{119:{l:{110:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8661]}}}}}}}}}}}}}}}}}}},112:{l:{101:{l:{114:{l:{76:{l:{101:{l:{102:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8598]}}}}}}}}}}}}}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{65:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8599]}}}}}}}}}}}}}}}}}}}}}}}}}}},115:{l:{105:{l:{59:{c:[978]},108:{l:{111:{l:{110:{l:{59:{c:[933]}}}}}}}}}}}}},114:{l:{105:{l:{110:{l:{103:{l:{59:{c:[366]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119984]}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[360]}}}}}}}}}}},117:{l:{109:{l:{108:{l:{59:{c:[220]}},c:[220]}}}}}}},86:{l:{68:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8875]}}}}}}}}},98:{l:{97:{l:{114:{l:{59:{c:[10987]}}}}}}},99:{l:{121:{l:{59:{c:[1042]}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8873]},108:{l:{59:{c:[10982]}}}}}}}}}}},101:{l:{101:{l:{59:{c:[8897]}}},114:{l:{98:{l:{97:{l:{114:{l:{59:{c:[8214]}}}}}}},116:{l:{59:{c:[8214]},105:{l:{99:{l:{97:{l:{108:{l:{66:{l:{97:{l:{114:{l:{59:{c:[8739]}}}}}}},76:{l:{105:{l:{110:{l:{101:{l:{59:{c:[124]}}}}}}}}},83:{l:{101:{l:{112:{l:{97:{l:{114:{l:{97:{l:{116:{l:{111:{l:{114:{l:{59:{c:[10072]}}}}}}}}}}}}}}}}}}},84:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[8768]}}}}}}}}}}}}}}}}}}}}},121:{l:{84:{l:{104:{l:{105:{l:{110:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8202]}}}}}}}}}}}}}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120089]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120141]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119985]}}}}}}},118:{l:{100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8874]}}}}}}}}}}}}},87:{l:{99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[372]}}}}}}}}},101:{l:{100:{l:{103:{l:{101:{l:{59:{c:[8896]}}}}}}}}},102:{l:{114:{l:{59:{c:[120090]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120142]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119986]}}}}}}}}},88:{l:{102:{l:{114:{l:{59:{c:[120091]}}}}},105:{l:{59:{c:[926]}}},111:{l:{112:{l:{102:{l:{59:{c:[120143]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119987]}}}}}}}}},89:{l:{65:{l:{99:{l:{121:{l:{59:{c:[1071]}}}}}}},73:{l:{99:{l:{121:{l:{59:{c:[1031]}}}}}}},85:{l:{99:{l:{121:{l:{59:{c:[1070]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[221]}},c:[221]}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[374]}}}}}}},121:{l:{59:{c:[1067]}}}}},102:{l:{114:{l:{59:{c:[120092]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120144]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119988]}}}}}}},117:{l:{109:{l:{108:{l:{59:{c:[376]}}}}}}}}},90:{l:{72:{l:{99:{l:{121:{l:{59:{c:[1046]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[377]}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[381]}}}}}}}}},121:{l:{59:{c:[1047]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[379]}}}}}}},101:{l:{114:{l:{111:{l:{87:{l:{105:{l:{100:{l:{116:{l:{104:{l:{83:{l:{112:{l:{97:{l:{99:{l:{101:{l:{59:{c:[8203]}}}}}}}}}}}}}}}}}}}}}}}}},116:{l:{97:{l:{59:{c:[918]}}}}}}},102:{l:{114:{l:{59:{c:[8488]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[8484]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119989]}}}}}}}}},97:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[225]}},c:[225]}}}}}}}}},98:{l:{114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[259]}}}}}}}}}}},99:{l:{59:{c:[8766]},69:{l:{59:{c:[8766,819]}}},100:{l:{59:{c:[8767]}}},105:{l:{114:{l:{99:{l:{59:{c:[226]}},c:[226]}}}}},117:{l:{116:{l:{101:{l:{59:{c:[180]}},c:[180]}}}}},121:{l:{59:{c:[1072]}}}}},101:{l:{108:{l:{105:{l:{103:{l:{59:{c:[230]}},c:[230]}}}}}}},102:{l:{59:{c:[8289]},114:{l:{59:{c:[120094]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[224]}},c:[224]}}}}}}}}},108:{l:{101:{l:{102:{l:{115:{l:{121:{l:{109:{l:{59:{c:[8501]}}}}}}}}},112:{l:{104:{l:{59:{c:[8501]}}}}}}},112:{l:{104:{l:{97:{l:{59:{c:[945]}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[257]}}}}},108:{l:{103:{l:{59:{c:[10815]}}}}}}},112:{l:{59:{c:[38]}},c:[38]}}},110:{l:{100:{l:{59:{c:[8743]},97:{l:{110:{l:{100:{l:{59:{c:[10837]}}}}}}},100:{l:{59:{c:[10844]}}},115:{l:{108:{l:{111:{l:{112:{l:{101:{l:{59:{c:[10840]}}}}}}}}}}},118:{l:{59:{c:[10842]}}}}},103:{l:{59:{c:[8736]},101:{l:{59:{c:[10660]}}},108:{l:{101:{l:{59:{c:[8736]}}}}},109:{l:{115:{l:{100:{l:{59:{c:[8737]},97:{l:{97:{l:{59:{c:[10664]}}},98:{l:{59:{c:[10665]}}},99:{l:{59:{c:[10666]}}},100:{l:{59:{c:[10667]}}},101:{l:{59:{c:[10668]}}},102:{l:{59:{c:[10669]}}},103:{l:{59:{c:[10670]}}},104:{l:{59:{c:[10671]}}}}}}}}}}},114:{l:{116:{l:{59:{c:[8735]},118:{l:{98:{l:{59:{c:[8894]},100:{l:{59:{c:[10653]}}}}}}}}}}},115:{l:{112:{l:{104:{l:{59:{c:[8738]}}}}},116:{l:{59:{c:[197]}}}}},122:{l:{97:{l:{114:{l:{114:{l:{59:{c:[9084]}}}}}}}}}}}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[261]}}}}}}},112:{l:{102:{l:{59:{c:[120146]}}}}}}},112:{l:{59:{c:[8776]},69:{l:{59:{c:[10864]}}},97:{l:{99:{l:{105:{l:{114:{l:{59:{c:[10863]}}}}}}}}},101:{l:{59:{c:[8778]}}},105:{l:{100:{l:{59:{c:[8779]}}}}},111:{l:{115:{l:{59:{c:[39]}}}}},112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[8776]},101:{l:{113:{l:{59:{c:[8778]}}}}}}}}}}}}}}},114:{l:{105:{l:{110:{l:{103:{l:{59:{c:[229]}},c:[229]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119990]}}}}},116:{l:{59:{c:[42]}}},121:{l:{109:{l:{112:{l:{59:{c:[8776]},101:{l:{113:{l:{59:{c:[8781]}}}}}}}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[227]}},c:[227]}}}}}}}}},117:{l:{109:{l:{108:{l:{59:{c:[228]}},c:[228]}}}}},119:{l:{99:{l:{111:{l:{110:{l:{105:{l:{110:{l:{116:{l:{59:{c:[8755]}}}}}}}}}}}}},105:{l:{110:{l:{116:{l:{59:{c:[10769]}}}}}}}}}}},98:{l:{78:{l:{111:{l:{116:{l:{59:{c:[10989]}}}}}}},97:{l:{99:{l:{107:{l:{99:{l:{111:{l:{110:{l:{103:{l:{59:{c:[8780]}}}}}}}}},101:{l:{112:{l:{115:{l:{105:{l:{108:{l:{111:{l:{110:{l:{59:{c:[1014]}}}}}}}}}}}}}}},112:{l:{114:{l:{105:{l:{109:{l:{101:{l:{59:{c:[8245]}}}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8765]},101:{l:{113:{l:{59:{c:[8909]}}}}}}}}}}}}}}},114:{l:{118:{l:{101:{l:{101:{l:{59:{c:[8893]}}}}}}},119:{l:{101:{l:{100:{l:{59:{c:[8965]},103:{l:{101:{l:{59:{c:[8965]}}}}}}}}}}}}}}},98:{l:{114:{l:{107:{l:{59:{c:[9141]},116:{l:{98:{l:{114:{l:{107:{l:{59:{c:[9142]}}}}}}}}}}}}}}},99:{l:{111:{l:{110:{l:{103:{l:{59:{c:[8780]}}}}}}},121:{l:{59:{c:[1073]}}}}},100:{l:{113:{l:{117:{l:{111:{l:{59:{c:[8222]}}}}}}}}},101:{l:{99:{l:{97:{l:{117:{l:{115:{l:{59:{c:[8757]},101:{l:{59:{c:[8757]}}}}}}}}}}},109:{l:{112:{l:{116:{l:{121:{l:{118:{l:{59:{c:[10672]}}}}}}}}}}},112:{l:{115:{l:{105:{l:{59:{c:[1014]}}}}}}},114:{l:{110:{l:{111:{l:{117:{l:{59:{c:[8492]}}}}}}}}},116:{l:{97:{l:{59:{c:[946]}}},104:{l:{59:{c:[8502]}}},119:{l:{101:{l:{101:{l:{110:{l:{59:{c:[8812]}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120095]}}}}},105:{l:{103:{l:{99:{l:{97:{l:{112:{l:{59:{c:[8898]}}}}},105:{l:{114:{l:{99:{l:{59:{c:[9711]}}}}}}},117:{l:{112:{l:{59:{c:[8899]}}}}}}},111:{l:{100:{l:{111:{l:{116:{l:{59:{c:[10752]}}}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10753]}}}}}}}}},116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[10754]}}}}}}}}}}}}},115:{l:{113:{l:{99:{l:{117:{l:{112:{l:{59:{c:[10758]}}}}}}}}},116:{l:{97:{l:{114:{l:{59:{c:[9733]}}}}}}}}},116:{l:{114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{100:{l:{111:{l:{119:{l:{110:{l:{59:{c:[9661]}}}}}}}}},117:{l:{112:{l:{59:{c:[9651]}}}}}}}}}}}}}}}}}}}}},117:{l:{112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10756]}}}}}}}}}}},118:{l:{101:{l:{101:{l:{59:{c:[8897]}}}}}}},119:{l:{101:{l:{100:{l:{103:{l:{101:{l:{59:{c:[8896]}}}}}}}}}}}}}}},107:{l:{97:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10509]}}}}}}}}}}},108:{l:{97:{l:{99:{l:{107:{l:{108:{l:{111:{l:{122:{l:{101:{l:{110:{l:{103:{l:{101:{l:{59:{c:[10731]}}}}}}}}}}}}}}},115:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[9642]}}}}}}}}}}}}},116:{l:{114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[9652]},100:{l:{111:{l:{119:{l:{110:{l:{59:{c:[9662]}}}}}}}}},108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[9666]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[9656]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},110:{l:{107:{l:{59:{c:[9251]}}}}}}},107:{l:{49:{l:{50:{l:{59:{c:[9618]}}},52:{l:{59:{c:[9617]}}}}},51:{l:{52:{l:{59:{c:[9619]}}}}}}},111:{l:{99:{l:{107:{l:{59:{c:[9608]}}}}}}}}},110:{l:{101:{l:{59:{c:[61,8421]},113:{l:{117:{l:{105:{l:{118:{l:{59:{c:[8801,8421]}}}}}}}}}}},111:{l:{116:{l:{59:{c:[8976]}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120147]}}}}},116:{l:{59:{c:[8869]},116:{l:{111:{l:{109:{l:{59:{c:[8869]}}}}}}}}},119:{l:{116:{l:{105:{l:{101:{l:{59:{c:[8904]}}}}}}}}},120:{l:{68:{l:{76:{l:{59:{c:[9559]}}},82:{l:{59:{c:[9556]}}},108:{l:{59:{c:[9558]}}},114:{l:{59:{c:[9555]}}}}},72:{l:{59:{c:[9552]},68:{l:{59:{c:[9574]}}},85:{l:{59:{c:[9577]}}},100:{l:{59:{c:[9572]}}},117:{l:{59:{c:[9575]}}}}},85:{l:{76:{l:{59:{c:[9565]}}},82:{l:{59:{c:[9562]}}},108:{l:{59:{c:[9564]}}},114:{l:{59:{c:[9561]}}}}},86:{l:{59:{c:[9553]},72:{l:{59:{c:[9580]}}},76:{l:{59:{c:[9571]}}},82:{l:{59:{c:[9568]}}},104:{l:{59:{c:[9579]}}},108:{l:{59:{c:[9570]}}},114:{l:{59:{c:[9567]}}}}},98:{l:{111:{l:{120:{l:{59:{c:[10697]}}}}}}},100:{l:{76:{l:{59:{c:[9557]}}},82:{l:{59:{c:[9554]}}},108:{l:{59:{c:[9488]}}},114:{l:{59:{c:[9484]}}}}},104:{l:{59:{c:[9472]},68:{l:{59:{c:[9573]}}},85:{l:{59:{c:[9576]}}},100:{l:{59:{c:[9516]}}},117:{l:{59:{c:[9524]}}}}},109:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[8863]}}}}}}}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[8862]}}}}}}}}},116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8864]}}}}}}}}}}},117:{l:{76:{l:{59:{c:[9563]}}},82:{l:{59:{c:[9560]}}},108:{l:{59:{c:[9496]}}},114:{l:{59:{c:[9492]}}}}},118:{l:{59:{c:[9474]},72:{l:{59:{c:[9578]}}},76:{l:{59:{c:[9569]}}},82:{l:{59:{c:[9566]}}},104:{l:{59:{c:[9532]}}},108:{l:{59:{c:[9508]}}},114:{l:{59:{c:[9500]}}}}}}}}},112:{l:{114:{l:{105:{l:{109:{l:{101:{l:{59:{c:[8245]}}}}}}}}}}},114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[728]}}}}}}},118:{l:{98:{l:{97:{l:{114:{l:{59:{c:[166]}},c:[166]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119991]}}}}},101:{l:{109:{l:{105:{l:{59:{c:[8271]}}}}}}},105:{l:{109:{l:{59:{c:[8765]},101:{l:{59:{c:[8909]}}}}}}},111:{l:{108:{l:{59:{c:[92]},98:{l:{59:{c:[10693]}}},104:{l:{115:{l:{117:{l:{98:{l:{59:{c:[10184]}}}}}}}}}}}}}}},117:{l:{108:{l:{108:{l:{59:{c:[8226]},101:{l:{116:{l:{59:{c:[8226]}}}}}}}}},109:{l:{112:{l:{59:{c:[8782]},69:{l:{59:{c:[10926]}}},101:{l:{59:{c:[8783]},113:{l:{59:{c:[8783]}}}}}}}}}}}}},99:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[263]}}}}}}}}},112:{l:{59:{c:[8745]},97:{l:{110:{l:{100:{l:{59:{c:[10820]}}}}}}},98:{l:{114:{l:{99:{l:{117:{l:{112:{l:{59:{c:[10825]}}}}}}}}}}},99:{l:{97:{l:{112:{l:{59:{c:[10827]}}}}},117:{l:{112:{l:{59:{c:[10823]}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[10816]}}}}}}},115:{l:{59:{c:[8745,65024]}}}}},114:{l:{101:{l:{116:{l:{59:{c:[8257]}}}}},111:{l:{110:{l:{59:{c:[711]}}}}}}}}},99:{l:{97:{l:{112:{l:{115:{l:{59:{c:[10829]}}}}},114:{l:{111:{l:{110:{l:{59:{c:[269]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[231]}},c:[231]}}}}}}},105:{l:{114:{l:{99:{l:{59:{c:[265]}}}}}}},117:{l:{112:{l:{115:{l:{59:{c:[10828]},115:{l:{109:{l:{59:{c:[10832]}}}}}}}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[267]}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[184]}},c:[184]}}}}},109:{l:{112:{l:{116:{l:{121:{l:{118:{l:{59:{c:[10674]}}}}}}}}}}},110:{l:{116:{l:{59:{c:[162]},101:{l:{114:{l:{100:{l:{111:{l:{116:{l:{59:{c:[183]}}}}}}}}}}}},c:[162]}}}}},102:{l:{114:{l:{59:{c:[120096]}}}}},104:{l:{99:{l:{121:{l:{59:{c:[1095]}}}}},101:{l:{99:{l:{107:{l:{59:{c:[10003]},109:{l:{97:{l:{114:{l:{107:{l:{59:{c:[10003]}}}}}}}}}}}}}}},105:{l:{59:{c:[967]}}}}},105:{l:{114:{l:{59:{c:[9675]},69:{l:{59:{c:[10691]}}},99:{l:{59:{c:[710]},101:{l:{113:{l:{59:{c:[8791]}}}}},108:{l:{101:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8634]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8635]}}}}}}}}}}}}}}}}}}}}},100:{l:{82:{l:{59:{c:[174]}}},83:{l:{59:{c:[9416]}}},97:{l:{115:{l:{116:{l:{59:{c:[8859]}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[8858]}}}}}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8861]}}}}}}}}}}}}}}}}},101:{l:{59:{c:[8791]}}},102:{l:{110:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10768]}}}}}}}}}}},109:{l:{105:{l:{100:{l:{59:{c:[10991]}}}}}}},115:{l:{99:{l:{105:{l:{114:{l:{59:{c:[10690]}}}}}}}}}}}}},108:{l:{117:{l:{98:{l:{115:{l:{59:{c:[9827]},117:{l:{105:{l:{116:{l:{59:{c:[9827]}}}}}}}}}}}}}}},111:{l:{108:{l:{111:{l:{110:{l:{59:{c:[58]},101:{l:{59:{c:[8788]},113:{l:{59:{c:[8788]}}}}}}}}}}},109:{l:{109:{l:{97:{l:{59:{c:[44]},116:{l:{59:{c:[64]}}}}}}},112:{l:{59:{c:[8705]},102:{l:{110:{l:{59:{c:[8728]}}}}},108:{l:{101:{l:{109:{l:{101:{l:{110:{l:{116:{l:{59:{c:[8705]}}}}}}}}},120:{l:{101:{l:{115:{l:{59:{c:[8450]}}}}}}}}}}}}}}},110:{l:{103:{l:{59:{c:[8773]},100:{l:{111:{l:{116:{l:{59:{c:[10861]}}}}}}}}},105:{l:{110:{l:{116:{l:{59:{c:[8750]}}}}}}}}},112:{l:{102:{l:{59:{c:[120148]}}},114:{l:{111:{l:{100:{l:{59:{c:[8720]}}}}}}},121:{l:{59:{c:[169]},115:{l:{114:{l:{59:{c:[8471]}}}}}},c:[169]}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8629]}}}}}}},111:{l:{115:{l:{115:{l:{59:{c:[10007]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119992]}}}}},117:{l:{98:{l:{59:{c:[10959]},101:{l:{59:{c:[10961]}}}}},112:{l:{59:{c:[10960]},101:{l:{59:{c:[10962]}}}}}}}}},116:{l:{100:{l:{111:{l:{116:{l:{59:{c:[8943]}}}}}}}}},117:{l:{100:{l:{97:{l:{114:{l:{114:{l:{108:{l:{59:{c:[10552]}}},114:{l:{59:{c:[10549]}}}}}}}}}}},101:{l:{112:{l:{114:{l:{59:{c:[8926]}}}}},115:{l:{99:{l:{59:{c:[8927]}}}}}}},108:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8630]},112:{l:{59:{c:[10557]}}}}}}}}}}},112:{l:{59:{c:[8746]},98:{l:{114:{l:{99:{l:{97:{l:{112:{l:{59:{c:[10824]}}}}}}}}}}},99:{l:{97:{l:{112:{l:{59:{c:[10822]}}}}},117:{l:{112:{l:{59:{c:[10826]}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8845]}}}}}}},111:{l:{114:{l:{59:{c:[10821]}}}}},115:{l:{59:{c:[8746,65024]}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8631]},109:{l:{59:{c:[10556]}}}}}}}}},108:{l:{121:{l:{101:{l:{113:{l:{112:{l:{114:{l:{101:{l:{99:{l:{59:{c:[8926]}}}}}}}}},115:{l:{117:{l:{99:{l:{99:{l:{59:{c:[8927]}}}}}}}}}}}}},118:{l:{101:{l:{101:{l:{59:{c:[8910]}}}}}}},119:{l:{101:{l:{100:{l:{103:{l:{101:{l:{59:{c:[8911]}}}}}}}}}}}}}}},114:{l:{101:{l:{110:{l:{59:{c:[164]}},c:[164]}}}}},118:{l:{101:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8630]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8631]}}}}}}}}}}}}}}}}}}}}}}}}}}},118:{l:{101:{l:{101:{l:{59:{c:[8910]}}}}}}},119:{l:{101:{l:{100:{l:{59:{c:[8911]}}}}}}}}},119:{l:{99:{l:{111:{l:{110:{l:{105:{l:{110:{l:{116:{l:{59:{c:[8754]}}}}}}}}}}}}},105:{l:{110:{l:{116:{l:{59:{c:[8753]}}}}}}}}},121:{l:{108:{l:{99:{l:{116:{l:{121:{l:{59:{c:[9005]}}}}}}}}}}}}},100:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8659]}}}}}}},72:{l:{97:{l:{114:{l:{59:{c:[10597]}}}}}}},97:{l:{103:{l:{103:{l:{101:{l:{114:{l:{59:{c:[8224]}}}}}}}}},108:{l:{101:{l:{116:{l:{104:{l:{59:{c:[8504]}}}}}}}}},114:{l:{114:{l:{59:{c:[8595]}}}}},115:{l:{104:{l:{59:{c:[8208]},118:{l:{59:{c:[8867]}}}}}}}}},98:{l:{107:{l:{97:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10511]}}}}}}}}}}},108:{l:{97:{l:{99:{l:{59:{c:[733]}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[271]}}}}}}}}},121:{l:{59:{c:[1076]}}}}},100:{l:{59:{c:[8518]},97:{l:{103:{l:{103:{l:{101:{l:{114:{l:{59:{c:[8225]}}}}}}}}},114:{l:{114:{l:{59:{c:[8650]}}}}}}},111:{l:{116:{l:{115:{l:{101:{l:{113:{l:{59:{c:[10871]}}}}}}}}}}}}},101:{l:{103:{l:{59:{c:[176]}},c:[176]},108:{l:{116:{l:{97:{l:{59:{c:[948]}}}}}}},109:{l:{112:{l:{116:{l:{121:{l:{118:{l:{59:{c:[10673]}}}}}}}}}}}}},102:{l:{105:{l:{115:{l:{104:{l:{116:{l:{59:{c:[10623]}}}}}}}}},114:{l:{59:{c:[120097]}}}}},104:{l:{97:{l:{114:{l:{108:{l:{59:{c:[8643]}}},114:{l:{59:{c:[8642]}}}}}}}}},105:{l:{97:{l:{109:{l:{59:{c:[8900]},111:{l:{110:{l:{100:{l:{59:{c:[8900]},115:{l:{117:{l:{105:{l:{116:{l:{59:{c:[9830]}}}}}}}}}}}}}}},115:{l:{59:{c:[9830]}}}}}}},101:{l:{59:{c:[168]}}},103:{l:{97:{l:{109:{l:{109:{l:{97:{l:{59:{c:[989]}}}}}}}}}}},115:{l:{105:{l:{110:{l:{59:{c:[8946]}}}}}}},118:{l:{59:{c:[247]},105:{l:{100:{l:{101:{l:{59:{c:[247]},111:{l:{110:{l:{116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8903]}}}}}}}}}}}}}}}},c:[247]}}}}},111:{l:{110:{l:{120:{l:{59:{c:[8903]}}}}}}}}}}},106:{l:{99:{l:{121:{l:{59:{c:[1106]}}}}}}},108:{l:{99:{l:{111:{l:{114:{l:{110:{l:{59:{c:[8990]}}}}}}},114:{l:{111:{l:{112:{l:{59:{c:[8973]}}}}}}}}}}},111:{l:{108:{l:{108:{l:{97:{l:{114:{l:{59:{c:[36]}}}}}}}}},112:{l:{102:{l:{59:{c:[120149]}}}}},116:{l:{59:{c:[729]},101:{l:{113:{l:{59:{c:[8784]},100:{l:{111:{l:{116:{l:{59:{c:[8785]}}}}}}}}}}},109:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[8760]}}}}}}}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[8724]}}}}}}}}},115:{l:{113:{l:{117:{l:{97:{l:{114:{l:{101:{l:{59:{c:[8865]}}}}}}}}}}}}}}},117:{l:{98:{l:{108:{l:{101:{l:{98:{l:{97:{l:{114:{l:{119:{l:{101:{l:{100:{l:{103:{l:{101:{l:{59:{c:[8966]}}}}}}}}}}}}}}}}}}}}}}}}},119:{l:{110:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8595]}}}}}}}}}}},100:{l:{111:{l:{119:{l:{110:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{115:{l:{59:{c:[8650]}}}}}}}}}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{111:{l:{111:{l:{110:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8643]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8642]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},114:{l:{98:{l:{107:{l:{97:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10512]}}}}}}}}}}}}},99:{l:{111:{l:{114:{l:{110:{l:{59:{c:[8991]}}}}}}},114:{l:{111:{l:{112:{l:{59:{c:[8972]}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119993]}}},121:{l:{59:{c:[1109]}}}}},111:{l:{108:{l:{59:{c:[10742]}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[273]}}}}}}}}}}},116:{l:{100:{l:{111:{l:{116:{l:{59:{c:[8945]}}}}}}},114:{l:{105:{l:{59:{c:[9663]},102:{l:{59:{c:[9662]}}}}}}}}},117:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8693]}}}}}}},104:{l:{97:{l:{114:{l:{59:{c:[10607]}}}}}}}}},119:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[10662]}}}}}}}}}}}}},122:{l:{99:{l:{121:{l:{59:{c:[1119]}}}}},105:{l:{103:{l:{114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10239]}}}}}}}}}}}}}}}}},101:{l:{68:{l:{68:{l:{111:{l:{116:{l:{59:{c:[10871]}}}}}}},111:{l:{116:{l:{59:{c:[8785]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[233]}},c:[233]}}}}}}},115:{l:{116:{l:{101:{l:{114:{l:{59:{c:[10862]}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[283]}}}}}}}}},105:{l:{114:{l:{59:{c:[8790]},99:{l:{59:{c:[234]}},c:[234]}}}}},111:{l:{108:{l:{111:{l:{110:{l:{59:{c:[8789]}}}}}}}}},121:{l:{59:{c:[1101]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[279]}}}}}}},101:{l:{59:{c:[8519]}}},102:{l:{68:{l:{111:{l:{116:{l:{59:{c:[8786]}}}}}}},114:{l:{59:{c:[120098]}}}}},103:{l:{59:{c:[10906]},114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[232]}},c:[232]}}}}}}},115:{l:{59:{c:[10902]},100:{l:{111:{l:{116:{l:{59:{c:[10904]}}}}}}}}}}},108:{l:{59:{c:[10905]},105:{l:{110:{l:{116:{l:{101:{l:{114:{l:{115:{l:{59:{c:[9191]}}}}}}}}}}}}},108:{l:{59:{c:[8467]}}},115:{l:{59:{c:[10901]},100:{l:{111:{l:{116:{l:{59:{c:[10903]}}}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[275]}}}}}}},112:{l:{116:{l:{121:{l:{59:{c:[8709]},115:{l:{101:{l:{116:{l:{59:{c:[8709]}}}}}}},118:{l:{59:{c:[8709]}}}}}}}}},115:{l:{112:{l:{49:{l:{51:{l:{59:{c:[8196]}}},52:{l:{59:{c:[8197]}}}}},59:{c:[8195]}}}}}}},110:{l:{103:{l:{59:{c:[331]}}},115:{l:{112:{l:{59:{c:[8194]}}}}}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[281]}}}}}}},112:{l:{102:{l:{59:{c:[120150]}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[8917]},115:{l:{108:{l:{59:{c:[10723]}}}}}}}}},108:{l:{117:{l:{115:{l:{59:{c:[10865]}}}}}}},115:{l:{105:{l:{59:{c:[949]},108:{l:{111:{l:{110:{l:{59:{c:[949]}}}}}}},118:{l:{59:{c:[1013]}}}}}}}}},113:{l:{99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[8790]}}}}}}},111:{l:{108:{l:{111:{l:{110:{l:{59:{c:[8789]}}}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8770]}}}}},108:{l:{97:{l:{110:{l:{116:{l:{103:{l:{116:{l:{114:{l:{59:{c:[10902]}}}}}}},108:{l:{101:{l:{115:{l:{115:{l:{59:{c:[10901]}}}}}}}}}}}}}}}}}}},117:{l:{97:{l:{108:{l:{115:{l:{59:{c:[61]}}}}}}},101:{l:{115:{l:{116:{l:{59:{c:[8799]}}}}}}},105:{l:{118:{l:{59:{c:[8801]},68:{l:{68:{l:{59:{c:[10872]}}}}}}}}}}},118:{l:{112:{l:{97:{l:{114:{l:{115:{l:{108:{l:{59:{c:[10725]}}}}}}}}}}}}}}},114:{l:{68:{l:{111:{l:{116:{l:{59:{c:[8787]}}}}}}},97:{l:{114:{l:{114:{l:{59:{c:[10609]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8495]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8784]}}}}}}},105:{l:{109:{l:{59:{c:[8770]}}}}}}},116:{l:{97:{l:{59:{c:[951]}}},104:{l:{59:{c:[240]}},c:[240]}}},117:{l:{109:{l:{108:{l:{59:{c:[235]}},c:[235]}}},114:{l:{111:{l:{59:{c:[8364]}}}}}}},120:{l:{99:{l:{108:{l:{59:{c:[33]}}}}},105:{l:{115:{l:{116:{l:{59:{c:[8707]}}}}}}},112:{l:{101:{l:{99:{l:{116:{l:{97:{l:{116:{l:{105:{l:{111:{l:{110:{l:{59:{c:[8496]}}}}}}}}}}}}}}}}},111:{l:{110:{l:{101:{l:{110:{l:{116:{l:{105:{l:{97:{l:{108:{l:{101:{l:{59:{c:[8519]}}}}}}}}}}}}}}}}}}}}}}}}},102:{l:{97:{l:{108:{l:{108:{l:{105:{l:{110:{l:{103:{l:{100:{l:{111:{l:{116:{l:{115:{l:{101:{l:{113:{l:{59:{c:[8786]}}}}}}}}}}}}}}}}}}}}}}}}},99:{l:{121:{l:{59:{c:[1092]}}}}},101:{l:{109:{l:{97:{l:{108:{l:{101:{l:{59:{c:[9792]}}}}}}}}}}},102:{l:{105:{l:{108:{l:{105:{l:{103:{l:{59:{c:[64259]}}}}}}}}},108:{l:{105:{l:{103:{l:{59:{c:[64256]}}}}},108:{l:{105:{l:{103:{l:{59:{c:[64260]}}}}}}}}},114:{l:{59:{c:[120099]}}}}},105:{l:{108:{l:{105:{l:{103:{l:{59:{c:[64257]}}}}}}}}},106:{l:{108:{l:{105:{l:{103:{l:{59:{c:[102,106]}}}}}}}}},108:{l:{97:{l:{116:{l:{59:{c:[9837]}}}}},108:{l:{105:{l:{103:{l:{59:{c:[64258]}}}}}}},116:{l:{110:{l:{115:{l:{59:{c:[9649]}}}}}}}}},110:{l:{111:{l:{102:{l:{59:{c:[402]}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120151]}}}}},114:{l:{97:{l:{108:{l:{108:{l:{59:{c:[8704]}}}}}}},107:{l:{59:{c:[8916]},118:{l:{59:{c:[10969]}}}}}}}}},112:{l:{97:{l:{114:{l:{116:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10765]}}}}}}}}}}}}}}},114:{l:{97:{l:{99:{l:{49:{l:{50:{l:{59:{c:[189]}},c:[189]},51:{l:{59:{c:[8531]}}},52:{l:{59:{c:[188]}},c:[188]},53:{l:{59:{c:[8533]}}},54:{l:{59:{c:[8537]}}},56:{l:{59:{c:[8539]}}}}},50:{l:{51:{l:{59:{c:[8532]}}},53:{l:{59:{c:[8534]}}}}},51:{l:{52:{l:{59:{c:[190]}},c:[190]},53:{l:{59:{c:[8535]}}},56:{l:{59:{c:[8540]}}}}},52:{l:{53:{l:{59:{c:[8536]}}}}},53:{l:{54:{l:{59:{c:[8538]}}},56:{l:{59:{c:[8541]}}}}},55:{l:{56:{l:{59:{c:[8542]}}}}}}},115:{l:{108:{l:{59:{c:[8260]}}}}}}},111:{l:{119:{l:{110:{l:{59:{c:[8994]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119995]}}}}}}}}},103:{l:{69:{l:{59:{c:[8807]},108:{l:{59:{c:[10892]}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[501]}}}}}}}}},109:{l:{109:{l:{97:{l:{59:{c:[947]},100:{l:{59:{c:[989]}}}}}}}}},112:{l:{59:{c:[10886]}}}}},98:{l:{114:{l:{101:{l:{118:{l:{101:{l:{59:{c:[287]}}}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[285]}}}}}}},121:{l:{59:{c:[1075]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[289]}}}}}}},101:{l:{59:{c:[8805]},108:{l:{59:{c:[8923]}}},113:{l:{59:{c:[8805]},113:{l:{59:{c:[8807]}}},115:{l:{108:{l:{97:{l:{110:{l:{116:{l:{59:{c:[10878]}}}}}}}}}}}}},115:{l:{59:{c:[10878]},99:{l:{99:{l:{59:{c:[10921]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[10880]},111:{l:{59:{c:[10882]},108:{l:{59:{c:[10884]}}}}}}}}}}},108:{l:{59:{c:[8923,65024]},101:{l:{115:{l:{59:{c:[10900]}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120100]}}}}},103:{l:{59:{c:[8811]},103:{l:{59:{c:[8921]}}}}},105:{l:{109:{l:{101:{l:{108:{l:{59:{c:[8503]}}}}}}}}},106:{l:{99:{l:{121:{l:{59:{c:[1107]}}}}}}},108:{l:{59:{c:[8823]},69:{l:{59:{c:[10898]}}},97:{l:{59:{c:[10917]}}},106:{l:{59:{c:[10916]}}}}},110:{l:{69:{l:{59:{c:[8809]}}},97:{l:{112:{l:{59:{c:[10890]},112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10890]}}}}}}}}}}}}},101:{l:{59:{c:[10888]},113:{l:{59:{c:[10888]},113:{l:{59:{c:[8809]}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8935]}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120152]}}}}}}},114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[96]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8458]}}}}},105:{l:{109:{l:{59:{c:[8819]},101:{l:{59:{c:[10894]}}},108:{l:{59:{c:[10896]}}}}}}}}},116:{l:{59:{c:[62]},99:{l:{99:{l:{59:{c:[10919]}}},105:{l:{114:{l:{59:{c:[10874]}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8919]}}}}}}},108:{l:{80:{l:{97:{l:{114:{l:{59:{c:[10645]}}}}}}}}},113:{l:{117:{l:{101:{l:{115:{l:{116:{l:{59:{c:[10876]}}}}}}}}}}},114:{l:{97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10886]}}}}}}}}}}},114:{l:{114:{l:{59:{c:[10616]}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8919]}}}}}}},101:{l:{113:{l:{108:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8923]}}}}}}}}},113:{l:{108:{l:{101:{l:{115:{l:{115:{l:{59:{c:[10892]}}}}}}}}}}}}}}},108:{l:{101:{l:{115:{l:{115:{l:{59:{c:[8823]}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8819]}}}}}}}}}},c:[62]},118:{l:{101:{l:{114:{l:{116:{l:{110:{l:{101:{l:{113:{l:{113:{l:{59:{c:[8809,65024]}}}}}}}}}}}}}}},110:{l:{69:{l:{59:{c:[8809,65024]}}}}}}}}},104:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8660]}}}}}}},97:{l:{105:{l:{114:{l:{115:{l:{112:{l:{59:{c:[8202]}}}}}}}}},108:{l:{102:{l:{59:{c:[189]}}}}},109:{l:{105:{l:{108:{l:{116:{l:{59:{c:[8459]}}}}}}}}},114:{l:{100:{l:{99:{l:{121:{l:{59:{c:[1098]}}}}}}},114:{l:{59:{c:[8596]},99:{l:{105:{l:{114:{l:{59:{c:[10568]}}}}}}},119:{l:{59:{c:[8621]}}}}}}}}},98:{l:{97:{l:{114:{l:{59:{c:[8463]}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[293]}}}}}}}}},101:{l:{97:{l:{114:{l:{116:{l:{115:{l:{59:{c:[9829]},117:{l:{105:{l:{116:{l:{59:{c:[9829]}}}}}}}}}}}}}}},108:{l:{108:{l:{105:{l:{112:{l:{59:{c:[8230]}}}}}}}}},114:{l:{99:{l:{111:{l:{110:{l:{59:{c:[8889]}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120101]}}}}},107:{l:{115:{l:{101:{l:{97:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10533]}}}}}}}}}}},119:{l:{97:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10534]}}}}}}}}}}}}}}},111:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8703]}}}}}}},109:{l:{116:{l:{104:{l:{116:{l:{59:{c:[8763]}}}}}}}}},111:{l:{107:{l:{108:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8617]}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8618]}}}}}}}}}}}}}}}}}}}}}}}}},112:{l:{102:{l:{59:{c:[120153]}}}}},114:{l:{98:{l:{97:{l:{114:{l:{59:{c:[8213]}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119997]}}}}},108:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8463]}}}}}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[295]}}}}}}}}}}},121:{l:{98:{l:{117:{l:{108:{l:{108:{l:{59:{c:[8259]}}}}}}}}},112:{l:{104:{l:{101:{l:{110:{l:{59:{c:[8208]}}}}}}}}}}}}},105:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[237]}},c:[237]}}}}}}}}},99:{l:{59:{c:[8291]},105:{l:{114:{l:{99:{l:{59:{c:[238]}},c:[238]}}}}},121:{l:{59:{c:[1080]}}}}},101:{l:{99:{l:{121:{l:{59:{c:[1077]}}}}},120:{l:{99:{l:{108:{l:{59:{c:[161]}},c:[161]}}}}}}},102:{l:{102:{l:{59:{c:[8660]}}},114:{l:{59:{c:[120102]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[236]}},c:[236]}}}}}}}}},105:{l:{59:{c:[8520]},105:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10764]}}}}}}},110:{l:{116:{l:{59:{c:[8749]}}}}}}},110:{l:{102:{l:{105:{l:{110:{l:{59:{c:[10716]}}}}}}}}},111:{l:{116:{l:{97:{l:{59:{c:[8489]}}}}}}}}},106:{l:{108:{l:{105:{l:{103:{l:{59:{c:[307]}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[299]}}}}},103:{l:{101:{l:{59:{c:[8465]}}},108:{l:{105:{l:{110:{l:{101:{l:{59:{c:[8464]}}}}}}}}},112:{l:{97:{l:{114:{l:{116:{l:{59:{c:[8465]}}}}}}}}}}},116:{l:{104:{l:{59:{c:[305]}}}}}}},111:{l:{102:{l:{59:{c:[8887]}}}}},112:{l:{101:{l:{100:{l:{59:{c:[437]}}}}}}}}},110:{l:{59:{c:[8712]},99:{l:{97:{l:{114:{l:{101:{l:{59:{c:[8453]}}}}}}}}},102:{l:{105:{l:{110:{l:{59:{c:[8734]},116:{l:{105:{l:{101:{l:{59:{c:[10717]}}}}}}}}}}}}},111:{l:{100:{l:{111:{l:{116:{l:{59:{c:[305]}}}}}}}}},116:{l:{59:{c:[8747]},99:{l:{97:{l:{108:{l:{59:{c:[8890]}}}}}}},101:{l:{103:{l:{101:{l:{114:{l:{115:{l:{59:{c:[8484]}}}}}}}}},114:{l:{99:{l:{97:{l:{108:{l:{59:{c:[8890]}}}}}}}}}}},108:{l:{97:{l:{114:{l:{104:{l:{107:{l:{59:{c:[10775]}}}}}}}}}}},112:{l:{114:{l:{111:{l:{100:{l:{59:{c:[10812]}}}}}}}}}}}}},111:{l:{99:{l:{121:{l:{59:{c:[1105]}}}}},103:{l:{111:{l:{110:{l:{59:{c:[303]}}}}}}},112:{l:{102:{l:{59:{c:[120154]}}}}},116:{l:{97:{l:{59:{c:[953]}}}}}}},112:{l:{114:{l:{111:{l:{100:{l:{59:{c:[10812]}}}}}}}}},113:{l:{117:{l:{101:{l:{115:{l:{116:{l:{59:{c:[191]}},c:[191]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119998]}}}}},105:{l:{110:{l:{59:{c:[8712]},69:{l:{59:{c:[8953]}}},100:{l:{111:{l:{116:{l:{59:{c:[8949]}}}}}}},115:{l:{59:{c:[8948]},118:{l:{59:{c:[8947]}}}}},118:{l:{59:{c:[8712]}}}}}}}}},116:{l:{59:{c:[8290]},105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[297]}}}}}}}}}}},117:{l:{107:{l:{99:{l:{121:{l:{59:{c:[1110]}}}}}}},109:{l:{108:{l:{59:{c:[239]}},c:[239]}}}}}}},106:{l:{99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[309]}}}}}}},121:{l:{59:{c:[1081]}}}}},102:{l:{114:{l:{59:{c:[120103]}}}}},109:{l:{97:{l:{116:{l:{104:{l:{59:{c:[567]}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120155]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[119999]}}}}},101:{l:{114:{l:{99:{l:{121:{l:{59:{c:[1112]}}}}}}}}}}},117:{l:{107:{l:{99:{l:{121:{l:{59:{c:[1108]}}}}}}}}}}},107:{l:{97:{l:{112:{l:{112:{l:{97:{l:{59:{c:[954]},118:{l:{59:{c:[1008]}}}}}}}}}}},99:{l:{101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[311]}}}}}}}}},121:{l:{59:{c:[1082]}}}}},102:{l:{114:{l:{59:{c:[120104]}}}}},103:{l:{114:{l:{101:{l:{101:{l:{110:{l:{59:{c:[312]}}}}}}}}}}},104:{l:{99:{l:{121:{l:{59:{c:[1093]}}}}}}},106:{l:{99:{l:{121:{l:{59:{c:[1116]}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120156]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[12e4]}}}}}}}}},108:{l:{65:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8666]}}}}}}},114:{l:{114:{l:{59:{c:[8656]}}}}},116:{l:{97:{l:{105:{l:{108:{l:{59:{c:[10523]}}}}}}}}}}},66:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10510]}}}}}}}}},69:{l:{59:{c:[8806]},103:{l:{59:{c:[10891]}}}}},72:{l:{97:{l:{114:{l:{59:{c:[10594]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[314]}}}}}}}}},101:{l:{109:{l:{112:{l:{116:{l:{121:{l:{118:{l:{59:{c:[10676]}}}}}}}}}}}}},103:{l:{114:{l:{97:{l:{110:{l:{59:{c:[8466]}}}}}}}}},109:{l:{98:{l:{100:{l:{97:{l:{59:{c:[955]}}}}}}}}},110:{l:{103:{l:{59:{c:[10216]},100:{l:{59:{c:[10641]}}},108:{l:{101:{l:{59:{c:[10216]}}}}}}}}},112:{l:{59:{c:[10885]}}},113:{l:{117:{l:{111:{l:{59:{c:[171]}},c:[171]}}}}},114:{l:{114:{l:{59:{c:[8592]},98:{l:{59:{c:[8676]},102:{l:{115:{l:{59:{c:[10527]}}}}}}},102:{l:{115:{l:{59:{c:[10525]}}}}},104:{l:{107:{l:{59:{c:[8617]}}}}},108:{l:{112:{l:{59:{c:[8619]}}}}},112:{l:{108:{l:{59:{c:[10553]}}}}},115:{l:{105:{l:{109:{l:{59:{c:[10611]}}}}}}},116:{l:{108:{l:{59:{c:[8610]}}}}}}}}},116:{l:{59:{c:[10923]},97:{l:{105:{l:{108:{l:{59:{c:[10521]}}}}}}},101:{l:{59:{c:[10925]},115:{l:{59:{c:[10925,65024]}}}}}}}}},98:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10508]}}}}}}},98:{l:{114:{l:{107:{l:{59:{c:[10098]}}}}}}},114:{l:{97:{l:{99:{l:{101:{l:{59:{c:[123]}}},107:{l:{59:{c:[91]}}}}}}},107:{l:{101:{l:{59:{c:[10635]}}},115:{l:{108:{l:{100:{l:{59:{c:[10639]}}},117:{l:{59:{c:[10637]}}}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[318]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[316]}}}}}}},105:{l:{108:{l:{59:{c:[8968]}}}}}}},117:{l:{98:{l:{59:{c:[123]}}}}},121:{l:{59:{c:[1083]}}}}},100:{l:{99:{l:{97:{l:{59:{c:[10550]}}}}},113:{l:{117:{l:{111:{l:{59:{c:[8220]},114:{l:{59:{c:[8222]}}}}}}}}},114:{l:{100:{l:{104:{l:{97:{l:{114:{l:{59:{c:[10599]}}}}}}}}},117:{l:{115:{l:{104:{l:{97:{l:{114:{l:{59:{c:[10571]}}}}}}}}}}}}},115:{l:{104:{l:{59:{c:[8626]}}}}}}},101:{l:{59:{c:[8804]},102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8592]},116:{l:{97:{l:{105:{l:{108:{l:{59:{c:[8610]}}}}}}}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{111:{l:{111:{l:{110:{l:{100:{l:{111:{l:{119:{l:{110:{l:{59:{c:[8637]}}}}}}}}},117:{l:{112:{l:{59:{c:[8636]}}}}}}}}}}}}}}}}}}},108:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{115:{l:{59:{c:[8647]}}}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8596]},115:{l:{59:{c:[8646]}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{111:{l:{111:{l:{110:{l:{115:{l:{59:{c:[8651]}}}}}}}}}}}}}}}}},115:{l:{113:{l:{117:{l:{105:{l:{103:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8621]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},116:{l:{104:{l:{114:{l:{101:{l:{101:{l:{116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8907]}}}}}}}}}}}}}}}}}}}}}}}}},103:{l:{59:{c:[8922]}}},113:{l:{59:{c:[8804]},113:{l:{59:{c:[8806]}}},115:{l:{108:{l:{97:{l:{110:{l:{116:{l:{59:{c:[10877]}}}}}}}}}}}}},115:{l:{59:{c:[10877]},99:{l:{99:{l:{59:{c:[10920]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[10879]},111:{l:{59:{c:[10881]},114:{l:{59:{c:[10883]}}}}}}}}}}},103:{l:{59:{c:[8922,65024]},101:{l:{115:{l:{59:{c:[10899]}}}}}}},115:{l:{97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10885]}}}}}}}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8918]}}}}}}},101:{l:{113:{l:{103:{l:{116:{l:{114:{l:{59:{c:[8922]}}}}}}},113:{l:{103:{l:{116:{l:{114:{l:{59:{c:[10891]}}}}}}}}}}}}},103:{l:{116:{l:{114:{l:{59:{c:[8822]}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8818]}}}}}}}}}}}}},102:{l:{105:{l:{115:{l:{104:{l:{116:{l:{59:{c:[10620]}}}}}}}}},108:{l:{111:{l:{111:{l:{114:{l:{59:{c:[8970]}}}}}}}}},114:{l:{59:{c:[120105]}}}}},103:{l:{59:{c:[8822]},69:{l:{59:{c:[10897]}}}}},104:{l:{97:{l:{114:{l:{100:{l:{59:{c:[8637]}}},117:{l:{59:{c:[8636]},108:{l:{59:{c:[10602]}}}}}}}}},98:{l:{108:{l:{107:{l:{59:{c:[9604]}}}}}}}}},106:{l:{99:{l:{121:{l:{59:{c:[1113]}}}}}}},108:{l:{59:{c:[8810]},97:{l:{114:{l:{114:{l:{59:{c:[8647]}}}}}}},99:{l:{111:{l:{114:{l:{110:{l:{101:{l:{114:{l:{59:{c:[8990]}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{100:{l:{59:{c:[10603]}}}}}}}}},116:{l:{114:{l:{105:{l:{59:{c:[9722]}}}}}}}}},109:{l:{105:{l:{100:{l:{111:{l:{116:{l:{59:{c:[320]}}}}}}}}},111:{l:{117:{l:{115:{l:{116:{l:{59:{c:[9136]},97:{l:{99:{l:{104:{l:{101:{l:{59:{c:[9136]}}}}}}}}}}}}}}}}}}},110:{l:{69:{l:{59:{c:[8808]}}},97:{l:{112:{l:{59:{c:[10889]},112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10889]}}}}}}}}}}}}},101:{l:{59:{c:[10887]},113:{l:{59:{c:[10887]},113:{l:{59:{c:[8808]}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8934]}}}}}}}}},111:{l:{97:{l:{110:{l:{103:{l:{59:{c:[10220]}}}}},114:{l:{114:{l:{59:{c:[8701]}}}}}}},98:{l:{114:{l:{107:{l:{59:{c:[10214]}}}}}}},110:{l:{103:{l:{108:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10229]}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10231]}}}}}}}}}}}}}}}}}}}}}}}}}}}}},109:{l:{97:{l:{112:{l:{115:{l:{116:{l:{111:{l:{59:{c:[10236]}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[10230]}}}}}}}}}}}}}}}}}}}}}}}}},111:{l:{112:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8619]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8620]}}}}}}}}}}}}}}}}}}}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[10629]}}}}},102:{l:{59:{c:[120157]}}},108:{l:{117:{l:{115:{l:{59:{c:[10797]}}}}}}}}},116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[10804]}}}}}}}}}}},119:{l:{97:{l:{115:{l:{116:{l:{59:{c:[8727]}}}}}}},98:{l:{97:{l:{114:{l:{59:{c:[95]}}}}}}}}},122:{l:{59:{c:[9674]},101:{l:{110:{l:{103:{l:{101:{l:{59:{c:[9674]}}}}}}}}},102:{l:{59:{c:[10731]}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[40]},108:{l:{116:{l:{59:{c:[10643]}}}}}}}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8646]}}}}}}},99:{l:{111:{l:{114:{l:{110:{l:{101:{l:{114:{l:{59:{c:[8991]}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{59:{c:[8651]},100:{l:{59:{c:[10605]}}}}}}}}},109:{l:{59:{c:[8206]}}},116:{l:{114:{l:{105:{l:{59:{c:[8895]}}}}}}}}},115:{l:{97:{l:{113:{l:{117:{l:{111:{l:{59:{c:[8249]}}}}}}}}},99:{l:{114:{l:{59:{c:[120001]}}}}},104:{l:{59:{c:[8624]}}},105:{l:{109:{l:{59:{c:[8818]},101:{l:{59:{c:[10893]}}},103:{l:{59:{c:[10895]}}}}}}},113:{l:{98:{l:{59:{c:[91]}}},117:{l:{111:{l:{59:{c:[8216]},114:{l:{59:{c:[8218]}}}}}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[322]}}}}}}}}}}},116:{l:{59:{c:[60]},99:{l:{99:{l:{59:{c:[10918]}}},105:{l:{114:{l:{59:{c:[10873]}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8918]}}}}}}},104:{l:{114:{l:{101:{l:{101:{l:{59:{c:[8907]}}}}}}}}},105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8905]}}}}}}}}},108:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10614]}}}}}}}}},113:{l:{117:{l:{101:{l:{115:{l:{116:{l:{59:{c:[10875]}}}}}}}}}}},114:{l:{80:{l:{97:{l:{114:{l:{59:{c:[10646]}}}}}}},105:{l:{59:{c:[9667]},101:{l:{59:{c:[8884]}}},102:{l:{59:{c:[9666]}}}}}}}},c:[60]},117:{l:{114:{l:{100:{l:{115:{l:{104:{l:{97:{l:{114:{l:{59:{c:[10570]}}}}}}}}}}},117:{l:{104:{l:{97:{l:{114:{l:{59:{c:[10598]}}}}}}}}}}}}},118:{l:{101:{l:{114:{l:{116:{l:{110:{l:{101:{l:{113:{l:{113:{l:{59:{c:[8808,65024]}}}}}}}}}}}}}}},110:{l:{69:{l:{59:{c:[8808,65024]}}}}}}}}},109:{l:{68:{l:{68:{l:{111:{l:{116:{l:{59:{c:[8762]}}}}}}}}},97:{l:{99:{l:{114:{l:{59:{c:[175]}},c:[175]}}},108:{l:{101:{l:{59:{c:[9794]}}},116:{l:{59:{c:[10016]},101:{l:{115:{l:{101:{l:{59:{c:[10016]}}}}}}}}}}},112:{l:{59:{c:[8614]},115:{l:{116:{l:{111:{l:{59:{c:[8614]},100:{l:{111:{l:{119:{l:{110:{l:{59:{c:[8615]}}}}}}}}},108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8612]}}}}}}}}},117:{l:{112:{l:{59:{c:[8613]}}}}}}}}}}}}},114:{l:{107:{l:{101:{l:{114:{l:{59:{c:[9646]}}}}}}}}}}},99:{l:{111:{l:{109:{l:{109:{l:{97:{l:{59:{c:[10793]}}}}}}}}},121:{l:{59:{c:[1084]}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8212]}}}}}}}}},101:{l:{97:{l:{115:{l:{117:{l:{114:{l:{101:{l:{100:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[8737]}}}}}}}}}}}}}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120106]}}}}},104:{l:{111:{l:{59:{c:[8487]}}}}},105:{l:{99:{l:{114:{l:{111:{l:{59:{c:[181]}},c:[181]}}}}},100:{l:{59:{c:[8739]},97:{l:{115:{l:{116:{l:{59:{c:[42]}}}}}}},99:{l:{105:{l:{114:{l:{59:{c:[10992]}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[183]}},c:[183]}}}}}}},110:{l:{117:{l:{115:{l:{59:{c:[8722]},98:{l:{59:{c:[8863]}}},100:{l:{59:{c:[8760]},117:{l:{59:{c:[10794]}}}}}}}}}}}}},108:{l:{99:{l:{112:{l:{59:{c:[10971]}}}}},100:{l:{114:{l:{59:{c:[8230]}}}}}}},110:{l:{112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[8723]}}}}}}}}}}},111:{l:{100:{l:{101:{l:{108:{l:{115:{l:{59:{c:[8871]}}}}}}}}},112:{l:{102:{l:{59:{c:[120158]}}}}}}},112:{l:{59:{c:[8723]}}},115:{l:{99:{l:{114:{l:{59:{c:[120002]}}}}},116:{l:{112:{l:{111:{l:{115:{l:{59:{c:[8766]}}}}}}}}}}},117:{l:{59:{c:[956]},108:{l:{116:{l:{105:{l:{109:{l:{97:{l:{112:{l:{59:{c:[8888]}}}}}}}}}}}}},109:{l:{97:{l:{112:{l:{59:{c:[8888]}}}}}}}}}}},110:{l:{71:{l:{103:{l:{59:{c:[8921,824]}}},116:{l:{59:{c:[8811,8402]},118:{l:{59:{c:[8811,824]}}}}}}},76:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8653]}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8654]}}}}}}}}}}}}}}}}}}}}}}}}}}},108:{l:{59:{c:[8920,824]}}},116:{l:{59:{c:[8810,8402]},118:{l:{59:{c:[8810,824]}}}}}}},82:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8655]}}}}}}}}}}}}}}}}}}}}},86:{l:{68:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8879]}}}}}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8878]}}}}}}}}}}},97:{l:{98:{l:{108:{l:{97:{l:{59:{c:[8711]}}}}}}},99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[324]}}}}}}}}},110:{l:{103:{l:{59:{c:[8736,8402]}}}}},112:{l:{59:{c:[8777]},69:{l:{59:{c:[10864,824]}}},105:{l:{100:{l:{59:{c:[8779,824]}}}}},111:{l:{115:{l:{59:{c:[329]}}}}},112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[8777]}}}}}}}}}}},116:{l:{117:{l:{114:{l:{59:{c:[9838]},97:{l:{108:{l:{59:{c:[9838]},115:{l:{59:{c:[8469]}}}}}}}}}}}}}}},98:{l:{115:{l:{112:{l:{59:{c:[160]}},c:[160]}}},117:{l:{109:{l:{112:{l:{59:{c:[8782,824]},101:{l:{59:{c:[8783,824]}}}}}}}}}}},99:{l:{97:{l:{112:{l:{59:{c:[10819]}}},114:{l:{111:{l:{110:{l:{59:{c:[328]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[326]}}}}}}}}},111:{l:{110:{l:{103:{l:{59:{c:[8775]},100:{l:{111:{l:{116:{l:{59:{c:[10861,824]}}}}}}}}}}}}},117:{l:{112:{l:{59:{c:[10818]}}}}},121:{l:{59:{c:[1085]}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8211]}}}}}}}}},101:{l:{59:{c:[8800]},65:{l:{114:{l:{114:{l:{59:{c:[8663]}}}}}}},97:{l:{114:{l:{104:{l:{107:{l:{59:{c:[10532]}}}}},114:{l:{59:{c:[8599]},111:{l:{119:{l:{59:{c:[8599]}}}}}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8784,824]}}}}}}},113:{l:{117:{l:{105:{l:{118:{l:{59:{c:[8802]}}}}}}}}},115:{l:{101:{l:{97:{l:{114:{l:{59:{c:[10536]}}}}}}},105:{l:{109:{l:{59:{c:[8770,824]}}}}}}},120:{l:{105:{l:{115:{l:{116:{l:{59:{c:[8708]},115:{l:{59:{c:[8708]}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120107]}}}}},103:{l:{69:{l:{59:{c:[8807,824]}}},101:{l:{59:{c:[8817]},113:{l:{59:{c:[8817]},113:{l:{59:{c:[8807,824]}}},115:{l:{108:{l:{97:{l:{110:{l:{116:{l:{59:{c:[10878,824]}}}}}}}}}}}}},115:{l:{59:{c:[10878,824]}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8821]}}}}}}},116:{l:{59:{c:[8815]},114:{l:{59:{c:[8815]}}}}}}},104:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8654]}}}}}}},97:{l:{114:{l:{114:{l:{59:{c:[8622]}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[10994]}}}}}}}}},105:{l:{59:{c:[8715]},115:{l:{59:{c:[8956]},100:{l:{59:{c:[8954]}}}}},118:{l:{59:{c:[8715]}}}}},106:{l:{99:{l:{121:{l:{59:{c:[1114]}}}}}}},108:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8653]}}}}}}},69:{l:{59:{c:[8806,824]}}},97:{l:{114:{l:{114:{l:{59:{c:[8602]}}}}}}},100:{l:{114:{l:{59:{c:[8229]}}}}},101:{l:{59:{c:[8816]},102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8602]}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8622]}}}}}}}}}}}}}}}}}}}}}}}}},113:{l:{59:{c:[8816]},113:{l:{59:{c:[8806,824]}}},115:{l:{108:{l:{97:{l:{110:{l:{116:{l:{59:{c:[10877,824]}}}}}}}}}}}}},115:{l:{59:{c:[10877,824]},115:{l:{59:{c:[8814]}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8820]}}}}}}},116:{l:{59:{c:[8814]},114:{l:{105:{l:{59:{c:[8938]},101:{l:{59:{c:[8940]}}}}}}}}}}},109:{l:{105:{l:{100:{l:{59:{c:[8740]}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120159]}}}}},116:{l:{59:{c:[172]},105:{l:{110:{l:{59:{c:[8713]},69:{l:{59:{c:[8953,824]}}},100:{l:{111:{l:{116:{l:{59:{c:[8949,824]}}}}}}},118:{l:{97:{l:{59:{c:[8713]}}},98:{l:{59:{c:[8951]}}},99:{l:{59:{c:[8950]}}}}}}}}},110:{l:{105:{l:{59:{c:[8716]},118:{l:{97:{l:{59:{c:[8716]}}},98:{l:{59:{c:[8958]}}},99:{l:{59:{c:[8957]}}}}}}}}}},c:[172]}}},112:{l:{97:{l:{114:{l:{59:{c:[8742]},97:{l:{108:{l:{108:{l:{101:{l:{108:{l:{59:{c:[8742]}}}}}}}}}}},115:{l:{108:{l:{59:{c:[11005,8421]}}}}},116:{l:{59:{c:[8706,824]}}}}}}},111:{l:{108:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10772]}}}}}}}}}}},114:{l:{59:{c:[8832]},99:{l:{117:{l:{101:{l:{59:{c:[8928]}}}}}}},101:{l:{59:{c:[10927,824]},99:{l:{59:{c:[8832]},101:{l:{113:{l:{59:{c:[10927,824]}}}}}}}}}}}}},114:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8655]}}}}}}},97:{l:{114:{l:{114:{l:{59:{c:[8603]},99:{l:{59:{c:[10547,824]}}},119:{l:{59:{c:[8605,824]}}}}}}}}},105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8603]}}}}}}}}}}}}}}}}}}},116:{l:{114:{l:{105:{l:{59:{c:[8939]},101:{l:{59:{c:[8941]}}}}}}}}}}},115:{l:{99:{l:{59:{c:[8833]},99:{l:{117:{l:{101:{l:{59:{c:[8929]}}}}}}},101:{l:{59:{c:[10928,824]}}},114:{l:{59:{c:[120003]}}}}},104:{l:{111:{l:{114:{l:{116:{l:{109:{l:{105:{l:{100:{l:{59:{c:[8740]}}}}}}},112:{l:{97:{l:{114:{l:{97:{l:{108:{l:{108:{l:{101:{l:{108:{l:{59:{c:[8742]}}}}}}}}}}}}}}}}}}}}}}}}},105:{l:{109:{l:{59:{c:[8769]},101:{l:{59:{c:[8772]},113:{l:{59:{c:[8772]}}}}}}}}},109:{l:{105:{l:{100:{l:{59:{c:[8740]}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[8742]}}}}}}},113:{l:{115:{l:{117:{l:{98:{l:{101:{l:{59:{c:[8930]}}}}},112:{l:{101:{l:{59:{c:[8931]}}}}}}}}}}},117:{l:{98:{l:{59:{c:[8836]},69:{l:{59:{c:[10949,824]}}},101:{l:{59:{c:[8840]}}},115:{l:{101:{l:{116:{l:{59:{c:[8834,8402]},101:{l:{113:{l:{59:{c:[8840]},113:{l:{59:{c:[10949,824]}}}}}}}}}}}}}}},99:{l:{99:{l:{59:{c:[8833]},101:{l:{113:{l:{59:{c:[10928,824]}}}}}}}}},112:{l:{59:{c:[8837]},69:{l:{59:{c:[10950,824]}}},101:{l:{59:{c:[8841]}}},115:{l:{101:{l:{116:{l:{59:{c:[8835,8402]},101:{l:{113:{l:{59:{c:[8841]},113:{l:{59:{c:[10950,824]}}}}}}}}}}}}}}}}}}},116:{l:{103:{l:{108:{l:{59:{c:[8825]}}}}},105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[241]}},c:[241]}}}}}}},108:{l:{103:{l:{59:{c:[8824]}}}}},114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8938]},101:{l:{113:{l:{59:{c:[8940]}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8939]},101:{l:{113:{l:{59:{c:[8941]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},117:{l:{59:{c:[957]},109:{l:{59:{c:[35]},101:{l:{114:{l:{111:{l:{59:{c:[8470]}}}}}}},115:{l:{112:{l:{59:{c:[8199]}}}}}}}}},118:{l:{68:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8877]}}}}}}}}},72:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10500]}}}}}}}}},97:{l:{112:{l:{59:{c:[8781,8402]}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8876]}}}}}}}}},103:{l:{101:{l:{59:{c:[8805,8402]}}},116:{l:{59:{c:[62,8402]}}}}},105:{l:{110:{l:{102:{l:{105:{l:{110:{l:{59:{c:[10718]}}}}}}}}}}},108:{l:{65:{l:{114:{l:{114:{l:{59:{c:[10498]}}}}}}},101:{l:{59:{c:[8804,8402]}}},116:{l:{59:{c:[60,8402]},114:{l:{105:{l:{101:{l:{59:{c:[8884,8402]}}}}}}}}}}},114:{l:{65:{l:{114:{l:{114:{l:{59:{c:[10499]}}}}}}},116:{l:{114:{l:{105:{l:{101:{l:{59:{c:[8885,8402]}}}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8764,8402]}}}}}}}}},119:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8662]}}}}}}},97:{l:{114:{l:{104:{l:{107:{l:{59:{c:[10531]}}}}},114:{l:{59:{c:[8598]},111:{l:{119:{l:{59:{c:[8598]}}}}}}}}}}},110:{l:{101:{l:{97:{l:{114:{l:{59:{c:[10535]}}}}}}}}}}}}},111:{l:{83:{l:{59:{c:[9416]}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[243]}},c:[243]}}}}}}},115:{l:{116:{l:{59:{c:[8859]}}}}}}},99:{l:{105:{l:{114:{l:{59:{c:[8858]},99:{l:{59:{c:[244]}},c:[244]}}}}},121:{l:{59:{c:[1086]}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8861]}}}}}}},98:{l:{108:{l:{97:{l:{99:{l:{59:{c:[337]}}}}}}}}},105:{l:{118:{l:{59:{c:[10808]}}}}},111:{l:{116:{l:{59:{c:[8857]}}}}},115:{l:{111:{l:{108:{l:{100:{l:{59:{c:[10684]}}}}}}}}}}},101:{l:{108:{l:{105:{l:{103:{l:{59:{c:[339]}}}}}}}}},102:{l:{99:{l:{105:{l:{114:{l:{59:{c:[10687]}}}}}}},114:{l:{59:{c:[120108]}}}}},103:{l:{111:{l:{110:{l:{59:{c:[731]}}}}},114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[242]}},c:[242]}}}}}}},116:{l:{59:{c:[10689]}}}}},104:{l:{98:{l:{97:{l:{114:{l:{59:{c:[10677]}}}}}}},109:{l:{59:{c:[937]}}}}},105:{l:{110:{l:{116:{l:{59:{c:[8750]}}}}}}},108:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8634]}}}}}}},99:{l:{105:{l:{114:{l:{59:{c:[10686]}}}}},114:{l:{111:{l:{115:{l:{115:{l:{59:{c:[10683]}}}}}}}}}}},105:{l:{110:{l:{101:{l:{59:{c:[8254]}}}}}}},116:{l:{59:{c:[10688]}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[333]}}}}}}},101:{l:{103:{l:{97:{l:{59:{c:[969]}}}}}}},105:{l:{99:{l:{114:{l:{111:{l:{110:{l:{59:{c:[959]}}}}}}}}},100:{l:{59:{c:[10678]}}},110:{l:{117:{l:{115:{l:{59:{c:[8854]}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120160]}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[10679]}}}}},101:{l:{114:{l:{112:{l:{59:{c:[10681]}}}}}}},108:{l:{117:{l:{115:{l:{59:{c:[8853]}}}}}}}}},114:{l:{59:{c:[8744]},97:{l:{114:{l:{114:{l:{59:{c:[8635]}}}}}}},100:{l:{59:{c:[10845]},101:{l:{114:{l:{59:{c:[8500]},111:{l:{102:{l:{59:{c:[8500]}}}}}}}}},102:{l:{59:{c:[170]}},c:[170]},109:{l:{59:{c:[186]}},c:[186]}}},105:{l:{103:{l:{111:{l:{102:{l:{59:{c:[8886]}}}}}}}}},111:{l:{114:{l:{59:{c:[10838]}}}}},115:{l:{108:{l:{111:{l:{112:{l:{101:{l:{59:{c:[10839]}}}}}}}}}}},118:{l:{59:{c:[10843]}}}}},115:{l:{99:{l:{114:{l:{59:{c:[8500]}}}}},108:{l:{97:{l:{115:{l:{104:{l:{59:{c:[248]}},c:[248]}}}}}}},111:{l:{108:{l:{59:{c:[8856]}}}}}}},116:{l:{105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[245]}},c:[245]}}}}},109:{l:{101:{l:{115:{l:{59:{c:[8855]},97:{l:{115:{l:{59:{c:[10806]}}}}}}}}}}}}}}},117:{l:{109:{l:{108:{l:{59:{c:[246]}},c:[246]}}}}},118:{l:{98:{l:{97:{l:{114:{l:{59:{c:[9021]}}}}}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[8741]},97:{l:{59:{c:[182]},108:{l:{108:{l:{101:{l:{108:{l:{59:{c:[8741]}}}}}}}}}},c:[182]},115:{l:{105:{l:{109:{l:{59:{c:[10995]}}}}},108:{l:{59:{c:[11005]}}}}},116:{l:{59:{c:[8706]}}}}}}},99:{l:{121:{l:{59:{c:[1087]}}}}},101:{l:{114:{l:{99:{l:{110:{l:{116:{l:{59:{c:[37]}}}}}}},105:{l:{111:{l:{100:{l:{59:{c:[46]}}}}}}},109:{l:{105:{l:{108:{l:{59:{c:[8240]}}}}}}},112:{l:{59:{c:[8869]}}},116:{l:{101:{l:{110:{l:{107:{l:{59:{c:[8241]}}}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120109]}}}}},104:{l:{105:{l:{59:{c:[966]},118:{l:{59:{c:[981]}}}}},109:{l:{109:{l:{97:{l:{116:{l:{59:{c:[8499]}}}}}}}}},111:{l:{110:{l:{101:{l:{59:{c:[9742]}}}}}}}}},105:{l:{59:{c:[960]},116:{l:{99:{l:{104:{l:{102:{l:{111:{l:{114:{l:{107:{l:{59:{c:[8916]}}}}}}}}}}}}}}},118:{l:{59:{c:[982]}}}}},108:{l:{97:{l:{110:{l:{99:{l:{107:{l:{59:{c:[8463]},104:{l:{59:{c:[8462]}}}}}}},107:{l:{118:{l:{59:{c:[8463]}}}}}}}}},117:{l:{115:{l:{59:{c:[43]},97:{l:{99:{l:{105:{l:{114:{l:{59:{c:[10787]}}}}}}}}},98:{l:{59:{c:[8862]}}},99:{l:{105:{l:{114:{l:{59:{c:[10786]}}}}}}},100:{l:{111:{l:{59:{c:[8724]}}},117:{l:{59:{c:[10789]}}}}},101:{l:{59:{c:[10866]}}},109:{l:{110:{l:{59:{c:[177]}},c:[177]}}},115:{l:{105:{l:{109:{l:{59:{c:[10790]}}}}}}},116:{l:{119:{l:{111:{l:{59:{c:[10791]}}}}}}}}}}}}},109:{l:{59:{c:[177]}}},111:{l:{105:{l:{110:{l:{116:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10773]}}}}}}}}}}}}},112:{l:{102:{l:{59:{c:[120161]}}}}},117:{l:{110:{l:{100:{l:{59:{c:[163]}},c:[163]}}}}}}},114:{l:{59:{c:[8826]},69:{l:{59:{c:[10931]}}},97:{l:{112:{l:{59:{c:[10935]}}}}},99:{l:{117:{l:{101:{l:{59:{c:[8828]}}}}}}},101:{l:{59:{c:[10927]},99:{l:{59:{c:[8826]},97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10935]}}}}}}}}}}}}},99:{l:{117:{l:{114:{l:{108:{l:{121:{l:{101:{l:{113:{l:{59:{c:[8828]}}}}}}}}}}}}}}},101:{l:{113:{l:{59:{c:[10927]}}}}},110:{l:{97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10937]}}}}}}}}}}}}},101:{l:{113:{l:{113:{l:{59:{c:[10933]}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8936]}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8830]}}}}}}}}}}},105:{l:{109:{l:{101:{l:{59:{c:[8242]},115:{l:{59:{c:[8473]}}}}}}}}},110:{l:{69:{l:{59:{c:[10933]}}},97:{l:{112:{l:{59:{c:[10937]}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8936]}}}}}}}}},111:{l:{100:{l:{59:{c:[8719]}}},102:{l:{97:{l:{108:{l:{97:{l:{114:{l:{59:{c:[9006]}}}}}}}}},108:{l:{105:{l:{110:{l:{101:{l:{59:{c:[8978]}}}}}}}}},115:{l:{117:{l:{114:{l:{102:{l:{59:{c:[8979]}}}}}}}}}}},112:{l:{59:{c:[8733]},116:{l:{111:{l:{59:{c:[8733]}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8830]}}}}}}},117:{l:{114:{l:{101:{l:{108:{l:{59:{c:[8880]}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120005]}}}}},105:{l:{59:{c:[968]}}}}},117:{l:{110:{l:{99:{l:{115:{l:{112:{l:{59:{c:[8200]}}}}}}}}}}}}},113:{l:{102:{l:{114:{l:{59:{c:[120110]}}}}},105:{l:{110:{l:{116:{l:{59:{c:[10764]}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120162]}}}}}}},112:{l:{114:{l:{105:{l:{109:{l:{101:{l:{59:{c:[8279]}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120006]}}}}}}},117:{l:{97:{l:{116:{l:{101:{l:{114:{l:{110:{l:{105:{l:{111:{l:{110:{l:{115:{l:{59:{c:[8461]}}}}}}}}}}}}}}},105:{l:{110:{l:{116:{l:{59:{c:[10774]}}}}}}}}}}},101:{l:{115:{l:{116:{l:{59:{c:[63]},101:{l:{113:{l:{59:{c:[8799]}}}}}}}}}}},111:{l:{116:{l:{59:{c:[34]}},c:[34]}}}}}}},114:{l:{65:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8667]}}}}}}},114:{l:{114:{l:{59:{c:[8658]}}}}},116:{l:{97:{l:{105:{l:{108:{l:{59:{c:[10524]}}}}}}}}}}},66:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10511]}}}}}}}}},72:{l:{97:{l:{114:{l:{59:{c:[10596]}}}}}}},97:{l:{99:{l:{101:{l:{59:{c:[8765,817]}}},117:{l:{116:{l:{101:{l:{59:{c:[341]}}}}}}}}},100:{l:{105:{l:{99:{l:{59:{c:[8730]}}}}}}},101:{l:{109:{l:{112:{l:{116:{l:{121:{l:{118:{l:{59:{c:[10675]}}}}}}}}}}}}},110:{l:{103:{l:{59:{c:[10217]},100:{l:{59:{c:[10642]}}},101:{l:{59:{c:[10661]}}},108:{l:{101:{l:{59:{c:[10217]}}}}}}}}},113:{l:{117:{l:{111:{l:{59:{c:[187]}},c:[187]}}}}},114:{l:{114:{l:{59:{c:[8594]},97:{l:{112:{l:{59:{c:[10613]}}}}},98:{l:{59:{c:[8677]},102:{l:{115:{l:{59:{c:[10528]}}}}}}},99:{l:{59:{c:[10547]}}},102:{l:{115:{l:{59:{c:[10526]}}}}},104:{l:{107:{l:{59:{c:[8618]}}}}},108:{l:{112:{l:{59:{c:[8620]}}}}},112:{l:{108:{l:{59:{c:[10565]}}}}},115:{l:{105:{l:{109:{l:{59:{c:[10612]}}}}}}},116:{l:{108:{l:{59:{c:[8611]}}}}},119:{l:{59:{c:[8605]}}}}}}},116:{l:{97:{l:{105:{l:{108:{l:{59:{c:[10522]}}}}}}},105:{l:{111:{l:{59:{c:[8758]},110:{l:{97:{l:{108:{l:{115:{l:{59:{c:[8474]}}}}}}}}}}}}}}}}},98:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10509]}}}}}}},98:{l:{114:{l:{107:{l:{59:{c:[10099]}}}}}}},114:{l:{97:{l:{99:{l:{101:{l:{59:{c:[125]}}},107:{l:{59:{c:[93]}}}}}}},107:{l:{101:{l:{59:{c:[10636]}}},115:{l:{108:{l:{100:{l:{59:{c:[10638]}}},117:{l:{59:{c:[10640]}}}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[345]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[343]}}}}}}},105:{l:{108:{l:{59:{c:[8969]}}}}}}},117:{l:{98:{l:{59:{c:[125]}}}}},121:{l:{59:{c:[1088]}}}}},100:{l:{99:{l:{97:{l:{59:{c:[10551]}}}}},108:{l:{100:{l:{104:{l:{97:{l:{114:{l:{59:{c:[10601]}}}}}}}}}}},113:{l:{117:{l:{111:{l:{59:{c:[8221]},114:{l:{59:{c:[8221]}}}}}}}}},115:{l:{104:{l:{59:{c:[8627]}}}}}}},101:{l:{97:{l:{108:{l:{59:{c:[8476]},105:{l:{110:{l:{101:{l:{59:{c:[8475]}}}}}}},112:{l:{97:{l:{114:{l:{116:{l:{59:{c:[8476]}}}}}}}}},115:{l:{59:{c:[8477]}}}}}}},99:{l:{116:{l:{59:{c:[9645]}}}}},103:{l:{59:{c:[174]}},c:[174]}}},102:{l:{105:{l:{115:{l:{104:{l:{116:{l:{59:{c:[10621]}}}}}}}}},108:{l:{111:{l:{111:{l:{114:{l:{59:{c:[8971]}}}}}}}}},114:{l:{59:{c:[120111]}}}}},104:{l:{97:{l:{114:{l:{100:{l:{59:{c:[8641]}}},117:{l:{59:{c:[8640]},108:{l:{59:{c:[10604]}}}}}}}}},111:{l:{59:{c:[961]},118:{l:{59:{c:[1009]}}}}}}},105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8594]},116:{l:{97:{l:{105:{l:{108:{l:{59:{c:[8611]}}}}}}}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{111:{l:{111:{l:{110:{l:{100:{l:{111:{l:{119:{l:{110:{l:{59:{c:[8641]}}}}}}}}},117:{l:{112:{l:{59:{c:[8640]}}}}}}}}}}}}}}}}}}},108:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{115:{l:{59:{c:[8644]}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{111:{l:{111:{l:{110:{l:{115:{l:{59:{c:[8652]}}}}}}}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{115:{l:{59:{c:[8649]}}}}}}}}}}}}}}}}}}}}}}},115:{l:{113:{l:{117:{l:{105:{l:{103:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8605]}}}}}}}}}}}}}}}}}}}}},116:{l:{104:{l:{114:{l:{101:{l:{101:{l:{116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8908]}}}}}}}}}}}}}}}}}}}}}}}}}}},110:{l:{103:{l:{59:{c:[730]}}}}},115:{l:{105:{l:{110:{l:{103:{l:{100:{l:{111:{l:{116:{l:{115:{l:{101:{l:{113:{l:{59:{c:[8787]}}}}}}}}}}}}}}}}}}}}}}},108:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8644]}}}}}}},104:{l:{97:{l:{114:{l:{59:{c:[8652]}}}}}}},109:{l:{59:{c:[8207]}}}}},109:{l:{111:{l:{117:{l:{115:{l:{116:{l:{59:{c:[9137]},97:{l:{99:{l:{104:{l:{101:{l:{59:{c:[9137]}}}}}}}}}}}}}}}}}}},110:{l:{109:{l:{105:{l:{100:{l:{59:{c:[10990]}}}}}}}}},111:{l:{97:{l:{110:{l:{103:{l:{59:{c:[10221]}}}}},114:{l:{114:{l:{59:{c:[8702]}}}}}}},98:{l:{114:{l:{107:{l:{59:{c:[10215]}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[10630]}}}}},102:{l:{59:{c:[120163]}}},108:{l:{117:{l:{115:{l:{59:{c:[10798]}}}}}}}}},116:{l:{105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[10805]}}}}}}}}}}}}},112:{l:{97:{l:{114:{l:{59:{c:[41]},103:{l:{116:{l:{59:{c:[10644]}}}}}}}}},112:{l:{111:{l:{108:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10770]}}}}}}}}}}}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8649]}}}}}}}}},115:{l:{97:{l:{113:{l:{117:{l:{111:{l:{59:{c:[8250]}}}}}}}}},99:{l:{114:{l:{59:{c:[120007]}}}}},104:{l:{59:{c:[8625]}}},113:{l:{98:{l:{59:{c:[93]}}},117:{l:{111:{l:{59:{c:[8217]},114:{l:{59:{c:[8217]}}}}}}}}}}},116:{l:{104:{l:{114:{l:{101:{l:{101:{l:{59:{c:[8908]}}}}}}}}},105:{l:{109:{l:{101:{l:{115:{l:{59:{c:[8906]}}}}}}}}},114:{l:{105:{l:{59:{c:[9657]},101:{l:{59:{c:[8885]}}},102:{l:{59:{c:[9656]}}},108:{l:{116:{l:{114:{l:{105:{l:{59:{c:[10702]}}}}}}}}}}}}}}},117:{l:{108:{l:{117:{l:{104:{l:{97:{l:{114:{l:{59:{c:[10600]}}}}}}}}}}}}},120:{l:{59:{c:[8478]}}}}},115:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[347]}}}}}}}}}}},98:{l:{113:{l:{117:{l:{111:{l:{59:{c:[8218]}}}}}}}}},99:{l:{59:{c:[8827]},69:{l:{59:{c:[10932]}}},97:{l:{112:{l:{59:{c:[10936]}}},114:{l:{111:{l:{110:{l:{59:{c:[353]}}}}}}}}},99:{l:{117:{l:{101:{l:{59:{c:[8829]}}}}}}},101:{l:{59:{c:[10928]},100:{l:{105:{l:{108:{l:{59:{c:[351]}}}}}}}}},105:{l:{114:{l:{99:{l:{59:{c:[349]}}}}}}},110:{l:{69:{l:{59:{c:[10934]}}},97:{l:{112:{l:{59:{c:[10938]}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8937]}}}}}}}}},112:{l:{111:{l:{108:{l:{105:{l:{110:{l:{116:{l:{59:{c:[10771]}}}}}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8831]}}}}}}},121:{l:{59:{c:[1089]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8901]},98:{l:{59:{c:[8865]}}},101:{l:{59:{c:[10854]}}}}}}}}},101:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8664]}}}}}}},97:{l:{114:{l:{104:{l:{107:{l:{59:{c:[10533]}}}}},114:{l:{59:{c:[8600]},111:{l:{119:{l:{59:{c:[8600]}}}}}}}}}}},99:{l:{116:{l:{59:{c:[167]}},c:[167]}}},109:{l:{105:{l:{59:{c:[59]}}}}},115:{l:{119:{l:{97:{l:{114:{l:{59:{c:[10537]}}}}}}}}},116:{l:{109:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[8726]}}}}}}}}},110:{l:{59:{c:[8726]}}}}}}},120:{l:{116:{l:{59:{c:[10038]}}}}}}},102:{l:{114:{l:{59:{c:[120112]},111:{l:{119:{l:{110:{l:{59:{c:[8994]}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{59:{c:[9839]}}}}}}},99:{l:{104:{l:{99:{l:{121:{l:{59:{c:[1097]}}}}}}},121:{l:{59:{c:[1096]}}}}},111:{l:{114:{l:{116:{l:{109:{l:{105:{l:{100:{l:{59:{c:[8739]}}}}}}},112:{l:{97:{l:{114:{l:{97:{l:{108:{l:{108:{l:{101:{l:{108:{l:{59:{c:[8741]}}}}}}}}}}}}}}}}}}}}}}},121:{l:{59:{c:[173]}},c:[173]}}},105:{l:{103:{l:{109:{l:{97:{l:{59:{c:[963]},102:{l:{59:{c:[962]}}},118:{l:{59:{c:[962]}}}}}}}}},109:{l:{59:{c:[8764]},100:{l:{111:{l:{116:{l:{59:{c:[10858]}}}}}}},101:{l:{59:{c:[8771]},113:{l:{59:{c:[8771]}}}}},103:{l:{59:{c:[10910]},69:{l:{59:{c:[10912]}}}}},108:{l:{59:{c:[10909]},69:{l:{59:{c:[10911]}}}}},110:{l:{101:{l:{59:{c:[8774]}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10788]}}}}}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10610]}}}}}}}}}}}}},108:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8592]}}}}}}}}},109:{l:{97:{l:{108:{l:{108:{l:{115:{l:{101:{l:{116:{l:{109:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[8726]}}}}}}}}}}}}}}}}}}}}},115:{l:{104:{l:{112:{l:{59:{c:[10803]}}}}}}}}},101:{l:{112:{l:{97:{l:{114:{l:{115:{l:{108:{l:{59:{c:[10724]}}}}}}}}}}}}},105:{l:{100:{l:{59:{c:[8739]}}},108:{l:{101:{l:{59:{c:[8995]}}}}}}},116:{l:{59:{c:[10922]},101:{l:{59:{c:[10924]},115:{l:{59:{c:[10924,65024]}}}}}}}}},111:{l:{102:{l:{116:{l:{99:{l:{121:{l:{59:{c:[1100]}}}}}}}}},108:{l:{59:{c:[47]},98:{l:{59:{c:[10692]},97:{l:{114:{l:{59:{c:[9023]}}}}}}}}},112:{l:{102:{l:{59:{c:[120164]}}}}}}},112:{l:{97:{l:{100:{l:{101:{l:{115:{l:{59:{c:[9824]},117:{l:{105:{l:{116:{l:{59:{c:[9824]}}}}}}}}}}}}},114:{l:{59:{c:[8741]}}}}}}},113:{l:{99:{l:{97:{l:{112:{l:{59:{c:[8851]},115:{l:{59:{c:[8851,65024]}}}}}}},117:{l:{112:{l:{59:{c:[8852]},115:{l:{59:{c:[8852,65024]}}}}}}}}},115:{l:{117:{l:{98:{l:{59:{c:[8847]},101:{l:{59:{c:[8849]}}},115:{l:{101:{l:{116:{l:{59:{c:[8847]},101:{l:{113:{l:{59:{c:[8849]}}}}}}}}}}}}},112:{l:{59:{c:[8848]},101:{l:{59:{c:[8850]}}},115:{l:{101:{l:{116:{l:{59:{c:[8848]},101:{l:{113:{l:{59:{c:[8850]}}}}}}}}}}}}}}}}},117:{l:{59:{c:[9633]},97:{l:{114:{l:{101:{l:{59:{c:[9633]}}},102:{l:{59:{c:[9642]}}}}}}},102:{l:{59:{c:[9642]}}}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8594]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120008]}}}}},101:{l:{116:{l:{109:{l:{110:{l:{59:{c:[8726]}}}}}}}}},109:{l:{105:{l:{108:{l:{101:{l:{59:{c:[8995]}}}}}}}}},116:{l:{97:{l:{114:{l:{102:{l:{59:{c:[8902]}}}}}}}}}}},116:{l:{97:{l:{114:{l:{59:{c:[9734]},102:{l:{59:{c:[9733]}}}}}}},114:{l:{97:{l:{105:{l:{103:{l:{104:{l:{116:{l:{101:{l:{112:{l:{115:{l:{105:{l:{108:{l:{111:{l:{110:{l:{59:{c:[1013]}}}}}}}}}}}}}}},112:{l:{104:{l:{105:{l:{59:{c:[981]}}}}}}}}}}}}}}}}},110:{l:{115:{l:{59:{c:[175]}}}}}}}}},117:{l:{98:{l:{59:{c:[8834]},69:{l:{59:{c:[10949]}}},100:{l:{111:{l:{116:{l:{59:{c:[10941]}}}}}}},101:{l:{59:{c:[8838]},100:{l:{111:{l:{116:{l:{59:{c:[10947]}}}}}}}}},109:{l:{117:{l:{108:{l:{116:{l:{59:{c:[10945]}}}}}}}}},110:{l:{69:{l:{59:{c:[10955]}}},101:{l:{59:{c:[8842]}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10943]}}}}}}}}},114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10617]}}}}}}}}},115:{l:{101:{l:{116:{l:{59:{c:[8834]},101:{l:{113:{l:{59:{c:[8838]},113:{l:{59:{c:[10949]}}}}}}},110:{l:{101:{l:{113:{l:{59:{c:[8842]},113:{l:{59:{c:[10955]}}}}}}}}}}}}},105:{l:{109:{l:{59:{c:[10951]}}}}},117:{l:{98:{l:{59:{c:[10965]}}},112:{l:{59:{c:[10963]}}}}}}}}},99:{l:{99:{l:{59:{c:[8827]},97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10936]}}}}}}}}}}}}},99:{l:{117:{l:{114:{l:{108:{l:{121:{l:{101:{l:{113:{l:{59:{c:[8829]}}}}}}}}}}}}}}},101:{l:{113:{l:{59:{c:[10928]}}}}},110:{l:{97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[10938]}}}}}}}}}}}}},101:{l:{113:{l:{113:{l:{59:{c:[10934]}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8937]}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8831]}}}}}}}}}}},109:{l:{59:{c:[8721]}}},110:{l:{103:{l:{59:{c:[9834]}}}}},112:{l:{49:{l:{59:{c:[185]}},c:[185]},50:{l:{59:{c:[178]}},c:[178]},51:{l:{59:{c:[179]}},c:[179]},59:{c:[8835]},69:{l:{59:{c:[10950]}}},100:{l:{111:{l:{116:{l:{59:{c:[10942]}}}}},115:{l:{117:{l:{98:{l:{59:{c:[10968]}}}}}}}}},101:{l:{59:{c:[8839]},100:{l:{111:{l:{116:{l:{59:{c:[10948]}}}}}}}}},104:{l:{115:{l:{111:{l:{108:{l:{59:{c:[10185]}}}}},117:{l:{98:{l:{59:{c:[10967]}}}}}}}}},108:{l:{97:{l:{114:{l:{114:{l:{59:{c:[10619]}}}}}}}}},109:{l:{117:{l:{108:{l:{116:{l:{59:{c:[10946]}}}}}}}}},110:{l:{69:{l:{59:{c:[10956]}}},101:{l:{59:{c:[8843]}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10944]}}}}}}}}},115:{l:{101:{l:{116:{l:{59:{c:[8835]},101:{l:{113:{l:{59:{c:[8839]},113:{l:{59:{c:[10950]}}}}}}},110:{l:{101:{l:{113:{l:{59:{c:[8843]},113:{l:{59:{c:[10956]}}}}}}}}}}}}},105:{l:{109:{l:{59:{c:[10952]}}}}},117:{l:{98:{l:{59:{c:[10964]}}},112:{l:{59:{c:[10966]}}}}}}}}}}},119:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8665]}}}}}}},97:{l:{114:{l:{104:{l:{107:{l:{59:{c:[10534]}}}}},114:{l:{59:{c:[8601]},111:{l:{119:{l:{59:{c:[8601]}}}}}}}}}}},110:{l:{119:{l:{97:{l:{114:{l:{59:{c:[10538]}}}}}}}}}}},122:{l:{108:{l:{105:{l:{103:{l:{59:{c:[223]}},c:[223]}}}}}}}}},116:{l:{97:{l:{114:{l:{103:{l:{101:{l:{116:{l:{59:{c:[8982]}}}}}}}}},117:{l:{59:{c:[964]}}}}},98:{l:{114:{l:{107:{l:{59:{c:[9140]}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[357]}}}}}}}}},101:{l:{100:{l:{105:{l:{108:{l:{59:{c:[355]}}}}}}}}},121:{l:{59:{c:[1090]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[8411]}}}}}}},101:{l:{108:{l:{114:{l:{101:{l:{99:{l:{59:{c:[8981]}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120113]}}}}},104:{l:{101:{l:{114:{l:{101:{l:{52:{l:{59:{c:[8756]}}},102:{l:{111:{l:{114:{l:{101:{l:{59:{c:[8756]}}}}}}}}}}}}},116:{l:{97:{l:{59:{c:[952]},115:{l:{121:{l:{109:{l:{59:{c:[977]}}}}}}},118:{l:{59:{c:[977]}}}}}}}}},105:{l:{99:{l:{107:{l:{97:{l:{112:{l:{112:{l:{114:{l:{111:{l:{120:{l:{59:{c:[8776]}}}}}}}}}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8764]}}}}}}}}}}},110:{l:{115:{l:{112:{l:{59:{c:[8201]}}}}}}}}},107:{l:{97:{l:{112:{l:{59:{c:[8776]}}}}},115:{l:{105:{l:{109:{l:{59:{c:[8764]}}}}}}}}},111:{l:{114:{l:{110:{l:{59:{c:[254]}},c:[254]}}}}}}},105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[732]}}}}}}},109:{l:{101:{l:{115:{l:{59:{c:[215]},98:{l:{59:{c:[8864]},97:{l:{114:{l:{59:{c:[10801]}}}}}}},100:{l:{59:{c:[10800]}}}},c:[215]}}}}},110:{l:{116:{l:{59:{c:[8749]}}}}}}},111:{l:{101:{l:{97:{l:{59:{c:[10536]}}}}},112:{l:{59:{c:[8868]},98:{l:{111:{l:{116:{l:{59:{c:[9014]}}}}}}},99:{l:{105:{l:{114:{l:{59:{c:[10993]}}}}}}},102:{l:{59:{c:[120165]},111:{l:{114:{l:{107:{l:{59:{c:[10970]}}}}}}}}}}},115:{l:{97:{l:{59:{c:[10537]}}}}}}},112:{l:{114:{l:{105:{l:{109:{l:{101:{l:{59:{c:[8244]}}}}}}}}}}},114:{l:{97:{l:{100:{l:{101:{l:{59:{c:[8482]}}}}}}},105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[9653]},100:{l:{111:{l:{119:{l:{110:{l:{59:{c:[9663]}}}}}}}}},108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[9667]},101:{l:{113:{l:{59:{c:[8884]}}}}}}}}}}}}},113:{l:{59:{c:[8796]}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[9657]},101:{l:{113:{l:{59:{c:[8885]}}}}}}}}}}}}}}}}}}}}}}}}},100:{l:{111:{l:{116:{l:{59:{c:[9708]}}}}}}},101:{l:{59:{c:[8796]}}},109:{l:{105:{l:{110:{l:{117:{l:{115:{l:{59:{c:[10810]}}}}}}}}}}},112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10809]}}}}}}}}},115:{l:{98:{l:{59:{c:[10701]}}}}},116:{l:{105:{l:{109:{l:{101:{l:{59:{c:[10811]}}}}}}}}}}},112:{l:{101:{l:{122:{l:{105:{l:{117:{l:{109:{l:{59:{c:[9186]}}}}}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120009]}}},121:{l:{59:{c:[1094]}}}}},104:{l:{99:{l:{121:{l:{59:{c:[1115]}}}}}}},116:{l:{114:{l:{111:{l:{107:{l:{59:{c:[359]}}}}}}}}}}},119:{l:{105:{l:{120:{l:{116:{l:{59:{c:[8812]}}}}}}},111:{l:{104:{l:{101:{l:{97:{l:{100:{l:{108:{l:{101:{l:{102:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8606]}}}}}}}}}}}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8608]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},117:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8657]}}}}}}},72:{l:{97:{l:{114:{l:{59:{c:[10595]}}}}}}},97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[250]}},c:[250]}}}}}}},114:{l:{114:{l:{59:{c:[8593]}}}}}}},98:{l:{114:{l:{99:{l:{121:{l:{59:{c:[1118]}}}}},101:{l:{118:{l:{101:{l:{59:{c:[365]}}}}}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[251]}},c:[251]}}}}},121:{l:{59:{c:[1091]}}}}},100:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8645]}}}}}}},98:{l:{108:{l:{97:{l:{99:{l:{59:{c:[369]}}}}}}}}},104:{l:{97:{l:{114:{l:{59:{c:[10606]}}}}}}}}},102:{l:{105:{l:{115:{l:{104:{l:{116:{l:{59:{c:[10622]}}}}}}}}},114:{l:{59:{c:[120114]}}}}},103:{l:{114:{l:{97:{l:{118:{l:{101:{l:{59:{c:[249]}},c:[249]}}}}}}}}},104:{l:{97:{l:{114:{l:{108:{l:{59:{c:[8639]}}},114:{l:{59:{c:[8638]}}}}}}},98:{l:{108:{l:{107:{l:{59:{c:[9600]}}}}}}}}},108:{l:{99:{l:{111:{l:{114:{l:{110:{l:{59:{c:[8988]},101:{l:{114:{l:{59:{c:[8988]}}}}}}}}}}},114:{l:{111:{l:{112:{l:{59:{c:[8975]}}}}}}}}},116:{l:{114:{l:{105:{l:{59:{c:[9720]}}}}}}}}},109:{l:{97:{l:{99:{l:{114:{l:{59:{c:[363]}}}}}}},108:{l:{59:{c:[168]}},c:[168]}}},111:{l:{103:{l:{111:{l:{110:{l:{59:{c:[371]}}}}}}},112:{l:{102:{l:{59:{c:[120166]}}}}}}},112:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8593]}}}}}}}}}}},100:{l:{111:{l:{119:{l:{110:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{59:{c:[8597]}}}}}}}}}}}}}}}}}}},104:{l:{97:{l:{114:{l:{112:{l:{111:{l:{111:{l:{110:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8639]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8638]}}}}}}}}}}}}}}}}}}}}}}}}},108:{l:{117:{l:{115:{l:{59:{c:[8846]}}}}}}},115:{l:{105:{l:{59:{c:[965]},104:{l:{59:{c:[978]}}},108:{l:{111:{l:{110:{l:{59:{c:[965]}}}}}}}}}}},117:{l:{112:{l:{97:{l:{114:{l:{114:{l:{111:{l:{119:{l:{115:{l:{59:{c:[8648]}}}}}}}}}}}}}}}}}}},114:{l:{99:{l:{111:{l:{114:{l:{110:{l:{59:{c:[8989]},101:{l:{114:{l:{59:{c:[8989]}}}}}}}}}}},114:{l:{111:{l:{112:{l:{59:{c:[8974]}}}}}}}}},105:{l:{110:{l:{103:{l:{59:{c:[367]}}}}}}},116:{l:{114:{l:{105:{l:{59:{c:[9721]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120010]}}}}}}},116:{l:{100:{l:{111:{l:{116:{l:{59:{c:[8944]}}}}}}},105:{l:{108:{l:{100:{l:{101:{l:{59:{c:[361]}}}}}}}}},114:{l:{105:{l:{59:{c:[9653]},102:{l:{59:{c:[9652]}}}}}}}}},117:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8648]}}}}}}},109:{l:{108:{l:{59:{c:[252]}},c:[252]}}}}},119:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{59:{c:[10663]}}}}}}}}}}}}}}},118:{l:{65:{l:{114:{l:{114:{l:{59:{c:[8661]}}}}}}},66:{l:{97:{l:{114:{l:{59:{c:[10984]},118:{l:{59:{c:[10985]}}}}}}}}},68:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8872]}}}}}}}}},97:{l:{110:{l:{103:{l:{114:{l:{116:{l:{59:{c:[10652]}}}}}}}}},114:{l:{101:{l:{112:{l:{115:{l:{105:{l:{108:{l:{111:{l:{110:{l:{59:{c:[1013]}}}}}}}}}}}}}}},107:{l:{97:{l:{112:{l:{112:{l:{97:{l:{59:{c:[1008]}}}}}}}}}}},110:{l:{111:{l:{116:{l:{104:{l:{105:{l:{110:{l:{103:{l:{59:{c:[8709]}}}}}}}}}}}}}}},112:{l:{104:{l:{105:{l:{59:{c:[981]}}}}},105:{l:{59:{c:[982]}}},114:{l:{111:{l:{112:{l:{116:{l:{111:{l:{59:{c:[8733]}}}}}}}}}}}}},114:{l:{59:{c:[8597]},104:{l:{111:{l:{59:{c:[1009]}}}}}}},115:{l:{105:{l:{103:{l:{109:{l:{97:{l:{59:{c:[962]}}}}}}}}},117:{l:{98:{l:{115:{l:{101:{l:{116:{l:{110:{l:{101:{l:{113:{l:{59:{c:[8842,65024]},113:{l:{59:{c:[10955,65024]}}}}}}}}}}}}}}}}},112:{l:{115:{l:{101:{l:{116:{l:{110:{l:{101:{l:{113:{l:{59:{c:[8843,65024]},113:{l:{59:{c:[10956,65024]}}}}}}}}}}}}}}}}}}}}},116:{l:{104:{l:{101:{l:{116:{l:{97:{l:{59:{c:[977]}}}}}}}}},114:{l:{105:{l:{97:{l:{110:{l:{103:{l:{108:{l:{101:{l:{108:{l:{101:{l:{102:{l:{116:{l:{59:{c:[8882]}}}}}}}}},114:{l:{105:{l:{103:{l:{104:{l:{116:{l:{59:{c:[8883]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},99:{l:{121:{l:{59:{c:[1074]}}}}},100:{l:{97:{l:{115:{l:{104:{l:{59:{c:[8866]}}}}}}}}},101:{l:{101:{l:{59:{c:[8744]},98:{l:{97:{l:{114:{l:{59:{c:[8891]}}}}}}},101:{l:{113:{l:{59:{c:[8794]}}}}}}},108:{l:{108:{l:{105:{l:{112:{l:{59:{c:[8942]}}}}}}}}},114:{l:{98:{l:{97:{l:{114:{l:{59:{c:[124]}}}}}}},116:{l:{59:{c:[124]}}}}}}},102:{l:{114:{l:{59:{c:[120115]}}}}},108:{l:{116:{l:{114:{l:{105:{l:{59:{c:[8882]}}}}}}}}},110:{l:{115:{l:{117:{l:{98:{l:{59:{c:[8834,8402]}}},112:{l:{59:{c:[8835,8402]}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120167]}}}}}}},112:{l:{114:{l:{111:{l:{112:{l:{59:{c:[8733]}}}}}}}}},114:{l:{116:{l:{114:{l:{105:{l:{59:{c:[8883]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120011]}}}}},117:{l:{98:{l:{110:{l:{69:{l:{59:{c:[10955,65024]}}},101:{l:{59:{c:[8842,65024]}}}}}}},112:{l:{110:{l:{69:{l:{59:{c:[10956,65024]}}},101:{l:{59:{c:[8843,65024]}}}}}}}}}}},122:{l:{105:{l:{103:{l:{122:{l:{97:{l:{103:{l:{59:{c:[10650]}}}}}}}}}}}}}}},119:{l:{99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[373]}}}}}}}}},101:{l:{100:{l:{98:{l:{97:{l:{114:{l:{59:{c:[10847]}}}}}}},103:{l:{101:{l:{59:{c:[8743]},113:{l:{59:{c:[8793]}}}}}}}}},105:{l:{101:{l:{114:{l:{112:{l:{59:{c:[8472]}}}}}}}}}}},102:{l:{114:{l:{59:{c:[120116]}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120168]}}}}}}},112:{l:{59:{c:[8472]}}},114:{l:{59:{c:[8768]},101:{l:{97:{l:{116:{l:{104:{l:{59:{c:[8768]}}}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120012]}}}}}}}}},120:{l:{99:{l:{97:{l:{112:{l:{59:{c:[8898]}}}}},105:{l:{114:{l:{99:{l:{59:{c:[9711]}}}}}}},117:{l:{112:{l:{59:{c:[8899]}}}}}}},100:{l:{116:{l:{114:{l:{105:{l:{59:{c:[9661]}}}}}}}}},102:{l:{114:{l:{59:{c:[120117]}}}}},104:{l:{65:{l:{114:{l:{114:{l:{59:{c:[10234]}}}}}}},97:{l:{114:{l:{114:{l:{59:{c:[10231]}}}}}}}}},105:{l:{59:{c:[958]}}},108:{l:{65:{l:{114:{l:{114:{l:{59:{c:[10232]}}}}}}},97:{l:{114:{l:{114:{l:{59:{c:[10229]}}}}}}}}},109:{l:{97:{l:{112:{l:{59:{c:[10236]}}}}}}},110:{l:{105:{l:{115:{l:{59:{c:[8955]}}}}}}},111:{l:{100:{l:{111:{l:{116:{l:{59:{c:[10752]}}}}}}},112:{l:{102:{l:{59:{c:[120169]}}},108:{l:{117:{l:{115:{l:{59:{c:[10753]}}}}}}}}},116:{l:{105:{l:{109:{l:{101:{l:{59:{c:[10754]}}}}}}}}}}},114:{l:{65:{l:{114:{l:{114:{l:{59:{c:[10233]}}}}}}},97:{l:{114:{l:{114:{l:{59:{c:[10230]}}}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120013]}}}}},113:{l:{99:{l:{117:{l:{112:{l:{59:{c:[10758]}}}}}}}}}}},117:{l:{112:{l:{108:{l:{117:{l:{115:{l:{59:{c:[10756]}}}}}}}}},116:{l:{114:{l:{105:{l:{59:{c:[9651]}}}}}}}}},118:{l:{101:{l:{101:{l:{59:{c:[8897]}}}}}}},119:{l:{101:{l:{100:{l:{103:{l:{101:{l:{59:{c:[8896]}}}}}}}}}}}}},121:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[253]}},c:[253]}}}}},121:{l:{59:{c:[1103]}}}}}}},99:{l:{105:{l:{114:{l:{99:{l:{59:{c:[375]}}}}}}},121:{l:{59:{c:[1099]}}}}},101:{l:{110:{l:{59:{c:[165]}},c:[165]}}},102:{l:{114:{l:{59:{c:[120118]}}}}},105:{l:{99:{l:{121:{l:{59:{c:[1111]}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120170]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120014]}}}}}}},117:{l:{99:{l:{121:{l:{59:{c:[1102]}}}}},109:{l:{108:{l:{59:{c:[255]}},c:[255]}}}}}}},122:{l:{97:{l:{99:{l:{117:{l:{116:{l:{101:{l:{59:{c:[378]}}}}}}}}}}},99:{l:{97:{l:{114:{l:{111:{l:{110:{l:{59:{c:[382]}}}}}}}}},121:{l:{59:{c:[1079]}}}}},100:{l:{111:{l:{116:{l:{59:{c:[380]}}}}}}},101:{l:{101:{l:{116:{l:{114:{l:{102:{l:{59:{c:[8488]}}}}}}}}},116:{l:{97:{l:{59:{c:[950]}}}}}}},102:{l:{114:{l:{59:{c:[120119]}}}}},104:{l:{99:{l:{121:{l:{59:{c:[1078]}}}}}}},105:{l:{103:{l:{114:{l:{97:{l:{114:{l:{114:{l:{59:{c:[8669]}}}}}}}}}}}}},111:{l:{112:{l:{102:{l:{59:{c:[120171]}}}}}}},115:{l:{99:{l:{114:{l:{59:{c:[120015]}}}}}}},119:{l:{106:{l:{59:{c:[8205]}}},110:{l:{106:{l:{59:{c:[8204]}}}}}}}}}}},539:function(e,t,r){"use strict";var n=3;var a=e.exports=function(e){this.length=0;this.entries=[];this.treeAdapter=e;this.bookmark=null};a.MARKER_ENTRY="MARKER_ENTRY";a.ELEMENT_ENTRY="ELEMENT_ENTRY";a.prototype._getNoahArkConditionCandidates=function(e){var t=[];if(this.length>=n){var r=this.treeAdapter.getAttrList(e).length,i=this.treeAdapter.getTagName(e),o=this.treeAdapter.getNamespaceURI(e);for(var s=this.length-1;s>=0;s--){var l=this.entries[s];if(l.type===a.MARKER_ENTRY)break;var u=l.element,c=this.treeAdapter.getAttrList(u),f=this.treeAdapter.getTagName(u)===i&&this.treeAdapter.getNamespaceURI(u)===o&&c.length===r;if(f)t.push({idx:s,attrs:c})}}return t.length<n?[]:t};a.prototype._ensureNoahArkCondition=function(e){var t=this._getNoahArkConditionCandidates(e),r=t.length;if(r){var a=this.treeAdapter.getAttrList(e),i=a.length,o={};for(var s=0;s<i;s++){var l=a[s];o[l.name]=l.value}for(s=0;s<i;s++){for(var u=0;u<r;u++){var c=t[u].attrs[s];if(o[c.name]!==c.value){t.splice(u,1);r--}if(t.length<n)return}}for(s=r-1;s>=n-1;s--){this.entries.splice(t[s].idx,1);this.length--}}};a.prototype.insertMarker=function(){this.entries.push({type:a.MARKER_ENTRY});this.length++};a.prototype.pushElement=function(e,t){this._ensureNoahArkCondition(e);this.entries.push({type:a.ELEMENT_ENTRY,element:e,token:t});this.length++};a.prototype.insertElementAfterBookmark=function(e,t){var r=this.length-1;for(;r>=0;r--){if(this.entries[r]===this.bookmark)break}this.entries.splice(r+1,0,{type:a.ELEMENT_ENTRY,element:e,token:t});this.length++};a.prototype.removeEntry=function(e){for(var t=this.length-1;t>=0;t--){if(this.entries[t]===e){this.entries.splice(t,1);this.length--;break}}};a.prototype.clearToLastMarker=function(){while(this.length){var e=this.entries.pop();this.length--;if(e.type===a.MARKER_ENTRY)break}};a.prototype.getElementEntryInScopeWithTagName=function(e){for(var t=this.length-1;t>=0;t--){var r=this.entries[t];if(r.type===a.MARKER_ENTRY)return null;if(this.treeAdapter.getTagName(r.element)===e)return r}return null};a.prototype.getElementEntry=function(e){for(var t=this.length-1;t>=0;t--){var r=this.entries[t];if(r.type===a.ELEMENT_ENTRY&&r.element===e)return r}return null}},540:function(e,t,r){"use strict";var n=r(202),a=r(82),i=r(68);var o=i.TAG_NAMES;function s(e,t,r){var n=e.__location;if(!n)return;if(!n.startTag){n.startTag={line:n.line,col:n.col,startOffset:n.startOffset,endOffset:n.endOffset};if(n.attrs)n.startTag.attrs=n.attrs}if(t.location){var i=t.location,o=r.getTagName(e),s=t.type===a.END_TAG_TOKEN&&o===t.tagName;if(s){n.endTag={line:i.line,col:i.col,startOffset:i.startOffset,endOffset:i.endOffset}}if(s)n.endOffset=i.endOffset;else n.endOffset=i.startOffset}}t.assign=function(e){var t=Object.getPrototypeOf(e),r=e.treeAdapter,i=null,l=null,u=null;e._bootstrap=function(a,o){t._bootstrap.call(this,a,o);i=null;l=null;u=null;e.openElements.pop=function(){s(this.current,u,r);n.prototype.pop.call(this)};e.openElements.popAllUpToHtmlElement=function(){for(var e=this.stackTop;e>0;e--)s(this.items[e],u,r);n.prototype.popAllUpToHtmlElement.call(this)};e.openElements.remove=function(e){s(e,u,r);n.prototype.remove.call(this,e)}};e._processTokenInForeignContent=function(e){u=e;t._processTokenInForeignContent.call(this,e)};e._processToken=function(e){u=e;t._processToken.call(this,e);if(e.type===a.END_TAG_TOKEN&&(e.tagName===o.HTML||e.tagName===o.BODY&&this.openElements.hasInScope(o.BODY))){for(var n=this.openElements.stackTop;n>=0;n--){var i=this.openElements.items[n];if(this.treeAdapter.getTagName(i)===e.tagName){s(i,e,r);break}}}};e._setDocumentType=function(e){t._setDocumentType.call(this,e);var r=this.treeAdapter.getChildNodes(this.document),n=r.length;for(var a=0;a<n;a++){var i=r[a];if(this.treeAdapter.isDocumentTypeNode(i)){i.__location=e.location;break}}};e._attachElementToTree=function(e){e.__location=i||null;i=null;t._attachElementToTree.call(this,e)};e._appendElement=function(e,r){i=e.location;t._appendElement.call(this,e,r)};e._insertElement=function(e,r){i=e.location;t._insertElement.call(this,e,r)};e._insertTemplate=function(e){i=e.location;t._insertTemplate.call(this,e);var r=this.treeAdapter.getTemplateContent(this.openElements.current);r.__location=null};e._insertFakeRootElement=function(){t._insertFakeRootElement.call(this);this.openElements.current.__location=null};e._appendCommentNode=function(e,r){t._appendCommentNode.call(this,e,r);var n=this.treeAdapter.getChildNodes(r),a=n[n.length-1];a.__location=e.location};e._findFosterParentingLocation=function(){l=t._findFosterParentingLocation.call(this);return l};e._insertCharacters=function(e){t._insertCharacters.call(this,e);var r=this._shouldFosterParentOnInsertion(),n=r&&l.parent||this.openElements.currentTmplContent||this.openElements.current,a=this.treeAdapter.getChildNodes(n),i=r&&l.beforeElement?a.indexOf(l.beforeElement)-1:a.length-1,o=a[i];if(o.__location)o.__location.endOffset=e.location.endOffset;else o.__location=e.location}}},541:function(e,t,r){"use strict";var n=r(134);var a={element:1,text:3,cdata:4,comment:8};var i={tagName:"name",childNodes:"children",parentNode:"parent",previousSibling:"prev",nextSibling:"next",nodeValue:"data"};var o=function(e){for(var t in e){if(e.hasOwnProperty(t))this[t]=e[t]}};o.prototype={get firstChild(){var e=this.children;return e&&e[0]||null},get lastChild(){var e=this.children;return e&&e[e.length-1]||null},get nodeType(){return a[this.type]||a.element}};Object.keys(i).forEach(function(e){var t=i[e];Object.defineProperty(o.prototype,e,{get:function(){return this[t]||null},set:function(e){this[t]=e;return e}})});t.createDocument=t.createDocumentFragment=function(){return new o({type:"root",name:"root",parent:null,prev:null,next:null,children:[]})};t.createElement=function(e,t,r){var n={},a={},i={};for(var s=0;s<r.length;s++){var l=r[s].name;n[l]=r[s].value;a[l]=r[s].namespace;i[l]=r[s].prefix}return new o({type:e==="script"||e==="style"?e:"tag",name:e,namespace:t,attribs:n,"x-attribsNamespace":a,"x-attribsPrefix":i,children:[],parent:null,prev:null,next:null})};t.createCommentNode=function(e){return new o({type:"comment",data:e,parent:null,prev:null,next:null})};var s=function(e){return new o({type:"text",data:e,parent:null,prev:null,next:null})};var l=t.appendChild=function(e,t){var r=e.children[e.children.length-1];if(r){r.next=t;t.prev=r}e.children.push(t);t.parent=e};var u=t.insertBefore=function(e,t,r){var n=e.children.indexOf(r),a=r.prev;if(a){a.next=t;t.prev=a}r.prev=t;t.next=r;e.children.splice(n,0,t);t.parent=e};t.setTemplateContent=function(e,t){l(e,t)};t.getTemplateContent=function(e){return e.children[0]};t.setDocumentType=function(e,t,r,a){var i=n.serializeContent(t,r,a),s=null;for(var u=0;u<e.children.length;u++){if(e.children[u].type==="directive"&&e.children[u].name==="!doctype"){s=e.children[u];break}}if(s){s.data=i;s["x-name"]=t;s["x-publicId"]=r;s["x-systemId"]=a}else{l(e,new o({type:"directive",name:"!doctype",data:i,"x-name":t,"x-publicId":r,"x-systemId":a}))}};t.setQuirksMode=function(e){e.quirksMode=true};t.isQuirksMode=function(e){return e.quirksMode};t.detachNode=function(e){if(e.parent){var t=e.parent.children.indexOf(e),r=e.prev,n=e.next;e.prev=null;e.next=null;if(r)r.next=n;if(n)n.prev=r;e.parent.children.splice(t,1);e.parent=null}};t.insertText=function(e,t){var r=e.children[e.children.length-1];if(r&&r.type==="text")r.data+=t;else l(e,s(t))};t.insertTextBefore=function(e,t,r){var n=e.children[e.children.indexOf(r)-1];if(n&&n.type==="text")n.data+=t;else u(e,s(t),r)};t.adoptAttributes=function(e,t){for(var r=0;r<t.length;r++){var n=t[r].name;if(typeof e.attribs[n]==="undefined"){e.attribs[n]=t[r].value;e["x-attribsNamespace"][n]=t[r].namespace;e["x-attribsPrefix"][n]=t[r].prefix}}};t.getFirstChild=function(e){return e.children[0]};t.getChildNodes=function(e){return e.children};t.getParentNode=function(e){return e.parent};t.getAttrList=function(e){var t=[];for(var r in e.attribs){if(e.attribs.hasOwnProperty(r)){t.push({name:r,value:e.attribs[r],namespace:e["x-attribsNamespace"][r],prefix:e["x-attribsPrefix"][r]})}}return t};t.getTagName=function(e){return e.name};t.getNamespaceURI=function(e){return e.namespace};t.getTextNodeContent=function(e){return e.data};t.getCommentNodeContent=function(e){return e.data};t.getDocumentTypeNodeName=function(e){return e["x-name"]};t.getDocumentTypeNodePublicId=function(e){return e["x-publicId"]};t.getDocumentTypeNodeSystemId=function(e){return e["x-systemId"]};t.isTextNode=function(e){return e.type==="text"};t.isCommentNode=function(e){return e.type==="comment"};t.isDocumentTypeNode=function(e){return e.type==="directive"&&e.name==="!doctype"};t.isElementNode=function(e){return!!e.attribs}},542:function(e,t,r){"use strict";var n=r(52).Writable,a=r(69).inherits,i=r(201);var o=e.exports=function(e){n.call(this);this.parser=new i(e);this.lastChunkWritten=false;this.writeCallback=null;this.pausedByScript=false;this.document=this.parser.treeAdapter.createDocument();this.pendingHtmlInsertions=[];this._resume=this._resume.bind(this);this._documentWrite=this._documentWrite.bind(this);this._scriptHandler=this._scriptHandler.bind(this);this.parser._bootstrap(this.document,null)};a(o,n);o.prototype._write=function(e,t,r){this.writeCallback=r;this.parser.tokenizer.write(e.toString("utf8"),this.lastChunkWritten);this._runParsingLoop()};o.prototype.end=function(e,t,r){this.lastChunkWritten=true;n.prototype.end.call(this,e,t,r)};o.prototype._runParsingLoop=function(){this.parser._runParsingLoop(this.writeCallback,this._scriptHandler)};o.prototype._resume=function(){if(!this.pausedByScript)throw new Error("Parser was already resumed");while(this.pendingHtmlInsertions.length){var e=this.pendingHtmlInsertions.pop();this.parser.tokenizer.insertHtmlAtCurrentPos(e)}this.pausedByScript=false;if(this.parser.tokenizer.active)this._runParsingLoop()};o.prototype._documentWrite=function(e){if(!this.parser.stopped)this.pendingHtmlInsertions.push(e)};o.prototype._scriptHandler=function(e){if(this.listeners("script").length){this.pausedByScript=true;this.emit("script",e,this._documentWrite,this._resume)}else this._runParsingLoop()}},543:function(e,t,r){"use strict";var n=r(52).Readable,a=r(69).inherits,i=r(204);var o=e.exports=function(e,t){n.call(this);this.serializer=new i(e,t);Object.defineProperty(this.serializer,"html",{get:function(){return""},set:this.push.bind(this)})};a(o,n);o.prototype._read=function(){this.serializer.serialize();this.push(null)}},544:function(e,t,r){"use strict";var n=r(52).Transform,a=r(545),i=r(69).inherits,o=r(82),s=r(546),l=r(135);var u={locationInfo:false};var c=e.exports=function(e){n.call(this);this.options=l(u,e);this.tokenizer=new o(e);this.parserFeedbackSimulator=new s(this.tokenizer);this.pendingText=null;this.currentTokenLocation=void 0;this.lastChunkWritten=false;this.stopped=false;this.pipe(new a)};i(c,n);c.prototype._transform=function(e,t,r){if(!this.stopped){this.tokenizer.write(e.toString("utf8"),this.lastChunkWritten);this._runParsingLoop()}this.push(e);r()};c.prototype._flush=function(e){e()};c.prototype.end=function(e,t,r){this.lastChunkWritten=true;n.prototype.end.call(this,e,t,r)};c.prototype.stop=function(){this.stopped=true};c.prototype._runParsingLoop=function(){do{var e=this.parserFeedbackSimulator.getNextToken();if(e.type===o.HIBERNATION_TOKEN)break;if(e.type===o.CHARACTER_TOKEN||e.type===o.WHITESPACE_CHARACTER_TOKEN||e.type===o.NULL_CHARACTER_TOKEN){if(this.options.locationInfo){if(this.pendingText===null)this.currentTokenLocation=e.location;else this.currentTokenLocation.endOffset=e.location.endOffset}this.pendingText=(this.pendingText||"")+e.chars}else{this._emitPendingText();this._handleToken(e)}}while(!this.stopped&&e.type!==o.EOF_TOKEN)};c.prototype._handleToken=function(e){if(this.options.locationInfo)this.currentTokenLocation=e.location;if(e.type===o.START_TAG_TOKEN)this.emit("startTag",e.tagName,e.attrs,e.selfClosing,this.currentTokenLocation);else if(e.type===o.END_TAG_TOKEN)this.emit("endTag",e.tagName,this.currentTokenLocation);else if(e.type===o.COMMENT_TOKEN)this.emit("comment",e.data,this.currentTokenLocation);else if(e.type===o.DOCTYPE_TOKEN)this.emit("doctype",e.name,e.publicId,e.systemId,this.currentTokenLocation)};c.prototype._emitPendingText=function(){if(this.pendingText!==null){this.emit("text",this.pendingText,this.currentTokenLocation);this.pendingText=null}}},545:function(e,t,r){"use strict";var n=r(52).Writable,a=r(69);var i=e.exports=function(){n.call(this)};a.inherits(i,n);i.prototype._write=function(e,t,r){r()}},546:function(e,t,r){"use strict";var n=r(82),a=r(203),i=r(83),o=r(68);var s=o.TAG_NAMES,l=o.NAMESPACES;var u=e.exports=function(e){this.tokenizer=e;this.namespaceStack=[];this.namespaceStackTop=-1;this._enterNamespace(l.HTML)};u.prototype.getNextToken=function(){var e=this.tokenizer.getNextToken();if(e.type===n.START_TAG_TOKEN)this._handleStartTagToken(e);else if(e.type===n.END_TAG_TOKEN)this._handleEndTagToken(e);else if(e.type===n.NULL_CHARACTER_TOKEN&&this.inForeignContent){e.type=n.CHARACTER_TOKEN;e.chars=i.REPLACEMENT_CHARACTER}else if(this.skipNextNewLine){if(e.type!==n.HIBERNATION_TOKEN)this.skipNextNewLine=false;if(e.type===n.WHITESPACE_CHARACTER_TOKEN&&e.chars[0]==="\n"){if(e.chars.length===1)return this.getNextToken();e.chars=e.chars.substr(1)}}return e};u.prototype._enterNamespace=function(e){this.namespaceStackTop++;this.namespaceStack.push(e);this.inForeignContent=e!==l.HTML;this.currentNamespace=e;this.tokenizer.allowCDATA=this.inForeignContent};u.prototype._leaveCurrentNamespace=function(){this.namespaceStackTop--;this.namespaceStack.pop();this.currentNamespace=this.namespaceStack[this.namespaceStackTop];this.inForeignContent=this.currentNamespace!==l.HTML;this.tokenizer.allowCDATA=this.inForeignContent};u.prototype._ensureTokenizerMode=function(e){if(e===s.TEXTAREA||e===s.TITLE)this.tokenizer.state=n.MODE.RCDATA;else if(e===s.PLAINTEXT)this.tokenizer.state=n.MODE.PLAINTEXT;else if(e===s.SCRIPT)this.tokenizer.state=n.MODE.SCRIPT_DATA;else if(e===s.STYLE||e===s.IFRAME||e===s.XMP||e===s.NOEMBED||e===s.NOFRAMES||e===s.NOSCRIPT)this.tokenizer.state=n.MODE.RAWTEXT};u.prototype._handleStartTagToken=function(e){var t=e.tagName;if(t===s.SVG)this._enterNamespace(l.SVG);else if(t===s.MATH)this._enterNamespace(l.MATHML);if(this.inForeignContent){if(a.causesExit(e)){this._leaveCurrentNamespace();return}var r=this.currentNamespace;if(r===l.MATHML)a.adjustTokenMathMLAttrs(e);else if(r===l.SVG){a.adjustTokenSVGTagName(e);a.adjustTokenSVGAttrs(e)}a.adjustTokenXMLAttrs(e);t=e.tagName;if(!e.selfClosing&&a.isIntegrationPoint(t,r,e.attrs))this._enterNamespace(l.HTML)}else{if(t===s.PRE||t===s.TEXTAREA||t===s.LISTING)this.skipNextNewLine=true;else if(t===s.IMAGE)e.tagName=s.IMG;this._ensureTokenizerMode(t)}};u.prototype._handleEndTagToken=function(e){var t=e.tagName;if(!this.inForeignContent){var r=this.namespaceStack[this.namespaceStackTop-1];if(r===l.SVG&&a.SVG_TAG_NAMES_ADJUSTMENT_MAP[t])t=a.SVG_TAG_NAMES_ADJUSTMENT_MAP[t];if(a.isIntegrationPoint(t,r,e.attrs))this._leaveCurrentNamespace()}else if(t===s.SVG&&this.currentNamespace===l.SVG||t===s.MATH&&this.currentNamespace===l.MATHML)this._leaveCurrentNamespace();if(this.currentNamespace===l.SVG)a.adjustTokenSVGTagName(e)}},547:function(e,t,r){(function(t){var r=9007199254740991;var n="[object Arguments]",a="[object Function]",i="[object GeneratorFunction]";var o=typeof t=="object"&&t&&t.Object===Object&&t;var s=typeof self=="object"&&self&&self.Object===Object&&self;var l=o||s||Function("return this")();function u(e,t){var r=-1,n=t.length,a=e.length;while(++r<n){e[a+r]=t[r]}return e}var c=Object.prototype;var f=c.hasOwnProperty;var h=c.toString;var p=l.Symbol,d=c.propertyIsEnumerable,v=p?p.isConcatSpreadable:undefined;function m(e,t,r,n,a){var i=-1,o=e.length;r||(r=g);a||(a=[]);while(++i<o){var s=e[i];if(t>0&&r(s)){if(t>1){m(s,t-1,r,n,a)}else{u(a,s)}}else if(!n){a[a.length]=s}}return a}function g(e){return _(e)||x(e)||!!(v&&e&&e[v])}function y(e){var t=e?e.length:0;return t?m(e,1):[]}function x(e){return w(e)&&f.call(e,"callee")&&(!d.call(e,"callee")||h.call(e)==n)}var _=Array.isArray;function b(e){return e!=null&&k(e.length)&&!T(e)}function w(e){return M(e)&&b(e)}function T(e){var t=A(e)?h.call(e):"";return t==a||t==i}function k(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=r}function A(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function M(e){return!!e&&typeof e=="object"}e.exports=y}).call(this,r(14))},548:function(e,t,r){var n=r(549);var a=[];var i={};for(var o=0;o<256;o++){a[o]=(o+256).toString(16).substr(1);i[a[o]]=o}function s(e,t,r){var n=t&&r||0,a=0;t=t||[];e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){if(a<16){t[n+a++]=i[e]}});while(a<16){t[n+a++]=0}return t}function l(e,t){var r=t||0,n=a;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}var u=n();var c=[u[0]|1,u[1],u[2],u[3],u[4],u[5]];var f=(u[6]<<8|u[7])&16383;var h=0,p=0;function d(e,t,r){var n=t&&r||0;var a=t||[];e=e||{};var i=e.clockseq!==undefined?e.clockseq:f;var o=e.msecs!==undefined?e.msecs:(new Date).getTime();var s=e.nsecs!==undefined?e.nsecs:p+1;var u=o-h+(s-p)/1e4;if(u<0&&e.clockseq===undefined){i=i+1&16383}if((u<0||o>h)&&e.nsecs===undefined){s=0}if(s>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}h=o;p=s;f=i;o+=122192928e5;var d=((o&268435455)*1e4+s)%4294967296;a[n++]=d>>>24&255;a[n++]=d>>>16&255;a[n++]=d>>>8&255;a[n++]=d&255;var v=o/4294967296*1e4&268435455;a[n++]=v>>>8&255;a[n++]=v&255;a[n++]=v>>>24&15|16;a[n++]=v>>>16&255;a[n++]=i>>>8|128;a[n++]=i&255;var m=e.node||c;for(var g=0;g<6;g++){a[n+g]=m[g]}return t?t:l(a)}function v(e,t,r){var a=t&&r||0;if(typeof e=="string"){t=e=="binary"?new Array(16):null;e=null}e=e||{};var i=e.random||(e.rng||n)();i[6]=i[6]&15|64;i[8]=i[8]&63|128;if(t){for(var o=0;o<16;o++){t[a+o]=i[o]}}return t||l(i)}var m=v;m.v1=d;m.v4=v;m.parse=s;m.unparse=l;e.exports=m},549:function(e,t,r){(function(t){var r;var n=t.crypto||t.msCrypto;if(n&&n.getRandomValues){var a=new Uint8Array(16);r=function e(){n.getRandomValues(a);return a}}if(!r){var i=new Array(16);r=function(){for(var e=0,t;e<16;e++){if((e&3)===0)t=Math.random()*4294967296;i[e]=t>>>((e&3)<<3)&255}return i}}e.exports=r}).call(this,r(14))},550:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t["default"]=_;var n=s(r(8));var a=i(r(551));function i(e){return e&&e.__esModule?e:{default:e}}function o(){if(typeof WeakMap!=="function")return null;var e=new WeakMap;o=function t(){return e};return e}function s(e){if(e&&e.__esModule){return e}var t=o();if(t&&t.has(e)){return t.get(e)}var r={};if(e!=null){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e){if(Object.prototype.hasOwnProperty.call(e,a)){var i=n?Object.getOwnPropertyDescriptor(e,a):null;if(i&&(i.get||i.set)){Object.defineProperty(r,a,i)}else{r[a]=e[a]}}}}r["default"]=e;if(t){t.set(e,r)}return r}function l(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){l=function e(t){return typeof t}}else{l=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return l(e)}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function f(e,t,r){if(t)c(e.prototype,t);if(r)c(e,r);return e}function h(e,t){if(t&&(l(t)==="object"||typeof t==="function")){return t}return d(e)}function p(e){p=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return p(e)}function d(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)m(e,t)}function m(e,t){m=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return m(e,t)}var g=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","Transitioning","TransitionInterrupted","Unhover"];var y=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_doubleclick","plotly_animated"];var x=typeof window!=="undefined";function _(e){var t=function(t){v(r,t);function r(e){var t;u(this,r);t=h(this,p(r).call(this,e));t.p=Promise.resolve();t.resizeHandler=null;t.handlers={};t.syncWindowResize=t.syncWindowResize.bind(d(t));t.syncEventHandlers=t.syncEventHandlers.bind(d(t));t.attachUpdateEvents=t.attachUpdateEvents.bind(d(t));t.getRef=t.getRef.bind(d(t));t.handleUpdate=t.handleUpdate.bind(d(t));t.figureCallback=t.figureCallback.bind(d(t));t.updatePlotly=t.updatePlotly.bind(d(t));return t}f(r,[{key:"updatePlotly",value:function t(r,n,a){var i=this;this.p=this.p.then(function(){if(!i.el){var t;if(i.unmounting){t=new Error("Component is unmounting");t.reason="unmounting"}else{t=new Error("Missing element reference")}throw t}return e.react(i.el,{data:i.props.data,layout:i.props.layout,config:i.props.config,frames:i.props.frames})}).then(function(){return i.syncWindowResize(r)}).then(this.syncEventHandlers).then(function(){return i.figureCallback(n)}).then(a?this.attachUpdateEvents:function(){})["catch"](function(e){if(e.reason==="unmounting"){return}console.error("Error while plotting:",e);if(i.props.onError){i.props.onError(e)}})}},{key:"componentDidMount",value:function e(){this.unmounting=false;this.updatePlotly(true,this.props.onInitialized,true)}},{key:"componentDidUpdate",value:function e(t){this.unmounting=false;var r=t.frames&&t.frames.length?t.frames.length:0;var n=this.props.frames&&this.props.frames.length?this.props.frames.length:0;var a=!(t.layout===this.props.layout&&t.data===this.props.data&&t.config===this.props.config&&n===r);var i=t.revision!==void 0;var o=t.revision!==this.props.revision;if(!a&&(!i||i&&!o)){return}this.updatePlotly(false,this.props.onUpdate,false)}},{key:"componentWillUnmount",value:function t(){this.unmounting=true;this.figureCallback(this.props.onPurge);if(this.resizeHandler&&x){window.removeEventListener("resize",this.resizeHandler);this.resizeHandler=null}this.removeUpdateEvents();e.purge(this.el)}},{key:"attachUpdateEvents",value:function e(){var t=this;if(!this.el||!this.el.removeListener){return}y.forEach(function(e){t.el.on(e,t.handleUpdate)})}},{key:"removeUpdateEvents",value:function e(){var t=this;if(!this.el||!this.el.removeListener){return}y.forEach(function(e){t.el.removeListener(e,t.handleUpdate)})}},{key:"handleUpdate",value:function e(){this.figureCallback(this.props.onUpdate)}},{key:"figureCallback",value:function e(t){if(typeof t==="function"){var r=this.el,n=r.data,a=r.layout;var i=this.el._transitionData?this.el._transitionData._frames:null;var o={data:n,layout:a,frames:i};t(o,this.el)}}},{key:"syncWindowResize",value:function t(r){var n=this;if(!x){return}if(this.props.useResizeHandler&&!this.resizeHandler){this.resizeHandler=function(){return e.Plots.resize(n.el)};window.addEventListener("resize",this.resizeHandler);if(r){this.resizeHandler()}}else if(!this.props.useResizeHandler&&this.resizeHandler){window.removeEventListener("resize",this.resizeHandler);this.resizeHandler=null}}},{key:"getRef",value:function e(t){this.el=t;if(this.props.debug&&x){window.gd=this.el}}},{key:"syncEventHandlers",value:function e(){var t=this;g.forEach(function(e){var r=t.props["on"+e];var n=t.handlers[e];var a=Boolean(n);if(r&&!a){t.addEventHandler(e,r)}else if(!r&&a){t.removeEventHandler(e)}else if(r&&a&&r!==n){t.removeEventHandler(e);t.addEventHandler(e,r)}})}},{key:"addEventHandler",value:function e(t,r){this.handlers[t]=r;this.el.on(this.getPlotlyEventName(t),this.handlers[t])}},{key:"removeEventHandler",value:function e(t){this.el.removeListener(this.getPlotlyEventName(t),this.handlers[t]);delete this.handlers[t]}},{key:"getPlotlyEventName",value:function e(t){return"plotly_"+t.toLowerCase()}},{key:"render",value:function e(){return n["default"].createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]);return r}(n.Component);t.propTypes={data:a["default"].arrayOf(a["default"].object),config:a["default"].object,layout:a["default"].object,frames:a["default"].arrayOf(a["default"].object),revision:a["default"].number,onInitialized:a["default"].func,onPurge:a["default"].func,onError:a["default"].func,onUpdate:a["default"].func,debug:a["default"].bool,style:a["default"].object,className:a["default"].string,useResizeHandler:a["default"].bool,divId:a["default"].string};g.forEach(function(e){t.propTypes["on"+e]=a["default"].func});t.defaultProps={debug:false,useResizeHandler:false,data:[],style:{position:"relative",display:"inline-block"}};return t}},551:function(e,t,r){if(false){var n,a}else{e.exports=r(552)()}},552:function(e,t,r){"use strict";var n=r(553);function a(){}function i(){}i.resetWarningCache=a;e.exports=function(){function e(e,t,r,a,i,o){if(o===n){return}var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. "+"Use PropTypes.checkPropTypes() to call them. "+"Read more at http://fb.me/use-check-prop-types");s.name="Invariant Violation";throw s}e.isRequired=e;function t(){return e}var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};r.PropTypes=r;return r}},553:function(e,t,r){"use strict";var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";e.exports=n},554:function(e,t,r){(function(t){var r;var r;(function(t){if(true){e.exports=t()}else{var r}})(function(){var e,n,a;return function(){function e(t,n,a){function i(s,l){if(!n[s]){if(!t[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return i(r||e)},f,f.exports,e,t,n,a)}return n[s].exports}for(var o="function"==typeof r&&r,s=0;s<a.length;s++)i(a[s]);return i}return e}()({1:[function(e,t,r){"use strict";var n=e("../src/lib");var a={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans', verdana, arial, sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var i in a){var o=i.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");n.addStyleRule(o,a[i])}},{"../src/lib":778}],2:[function(e,t,r){"use strict";t.exports=e("../src/transforms/aggregate")},{"../src/transforms/aggregate":1365}],3:[function(e,t,r){"use strict";t.exports=e("../src/traces/bar")},{"../src/traces/bar":929}],4:[function(e,t,r){"use strict";t.exports=e("../src/traces/barpolar")},{"../src/traces/barpolar":942}],5:[function(e,t,r){"use strict";t.exports=e("../src/traces/box")},{"../src/traces/box":952}],6:[function(e,t,r){"use strict";t.exports=e("../src/components/calendars")},{"../src/components/calendars":641}],7:[function(e,t,r){"use strict";t.exports=e("../src/traces/candlestick")},{"../src/traces/candlestick":961}],8:[function(e,t,r){"use strict";t.exports=e("../src/traces/carpet")},{"../src/traces/carpet":980}],9:[function(e,t,r){"use strict";t.exports=e("../src/traces/choropleth")},{"../src/traces/choropleth":994}],10:[function(e,t,r){"use strict";t.exports=e("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1001}],11:[function(e,t,r){"use strict";t.exports=e("../src/traces/cone")},{"../src/traces/cone":1007}],12:[function(e,t,r){"use strict";t.exports=e("../src/traces/contour")},{"../src/traces/contour":1022}],13:[function(e,t,r){"use strict";t.exports=e("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1033}],14:[function(e,t,r){"use strict";t.exports=e("../src/core")},{"../src/core":755}],15:[function(e,t,r){"use strict";t.exports=e("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1041}],16:[function(e,t,r){"use strict";t.exports=e("../src/transforms/filter")},{"../src/transforms/filter":1366}],17:[function(e,t,r){"use strict";t.exports=e("../src/traces/funnel")},{"../src/traces/funnel":1051}],18:[function(e,t,r){"use strict";t.exports=e("../src/traces/funnelarea")},{"../src/traces/funnelarea":1060}],19:[function(e,t,r){"use strict";t.exports=e("../src/transforms/groupby")},{"../src/transforms/groupby":1367}],20:[function(e,t,r){"use strict";t.exports=e("../src/traces/heatmap")},{"../src/traces/heatmap":1073}],21:[function(e,t,r){"use strict";t.exports=e("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1083}],22:[function(e,t,r){"use strict";t.exports=e("../src/traces/histogram")},{"../src/traces/histogram":1095}],23:[function(e,t,r){"use strict";t.exports=e("../src/traces/histogram2d")},{"../src/traces/histogram2d":1101}],24:[function(e,t,r){"use strict";t.exports=e("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1105}],25:[function(e,t,r){"use strict";t.exports=e("../src/traces/image")},{"../src/traces/image":1113}],26:[function(e,t,r){"use strict";var n=e("./core");n.register([e("./bar"),e("./box"),e("./heatmap"),e("./histogram"),e("./histogram2d"),e("./histogram2dcontour"),e("./contour"),e("./scatterternary"),e("./violin"),e("./funnel"),e("./waterfall"),e("./image"),e("./pie"),e("./sunburst"),e("./treemap"),e("./funnelarea"),e("./scatter3d"),e("./surface"),e("./isosurface"),e("./volume"),e("./mesh3d"),e("./cone"),e("./streamtube"),e("./scattergeo"),e("./choropleth"),e("./scattergl"),e("./splom"),e("./pointcloud"),e("./heatmapgl"),e("./parcoords"),e("./parcats"),e("./scattermapbox"),e("./choroplethmapbox"),e("./densitymapbox"),e("./sankey"),e("./indicator"),e("./table"),e("./carpet"),e("./scattercarpet"),e("./contourcarpet"),e("./ohlc"),e("./candlestick"),e("./scatterpolar"),e("./scatterpolargl"),e("./barpolar")]);n.register([e("./aggregate"),e("./filter"),e("./groupby"),e("./sort")]);n.register([e("./calendars")]);t.exports=n},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./image":25,"./indicator":27,"./isosurface":28,"./mesh3d":29,"./ohlc":30,"./parcats":31,"./parcoords":32,"./pie":33,"./pointcloud":34,"./sankey":35,"./scatter3d":36,"./scattercarpet":37,"./scattergeo":38,"./scattergl":39,"./scattermapbox":40,"./scatterpolar":41,"./scatterpolargl":42,"./scatterternary":43,"./sort":44,"./splom":45,"./streamtube":46,"./sunburst":47,"./surface":48,"./table":49,"./treemap":50,"./violin":51,"./volume":52,"./waterfall":53}],27:[function(e,t,r){"use strict";t.exports=e("../src/traces/indicator")},{"../src/traces/indicator":1121}],28:[function(e,t,r){"use strict";t.exports=e("../src/traces/isosurface")},{"../src/traces/isosurface":1127}],29:[function(e,t,r){"use strict";t.exports=e("../src/traces/mesh3d")},{"../src/traces/mesh3d":1132}],30:[function(e,t,r){"use strict";t.exports=e("../src/traces/ohlc")},{"../src/traces/ohlc":1137}],31:[function(e,t,r){"use strict";t.exports=e("../src/traces/parcats")},{"../src/traces/parcats":1146}],32:[function(e,t,r){"use strict";t.exports=e("../src/traces/parcoords")},{"../src/traces/parcoords":1156}],33:[function(e,t,r){"use strict";t.exports=e("../src/traces/pie")},{"../src/traces/pie":1167}],34:[function(e,t,r){"use strict";t.exports=e("../src/traces/pointcloud")},{"../src/traces/pointcloud":1176}],35:[function(e,t,r){"use strict";t.exports=e("../src/traces/sankey")},{"../src/traces/sankey":1182}],36:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatter3d")},{"../src/traces/scatter3d":1220}],37:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1227}],38:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattergeo")},{"../src/traces/scattergeo":1235}],39:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattergl")},{"../src/traces/scattergl":1248}],40:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1258}],41:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1266}],42:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1273}],43:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatterternary")},{"../src/traces/scatterternary":1281}],44:[function(e,t,r){"use strict";t.exports=e("../src/transforms/sort")},{"../src/transforms/sort":1369}],45:[function(e,t,r){"use strict";t.exports=e("../src/traces/splom")},{"../src/traces/splom":1290}],46:[function(e,t,r){"use strict";t.exports=e("../src/traces/streamtube")},{"../src/traces/streamtube":1298}],47:[function(e,t,r){"use strict";t.exports=e("../src/traces/sunburst")},{"../src/traces/sunburst":1306}],48:[function(e,t,r){"use strict";t.exports=e("../src/traces/surface")},{"../src/traces/surface":1315}],49:[function(e,t,r){"use strict";t.exports=e("../src/traces/table")},{"../src/traces/table":1323}],50:[function(e,t,r){"use strict";t.exports=e("../src/traces/treemap")},{"../src/traces/treemap":1332}],51:[function(e,t,r){"use strict";t.exports=e("../src/traces/violin")},{"../src/traces/violin":1344}],52:[function(e,t,r){"use strict";t.exports=e("../src/traces/volume")},{"../src/traces/volume":1352}],53:[function(e,t,r){"use strict";t.exports=e("../src/traces/waterfall")},{"../src/traces/waterfall":1360}],54:[function(e,t,r){"use strict";t.exports=u;var n=e("turntable-camera-controller");var a=e("orbit-camera-controller");var i=e("matrix-camera-controller");function o(e,t){this._controllerNames=Object.keys(e);this._controllerList=this._controllerNames.map(function(t){return e[t]});this._mode=t;this._active=e[t];if(!this._active){this._mode="turntable";this._active=e.turntable}this.modes=this._controllerNames;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius}var s=o.prototype;var l=[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]];l.forEach(function(e){var t=e[0];var r=[];for(var n=0;n<e[1];++n){r.push("a"+n)}var a="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+r.join()+")}";s[t]=Function.apply(null,r.concat(a))});s.recalcMatrix=function(e){this._active.recalcMatrix(e)};s.getDistance=function(e){return this._active.getDistance(e)};s.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)};s.lastT=function(){return this._active.lastT()};s.setMode=function(e){if(e===this._mode){return}var t=this._controllerNames.indexOf(e);if(t<0){return}var r=this._active;var n=this._controllerList[t];var a=Math.max(r.lastT(),n.lastT());r.recalcMatrix(a);n.setMatrix(a,r.computedMatrix);this._active=n;this._mode=e;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius};s.getMode=function(){return this._mode};function u(e){e=e||{};var t=e.eye||[0,0,1];var r=e.center||[0,0,0];var s=e.up||[0,1,0];var l=e.distanceLimits||[0,Infinity];var u=e.mode||"turntable";var c=n();var f=a();var h=i();c.setDistanceLimits(l[0],l[1]);c.lookAt(0,t,r,s);f.setDistanceLimits(l[0],l[1]);f.lookAt(0,t,r,s);h.setDistanceLimits(l[0],l[1]);h.lookAt(0,t,r,s);return new o({turntable:c,orbit:f,matrix:h},u)}},{"matrix-camera-controller":480,"orbit-camera-controller":501,"turntable-camera-controller":581}],55:[function(t,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,t("d3-array"),t("d3-collection"),t("d3-shape"),t("elementary-circuits-directed-graph")):typeof e==="function"&&e.amd?e(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],i):i(a.d3=a.d3||{},a.d3,a.d3,a.d3,null)})(this,function(e,t,r,n,a){"use strict";a=a&&a.hasOwnProperty("default")?a["default"]:a;function i(e){return e.target.depth}function o(e){return e.depth}function s(e,t){return t-1-e.height}function l(e,t){return e.sourceLinks.length?e.depth:t-1}function u(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,i)-1:0}function c(e){return function(){return e}}var f=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function h(e,t){return d(e.source,t.source)||e.index-t.index}function p(e,t){return d(e.target,t.target)||e.index-t.index}function d(e,t){if(e.partOfCycle===t.partOfCycle){return e.y0-t.y0}else{if(e.circularLinkType==="top"||t.circularLinkType==="bottom"){return-1}else{return 1}}}function v(e){return e.value}function m(e){return(e.y0+e.y1)/2}function g(e){return m(e.source)}function y(e){return m(e.target)}function x(e){return e.index}function _(e){return e.nodes}function b(e){return e.links}function w(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}function T(e,t){return t(e)}var k=25;var A=10;var M=.3;function E(){var e=0,n=0,a=1,i=1,o=24,s,u=x,T=l,E=_,L=b,I=32,P=2,D,z=null;function N(){var e={nodes:E.apply(null,arguments),links:L.apply(null,arguments)};F(e);S(e,u,z);B(e);H(e);C(e,u);V(e,I,u);G(e);var t=4;for(var r=0;r<t;r++){Z(e,i,u);K(e,i,u);Y(e,n,i,u);Z(e,i,u);K(e,i,u)}ee(e,n,i);R(e,P,i,u);return e}N.nodeId=function(e){return arguments.length?(u=typeof e==="function"?e:c(e),N):u};N.nodeAlign=function(e){return arguments.length?(T=typeof e==="function"?e:c(e),N):T};N.nodeWidth=function(e){return arguments.length?(o=+e,N):o};N.nodePadding=function(e){return arguments.length?(s=+e,N):s};N.nodes=function(e){return arguments.length?(E=typeof e==="function"?e:c(e),N):E};N.links=function(e){return arguments.length?(L=typeof e==="function"?e:c(e),N):L};N.size=function(t){return arguments.length?(e=n=0,a=+t[0],i=+t[1],N):[a-e,i-n]};N.extent=function(t){return arguments.length?(e=+t[0][0],a=+t[1][0],n=+t[0][1],i=+t[1][1],N):[[e,n],[a,i]]};N.iterations=function(e){return arguments.length?(I=+e,N):I};N.circularLinkGap=function(e){return arguments.length?(P=+e,N):P};N.nodePaddingRatio=function(e){return arguments.length?(D=+e,N):D};N.sortNodes=function(e){return arguments.length?(z=e,N):z};N.update=function(e){C(e,u);G(e);e.links.forEach(function(e){if(e.circular){e.circularLinkType=e.y0+e.y1<i?"top":"bottom";e.source.circularLinkType=e.circularLinkType;e.target.circularLinkType=e.circularLinkType}});Z(e,i,u,false);K(e,i,u);R(e,P,i,u);return e};function F(e){e.nodes.forEach(function(e,t){e.index=t;e.sourceLinks=[];e.targetLinks=[]});var t=r.map(e.nodes,u);e.links.forEach(function(e,r){e.index=r;var n=e.source;var a=e.target;if((typeof n==="undefined"?"undefined":f(n))!=="object"){n=e.source=w(t,n)}if((typeof a==="undefined"?"undefined":f(a))!=="object"){a=e.target=w(t,a)}n.sourceLinks.push(e);a.targetLinks.push(e)});return e}function B(e){e.nodes.forEach(function(e){e.partOfCycle=false;e.value=Math.max(t.sum(e.sourceLinks,v),t.sum(e.targetLinks,v));e.sourceLinks.forEach(function(t){if(t.circular){e.partOfCycle=true;e.circularLinkType=t.circularLinkType}});e.targetLinks.forEach(function(t){if(t.circular){e.partOfCycle=true;e.circularLinkType=t.circularLinkType}})})}function j(e){var r=0,n=0,a=0,i=0;var o=t.max(e.nodes,function(e){return e.column});e.links.forEach(function(e){if(e.circular){if(e.circularLinkType=="top"){r=r+e.width}else{n=n+e.width}if(e.target.column==0){i=i+e.width}if(e.source.column==o){a=a+e.width}}});r=r>0?r+k+A:r;n=n>0?n+k+A:n;a=a>0?a+k+A:a;i=i>0?i+k+A:i;return{top:r,bottom:n,left:i,right:a}}function U(r,s){var l=t.max(r.nodes,function(e){return e.column});var u=a-e;var c=i-n;var f=u+s.right+s.left;var h=c+s.top+s.bottom;var p=u/f;var d=c/h;e=e*p+s.left;a=s.right==0?a:a*p;n=n*d+s.top;i=i*d;r.nodes.forEach(function(t){t.x0=e+t.column*((a-e-o)/l);t.x1=t.x0+o});return d}function H(e){var t,r,n;for(t=e.nodes,r=[],n=0;t.length;++n,t=r,r=[]){t.forEach(function(e){e.depth=n;e.sourceLinks.forEach(function(e){if(r.indexOf(e.target)<0&&!e.circular){r.push(e.target)}})})}for(t=e.nodes,r=[],n=0;t.length;++n,t=r,r=[]){t.forEach(function(e){e.height=n;e.targetLinks.forEach(function(e){if(r.indexOf(e.source)<0&&!e.circular){r.push(e.source)}})})}e.nodes.forEach(function(e){e.column=Math.floor(T.call(null,e,n))})}function V(e,a,o){var l=r.nest().key(function(e){return e.column}).sortKeys(t.ascending).entries(e.nodes).map(function(e){return e.values});f(o);p();for(var u=1,c=a;c>0;--c){h(u*=.99,o);p()}function f(r){if(D){var a=Infinity;l.forEach(function(e){var t=i*D/(e.length+1);a=t<a?t:a});s=a}var o=t.min(l,function(e){return(i-n-(e.length-1)*s)/t.sum(e,v)});o=o*M;e.links.forEach(function(e){e.width=e.value*o});var u=j(e);var c=U(e,u);o=o*c;e.links.forEach(function(e){e.width=e.value*o});l.forEach(function(e){var t=e.length;e.forEach(function(e,a){if(e.depth==l.length-1&&t==1){e.y0=i/2-e.value*o;e.y1=e.y0+e.value*o}else if(e.depth==0&&t==1){e.y0=i/2-e.value*o;e.y1=e.y0+e.value*o}else if(e.partOfCycle){if(O(e,r)==0){e.y0=i/2+a;e.y1=e.y0+e.value*o}else if(e.circularLinkType=="top"){e.y0=n+a;e.y1=e.y0+e.value*o}else{e.y0=i-e.value*o-a;e.y1=e.y0+e.value*o}}else{if(u.top==0||u.bottom==0){e.y0=(i-n)/t*a;e.y1=e.y0+e.value*o}else{e.y0=(i-n)/2-t/2+a;e.y1=e.y0+e.value*o}}})})}function h(e,r){var n=l.length;l.forEach(function(a){var o=a.length;var s=a[0].depth;a.forEach(function(a){var l;if(a.sourceLinks.length||a.targetLinks.length){if(a.partOfCycle&&O(a,r)>0);else if(s==0&&o==1){l=a.y1-a.y0;a.y0=i/2-l/2;a.y1=i/2+l/2}else if(s==n-1&&o==1){l=a.y1-a.y0;a.y0=i/2-l/2;a.y1=i/2+l/2}else{var u=0;var c=t.mean(a.sourceLinks,y);var f=t.mean(a.targetLinks,g);if(c&&f){u=(c+f)/2}else{u=c||f}var h=(u-m(a))*e;a.y0+=h;a.y1+=h}}})})}function p(){l.forEach(function(e){var t,r,a=n,o=e.length,l;e.sort(d);for(l=0;l<o;++l){t=e[l];r=a-t.y0;if(r>0){t.y0+=r;t.y1+=r}a=t.y1+s}r=a-s-i;if(r>0){a=t.y0-=r,t.y1-=r;for(l=o-2;l>=0;--l){t=e[l];r=t.y1+s-a;if(r>0)t.y0-=r,t.y1-=r;a=t.y0}}})}}function G(e){e.nodes.forEach(function(e){e.sourceLinks.sort(p);e.targetLinks.sort(h)});e.nodes.forEach(function(e){var t=e.y0;var r=t;var n=e.y1;var a=n;e.sourceLinks.forEach(function(e){if(e.circular){e.y0=n-e.width/2;n=n-e.width}else{e.y0=t+e.width/2;t+=e.width}});e.targetLinks.forEach(function(e){if(e.circular){e.y1=a-e.width/2;a=a-e.width}else{e.y1=r+e.width/2;r+=e.width}})})}return N}function S(e,t,r){var n=0;if(r===null){var i=[];for(var o=0;o<e.links.length;o++){var s=e.links[o];var l=s.source.index;var u=s.target.index;if(!i[l])i[l]=[];if(!i[u])i[u]=[];if(i[l].indexOf(u)===-1)i[l].push(u)}var c=a(i);c.sort(function(e,t){return e.length-t.length});var f={};for(o=0;o<c.length;o++){var h=c[o];var p=h.slice(-2);if(!f[p[0]])f[p[0]]={};f[p[0]][p[1]]=true}e.links.forEach(function(e){var t=e.target.index;var r=e.source.index;if(t===r||f[r]&&f[r][t]){e.circular=true;e.circularLinkID=n;n=n+1}else{e.circular=false}})}else{e.links.forEach(function(e){if(e.source[r]<e.target[r]){e.circular=false}else{e.circular=true;e.circularLinkID=n;n=n+1}})}}function C(e,t){var r=0;var n=0;e.links.forEach(function(a){if(a.circular){if(a.source.circularLinkType||a.target.circularLinkType){a.circularLinkType=a.source.circularLinkType?a.source.circularLinkType:a.target.circularLinkType}else{a.circularLinkType=r<n?"top":"bottom"}if(a.circularLinkType=="top"){r=r+1}else{n=n+1}e.nodes.forEach(function(e){if(T(e,t)==T(a.source,t)||T(e,t)==T(a.target,t)){e.circularLinkType=a.circularLinkType}})}});e.links.forEach(function(e){if(e.circular){if(e.source.circularLinkType==e.target.circularLinkType){e.circularLinkType=e.source.circularLinkType}if($(e,t)){e.circularLinkType=e.source.circularLinkType}}})}function L(e){var t=Math.abs(e.y1-e.y0);var r=Math.abs(e.target.x0-e.source.x1);return Math.atan(r/t)}function I(e,t){if(e.source.column<t.target.column){return false}else if(e.target.column>t.source.column){return false}else{return true}}function O(e,t){var r=0;e.sourceLinks.forEach(function(e){r=e.circular&&!$(e,t)?r+1:r});var n=0;e.targetLinks.forEach(function(e){n=e.circular&&!$(e,t)?n+1:n});return r+n}function P(e){var t=e.source.sourceLinks;var r=0;t.forEach(function(e){r=e.circular?r+1:r});var n=e.target.targetLinks;var a=0;n.forEach(function(e){a=e.circular?a+1:a});if(r>1||a>1){return false}else{return true}}function D(e,t,r){e.sort(N);e.forEach(function(n,a){var i=0;if($(n,r)&&P(n)){n.circularPathData.verticalBuffer=i+n.width/2}else{var o=0;for(o;o<a;o++){if(I(e[a],e[o])){var s=e[o].circularPathData.verticalBuffer+e[o].width/2+t;i=s>i?s:i}}n.circularPathData.verticalBuffer=i+n.width/2}});return e}function R(e,r,a,i){var o=5;var s=t.min(e.links,function(e){return e.source.y0});e.links.forEach(function(e){if(e.circular){e.circularPathData={}}});var l=e.links.filter(function(e){return e.circularLinkType=="top"});D(l,r,i);var u=e.links.filter(function(e){return e.circularLinkType=="bottom"});D(u,r,i);e.links.forEach(function(t){if(t.circular){t.circularPathData.arcRadius=t.width+A;t.circularPathData.leftNodeBuffer=o;t.circularPathData.rightNodeBuffer=o;t.circularPathData.sourceWidth=t.source.x1-t.source.x0;t.circularPathData.sourceX=t.source.x0+t.circularPathData.sourceWidth;t.circularPathData.targetX=t.target.x0;t.circularPathData.sourceY=t.y0;t.circularPathData.targetY=t.y1;if($(t,i)&&P(t)){t.circularPathData.leftSmallArcRadius=A+t.width/2;t.circularPathData.leftLargeArcRadius=A+t.width/2;t.circularPathData.rightSmallArcRadius=A+t.width/2;t.circularPathData.rightLargeArcRadius=A+t.width/2;if(t.circularLinkType=="bottom"){t.circularPathData.verticalFullExtent=t.source.y1+k+t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius}else{t.circularPathData.verticalFullExtent=t.source.y0-k-t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius}}else{var l=t.source.column;var u=t.circularLinkType;var c=e.links.filter(function(e){return e.source.column==l&&e.circularLinkType==u});if(t.circularLinkType=="bottom"){c.sort(B)}else{c.sort(F)}var f=0;c.forEach(function(e,n){if(e.circularLinkID==t.circularLinkID){t.circularPathData.leftSmallArcRadius=A+t.width/2+f;t.circularPathData.leftLargeArcRadius=A+t.width/2+n*r+f}f=f+e.width});l=t.target.column;c=e.links.filter(function(e){return e.target.column==l&&e.circularLinkType==u});if(t.circularLinkType=="bottom"){c.sort(U)}else{c.sort(j)}f=0;c.forEach(function(e,n){if(e.circularLinkID==t.circularLinkID){t.circularPathData.rightSmallArcRadius=A+t.width/2+f;t.circularPathData.rightLargeArcRadius=A+t.width/2+n*r+f}f=f+e.width});if(t.circularLinkType=="bottom"){t.circularPathData.verticalFullExtent=Math.max(a,t.source.y1,t.target.y1)+k+t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius}else{t.circularPathData.verticalFullExtent=s-k-t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius}}t.circularPathData.leftInnerExtent=t.circularPathData.sourceX+t.circularPathData.leftNodeBuffer;t.circularPathData.rightInnerExtent=t.circularPathData.targetX-t.circularPathData.rightNodeBuffer;t.circularPathData.leftFullExtent=t.circularPathData.sourceX+t.circularPathData.leftLargeArcRadius+t.circularPathData.leftNodeBuffer;t.circularPathData.rightFullExtent=t.circularPathData.targetX-t.circularPathData.rightLargeArcRadius-t.circularPathData.rightNodeBuffer}if(t.circular){t.path=z(t)}else{var h=n.linkHorizontal().source(function(e){var t=e.source.x0+(e.source.x1-e.source.x0);var r=e.y0;return[t,r]}).target(function(e){var t=e.target.x0;var r=e.y1;return[t,r]});t.path=h(t)}})}function z(e){var t="";if(e.circularLinkType=="top"){t="M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" "+"L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 0 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY-e.circularPathData.leftSmallArcRadius)+" "+"L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 0 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 0 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" "+"L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY-e.circularPathData.rightSmallArcRadius)+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 0 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" "+"L"+e.circularPathData.targetX+" "+e.circularPathData.targetY}else{t="M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" "+"L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 1 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY+e.circularPathData.leftSmallArcRadius)+" "+"L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 1 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 1 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" "+"L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY+e.circularPathData.rightSmallArcRadius)+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 1 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" "+"L"+e.circularPathData.targetX+" "+e.circularPathData.targetY}return t}function N(e,t){if(H(e)==H(t)){return e.circularLinkType=="bottom"?B(e,t):F(e,t)}else{return H(t)-H(e)}}function F(e,t){return e.y0-t.y0}function B(e,t){return t.y0-e.y0}function j(e,t){return e.y1-t.y1}function U(e,t){return t.y1-e.y1}function H(e){return e.target.column-e.source.column}function V(e){return e.target.x0-e.source.x1}function G(e,t){var r=L(e);var n=V(t)/Math.tan(r);var a=Q(e)=="up"?e.y1+n:e.y1-n;return a}function q(e,t){var r=L(e);var n=V(t)/Math.tan(r);var a=Q(e)=="up"?e.y1-n:e.y1+n;return a}function Y(e,t,r,n){e.links.forEach(function(a){if(a.circular){return}if(a.target.column-a.source.column>1){var i=a.source.column+1;var o=a.target.column-1;var s=1;var l=o-i+1;for(s=1;i<=o;i++,s++){e.nodes.forEach(function(o){if(o.column==i){var u=s/(l+1);var c=Math.pow(1-u,3);var f=3*u*Math.pow(1-u,2);var h=3*Math.pow(u,2)*(1-u);var p=Math.pow(u,3);var d=c*a.y0+f*a.y0+h*a.y1+p*a.y1;var v=d-a.width/2;var m=d+a.width/2;var g;if(v>o.y0&&v<o.y1){g=o.y1-v+10;g=o.circularLinkType=="bottom"?g:-g;o=X(o,g,t,r);e.nodes.forEach(function(e){if(T(e,n)==T(o,n)||e.column!=o.column){return}if(W(o,e)){X(e,g,t,r)}})}else if(m>o.y0&&m<o.y1){g=m-o.y0+10;o=X(o,g,t,r);e.nodes.forEach(function(e){if(T(e,n)==T(o,n)||e.column!=o.column){return}if(e.y0<o.y1&&e.y1>o.y1){X(e,g,t,r)}})}else if(v<o.y0&&m>o.y1){g=m-o.y0+10;o=X(o,g,t,r);e.nodes.forEach(function(e){if(T(e,n)==T(o,n)||e.column!=o.column){return}if(e.y0<o.y1&&e.y1>o.y1){X(e,g,t,r)}})}}})}}})}function W(e,t){if(e.y0>t.y0&&e.y0<t.y1){return true}else if(e.y1>t.y0&&e.y1<t.y1){return true}else if(e.y0<t.y0&&e.y1>t.y1){return true}else{return false}}function X(e,t,r,n){if(e.y0+t>=r&&e.y1+t<=n){e.y0=e.y0+t;e.y1=e.y1+t;e.targetLinks.forEach(function(e){e.y1=e.y1+t});e.sourceLinks.forEach(function(e){e.y0=e.y0+t})}return e}function Z(e,t,r,n){e.nodes.forEach(function(a){if(n&&a.y+(a.y1-a.y0)>t){a.y=a.y-(a.y+(a.y1-a.y0)-t)}var i=e.links.filter(function(e){return T(e.source,r)==T(a,r)});var o=i.length;if(o>1){i.sort(function(e,t){if(!e.circular&&!t.circular){if(e.target.column==t.target.column){return e.y1-t.y1}else if(!J(e,t)){return e.y1-t.y1}else{if(e.target.column>t.target.column){var r=q(t,e);return e.y1-r}if(t.target.column>e.target.column){var n=q(e,t);return n-t.y1}}}if(e.circular&&!t.circular){return e.circularLinkType=="top"?-1:1}else if(t.circular&&!e.circular){return t.circularLinkType=="top"?1:-1}if(e.circular&&t.circular){if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="top"){if(e.target.column===t.target.column){return e.target.y1-t.target.y1}else{return t.target.column-e.target.column}}else if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="bottom"){if(e.target.column===t.target.column){return t.target.y1-e.target.y1}else{return e.target.column-t.target.column}}else{return e.circularLinkType=="top"?-1:1}}})}var s=a.y0;i.forEach(function(e){e.y0=s+e.width/2;s=s+e.width});i.forEach(function(e,t){if(e.circularLinkType=="bottom"){var r=t+1;var n=0;for(r;r<o;r++){n=n+i[r].width}e.y0=a.y1-n-e.width/2}})})}function K(e,t,r){e.nodes.forEach(function(t){var n=e.links.filter(function(e){return T(e.target,r)==T(t,r)});var a=n.length;if(a>1){n.sort(function(e,t){if(!e.circular&&!t.circular){if(e.source.column==t.source.column){return e.y0-t.y0}else if(!J(e,t)){return e.y0-t.y0}else{if(t.source.column<e.source.column){var r=G(t,e);return e.y0-r}if(e.source.column<t.source.column){var n=G(e,t);return n-t.y0}}}if(e.circular&&!t.circular){return e.circularLinkType=="top"?-1:1}else if(t.circular&&!e.circular){return t.circularLinkType=="top"?1:-1}if(e.circular&&t.circular){if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="top"){if(e.source.column===t.source.column){return e.source.y1-t.source.y1}else{return e.source.column-t.source.column}}else if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="bottom"){if(e.source.column===t.source.column){return e.source.y1-t.source.y1}else{return t.source.column-e.source.column}}else{return e.circularLinkType=="top"?-1:1}}})}var i=t.y0;n.forEach(function(e){e.y1=i+e.width/2;i=i+e.width});n.forEach(function(e,r){if(e.circularLinkType=="bottom"){var i=r+1;var o=0;for(i;i<a;i++){o=o+n[i].width}e.y1=t.y1-o-e.width/2}})})}function J(e,t){return Q(e)==Q(t)}function Q(e){return e.y0-e.y1>0?"up":"down"}function $(e,t){return T(e.source,t)==T(e.target,t)}function ee(e,r,n){var a=e.nodes;var i=e.links;var o=false;var s=false;i.forEach(function(e){if(e.circularLinkType=="top"){o=true}else if(e.circularLinkType=="bottom"){s=true}});if(o==false||s==false){var l=t.min(a,function(e){return e.y0});var u=t.max(a,function(e){return e.y1});var c=u-l;var f=n-r;var h=f/c;a.forEach(function(e){var t=(e.y1-e.y0)*h;e.y0=(e.y0-l)*h;e.y1=e.y0+t});i.forEach(function(e){e.y0=(e.y0-l)*h;e.y1=(e.y1-l)*h;e.width=e.width*h})}}e.sankeyCircular=E;e.sankeyCenter=u;e.sankeyLeft=o;e.sankeyRight=s;e.sankeyJustify=l;Object.defineProperty(e,"__esModule",{value:true})})},{"d3-array":156,"d3-collection":157,"d3-shape":165,"elementary-circuits-directed-graph":179}],56:[function(t,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,t("d3-array"),t("d3-collection"),t("d3-shape")):typeof e==="function"&&e.amd?e(["exports","d3-array","d3-collection","d3-shape"],i):i(a.d3=a.d3||{},a.d3,a.d3,a.d3)})(this,function(e,t,r,n){"use strict";function a(e){return e.target.depth}function i(e){return e.depth}function o(e,t){return t-1-e.height}function s(e,t){return e.sourceLinks.length?e.depth:t-1}function l(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,a)-1:0}function u(e){return function(){return e}}function c(e,t){return h(e.source,t.source)||e.index-t.index}function f(e,t){return h(e.target,t.target)||e.index-t.index}function h(e,t){return e.y0-t.y0}function p(e){return e.value}function d(e){return(e.y0+e.y1)/2}function v(e){return d(e.source)*e.value}function m(e){return d(e.target)*e.value}function g(e){return e.index}function y(e){return e.nodes}function x(e){return e.links}function _(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}var b=function(){var e=0,n=0,a=1,i=1,o=24,l=8,b=g,w=s,T=y,k=x,A=32,M=2/3;function E(){var e={nodes:T.apply(null,arguments),links:k.apply(null,arguments)};S(e);C(e);L(e);I(e,A);O(e);return e}E.update=function(e){O(e);return e};E.nodeId=function(e){return arguments.length?(b=typeof e==="function"?e:u(e),E):b};E.nodeAlign=function(e){return arguments.length?(w=typeof e==="function"?e:u(e),E):w};E.nodeWidth=function(e){return arguments.length?(o=+e,E):o};E.nodePadding=function(e){return arguments.length?(l=+e,E):l};E.nodes=function(e){return arguments.length?(T=typeof e==="function"?e:u(e),E):T};E.links=function(e){return arguments.length?(k=typeof e==="function"?e:u(e),E):k};E.size=function(t){return arguments.length?(e=n=0,a=+t[0],i=+t[1],E):[a-e,i-n]};E.extent=function(t){return arguments.length?(e=+t[0][0],a=+t[1][0],n=+t[0][1],i=+t[1][1],E):[[e,n],[a,i]]};E.iterations=function(e){return arguments.length?(A=+e,E):A};function S(e){e.nodes.forEach(function(e,t){e.index=t;e.sourceLinks=[];e.targetLinks=[]});var t=r.map(e.nodes,b);e.links.forEach(function(e,r){e.index=r;var n=e.source,a=e.target;if(typeof n!=="object")n=e.source=_(t,n);if(typeof a!=="object")a=e.target=_(t,a);n.sourceLinks.push(e);a.targetLinks.push(e)})}function C(e){e.nodes.forEach(function(e){e.value=Math.max(t.sum(e.sourceLinks,p),t.sum(e.targetLinks,p))})}function L(t){var r,n,i;for(r=t.nodes,n=[],i=0;r.length;++i,r=n,n=[]){r.forEach(function(e){e.depth=i;e.sourceLinks.forEach(function(e){if(n.indexOf(e.target)<0){n.push(e.target)}})})}for(r=t.nodes,n=[],i=0;r.length;++i,r=n,n=[]){r.forEach(function(e){e.height=i;e.targetLinks.forEach(function(e){if(n.indexOf(e.source)<0){n.push(e.source)}})})}var s=(a-e-o)/(i-1);t.nodes.forEach(function(t){t.x1=(t.x0=e+Math.max(0,Math.min(i-1,Math.floor(w.call(null,t,i))))*s)+o})}function I(e){var a=r.nest().key(function(e){return e.x0}).sortKeys(t.ascending).entries(e.nodes).map(function(e){return e.values});u();g();for(var o=1,s=A;s>0;--s){f(o*=.99);g();c(o);g()}function u(){var r=t.max(a,function(e){return e.length});var o=M*(i-n)/(r-1);if(l>o)l=o;var s=t.min(a,function(e){return(i-n-(e.length-1)*l)/t.sum(e,p)});a.forEach(function(e){e.forEach(function(e,t){e.y1=(e.y0=t)+e.value*s})});e.links.forEach(function(e){e.width=e.value*s})}function c(e){a.forEach(function(r){r.forEach(function(r){if(r.targetLinks.length){var n=(t.sum(r.targetLinks,v)/t.sum(r.targetLinks,p)-d(r))*e;r.y0+=n,r.y1+=n}})})}function f(e){a.slice().reverse().forEach(function(r){r.forEach(function(r){if(r.sourceLinks.length){var n=(t.sum(r.sourceLinks,m)/t.sum(r.sourceLinks,p)-d(r))*e;r.y0+=n,r.y1+=n}})})}function g(){a.forEach(function(e){var t,r,a=n,o=e.length,s;e.sort(h);for(s=0;s<o;++s){t=e[s];r=a-t.y0;if(r>0)t.y0+=r,t.y1+=r;a=t.y1+l}r=a-l-i;if(r>0){a=t.y0-=r,t.y1-=r;for(s=o-2;s>=0;--s){t=e[s];r=t.y1+l-a;if(r>0)t.y0-=r,t.y1-=r;a=t.y0}}})}}function O(e){e.nodes.forEach(function(e){e.sourceLinks.sort(f);e.targetLinks.sort(c)});e.nodes.forEach(function(e){var t=e.y0,r=t;e.sourceLinks.forEach(function(e){e.y0=t+e.width/2,t+=e.width});e.targetLinks.forEach(function(e){e.y1=r+e.width/2,r+=e.width})})}return E};function w(e){return[e.source.x1,e.y0]}function T(e){return[e.target.x0,e.y1]}var k=function(){return n.linkHorizontal().source(w).target(T)};e.sankey=b;e.sankeyCenter=l;e.sankeyLeft=i;e.sankeyRight=o;e.sankeyJustify=s;e.sankeyLinkHorizontal=k;Object.defineProperty(e,"__esModule",{value:true})})},{"d3-array":156,"d3-collection":157,"d3-shape":165}],57:[function(e,t,r){"use strict";t.exports=e("./quad")},{"./quad":58}],58:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var a=e("clamp");var i=e("parse-rect");var o=e("array-bounds");var s=e("pick-by-alias");var l=e("defined");var u=e("flatten-vertex-data");var c=e("is-obj");var f=e("dtype");var h=e("math-log2");var p=1073741824;t.exports=function e(t,r){if(!r){r={}}t=u(t,"float64");r=s(r,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var a=l(r.maxDepth,255);var v=l(r.bounds,o(t,2));if(v[0]===v[2]){v[2]++}if(v[1]===v[3]){v[3]++}var m=d(t,v);var g=t.length>>>1;var y;if(!r.dtype){r.dtype="array"}if(typeof r.dtype==="string"){y=new(f(r.dtype))(g)}else if(r.dtype){y=r.dtype;if(Array.isArray(y)){y.length=g}}for(var x=0;x<g;++x){y[x]=x}var _=[];var b=[];var w=[];var T=[];L(0,0,1,y,0,1);var k=0;for(var A=0;A<_.length;A++){var M=_[A];if(y.set){y.set(M,k)}else{for(var E=0,S=M.length;E<S;E++){y[E+k]=M[E]}}var C=k+_[A].length;T[A]=[k,C];k=C}y.range=I;return y;function L(e,t,r,n,i,o){if(!n.length){return null}var s=_[i]||(_[i]=[]);var l=w[i]||(w[i]=[]);var u=b[i]||(b[i]=[]);var c=s.length;i++;if(i>a||o>p){for(var f=0;f<n.length;f++){s.push(n[f]);l.push(o);u.push(null,null,null,null)}return c}s.push(n[0]);l.push(o);if(n.length<=1){u.push(null,null,null,null);return c}var h=r*.5;var d=e+h,v=t+h;var g=[],y=[],x=[],T=[];for(var k=1,A=n.length;k<A;k++){var M=n[k],E=m[M*2],S=m[M*2+1];E<d?S<v?g.push(M):y.push(M):S<v?x.push(M):T.push(M)}o<<=2;u.push(L(e,t,h,g,i,o),L(e,v,h,y,i,o+1),L(d,t,h,x,i,o+2),L(d,v,h,T,i,o+3));return c}function I(){var e=[],r=arguments.length;while(r--)e[r]=arguments[r];var n;if(c(e[e.length-1])){var a=e.pop();if(!e.length&&(a.x!=null||a.l!=null||a.left!=null)){e=[a];n={}}n=s(a,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else{n={}}if(!e.length){e=v}var o=i.apply(void 0,e);var u=[Math.min(o.x,o.x+o.width),Math.min(o.y,o.y+o.height),Math.max(o.x,o.x+o.width),Math.max(o.y,o.y+o.height)];var f=u[0];var p=u[1];var m=u[2];var g=u[3];var y=d([f,p,m,g],v);var x=y[0];var w=y[1];var T=y[2];var k=y[3];var A=l(n.level,_.length);if(n.d!=null){var M;if(typeof n.d==="number"){M=[n.d,n.d]}else if(n.d.length){M=n.d}A=Math.min(Math.max(Math.ceil(-h(Math.abs(M[0])/(v[2]-v[0]))),Math.ceil(-h(Math.abs(M[1])/(v[3]-v[1])))),A)}A=Math.min(A,_.length);if(n.lod){return O(x,w,T,k,A)}var E=[];S(0,0,1,0,0,1);function S(e,r,n,a,i,o){if(i===null||o===null){return}var s=e+n;var l=r+n;if(x>s||w>l||T<e||k<r){return}if(a>=A){return}if(i===o){return}var u=_[a];if(o===undefined){o=u.length}for(var c=i;c<o;c++){var h=u[c];var d=t[h*2];var v=t[h*2+1];if(d>=f&&d<=m&&v>=p&&v<=g){E.push(h)}}var y=b[a];var M=y[i*4+0];var L=y[i*4+1];var I=y[i*4+2];var O=y[i*4+3];var P=C(y,i+1);var D=n*.5;var R=a+1;S(e,r,D,R,M,L||I||O||P);S(e,r+D,D,R,L,I||O||P);S(e+D,r,D,R,I,O||P);S(e+D,r+D,D,R,O,P)}function C(e,t){var r=null,n=0;while(r===null){r=e[t*4+n];n++;if(n>e.length){return null}}return r}return E}function O(e,t,r,a,i){var o=[];for(var s=0;s<i;s++){var l=w[s];var u=T[s][0];var c=P(e,t,s);var f=P(r,a,s);var h=n.ge(l,c);var p=n.gt(l,f,h,l.length-1);o[s]=[h+u,p+u]}return o}function P(e,t,r){var n=1;var a=.5,i=.5;var o=.5;for(var s=0;s<r;s++){n<<=2;n+=e<a?t<i?0:1:t<i?2:3;o*=.5;a+=e<a?-o:o;i+=t<i?-o:o}return n}};function d(e,t){var r=t[0];var n=t[1];var i=t[2];var o=t[3];var s=1/(i-r);var l=1/(o-n);var u=new Array(e.length);for(var c=0,f=e.length/2;c<f;c++){u[2*c]=a((e[2*c]-r)*s,0,1);u[2*c+1]=a((e[2*c+1]-n)*l,0,1)}return u}},{"array-bounds":70,"binary-search-bounds":96,clamp:120,defined:170,dtype:175,"flatten-vertex-data":244,"is-obj":468,"math-log2":479,"parse-rect":504,"pick-by-alias":511}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=e("@turf/meta");var a=6378137;function i(e){return n.geomReduce(e,function(e,t){return e+o(t)},0)}r.default=i;function o(e){var t=0;var r;switch(e.type){case"Polygon":return s(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++){t+=s(e.coordinates[r])}return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function s(e){var t=0;if(e&&e.length>0){t+=Math.abs(l(e[0]));for(var r=1;r<e.length;r++){t-=Math.abs(l(e[r]))}}return t}function l(e){var t;var r;var n;var i;var o;var s;var l;var c=0;var f=e.length;if(f>2){for(l=0;l<f;l++){if(l===f-2){i=f-2;o=f-1;s=0}else if(l===f-1){i=f-1;o=0;s=1}else{i=l;o=l+1;s=l+2}t=e[i];r=e[o];n=e[s];c+=(u(n[0])-u(t[0]))*Math.sin(u(r[1]))}c=c*a*a/2}return c}function u(e){return e*Math.PI/180}},{"@turf/meta":63}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=e("@turf/meta");function a(e){var t=[Infinity,Infinity,-Infinity,-Infinity];n.coordEach(e,function(e){if(t[0]>e[0]){t[0]=e[0]}if(t[1]>e[1]){t[1]=e[1]}if(t[2]<e[0]){t[2]=e[0]}if(t[3]<e[1]){t[3]=e[1]}});return t}r.default=a},{"@turf/meta":63}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=e("@turf/meta");var a=e("@turf/helpers");function i(e,t){if(t===void 0){t={}}var r=0;var i=0;var o=0;n.coordEach(e,function(e){r+=e[0];i+=e[1];o++});return a.point([r/o,i/o],t.properties)}r.default=i},{"@turf/helpers":62,"@turf/meta":63}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.earthRadius=6371008.8;r.factors={centimeters:r.earthRadius*100,centimetres:r.earthRadius*100,degrees:r.earthRadius/111325,feet:r.earthRadius*3.28084,inches:r.earthRadius*39.37,kilometers:r.earthRadius/1e3,kilometres:r.earthRadius/1e3,meters:r.earthRadius,metres:r.earthRadius,miles:r.earthRadius/1609.344,millimeters:r.earthRadius*1e3,millimetres:r.earthRadius*1e3,nauticalmiles:r.earthRadius/1852,radians:1,yards:r.earthRadius/1.0936};r.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/r.earthRadius,yards:1/1.0936};r.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046};function n(e,t,r){if(r===void 0){r={}}var n={type:"Feature"};if(r.id===0||r.id){n.id=r.id}if(r.bbox){n.bbox=r.bbox}n.properties=t||{};n.geometry=e;return n}r.feature=n;function a(e,t,r){if(r===void 0){r={}}switch(e){case"Point":return i(t).geometry;case"LineString":return u(t).geometry;case"Polygon":return s(t).geometry;case"MultiPoint":return p(t).geometry;case"MultiLineString":return h(t).geometry;case"MultiPolygon":return d(t).geometry;default:throw new Error(e+" is invalid")}}r.geometry=a;function i(e,t,r){if(r===void 0){r={}}var a={type:"Point",coordinates:e};return n(a,t,r)}r.point=i;function o(e,t,r){if(r===void 0){r={}}return f(e.map(function(e){return i(e,t)}),r)}r.points=o;function s(e,t,r){if(r===void 0){r={}}for(var a=0,i=e;a<i.length;a++){var o=i[a];if(o.length<4){throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.")}for(var s=0;s<o[o.length-1].length;s++){if(o[o.length-1][s]!==o[0][s]){throw new Error("First and last Position are not equivalent.")}}}var l={type:"Polygon",coordinates:e};return n(l,t,r)}r.polygon=s;function l(e,t,r){if(r===void 0){r={}}return f(e.map(function(e){return s(e,t)}),r)}r.polygons=l;function u(e,t,r){if(r===void 0){r={}}if(e.length<2){throw new Error("coordinates must be an array of two or more positions")}var a={type:"LineString",coordinates:e};return n(a,t,r)}r.lineString=u;function c(e,t,r){if(r===void 0){r={}}return f(e.map(function(e){return u(e,t)}),r)}r.lineStrings=c;function f(e,t){if(t===void 0){t={}}var r={type:"FeatureCollection"};if(t.id){r.id=t.id}if(t.bbox){r.bbox=t.bbox}r.features=e;return r}r.featureCollection=f;function h(e,t,r){if(r===void 0){r={}}var a={type:"MultiLineString",coordinates:e};return n(a,t,r)}r.multiLineString=h;function p(e,t,r){if(r===void 0){r={}}var a={type:"MultiPoint",coordinates:e};return n(a,t,r)}r.multiPoint=p;function d(e,t,r){if(r===void 0){r={}}var a={type:"MultiPolygon",coordinates:e};return n(a,t,r)}r.multiPolygon=d;function v(e,t,r){if(r===void 0){r={}}var a={type:"GeometryCollection",geometries:e};return n(a,t,r)}r.geometryCollection=v;function m(e,t){if(t===void 0){t=0}if(t&&!(t>=0)){throw new Error("precision must be a positive number")}var r=Math.pow(10,t||0);return Math.round(e*r)/r}r.round=m;function g(e,t){if(t===void 0){t="kilometers"}var n=r.factors[t];if(!n){throw new Error(t+" units is invalid")}return e*n}r.radiansToLength=g;function y(e,t){if(t===void 0){t="kilometers"}var n=r.factors[t];if(!n){throw new Error(t+" units is invalid")}return e/n}r.lengthToRadians=y;function x(e,t){return b(y(e,t))}r.lengthToDegrees=x;function _(e){var t=e%360;if(t<0){t+=360}return t}r.bearingToAzimuth=_;function b(e){var t=e%(2*Math.PI);return t*180/Math.PI}r.radiansToDegrees=b;function w(e){var t=e%360;return t*Math.PI/180}r.degreesToRadians=w;function T(e,t,r){if(t===void 0){t="kilometers"}if(r===void 0){r="kilometers"}if(!(e>=0)){throw new Error("length must be a positive number")}return g(y(e,t),r)}r.convertLength=T;function k(e,t,n){if(t===void 0){t="meters"}if(n===void 0){n="kilometers"}if(!(e>=0)){throw new Error("area must be a positive number")}var a=r.areaFactors[t];if(!a){throw new Error("invalid original units")}var i=r.areaFactors[n];if(!i){throw new Error("invalid final units")}return e/a*i}r.convertArea=k;function A(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)&&!/^\s*$/.test(e)}r.isNumber=A;function M(e){return!!e&&e.constructor===Object}r.isObject=M;function E(e){if(!e){throw new Error("bbox is required")}if(!Array.isArray(e)){throw new Error("bbox must be an Array")}if(e.length!==4&&e.length!==6){throw new Error("bbox must be an Array of 4 or 6 numbers")}e.forEach(function(e){if(!A(e)){throw new Error("bbox must only contain numbers")}})}r.validateBBox=E;function S(e){if(!e){throw new Error("id is required")}if(["string","number"].indexOf(typeof e)===-1){throw new Error("id must be a number or a string")}}r.validateId=S;function C(){throw new Error("method has been renamed to `radiansToDegrees`")}r.radians2degrees=C;function L(){throw new Error("method has been renamed to `degreesToRadians`")}r.degrees2radians=L;function I(){throw new Error("method has been renamed to `lengthToDegrees`")}r.distanceToDegrees=I;function O(){throw new Error("method has been renamed to `lengthToRadians`")}r.distanceToRadians=O;function P(){throw new Error("method has been renamed to `radiansToLength`")}r.radiansToDistance=P;function D(){throw new Error("method has been renamed to `bearingToAzimuth`")}r.bearingToAngle=D;function R(){throw new Error("method has been renamed to `convertLength`")}r.convertDistance=R},{}],63:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=e("@turf/helpers");function a(e,t,r){if(e===null)return;var n,i,o,s,l,u,c,f=0,h=0,p,d=e.type,v=d==="FeatureCollection",m=d==="Feature",g=v?e.features.length:1;for(var y=0;y<g;y++){c=v?e.features[y].geometry:m?e.geometry:e;p=c?c.type==="GeometryCollection":false;l=p?c.geometries.length:1;for(var x=0;x<l;x++){var _=0;var b=0;s=p?c.geometries[x]:c;if(s===null)continue;u=s.coordinates;var w=s.type;f=r&&(w==="Polygon"||w==="MultiPolygon")?1:0;switch(w){case null:break;case"Point":if(t(u,h,y,_,b)===false)return false;h++;_++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(t(u[n],h,y,_,b)===false)return false;h++;if(w==="MultiPoint")_++}if(w==="LineString")_++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(i=0;i<u[n].length-f;i++){if(t(u[n][i],h,y,_,b)===false)return false;h++}if(w==="MultiLineString")_++;if(w==="Polygon")b++}if(w==="Polygon")_++;break;case"MultiPolygon":for(n=0;n<u.length;n++){b=0;for(i=0;i<u[n].length;i++){for(o=0;o<u[n][i].length-f;o++){if(t(u[n][i][o],h,y,_,b)===false)return false;h++}b++}_++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(a(s.geometries[n],t,r)===false)return false;break;default:throw new Error("Unknown Geometry Type")}}}}function i(e,t,r,n){var i=r;a(e,function(e,n,a,o,s){if(n===0&&r===undefined)i=e;else i=t(i,e,n,a,o,s)},n);return i}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length;r++){if(t(e.features[r].properties,r)===false)break}break;case"Feature":t(e.properties,0);break}}function s(e,t,r){var n=r;o(e,function(e,a){if(a===0&&r===undefined)n=e;else n=t(n,e,a)});return n}function l(e,t){if(e.type==="Feature"){t(e,0)}else if(e.type==="FeatureCollection"){for(var r=0;r<e.features.length;r++){if(t(e.features[r],r)===false)break}}}function u(e,t,r){var n=r;l(e,function(e,a){if(a===0&&r===undefined)n=e;else n=t(n,e,a)});return n}function c(e){var t=[];a(e,function(e){t.push(e)});return t}function f(e,t){var r,n,a,i,o,s,l,u,c,f,h=0,p=e.type==="FeatureCollection",d=e.type==="Feature",v=p?e.features.length:1;for(r=0;r<v;r++){s=p?e.features[r].geometry:d?e.geometry:e;u=p?e.features[r].properties:d?e.properties:{};c=p?e.features[r].bbox:d?e.bbox:undefined;f=p?e.features[r].id:d?e.id:undefined;l=s?s.type==="GeometryCollection":false;o=l?s.geometries.length:1;for(a=0;a<o;a++){i=l?s.geometries[a]:s;if(i===null){if(t(null,h,u,c,f)===false)return false;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(i,h,u,c,f)===false)return false;break}case"GeometryCollection":{for(n=0;n<i.geometries.length;n++){if(t(i.geometries[n],h,u,c,f)===false)return false}break}default:throw new Error("Unknown Geometry Type")}}h++}}function h(e,t,r){var n=r;f(e,function(e,a,i,o,s){if(a===0&&r===undefined)n=e;else n=t(n,e,a,i,o,s)});return n}function p(e,t){f(e,function(e,r,a,i,o){var s=e===null?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":if(t(n.feature(e,a,{bbox:i,id:o}),r,0)===false)return false;return}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<e.coordinates.length;u++){var c=e.coordinates[u];var f={type:l,coordinates:c};if(t(n.feature(f,a),r,u)===false)return false}})}function d(e,t,r){var n=r;p(e,function(e,a,i){if(a===0&&i===0&&r===undefined)n=e;else n=t(n,e,a,i)});return n}function v(e,t){p(e,function(e,r,i){var o=0;if(!e.geometry)return;var s=e.geometry.type;if(s==="Point"||s==="MultiPoint")return;var l;var u=0;var c=0;var f=0;if(a(e,function(a,s,h,p,d){if(l===undefined||r>u||p>c||d>f){l=a;u=r;c=p;f=d;o=0;return}var v=n.lineString([l,a],e.properties);if(t(v,r,i,d,o)===false)return false;o++;l=a})===false)return false})}function m(e,t,r){var n=r;var a=false;v(e,function(e,i,o,s,l){if(a===false&&r===undefined)n=e;else n=t(n,e,i,o,s,l);a=true});return n}function g(e,t){if(!e)throw new Error("geojson is required");p(e,function(e,r,a){if(e.geometry===null)return;var i=e.geometry.type;var o=e.geometry.coordinates;switch(i){case"LineString":if(t(e,r,a,0,0)===false)return false;break;case"Polygon":for(var s=0;s<o.length;s++){if(t(n.lineString(o[s],e.properties),r,a,s)===false)return false}break}})}function y(e,t,r){var n=r;g(e,function(e,a,i,o){if(a===0&&r===undefined)n=e;else n=t(n,e,a,i,o)});return n}function x(e,t){t=t||{};if(!n.isObject(t))throw new Error("options is invalid");var r=t.featureIndex||0;var a=t.multiFeatureIndex||0;var i=t.geometryIndex||0;var o=t.segmentIndex||0;var s=t.properties;var l;switch(e.type){case"FeatureCollection":if(r<0)r=e.features.length+r;s=s||e.features[r].properties;l=e.features[r].geometry;break;case"Feature":s=s||e.properties;l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var u=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":if(o<0)o=u.length+o-1;return n.lineString([u[o],u[o+1]],s,t);case"Polygon":if(i<0)i=u.length+i;if(o<0)o=u[i].length+o-1;return n.lineString([u[i][o],u[i][o+1]],s,t);case"MultiLineString":if(a<0)a=u.length+a;if(o<0)o=u[a].length+o-1;return n.lineString([u[a][o],u[a][o+1]],s,t);case"MultiPolygon":if(a<0)a=u.length+a;if(i<0)i=u[a].length+i;if(o<0)o=u[a][i].length-o-1;return n.lineString([u[a][i][o],u[a][i][o+1]],s,t)}throw new Error("geojson is invalid")}function _(e,t){t=t||{};if(!n.isObject(t))throw new Error("options is invalid");var r=t.featureIndex||0;var a=t.multiFeatureIndex||0;var i=t.geometryIndex||0;var o=t.coordIndex||0;var s=t.properties;var l;switch(e.type){case"FeatureCollection":if(r<0)r=e.features.length+r;s=s||e.features[r].properties;l=e.features[r].geometry;break;case"Feature":s=s||e.properties;l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var u=l.coordinates;switch(l.type){case"Point":return n.point(u,s,t);case"MultiPoint":if(a<0)a=u.length+a;return n.point(u[a],s,t);case"LineString":if(o<0)o=u.length+o;return n.point(u[o],s,t);case"Polygon":if(i<0)i=u.length+i;if(o<0)o=u[i].length+o;return n.point(u[i][o],s,t);case"MultiLineString":if(a<0)a=u.length+a;if(o<0)o=u[a].length+o;return n.point(u[a][o],s,t);case"MultiPolygon":if(a<0)a=u.length+a;if(i<0)i=u[a].length+i;if(o<0)o=u[a][i].length-o;return n.point(u[a][i][o],s,t)}throw new Error("geojson is invalid")}r.coordEach=a;r.coordReduce=i;r.propEach=o;r.propReduce=s;r.featureEach=l;r.featureReduce=u;r.coordAll=c;r.geomEach=f;r.geomReduce=h;r.flattenEach=p;r.flattenReduce=d;r.segmentEach=v;r.segmentReduce=m;r.lineEach=g;r.lineReduce=y;r.findSegment=x;r.findPoint=_},{"@turf/helpers":62}],64:[function(e,t,r){"use strict";var n=typeof WeakMap==="undefined"?e("weak-map"):WeakMap;var a=e("gl-buffer");var i=e("gl-vao");var o=new n;function s(e){var t=o.get(e);var r=t&&(t._triangleBuffer.handle||t._triangleBuffer.buffer);if(!r||!e.isBuffer(r)){var n=a(e,new Float32Array([-1,-1,-1,4,4,-1]));t=i(e,[{buffer:n,type:e.FLOAT,size:2}]);t._triangleBuffer=n;o.set(e,t)}t.bind();e.drawArrays(e.TRIANGLES,0,3);t.unbind()}t.exports=s},{"gl-buffer":259,"gl-vao":358,"weak-map":602}],65:[function(e,t,r){t.exports=n;function n(e){var t=0;var r=0;var n=0;var a=0;return e.map(function(e){e=e.slice();var i=e[0];var o=i.toUpperCase();if(i!=o){e[0]=o;switch(i){case"a":e[6]+=n;e[7]+=a;break;case"v":e[1]+=a;break;case"h":e[1]+=n;break;default:for(var s=1;s<e.length;){e[s++]+=n;e[s++]+=a}}}switch(o){case"Z":n=t;a=r;break;case"H":n=e[1];break;case"V":a=e[1];break;case"M":n=t=e[1];a=r=e[2];break;default:n=e[e.length-2];a=e[e.length-1]}return e})}},{}],66:[function(e,t,r){var n=e("pad-left");t.exports=a;function a(e,t,r){t=typeof t==="number"?t:1;r=r||": ";var a=e.split(/\r?\n/);var i=String(a.length+t-1).length;return a.map(function(e,a){var o=a+t;var s=String(o).length;var l=n(o,i-s);return l+r+e}).join("\n")}},{"pad-left":502}],67:[function(e,t,r){"use strict";t.exports=i;var n=e("robust-orientation");function a(e,t){var r=new Array(t+1);for(var a=0;a<e.length;++a){r[a]=e[a]}for(var a=0;a<=e.length;++a){for(var i=e.length;i<=t;++i){var o=new Array(t);for(var s=0;s<t;++s){o[s]=Math.pow(i+1-a,s)}r[i]=o}var l=n.apply(void 0,r);if(l){return true}}return false}function i(e){var t=e.length;if(t===0){return[]}if(t===1){return[0]}var r=e[0].length;var n=[e[0]];var i=[0];for(var o=1;o<t;++o){n.push(e[o]);if(!a(n,r)){n.pop();continue}i.push(o);if(i.length===r+1){return i}}return i}},{"robust-orientation":548}],68:[function(e,t,r){"use strict";t.exports=i;var n=e("delaunay-triangulate");var a=e("circumradius");function i(e,t){return n(t).filter(function(r){var n=new Array(r.length);for(var i=0;i<r.length;++i){n[i]=t[r[i]]}return a(n)*e<1})}},{circumradius:119,"delaunay-triangulate":171}],69:[function(e,t,r){t.exports=i;var n=e("alpha-complex");var a=e("simplicial-complex-boundary");function i(e,t){return a(n(e,t))}},{"alpha-complex":68,"simplicial-complex-boundary":555}],70:[function(e,t,r){"use strict";t.exports=n;function n(e,t){if(!e||e.length==null)throw Error("Argument should be an array");if(t==null)t=1;else t=Math.floor(t);var r=Array(t*2);for(var n=0;n<t;n++){var a=-Infinity,i=Infinity,o=n,s=e.length;for(;o<s;o+=t){if(e[o]>a)a=e[o];if(e[o]<i)i=e[o]}r[n]=i;r[t+n]=a}return r}},{}],71:[function(e,t,r){"use strict";var n=e("array-bounds");t.exports=a;function a(e,t,r){if(!e||e.length==null)throw Error("Argument should be an array");if(t==null)t=1;if(r==null)r=n(e,t);for(var a=0;a<t;a++){var i=r[t+a],o=r[a],s=a,l=e.length;if(i===Infinity&&o===-Infinity){for(s=a;s<l;s+=t){e[s]=e[s]===i?1:e[s]===o?0:.5}}else if(i===Infinity){for(s=a;s<l;s+=t){e[s]=e[s]===i?1:0}}else if(o===-Infinity){for(s=a;s<l;s+=t){e[s]=e[s]===o?0:1}}else{var u=i-o;for(s=a;s<l;s+=t){if(!isNaN(e[s])){e[s]=u===0?.5:(e[s]-o)/u}}}}return e}},{"array-bounds":70}],72:[function(e,t,r){t.exports=function e(t,r){var n=typeof t==="number",a=typeof r==="number";if(n&&!a){r=t;t=0}else if(!n&&!a){t=0;r=0}t=t|0;r=r|0;var i=r-t;if(i<0)throw new Error("array length must be positive");var o=new Array(i);for(var s=0,l=t;s<i;s++,l++)o[s]=l;return o}},{}],73:[function(e,r,n){(function(t){(function(){"use strict";var n=e("object-assign");
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function a(e,t){if(e===t){return 0}var r=e.length;var n=t.length;for(var a=0,i=Math.min(r,n);a<i;++a){if(e[a]!==t[a]){r=e[a];n=t[a];break}}if(r<n){return-1}if(n<r){return 1}return 0}function i(e){if(t.Buffer&&typeof t.Buffer.isBuffer==="function"){return t.Buffer.isBuffer(e)}return!!(e!=null&&e._isBuffer)}var o=e("util/");var s=Object.prototype.hasOwnProperty;var l=Array.prototype.slice;var u=function(){return function e(){}.name==="foo"}();function c(e){return Object.prototype.toString.call(e)}function f(e){if(i(e)){return false}if(typeof t.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(e)}if(!e){return false}if(e instanceof DataView){return true}if(e.buffer&&e.buffer instanceof ArrayBuffer){return true}return false}var h=r.exports=x;var p=/\s*function\s+([^\(\s]*)\s*/;function d(e){if(!o.isFunction(e)){return}if(u){return e.name}var t=e.toString();var r=t.match(p);return r&&r[1]}h.AssertionError=function e(t){this.name="AssertionError";this.actual=t.actual;this.expected=t.expected;this.operator=t.operator;if(t.message){this.message=t.message;this.generatedMessage=false}else{this.message=g(this);this.generatedMessage=true}var r=t.stackStartFunction||y;if(Error.captureStackTrace){Error.captureStackTrace(this,r)}else{var n=new Error;if(n.stack){var a=n.stack;var i=d(r);var o=a.indexOf("\n"+i);if(o>=0){var s=a.indexOf("\n",o+1);a=a.substring(s+1)}this.stack=a}}};o.inherits(h.AssertionError,Error);function v(e,t){if(typeof e==="string"){return e.length<t?e:e.slice(0,t)}else{return e}}function m(e){if(u||!o.isFunction(e)){return o.inspect(e)}var t=d(e);var r=t?": "+t:"";return"[Function"+r+"]"}function g(e){return v(m(e.actual),128)+" "+e.operator+" "+v(m(e.expected),128)}function y(e,t,r,n,a){throw new h.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:a})}h.fail=y;function x(e,t){if(!e)y(e,true,t,"==",h.ok)}h.ok=x;h.equal=function e(t,r,n){if(t!=r)y(t,r,n,"==",h.equal)};h.notEqual=function e(t,r,n){if(t==r){y(t,r,n,"!=",h.notEqual)}};h.deepEqual=function e(t,r,n){if(!_(t,r,false)){y(t,r,n,"deepEqual",h.deepEqual)}};h.deepStrictEqual=function e(t,r,n){if(!_(t,r,true)){y(t,r,n,"deepStrictEqual",h.deepStrictEqual)}};function _(e,t,r,n){if(e===t){return true}else if(i(e)&&i(t)){return a(e,t)===0}else if(o.isDate(e)&&o.isDate(t)){return e.getTime()===t.getTime()}else if(o.isRegExp(e)&&o.isRegExp(t)){return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase}else if((e===null||typeof e!=="object")&&(t===null||typeof t!=="object")){return r?e===t:e==t}else if(f(e)&&f(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array)){return a(new Uint8Array(e.buffer),new Uint8Array(t.buffer))===0}else if(i(e)!==i(t)){return false}else{n=n||{actual:[],expected:[]};var s=n.actual.indexOf(e);if(s!==-1){if(s===n.expected.indexOf(t)){return true}}n.actual.push(e);n.expected.push(t);return w(e,t,r,n)}}function b(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function w(e,t,r,n){if(e===null||e===undefined||t===null||t===undefined)return false;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return false;var a=b(e);var i=b(t);if(a&&!i||!a&&i)return false;if(a){e=l.call(e);t=l.call(t);return _(e,t,r)}var s=S(e);var u=S(t);var c,f;if(s.length!==u.length)return false;s.sort();u.sort();for(f=s.length-1;f>=0;f--){if(s[f]!==u[f])return false}for(f=s.length-1;f>=0;f--){c=s[f];if(!_(e[c],t[c],r,n))return false}return true}h.notDeepEqual=function e(t,r,n){if(_(t,r,false)){y(t,r,n,"notDeepEqual",h.notDeepEqual)}};h.notDeepStrictEqual=T;function T(e,t,r){if(_(e,t,true)){y(e,t,r,"notDeepStrictEqual",T)}}h.strictEqual=function e(t,r,n){if(t!==r){y(t,r,n,"===",h.strictEqual)}};h.notStrictEqual=function e(t,r,n){if(t===r){y(t,r,n,"!==",h.notStrictEqual)}};function k(e,t){if(!e||!t){return false}if(Object.prototype.toString.call(t)=="[object RegExp]"){return t.test(e)}try{if(e instanceof t){return true}}catch(e){}if(Error.isPrototypeOf(t)){return false}return t.call({},e)===true}function A(e){var t;try{e()}catch(e){t=e}return t}function M(e,t,r,n){var a;if(typeof t!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof r==="string"){n=r;r=null}a=A(t);n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:".");if(e&&!a){y(a,r,"Missing expected exception"+n)}var i=typeof n==="string";var s=!e&&o.isError(a);var l=!e&&a&&!r;if(s&&i&&k(a,r)||l){y(a,r,"Got unwanted exception"+n)}if(e&&a&&r&&!k(a,r)||!e&&a){throw a}}h.throws=function(e,t,r){M(true,e,t,r)};h.doesNotThrow=function(e,t,r){M(false,e,t,r)};h.ifError=function(e){if(e)throw e};function E(e,t){if(!e)y(e,true,t,"==",E)}h.strict=n(E,h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual});h.strict.strict=h.strict;var S=Object.keys||function(e){var t=[];for(var r in e){if(s.call(e,r))t.push(r)}return t}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"object-assign":499,"util/":76}],74:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function e(t,r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function e(t,r){t.super_=r;var n=function(){};n.prototype=r.prototype;t.prototype=new n;t.prototype.constructor=t}}},{}],75:[function(e,t,r){t.exports=function e(t){return t&&typeof t==="object"&&typeof t.copy==="function"&&typeof t.fill==="function"&&typeof t.readUInt8==="function"}},{}],76:[function(e,r,n){(function(t,r){(function(){var a=/%[sdj%]/g;n.format=function(e){if(!w(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(s(arguments[r]))}return t.join(" ")}var r=1;var n=arguments;var i=n.length;var o=String(e).replace(a,function(e){if(e==="%%")return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}});for(var l=n[r];r<i;l=n[++r]){if(x(l)||!M(l)){o+=" "+l}else{o+=" "+s(l)}}return o};n.deprecate=function(e,a){if(k(r.process)){return function(){return n.deprecate(e,a).apply(this,arguments)}}if(t.noDeprecation===true){return e}var i=false;function o(){if(!i){if(t.throwDeprecation){throw new Error(a)}else if(t.traceDeprecation){console.trace(a)}else{console.error(a)}i=true}return e.apply(this,arguments)}return o};var i={};var o;n.debuglog=function(e){if(k(o))o=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!i[e]){if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=t.pid;i[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else{i[e]=function(){}}}return i[e]};function s(e,t){var r={seen:[],stylize:u};if(arguments.length>=3)r.depth=arguments[2];if(arguments.length>=4)r.colors=arguments[3];if(y(t)){r.showHidden=t}else if(t){n._extend(r,t)}if(k(r.showHidden))r.showHidden=false;if(k(r.depth))r.depth=2;if(k(r.colors))r.colors=false;if(k(r.customInspect))r.customInspect=true;if(r.colors)r.stylize=l;return f(r,e,r.depth)}n.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=s.styles[t];if(r){return"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m"}else{return e}}function u(e,t){return e}function c(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function f(e,t,r){if(e.customInspect&&t&&C(t.inspect)&&t.inspect!==n.inspect&&!(t.constructor&&t.constructor.prototype===t)){var a=t.inspect(r,e);if(!w(a)){a=f(e,a,r)}return a}var i=h(e,t);if(i){return i}var o=Object.keys(t);var s=c(o);if(e.showHidden){o=Object.getOwnPropertyNames(t)}if(S(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0)){return p(t)}if(o.length===0){if(C(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(A(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(E(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(S(t)){return p(t)}}var u="",y=false,x=["{","}"];if(g(t)){y=true;x=["[","]"]}if(C(t)){var _=t.name?": "+t.name:"";u=" [Function"+_+"]"}if(A(t)){u=" "+RegExp.prototype.toString.call(t)}if(E(t)){u=" "+Date.prototype.toUTCString.call(t)}if(S(t)){u=" "+p(t)}if(o.length===0&&(!y||t.length==0)){return x[0]+u+x[1]}if(r<0){if(A(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var b;if(y){b=d(e,t,r,s,o)}else{b=o.map(function(n){return v(e,t,r,s,n,y)})}e.seen.pop();return m(b,u,x)}function h(e,t){if(k(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(b(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(x(t))return e.stylize("null","null")}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,a){var i=[];for(var o=0,s=t.length;o<s;++o){if(R(t,String(o))){i.push(v(e,t,r,n,String(o),true))}else{i.push("")}}a.forEach(function(a){if(!a.match(/^\d+$/)){i.push(v(e,t,r,n,a,true))}});return i}function v(e,t,r,n,a,i){var o,s,l;l=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]};if(l.get){if(l.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(l.set){s=e.stylize("[Setter]","special")}}if(!R(n,a)){o="["+a+"]"}if(!s){if(e.seen.indexOf(l.value)<0){if(x(r)){s=f(e,l.value,null)}else{s=f(e,l.value,r-1)}if(s.indexOf("\n")>-1){if(i){s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(k(o)){if(i&&a.match(/^\d+$/)){return s}o=JSON.stringify(""+a);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=e.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=e.stylize(o,"string")}}return o+": "+s}function m(e,t,r){var n=0;var a=e.reduce(function(e,t){n++;if(t.indexOf("\n")>=0)n++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(a>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function g(e){return Array.isArray(e)}n.isArray=g;function y(e){return typeof e==="boolean"}n.isBoolean=y;function x(e){return e===null}n.isNull=x;function _(e){return e==null}n.isNullOrUndefined=_;function b(e){return typeof e==="number"}n.isNumber=b;function w(e){return typeof e==="string"}n.isString=w;function T(e){return typeof e==="symbol"}n.isSymbol=T;function k(e){return e===void 0}n.isUndefined=k;function A(e){return M(e)&&I(e)==="[object RegExp]"}n.isRegExp=A;function M(e){return typeof e==="object"&&e!==null}n.isObject=M;function E(e){return M(e)&&I(e)==="[object Date]"}n.isDate=E;function S(e){return M(e)&&(I(e)==="[object Error]"||e instanceof Error)}n.isError=S;function C(e){return typeof e==="function"}n.isFunction=C;function L(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}n.isPrimitive=L;n.isBuffer=e("./support/isBuffer");function I(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(){var e=new Date;var t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}n.log=function(){console.log("%s - %s",D(),n.format.apply(n,arguments))};n.inherits=e("inherits");n._extend=function(e,t){if(!t||!M(t))return e;var r=Object.keys(t);var n=r.length;while(n--){e[r[n]]=t[r[n]]}return e};function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this)}).call(this,e("_process"),typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":75,_process:526,inherits:74}],77:[function(e,t,r){t.exports=function e(t){return atob(t)}},{}],78:[function(e,t,r){"use strict";t.exports=i;var n=e("robust-linear-solve");function a(e){var t=0;for(var r=0;r<e.length;++r){t+=e[r]}return t}function i(e,t){var r=t.length;var i=new Array(r+1);for(var o=0;o<r;++o){var s=new Array(r+1);for(var l=0;l<=r;++l){s[l]=e[l][o]}i[o]=s}i[r]=new Array(r+1);for(var o=0;o<=r;++o){i[r][o]=1}var u=new Array(r+1);for(var o=0;o<r;++o){u[o]=t[o]}u[r]=1;var c=n(i,u);var f=a(c[r+1]);if(f===0){f=1}var h=new Array(r+1);for(var o=0;o<=r;++o){h[o]=a(c[o])/f}return h}},{"robust-linear-solve":547}],79:[function(e,t,r){"use strict";r.byteLength=c;r.toByteArray=h;r.fromByteArray=v;var n=[];var a=[];var i=typeof Uint8Array!=="undefined"?Uint8Array:Array;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,l=o.length;s<l;++s){n[s]=o[s];a[o.charCodeAt(s)]=s}a["-".charCodeAt(0)]=62;a["_".charCodeAt(0)]=63;function u(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var r=e.indexOf("=");if(r===-1)r=t;var n=r===t?0:4-r%4;return[r,n]}function c(e){var t=u(e);var r=t[0];var n=t[1];return(r+n)*3/4-n}function f(e,t,r){return(t+r)*3/4-r}function h(e){var t;var r=u(e);var n=r[0];var o=r[1];var s=new i(f(e,n,o));var l=0;var c=o>0?n-4:n;var h;for(h=0;h<c;h+=4){t=a[e.charCodeAt(h)]<<18|a[e.charCodeAt(h+1)]<<12|a[e.charCodeAt(h+2)]<<6|a[e.charCodeAt(h+3)];s[l++]=t>>16&255;s[l++]=t>>8&255;s[l++]=t&255}if(o===2){t=a[e.charCodeAt(h)]<<2|a[e.charCodeAt(h+1)]>>4;s[l++]=t&255}if(o===1){t=a[e.charCodeAt(h)]<<10|a[e.charCodeAt(h+1)]<<4|a[e.charCodeAt(h+2)]>>2;s[l++]=t>>8&255;s[l++]=t&255}return s}function p(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function d(e,t,r){var n;var a=[];for(var i=t;i<r;i+=3){n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255);a.push(p(n))}return a.join("")}function v(e){var t;var r=e.length;var a=r%3;var i=[];var o=16383;for(var s=0,l=r-a;s<l;s+=o){i.push(d(e,s,s+o>l?l:s+o))}if(a===1){t=e[r-1];i.push(n[t>>2]+n[t<<4&63]+"==")}else if(a===2){t=(e[r-2]<<8)+e[r-1];i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")}return i.join("")}},{}],80:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=a;function a(e,t){return n(e[0].mul(t[1]).add(t[0].mul(e[1])),e[1].mul(t[1]))}},{"./lib/rationalize":90}],81:[function(e,t,r){"use strict";t.exports=n;function n(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],82:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=a;function a(e,t){return n(e[0].mul(t[1]),e[1].mul(t[0]))}},{"./lib/rationalize":90}],83:[function(e,t,r){"use strict";var n=e("./is-rat");var a=e("./lib/is-bn");var i=e("./lib/num-to-bn");var o=e("./lib/str-to-bn");var s=e("./lib/rationalize");var l=e("./div");t.exports=u;function u(e,t){if(n(e)){if(t){return l(e,u(t))}return[e[0].clone(),e[1].clone()]}var r=0;var c,f;if(a(e)){c=e.clone()}else if(typeof e==="string"){c=o(e)}else if(e===0){return[i(0),i(1)]}else if(e===Math.floor(e)){c=i(e)}else{while(e!==Math.floor(e)){e=e*Math.pow(2,256);r-=256}c=i(e)}if(n(t)){c.mul(t[1]);f=t[0].clone()}else if(a(t)){f=t.clone()}else if(typeof t==="string"){f=o(t)}else if(!t){f=i(1)}else if(t===Math.floor(t)){f=i(t)}else{while(t!==Math.floor(t)){t=t*Math.pow(2,256);r+=256}f=i(t)}if(r>0){c=c.ushln(r)}else if(r<0){f=f.ushln(-r)}return s(c,f)}},{"./div":82,"./is-rat":84,"./lib/is-bn":88,"./lib/num-to-bn":89,"./lib/rationalize":90,"./lib/str-to-bn":91}],84:[function(e,t,r){"use strict";var n=e("./lib/is-bn");t.exports=a;function a(e){return Array.isArray(e)&&e.length===2&&n(e[0])&&n(e[1])}},{"./lib/is-bn":88}],85:[function(e,t,r){"use strict";var n=e("bn.js");t.exports=a;function a(e){return e.cmp(new n(0))}},{"bn.js":99}],86:[function(e,t,r){"use strict";var n=e("./bn-sign");t.exports=a;function a(e){var t=e.length;var r=e.words;var a=0;if(t===1){a=r[0]}else if(t===2){a=r[0]+r[1]*67108864}else{for(var i=0;i<t;i++){var o=r[i];a+=o*Math.pow(67108864,i)}}return n(e)*a}},{"./bn-sign":85}],87:[function(e,t,r){"use strict";var n=e("double-bits");var a=e("bit-twiddle").countTrailingZeros;t.exports=i;function i(e){var t=a(n.lo(e));if(t<32){return t}var r=a(n.hi(e));if(r>20){return 52}return r+32}},{"bit-twiddle":97,"double-bits":173}],88:[function(e,t,r){"use strict";var n=e("bn.js");t.exports=a;function a(e){return e&&typeof e==="object"&&Boolean(e.words)}},{"bn.js":99}],89:[function(e,t,r){"use strict";var n=e("bn.js");var a=e("double-bits");t.exports=i;function i(e){var t=a.exponent(e);if(t<52){return new n(e)}else{return new n(e*Math.pow(2,52-t)).ushln(t-52)}}},{"bn.js":99,"double-bits":173}],90:[function(e,t,r){"use strict";var n=e("./num-to-bn");var a=e("./bn-sign");t.exports=i;function i(e,t){var r=a(e);var i=a(t);if(r===0){return[n(0),n(1)]}if(i===0){return[n(0),n(0)]}if(i<0){e=e.neg();t=t.neg()}var o=e.gcd(t);if(o.cmpn(1)){return[e.div(o),t.div(o)]}return[e,t]}},{"./bn-sign":85,"./num-to-bn":89}],91:[function(e,t,r){"use strict";var n=e("bn.js");t.exports=a;function a(e){return new n(e)}},{"bn.js":99}],92:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=a;function a(e,t){return n(e[0].mul(t[0]),e[1].mul(t[1]))}},{"./lib/rationalize":90}],93:[function(e,t,r){"use strict";var n=e("./lib/bn-sign");t.exports=a;function a(e){return n(e[0])*n(e[1])}},{"./lib/bn-sign":85}],94:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=a;function a(e,t){return n(e[0].mul(t[1]).sub(e[1].mul(t[0])),e[1].mul(t[1]))}},{"./lib/rationalize":90}],95:[function(e,t,r){"use strict";var n=e("./lib/bn-to-num");var a=e("./lib/ctz");t.exports=i;function i(e){var t=e[0];var r=e[1];if(t.cmpn(0)===0){return 0}var i=t.abs().divmod(r.abs());var o=i.div;var s=n(o);var l=i.mod;var u=t.negative!==r.negative?-1:1;if(l.cmpn(0)===0){return u*s}if(s){var c=a(s)+4;var f=n(l.ushln(c).divRound(r));return u*(s+f*Math.pow(2,-c))}else{var h=r.bitLength()-l.bitLength()+53;var f=n(l.ushln(h).divRound(r));if(h<1023){return u*f*Math.pow(2,-h)}f*=Math.pow(2,-1023);return u*f*Math.pow(2,1023-h)}}},{"./lib/bn-to-num":86,"./lib/ctz":87}],96:[function(e,t,r){"use strict";function n(e,t,r,n,a){var i=["function ",e,"(a,l,h,",n.join(","),"){",a?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];if(a){if(t.indexOf("c")<0){i.push(";if(x===y){return m}else if(x<=y){")}else{i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{i.push(";if(",t,"){i=m;")}if(r){i.push("l=m+1}else{h=m-1}")}else{i.push("h=m-1}else{l=m+1}")}i.push("}");if(a){i.push("return -1};")}else{i.push("return i};")}return i.join("")}function a(e,t,r,a){var i=new Function([n("A","x"+e+"y",t,["y"],a),n("P","c(x,y)"+e+"0",t,["y","c"],a),"function dispatchBsearch",r,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",r].join(""));return i()}t.exports={ge:a(">=",false,"GE"),gt:a(">",false,"GT"),lt:a("<",true,"LT"),le:a("<=",true,"LE"),eq:a("-",true,"EQ",true)}},{}],97:[function(e,t,r){"use strict";"use restrict";var n=32;r.INT_BITS=n;r.INT_MAX=2147483647;r.INT_MIN=-1<<n-1;r.sign=function(e){return(e>0)-(e<0)};r.abs=function(e){var t=e>>n-1;return(e^t)-t};r.min=function(e,t){return t^(e^t)&-(e<t)};r.max=function(e,t){return e^(e^t)&-(e<t)};r.isPow2=function(e){return!(e&e-1)&&!!e};r.log2=function(e){var t,r;t=(e>65535)<<4;e>>>=t;r=(e>255)<<3;e>>>=r;t|=r;r=(e>15)<<2;e>>>=r;t|=r;r=(e>3)<<1;e>>>=r;t|=r;return t|e>>1};r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0};r.popCount=function(e){e=e-(e>>>1&1431655765);e=(e&858993459)+(e>>>2&858993459);return(e+(e>>>4)&252645135)*16843009>>>24};function a(e){var t=32;e&=-e;if(e)t--;if(e&65535)t-=16;if(e&16711935)t-=8;if(e&252645135)t-=4;if(e&858993459)t-=2;if(e&1431655765)t-=1;return t}r.countTrailingZeros=a;r.nextPow2=function(e){e+=e===0;--e;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e+1};r.prevPow2=function(e){e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e-(e>>>1)};r.parity=function(e){e^=e>>>16;e^=e>>>8;e^=e>>>4;e&=15;return 27030>>>e&1};var i=new Array(256);(function(e){for(var t=0;t<256;++t){var r=t,n=t,a=7;for(r>>>=1;r;r>>>=1){n<<=1;n|=r&1;--a}e[t]=n<<a&255}})(i);r.reverse=function(e){return i[e&255]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]};r.interleave2=function(e,t){e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t&=65535;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1};r.deinterleave2=function(e,t){e=e>>>t&1431655765;e=(e|e>>>1)&858993459;e=(e|e>>>2)&252645135;e=(e|e>>>4)&16711935;e=(e|e>>>16)&65535;return e<<16>>16};r.interleave3=function(e,t,r){e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;e=(e|e<<2)&1227133513;t&=1023;t=(t|t<<16)&4278190335;t=(t|t<<8)&251719695;t=(t|t<<4)&3272356035;t=(t|t<<2)&1227133513;e|=t<<1;r&=1023;r=(r|r<<16)&4278190335;r=(r|r<<8)&251719695;r=(r|r<<4)&3272356035;r=(r|r<<2)&1227133513;return e|r<<2};r.deinterleave3=function(e,t){e=e>>>t&1227133513;e=(e|e>>>2)&3272356035;e=(e|e>>>4)&251719695;e=(e|e>>>8)&4278190335;e=(e|e>>>16)&1023;return e<<22>>22};r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>a(e)+1}},{}],98:[function(e,t,r){"use strict";var n=e("clamp");t.exports=i;var a=1e20;function i(e,t){if(!t)t={};var r=t.cutoff==null?.25:t.cutoff;var i=t.radius==null?8:t.radius;var s=t.channel||0;var l,u,c,f,h,p,d,v,m,g,y;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");l=t.width,u=t.height;f=e;if(!t.stride)p=Math.floor(e.length/l/u);else p=t.stride}else{if(window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement){v=e;d=v.getContext("2d");l=v.width,u=v.height;m=d.getImageData(0,0,l,u);f=m.data;p=4}else if(window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D){v=e.canvas;d=e;l=v.width,u=v.height;m=d.getImageData(0,0,l,u);f=m.data;p=4}else if(window.ImageData&&e instanceof window.ImageData){m=e;l=e.width,u=e.height;f=m.data;p=4}}c=Math.max(l,u);if(window.Uint8ClampedArray&&f instanceof window.Uint8ClampedArray||window.Uint8Array&&f instanceof window.Uint8Array){h=f;f=Array(l*u);for(g=0,y=h.length;g<y;g++){f[g]=h[g*p+s]/255}}else{if(p!==1)throw Error("Raw data can have only 1 value per pixel")}var x=Array(l*u);var _=Array(l*u);var b=Array(c);var w=Array(c);var T=Array(c+1);var k=Array(c);for(g=0,y=l*u;g<y;g++){var A=f[g];x[g]=A===1?0:A===0?a:Math.pow(Math.max(0,.5-A),2);_[g]=A===1?a:A===0?0:Math.pow(Math.max(0,A-.5),2)}o(x,l,u,b,w,k,T);o(_,l,u,b,w,k,T);var M=window.Float32Array?new Float32Array(l*u):new Array(l*u);for(g=0,y=l*u;g<y;g++){M[g]=n(1-((x[g]-_[g])/i+r),0,1)}return M}function o(e,t,r,n,a,i,o){for(var l=0;l<t;l++){for(var u=0;u<r;u++){n[u]=e[u*t+l]}s(n,a,i,o,r);for(u=0;u<r;u++){e[u*t+l]=a[u]}}for(u=0;u<r;u++){for(l=0;l<t;l++){n[l]=e[u*t+l]}s(n,a,i,o,t);for(l=0;l<t;l++){e[u*t+l]=Math.sqrt(a[l])}}}function s(e,t,r,n,i){r[0]=0;n[0]=-a;n[1]=+a;for(var o=1,s=0;o<i;o++){var l=(e[o]+o*o-(e[r[s]]+r[s]*r[s]))/(2*o-2*r[s]);while(l<=n[s]){s--;l=(e[o]+o*o-(e[r[s]]+r[s]*r[s]))/(2*o-2*r[s])}s++;r[s]=o;n[s]=l;n[s+1]=+a}for(o=0,s=0;o<i;o++){while(n[s+1]<o)s++;t[o]=(o-r[s])*(o-r[s])+e[r[s]]}}},{clamp:120}],99:[function(e,t,r){(function(t,r){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function a(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}function i(e,t,r){if(i.isBN(e)){return e}this.negative=0;this.words=null;this.length=0;this.red=null;if(e!==null){if(t==="le"||t==="be"){r=t;t=10}this._init(e||0,t||10,r||"be")}}if(typeof t==="object"){t.exports=i}else{r.BN=i}i.BN=i;i.wordSize=26;var o;try{o=e("buffer").Buffer}catch(e){}i.isBN=function e(t){if(t instanceof i){return true}return t!==null&&typeof t==="object"&&t.constructor.wordSize===i.wordSize&&Array.isArray(t.words)};i.max=function e(t,r){if(t.cmp(r)>0)return t;return r};i.min=function e(t,r){if(t.cmp(r)<0)return t;return r};i.prototype._init=function e(t,r,a){if(typeof t==="number"){return this._initNumber(t,r,a)}if(typeof t==="object"){return this._initArray(t,r,a)}if(r==="hex"){r=16}n(r===(r|0)&&r>=2&&r<=36);t=t.toString().replace(/\s+/g,"");var i=0;if(t[0]==="-"){i++}if(r===16){this._parseHex(t,i)}else{this._parseBase(t,r,i)}if(t[0]==="-"){this.negative=1}this.strip();if(a!=="le")return;this._initArray(this.toArray(),r,a)};i.prototype._initNumber=function e(t,r,a){if(t<0){this.negative=1;t=-t}if(t<67108864){this.words=[t&67108863];this.length=1}else if(t<4503599627370496){this.words=[t&67108863,t/67108864&67108863];this.length=2}else{n(t<9007199254740992);this.words=[t&67108863,t/67108864&67108863,1];this.length=3}if(a!=="le")return;this._initArray(this.toArray(),r,a)};i.prototype._initArray=function e(t,r,a){n(typeof t.length==="number");if(t.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(t.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var o,s;var l=0;if(a==="be"){for(i=t.length-1,o=0;i>=0;i-=3){s=t[i]|t[i-1]<<8|t[i-2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}else if(a==="le"){for(i=0,o=0;i<t.length;i+=3){s=t[i]|t[i+1]<<8|t[i+2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}return this.strip()};function s(e,t,r){var n=0;var a=Math.min(e.length,r);for(var i=t;i<a;i++){var o=e.charCodeAt(i)-48;n<<=4;if(o>=49&&o<=54){n|=o-49+10}else if(o>=17&&o<=22){n|=o-17+10}else{n|=o&15}}return n}i.prototype._parseHex=function e(t,r){this.length=Math.ceil((t.length-r)/6);this.words=new Array(this.length);for(var n=0;n<this.length;n++){this.words[n]=0}var a,i;var o=0;for(n=t.length-6,a=0;n>=r;n-=6){i=s(t,n,n+6);this.words[a]|=i<<o&67108863;this.words[a+1]|=i>>>26-o&4194303;o+=24;if(o>=26){o-=26;a++}}if(n+6!==r){i=s(t,r,n+6);this.words[a]|=i<<o&67108863;this.words[a+1]|=i>>>26-o&4194303}this.strip()};function l(e,t,r,n){var a=0;var i=Math.min(e.length,r);for(var o=t;o<i;o++){var s=e.charCodeAt(o)-48;a*=n;if(s>=49){a+=s-49+10}else if(s>=17){a+=s-17+10}else{a+=s}}return a}i.prototype._parseBase=function e(t,r,n){this.words=[0];this.length=1;for(var a=0,i=1;i<=67108863;i*=r){a++}a--;i=i/r|0;var o=t.length-n;var s=o%a;var u=Math.min(o,o-s)+n;var c=0;for(var f=n;f<u;f+=a){c=l(t,f,f+a,r);this.imuln(i);if(this.words[0]+c<67108864){this.words[0]+=c}else{this._iaddn(c)}}if(s!==0){var h=1;c=l(t,f,t.length,r);for(f=0;f<s;f++){h*=r}this.imuln(h);if(this.words[0]+c<67108864){this.words[0]+=c}else{this._iaddn(c)}}};i.prototype.copy=function e(t){t.words=new Array(this.length);for(var r=0;r<this.length;r++){t.words[r]=this.words[r]}t.length=this.length;t.negative=this.negative;t.red=this.red};i.prototype.clone=function e(){var t=new i(null);this.copy(t);return t};i.prototype._expand=function e(t){while(this.length<t){this.words[this.length++]=0}return this};i.prototype.strip=function e(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};i.prototype._normSign=function e(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};i.prototype.inspect=function e(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function e(t,r){t=t||10;r=r|0||1;var a;if(t===16||t==="hex"){a="";var i=0;var o=0;for(var s=0;s<this.length;s++){var l=this.words[s];var h=((l<<i|o)&16777215).toString(16);o=l>>>24-i&16777215;if(o!==0||s!==this.length-1){a=u[6-h.length]+h+a}else{a=h+a}i+=2;if(i>=26){i-=26;s--}}if(o!==0){a=o.toString(16)+a}while(a.length%r!==0){a="0"+a}if(this.negative!==0){a="-"+a}return a}if(t===(t|0)&&t>=2&&t<=36){var p=c[t];var d=f[t];a="";var v=this.clone();v.negative=0;while(!v.isZero()){var m=v.modn(d).toString(t);v=v.idivn(d);if(!v.isZero()){a=u[p-m.length]+m+a}else{a=m+a}}if(this.isZero()){a="0"+a}while(a.length%r!==0){a="0"+a}if(this.negative!==0){a="-"+a}return a}n(false,"Base should be between 2 and 36")};i.prototype.toNumber=function e(){var t=this.words[0];if(this.length===2){t+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){t+=4503599627370496+this.words[1]*67108864}else if(this.length>2){n(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-t:t};i.prototype.toJSON=function e(){return this.toString(16)};i.prototype.toBuffer=function e(t,r){n(typeof o!=="undefined");return this.toArrayLike(o,t,r)};i.prototype.toArray=function e(t,r){return this.toArrayLike(Array,t,r)};i.prototype.toArrayLike=function e(t,r,a){var i=this.byteLength();var o=a||Math.max(1,i);n(i<=o,"byte array longer than desired length");n(o>0,"Requested array length <= 0");this.strip();var s=r==="le";var l=new t(o);var u,c;var f=this.clone();if(!s){for(c=0;c<o-i;c++){l[c]=0}for(c=0;!f.isZero();c++){u=f.andln(255);f.iushrn(8);l[o-c-1]=u}}else{for(c=0;!f.isZero();c++){u=f.andln(255);f.iushrn(8);l[c]=u}for(;c<o;c++){l[c]=0}}return l};if(Math.clz32){i.prototype._countBits=function e(t){return 32-Math.clz32(t)}}else{i.prototype._countBits=function e(t){var r=t;var n=0;if(r>=4096){n+=13;r>>>=13}if(r>=64){n+=7;r>>>=7}if(r>=8){n+=4;r>>>=4}if(r>=2){n+=2;r>>>=2}return n+r}}i.prototype._zeroBits=function e(t){if(t===0)return 26;var r=t;var n=0;if((r&8191)===0){n+=13;r>>>=13}if((r&127)===0){n+=7;r>>>=7}if((r&15)===0){n+=4;r>>>=4}if((r&3)===0){n+=2;r>>>=2}if((r&1)===0){n++}return n};i.prototype.bitLength=function e(){var t=this.words[this.length-1];var r=this._countBits(t);return(this.length-1)*26+r};function h(e){var t=new Array(e.bitLength());for(var r=0;r<t.length;r++){var n=r/26|0;var a=r%26;t[r]=(e.words[n]&1<<a)>>>a}return t}i.prototype.zeroBits=function e(){if(this.isZero())return 0;var t=0;for(var r=0;r<this.length;r++){var n=this._zeroBits(this.words[r]);t+=n;if(n!==26)break}return t};i.prototype.byteLength=function e(){return Math.ceil(this.bitLength()/8)};i.prototype.toTwos=function e(t){if(this.negative!==0){return this.abs().inotn(t).iaddn(1)}return this.clone()};i.prototype.fromTwos=function e(t){if(this.testn(t-1)){return this.notn(t).iaddn(1).ineg()}return this.clone()};i.prototype.isNeg=function e(){return this.negative!==0};i.prototype.neg=function e(){return this.clone().ineg()};i.prototype.ineg=function e(){if(!this.isZero()){this.negative^=1}return this};i.prototype.iuor=function e(t){while(this.length<t.length){this.words[this.length++]=0}for(var r=0;r<t.length;r++){this.words[r]=this.words[r]|t.words[r]}return this.strip()};i.prototype.ior=function e(t){n((this.negative|t.negative)===0);return this.iuor(t)};i.prototype.or=function e(t){if(this.length>t.length)return this.clone().ior(t);return t.clone().ior(this)};i.prototype.uor=function e(t){if(this.length>t.length)return this.clone().iuor(t);return t.clone().iuor(this)};i.prototype.iuand=function e(t){var r;if(this.length>t.length){r=t}else{r=this}for(var n=0;n<r.length;n++){this.words[n]=this.words[n]&t.words[n]}this.length=r.length;return this.strip()};i.prototype.iand=function e(t){n((this.negative|t.negative)===0);return this.iuand(t)};i.prototype.and=function e(t){if(this.length>t.length)return this.clone().iand(t);return t.clone().iand(this)};i.prototype.uand=function e(t){if(this.length>t.length)return this.clone().iuand(t);return t.clone().iuand(this)};i.prototype.iuxor=function e(t){var r;var n;if(this.length>t.length){r=this;n=t}else{r=t;n=this}for(var a=0;a<n.length;a++){this.words[a]=r.words[a]^n.words[a]}if(this!==r){for(;a<r.length;a++){this.words[a]=r.words[a]}}this.length=r.length;return this.strip()};i.prototype.ixor=function e(t){n((this.negative|t.negative)===0);return this.iuxor(t)};i.prototype.xor=function e(t){if(this.length>t.length)return this.clone().ixor(t);return t.clone().ixor(this)};i.prototype.uxor=function e(t){if(this.length>t.length)return this.clone().iuxor(t);return t.clone().iuxor(this)};i.prototype.inotn=function e(t){n(typeof t==="number"&&t>=0);var r=Math.ceil(t/26)|0;var a=t%26;this._expand(r);if(a>0){r--}for(var i=0;i<r;i++){this.words[i]=~this.words[i]&67108863}if(a>0){this.words[i]=~this.words[i]&67108863>>26-a}return this.strip()};i.prototype.notn=function e(t){return this.clone().inotn(t)};i.prototype.setn=function e(t,r){n(typeof t==="number"&&t>=0);var a=t/26|0;var i=t%26;this._expand(a+1);if(r){this.words[a]=this.words[a]|1<<i}else{this.words[a]=this.words[a]&~(1<<i)}return this.strip()};i.prototype.iadd=function e(t){var r;if(this.negative!==0&&t.negative===0){this.negative=0;r=this.isub(t);this.negative^=1;return this._normSign()}else if(this.negative===0&&t.negative!==0){t.negative=0;r=this.isub(t);t.negative=1;return r._normSign()}var n,a;if(this.length>t.length){n=this;a=t}else{n=t;a=this}var i=0;for(var o=0;o<a.length;o++){r=(n.words[o]|0)+(a.words[o]|0)+i;this.words[o]=r&67108863;i=r>>>26}for(;i!==0&&o<n.length;o++){r=(n.words[o]|0)+i;this.words[o]=r&67108863;i=r>>>26}this.length=n.length;if(i!==0){this.words[this.length]=i;this.length++}else if(n!==this){for(;o<n.length;o++){this.words[o]=n.words[o]}}return this};i.prototype.add=function e(t){var r;if(t.negative!==0&&this.negative===0){t.negative=0;r=this.sub(t);t.negative^=1;return r}else if(t.negative===0&&this.negative!==0){this.negative=0;r=t.sub(this);this.negative=1;return r}if(this.length>t.length)return this.clone().iadd(t);return t.clone().iadd(this)};i.prototype.isub=function e(t){if(t.negative!==0){t.negative=0;var r=this.iadd(t);t.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(t);this.negative=1;return this._normSign()}var n=this.cmp(t);if(n===0){this.negative=0;this.length=1;this.words[0]=0;return this}var a,i;if(n>0){a=this;i=t}else{a=t;i=this}var o=0;for(var s=0;s<i.length;s++){r=(a.words[s]|0)-(i.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}for(;o!==0&&s<a.length;s++){r=(a.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}if(o===0&&s<a.length&&a!==this){for(;s<a.length;s++){this.words[s]=a.words[s]}}this.length=Math.max(this.length,s);if(a!==this){this.negative=1}return this.strip()};i.prototype.sub=function e(t){return this.clone().isub(t)};function p(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n;n=n-1|0;var a=e.words[0]|0;var i=t.words[0]|0;var o=a*i;var s=o&67108863;var l=o/67108864|0;r.words[0]=s;for(var u=1;u<n;u++){var c=l>>>26;var f=l&67108863;var h=Math.min(u,t.length-1);for(var p=Math.max(0,u-e.length+1);p<=h;p++){var d=u-p|0;a=e.words[d]|0;i=t.words[p]|0;o=a*i+f;c+=o/67108864|0;f=o&67108863}r.words[u]=f|0;l=c|0}if(l!==0){r.words[u]=l|0}else{r.length--}return r.strip()}var d=function e(t,r,n){var a=t.words;var i=r.words;var o=n.words;var s=0;var l;var u;var c;var f=a[0]|0;var h=f&8191;var p=f>>>13;var d=a[1]|0;var v=d&8191;var m=d>>>13;var g=a[2]|0;var y=g&8191;var x=g>>>13;var _=a[3]|0;var b=_&8191;var w=_>>>13;var T=a[4]|0;var k=T&8191;var A=T>>>13;var M=a[5]|0;var E=M&8191;var S=M>>>13;var C=a[6]|0;var L=C&8191;var I=C>>>13;var O=a[7]|0;var P=O&8191;var D=O>>>13;var R=a[8]|0;var z=R&8191;var N=R>>>13;var F=a[9]|0;var B=F&8191;var j=F>>>13;var U=i[0]|0;var H=U&8191;var V=U>>>13;var G=i[1]|0;var q=G&8191;var Y=G>>>13;var W=i[2]|0;var X=W&8191;var Z=W>>>13;var K=i[3]|0;var J=K&8191;var Q=K>>>13;var $=i[4]|0;var ee=$&8191;var te=$>>>13;var re=i[5]|0;var ne=re&8191;var ae=re>>>13;var ie=i[6]|0;var oe=ie&8191;var se=ie>>>13;var le=i[7]|0;var ue=le&8191;var ce=le>>>13;var fe=i[8]|0;var he=fe&8191;var pe=fe>>>13;var de=i[9]|0;var ve=de&8191;var me=de>>>13;n.negative=t.negative^r.negative;n.length=19;l=Math.imul(h,H);u=Math.imul(h,V);u=u+Math.imul(p,H)|0;c=Math.imul(p,V);var ge=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ge>>>26)|0;ge&=67108863;l=Math.imul(v,H);u=Math.imul(v,V);u=u+Math.imul(m,H)|0;c=Math.imul(m,V);l=l+Math.imul(h,q)|0;u=u+Math.imul(h,Y)|0;u=u+Math.imul(p,q)|0;c=c+Math.imul(p,Y)|0;var ye=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ye>>>26)|0;ye&=67108863;l=Math.imul(y,H);u=Math.imul(y,V);u=u+Math.imul(x,H)|0;c=Math.imul(x,V);l=l+Math.imul(v,q)|0;u=u+Math.imul(v,Y)|0;u=u+Math.imul(m,q)|0;c=c+Math.imul(m,Y)|0;l=l+Math.imul(h,X)|0;u=u+Math.imul(h,Z)|0;u=u+Math.imul(p,X)|0;c=c+Math.imul(p,Z)|0;var xe=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(xe>>>26)|0;xe&=67108863;l=Math.imul(b,H);u=Math.imul(b,V);u=u+Math.imul(w,H)|0;c=Math.imul(w,V);l=l+Math.imul(y,q)|0;u=u+Math.imul(y,Y)|0;u=u+Math.imul(x,q)|0;c=c+Math.imul(x,Y)|0;l=l+Math.imul(v,X)|0;u=u+Math.imul(v,Z)|0;u=u+Math.imul(m,X)|0;c=c+Math.imul(m,Z)|0;l=l+Math.imul(h,J)|0;u=u+Math.imul(h,Q)|0;u=u+Math.imul(p,J)|0;c=c+Math.imul(p,Q)|0;var _e=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(_e>>>26)|0;_e&=67108863;l=Math.imul(k,H);u=Math.imul(k,V);u=u+Math.imul(A,H)|0;c=Math.imul(A,V);l=l+Math.imul(b,q)|0;u=u+Math.imul(b,Y)|0;u=u+Math.imul(w,q)|0;c=c+Math.imul(w,Y)|0;l=l+Math.imul(y,X)|0;u=u+Math.imul(y,Z)|0;u=u+Math.imul(x,X)|0;c=c+Math.imul(x,Z)|0;l=l+Math.imul(v,J)|0;u=u+Math.imul(v,Q)|0;u=u+Math.imul(m,J)|0;c=c+Math.imul(m,Q)|0;l=l+Math.imul(h,ee)|0;u=u+Math.imul(h,te)|0;u=u+Math.imul(p,ee)|0;c=c+Math.imul(p,te)|0;var be=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(be>>>26)|0;be&=67108863;l=Math.imul(E,H);u=Math.imul(E,V);u=u+Math.imul(S,H)|0;c=Math.imul(S,V);l=l+Math.imul(k,q)|0;u=u+Math.imul(k,Y)|0;u=u+Math.imul(A,q)|0;c=c+Math.imul(A,Y)|0;l=l+Math.imul(b,X)|0;u=u+Math.imul(b,Z)|0;u=u+Math.imul(w,X)|0;c=c+Math.imul(w,Z)|0;l=l+Math.imul(y,J)|0;u=u+Math.imul(y,Q)|0;u=u+Math.imul(x,J)|0;c=c+Math.imul(x,Q)|0;l=l+Math.imul(v,ee)|0;u=u+Math.imul(v,te)|0;u=u+Math.imul(m,ee)|0;c=c+Math.imul(m,te)|0;l=l+Math.imul(h,ne)|0;u=u+Math.imul(h,ae)|0;u=u+Math.imul(p,ne)|0;c=c+Math.imul(p,ae)|0;var we=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(we>>>26)|0;we&=67108863;l=Math.imul(L,H);u=Math.imul(L,V);u=u+Math.imul(I,H)|0;c=Math.imul(I,V);l=l+Math.imul(E,q)|0;u=u+Math.imul(E,Y)|0;u=u+Math.imul(S,q)|0;c=c+Math.imul(S,Y)|0;l=l+Math.imul(k,X)|0;u=u+Math.imul(k,Z)|0;u=u+Math.imul(A,X)|0;c=c+Math.imul(A,Z)|0;l=l+Math.imul(b,J)|0;u=u+Math.imul(b,Q)|0;u=u+Math.imul(w,J)|0;c=c+Math.imul(w,Q)|0;l=l+Math.imul(y,ee)|0;u=u+Math.imul(y,te)|0;u=u+Math.imul(x,ee)|0;c=c+Math.imul(x,te)|0;l=l+Math.imul(v,ne)|0;u=u+Math.imul(v,ae)|0;u=u+Math.imul(m,ne)|0;c=c+Math.imul(m,ae)|0;l=l+Math.imul(h,oe)|0;u=u+Math.imul(h,se)|0;u=u+Math.imul(p,oe)|0;c=c+Math.imul(p,se)|0;var Te=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Te>>>26)|0;Te&=67108863;l=Math.imul(P,H);u=Math.imul(P,V);u=u+Math.imul(D,H)|0;c=Math.imul(D,V);l=l+Math.imul(L,q)|0;u=u+Math.imul(L,Y)|0;u=u+Math.imul(I,q)|0;c=c+Math.imul(I,Y)|0;l=l+Math.imul(E,X)|0;u=u+Math.imul(E,Z)|0;u=u+Math.imul(S,X)|0;c=c+Math.imul(S,Z)|0;l=l+Math.imul(k,J)|0;u=u+Math.imul(k,Q)|0;u=u+Math.imul(A,J)|0;c=c+Math.imul(A,Q)|0;l=l+Math.imul(b,ee)|0;u=u+Math.imul(b,te)|0;u=u+Math.imul(w,ee)|0;c=c+Math.imul(w,te)|0;l=l+Math.imul(y,ne)|0;u=u+Math.imul(y,ae)|0;u=u+Math.imul(x,ne)|0;c=c+Math.imul(x,ae)|0;l=l+Math.imul(v,oe)|0;u=u+Math.imul(v,se)|0;u=u+Math.imul(m,oe)|0;c=c+Math.imul(m,se)|0;l=l+Math.imul(h,ue)|0;u=u+Math.imul(h,ce)|0;u=u+Math.imul(p,ue)|0;c=c+Math.imul(p,ce)|0;var ke=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ke>>>26)|0;ke&=67108863;l=Math.imul(z,H);u=Math.imul(z,V);u=u+Math.imul(N,H)|0;c=Math.imul(N,V);l=l+Math.imul(P,q)|0;u=u+Math.imul(P,Y)|0;u=u+Math.imul(D,q)|0;c=c+Math.imul(D,Y)|0;l=l+Math.imul(L,X)|0;u=u+Math.imul(L,Z)|0;u=u+Math.imul(I,X)|0;c=c+Math.imul(I,Z)|0;l=l+Math.imul(E,J)|0;u=u+Math.imul(E,Q)|0;u=u+Math.imul(S,J)|0;c=c+Math.imul(S,Q)|0;l=l+Math.imul(k,ee)|0;u=u+Math.imul(k,te)|0;u=u+Math.imul(A,ee)|0;c=c+Math.imul(A,te)|0;l=l+Math.imul(b,ne)|0;u=u+Math.imul(b,ae)|0;u=u+Math.imul(w,ne)|0;c=c+Math.imul(w,ae)|0;l=l+Math.imul(y,oe)|0;u=u+Math.imul(y,se)|0;u=u+Math.imul(x,oe)|0;c=c+Math.imul(x,se)|0;l=l+Math.imul(v,ue)|0;u=u+Math.imul(v,ce)|0;u=u+Math.imul(m,ue)|0;c=c+Math.imul(m,ce)|0;l=l+Math.imul(h,he)|0;u=u+Math.imul(h,pe)|0;u=u+Math.imul(p,he)|0;c=c+Math.imul(p,pe)|0;var Ae=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ae>>>26)|0;Ae&=67108863;l=Math.imul(B,H);u=Math.imul(B,V);u=u+Math.imul(j,H)|0;c=Math.imul(j,V);l=l+Math.imul(z,q)|0;u=u+Math.imul(z,Y)|0;u=u+Math.imul(N,q)|0;c=c+Math.imul(N,Y)|0;l=l+Math.imul(P,X)|0;u=u+Math.imul(P,Z)|0;u=u+Math.imul(D,X)|0;c=c+Math.imul(D,Z)|0;l=l+Math.imul(L,J)|0;u=u+Math.imul(L,Q)|0;u=u+Math.imul(I,J)|0;c=c+Math.imul(I,Q)|0;l=l+Math.imul(E,ee)|0;u=u+Math.imul(E,te)|0;u=u+Math.imul(S,ee)|0;c=c+Math.imul(S,te)|0;l=l+Math.imul(k,ne)|0;u=u+Math.imul(k,ae)|0;u=u+Math.imul(A,ne)|0;c=c+Math.imul(A,ae)|0;l=l+Math.imul(b,oe)|0;u=u+Math.imul(b,se)|0;u=u+Math.imul(w,oe)|0;c=c+Math.imul(w,se)|0;l=l+Math.imul(y,ue)|0;u=u+Math.imul(y,ce)|0;u=u+Math.imul(x,ue)|0;c=c+Math.imul(x,ce)|0;l=l+Math.imul(v,he)|0;u=u+Math.imul(v,pe)|0;u=u+Math.imul(m,he)|0;c=c+Math.imul(m,pe)|0;l=l+Math.imul(h,ve)|0;u=u+Math.imul(h,me)|0;u=u+Math.imul(p,ve)|0;c=c+Math.imul(p,me)|0;var Me=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Me>>>26)|0;Me&=67108863;l=Math.imul(B,q);u=Math.imul(B,Y);u=u+Math.imul(j,q)|0;c=Math.imul(j,Y);l=l+Math.imul(z,X)|0;u=u+Math.imul(z,Z)|0;u=u+Math.imul(N,X)|0;c=c+Math.imul(N,Z)|0;l=l+Math.imul(P,J)|0;u=u+Math.imul(P,Q)|0;u=u+Math.imul(D,J)|0;c=c+Math.imul(D,Q)|0;l=l+Math.imul(L,ee)|0;u=u+Math.imul(L,te)|0;u=u+Math.imul(I,ee)|0;c=c+Math.imul(I,te)|0;l=l+Math.imul(E,ne)|0;u=u+Math.imul(E,ae)|0;u=u+Math.imul(S,ne)|0;c=c+Math.imul(S,ae)|0;l=l+Math.imul(k,oe)|0;u=u+Math.imul(k,se)|0;u=u+Math.imul(A,oe)|0;c=c+Math.imul(A,se)|0;l=l+Math.imul(b,ue)|0;u=u+Math.imul(b,ce)|0;u=u+Math.imul(w,ue)|0;c=c+Math.imul(w,ce)|0;l=l+Math.imul(y,he)|0;u=u+Math.imul(y,pe)|0;u=u+Math.imul(x,he)|0;c=c+Math.imul(x,pe)|0;l=l+Math.imul(v,ve)|0;u=u+Math.imul(v,me)|0;u=u+Math.imul(m,ve)|0;c=c+Math.imul(m,me)|0;var Ee=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ee>>>26)|0;Ee&=67108863;l=Math.imul(B,X);u=Math.imul(B,Z);u=u+Math.imul(j,X)|0;c=Math.imul(j,Z);l=l+Math.imul(z,J)|0;u=u+Math.imul(z,Q)|0;u=u+Math.imul(N,J)|0;c=c+Math.imul(N,Q)|0;l=l+Math.imul(P,ee)|0;u=u+Math.imul(P,te)|0;u=u+Math.imul(D,ee)|0;c=c+Math.imul(D,te)|0;l=l+Math.imul(L,ne)|0;u=u+Math.imul(L,ae)|0;u=u+Math.imul(I,ne)|0;c=c+Math.imul(I,ae)|0;l=l+Math.imul(E,oe)|0;u=u+Math.imul(E,se)|0;u=u+Math.imul(S,oe)|0;c=c+Math.imul(S,se)|0;l=l+Math.imul(k,ue)|0;u=u+Math.imul(k,ce)|0;u=u+Math.imul(A,ue)|0;c=c+Math.imul(A,ce)|0;l=l+Math.imul(b,he)|0;u=u+Math.imul(b,pe)|0;u=u+Math.imul(w,he)|0;c=c+Math.imul(w,pe)|0;l=l+Math.imul(y,ve)|0;u=u+Math.imul(y,me)|0;u=u+Math.imul(x,ve)|0;c=c+Math.imul(x,me)|0;var Se=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Se>>>26)|0;Se&=67108863;l=Math.imul(B,J);u=Math.imul(B,Q);u=u+Math.imul(j,J)|0;c=Math.imul(j,Q);l=l+Math.imul(z,ee)|0;u=u+Math.imul(z,te)|0;u=u+Math.imul(N,ee)|0;c=c+Math.imul(N,te)|0;l=l+Math.imul(P,ne)|0;u=u+Math.imul(P,ae)|0;u=u+Math.imul(D,ne)|0;c=c+Math.imul(D,ae)|0;l=l+Math.imul(L,oe)|0;u=u+Math.imul(L,se)|0;u=u+Math.imul(I,oe)|0;c=c+Math.imul(I,se)|0;l=l+Math.imul(E,ue)|0;u=u+Math.imul(E,ce)|0;u=u+Math.imul(S,ue)|0;c=c+Math.imul(S,ce)|0;l=l+Math.imul(k,he)|0;u=u+Math.imul(k,pe)|0;u=u+Math.imul(A,he)|0;c=c+Math.imul(A,pe)|0;l=l+Math.imul(b,ve)|0;u=u+Math.imul(b,me)|0;u=u+Math.imul(w,ve)|0;c=c+Math.imul(w,me)|0;var Ce=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ce>>>26)|0;Ce&=67108863;l=Math.imul(B,ee);u=Math.imul(B,te);u=u+Math.imul(j,ee)|0;c=Math.imul(j,te);l=l+Math.imul(z,ne)|0;u=u+Math.imul(z,ae)|0;u=u+Math.imul(N,ne)|0;c=c+Math.imul(N,ae)|0;l=l+Math.imul(P,oe)|0;u=u+Math.imul(P,se)|0;u=u+Math.imul(D,oe)|0;c=c+Math.imul(D,se)|0;l=l+Math.imul(L,ue)|0;u=u+Math.imul(L,ce)|0;u=u+Math.imul(I,ue)|0;c=c+Math.imul(I,ce)|0;l=l+Math.imul(E,he)|0;u=u+Math.imul(E,pe)|0;u=u+Math.imul(S,he)|0;c=c+Math.imul(S,pe)|0;l=l+Math.imul(k,ve)|0;u=u+Math.imul(k,me)|0;u=u+Math.imul(A,ve)|0;c=c+Math.imul(A,me)|0;var Le=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Le>>>26)|0;Le&=67108863;l=Math.imul(B,ne);u=Math.imul(B,ae);u=u+Math.imul(j,ne)|0;c=Math.imul(j,ae);l=l+Math.imul(z,oe)|0;u=u+Math.imul(z,se)|0;u=u+Math.imul(N,oe)|0;c=c+Math.imul(N,se)|0;l=l+Math.imul(P,ue)|0;u=u+Math.imul(P,ce)|0;u=u+Math.imul(D,ue)|0;c=c+Math.imul(D,ce)|0;l=l+Math.imul(L,he)|0;u=u+Math.imul(L,pe)|0;u=u+Math.imul(I,he)|0;c=c+Math.imul(I,pe)|0;l=l+Math.imul(E,ve)|0;u=u+Math.imul(E,me)|0;u=u+Math.imul(S,ve)|0;c=c+Math.imul(S,me)|0;var Ie=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ie>>>26)|0;Ie&=67108863;l=Math.imul(B,oe);u=Math.imul(B,se);u=u+Math.imul(j,oe)|0;c=Math.imul(j,se);l=l+Math.imul(z,ue)|0;u=u+Math.imul(z,ce)|0;u=u+Math.imul(N,ue)|0;c=c+Math.imul(N,ce)|0;l=l+Math.imul(P,he)|0;u=u+Math.imul(P,pe)|0;u=u+Math.imul(D,he)|0;c=c+Math.imul(D,pe)|0;l=l+Math.imul(L,ve)|0;u=u+Math.imul(L,me)|0;u=u+Math.imul(I,ve)|0;c=c+Math.imul(I,me)|0;var Oe=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Oe>>>26)|0;Oe&=67108863;l=Math.imul(B,ue);u=Math.imul(B,ce);u=u+Math.imul(j,ue)|0;c=Math.imul(j,ce);l=l+Math.imul(z,he)|0;u=u+Math.imul(z,pe)|0;u=u+Math.imul(N,he)|0;c=c+Math.imul(N,pe)|0;l=l+Math.imul(P,ve)|0;u=u+Math.imul(P,me)|0;u=u+Math.imul(D,ve)|0;c=c+Math.imul(D,me)|0;var Pe=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Pe>>>26)|0;Pe&=67108863;l=Math.imul(B,he);u=Math.imul(B,pe);u=u+Math.imul(j,he)|0;c=Math.imul(j,pe);l=l+Math.imul(z,ve)|0;u=u+Math.imul(z,me)|0;u=u+Math.imul(N,ve)|0;c=c+Math.imul(N,me)|0;var De=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(De>>>26)|0;De&=67108863;l=Math.imul(B,ve);u=Math.imul(B,me);u=u+Math.imul(j,ve)|0;c=Math.imul(j,me);var Re=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Re>>>26)|0;Re&=67108863;o[0]=ge;o[1]=ye;o[2]=xe;o[3]=_e;o[4]=be;o[5]=we;o[6]=Te;o[7]=ke;o[8]=Ae;o[9]=Me;o[10]=Ee;o[11]=Se;o[12]=Ce;o[13]=Le;o[14]=Ie;o[15]=Oe;o[16]=Pe;o[17]=De;o[18]=Re;if(s!==0){o[19]=s;n.length++}return n};if(!Math.imul){d=p}function v(e,t,r){r.negative=t.negative^e.negative;r.length=e.length+t.length;var n=0;var a=0;for(var i=0;i<r.length-1;i++){var o=a;a=0;var s=n&67108863;var l=Math.min(i,t.length-1);for(var u=Math.max(0,i-e.length+1);u<=l;u++){var c=i-u;var f=e.words[c]|0;var h=t.words[u]|0;var p=f*h;var d=p&67108863;o=o+(p/67108864|0)|0;d=d+s|0;s=d&67108863;o=o+(d>>>26)|0;a+=o>>>26;o&=67108863}r.words[i]=s;n=o;o=a}if(n!==0){r.words[i]=n}else{r.length--}return r.strip()}function m(e,t,r){var n=new g;return n.mulp(e,t,r)}i.prototype.mulTo=function e(t,r){var n;var a=this.length+t.length;if(this.length===10&&t.length===10){n=d(this,t,r)}else if(a<63){n=p(this,t,r)}else if(a<1024){n=v(this,t,r)}else{n=m(this,t,r)}return n};function g(e,t){this.x=e;this.y=t}g.prototype.makeRBT=function e(t){var r=new Array(t);var n=i.prototype._countBits(t)-1;for(var a=0;a<t;a++){r[a]=this.revBin(a,n,t)}return r};g.prototype.revBin=function e(t,r,n){if(t===0||t===n-1)return t;var a=0;for(var i=0;i<r;i++){a|=(t&1)<<r-i-1;t>>=1}return a};g.prototype.permute=function e(t,r,n,a,i,o){for(var s=0;s<o;s++){a[s]=r[t[s]];i[s]=n[t[s]]}};g.prototype.transform=function e(t,r,n,a,i,o){this.permute(o,t,r,n,a,i);for(var s=1;s<i;s<<=1){var l=s<<1;var u=Math.cos(2*Math.PI/l);var c=Math.sin(2*Math.PI/l);for(var f=0;f<i;f+=l){var h=u;var p=c;for(var d=0;d<s;d++){var v=n[f+d];var m=a[f+d];var g=n[f+d+s];var y=a[f+d+s];var x=h*g-p*y;y=h*y+p*g;g=x;n[f+d]=v+g;a[f+d]=m+y;n[f+d+s]=v-g;a[f+d+s]=m-y;if(d!==l){x=u*h-c*p;p=u*p+c*h;h=x}}}}};g.prototype.guessLen13b=function e(t,r){var n=Math.max(r,t)|1;var a=n&1;var i=0;for(n=n/2|0;n;n=n>>>1){i++}return 1<<i+1+a};g.prototype.conjugate=function e(t,r,n){if(n<=1)return;for(var a=0;a<n/2;a++){var i=t[a];t[a]=t[n-a-1];t[n-a-1]=i;i=r[a];r[a]=-r[n-a-1];r[n-a-1]=-i}};g.prototype.normalize13b=function e(t,r){var n=0;for(var a=0;a<r/2;a++){var i=Math.round(t[2*a+1]/r)*8192+Math.round(t[2*a]/r)+n;t[a]=i&67108863;if(i<67108864){n=0}else{n=i/67108864|0}}return t};g.prototype.convert13b=function e(t,r,a,i){var o=0;for(var s=0;s<r;s++){o=o+(t[s]|0);a[2*s]=o&8191;o=o>>>13;a[2*s+1]=o&8191;o=o>>>13}for(s=2*r;s<i;++s){a[s]=0}n(o===0);n((o&~8191)===0)};g.prototype.stub=function e(t){var r=new Array(t);for(var n=0;n<t;n++){r[n]=0}return r};g.prototype.mulp=function e(t,r,n){var a=2*this.guessLen13b(t.length,r.length);var i=this.makeRBT(a);var o=this.stub(a);var s=new Array(a);var l=new Array(a);var u=new Array(a);var c=new Array(a);var f=new Array(a);var h=new Array(a);var p=n.words;p.length=a;this.convert13b(t.words,t.length,s,a);this.convert13b(r.words,r.length,c,a);this.transform(s,o,l,u,a,i);this.transform(c,o,f,h,a,i);for(var d=0;d<a;d++){var v=l[d]*f[d]-u[d]*h[d];u[d]=l[d]*h[d]+u[d]*f[d];l[d]=v}this.conjugate(l,u,a);this.transform(l,u,p,o,a,i);this.conjugate(p,o,a);this.normalize13b(p,a);n.negative=t.negative^r.negative;n.length=t.length+r.length;return n.strip()};i.prototype.mul=function e(t){var r=new i(null);r.words=new Array(this.length+t.length);return this.mulTo(t,r)};i.prototype.mulf=function e(t){var r=new i(null);r.words=new Array(this.length+t.length);return m(this,t,r)};i.prototype.imul=function e(t){return this.clone().mulTo(t,this)};i.prototype.imuln=function e(t){n(typeof t==="number");n(t<67108864);var r=0;for(var a=0;a<this.length;a++){var i=(this.words[a]|0)*t;var o=(i&67108863)+(r&67108863);r>>=26;r+=i/67108864|0;r+=o>>>26;this.words[a]=o&67108863}if(r!==0){this.words[a]=r;this.length++}return this};i.prototype.muln=function e(t){return this.clone().imuln(t)};i.prototype.sqr=function e(){return this.mul(this)};i.prototype.isqr=function e(){return this.imul(this.clone())};i.prototype.pow=function e(t){var r=h(t);if(r.length===0)return new i(1);var n=this;for(var a=0;a<r.length;a++,n=n.sqr()){if(r[a]!==0)break}if(++a<r.length){for(var o=n.sqr();a<r.length;a++,o=o.sqr()){if(r[a]===0)continue;n=n.mul(o)}}return n};i.prototype.iushln=function e(t){n(typeof t==="number"&&t>=0);var r=t%26;var a=(t-r)/26;var i=67108863>>>26-r<<26-r;var o;if(r!==0){var s=0;for(o=0;o<this.length;o++){var l=this.words[o]&i;var u=(this.words[o]|0)-l<<r;this.words[o]=u|s;s=l>>>26-r}if(s){this.words[o]=s;this.length++}}if(a!==0){for(o=this.length-1;o>=0;o--){this.words[o+a]=this.words[o]}for(o=0;o<a;o++){this.words[o]=0}this.length+=a}return this.strip()};i.prototype.ishln=function e(t){n(this.negative===0);return this.iushln(t)};i.prototype.iushrn=function e(t,r,a){n(typeof t==="number"&&t>=0);var i;if(r){i=(r-r%26)/26}else{i=0}var o=t%26;var s=Math.min((t-o)/26,this.length);var l=67108863^67108863>>>o<<o;var u=a;i-=s;i=Math.max(0,i);if(u){for(var c=0;c<s;c++){u.words[c]=this.words[c]}u.length=s}if(s===0){}else if(this.length>s){this.length-=s;for(c=0;c<this.length;c++){this.words[c]=this.words[c+s]}}else{this.words[0]=0;this.length=1}var f=0;for(c=this.length-1;c>=0&&(f!==0||c>=i);c--){var h=this.words[c]|0;this.words[c]=f<<26-o|h>>>o;f=h&l}if(u&&f!==0){u.words[u.length++]=f}if(this.length===0){this.words[0]=0;this.length=1}return this.strip()};i.prototype.ishrn=function e(t,r,a){n(this.negative===0);return this.iushrn(t,r,a)};i.prototype.shln=function e(t){return this.clone().ishln(t)};i.prototype.ushln=function e(t){return this.clone().iushln(t)};i.prototype.shrn=function e(t){return this.clone().ishrn(t)};i.prototype.ushrn=function e(t){return this.clone().iushrn(t)};i.prototype.testn=function e(t){n(typeof t==="number"&&t>=0);var r=t%26;var a=(t-r)/26;var i=1<<r;if(this.length<=a)return false;var o=this.words[a];return!!(o&i)};i.prototype.imaskn=function e(t){n(typeof t==="number"&&t>=0);var r=t%26;var a=(t-r)/26;n(this.negative===0,"imaskn works only with positive numbers");if(this.length<=a){return this}if(r!==0){a++}this.length=Math.min(a,this.length);if(r!==0){var i=67108863^67108863>>>r<<r;this.words[this.length-1]&=i}return this.strip()};i.prototype.maskn=function e(t){return this.clone().imaskn(t)};i.prototype.iaddn=function e(t){n(typeof t==="number");n(t<67108864);if(t<0)return this.isubn(-t);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<t){this.words[0]=t-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(t);this.negative=1;return this}return this._iaddn(t)};i.prototype._iaddn=function e(t){this.words[0]+=t;for(var r=0;r<this.length&&this.words[r]>=67108864;r++){this.words[r]-=67108864;if(r===this.length-1){this.words[r+1]=1}else{this.words[r+1]++}}this.length=Math.max(this.length,r+1);return this};i.prototype.isubn=function e(t){n(typeof t==="number");n(t<67108864);if(t<0)return this.iaddn(-t);if(this.negative!==0){this.negative=0;this.iaddn(t);this.negative=1;return this}this.words[0]-=t;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var r=0;r<this.length&&this.words[r]<0;r++){this.words[r]+=67108864;this.words[r+1]-=1}}return this.strip()};i.prototype.addn=function e(t){return this.clone().iaddn(t)};i.prototype.subn=function e(t){return this.clone().isubn(t)};i.prototype.iabs=function e(){this.negative=0;return this};i.prototype.abs=function e(){return this.clone().iabs()};i.prototype._ishlnsubmul=function e(t,r,a){var i=t.length+a;var o;this._expand(i);var s;var l=0;for(o=0;o<t.length;o++){s=(this.words[o+a]|0)+l;var u=(t.words[o]|0)*r;s-=u&67108863;l=(s>>26)-(u/67108864|0);this.words[o+a]=s&67108863}for(;o<this.length-a;o++){s=(this.words[o+a]|0)+l;l=s>>26;this.words[o+a]=s&67108863}if(l===0)return this.strip();n(l===-1);l=0;for(o=0;o<this.length;o++){s=-(this.words[o]|0)+l;l=s>>26;this.words[o]=s&67108863}this.negative=1;return this.strip()};i.prototype._wordDiv=function e(t,r){var n=this.length-t.length;var a=this.clone();var o=t;var s=o.words[o.length-1]|0;var l=this._countBits(s);n=26-l;if(n!==0){o=o.ushln(n);a.iushln(n);s=o.words[o.length-1]|0}var u=a.length-o.length;var c;if(r!=="mod"){c=new i(null);c.length=u+1;c.words=new Array(c.length);for(var f=0;f<c.length;f++){c.words[f]=0}}var h=a.clone()._ishlnsubmul(o,1,u);if(h.negative===0){a=h;if(c){c.words[u]=1}}for(var p=u-1;p>=0;p--){var d=(a.words[o.length+p]|0)*67108864+(a.words[o.length+p-1]|0);d=Math.min(d/s|0,67108863);a._ishlnsubmul(o,d,p);while(a.negative!==0){d--;a.negative=0;a._ishlnsubmul(o,1,p);if(!a.isZero()){a.negative^=1}}if(c){c.words[p]=d}}if(c){c.strip()}a.strip();if(r!=="div"&&n!==0){a.iushrn(n)}return{div:c||null,mod:a}};i.prototype.divmod=function e(t,r,a){n(!t.isZero());if(this.isZero()){return{div:new i(0),mod:new i(0)}}var o,s,l;if(this.negative!==0&&t.negative===0){l=this.neg().divmod(t,r);if(r!=="mod"){o=l.div.neg()}if(r!=="div"){s=l.mod.neg();if(a&&s.negative!==0){s.iadd(t)}}return{div:o,mod:s}}if(this.negative===0&&t.negative!==0){l=this.divmod(t.neg(),r);if(r!=="mod"){o=l.div.neg()}return{div:o,mod:l.mod}}if((this.negative&t.negative)!==0){l=this.neg().divmod(t.neg(),r);if(r!=="div"){s=l.mod.neg();if(a&&s.negative!==0){s.isub(t)}}return{div:l.div,mod:s}}if(t.length>this.length||this.cmp(t)<0){return{div:new i(0),mod:this}}if(t.length===1){if(r==="div"){return{div:this.divn(t.words[0]),mod:null}}if(r==="mod"){return{div:null,mod:new i(this.modn(t.words[0]))}}return{div:this.divn(t.words[0]),mod:new i(this.modn(t.words[0]))}}return this._wordDiv(t,r)};i.prototype.div=function e(t){return this.divmod(t,"div",false).div};i.prototype.mod=function e(t){return this.divmod(t,"mod",false).mod};i.prototype.umod=function e(t){return this.divmod(t,"mod",true).mod};i.prototype.divRound=function e(t){var r=this.divmod(t);if(r.mod.isZero())return r.div;var n=r.div.negative!==0?r.mod.isub(t):r.mod;var a=t.ushrn(1);var i=t.andln(1);var o=n.cmp(a);if(o<0||i===1&&o===0)return r.div;return r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)};i.prototype.modn=function e(t){n(t<=67108863);var r=(1<<26)%t;var a=0;for(var i=this.length-1;i>=0;i--){a=(r*a+(this.words[i]|0))%t}return a};i.prototype.idivn=function e(t){n(t<=67108863);var r=0;for(var a=this.length-1;a>=0;a--){var i=(this.words[a]|0)+r*67108864;this.words[a]=i/t|0;r=i%t}return this.strip()};i.prototype.divn=function e(t){return this.clone().idivn(t)};i.prototype.egcd=function e(t){n(t.negative===0);n(!t.isZero());var r=this;var a=t.clone();if(r.negative!==0){r=r.umod(t)}else{r=r.clone()}var o=new i(1);var s=new i(0);var l=new i(0);var u=new i(1);var c=0;while(r.isEven()&&a.isEven()){r.iushrn(1);a.iushrn(1);++c}var f=a.clone();var h=r.clone();while(!r.isZero()){for(var p=0,d=1;(r.words[0]&d)===0&&p<26;++p,d<<=1);if(p>0){r.iushrn(p);while(p-- >0){if(o.isOdd()||s.isOdd()){o.iadd(f);s.isub(h)}o.iushrn(1);s.iushrn(1)}}for(var v=0,m=1;(a.words[0]&m)===0&&v<26;++v,m<<=1);if(v>0){a.iushrn(v);while(v-- >0){if(l.isOdd()||u.isOdd()){l.iadd(f);u.isub(h)}l.iushrn(1);u.iushrn(1)}}if(r.cmp(a)>=0){r.isub(a);o.isub(l);s.isub(u)}else{a.isub(r);l.isub(o);u.isub(s)}}return{a:l,b:u,gcd:a.iushln(c)}};i.prototype._invmp=function e(t){n(t.negative===0);n(!t.isZero());var r=this;var a=t.clone();if(r.negative!==0){r=r.umod(t)}else{r=r.clone()}var o=new i(1);var s=new i(0);var l=a.clone();while(r.cmpn(1)>0&&a.cmpn(1)>0){for(var u=0,c=1;(r.words[0]&c)===0&&u<26;++u,c<<=1);if(u>0){r.iushrn(u);while(u-- >0){if(o.isOdd()){o.iadd(l)}o.iushrn(1)}}for(var f=0,h=1;(a.words[0]&h)===0&&f<26;++f,h<<=1);if(f>0){a.iushrn(f);while(f-- >0){if(s.isOdd()){s.iadd(l)}s.iushrn(1)}}if(r.cmp(a)>=0){r.isub(a);o.isub(s)}else{a.isub(r);s.isub(o)}}var p;if(r.cmpn(1)===0){p=o}else{p=s}if(p.cmpn(0)<0){p.iadd(t)}return p};i.prototype.gcd=function e(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var r=this.clone();var n=t.clone();r.negative=0;n.negative=0;for(var a=0;r.isEven()&&n.isEven();a++){r.iushrn(1);n.iushrn(1)}do{while(r.isEven()){r.iushrn(1)}while(n.isEven()){n.iushrn(1)}var i=r.cmp(n);if(i<0){var o=r;r=n;n=o}else if(i===0||n.cmpn(1)===0){break}r.isub(n)}while(true);return n.iushln(a)};i.prototype.invm=function e(t){return this.egcd(t).a.umod(t)};i.prototype.isEven=function e(){return(this.words[0]&1)===0};i.prototype.isOdd=function e(){return(this.words[0]&1)===1};i.prototype.andln=function e(t){return this.words[0]&t};i.prototype.bincn=function e(t){n(typeof t==="number");var r=t%26;var a=(t-r)/26;var i=1<<r;if(this.length<=a){this._expand(a+1);this.words[a]|=i;return this}var o=i;for(var s=a;o!==0&&s<this.length;s++){var l=this.words[s]|0;l+=o;o=l>>>26;l&=67108863;this.words[s]=l}if(o!==0){this.words[s]=o;this.length++}return this};i.prototype.isZero=function e(){return this.length===1&&this.words[0]===0};i.prototype.cmpn=function e(t){var r=t<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();var a;if(this.length>1){a=1}else{if(r){t=-t}n(t<=67108863,"Number is too big");var i=this.words[0]|0;a=i===t?0:i<t?-1:1}if(this.negative!==0)return-a|0;return a};i.prototype.cmp=function e(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var r=this.ucmp(t);if(this.negative!==0)return-r|0;return r};i.prototype.ucmp=function e(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;var r=0;for(var n=this.length-1;n>=0;n--){var a=this.words[n]|0;var i=t.words[n]|0;if(a===i)continue;if(a<i){r=-1}else if(a>i){r=1}break}return r};i.prototype.gtn=function e(t){return this.cmpn(t)===1};i.prototype.gt=function e(t){return this.cmp(t)===1};i.prototype.gten=function e(t){return this.cmpn(t)>=0};i.prototype.gte=function e(t){return this.cmp(t)>=0};i.prototype.ltn=function e(t){return this.cmpn(t)===-1};i.prototype.lt=function e(t){return this.cmp(t)===-1};i.prototype.lten=function e(t){return this.cmpn(t)<=0};i.prototype.lte=function e(t){return this.cmp(t)<=0};i.prototype.eqn=function e(t){return this.cmpn(t)===0};i.prototype.eq=function e(t){return this.cmp(t)===0};i.red=function e(t){return new k(t)};i.prototype.toRed=function e(t){n(!this.red,"Already a number in reduction context");n(this.negative===0,"red works only with positives");return t.convertTo(this)._forceRed(t)};i.prototype.fromRed=function e(){n(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};i.prototype._forceRed=function e(t){this.red=t;return this};i.prototype.forceRed=function e(t){n(!this.red,"Already a number in reduction context");return this._forceRed(t)};i.prototype.redAdd=function e(t){n(this.red,"redAdd works only with red numbers");return this.red.add(this,t)};i.prototype.redIAdd=function e(t){n(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,t)};i.prototype.redSub=function e(t){n(this.red,"redSub works only with red numbers");return this.red.sub(this,t)};i.prototype.redISub=function e(t){n(this.red,"redISub works only with red numbers");return this.red.isub(this,t)};i.prototype.redShl=function e(t){n(this.red,"redShl works only with red numbers");return this.red.shl(this,t)};i.prototype.redMul=function e(t){n(this.red,"redMul works only with red numbers");this.red._verify2(this,t);return this.red.mul(this,t)};i.prototype.redIMul=function e(t){n(this.red,"redMul works only with red numbers");this.red._verify2(this,t);return this.red.imul(this,t)};i.prototype.redSqr=function e(){n(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};i.prototype.redISqr=function e(){n(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};i.prototype.redSqrt=function e(){n(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};i.prototype.redInvm=function e(){n(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};i.prototype.redNeg=function e(){n(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};i.prototype.redPow=function e(t){n(this.red&&!t.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,t)};var y={k256:null,p224:null,p192:null,p25519:null};function x(e,t){this.name=e;this.p=new i(t,16);this.n=this.p.bitLength();this.k=new i(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}x.prototype._tmp=function e(){var t=new i(null);t.words=new Array(Math.ceil(this.n/13));return t};x.prototype.ireduce=function e(t){var r=t;var n;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);n=r.bitLength()}while(n>this.n);var a=n<this.n?-1:r.ucmp(this.p);if(a===0){r.words[0]=0;r.length=1}else if(a>0){r.isub(this.p)}else{r.strip()}return r};x.prototype.split=function e(t,r){t.iushrn(this.n,0,r)};x.prototype.imulK=function e(t){return t.imul(this.k)};function _(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(_,x);_.prototype.split=function e(t,r){var n=4194303;var a=Math.min(t.length,9);for(var i=0;i<a;i++){r.words[i]=t.words[i]}r.length=a;if(t.length<=9){t.words[0]=0;t.length=1;return}var o=t.words[9];r.words[r.length++]=o&n;for(i=10;i<t.length;i++){var s=t.words[i]|0;t.words[i-10]=(s&n)<<4|o>>>22;o=s}o>>>=22;t.words[i-10]=o;if(o===0&&t.length>10){t.length-=10}else{t.length-=9}};_.prototype.imulK=function e(t){t.words[t.length]=0;t.words[t.length+1]=0;t.length+=2;var r=0;for(var n=0;n<t.length;n++){var a=t.words[n]|0;r+=a*977;t.words[n]=r&67108863;r=a*64+(r/67108864|0)}if(t.words[t.length-1]===0){t.length--;if(t.words[t.length-1]===0){t.length--}}return t};function b(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(b,x);function w(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(w,x);function T(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(T,x);T.prototype.imulK=function e(t){var r=0;for(var n=0;n<t.length;n++){var a=(t.words[n]|0)*19+r;var i=a&67108863;a>>>=26;t.words[n]=i;r=a}if(r!==0){t.words[t.length++]=r}return t};i._prime=function e(t){if(y[t])return y[t];var e;if(t==="k256"){e=new _}else if(t==="p224"){e=new b}else if(t==="p192"){e=new w}else if(t==="p25519"){e=new T}else{throw new Error("Unknown prime "+t)}y[t]=e;return e};function k(e){if(typeof e==="string"){var t=i._prime(e);this.m=t.p;this.prime=t}else{n(e.gtn(1),"modulus must be greater than 1");this.m=e;this.prime=null}}k.prototype._verify1=function e(t){n(t.negative===0,"red works only with positives");n(t.red,"red works only with red numbers")};k.prototype._verify2=function e(t,r){n((t.negative|r.negative)===0,"red works only with positives");n(t.red&&t.red===r.red,"red works only with red numbers")};k.prototype.imod=function e(t){if(this.prime)return this.prime.ireduce(t)._forceRed(this);return t.umod(this.m)._forceRed(this)};k.prototype.neg=function e(t){if(t.isZero()){return t.clone()}return this.m.sub(t)._forceRed(this)};k.prototype.add=function e(t,r){this._verify2(t,r);var n=t.add(r);if(n.cmp(this.m)>=0){n.isub(this.m)}return n._forceRed(this)};k.prototype.iadd=function e(t,r){this._verify2(t,r);var n=t.iadd(r);if(n.cmp(this.m)>=0){n.isub(this.m)}return n};k.prototype.sub=function e(t,r){this._verify2(t,r);var n=t.sub(r);if(n.cmpn(0)<0){n.iadd(this.m)}return n._forceRed(this)};k.prototype.isub=function e(t,r){this._verify2(t,r);var n=t.isub(r);if(n.cmpn(0)<0){n.iadd(this.m)}return n};k.prototype.shl=function e(t,r){this._verify1(t);return this.imod(t.ushln(r))};k.prototype.imul=function e(t,r){this._verify2(t,r);return this.imod(t.imul(r))};k.prototype.mul=function e(t,r){this._verify2(t,r);return this.imod(t.mul(r))};k.prototype.isqr=function e(t){return this.imul(t,t.clone())};k.prototype.sqr=function e(t){return this.mul(t,t)};k.prototype.sqrt=function e(t){if(t.isZero())return t.clone();var r=this.m.andln(3);n(r%2===1);if(r===3){var a=this.m.add(new i(1)).iushrn(2);return this.pow(t,a)}var o=this.m.subn(1);var s=0;while(!o.isZero()&&o.andln(1)===0){s++;o.iushrn(1)}n(!o.isZero());var l=new i(1).toRed(this);var u=l.redNeg();var c=this.m.subn(1).iushrn(1);var f=this.m.bitLength();f=new i(2*f*f).toRed(this);while(this.pow(f,c).cmp(u)!==0){f.redIAdd(u)}var h=this.pow(f,o);var p=this.pow(t,o.addn(1).iushrn(1));var d=this.pow(t,o);var v=s;while(d.cmp(l)!==0){var m=d;for(var g=0;m.cmp(l)!==0;g++){m=m.redSqr()}n(g<v);var y=this.pow(h,new i(1).iushln(v-g-1));p=p.redMul(y);h=y.redSqr();d=d.redMul(h);v=g}return p};k.prototype.invm=function e(t){var r=t._invmp(this.m);if(r.negative!==0){r.negative=0;return this.imod(r).redNeg()}else{return this.imod(r)}};k.prototype.pow=function e(t,r){if(r.isZero())return new i(1).toRed(this);if(r.cmpn(1)===0)return t.clone();var n=4;var a=new Array(1<<n);a[0]=new i(1).toRed(this);a[1]=t;for(var o=2;o<a.length;o++){a[o]=this.mul(a[o-1],t)}var s=a[0];var l=0;var u=0;var c=r.bitLength()%26;if(c===0){c=26}for(o=r.length-1;o>=0;o--){var f=r.words[o];for(var h=c-1;h>=0;h--){var p=f>>h&1;if(s!==a[0]){s=this.sqr(s)}if(p===0&&l===0){u=0;continue}l<<=1;l|=p;u++;if(u!==n&&(o!==0||h!==0))continue;s=this.mul(s,a[l]);u=0;l=0}c=26}return s};k.prototype.convertTo=function e(t){var r=t.umod(this.m);return r===t?r.clone():r};k.prototype.convertFrom=function e(t){var r=t.clone();r.red=null;return r};i.mont=function e(t){return new A(t)};function A(e){k.call(this,e);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new i(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}a(A,k);A.prototype.convertTo=function e(t){return this.imod(t.ushln(this.shift))};A.prototype.convertFrom=function e(t){var r=this.imod(t.mul(this.rinv));r.red=null;return r};A.prototype.imul=function e(t,r){if(t.isZero()||r.isZero()){t.words[0]=0;t.length=1;return t}var n=t.imul(r);var a=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var i=n.isub(a).iushrn(this.shift);var o=i;if(i.cmp(this.m)>=0){o=i.isub(this.m)}else if(i.cmpn(0)<0){o=i.iadd(this.m)}return o._forceRed(this)};A.prototype.mul=function e(t,r){if(t.isZero()||r.isZero())return new i(0)._forceRed(this);var n=t.mul(r);var a=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var o=n.isub(a).iushrn(this.shift);var s=o;if(o.cmp(this.m)>=0){s=o.isub(this.m)}else if(o.cmpn(0)<0){s=o.iadd(this.m)}return s._forceRed(this)};A.prototype.invm=function e(t){var r=this.imod(t._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(typeof t==="undefined"||t,this)},{buffer:108}],100:[function(e,t,r){"use strict";t.exports=n;function n(e){var t,r,n;var a=e.length;var i=0;for(t=0;t<a;++t){i+=e[t].length}var o=new Array(i);var s=0;for(t=0;t<a;++t){var l=e[t];var u=l.length;for(r=0;r<u;++r){var c=o[s++]=new Array(u-1);var f=0;for(n=0;n<u;++n){if(n===r){continue}c[f++]=l[n]}if(r&1){var h=c[1];c[1]=c[0];c[0]=h}}}return o}},{}],101:[function(e,t,r){"use strict";t.exports=p;var n=e("typedarray-pool");var a=e("./lib/sweep");var i=e("./lib/intersect");function o(e,t){for(var r=0;r<e;++r){if(!(t[r]<=t[r+e])){return true}}return false}function s(e,t,r,n){var a=0;var i=0;for(var s=0,l=e.length;s<l;++s){var u=e[s];if(o(t,u)){continue}for(var c=0;c<2*t;++c){r[a++]=u[c]}n[i++]=s}return i}function l(e,t,r,o){var l=e.length;var u=t.length;if(l<=0||u<=0){return}var c=e[0].length>>>1;if(c<=0){return}var f;var h=n.mallocDouble(2*c*l);var p=n.mallocInt32(l);l=s(e,c,h,p);if(l>0){if(c===1&&o){a.init(l);f=a.sweepComplete(c,r,0,l,h,p,0,l,h,p)}else{var d=n.mallocDouble(2*c*u);var v=n.mallocInt32(u);u=s(t,c,d,v);if(u>0){a.init(l+u);if(c===1){f=a.sweepBipartite(c,r,0,l,h,p,0,u,d,v)}else{f=i(c,r,o,l,h,p,u,d,v)}n.free(d);n.free(v)}}n.free(h);n.free(p)}return f}var u;function c(e,t){u.push([e,t])}function f(e){u=[];l(e,e,c,true);return u}function h(e,t){u=[];l(e,t,c,false);return u}function p(e,t,r){var n;switch(arguments.length){case 1:return f(e);case 2:if(typeof t==="function"){return l(e,e,t,true)}else{return h(e,t)}case 3:return l(e,t,r,false);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":103,"./lib/sweep":107,"typedarray-pool":595}],102:[function(e,t,r){"use strict";var n="d";var a="ax";var i="vv";var o="fp";var s="es";var l="rs";var u="re";var c="rb";var f="ri";var h="rp";var p="bs";var d="be";var v="bb";var m="bi";var g="bp";var y="rv";var x="Q";var _=[n,a,i,l,u,c,f,p,d,v,m];function b(e,t,r){var o="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(r?"Full":"");var b=["function ",o,"(",_.join(),"){","var ",s,"=2*",n,";"];var w="for(var i="+l+","+h+"="+s+"*"+l+";"+"i<"+u+";"+"++i,"+h+"+="+s+"){"+"var x0="+c+"["+a+"+"+h+"],"+"x1="+c+"["+a+"+"+h+"+"+n+"],"+"xi="+f+"[i];";var T="for(var j="+p+","+g+"="+s+"*"+p+";"+"j<"+d+";"+"++j,"+g+"+="+s+"){"+"var y0="+v+"["+a+"+"+g+"],"+(r?"y1="+v+"["+a+"+"+g+"+"+n+"],":"")+"yi="+m+"[j];";if(e){b.push(w,x,":",T)}else{b.push(T,x,":",w)}if(r){b.push("if(y1<x0||x1<y0)continue;")}else if(t){b.push("if(y0<=x0||x1<y0)continue;")}else{b.push("if(y0<x0||x1<y0)continue;")}b.push("for(var k="+a+"+1;k<"+n+";++k){"+"var r0="+c+"[k+"+h+"],"+"r1="+c+"[k+"+n+"+"+h+"],"+"b0="+v+"[k+"+g+"],"+"b1="+v+"[k+"+n+"+"+g+"];"+"if(r1<b0||b1<r0)continue "+x+";}"+"var "+y+"="+i+"(");if(t){b.push("yi,xi")}else{b.push("xi,yi")}b.push(");if("+y+"!==void 0)return "+y+";}}}");return{name:o,code:b.join("")}}function w(e){var t="bruteForce"+(e?"Full":"Partial");var r=[];var n=_.slice();if(!e){n.splice(3,0,o)}var a=["function "+t+"("+n.join()+"){"];function i(t,n){var i=b(t,n,e);r.push(i.code);a.push("return "+i.name+"("+_.join()+");")}a.push("if("+u+"-"+l+">"+d+"-"+p+"){");if(e){i(true,false);a.push("}else{");i(false,false)}else{a.push("if("+o+"){");i(true,true);a.push("}else{");i(true,false);a.push("}}else{if("+o+"){");i(false,true);a.push("}else{");i(false,false);a.push("}")}a.push("}}return "+t);var s=r.join("")+a.join("");var c=new Function(s);return c()}r.partial=w(false);r.full=w(true)},{}],103:[function(e,t,r){"use strict";t.exports=C;var n=e("typedarray-pool");var a=e("bit-twiddle");var i=e("./brute");var o=i.partial;var s=i.full;var l=e("./sweep");var u=e("./median");var c=e("./partition");var f=128;var h=1<<22;var p=1<<22;var d=c("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]);var v=c("lo===p0",["p0"]);var m=c("lo<p0",["p0"]);var g=c("hi<=p0",["p0"]);var y=c("lo<=p0&&p0<=hi",["p0"]);var x=c("lo<p0&&p0<=hi",["p0"]);var _=6;var b=2;var w=1024;var T=n.mallocInt32(w);var k=n.mallocDouble(w);function A(e,t){var r=8*a.log2(t+1)*(e+1)|0;var i=a.nextPow2(_*r);if(T.length<i){n.free(T);T=n.mallocInt32(i)}var o=a.nextPow2(b*r);if(k.length<o){n.free(k);k=n.mallocDouble(o)}}function M(e,t,r,n,a,i,o,s,l){var u=_*e;T[u]=t;T[u+1]=r;T[u+2]=n;T[u+3]=a;T[u+4]=i;T[u+5]=o;var c=b*e;k[c]=s;k[c+1]=l}function E(e,t,r,n,a,i,o,s,l,u,c){var f=2*e;var h=l*f;var p=u[h+t];e:for(var d=a,v=a*f;d<i;++d,v+=f){var m=o[v+t];var g=o[v+t+e];if(p<m||g<p){continue}if(n&&p===m){continue}var y=s[d];for(var x=t+1;x<e;++x){var m=o[v+x];var g=o[v+x+e];var _=u[h+x];var b=u[h+x+e];if(g<_||b<m){continue e}}var w;if(n){w=r(c,y)}else{w=r(y,c)}if(w!==void 0){return w}}}function S(e,t,r,n,a,i,o,s,l,u){var c=2*e;var f=s*c;var h=l[f+t];e:for(var p=n,d=n*c;p<a;++p,d+=c){var v=o[p];if(v===u){continue}var m=i[d+t];var g=i[d+t+e];if(h<m||g<h){continue}for(var y=t+1;y<e;++y){var m=i[d+y];var g=i[d+y+e];var x=l[f+y];var _=l[f+y+e];if(g<x||_<m){continue e}}var b=r(v,u);if(b!==void 0){return b}}}function C(e,t,r,n,a,i,c,w,C){A(e,n+c);var L=0;var I=2*e;var O;M(L++,0,0,n,0,c,r?16:0,-Infinity,Infinity);if(!r){M(L++,0,0,c,0,n,1,-Infinity,Infinity)}while(L>0){L-=1;var P=L*_;var D=T[P];var R=T[P+1];var z=T[P+2];var N=T[P+3];var F=T[P+4];var B=T[P+5];var j=L*b;var U=k[j];var H=k[j+1];var V=B&1;var G=!!(B&16);var q=a;var Y=i;var W=w;var X=C;if(V){q=w;Y=C;W=a;X=i}if(B&2){z=m(e,D,R,z,q,Y,H);if(R>=z){continue}}if(B&4){R=g(e,D,R,z,q,Y,U);if(R>=z){continue}}var Z=z-R;var K=F-N;if(G){if(e*Z*(Z+K)<p){O=l.scanComplete(e,D,t,R,z,q,Y,N,F,W,X);if(O!==void 0){return O}continue}}else{if(e*Math.min(Z,K)<f){O=o(e,D,t,V,R,z,q,Y,N,F,W,X);if(O!==void 0){return O}continue}else if(e*Z*K<h){O=l.scanBipartite(e,D,t,V,R,z,q,Y,N,F,W,X);if(O!==void 0){return O}continue}}var J=d(e,D,R,z,q,Y,U,H);if(R<J){if(e*(J-R)<f){O=s(e,D+1,t,R,J,q,Y,N,F,W,X);if(O!==void 0){return O}}else if(D===e-2){if(V){O=l.sweepBipartite(e,t,N,F,W,X,R,J,q,Y)}else{O=l.sweepBipartite(e,t,R,J,q,Y,N,F,W,X)}if(O!==void 0){return O}}else{M(L++,D+1,R,J,N,F,V,-Infinity,Infinity);M(L++,D+1,N,F,R,J,V^1,-Infinity,Infinity)}}if(J<z){var Q=u(e,D,N,F,W,X);var $=W[I*Q+D];var ee=v(e,D,Q,F,W,X,$);if(ee<F){M(L++,D,J,z,ee,F,(V|4)+(G?16:0),$,H)}if(N<Q){M(L++,D,J,z,N,Q,(V|2)+(G?16:0),U,$)}if(Q+1===ee){if(G){O=S(e,D,t,J,z,q,Y,Q,W,X[Q])}else{O=E(e,D,t,V,J,z,q,Y,Q,W,X[Q])}if(O!==void 0){return O}}else if(Q<ee){var te;if(G){te=y(e,D,J,z,q,Y,$);if(J<te){var re=v(e,D,J,te,q,Y,$);if(D===e-2){if(J<re){O=l.sweepComplete(e,t,J,re,q,Y,Q,ee,W,X);if(O!==void 0){return O}}if(re<te){O=l.sweepBipartite(e,t,re,te,q,Y,Q,ee,W,X);if(O!==void 0){return O}}}else{if(J<re){M(L++,D+1,J,re,Q,ee,16,-Infinity,Infinity)}if(re<te){M(L++,D+1,re,te,Q,ee,0,-Infinity,Infinity);M(L++,D+1,Q,ee,re,te,1,-Infinity,Infinity)}}}}else{if(V){te=x(e,D,J,z,q,Y,$)}else{te=y(e,D,J,z,q,Y,$)}if(J<te){if(D===e-2){if(V){O=l.sweepBipartite(e,t,Q,ee,W,X,J,te,q,Y)}else{O=l.sweepBipartite(e,t,J,te,q,Y,Q,ee,W,X)}}else{M(L++,D+1,J,te,Q,ee,V,-Infinity,Infinity);M(L++,D+1,Q,ee,J,te,V^1,-Infinity,Infinity)}}}}}}}},{"./brute":102,"./median":104,"./partition":105,"./sweep":107,"bit-twiddle":97,"typedarray-pool":595}],104:[function(e,t,r){"use strict";t.exports=s;var n=e("./partition");var a=n("lo<p0",["p0"]);var i=8;function o(e,t,r,n,a,i){var o=2*e;var s=o*(r+1)+t;for(var l=r+1;l<n;++l,s+=o){var u=a[s];for(var c=l,f=o*(l-1);c>r&&a[f+t]>u;--c,f-=o){var h=f;var p=f+o;for(var d=0;d<o;++d,++h,++p){var v=a[h];a[h]=a[p];a[p]=v}var m=i[c];i[c]=i[c-1];i[c-1]=m}}}function s(e,t,r,n,s,l){if(n<=r+1){return r}var u=r;var c=n;var f=n+r>>>1;var h=2*e;var p=f;var d=s[h*f+t];while(u<c){if(c-u<i){o(e,t,u,c,s,l);d=s[h*f+t];break}var v=c-u;var m=Math.random()*v+u|0;var g=s[h*m+t];var y=Math.random()*v+u|0;var x=s[h*y+t];var _=Math.random()*v+u|0;var b=s[h*_+t];if(g<=x){if(b>=x){p=y;d=x}else if(g>=b){p=m;d=g}else{p=_;d=b}}else{if(x>=b){p=y;d=x}else if(b>=g){p=m;d=g}else{p=_;d=b}}var w=h*(c-1);var T=h*p;for(var k=0;k<h;++k,++w,++T){var A=s[w];s[w]=s[T];s[T]=A}var M=l[c-1];l[c-1]=l[p];l[p]=M;p=a(e,t,u,c-1,s,l,d);var w=h*(c-1);var T=h*p;for(var k=0;k<h;++k,++w,++T){var A=s[w];s[w]=s[T];s[T]=A}var M=l[c-1];l[c-1]=l[p];l[p]=M;if(f<p){c=p-1;while(u<c&&s[h*(c-1)+t]===d){c-=1}c+=1}else if(p<f){u=p+1;while(u<c&&s[h*u+t]===d){u+=1}}else{break}}return a(e,t,r,f,s,l,s[h*f+t])}},{"./partition":105}],105:[function(e,t,r){"use strict";t.exports=a;var n="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m";function a(e,t){var r="abcdef".split("").concat(t);var a=[];if(e.indexOf("lo")>=0){a.push("lo=e[k+n]")}if(e.indexOf("hi")>=0){a.push("hi=e[k+o]")}r.push(n.replace("_",a.join()).replace("$",e));return Function.apply(void 0,r)}},{}],106:[function(e,t,r){"use strict";t.exports=a;var n=32;function a(e,t){if(t<=4*n){i(0,t-1,e)}else{h(0,t-1,e)}}function i(e,t,r){var n=2*(e+1);for(var a=e+1;a<=t;++a){var i=r[n++];var o=r[n++];var s=a;var l=n-2;while(s-- >e){var u=r[l-2];var c=r[l-1];if(u<i){break}else if(u===i&&c<o){break}r[l]=u;r[l+1]=c;l-=2}r[l]=i;r[l+1]=o}}function o(e,t,r){e*=2;t*=2;var n=r[e];var a=r[e+1];r[e]=r[t];r[e+1]=r[t+1];r[t]=n;r[t+1]=a}function s(e,t,r){e*=2;t*=2;r[e]=r[t];r[e+1]=r[t+1]}function l(e,t,r,n){e*=2;t*=2;r*=2;var a=n[e];var i=n[e+1];n[e]=n[t];n[e+1]=n[t+1];n[t]=n[r];n[t+1]=n[r+1];n[r]=a;n[r+1]=i}function u(e,t,r,n,a){e*=2;t*=2;a[e]=a[t];a[t]=r;a[e+1]=a[t+1];a[t+1]=n}function c(e,t,r){e*=2;t*=2;var n=r[e],a=r[t];if(n<a){return false}else if(n===a){return r[e+1]>r[t+1]}return true}function f(e,t,r,n){e*=2;var a=n[e];if(a<t){return true}else if(a===t){return n[e+1]<r}return false}function h(e,t,r){var a=(t-e+1)/6|0,p=e+a,d=t-a,v=e+t>>1,m=v-a,g=v+a,y=p,x=m,_=v,b=g,w=d,T=e+1,k=t-1,A=0;if(c(y,x,r)){A=y;y=x;x=A}if(c(b,w,r)){A=b;b=w;w=A}if(c(y,_,r)){A=y;y=_;_=A}if(c(x,_,r)){A=x;x=_;_=A}if(c(y,b,r)){A=y;y=b;b=A}if(c(_,b,r)){A=_;_=b;b=A}if(c(x,w,r)){A=x;x=w;w=A}if(c(x,_,r)){A=x;x=_;_=A}if(c(b,w,r)){A=b;b=w;w=A}var M=r[2*x];var E=r[2*x+1];var S=r[2*b];var C=r[2*b+1];var L=2*y;var I=2*_;var O=2*w;var P=2*p;var D=2*v;var R=2*d;for(var z=0;z<2;++z){var N=r[L+z];var F=r[I+z];var B=r[O+z];r[P+z]=N;r[D+z]=F;r[R+z]=B}s(m,e,r);s(g,t,r);for(var j=T;j<=k;++j){if(f(j,M,E,r)){if(j!==T){o(j,T,r)}++T}else{if(!f(j,S,C,r)){while(true){if(!f(k,S,C,r)){if(--k<j){break}continue}else{if(f(k,M,E,r)){l(j,T,k,r);++T;--k}else{o(j,k,r);--k}break}}}}}u(e,T-1,M,E,r);u(t,k+1,S,C,r);if(T-2-e<=n){i(e,T-2,r)}else{h(e,T-2,r)}if(t-(k+2)<=n){i(k+2,t,r)}else{h(k+2,t,r)}if(k-T<=n){i(T,k,r)}else{h(T,k,r)}}},{}],107:[function(e,t,r){"use strict";t.exports={init:v,sweepBipartite:y,sweepComplete:x,scanBipartite:_,scanComplete:b};var n=e("typedarray-pool");var a=e("bit-twiddle");var i=e("./sort");var o=1<<28;var s=1024;var l=n.mallocInt32(s);var u=n.mallocInt32(s);var c=n.mallocInt32(s);var f=n.mallocInt32(s);var h=n.mallocInt32(s);var p=n.mallocInt32(s);var d=n.mallocDouble(s*8);function v(e){var t=a.nextPow2(e);if(l.length<t){n.free(l);l=n.mallocInt32(t)}if(u.length<t){n.free(u);u=n.mallocInt32(t)}if(c.length<t){n.free(c);c=n.mallocInt32(t)}if(f.length<t){n.free(f);f=n.mallocInt32(t)}if(h.length<t){n.free(h);h=n.mallocInt32(t)}if(p.length<t){n.free(p);p=n.mallocInt32(t)}var r=8*t;if(d.length<r){n.free(d);d=n.mallocDouble(r)}}function m(e,t,r,n){var a=t[n];var i=e[r-1];e[a]=i;t[i]=a}function g(e,t,r,n){e[r]=n;t[n]=r}function y(e,t,r,n,a,s,h,p,v,y){var x=0;var _=2*e;var b=e-1;var w=_-1;for(var T=r;T<n;++T){var k=s[T];var A=_*T;d[x++]=a[A+b];d[x++]=-(k+1);d[x++]=a[A+w];d[x++]=k}for(var T=h;T<p;++T){var k=y[T]+o;var M=_*T;d[x++]=v[M+b];d[x++]=-k;d[x++]=v[M+w];d[x++]=k}var E=x>>>1;i(d,E);var S=0;var C=0;for(var T=0;T<E;++T){var L=d[2*T+1]|0;if(L>=o){L=L-o|0;m(c,f,C--,L)}else if(L>=0){m(l,u,S--,L)}else if(L<=-o){L=-L-o|0;for(var I=0;I<S;++I){var O=t(l[I],L);if(O!==void 0){return O}}g(c,f,C++,L)}else{L=-L-1|0;for(var I=0;I<C;++I){var O=t(L,c[I]);if(O!==void 0){return O}}g(l,u,S++,L)}}}function x(e,t,r,n,a,o,s,v,y,x){var _=0;var b=2*e;var w=e-1;var T=b-1;for(var k=r;k<n;++k){var A=o[k]+1<<1;var M=b*k;d[_++]=a[M+w];d[_++]=-A;d[_++]=a[M+T];d[_++]=A}for(var k=s;k<v;++k){var A=x[k]+1<<1;var E=b*k;d[_++]=y[E+w];d[_++]=-A|1;d[_++]=y[E+T];d[_++]=A|1}var S=_>>>1;i(d,S);var C=0;var L=0;var I=0;for(var k=0;k<S;++k){var O=d[2*k+1]|0;var P=O&1;if(k<S-1&&O>>1===d[2*k+3]>>1){P=2;k+=1}if(O<0){var D=-(O>>1)-1;for(var R=0;R<I;++R){var z=t(h[R],D);if(z!==void 0){return z}}if(P!==0){for(var R=0;R<C;++R){var z=t(l[R],D);if(z!==void 0){return z}}}if(P!==1){for(var R=0;R<L;++R){var z=t(c[R],D);if(z!==void 0){return z}}}if(P===0){g(l,u,C++,D)}else if(P===1){g(c,f,L++,D)}else if(P===2){g(h,p,I++,D)}}else{var D=(O>>1)-1;if(P===0){m(l,u,C--,D)}else if(P===1){m(c,f,L--,D)}else if(P===2){m(h,p,I--,D)}}}}function _(e,t,r,n,a,s,c,f,h,p,v,y){var x=0;var _=2*e;var b=t;var w=t+e;var T=1;var k=1;if(n){k=o}else{T=o}for(var A=a;A<s;++A){var M=A+T;var E=_*A;d[x++]=c[E+b];d[x++]=-M;d[x++]=c[E+w];d[x++]=M}for(var A=h;A<p;++A){var M=A+k;var S=_*A;d[x++]=v[S+b];d[x++]=-M}var C=x>>>1;i(d,C);var L=0;for(var A=0;A<C;++A){var I=d[2*A+1]|0;if(I<0){var M=-I;var O=false;if(M>=o){O=!n;M-=o}else{O=!!n;M-=1}if(O){g(l,u,L++,M)}else{var P=y[M];var D=_*M;var R=v[D+t+1];var z=v[D+t+1+e];e:for(var N=0;N<L;++N){var F=l[N];var B=_*F;if(z<c[B+t+1]||c[B+t+1+e]<R){continue}for(var j=t+2;j<e;++j){if(v[D+j+e]<c[B+j]||c[B+j+e]<v[D+j]){continue e}}var U=f[F];var H;if(n){H=r(P,U)}else{H=r(U,P)}if(H!==void 0){return H}}}}else{m(l,u,L--,I-T)}}}function b(e,t,r,n,a,s,u,c,f,h,p){var v=0;var m=2*e;var g=t;var y=t+e;for(var x=n;x<a;++x){var _=x+o;var b=m*x;d[v++]=s[b+g];d[v++]=-_;d[v++]=s[b+y];d[v++]=_}for(var x=c;x<f;++x){var _=x+1;var w=m*x;d[v++]=h[w+g];d[v++]=-_}var T=v>>>1;i(d,T);var k=0;for(var x=0;x<T;++x){var A=d[2*x+1]|0;if(A<0){var _=-A;if(_>=o){l[k++]=_-o}else{_-=1;var M=p[_];var E=m*_;var S=h[E+t+1];var C=h[E+t+1+e];e:for(var L=0;L<k;++L){var I=l[L];var O=u[I];if(O===M){break}var P=m*I;if(C<s[P+t+1]||s[P+t+1+e]<S){continue}for(var D=t+2;D<e;++D){if(h[E+D+e]<s[P+D]||s[P+D+e]<h[E+D]){continue e}}var R=r(O,M);if(R!==void 0){return R}}}}else{var _=A-o;for(var L=k-1;L>=0;--L){if(l[L]===_){for(var D=L+1;D<k;++D){l[D-1]=l[D]}break}}--k}}}},{"./sort":106,"bit-twiddle":97,"typedarray-pool":595}],108:[function(e,t,r){},{}],109:[function(e,t,r){arguments[4][108][0].apply(r,arguments)},{dup:108}],110:[function(e,t,r){"use strict";var n=typeof Reflect==="object"?Reflect:null;var a=n&&typeof n.apply==="function"?n.apply:function e(t,r,n){return Function.prototype.apply.call(t,r,n)};var i;if(n&&typeof n.ownKeys==="function"){i=n.ownKeys}else if(Object.getOwnPropertySymbols){i=function e(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}}else{i=function e(t){return Object.getOwnPropertyNames(t)}}function o(e){if(console&&console.warn)console.warn(e)}var s=Number.isNaN||function e(t){return t!==t};function l(){l.init.call(this)}t.exports=l;t.exports.once=_;l.EventEmitter=l;l.prototype._events=undefined;l.prototype._eventsCount=0;l.prototype._maxListeners=undefined;var u=10;function c(e){if(typeof e!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:true,get:function(){return u},set:function(e){if(typeof e!=="number"||e<0||s(e)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".")}u=e}});l.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};l.prototype.setMaxListeners=function e(t){if(typeof t!=="number"||t<0||s(t)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".")}this._maxListeners=t;return this};function f(e){if(e._maxListeners===undefined)return l.defaultMaxListeners;return e._maxListeners}l.prototype.getMaxListeners=function e(){return f(this)};l.prototype.emit=function e(t){var r=[];for(var n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error";var o=this._events;if(o!==undefined)i=i&&o.error===undefined;else if(!i)return false;if(i){var s;if(r.length>0)s=r[0];if(s instanceof Error){throw s}var l=new Error("Unhandled error."+(s?" ("+s.message+")":""));l.context=s;throw l}var u=o[t];if(u===undefined)return false;if(typeof u==="function"){a(u,this,r)}else{var c=u.length;var f=g(u,c);for(var n=0;n<c;++n)a(f[n],this,r)}return true};function h(e,t,r,n){var a;var i;var s;c(r);i=e._events;if(i===undefined){i=e._events=Object.create(null);e._eventsCount=0}else{if(i.newListener!==undefined){e.emit("newListener",t,r.listener?r.listener:r);i=e._events}s=i[t]}if(s===undefined){s=i[t]=r;++e._eventsCount}else{if(typeof s==="function"){s=i[t]=n?[r,s]:[s,r]}else if(n){s.unshift(r)}else{s.push(r)}a=f(e);if(a>0&&s.length>a&&!s.warned){s.warned=true;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");l.name="MaxListenersExceededWarning";l.emitter=e;l.type=t;l.count=s.length;o(l)}}return e}l.prototype.addListener=function e(t,r){return h(this,t,r,false)};l.prototype.on=l.prototype.addListener;l.prototype.prependListener=function e(t,r){return h(this,t,r,true)};function p(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function d(e,t,r){var n={fired:false,wrapFn:undefined,target:e,type:t,listener:r};var a=p.bind(n);a.listener=r;n.wrapFn=a;return a}l.prototype.once=function e(t,r){c(r);this.on(t,d(this,t,r));return this};l.prototype.prependOnceListener=function e(t,r){c(r);this.prependListener(t,d(this,t,r));return this};l.prototype.removeListener=function e(t,r){var n,a,i,o,s;c(r);a=this._events;if(a===undefined)return this;n=a[t];if(n===undefined)return this;if(n===r||n.listener===r){if(--this._eventsCount===0)this._events=Object.create(null);else{delete a[t];if(a.removeListener)this.emit("removeListener",t,n.listener||r)}}else if(typeof n!=="function"){i=-1;for(o=n.length-1;o>=0;o--){if(n[o]===r||n[o].listener===r){s=n[o].listener;i=o;break}}if(i<0)return this;if(i===0)n.shift();else{y(n,i)}if(n.length===1)a[t]=n[0];if(a.removeListener!==undefined)this.emit("removeListener",t,s||r)}return this};l.prototype.off=l.prototype.removeListener;l.prototype.removeAllListeners=function e(t){var r,n,a;n=this._events;if(n===undefined)return this;if(n.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(n[t]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete n[t]}return this}if(arguments.length===0){var i=Object.keys(n);var o;for(a=0;a<i.length;++a){o=i[a];if(o==="removeListener")continue;this.removeAllListeners(o)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}r=n[t];if(typeof r==="function"){this.removeListener(t,r)}else if(r!==undefined){for(a=r.length-1;a>=0;a--){this.removeListener(t,r[a])}}return this};function v(e,t,r){var n=e._events;if(n===undefined)return[];var a=n[t];if(a===undefined)return[];if(typeof a==="function")return r?[a.listener||a]:[a];return r?x(a):g(a,a.length)}l.prototype.listeners=function e(t){return v(this,t,true)};l.prototype.rawListeners=function e(t){return v(this,t,false)};l.listenerCount=function(e,t){if(typeof e.listenerCount==="function"){return e.listenerCount(t)}else{return m.call(e,t)}};l.prototype.listenerCount=m;function m(e){var t=this._events;if(t!==undefined){var r=t[e];if(typeof r==="function"){return 1}else if(r!==undefined){return r.length}}return 0}l.prototype.eventNames=function e(){return this._eventsCount>0?i(this._events):[]};function g(e,t){var r=new Array(t);for(var n=0;n<t;++n)r[n]=e[n];return r}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function x(e){var t=new Array(e.length);for(var r=0;r<t.length;++r){t[r]=e[r].listener||e[r]}return t}function _(e,t){return new Promise(function(r,n){function a(){if(i!==undefined){e.removeListener("error",i)}r([].slice.call(arguments))}var i;if(t!=="error"){i=function r(i){e.removeListener(t,a);n(i)};e.once("error",i)}e.once(t,a)})}},{}],111:[function(e,t,r){(function(t){(function(){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";var t=e("base64-js");var n=e("ieee754");r.Buffer=s;r.SlowBuffer=g;r.INSPECT_MAX_BYTES=50;var a=2147483647;r.kMaxLength=a;s.TYPED_ARRAY_SUPPORT=i();if(!s.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function i(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42}catch(e){return false}}Object.defineProperty(s.prototype,"parent",{enumerable:true,get:function(){if(!s.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(s.prototype,"offset",{enumerable:true,get:function(){if(!s.isBuffer(this))return undefined;return this.byteOffset}});function o(e){if(e>a){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var t=new Uint8Array(e);t.__proto__=s.prototype;return t}function s(e,t,r){if(typeof e==="number"){if(typeof t==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return f(e)}return l(e,t,r)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&s[Symbol.species]===s){Object.defineProperty(s,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}s.poolSize=8192;function l(e,t,r){if(typeof e==="string"){return h(e,t)}if(ArrayBuffer.isView(e)){return p(e)}if(e==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer)){return d(e,t,r)}if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var n=e.valueOf&&e.valueOf();if(n!=null&&n!==e){return s.from(n,t,r)}var a=v(e);if(a)return a;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]==="function"){return s.from(e[Symbol.toPrimitive]("string"),t,r)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}s.from=function(e,t,r){return l(e,t,r)};s.prototype.__proto__=Uint8Array.prototype;s.__proto__=Uint8Array;function u(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be of type number')}else if(e<0){throw new RangeError('The value "'+e+'" is invalid for option "size"')}}function c(e,t,r){u(e);if(e<=0){return o(e)}if(t!==undefined){return typeof r==="string"?o(e).fill(t,r):o(e).fill(t)}return o(e)}s.alloc=function(e,t,r){return c(e,t,r)};function f(e){u(e);return o(e<0?0:m(e)|0)}s.allocUnsafe=function(e){return f(e)};s.allocUnsafeSlow=function(e){return f(e)};function h(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!s.isEncoding(t)){throw new TypeError("Unknown encoding: "+t)}var r=y(e,t)|0;var n=o(r);var a=n.write(e,t);if(a!==r){n=n.slice(0,a)}return n}function p(e){var t=e.length<0?0:m(e.length)|0;var r=o(t);for(var n=0;n<t;n+=1){r[n]=e[n]&255}return r}function d(e,t,r){if(t<0||e.byteLength<t){throw new RangeError('"offset" is outside of buffer bounds')}if(e.byteLength<t+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var n;if(t===undefined&&r===undefined){n=new Uint8Array(e)}else if(r===undefined){n=new Uint8Array(e,t)}else{n=new Uint8Array(e,t,r)}n.__proto__=s.prototype;return n}function v(e){if(s.isBuffer(e)){var t=m(e.length)|0;var r=o(t);if(r.length===0){return r}e.copy(r,0,0,t);return r}if(e.length!==undefined){if(typeof e.length!=="number"||J(e.length)){return o(0)}return p(e)}if(e.type==="Buffer"&&Array.isArray(e.data)){return p(e.data)}}function m(e){if(e>=a){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+a.toString(16)+" bytes")}return e|0}function g(e){if(+e!=e){e=0}return s.alloc(+e)}s.isBuffer=function e(t){return t!=null&&t._isBuffer===true&&t!==s.prototype};s.compare=function e(t,r){if(K(t,Uint8Array))t=s.from(t,t.offset,t.byteLength);if(K(r,Uint8Array))r=s.from(r,r.offset,r.byteLength);if(!s.isBuffer(t)||!s.isBuffer(r)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(t===r)return 0;var n=t.length;var a=r.length;for(var i=0,o=Math.min(n,a);i<o;++i){if(t[i]!==r[i]){n=t[i];a=r[i];break}}if(n<a)return-1;if(a<n)return 1;return 0};s.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};s.concat=function e(t,r){if(!Array.isArray(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return s.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var a=s.allocUnsafe(r);var i=0;for(n=0;n<t.length;++n){var o=t[n];if(K(o,Uint8Array)){o=s.from(o)}if(!s.isBuffer(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(a,i);i+=o.length}return a};function y(e,t){if(s.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||K(e,ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof e)}var r=e.length;var n=arguments.length>2&&arguments[2]===true;if(!n&&r===0)return 0;var a=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return X(e).length;default:if(a){return n?-1:q(e).length}t=(""+t).toLowerCase();a=true}}}s.byteLength=y;function x(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return L(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return D(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}s.prototype._isBuffer=true;function _(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}s.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){_(this,r,r+1)}return this};s.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){_(this,r,r+3);_(this,r+1,r+2)}return this};s.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){_(this,r,r+7);_(this,r+1,r+6);_(this,r+2,r+5);_(this,r+3,r+4)}return this};s.prototype.toString=function e(){var t=this.length;if(t===0)return"";if(arguments.length===0)return L(this,0,t);return x.apply(this,arguments)};s.prototype.toLocaleString=s.prototype.toString;s.prototype.equals=function e(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return s.compare(this,t)===0};s.prototype.inspect=function e(){var t="";var n=r.INSPECT_MAX_BYTES;t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim();if(this.length>n)t+=" ... ";return"<Buffer "+t+">"};s.prototype.compare=function e(t,r,n,a,i){if(K(t,Uint8Array)){t=s.from(t,t.offset,t.byteLength)}if(!s.isBuffer(t)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof t)}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(a===undefined){a=0}if(i===undefined){i=this.length}if(r<0||n>t.length||a<0||i>this.length){throw new RangeError("out of range index")}if(a>=i&&r>=n){return 0}if(a>=i){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;a>>>=0;i>>>=0;if(this===t)return 0;var o=i-a;var l=n-r;var u=Math.min(o,l);var c=this.slice(a,i);var f=t.slice(r,n);for(var h=0;h<u;++h){if(c[h]!==f[h]){o=c[h];l=f[h];break}}if(o<l)return-1;if(l<o)return 1;return 0};function b(e,t,r,n,a){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(J(r)){r=a?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(a)return-1;else r=e.length-1}else if(r<0){if(a)r=0;else return-1}if(typeof t==="string"){t=s.from(t,n)}if(s.isBuffer(t)){if(t.length===0){return-1}return w(e,t,r,n,a)}else if(typeof t==="number"){t=t&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(a){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return w(e,[t],r,n,a)}throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,a){var i=1;var o=e.length;var s=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}i=2;o/=2;s/=2;r/=2}}function l(e,t){if(i===1){return e[t]}else{return e.readUInt16BE(t*i)}}var u;if(a){var c=-1;for(u=r;u<o;u++){if(l(e,u)===l(t,c===-1?0:u-c)){if(c===-1)c=u;if(u-c+1===s)return c*i}else{if(c!==-1)u-=u-c;c=-1}}}else{if(r+s>o)r=o-s;for(u=r;u>=0;u--){var f=true;for(var h=0;h<s;h++){if(l(e,u+h)!==l(t,h)){f=false;break}}if(f)return u}}return-1}s.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};s.prototype.indexOf=function e(t,r,n){return b(this,t,r,n,true)};s.prototype.lastIndexOf=function e(t,r,n){return b(this,t,r,n,false)};function T(e,t,r,n){r=Number(r)||0;var a=e.length-r;if(!n){n=a}else{n=Number(n);if(n>a){n=a}}var i=t.length;if(n>i/2){n=i/2}for(var o=0;o<n;++o){var s=parseInt(t.substr(o*2,2),16);if(J(s))return o;e[r+o]=s}return o}function k(e,t,r,n){return Z(q(t,e.length-r),e,r,n)}function A(e,t,r,n){return Z(Y(t),e,r,n)}function M(e,t,r,n){return A(e,t,r,n)}function E(e,t,r,n){return Z(X(t),e,r,n)}function S(e,t,r,n){return Z(W(t,e.length-r),e,r,n)}s.prototype.write=function e(t,r,n,a){if(r===undefined){a="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){a=r;n=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(n)){n=n>>>0;if(a===undefined)a="utf8"}else{a=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var i=this.length-r;if(n===undefined||n>i)n=i;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!a)a="utf8";var o=false;for(;;){switch(a){case"hex":return T(this,t,r,n);case"utf8":case"utf-8":return k(this,t,r,n);case"ascii":return A(this,t,r,n);case"latin1":case"binary":return M(this,t,r,n);case"base64":return E(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,r,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase();o=true}}};s.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,r,n){if(r===0&&n===e.length){return t.fromByteArray(e)}else{return t.fromByteArray(e.slice(r,n))}}function L(e,t,r){r=Math.min(e.length,r);var n=[];var a=t;while(a<r){var i=e[a];var o=null;var s=i>239?4:i>223?3:i>191?2:1;if(a+s<=r){var l,u,c,f;switch(s){case 1:if(i<128){o=i}break;case 2:l=e[a+1];if((l&192)===128){f=(i&31)<<6|l&63;if(f>127){o=f}}break;case 3:l=e[a+1];u=e[a+2];if((l&192)===128&&(u&192)===128){f=(i&15)<<12|(l&63)<<6|u&63;if(f>2047&&(f<55296||f>57343)){o=f}}break;case 4:l=e[a+1];u=e[a+2];c=e[a+3];if((l&192)===128&&(u&192)===128&&(c&192)===128){f=(i&15)<<18|(l&63)<<12|(u&63)<<6|c&63;if(f>65535&&f<1114112){o=f}}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;n.push(o>>>10&1023|55296);o=56320|o&1023}n.push(o);a+=s}return O(n)}var I=4096;function O(e){var t=e.length;if(t<=I){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=I))}return r}function P(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a){n+=String.fromCharCode(e[a]&127)}return n}function D(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a){n+=String.fromCharCode(e[a])}return n}function R(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var a="";for(var i=t;i<r;++i){a+=G(e[i])}return a}function z(e,t,r){var n=e.slice(t,r);var a="";for(var i=0;i<n.length;i+=2){a+=String.fromCharCode(n[i]+n[i+1]*256)}return a}s.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var a=this.subarray(t,r);a.__proto__=s.prototype;return a};function N(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)N(t,r,this.length);var a=this[t];var i=1;var o=0;while(++o<r&&(i*=256)){a+=this[t+o]*i}return a};s.prototype.readUIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n){N(t,r,this.length)}var a=this[t+--r];var i=1;while(r>0&&(i*=256)){a+=this[t+--r]*i}return a};s.prototype.readUInt8=function e(t,r){t=t>>>0;if(!r)N(t,1,this.length);return this[t]};s.prototype.readUInt16LE=function e(t,r){t=t>>>0;if(!r)N(t,2,this.length);return this[t]|this[t+1]<<8};s.prototype.readUInt16BE=function e(t,r){t=t>>>0;if(!r)N(t,2,this.length);return this[t]<<8|this[t+1]};s.prototype.readUInt32LE=function e(t,r){t=t>>>0;if(!r)N(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};s.prototype.readUInt32BE=function e(t,r){t=t>>>0;if(!r)N(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};s.prototype.readIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)N(t,r,this.length);var a=this[t];var i=1;var o=0;while(++o<r&&(i*=256)){a+=this[t+o]*i}i*=128;if(a>=i)a-=Math.pow(2,8*r);return a};s.prototype.readIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)N(t,r,this.length);var a=r;var i=1;var o=this[t+--a];while(a>0&&(i*=256)){o+=this[t+--a]*i}i*=128;if(o>=i)o-=Math.pow(2,8*r);return o};s.prototype.readInt8=function e(t,r){t=t>>>0;if(!r)N(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};s.prototype.readInt16LE=function e(t,r){t=t>>>0;if(!r)N(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};s.prototype.readInt16BE=function e(t,r){t=t>>>0;if(!r)N(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};s.prototype.readInt32LE=function e(t,r){t=t>>>0;if(!r)N(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};s.prototype.readInt32BE=function e(t,r){t=t>>>0;if(!r)N(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};s.prototype.readFloatLE=function e(t,r){t=t>>>0;if(!r)N(t,4,this.length);return n.read(this,t,true,23,4)};s.prototype.readFloatBE=function e(t,r){t=t>>>0;if(!r)N(t,4,this.length);return n.read(this,t,false,23,4)};s.prototype.readDoubleLE=function e(t,r){t=t>>>0;if(!r)N(t,8,this.length);return n.read(this,t,true,52,8)};s.prototype.readDoubleBE=function e(t,r){t=t>>>0;if(!r)N(t,8,this.length);return n.read(this,t,false,52,8)};function F(e,t,r,n,a,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function e(t,r,n,a){t=+t;r=r>>>0;n=n>>>0;if(!a){var i=Math.pow(2,8*n)-1;F(this,t,r,n,i,0)}var o=1;var s=0;this[r]=t&255;while(++s<n&&(o*=256)){this[r+s]=t/o&255}return r+n};s.prototype.writeUIntBE=function e(t,r,n,a){t=+t;r=r>>>0;n=n>>>0;if(!a){var i=Math.pow(2,8*n)-1;F(this,t,r,n,i,0)}var o=n-1;var s=1;this[r+o]=t&255;while(--o>=0&&(s*=256)){this[r+o]=t/s&255}return r+n};s.prototype.writeUInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,1,255,0);this[r]=t&255;return r+1};s.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,65535,0);this[r]=t&255;this[r+1]=t>>>8;return r+2};s.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,65535,0);this[r]=t>>>8;this[r+1]=t&255;return r+2};s.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,4294967295,0);this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255;return r+4};s.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,4294967295,0);this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};s.prototype.writeIntLE=function e(t,r,n,a){t=+t;r=r>>>0;if(!a){var i=Math.pow(2,8*n-1);F(this,t,r,n,i-1,-i)}var o=0;var s=1;var l=0;this[r]=t&255;while(++o<n&&(s*=256)){if(t<0&&l===0&&this[r+o-1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+n};s.prototype.writeIntBE=function e(t,r,n,a){t=+t;r=r>>>0;if(!a){var i=Math.pow(2,8*n-1);F(this,t,r,n,i-1,-i)}var o=n-1;var s=1;var l=0;this[r+o]=t&255;while(--o>=0&&(s*=256)){if(t<0&&l===0&&this[r+o+1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+n};s.prototype.writeInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,1,127,-128);if(t<0)t=255+t+1;this[r]=t&255;return r+1};s.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,32767,-32768);this[r]=t&255;this[r+1]=t>>>8;return r+2};s.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,32767,-32768);this[r]=t>>>8;this[r+1]=t&255;return r+2};s.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,2147483647,-2147483648);this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24;return r+4};s.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};function B(e,t,r,n,a,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,a,i){t=+t;r=r>>>0;if(!i){B(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}n.write(e,t,r,a,23,4);return r+4}s.prototype.writeFloatLE=function e(t,r,n){return j(this,t,r,true,n)};s.prototype.writeFloatBE=function e(t,r,n){return j(this,t,r,false,n)};function U(e,t,r,a,i){t=+t;r=r>>>0;if(!i){B(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}n.write(e,t,r,a,52,8);return r+8}s.prototype.writeDoubleLE=function e(t,r,n){return U(this,t,r,true,n)};s.prototype.writeDoubleBE=function e(t,r,n){return U(this,t,r,false,n)};s.prototype.copy=function e(t,r,n,a){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(!n)n=0;if(!a&&a!==0)a=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(a>0&&a<n)a=n;if(a===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");if(a>this.length)a=this.length;if(t.length-r<a-n){a=t.length-r+n}var i=a-n;if(this===t&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,n,a)}else if(this===t&&n<r&&r<a){for(var o=i-1;o>=0;--o){t[o+r]=this[o+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,a),r)}return i};s.prototype.fill=function e(t,r,n,a){if(typeof t==="string"){if(typeof r==="string"){a=r;r=0;n=this.length}else if(typeof n==="string"){a=n;n=this.length}if(a!==undefined&&typeof a!=="string"){throw new TypeError("encoding must be a string")}if(typeof a==="string"&&!s.isEncoding(a)){throw new TypeError("Unknown encoding: "+a)}if(t.length===1){var i=t.charCodeAt(0);if(a==="utf8"&&i<128||a==="latin1"){t=i}}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var o;if(typeof t==="number"){for(o=r;o<n;++o){this[o]=t}}else{var l=s.isBuffer(t)?t:s.from(t,a);var u=l.length;if(u===0){throw new TypeError('The value "'+t+'" is invalid for argument "value"')}for(o=0;o<n-r;++o){this[o+r]=l[o%u]}}return this};var H=/[^+/0-9A-Za-z-_]/g;function V(e){e=e.split("=")[0];e=e.trim().replace(H,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function G(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function q(e,t){t=t||Infinity;var r;var n=e.length;var a=null;var i=[];for(var o=0;o<n;++o){r=e.charCodeAt(o);if(r>55295&&r<57344){if(!a){if(r>56319){if((t-=3)>-1)i.push(239,191,189);continue}else if(o+1===n){if((t-=3)>-1)i.push(239,191,189);continue}a=r;continue}if(r<56320){if((t-=3)>-1)i.push(239,191,189);a=r;continue}r=(a-55296<<10|r-56320)+65536}else if(a){if((t-=3)>-1)i.push(239,191,189)}a=null;if(r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return i}function Y(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function W(e,t){var r,n,a;var i=[];for(var o=0;o<e.length;++o){if((t-=2)<0)break;r=e.charCodeAt(o);n=r>>8;a=r%256;i.push(a);i.push(n)}return i}function X(e){return t.toByteArray(V(e))}function Z(e,t,r,n){for(var a=0;a<n;++a){if(a+r>=t.length||a>=e.length)break;t[a+r]=e[a]}return a}function K(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function J(e){return e!==e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":79,buffer:111,ieee754:442}],112:[function(e,t,r){"use strict";var n=e("./lib/monotone");var a=e("./lib/triangulation");var i=e("./lib/delaunay");var o=e("./lib/filter");t.exports=f;function s(e){return[Math.min(e[0],e[1]),Math.max(e[0],e[1])]}function l(e,t){return e[0]-t[0]||e[1]-t[1]}function u(e){return e.map(s).sort(l)}function c(e,t,r){if(t in e){return e[t]}return r}function f(e,t,r){if(!Array.isArray(t)){r=t||{};t=[]}else{r=r||{};t=t||[]}var s=!!c(r,"delaunay",true);var l=!!c(r,"interior",true);var f=!!c(r,"exterior",true);var h=!!c(r,"infinity",false);if(!l&&!f||e.length===0){return[]}var p=n(e,t);if(s||l!==f||h){var d=a(e.length,u(t));for(var v=0;v<p.length;++v){var m=p[v];d.addTriangle(m[0],m[1],m[2])}if(s){i(e,d)}if(!f){return o(d,-1)}else if(!l){return o(d,1,h)}else if(h){return o(d,0,h)}else{return d.cells()}}else{return p}}},{"./lib/delaunay":113,"./lib/filter":114,"./lib/monotone":115,"./lib/triangulation":116}],113:[function(e,t,r){"use strict";var n=e("robust-in-sphere")[4];var a=e("binary-search-bounds");t.exports=o;function i(e,t,r,a,i,o){var s=t.opposite(a,i);if(s<0){return}if(i<a){var l=a;a=i;i=l;l=o;o=s;s=l}if(t.isConstraint(a,i)){return}if(n(e[a],e[i],e[o],e[s])<0){r.push(a,i)}}function o(e,t){var r=[];var a=e.length;var o=t.stars;for(var s=0;s<a;++s){var l=o[s];for(var u=1;u<l.length;u+=2){var c=l[u];if(c<s){continue}if(t.isConstraint(s,c)){continue}var f=l[u-1],h=-1;for(var p=1;p<l.length;p+=2){if(l[p-1]===c){h=l[p];break}}if(h<0){continue}if(n(e[s],e[c],e[f],e[h])<0){r.push(s,c)}}}while(r.length>0){var c=r.pop();var s=r.pop();var f=-1,h=-1;var l=o[s];for(var d=1;d<l.length;d+=2){var v=l[d-1];var m=l[d];if(v===c){h=m}else if(m===c){f=v}}if(f<0||h<0){continue}if(n(e[s],e[c],e[f],e[h])>=0){continue}t.flip(s,c);i(e,t,r,f,s,h);i(e,t,r,s,h,f);i(e,t,r,h,c,f);i(e,t,r,c,f,h)}}},{"binary-search-bounds":96,"robust-in-sphere":546}],114:[function(e,t,r){"use strict";var n=e("binary-search-bounds");t.exports=u;function a(e,t,r,n,a,i,o){this.cells=e;this.neighbor=t;this.flags=n;this.constraint=r;this.active=a;this.next=i;this.boundary=o}var i=a.prototype;function o(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}i.locate=function(){var e=[0,0,0];return function(t,r,a){var i=t,s=r,l=a;if(r<a){if(r<t){i=r;s=a;l=t}}else if(a<t){i=a;s=t;l=r}if(i<0){return-1}e[0]=i;e[1]=s;e[2]=l;return n.eq(this.cells,e,o)}}();function s(e,t){var r=e.cells();var n=r.length;for(var i=0;i<n;++i){var s=r[i];var l=s[0],u=s[1],c=s[2];if(u<c){if(u<l){s[0]=u;s[1]=c;s[2]=l}}else if(c<l){s[0]=c;s[1]=l;s[2]=u}}r.sort(o);var f=new Array(n);for(var i=0;i<f.length;++i){f[i]=0}var h=[];var p=[];var d=new Array(3*n);var v=new Array(3*n);var m=null;if(t){m=[]}var g=new a(r,d,v,f,h,p,m);for(var i=0;i<n;++i){var s=r[i];for(var y=0;y<3;++y){var l=s[y],u=s[(y+1)%3];var x=d[3*i+y]=g.locate(u,l,e.opposite(u,l));var _=v[3*i+y]=e.isConstraint(l,u);if(x<0){if(_){p.push(i)}else{h.push(i);f[i]=1}if(t){m.push([u,l,-1])}}}}return g}function l(e,t,r){var n=0;for(var a=0;a<e.length;++a){if(t[a]===r){e[n++]=e[a]}}e.length=n;return e}function u(e,t,r){var n=s(e,r);if(t===0){if(r){return n.cells.concat(n.boundary)}else{return n.cells}}var a=1;var i=n.active;var o=n.next;var u=n.flags;var c=n.cells;var f=n.constraint;var h=n.neighbor;while(i.length>0||o.length>0){while(i.length>0){var p=i.pop();if(u[p]===-a){continue}u[p]=a;var d=c[p];for(var v=0;v<3;++v){var m=h[3*p+v];if(m>=0&&u[m]===0){if(f[3*p+v]){o.push(m)}else{i.push(m);u[m]=a}}}}var g=o;o=i;i=g;o.length=0;a=-a}var y=l(c,u,t);if(r){return y.concat(n.boundary)}return y}},{"binary-search-bounds":96}],115:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var a=e("robust-orientation")[3];var i=0;var o=1;var s=2;t.exports=m;function l(e,t,r,n,a){this.a=e;this.b=t;this.idx=r;this.lowerIds=n;this.upperIds=a}function u(e,t,r,n){this.a=e;this.b=t;this.type=r;this.idx=n}function c(e,t){var r=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;if(r){return r}if(e.type!==i){r=a(e.a,e.b,t.b);if(r){return r}}return e.idx-t.idx}function f(e,t){return a(e.a,e.b,t)}function h(e,t,r,i,o){var s=n.lt(t,i,f);var l=n.gt(t,i,f);for(var u=s;u<l;++u){var c=t[u];var h=c.lowerIds;var p=h.length;while(p>1&&a(r[h[p-2]],r[h[p-1]],i)>0){e.push([h[p-1],h[p-2],o]);p-=1}h.length=p;h.push(o);var d=c.upperIds;var p=d.length;while(p>1&&a(r[d[p-2]],r[d[p-1]],i)<0){e.push([d[p-2],d[p-1],o]);p-=1}d.length=p;d.push(o)}}function p(e,t){var r;if(e.a[0]<t.a[0]){r=a(e.a,e.b,t.a)}else{r=a(t.b,t.a,e.a)}if(r){return r}if(t.b[0]<e.b[0]){r=a(e.a,e.b,t.b)}else{r=a(t.b,t.a,e.b)}return r||e.idx-t.idx}function d(e,t,r){var a=n.le(e,r,p);var i=e[a];var o=i.upperIds;var s=o[o.length-1];i.upperIds=[s];e.splice(a+1,0,new l(r.a,r.b,r.idx,[s],o))}function v(e,t,r){var a=r.a;r.a=r.b;r.b=a;var i=n.eq(e,r,p);var o=e[i];var s=e[i-1];s.upperIds=o.upperIds;e.splice(i,1)}function m(e,t){var r=e.length;var n=t.length;var a=[];for(var f=0;f<r;++f){a.push(new u(e[f],null,i,f))}for(var f=0;f<n;++f){var p=t[f];var m=e[p[0]];var g=e[p[1]];if(m[0]<g[0]){a.push(new u(m,g,s,f),new u(g,m,o,f))}else if(m[0]>g[0]){a.push(new u(g,m,s,f),new u(m,g,o,f))}}a.sort(c);var y=a[0].a[0]-(1+Math.abs(a[0].a[0]))*Math.pow(2,-52);var x=[new l([y,1],[y,0],-1,[],[],[],[])];var _=[];for(var f=0,b=a.length;f<b;++f){var w=a[f];var T=w.type;if(T===i){h(_,x,e,w.a,w.idx)}else if(T===s){d(x,e,w)}else{v(x,e,w)}}return _}},{"binary-search-bounds":96,"robust-orientation":548}],116:[function(e,t,r){"use strict";var n=e("binary-search-bounds");t.exports=s;function a(e,t){this.stars=e;this.edges=t}var i=a.prototype;function o(e,t,r){for(var n=1,a=e.length;n<a;n+=2){if(e[n-1]===t&&e[n]===r){e[n-1]=e[a-2];e[n]=e[a-1];e.length=a-2;return}}}i.isConstraint=function(){var e=[0,0];function t(e,t){return e[0]-t[0]||e[1]-t[1]}return function(r,a){e[0]=Math.min(r,a);e[1]=Math.max(r,a);return n.eq(this.edges,e,t)>=0}}();i.removeTriangle=function(e,t,r){var n=this.stars;o(n[e],t,r);o(n[t],r,e);o(n[r],e,t)};i.addTriangle=function(e,t,r){var n=this.stars;n[e].push(t,r);n[t].push(r,e);n[r].push(e,t)};i.opposite=function(e,t){var r=this.stars[t];for(var n=1,a=r.length;n<a;n+=2){if(r[n]===e){return r[n-1]}}return-1};i.flip=function(e,t){var r=this.opposite(e,t);var n=this.opposite(t,e);this.removeTriangle(e,t,r);this.removeTriangle(t,e,n);this.addTriangle(e,n,r);this.addTriangle(t,r,n)};i.edges=function(){var e=this.stars;var t=[];for(var r=0,n=e.length;r<n;++r){var a=e[r];for(var i=0,o=a.length;i<o;i+=2){t.push([a[i],a[i+1]])}}return t};i.cells=function(){var e=this.stars;var t=[];for(var r=0,n=e.length;r<n;++r){var a=e[r];for(var i=0,o=a.length;i<o;i+=2){var s=a[i];var l=a[i+1];if(r<Math.min(s,l)){t.push([r,s,l])}}}return t};function s(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=[]}return new a(r,t)}},{"binary-search-bounds":96}],117:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=1;for(var r=1;r<e.length;++r){for(var n=0;n<r;++n){if(e[r]<e[n]){t=-t}else if(e[n]===e[r]){return 0}}}return t}},{}],118:[function(e,t,r){"use strict";var n=e("dup");var a=e("robust-linear-solve");function i(e,t){var r=0;var n=e.length;for(var a=0;a<n;++a){r+=e[a]*t[a]}return r}function o(e){var t=e.length;if(t===0){return[]}var r=e[0].length;var o=n([e.length+1,e.length+1],1);var s=n([e.length+1],1);o[t][t]=0;for(var l=0;l<t;++l){for(var u=0;u<=l;++u){o[u][l]=o[l][u]=2*i(e[l],e[u])}s[l]=i(e[l],e[l])}var c=a(o,s);var f=0;var h=c[t+1];for(var l=0;l<h.length;++l){f+=h[l]}var p=new Array(t);for(var l=0;l<t;++l){var h=c[l];var d=0;for(var u=0;u<h.length;++u){d+=h[u]}p[l]=d/f}return p}function s(e){if(e.length===0){return[]}var t=e[0].length;var r=n([t]);var a=o(e);for(var i=0;i<e.length;++i){for(var s=0;s<t;++s){r[s]+=e[i][s]*a[i]}}return r}s.barycenetric=o;t.exports=s},{dup:176,"robust-linear-solve":547}],119:[function(e,t,r){t.exports=a;var n=e("circumcenter");function a(e){var t=n(e);var r=0;for(var a=0;a<e.length;++a){var i=e[a];for(var o=0;o<t.length;++o){r+=Math.pow(i[o]-t[o],2)}}return Math.sqrt(r/e.length)}},{circumcenter:118}],120:[function(e,t,r){t.exports=n;function n(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}},{}],121:[function(e,t,r){"use strict";t.exports=k;var n=e("union-find");var a=e("box-intersect");var i=e("robust-segment-intersect");var o=e("big-rat");var s=e("big-rat/cmp");var l=e("big-rat/to-float");var u=e("rat-vec");var c=e("nextafter");var f=e("./lib/rat-seg-intersect");function h(e){var t=l(e);return[c(t,-Infinity),c(t,Infinity)]}function p(e,t){var r=new Array(t.length);for(var n=0;n<t.length;++n){var a=t[n];var i=e[a[0]];var o=e[a[1]];r[n]=[c(Math.min(i[0],o[0]),-Infinity),c(Math.min(i[1],o[1]),-Infinity),c(Math.max(i[0],o[0]),Infinity),c(Math.max(i[1],o[1]),Infinity)]}return r}function d(e){var t=new Array(e.length);for(var r=0;r<e.length;++r){var n=e[r];t[r]=[c(n[0],-Infinity),c(n[1],-Infinity),c(n[0],Infinity),c(n[1],Infinity)]}return t}function v(e,t,r){var n=[];a(r,function(r,a){var o=t[r];var s=t[a];if(o[0]===s[0]||o[0]===s[1]||o[1]===s[0]||o[1]===s[1]){return}var l=e[o[0]];var u=e[o[1]];var c=e[s[0]];var f=e[s[1]];if(i(l,u,c,f)){n.push([r,a])}});return n}function m(e,t,r,n){var o=[];a(r,n,function(r,n){var a=t[r];if(a[0]===n||a[1]===n){return}var s=e[n];var l=e[a[0]];var u=e[a[1]];if(i(l,u,s,s)){o.push([r,n])}});return o}function g(e,t,r,n,a){var i,c;var h=e.map(function(e){return[o(e[0]),o(e[1])]});for(i=0;i<r.length;++i){var p=r[i];c=p[0];var d=p[1];var v=t[c];var m=t[d];var g=f(u(e[v[0]]),u(e[v[1]]),u(e[m[0]]),u(e[m[1]]));if(!g){continue}var y=e.length;e.push([l(g[0]),l(g[1])]);h.push(g);n.push([c,y],[d,y])}n.sort(function(e,t){if(e[0]!==t[0]){return e[0]-t[0]}var r=h[e[1]];var n=h[t[1]];return s(r[0],n[0])||s(r[1],n[1])});for(i=n.length-1;i>=0;--i){var x=n[i];c=x[0];var _=t[c];var b=_[0];var w=_[1];var T=e[b];var k=e[w];if((T[0]-k[0]||T[1]-k[1])<0){var A=b;b=w;w=A}_[0]=b;var M=_[1]=x[1];var E;if(a){E=_[2]}while(i>0&&n[i-1][0]===c){var x=n[--i];var S=x[1];if(a){t.push([M,S,E])}else{t.push([M,S])}M=S}if(a){t.push([M,w,E])}else{t.push([M,w])}}return h}function y(e,t,r){var i=t.length;var o=new n(i);var s=[];for(var l=0;l<t.length;++l){var u=t[l];var f=h(u[0]);var p=h(u[1]);s.push([c(f[0],-Infinity),c(p[0],-Infinity),c(f[1],Infinity),c(p[1],Infinity)])}a(s,function(e,t){o.link(e,t)});var d=true;var v=new Array(i);for(var l=0;l<i;++l){var m=o.find(l);if(m!==l){d=false;e[m]=[Math.min(e[l][0],e[m][0]),Math.min(e[l][1],e[m][1])]}}if(d){return null}var g=0;for(var l=0;l<i;++l){var m=o.find(l);if(m===l){v[l]=g;e[g++]=e[l]}else{v[l]=-1}}e.length=g;for(var l=0;l<i;++l){if(v[l]<0){v[l]=v[o.find(l)]}}return v}function x(e,t){return e[0]-t[0]||e[1]-t[1]}function _(e,t){var r=e[0]-t[0]||e[1]-t[1];if(r){return r}if(e[2]<t[2]){return-1}else if(e[2]>t[2]){return 1}return 0}function b(e,t,r){if(e.length===0){return}if(t){for(var n=0;n<e.length;++n){var a=e[n];var i=t[a[0]];var o=t[a[1]];a[0]=Math.min(i,o);a[1]=Math.max(i,o)}}else{for(var n=0;n<e.length;++n){var a=e[n];var i=a[0];var o=a[1];a[0]=Math.min(i,o);a[1]=Math.max(i,o)}}if(r){e.sort(_)}else{e.sort(x)}var s=1;for(var n=1;n<e.length;++n){var l=e[n-1];var u=e[n];if(u[0]===l[0]&&u[1]===l[1]&&(!r||u[2]===l[2])){continue}e[s++]=u}e.length=s}function w(e,t,r){var n=y(e,[],d(e));b(t,n,r);return!!n}function T(e,t,r){var n=p(e,t);var a=v(e,t,n);var i=d(e);var o=m(e,t,n,i);var s=g(e,t,a,o,r);var l=y(e,s,i);b(t,l,r);if(!l){return a.length>0||o.length>0}return true}function k(e,t,r){var n;if(r){n=t;var a=new Array(t.length);for(var i=0;i<t.length;++i){var o=t[i];a[i]=[o[0],o[1],r[i]]}t=a}var s=w(e,t,!!r);while(T(e,t,!!r)){s=true}if(!!r&&s){n.length=0;r.length=0;for(var i=0;i<t.length;++i){var o=t[i];n.push([o[0],o[1]]);r.push(o[2])}}return s}},{"./lib/rat-seg-intersect":122,"big-rat":83,"big-rat/cmp":81,"big-rat/to-float":95,"box-intersect":101,nextafter:496,"rat-vec":530,"robust-segment-intersect":551,"union-find":596}],122:[function(e,t,r){"use strict";t.exports=f;var n=e("big-rat/mul");var a=e("big-rat/div");var i=e("big-rat/sub");var o=e("big-rat/sign");var s=e("rat-vec/sub");var l=e("rat-vec/add");var u=e("rat-vec/muls");function c(e,t){return i(n(e[0],t[1]),n(e[1],t[0]))}function f(e,t,r,n){var i=s(t,e);var f=s(n,r);var h=c(i,f);if(o(h)===0){return null}var p=s(e,r);var d=c(f,p);var v=a(d,h);var m=u(i,v);var g=l(e,m);return g}},{"big-rat/div":82,"big-rat/mul":92,"big-rat/sign":93,"big-rat/sub":94,"rat-vec/add":529,"rat-vec/muls":531,"rat-vec/sub":532}],123:[function(e,t,r){"use strict";var n=e("clamp");t.exports=a;t.exports.to=a;t.exports.from=i;function a(e,t){if(t==null)t=true;var r=e[0],a=e[1],i=e[2],o=e[3];if(o==null)o=t?1:255;if(t){r*=255;a*=255;i*=255;o*=255}r=n(r,0,255)&255;a=n(a,0,255)&255;i=n(i,0,255)&255;o=n(o,0,255)&255;var s=r*16777216+(a<<16)+(i<<8)+o;return s}function i(e,t){e=+e;var r=e>>>24;var n=(e&16711680)>>>16;var a=(e&65280)>>>8;var i=e&255;if(t===false)return[r,n,a,i];return[r/255,n/255,a/255,i/255]}},{clamp:120}],124:[function(e,t,r){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],125:[function(e,t,r){"use strict";var n=e("color-rgba");var a=e("clamp");var i=e("dtype");t.exports=function e(t,r){if(r==="float"||!r)r="array";if(r==="uint")r="uint8";if(r==="uint_clamped")r="uint8_clamped";var s=i(r);var l=new s(4);var e=r!=="uint8"&&r!=="uint8_clamped";if(!t.length||typeof t==="string"){t=n(t);t[0]/=255;t[1]/=255;t[2]/=255}if(o(t)){l[0]=t[0];l[1]=t[1];l[2]=t[2];l[3]=t[3]!=null?t[3]:255;if(e){l[0]/=255;l[1]/=255;l[2]/=255;l[3]/=255}return l}if(!e){l[0]=a(Math.floor(t[0]*255),0,255);l[1]=a(Math.floor(t[1]*255),0,255);l[2]=a(Math.floor(t[2]*255),0,255);l[3]=t[3]==null?255:a(Math.floor(t[3]*255),0,255)}else{l[0]=t[0];l[1]=t[1];l[2]=t[2];l[3]=t[3]!=null?t[3]:1}return l};function o(e){if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return true;if(Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))return true;return false}},{clamp:120,"color-rgba":127,dtype:175}],126:[function(e,r,n){(function(t){(function(){"use strict";var n=e("color-name");var a=e("is-plain-obj");var i=e("defined");r.exports=s;var o={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function s(e){var r,s=[],l=1,u;if(typeof e==="string"){if(n[e]){s=n[e].slice();u="rgb"}else if(e==="transparent"){l=0;u="rgb";s=[0,0,0]}else if(/^#[A-Fa-f0-9]+$/.test(e)){var c=e.slice(1);var f=c.length;var h=f<=4;l=1;if(h){s=[parseInt(c[0]+c[0],16),parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16)];if(f===4){l=parseInt(c[3]+c[3],16)/255}}else{s=[parseInt(c[0]+c[1],16),parseInt(c[2]+c[3],16),parseInt(c[4]+c[5],16)];if(f===8){l=parseInt(c[6]+c[7],16)/255}}if(!s[0])s[0]=0;if(!s[1])s[1]=0;if(!s[2])s[2]=0;u="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var p=r[1];var d=p==="rgb";var c=p.replace(/a$/,"");u=c;var f=c==="cmyk"?4:c==="gray"?1:3;s=r[2].trim().split(/\s*,\s*/).map(function(e,t){if(/%$/.test(e)){if(t===f)return parseFloat(e)/100;if(c==="rgb")return parseFloat(e)*255/100;return parseFloat(e)}else if(c[t]==="h"){if(/deg$/.test(e)){return parseFloat(e)}else if(o[e]!==undefined){return o[e]}}return parseFloat(e)});if(p===c)s.push(1);l=d?1:s[f]===undefined?1:s[f];s=s.slice(0,f)}else if(e.length>10&&/[0-9](?:\s|\/)/.test(e)){s=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)});u=e.match(/([a-z])/gi).join("").toLowerCase()}}else if(!isNaN(e)){u="rgb";s=[e>>>16,(e&65280)>>>8,e&255]}else if(a(e)){var v=i(e.r,e.red,e.R,null);if(v!==null){u="rgb";s=[v,i(e.g,e.green,e.G),i(e.b,e.blue,e.B)]}else{u="hsl";s=[i(e.h,e.hue,e.H),i(e.s,e.saturation,e.S),i(e.l,e.lightness,e.L,e.b,e.brightness)]}l=i(e.a,e.alpha,e.opacity,1);if(e.opacity!=null)l/=100}else if(Array.isArray(e)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e)){s=[e[0],e[1],e[2]];u="rgb";l=e.length===4?e[3]:1}return{space:u,values:s,alpha:l}}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"color-name":124,defined:170,"is-plain-obj":469}],127:[function(e,t,r){"use strict";var n=e("color-parse");var a=e("color-space/hsl");var i=e("clamp");t.exports=function e(t){var r,o,s;var l=n(t);if(!l.space)return[];r=Array(3);r[0]=i(l.values[0],0,255);r[1]=i(l.values[1],0,255);r[2]=i(l.values[2],0,255);if(l.space[0]==="h"){r=a.rgb(r)}r.push(i(l.alpha,0,1));return r}},{clamp:120,"color-parse":126,"color-space/hsl":128}],128:[function(e,t,r){"use strict";var n=e("./rgb");t.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100,a,i,o,s,l;if(r===0){l=n*255;return[l,l,l]}if(n<.5){i=n*(1+r)}else{i=n+r-n*r}a=2*n-i;s=[0,0,0];for(var u=0;u<3;u++){o=t+1/3*-(u-1);if(o<0){o++}else if(o>1){o--}if(6*o<1){l=a+(i-a)*6*o}else if(2*o<1){l=i}else if(3*o<2){l=a+(i-a)*(2/3-o)*6}else{l=a}s[u]=l*255}return s}};n.hsl=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=i-a,s,l,u;if(i===a){s=0}else if(t===i){s=(r-n)/o}else if(r===i){s=2+(n-t)/o}else if(n===i){s=4+(t-r)/o}s=Math.min(s*60,360);if(s<0){s+=360}u=(a+i)/2;if(i===a){l=0}else if(u<=.5){l=o/(i+a)}else{l=o/(2-i-a)}return[s,l*100,u*100]}},{"./rgb":129}],129:[function(e,t,r){"use strict";t.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],130:[function(e,t,r){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],131:[function(e,t,r){"use strict";var n=e("./colorScale");var a=e("lerp");t.exports=i;function i(e){var t,r,i,u,c,f,h,p,d,v,m;if(!e)e={};p=(e.nshades||72)-1;h=e.format||"hex";f=e.colormap;if(!f)f="jet";if(typeof f==="string"){f=f.toLowerCase();if(!n[f]){throw Error(f+" not a supported colorscale")}c=n[f]}else if(Array.isArray(f)){c=f.slice()}else{throw Error("unsupported colormap option",f)}if(c.length>p+1){throw new Error(f+" map requires nshades to be at least size "+c.length)}if(!Array.isArray(e.alpha)){if(typeof e.alpha==="number"){v=[e.alpha,e.alpha]}else{v=[1,1]}}else if(e.alpha.length!==2){v=[1,1]}else{v=e.alpha.slice()}t=c.map(function(e){return Math.round(e.index*p)});v[0]=Math.min(Math.max(v[0],0),1);v[1]=Math.min(Math.max(v[1],0),1);var g=c.map(function(e,t){var r=c[t].index;var n=c[t].rgb.slice();if(n.length===4&&n[3]>=0&&n[3]<=1){return n}n[3]=v[0]+(v[1]-v[0])*r;return n});var d=[];for(m=0;m<t.length-1;++m){u=t[m+1]-t[m];r=g[m];i=g[m+1];for(var y=0;y<u;y++){var x=y/u;d.push([Math.round(a(r[0],i[0],x)),Math.round(a(r[1],i[1],x)),Math.round(a(r[2],i[2],x)),a(r[3],i[3],x)])}}d.push(c[c.length-1].rgb.concat(v[1]));if(h==="hex")d=d.map(s);else if(h==="rgbaString")d=d.map(l);else if(h==="float")d=d.map(o);return d}function o(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function s(e){var t,r="#";for(var n=0;n<3;++n){t=e[n];t=t.toString(16);r+=("00"+t).substr(t.length)}return r}function l(e){return"rgba("+e.join(",")+")"}},{"./colorScale":130,lerp:472}],132:[function(e,t,r){"use strict";t.exports=u;var n=e("robust-orientation");var a=e("signum");var i=e("two-sum");var o=e("robust-product");var s=e("robust-sum");function l(e,t,r){var n=i(e[0],-t[0]);var a=i(e[1],-t[1]);var l=i(r[0],-t[0]);var u=i(r[1],-t[1]);var c=s(o(n,l),o(a,u));return c[c.length-1]>=0}function u(e,t,r,i){var o=n(t,r,i);if(o===0){var s=a(n(e,t,r));var u=a(n(e,t,i));if(s===u){if(s===0){var c=l(e,t,r);var f=l(e,t,i);if(c===f){return 0}else if(c){return 1}else{return-1}}return 0}else if(u===0){if(s>0){return-1}else if(l(e,t,i)){return-1}else{return 1}}else if(s===0){if(u>0){return 1}else if(l(e,t,r)){return 1}else{return-1}}return a(u-s)}var h=n(e,t,r);if(h>0){if(o>0&&n(e,t,i)>0){return 1}return-1}else if(h<0){if(o>0||n(e,t,i)>0){return 1}return-1}else{var p=n(e,t,i);if(p>0){return 1}else{if(l(e,t,r)){return 1}else{return-1}}}}},{"robust-orientation":548,"robust-product":549,"robust-sum":553,signum:554,"two-sum":583}],133:[function(e,t,r){t.exports=i;var n=Math.min;function a(e,t){return e-t}function i(e,t){var r=e.length,i=e.length-t.length;if(i){return i}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:return e[0]+e[1]-t[0]-t[1]||n(e[0],e[1])-n(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];i=o+e[2]-(s+t[2]);if(i){return i}var l=n(e[0],e[1]),u=n(t[0],t[1]);return n(l,e[2])-n(u,t[2])||n(l+e[2],o)-n(u+t[2],s);case 4:var c=e[0],f=e[1],h=e[2],p=e[3],d=t[0],v=t[1],m=t[2],g=t[3];return c+f+h+p-(d+v+m+g)||n(c,f,h,p)-n(d,v,m,g,d)||n(c+f,c+h,c+p,f+h,f+p,h+p)-n(d+v,d+m,d+g,v+m,v+g,m+g)||n(c+f+h,c+f+p,c+h+p,f+h+p)-n(d+v+m,d+v+g,d+m+g,v+m+g);default:var y=e.slice().sort(a);var x=t.slice().sort(a);for(var _=0;_<r;++_){i=y[_]-x[_];if(i){return i}}return 0}}},{}],134:[function(e,t,r){"use strict";var n=e("compare-cell");var a=e("cell-orientation");t.exports=i;function i(e,t){return n(e,t)||a(e)-a(t)}},{"cell-orientation":117,"compare-cell":133}],135:[function(e,t,r){"use strict";var n=e("./lib/ch1d");var a=e("./lib/ch2d");var i=e("./lib/chnd");t.exports=o;function o(e){var t=e.length;if(t===0){return[]}else if(t===1){return[[0]]}var r=e[0].length;if(r===0){return[]}else if(r===1){return n(e)}else if(r===2){return a(e)}return i(e,r)}},{"./lib/ch1d":136,"./lib/ch2d":137,"./lib/chnd":138}],136:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=0;var r=0;for(var n=1;n<e.length;++n){if(e[n][0]<e[t][0]){t=n}if(e[n][0]>e[r][0]){r=n}}if(t<r){return[[t],[r]]}else if(t>r){return[[r],[t]]}else{return[[t]]}}},{}],137:[function(e,t,r){"use strict";t.exports=a;var n=e("monotone-convex-hull-2d");function a(e){var t=n(e);var r=t.length;if(r<=2){return[]}var a=new Array(r);var i=t[r-1];for(var o=0;o<r;++o){var s=t[o];a[o]=[i,s];i=s}return a}},{"monotone-convex-hull-2d":482}],138:[function(e,t,r){"use strict";t.exports=s;var n=e("incremental-convex-hull");var a=e("affine-hull");function i(e,t){var r=e.length;var n=new Array(r);for(var a=0;a<t.length;++a){n[a]=e[t[a]]}var i=t.length;for(var a=0;a<r;++a){if(t.indexOf(a)<0){n[i++]=e[a]}}return n}function o(e,t){var r=e.length;var n=t.length;for(var a=0;a<r;++a){var i=e[a];for(var o=0;o<i.length;++o){var s=i[o];if(s<n){i[o]=t[s]}else{s=s-n;for(var l=0;l<n;++l){if(s>=t[l]){s+=1}}i[o]=s}}}return e}function s(e,t){try{return n(e,true)}catch(u){var r=a(e);if(r.length<=t){return[]}var s=i(e,r);var l=n(s,true);return o(l,r)}}},{"affine-hull":67,"incremental-convex-hull":459}],139:[function(e,t,r){t.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|ç)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|é)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|é)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|ã)o.?tom(e|é)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],140:[function(e,t,r){t.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],141:[function(e,t,r){t.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],142:[function(e,t,r){t.exports=["normal","italic","oblique"]},{}],143:[function(e,t,r){t.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],144:[function(e,t,r){"use strict";t.exports={parse:e("./parse"),stringify:e("./stringify")}},{"./parse":146,"./stringify":147}],145:[function(e,t,r){"use strict";var n=e("css-font-size-keywords");t.exports={isSize:function e(t){return/^[\d\.]/.test(t)||t.indexOf("/")!==-1||n.indexOf(t)!==-1}}},{"css-font-size-keywords":140}],146:[function(e,t,r){"use strict";var n=e("unquote");var a=e("css-global-keywords");var i=e("css-system-font-keywords");var o=e("css-font-weight-keywords");var s=e("css-font-style-keywords");var l=e("css-font-stretch-keywords");var u=e("string-split-by");var c=e("./lib/util").isSize;t.exports=h;var f=h.cache={};function h(e){if(typeof e!=="string")throw new Error("Font argument must be a string.");if(f[e])return f[e];if(e===""){throw new Error("Cannot parse an empty string.")}if(i.indexOf(e)!==-1){return f[e]={system:e}}var t={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]};var r=u(e,/\s+/);var h;while(h=r.shift()){if(a.indexOf(h)!==-1){["style","variant","weight","stretch"].forEach(function(e){t[e]=h});return f[e]=t}if(s.indexOf(h)!==-1){t.style=h;continue}if(h==="normal"||h==="small-caps"){t.variant=h;continue}if(l.indexOf(h)!==-1){t.stretch=h;continue}if(o.indexOf(h)!==-1){t.weight=h;continue}if(c(h)){var d=u(h,"/");t.size=d[0];if(d[1]!=null){t.lineHeight=p(d[1])}else if(r[0]==="/"){r.shift();t.lineHeight=p(r.shift())}if(!r.length){throw new Error("Missing required font-family.")}t.family=u(r.join(" "),/\s*,\s*/).map(n);return f[e]=t}throw new Error("Unknown or unsupported font token: "+h)}throw new Error("Missing required font-size.")}function p(e){var t=parseFloat(e);if(t.toString()===e){return t}return e}},{"./lib/util":145,"css-font-stretch-keywords":141,"css-font-style-keywords":142,"css-font-weight-keywords":143,"css-global-keywords":148,"css-system-font-keywords":149,"string-split-by":568,unquote:598}],147:[function(e,t,r){"use strict";var n=e("pick-by-alias");var a=e("./lib/util").isSize;var i=d(e("css-global-keywords"));var o=d(e("css-system-font-keywords"));var s=d(e("css-font-weight-keywords"));var l=d(e("css-font-style-keywords"));var u=d(e("css-font-stretch-keywords"));var c={normal:1,"small-caps":1};var f={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1};var h={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};t.exports=function e(t){t=n(t,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"});if(t.system){if(t.system)p(t.system,o);return t.system}p(t.style,l);p(t.variant,c);p(t.weight,s);p(t.stretch,u);if(t.size==null)t.size=h.size;if(typeof t.size==="number")t.size+="px";if(!a)throw Error("Bad size value `"+t.size+"`");if(!t.family)t.family=h.family;if(Array.isArray(t.family)){if(!t.family.length)t.family=[h.family];t.family=t.family.map(function(e){return f[e]?e:'"'+e+'"'}).join(", ")}var r=[];r.push(t.style);if(t.variant!==t.style)r.push(t.variant);if(t.weight!==t.variant&&t.weight!==t.style)r.push(t.weight);if(t.stretch!==t.weight&&t.stretch!==t.variant&&t.stretch!==t.style)r.push(t.stretch);r.push(t.size+(t.lineHeight==null||t.lineHeight==="normal"||t.lineHeight+""==="1"?"":"/"+t.lineHeight));r.push(t.family);return r.filter(Boolean).join(" ")};function p(e,t){if(e&&!t[e]&&!i[e])throw Error("Unknown keyword `"+e+"`");return e}function d(e){var t={};for(var r=0;r<e.length;r++){t[e[r]]=1}return t}},{"./lib/util":145,"css-font-stretch-keywords":141,"css-font-style-keywords":142,"css-font-weight-keywords":143,"css-global-keywords":148,"css-system-font-keywords":149,"pick-by-alias":511}],148:[function(e,t,r){t.exports=["inherit","initial","unset"]},{}],149:[function(e,t,r){t.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],150:[function(e,t,r){"use strict";function n(e,t,r,n,a,i){var o=6*a*a-6*a,s=3*a*a-4*a+1,l=-6*a*a+6*a,u=3*a*a-2*a;if(e.length){if(!i){i=new Array(e.length)}for(var c=e.length-1;c>=0;--c){i[c]=o*e[c]+s*t[c]+l*r[c]+u*n[c]}return i}return o*e+s*t+l*r[c]+u*n}function a(e,t,r,n,a,i){var o=a-1,s=a*a,l=o*o,u=(1+2*a)*l,c=a*l,f=s*(3-2*a),h=s*o;if(e.length){if(!i){i=new Array(e.length)}for(var p=e.length-1;p>=0;--p){i[p]=u*e[p]+c*t[p]+f*r[p]+h*n[p]}return i}return u*e+c*t+f*r+h*n}t.exports=a;t.exports.derivative=n},{}],151:[function(e,t,r){"use strict";var n=e("./lib/thunk.js");function a(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function i(e){var t=new a;t.pre=e.pre;t.body=e.body;t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var i=0;i<r.length;++i){var o=r[i];if(o==="array"||typeof o==="object"&&o.blockIndices){t.argTypes[i]="array";t.arrayArgs.push(i);t.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0);t.shimArgs.push("array"+i);if(i<t.pre.args.length&&t.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array args")}if(i<t.post.args.length&&t.post.args[i].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(o==="scalar"){t.scalarArgs.push(i);t.shimArgs.push("scalar"+i)}else if(o==="index"){t.indexArgs.push(i);if(i<t.pre.args.length&&t.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array index")}if(i<t.body.args.length&&t.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array index")}if(i<t.post.args.length&&t.post.args[i].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(o==="shape"){t.shapeArgs.push(i);if(i<t.pre.args.length&&t.pre.args[i].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(i<t.body.args.length&&t.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(i<t.post.args.length&&t.post.args[i].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof o==="object"&&o.offset){t.argTypes[i]="offset";t.offsetArgs.push({array:o.array,offset:o.offset});t.offsetArgIndex.push(i)}else{throw new Error("cwise: Unknown argument type "+r[i])}}if(t.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(t.pre.args.length>r.length){throw new Error("cwise: Too many arguments in pre() block")}if(t.body.args.length>r.length){throw new Error("cwise: Too many arguments in body() block")}if(t.post.args.length>r.length){throw new Error("cwise: Too many arguments in post() block")}t.debug=!!e.printCode||!!e.debug;t.funcName=e.funcName||"cwise";t.blockSize=e.blockSize||64;return n(t)}t.exports=i},{"./lib/thunk.js":153}],152:[function(e,t,r){"use strict";var n=e("uniq");function a(e,t,r){var n=e.length,a=t.arrayArgs.length,i=t.indexArgs.length>0,o=[],s=[],l=0,u=0,c,f;for(c=0;c<n;++c){s.push(["i",c,"=0"].join(""))}for(f=0;f<a;++f){for(c=0;c<n;++c){u=l;l=e[c];if(c===0){s.push(["d",f,"s",c,"=t",f,"p",l].join(""))}else{s.push(["d",f,"s",c,"=(t",f,"p",l,"-s",u,"*t",f,"p",u,")"].join(""))}}}if(s.length>0){o.push("var "+s.join(","))}for(c=n-1;c>=0;--c){l=e[c];o.push(["for(i",c,"=0;i",c,"<s",l,";++i",c,"){"].join(""))}o.push(r);for(c=0;c<n;++c){u=l;l=e[c];for(f=0;f<a;++f){o.push(["p",f,"+=d",f,"s",c].join(""))}if(i){if(c>0){o.push(["index[",u,"]-=s",u].join(""))}o.push(["++index[",l,"]"].join(""))}o.push("}")}return o.join("\n")}function i(e,t,r,n){var i=t.length,o=r.arrayArgs.length,s=r.blockSize,l=r.indexArgs.length>0,u=[];for(var c=0;c<o;++c){u.push(["var offset",c,"=p",c].join(""))}for(var c=e;c<i;++c){u.push(["for(var j"+c+"=SS[",t[c],"]|0;j",c,">0;){"].join(""));u.push(["if(j",c,"<",s,"){"].join(""));u.push(["s",t[c],"=j",c].join(""));u.push(["j",c,"=0"].join(""));u.push(["}else{s",t[c],"=",s].join(""));u.push(["j",c,"-=",s,"}"].join(""));if(l){u.push(["index[",t[c],"]=j",c].join(""))}}for(var c=0;c<o;++c){var f=["offset"+c];for(var h=e;h<i;++h){f.push(["j",h,"*t",c,"p",t[h]].join(""))}u.push(["p",c,"=(",f.join("+"),")"].join(""))}u.push(a(t,r,n));for(var c=e;c<i;++c){u.push("}")}return u.join("\n")}function o(e){var t=0,r=e[0].length;while(t<r){for(var n=1;n<e.length;++n){if(e[n][t]!==e[0][t]){return t}}++t}return t}function s(e,t,r){var n=e.body;var a=[];var i=[];for(var o=0;o<e.args.length;++o){var s=e.args[o];if(s.count<=0){continue}var l=new RegExp(s.name,"g");var u="";var c=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var f=t.offsetArgIndex.indexOf(o);var h=t.offsetArgs[f];c=h.array;u="+q"+f;case"array":u="p"+c+u;var p="l"+o;var d="a"+c;if(t.arrayBlockIndices[c]===0){if(s.count===1){if(r[c]==="generic"){if(s.lvalue){a.push(["var ",p,"=",d,".get(",u,")"].join(""));n=n.replace(l,p);i.push([d,".set(",u,",",p,")"].join(""))}else{n=n.replace(l,[d,".get(",u,")"].join(""))}}else{n=n.replace(l,[d,"[",u,"]"].join(""))}}else if(r[c]==="generic"){a.push(["var ",p,"=",d,".get(",u,")"].join(""));n=n.replace(l,p);if(s.lvalue){i.push([d,".set(",u,",",p,")"].join(""))}}else{a.push(["var ",p,"=",d,"[",u,"]"].join(""));n=n.replace(l,p);if(s.lvalue){i.push([d,"[",u,"]=",p].join(""))}}}else{var v=[s.name],m=[u];for(var g=0;g<Math.abs(t.arrayBlockIndices[c]);g++){v.push("\\s*\\[([^\\]]+)\\]");m.push("$"+(g+1)+"*t"+c+"b"+g)}l=new RegExp(v.join(""),"g");u=m.join("+");if(r[c]==="generic"){throw new Error("cwise: Generic arrays not supported in combination with blocks!")}else{n=n.replace(l,[d,"[",u,"]"].join(""))}}break;case"scalar":n=n.replace(l,"Y"+t.scalarArgs.indexOf(o));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape");break}}return[a.join("\n"),n,i.join("\n")].join("\n").trim()}function l(e){var t=new Array(e.length);var r=true;for(var n=0;n<e.length;++n){var a=e[n];var i=a.match(/\d+/);if(!i){i=""}else{i=i[0]}if(a.charAt(0)===0){t[n]="u"+a.charAt(1)+i}else{t[n]=a.charAt(0)+i}if(n>0){r=r&&t[n]===t[n-1]}}if(r){return t[0]}return t.join("")}function u(e,t){var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0;var u=new Array(e.arrayArgs.length);var c=new Array(e.arrayArgs.length);for(var f=0;f<e.arrayArgs.length;++f){c[f]=t[2*f];u[f]=t[2*f+1]}var h=[],p=[];var d=[],v=[];var m=[];for(var f=0;f<e.arrayArgs.length;++f){if(e.arrayBlockIndices[f]<0){d.push(0);v.push(r);h.push(r);p.push(r+e.arrayBlockIndices[f])}else{d.push(e.arrayBlockIndices[f]);v.push(e.arrayBlockIndices[f]+r);h.push(0);p.push(e.arrayBlockIndices[f])}var g=[];for(var y=0;y<u[f].length;y++){if(d[f]<=u[f][y]&&u[f][y]<v[f]){g.push(u[f][y]-d[f])}}m.push(g)}var x=["SS"];var _=["'use strict'"];var b=[];for(var y=0;y<r;++y){b.push(["s",y,"=SS[",y,"]"].join(""))}for(var f=0;f<e.arrayArgs.length;++f){x.push("a"+f);x.push("t"+f);x.push("p"+f);for(var y=0;y<r;++y){b.push(["t",f,"p",y,"=t",f,"[",d[f]+y,"]"].join(""))}for(var y=0;y<Math.abs(e.arrayBlockIndices[f]);++y){b.push(["t",f,"b",y,"=t",f,"[",h[f]+y,"]"].join(""))}}for(var f=0;f<e.scalarArgs.length;++f){x.push("Y"+f)}if(e.shapeArgs.length>0){b.push("shape=SS.slice(0)")}if(e.indexArgs.length>0){var w=new Array(r);for(var f=0;f<r;++f){w[f]="0"}b.push(["index=[",w.join(","),"]"].join(""))}for(var f=0;f<e.offsetArgs.length;++f){var T=e.offsetArgs[f];var k=[];for(var y=0;y<T.offset.length;++y){if(T.offset[y]===0){continue}else if(T.offset[y]===1){k.push(["t",T.array,"p",y].join(""))}else{k.push([T.offset[y],"*t",T.array,"p",y].join(""))}}if(k.length===0){b.push("q"+f+"=0")}else{b.push(["q",f,"=",k.join("+")].join(""))}}var A=n([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));b=b.concat(A);if(b.length>0){_.push("var "+b.join(","))}for(var f=0;f<e.arrayArgs.length;++f){_.push("p"+f+"|=0")}if(e.pre.body.length>3){_.push(s(e.pre,e,c))}var M=s(e.body,e,c);var E=o(m);if(E<r){_.push(i(E,m[0],e,M))}else{_.push(a(m[0],e,M))}if(e.post.body.length>3){_.push(s(e.post,e,c))}if(e.debug){console.log("-----Generated cwise routine for ",t,":\n"+_.join("\n")+"\n----------")}var S=[e.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",E,l(c)].join("");var C=new Function(["function ",S,"(",x.join(","),"){",_.join("\n"),"} return ",S].join(""));return C()}t.exports=u},{uniq:597}],153:[function(e,t,r){"use strict";var n=e("./compile.js");function a(e){var t=["'use strict'","var CACHED={}"];var r=[];var a=e.funcName+"_cwise_thunk";t.push(["return function ",a,"(",e.shimArgs.join(","),"){"].join(""));var i=[];var o=[];var s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")];var l=[],u=[];for(var c=0;c<e.arrayArgs.length;++c){var f=e.arrayArgs[c];r.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join(""));i.push("t"+f);i.push("r"+f);o.push("t"+f);o.push("r"+f+".join()");s.push("array"+f+".data");s.push("array"+f+".stride");s.push("array"+f+".offset|0");if(c>0){l.push("array"+e.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[c])));u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[c])+"]")}}if(e.arrayArgs.length>1){t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')");t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {");t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')");t.push("}")}for(var c=0;c<e.scalarArgs.length;++c){s.push("scalar"+e.scalarArgs[c])}r.push(["type=[",o.join(","),"].join()"].join(""));r.push("proc=CACHED[type]");t.push("var "+r.join(","));t.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",s.join(","),")}"].join(""));if(e.debug){console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------")}var h=new Function("compile",t.join("\n"));return h(n.bind(undefined,e))}t.exports=a},{"./compile.js":152}],154:[function(e,t,r){"use strict";var n=e("type/value/is"),a=e("type/value/ensure"),i=e("type/plain-function/ensure"),o=e("es5-ext/object/copy"),s=e("es5-ext/object/normalize-options"),l=e("es5-ext/object/map");var u=Function.prototype.bind,c=Object.defineProperty,f=Object.prototype.hasOwnProperty,h;h=function(e,t,r){var n=a(t)&&i(t.value),s;s=o(t);delete s.writable;delete s.value;s.get=function(){if(!r.overwriteDefinition&&f.call(this,e))return n;t.value=u.call(n,r.resolveContext?r.resolveContext(this):this);c(this,e,t);return this[e]};return s};t.exports=function(e){var t=s(arguments[1]);if(n(t.resolveContext))i(t.resolveContext);return l(e,function(e,r){return h(r,e,t)})}},{"es5-ext/object/copy":196,"es5-ext/object/map":204,"es5-ext/object/normalize-options":205,"type/plain-function/ensure":589,"type/value/ensure":593,"type/value/is":594}],155:[function(e,t,r){"use strict";var n=e("type/value/is"),a=e("type/plain-function/is"),i=e("es5-ext/object/assign"),o=e("es5-ext/object/normalize-options"),s=e("es5-ext/string/#/contains");var l=t.exports=function(e,t){var r,a,l,u,c;if(arguments.length<2||typeof e!=="string"){u=t;t=e;e=null}else{u=arguments[2]}if(n(e)){r=s.call(e,"c");a=s.call(e,"e");l=s.call(e,"w")}else{r=l=true;a=false}c={value:t,configurable:r,enumerable:a,writable:l};return!u?c:i(o(u),c)};l.gs=function(e,t,r){var l,u,c,f;if(typeof e!=="string"){c=r;r=t;t=e;e=null}else{c=arguments[3]}if(!n(t)){t=undefined}else if(!a(t)){c=t;t=r=undefined}else if(!n(r)){r=undefined}else if(!a(r)){c=r;r=undefined}if(n(e)){l=s.call(e,"c");u=s.call(e,"e")}else{l=true;u=false}f={get:t,set:r,configurable:l,enumerable:u};return!c?f:i(o(c),f)}},{"es5-ext/object/assign":193,"es5-ext/object/normalize-options":205,"es5-ext/string/#/contains":212,"type/plain-function/is":590,"type/value/is":594}],156:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):a(t.d3=t.d3||{})})(this,function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function r(e){if(e.length===1)e=n(e);return{left:function(t,r,n,a){if(n==null)n=0;if(a==null)a=t.length;while(n<a){var i=n+a>>>1;if(e(t[i],r)<0)n=i+1;else a=i}return n},right:function(t,r,n,a){if(n==null)n=0;if(a==null)a=t.length;while(n<a){var i=n+a>>>1;if(e(t[i],r)>0)a=i;else n=i+1}return n}}}function n(e){return function(r,n){return t(e(r),n)}}var a=r(t);var i=a.right;var o=a.left;function s(e,t){if(t==null)t=l;var r=0,n=e.length-1,a=e[0],i=new Array(n<0?0:n);while(r<n)i[r]=t(a,a=e[++r]);return i}function l(e,t){return[e,t]}function u(e,t,r){var n=e.length,a=t.length,i=new Array(n*a),o,s,u,c;if(r==null)r=l;for(o=u=0;o<n;++o){for(c=e[o],s=0;s<a;++s,++u){i[u]=r(c,t[s])}}return i}function c(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function f(e){return e===null?NaN:+e}function h(e,t){var r=e.length,n=0,a=-1,i=0,o,s,l=0;if(t==null){while(++a<r){if(!isNaN(o=f(e[a]))){s=o-i;i+=s/++n;l+=s*(o-i)}}}else{while(++a<r){if(!isNaN(o=f(t(e[a],a,e)))){s=o-i;i+=s/++n;l+=s*(o-i)}}}if(n>1)return l/(n-1)}function p(e,t){var r=h(e,t);return r?Math.sqrt(r):r}function d(e,t){var r=e.length,n=-1,a,i,o;if(t==null){while(++n<r){if((a=e[n])!=null&&a>=a){i=o=a;while(++n<r){if((a=e[n])!=null){if(i>a)i=a;if(o<a)o=a}}}}}else{while(++n<r){if((a=t(e[n],n,e))!=null&&a>=a){i=o=a;while(++n<r){if((a=t(e[n],n,e))!=null){if(i>a)i=a;if(o<a)o=a}}}}}return[i,o]}var v=Array.prototype;var m=v.slice;var g=v.map;function y(e){return function(){return e}}function x(e){return e}function _(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);while(++n<a){i[n]=e+n*r}return i}var b=Math.sqrt(50),w=Math.sqrt(10),T=Math.sqrt(2);function k(e,t,r){var n,a=-1,i,o,s;t=+t,e=+e,r=+r;if(e===t&&r>0)return[e];if(n=t<e)i=e,e=t,t=i;if((s=A(e,t,r))===0||!isFinite(s))return[];if(s>0){e=Math.ceil(e/s);t=Math.floor(t/s);o=new Array(i=Math.ceil(t-e+1));while(++a<i)o[a]=(e+a)*s}else{e=Math.floor(e*s);t=Math.ceil(t*s);o=new Array(i=Math.ceil(e-t+1));while(++a<i)o[a]=(e-a)/s}if(n)o.reverse();return o}function A(e,t,r){var n=(t-e)/Math.max(0,r),a=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,a);return a>=0?(i>=b?10:i>=w?5:i>=T?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=b?10:i>=w?5:i>=T?2:1)}function M(e,t,r){var n=Math.abs(t-e)/Math.max(0,r),a=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/a;if(i>=b)a*=10;else if(i>=w)a*=5;else if(i>=T)a*=2;return t<e?-a:a}function E(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}function S(){var e=x,t=d,r=E;function n(n){var a,o=n.length,s,l=new Array(o);for(a=0;a<o;++a){l[a]=e(n[a],a,n)}var u=t(l),c=u[0],f=u[1],h=r(l,c,f);if(!Array.isArray(h)){h=M(c,f,h);h=_(Math.ceil(c/h)*h,f,h)}var p=h.length;while(h[0]<=c)h.shift(),--p;while(h[p-1]>f)h.pop(),--p;var d=new Array(p+1),v;for(a=0;a<=p;++a){v=d[a]=[];v.x0=a>0?h[a-1]:c;v.x1=a<p?h[a]:f}for(a=0;a<o;++a){s=l[a];if(c<=s&&s<=f){d[i(h,s,0,p)].push(n[a])}}return d}n.value=function(t){return arguments.length?(e=typeof t==="function"?t:y(t),n):e};n.domain=function(e){return arguments.length?(t=typeof e==="function"?e:y([e[0],e[1]]),n):t};n.thresholds=function(e){return arguments.length?(r=typeof e==="function"?e:Array.isArray(e)?y(m.call(e)):y(e),n):r};return n}function C(e,t,r){if(r==null)r=f;if(!(n=e.length))return;if((t=+t)<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),s=+r(e[i+1],i+1,e);return o+(s-o)*(a-i)}function L(e,r,n){e=g.call(e,f).sort(t);return Math.ceil((n-r)/(2*(C(e,.75)-C(e,.25))*Math.pow(e.length,-1/3)))}function I(e,t,r){return Math.ceil((r-t)/(3.5*p(e)*Math.pow(e.length,-1/3)))}function O(e,t){var r=e.length,n=-1,a,i;if(t==null){while(++n<r){if((a=e[n])!=null&&a>=a){i=a;while(++n<r){if((a=e[n])!=null&&a>i){i=a}}}}}else{while(++n<r){if((a=t(e[n],n,e))!=null&&a>=a){i=a;while(++n<r){if((a=t(e[n],n,e))!=null&&a>i){i=a}}}}}return i}function P(e,t){var r=e.length,n=r,a=-1,i,o=0;if(t==null){while(++a<r){if(!isNaN(i=f(e[a])))o+=i;else--n}}else{while(++a<r){if(!isNaN(i=f(t(e[a],a,e))))o+=i;else--n}}if(n)return o/n}function D(e,r){var n=e.length,a=-1,i,o=[];if(r==null){while(++a<n){if(!isNaN(i=f(e[a]))){o.push(i)}}}else{while(++a<n){if(!isNaN(i=f(r(e[a],a,e)))){o.push(i)}}}return C(o.sort(t),.5)}function R(e){var t=e.length,r,n=-1,a=0,i,o;while(++n<t)a+=e[n].length;i=new Array(a);while(--t>=0){o=e[t];r=o.length;while(--r>=0){i[--a]=o[r]}}return i}function z(e,t){var r=e.length,n=-1,a,i;if(t==null){while(++n<r){if((a=e[n])!=null&&a>=a){i=a;while(++n<r){if((a=e[n])!=null&&i>a){i=a}}}}}else{while(++n<r){if((a=t(e[n],n,e))!=null&&a>=a){i=a;while(++n<r){if((a=t(e[n],n,e))!=null&&i>a){i=a}}}}}return i}function N(e,t){var r=t.length,n=new Array(r);while(r--)n[r]=e[t[r]];return n}function F(e,r){if(!(n=e.length))return;var n,a=0,i=0,o,s=e[i];if(r==null)r=t;while(++a<n){if(r(o=e[a],s)<0||r(s,s)!==0){s=o,i=a}}if(r(s,s)===0)return i}function B(e,t,r){var n=(r==null?e.length:r)-(t=t==null?0:+t),a,i;while(n){i=Math.random()*n--|0;a=e[n+t];e[n+t]=e[i+t];e[i+t]=a}return e}function j(e,t){var r=e.length,n=-1,a,i=0;if(t==null){while(++n<r){if(a=+e[n])i+=a}}else{while(++n<r){if(a=+t(e[n],n,e))i+=a}}return i}function U(e){if(!(i=e.length))return[];for(var t=-1,r=z(e,H),n=new Array(r);++t<r;){for(var a=-1,i,o=n[t]=new Array(i);++a<i;){o[a]=e[a][t]}}return n}function H(e){return e.length}function V(){return U(arguments)}e.bisect=i;e.bisectRight=i;e.bisectLeft=o;e.ascending=t;e.bisector=r;e.cross=u;e.descending=c;e.deviation=p;e.extent=d;e.histogram=S;e.thresholdFreedmanDiaconis=L;e.thresholdScott=I;e.thresholdSturges=E;e.max=O;e.mean=P;e.median=D;e.merge=R;e.min=z;e.pairs=s;e.permute=N;e.quantile=C;e.range=_;e.scan=F;e.shuffle=B;e.sum=j;e.ticks=k;e.tickIncrement=A;e.tickStep=M;e.transpose=U;e.variance=h;e.zip=V;Object.defineProperty(e,"__esModule",{value:true})})},{}],157:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):a(t.d3=t.d3||{})})(this,function(e){"use strict";var t="$";function r(){}r.prototype=n.prototype={constructor:r,has:function(e){return t+e in this},get:function(e){return this[t+e]},set:function(e,r){this[t+e]=r;return this},remove:function(e){var r=t+e;return r in this&&delete this[r]},clear:function(){for(var e in this)if(e[0]===t)delete this[e]},keys:function(){var e=[];for(var r in this)if(r[0]===t)e.push(r.slice(1));return e},values:function(){var e=[];for(var r in this)if(r[0]===t)e.push(this[r]);return e},entries:function(){var e=[];for(var r in this)if(r[0]===t)e.push({key:r.slice(1),value:this[r]});return e},size:function(){var e=0;for(var r in this)if(r[0]===t)++e;return e},empty:function(){for(var e in this)if(e[0]===t)return false;return true},each:function(e){for(var r in this)if(r[0]===t)e(this[r],r.slice(1),this)}};function n(e,t){var n=new r;if(e instanceof r)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var a=-1,i=e.length,o;if(t==null)while(++a<i)n.set(a,e[a]);else while(++a<i)n.set(t(o=e[a],a,e),o)}else if(e)for(var s in e)n.set(s,e[s]);return n}function a(){var e=[],t=[],r,a,u;function c(t,i,o,s){if(i>=e.length){if(r!=null)t.sort(r);return a!=null?a(t):t}var l=-1,u=t.length,f=e[i++],h,p,d=n(),v,m=o();while(++l<u){if(v=d.get(h=f(p=t[l])+"")){v.push(p)}else{d.set(h,[p])}}d.each(function(e,t){s(m,t,c(e,i,o,s))});return m}function f(r,n){if(++n>e.length)return r;var i,o=t[n-1];if(a!=null&&n>=e.length)i=r.entries();else i=[],r.each(function(e,t){i.push({key:t,values:f(e,n)})});return o!=null?i.sort(function(e,t){return o(e.key,t.key)}):i}return u={object:function(e){return c(e,0,i,o)},map:function(e){return c(e,0,s,l)},entries:function(e){return f(c(e,0,s,l),0)},key:function(t){e.push(t);return u},sortKeys:function(r){t[e.length-1]=r;return u},sortValues:function(e){r=e;return u},rollup:function(e){a=e;return u}}}function i(){return{}}function o(e,t,r){e[t]=r}function s(){return n()}function l(e,t,r){e.set(t,r)}function u(){}var c=n.prototype;u.prototype=f.prototype={constructor:u,has:c.has,add:function(e){e+="";this[t+e]=e;return this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each};function f(e,t){var r=new u;if(e instanceof u)e.each(function(e){r.add(e)});else if(e){var n=-1,a=e.length;if(t==null)while(++n<a)r.add(e[n]);else while(++n<a)r.add(t(e[n],n,e))}return r}function h(e){var t=[];for(var r in e)t.push(r);return t}function p(e){var t=[];for(var r in e)t.push(e[r]);return t}function d(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t}e.nest=a;e.set=f;e.map=n;e.keys=h;e.values=p;e.entries=d;Object.defineProperty(e,"__esModule",{value:true})})},{}],158:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";function t(e,t,r){e.prototype=t.prototype=r;r.constructor=e}function r(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function n(){}var a=.7;var i=1/a;var o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3,8})$/,c=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),f=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),h=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),p=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),d=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),v=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$");var m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t(n,_,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:g,formatHex:g,formatHsl:y,formatRgb:x,toString:x});function g(){return this.rgb().formatHex()}function y(){return L(this).formatHsl()}function x(){return this.rgb().formatRgb()}function _(e){var t,r;e=(e+"").trim().toLowerCase();return(t=u.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?b(t):r===3?new A(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?w(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?w(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=c.exec(e))?new A(t[1],t[2],t[3],1):(t=f.exec(e))?new A(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=h.exec(e))?w(t[1],t[2],t[3],t[4]):(t=p.exec(e))?w(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=d.exec(e))?C(t[1],t[2]/100,t[3]/100,1):(t=v.exec(e))?C(t[1],t[2]/100,t[3]/100,t[4]):m.hasOwnProperty(e)?b(m[e]):e==="transparent"?new A(NaN,NaN,NaN,0):null}function b(e){return new A(e>>16&255,e>>8&255,e&255,1)}function w(e,t,r,n){if(n<=0)e=t=r=NaN;return new A(e,t,r,n)}function T(e){if(!(e instanceof n))e=_(e);if(!e)return new A;e=e.rgb();return new A(e.r,e.g,e.b,e.opacity)}function k(e,t,r,n){return arguments.length===1?T(e):new A(e,t,r,n==null?1:n)}function A(e,t,r,n){this.r=+e;this.g=+t;this.b=+r;this.opacity=+n}t(A,k,r(n,{brighter:function(e){e=e==null?i:Math.pow(i,e);return new A(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){e=e==null?a:Math.pow(a,e);return new A(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&(-.5<=this.g&&this.g<255.5)&&(-.5<=this.b&&this.b<255.5)&&(0<=this.opacity&&this.opacity<=1)},hex:M,formatHex:M,formatRgb:E,toString:E}));function M(){return"#"+S(this.r)+S(this.g)+S(this.b)}function E(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function S(e){e=Math.max(0,Math.min(255,Math.round(e)||0));return(e<16?"0":"")+e.toString(16)}function C(e,t,r,n){if(n<=0)e=t=r=NaN;else if(r<=0||r>=1)e=t=NaN;else if(t<=0)e=NaN;return new O(e,t,r,n)}function L(e){if(e instanceof O)return new O(e.h,e.s,e.l,e.opacity);if(!(e instanceof n))e=_(e);if(!e)return new O;if(e instanceof O)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,i=Math.min(t,r,a),o=Math.max(t,r,a),s=NaN,l=o-i,u=(o+i)/2;if(l){if(t===o)s=(r-a)/l+(r<a)*6;else if(r===o)s=(a-t)/l+2;else s=(t-r)/l+4;l/=u<.5?o+i:2-o-i;s*=60}else{l=u>0&&u<1?0:s}return new O(s,l,u,e.opacity)}function I(e,t,r,n){return arguments.length===1?L(e):new O(e,t,r,n==null?1:n)}function O(e,t,r,n){this.h=+e;this.s=+t;this.l=+r;this.opacity=+n}t(O,I,r(n,{brighter:function(e){e=e==null?i:Math.pow(i,e);return new O(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?a:Math.pow(a,e);return new O(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new A(P(e>=240?e-240:e+120,a,n),P(e,a,n),P(e<120?e+240:e-120,a,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)},formatHsl:function(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function P(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var D=Math.PI/180;var R=180/Math.PI;var z=18,N=.96422,F=1,B=.82521,j=4/29,U=6/29,H=3*U*U,V=U*U*U;function G(e){if(e instanceof W)return new W(e.l,e.a,e.b,e.opacity);if(e instanceof te)return re(e);if(!(e instanceof A))e=T(e);var t=J(e.r),r=J(e.g),n=J(e.b),a=X((.2225045*t+.7168786*r+.0606169*n)/F),i,o;if(t===r&&r===n)i=o=a;else{i=X((.4360747*t+.3850649*r+.1430804*n)/N);o=X((.0139322*t+.0971045*r+.7141733*n)/B)}return new W(116*a-16,500*(i-a),200*(a-o),e.opacity)}function q(e,t){return new W(e,0,0,t==null?1:t)}function Y(e,t,r,n){return arguments.length===1?G(e):new W(e,t,r,n==null?1:n)}function W(e,t,r,n){this.l=+e;this.a=+t;this.b=+r;this.opacity=+n}t(W,Y,r(n,{brighter:function(e){return new W(this.l+z*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new W(this.l-z*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;t=N*Z(t);e=F*Z(e);r=B*Z(r);return new A(K(3.1338561*t-1.6168667*e-.4906146*r),K(-.9787684*t+1.9161415*e+.033454*r),K(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function X(e){return e>V?Math.pow(e,1/3):e/H+j}function Z(e){return e>U?e*e*e:H*(e-j)}function K(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function J(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Q(e){if(e instanceof te)return new te(e.h,e.c,e.l,e.opacity);if(!(e instanceof W))e=G(e);if(e.a===0&&e.b===0)return new te(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*R;return new te(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function $(e,t,r,n){return arguments.length===1?Q(e):new te(r,t,e,n==null?1:n)}function ee(e,t,r,n){return arguments.length===1?Q(e):new te(e,t,r,n==null?1:n)}function te(e,t,r,n){this.h=+e;this.c=+t;this.l=+r;this.opacity=+n}function re(e){if(isNaN(e.h))return new W(e.l,0,0,e.opacity);var t=e.h*D;return new W(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(te,ee,r(n,{brighter:function(e){return new te(this.h,this.c,this.l+z*(e==null?1:e),this.opacity)},darker:function(e){return new te(this.h,this.c,this.l-z*(e==null?1:e),this.opacity)},rgb:function(){return re(this).rgb()}}));var ne=-.14861,ae=+1.78277,ie=-.29227,oe=-.90649,se=+1.97294,le=se*oe,ue=se*ae,ce=ae*ie-oe*ne;function fe(e){if(e instanceof pe)return new pe(e.h,e.s,e.l,e.opacity);if(!(e instanceof A))e=T(e);var t=e.r/255,r=e.g/255,n=e.b/255,a=(ce*n+le*t-ue*r)/(ce+le-ue),i=n-a,o=(se*(r-a)-ie*i)/oe,s=Math.sqrt(o*o+i*i)/(se*a*(1-a)),l=s?Math.atan2(o,i)*R-120:NaN;return new pe(l<0?l+360:l,s,a,e.opacity)}function he(e,t,r,n){return arguments.length===1?fe(e):new pe(e,t,r,n==null?1:n)}function pe(e,t,r,n){this.h=+e;this.s=+t;this.l=+r;this.opacity=+n}t(pe,he,r(n,{brighter:function(e){e=e==null?i:Math.pow(i,e);return new pe(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?a:Math.pow(a,e);return new pe(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*D,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),a=Math.sin(e);return new A(255*(t+r*(ne*n+ae*a)),255*(t+r*(ie*n+oe*a)),255*(t+r*(se*n)),this.opacity)}}));e.color=_;e.cubehelix=he;e.gray=q;e.hcl=ee;e.hsl=I;e.lab=Y;e.lch=$;e.rgb=k;Object.defineProperty(e,"__esModule",{value:true})})},{}],159:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";var t={value:function(){}};function r(){for(var e=0,t=arguments.length,r={},a;e<t;++e){if(!(a=arguments[e]+"")||a in r||/[\s.]/.test(a))throw new Error("illegal type: "+a);r[a]=[]}return new n(r)}function n(e){this._=e}function a(e,t){return e.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");if(n>=0)r=e.slice(n+1),e=e.slice(0,n);if(e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}n.prototype=r.prototype={constructor:n,on:function(e,t){var r=this._,n=a(e+"",r),s,l=-1,u=n.length;if(arguments.length<2){while(++l<u)if((s=(e=n[l]).type)&&(s=i(r[s],e.name)))return s;return}if(t!=null&&typeof t!=="function")throw new Error("invalid callback: "+t);while(++l<u){if(s=(e=n[l]).type)r[s]=o(r[s],e.name,t);else if(t==null)for(s in r)r[s]=o(r[s],e.name,null)}return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new n(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,i;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,a=i.length;n<a;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(t,r)}};function i(e,t){for(var r=0,n=e.length,a;r<n;++r){if((a=e[r]).name===t){return a.value}}}function o(e,r,n){for(var a=0,i=e.length;a<i;++a){if(e[a].name===r){e[a]=t,e=e.slice(0,a).concat(e.slice(a+1));break}}if(n!=null)e.push({name:r,value:n});return e}e.dispatch=r;Object.defineProperty(e,"__esModule",{value:true})})},{}],160:[function(t,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,t("d3-quadtree"),t("d3-collection"),t("d3-dispatch"),t("d3-timer")):typeof e==="function"&&e.amd?e(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],i):i(a.d3=a.d3||{},a.d3,a.d3,a.d3,a.d3)})(this,function(e,t,r,n,a){"use strict";function i(e,t){var r;if(e==null)e=0;if(t==null)t=0;function n(){var n,a=r.length,i,o=0,s=0;for(n=0;n<a;++n){i=r[n],o+=i.x,s+=i.y}for(o=o/a-e,s=s/a-t,n=0;n<a;++n){i=r[n],i.x-=o,i.y-=s}}n.initialize=function(e){r=e};n.x=function(t){return arguments.length?(e=+t,n):e};n.y=function(e){return arguments.length?(t=+e,n):t};return n}function o(e){return function(){return e}}function s(){return(Math.random()-.5)*1e-6}function l(e){return e.x+e.vx}function u(e){return e.y+e.vy}function c(e){var r,n,a=1,i=1;if(typeof e!=="function")e=o(e==null?1:+e);function c(){var e,o=r.length,c,h,p,d,v,m;for(var g=0;g<i;++g){c=t.quadtree(r,l,u).visitAfter(f);for(e=0;e<o;++e){h=r[e];v=n[h.index],m=v*v;p=h.x+h.vx;d=h.y+h.vy;c.visit(y)}}function y(e,t,r,n,i){var o=e.data,l=e.r,u=v+l;if(o){if(o.index>h.index){var c=p-o.x-o.vx,f=d-o.y-o.vy,g=c*c+f*f;if(g<u*u){if(c===0)c=s(),g+=c*c;if(f===0)f=s(),g+=f*f;g=(u-(g=Math.sqrt(g)))/g*a;h.vx+=(c*=g)*(u=(l*=l)/(m+l));h.vy+=(f*=g)*u;o.vx-=c*(u=1-u);o.vy-=f*u}}return}return t>p+u||n<p-u||r>d+u||i<d-u}}function f(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t){if(e[t]&&e[t].r>e.r){e.r=e[t].r}}}function h(){if(!r)return;var t,a=r.length,i;n=new Array(a);for(t=0;t<a;++t)i=r[t],n[i.index]=+e(i,t,r)}c.initialize=function(e){r=e;h()};c.iterations=function(e){return arguments.length?(i=+e,c):i};c.strength=function(e){return arguments.length?(a=+e,c):a};c.radius=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),h(),c):e};return c}function f(e){return e.index}function h(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}function p(e){var t=f,n=v,a,i=o(30),l,u,c,p,d=1;if(e==null)e=[];function v(e){return 1/Math.min(c[e.source.index],c[e.target.index])}function m(t){for(var r=0,n=e.length;r<d;++r){for(var i=0,o,u,c,f,h,v,m;i<n;++i){o=e[i],u=o.source,c=o.target;f=c.x+c.vx-u.x-u.vx||s();h=c.y+c.vy-u.y-u.vy||s();v=Math.sqrt(f*f+h*h);v=(v-l[i])/v*t*a[i];f*=v,h*=v;c.vx-=f*(m=p[i]);c.vy-=h*m;u.vx+=f*(m=1-m);u.vy+=h*m}}}function g(){if(!u)return;var n,i=u.length,o=e.length,s=r.map(u,t),f;for(n=0,c=new Array(i);n<o;++n){f=e[n],f.index=n;if(typeof f.source!=="object")f.source=h(s,f.source);if(typeof f.target!=="object")f.target=h(s,f.target);c[f.source.index]=(c[f.source.index]||0)+1;c[f.target.index]=(c[f.target.index]||0)+1}for(n=0,p=new Array(o);n<o;++n){f=e[n],p[n]=c[f.source.index]/(c[f.source.index]+c[f.target.index])}a=new Array(o),y();l=new Array(o),x()}function y(){if(!u)return;for(var t=0,r=e.length;t<r;++t){a[t]=+n(e[t],t,e)}}function x(){if(!u)return;for(var t=0,r=e.length;t<r;++t){l[t]=+i(e[t],t,e)}}m.initialize=function(e){u=e;g()};m.links=function(t){return arguments.length?(e=t,g(),m):e};m.id=function(e){return arguments.length?(t=e,m):t};m.iterations=function(e){return arguments.length?(d=+e,m):d};m.strength=function(e){return arguments.length?(n=typeof e==="function"?e:o(+e),y(),m):n};m.distance=function(e){return arguments.length?(i=typeof e==="function"?e:o(+e),x(),m):i};return m}function d(e){return e.x}function v(e){return e.y}var m=10,g=Math.PI*(3-Math.sqrt(5));function y(e){var t,i=1,o=.001,s=1-Math.pow(o,1/300),l=0,u=.6,c=r.map(),f=a.timer(p),h=n.dispatch("tick","end");if(e==null)e=[];function p(){d();h.call("tick",t);if(i<o){f.stop();h.call("end",t)}}function d(r){var n,a=e.length,o;if(r===undefined)r=1;for(var f=0;f<r;++f){i+=(l-i)*s;c.each(function(e){e(i)});for(n=0;n<a;++n){o=e[n];if(o.fx==null)o.x+=o.vx*=u;else o.x=o.fx,o.vx=0;if(o.fy==null)o.y+=o.vy*=u;else o.y=o.fy,o.vy=0}}return t}function v(){for(var t=0,r=e.length,n;t<r;++t){n=e[t],n.index=t;if(n.fx!=null)n.x=n.fx;if(n.fy!=null)n.y=n.fy;if(isNaN(n.x)||isNaN(n.y)){var a=m*Math.sqrt(t),i=t*g;n.x=a*Math.cos(i);n.y=a*Math.sin(i)}if(isNaN(n.vx)||isNaN(n.vy)){n.vx=n.vy=0}}}function y(t){if(t.initialize)t.initialize(e);return t}v();return t={tick:d,restart:function(){return f.restart(p),t},stop:function(){return f.stop(),t},nodes:function(r){return arguments.length?(e=r,v(),c.each(y),t):e},alpha:function(e){return arguments.length?(i=+e,t):i},alphaMin:function(e){return arguments.length?(o=+e,t):o},alphaDecay:function(e){return arguments.length?(s=+e,t):+s},alphaTarget:function(e){return arguments.length?(l=+e,t):l},velocityDecay:function(e){return arguments.length?(u=1-e,t):1-u},force:function(e,r){return arguments.length>1?(r==null?c.remove(e):c.set(e,y(r)),t):c.get(e)},find:function(t,r,n){var a=0,i=e.length,o,s,l,u,c;if(n==null)n=Infinity;else n*=n;for(a=0;a<i;++a){u=e[a];o=t-u.x;s=r-u.y;l=o*o+s*s;if(l<n)c=u,n=l}return c},on:function(e,r){return arguments.length>1?(h.on(e,r),t):h.on(e)}}}function x(){var e,r,n,a=o(-30),i,l=1,u=Infinity,c=.81;function f(a){var i,o=e.length,s=t.quadtree(e,d,v).visitAfter(p);for(n=a,i=0;i<o;++i)r=e[i],s.visit(m)}function h(){if(!e)return;var t,r=e.length,n;i=new Array(r);for(t=0;t<r;++t)n=e[t],i[n.index]=+a(n,t,e)}function p(e){var t=0,r,n,a=0,o,s,l;if(e.length){for(o=s=l=0;l<4;++l){if((r=e[l])&&(n=Math.abs(r.value))){t+=r.value,a+=n,o+=n*r.x,s+=n*r.y}}e.x=o/a;e.y=s/a}else{r=e;r.x=r.data.x;r.y=r.data.y;do{t+=i[r.data.index]}while(r=r.next)}e.value=t}function m(e,t,a,o){if(!e.value)return true;var f=e.x-r.x,h=e.y-r.y,p=o-t,d=f*f+h*h;if(p*p/c<d){if(d<u){if(f===0)f=s(),d+=f*f;if(h===0)h=s(),d+=h*h;if(d<l)d=Math.sqrt(l*d);r.vx+=f*e.value*n/d;r.vy+=h*e.value*n/d}return true}else if(e.length||d>=u)return;if(e.data!==r||e.next){if(f===0)f=s(),d+=f*f;if(h===0)h=s(),d+=h*h;if(d<l)d=Math.sqrt(l*d)}do{if(e.data!==r){p=i[e.data.index]*n/d;r.vx+=f*p;r.vy+=h*p}}while(e=e.next)}f.initialize=function(t){e=t;h()};f.strength=function(e){return arguments.length?(a=typeof e==="function"?e:o(+e),h(),f):a};f.distanceMin=function(e){return arguments.length?(l=e*e,f):Math.sqrt(l)};f.distanceMax=function(e){return arguments.length?(u=e*e,f):Math.sqrt(u)};f.theta=function(e){return arguments.length?(c=e*e,f):Math.sqrt(c)};return f}function _(e,t,r){var n,a=o(.1),i,s;if(typeof e!=="function")e=o(+e);if(t==null)t=0;if(r==null)r=0;function l(e){for(var a=0,o=n.length;a<o;++a){var l=n[a],u=l.x-t||1e-6,c=l.y-r||1e-6,f=Math.sqrt(u*u+c*c),h=(s[a]-f)*i[a]*e/f;l.vx+=u*h;l.vy+=c*h}}function u(){if(!n)return;var t,r=n.length;i=new Array(r);s=new Array(r);for(t=0;t<r;++t){s[t]=+e(n[t],t,n);i[t]=isNaN(s[t])?0:+a(n[t],t,n)}}l.initialize=function(e){n=e,u()};l.strength=function(e){return arguments.length?(a=typeof e==="function"?e:o(+e),u(),l):a};l.radius=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),u(),l):e};l.x=function(e){return arguments.length?(t=+e,l):t};l.y=function(e){return arguments.length?(r=+e,l):r};return l}function b(e){var t=o(.1),r,n,a;if(typeof e!=="function")e=o(e==null?0:+e);function i(e){for(var t=0,i=r.length,o;t<i;++t){o=r[t],o.vx+=(a[t]-o.x)*n[t]*e}}function s(){if(!r)return;var i,o=r.length;n=new Array(o);a=new Array(o);for(i=0;i<o;++i){n[i]=isNaN(a[i]=+e(r[i],i,r))?0:+t(r[i],i,r)}}i.initialize=function(e){r=e;s()};i.strength=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),s(),i):t};i.x=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),s(),i):e};return i}function w(e){var t=o(.1),r,n,a;if(typeof e!=="function")e=o(e==null?0:+e);function i(e){for(var t=0,i=r.length,o;t<i;++t){o=r[t],o.vy+=(a[t]-o.y)*n[t]*e}}function s(){if(!r)return;var i,o=r.length;n=new Array(o);a=new Array(o);for(i=0;i<o;++i){n[i]=isNaN(a[i]=+e(r[i],i,r))?0:+t(r[i],i,r)}}i.initialize=function(e){r=e;s()};i.strength=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),s(),i):t};i.y=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),s(),i):e};return i}e.forceCenter=i;e.forceCollide=c;e.forceLink=p;e.forceManyBody=x;e.forceRadial=_;e.forceSimulation=y;e.forceX=b;e.forceY=w;Object.defineProperty(e,"__esModule",{value:true})})},{"d3-collection":157,"d3-dispatch":159,"d3-quadtree":164,"d3-timer":168}],161:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";function t(e,t){return e.parent===t.parent?1:2}function r(e){return e.reduce(n,0)/e.length}function n(e,t){return e+t.x}function a(e){return 1+e.reduce(i,0)}function i(e,t){return Math.max(e,t.y)}function o(e){var t;while(t=e.children)e=t[0];return e}function s(e){var t;while(t=e.children)e=t[t.length-1];return e}function l(){var e=t,n=1,i=1,l=false;function u(t){var u,c=0;t.eachAfter(function(t){var n=t.children;if(n){t.x=r(n);t.y=a(n)}else{t.x=u?c+=e(t,u):0;t.y=0;u=t}});var f=o(t),h=s(t),p=f.x-e(f,h)/2,d=h.x+e(h,f)/2;return t.eachAfter(l?function(e){e.x=(e.x-t.x)*n;e.y=(t.y-e.y)*i}:function(e){e.x=(e.x-p)/(d-p)*n;e.y=(1-(t.y?e.y/t.y:1))*i})}u.separation=function(t){return arguments.length?(e=t,u):e};u.size=function(e){return arguments.length?(l=false,n=+e[0],i=+e[1],u):l?null:[n,i]};u.nodeSize=function(e){return arguments.length?(l=true,n=+e[0],i=+e[1],u):l?[n,i]:null};return u}function u(e){var t=0,r=e.children,n=r&&r.length;if(!n)t=1;else while(--n>=0)t+=r[n].value;e.value=t}function c(){return this.eachAfter(u)}function f(e){var t=this,r,n=[t],a,i,o;do{r=n.reverse(),n=[];while(t=r.pop()){e(t),a=t.children;if(a)for(i=0,o=a.length;i<o;++i){n.push(a[i])}}}while(n.length);return this}function h(e){var t=this,r=[t],n,a;while(t=r.pop()){e(t),n=t.children;if(n)for(a=n.length-1;a>=0;--a){r.push(n[a])}}return this}function p(e){var t=this,r=[t],n=[],a,i,o;while(t=r.pop()){n.push(t),a=t.children;if(a)for(i=0,o=a.length;i<o;++i){r.push(a[i])}}while(t=n.pop()){e(t)}return this}function d(e){return this.eachAfter(function(t){var r=+e(t.data)||0,n=t.children,a=n&&n.length;while(--a>=0)r+=n[a].value;t.value=r})}function v(e){return this.eachBefore(function(t){if(t.children){t.children.sort(e)}})}function m(e){var t=this,r=g(t,e),n=[t];while(t!==r){t=t.parent;n.push(t)}var a=n.length;while(e!==r){n.splice(a,0,e);e=e.parent}return n}function g(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),a=null;e=r.pop();t=n.pop();while(e===t){a=e;e=r.pop();t=n.pop()}return a}function y(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t}function x(){var e=[];this.each(function(t){e.push(t)});return e}function _(){var e=[];this.eachBefore(function(t){if(!t.children){e.push(t)}});return e}function b(){var e=this,t=[];e.each(function(r){if(r!==e){t.push({source:r.parent,target:r})}});return t}function w(e,t){var r=new E(e),n=+e.value&&(r.value=e.value),a,i=[r],o,s,l,u;if(t==null)t=k;while(a=i.pop()){if(n)a.value=+a.data.value;if((s=t(a.data))&&(u=s.length)){a.children=new Array(u);for(l=u-1;l>=0;--l){i.push(o=a.children[l]=new E(s[l]));o.parent=a;o.depth=a.depth+1}}}return r.eachBefore(M)}function T(){return w(this).eachBefore(A)}function k(e){return e.children}function A(e){e.data=e.data.data}function M(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function E(e){this.data=e;this.depth=this.height=0;this.parent=null}E.prototype=w.prototype={constructor:E,count:c,each:f,eachAfter:p,eachBefore:h,sum:d,sort:v,path:m,ancestors:y,descendants:x,leaves:_,links:b,copy:T};var S=Array.prototype.slice;function C(e){var t=e.length,r,n;while(t){n=Math.random()*t--|0;r=e[t];e[t]=e[n];e[n]=r}return e}function L(e){var t=0,r=(e=C(S.call(e))).length,n=[],a,i;while(t<r){a=e[t];if(i&&P(i,a))++t;else i=R(n=I(n,a)),t=0}return i}function I(e,t){var r,n;if(D(t,e))return[t];for(r=0;r<e.length;++r){if(O(t,e[r])&&D(N(e[r],t),e)){return[e[r],t]}}for(r=0;r<e.length-1;++r){for(n=r+1;n<e.length;++n){if(O(N(e[r],e[n]),t)&&O(N(e[r],t),e[n])&&O(N(e[n],t),e[r])&&D(F(e[r],e[n],t),e)){return[e[r],e[n],t]}}}throw new Error}function O(e,t){var r=e.r-t.r,n=t.x-e.x,a=t.y-e.y;return r<0||r*r<n*n+a*a}function P(e,t){var r=e.r-t.r+1e-6,n=t.x-e.x,a=t.y-e.y;return r>0&&r*r>n*n+a*a}function D(e,t){for(var r=0;r<t.length;++r){if(!P(e,t[r])){return false}}return true}function R(e){switch(e.length){case 1:return z(e[0]);case 2:return N(e[0],e[1]);case 3:return F(e[0],e[1],e[2])}}function z(e){return{x:e.x,y:e.y,r:e.r}}function N(e,t){var r=e.x,n=e.y,a=e.r,i=t.x,o=t.y,s=t.r,l=i-r,u=o-n,c=s-a,f=Math.sqrt(l*l+u*u);return{x:(r+i+l/f*c)/2,y:(n+o+u/f*c)/2,r:(f+a+s)/2}}function F(e,t,r){var n=e.x,a=e.y,i=e.r,o=t.x,s=t.y,l=t.r,u=r.x,c=r.y,f=r.r,h=n-o,p=n-u,d=a-s,v=a-c,m=l-i,g=f-i,y=n*n+a*a-i*i,x=y-o*o-s*s+l*l,_=y-u*u-c*c+f*f,b=p*d-h*v,w=(d*_-v*x)/(b*2)-n,T=(v*m-d*g)/b,k=(p*x-h*_)/(b*2)-a,A=(h*g-p*m)/b,M=T*T+A*A-1,E=2*(i+w*T+k*A),S=w*w+k*k-i*i,C=-(M?(E+Math.sqrt(E*E-4*M*S))/(2*M):S/E);return{x:n+w+T*C,y:a+k+A*C,r:C}}function B(e,t,r){var n=e.x-t.x,a,i,o=e.y-t.y,s,l,u=n*n+o*o;if(u){i=t.r+r.r,i*=i;l=e.r+r.r,l*=l;if(i>l){a=(u+l-i)/(2*u);s=Math.sqrt(Math.max(0,l/u-a*a));r.x=e.x-a*n-s*o;r.y=e.y-a*o+s*n}else{a=(u+i-l)/(2*u);s=Math.sqrt(Math.max(0,i/u-a*a));r.x=t.x+a*n-s*o;r.y=t.y+a*o+s*n}}else{r.x=t.x+r.r;r.y=t.y}}function j(e,t){var r=e.r+t.r-1e-6,n=t.x-e.x,a=t.y-e.y;return r>0&&r*r>n*n+a*a}function U(e){var t=e._,r=e.next._,n=t.r+r.r,a=(t.x*r.r+r.x*t.r)/n,i=(t.y*r.r+r.y*t.r)/n;return a*a+i*i}function H(e){this._=e;this.next=null;this.previous=null}function V(e){if(!(a=e.length))return 0;var t,r,n,a,i,o,s,l,u,c,f;t=e[0],t.x=0,t.y=0;if(!(a>1))return t.r;r=e[1],t.x=-r.r,r.x=t.r,r.y=0;if(!(a>2))return t.r+r.r;B(r,t,n=e[2]);t=new H(t),r=new H(r),n=new H(n);t.next=n.previous=r;r.next=t.previous=n;n.next=r.previous=t;e:for(s=3;s<a;++s){B(t._,r._,n=e[s]),n=new H(n);l=r.next,u=t.previous,c=r._.r,f=t._.r;do{if(c<=f){if(j(l._,n._)){r=l,t.next=r,r.previous=t,--s;continue e}c+=l._.r,l=l.next}else{if(j(u._,n._)){t=u,t.next=r,r.previous=t,--s;continue e}f+=u._.r,u=u.previous}}while(l!==u.next);n.previous=t,n.next=r,t.next=r.previous=r=n;i=U(t);while((n=n.next)!==r){if((o=U(n))<i){t=n,i=o}}r=t.next}t=[r._],n=r;while((n=n.next)!==r)t.push(n._);n=L(t);for(s=0;s<a;++s)t=e[s],t.x-=n.x,t.y-=n.y;return n.r}function G(e){V(e);return e}function q(e){return e==null?null:Y(e)}function Y(e){if(typeof e!=="function")throw new Error;return e}function W(){return 0}function X(e){return function(){return e}}function Z(e){return Math.sqrt(e.value)}function K(){var e=null,t=1,r=1,n=W;function a(a){a.x=t/2,a.y=r/2;if(e){a.eachBefore(J(e)).eachAfter(Q(n,.5)).eachBefore($(1))}else{a.eachBefore(J(Z)).eachAfter(Q(W,1)).eachAfter(Q(n,a.r/Math.min(t,r))).eachBefore($(Math.min(t,r)/(2*a.r)))}return a}a.radius=function(t){return arguments.length?(e=q(t),a):e};a.size=function(e){return arguments.length?(t=+e[0],r=+e[1],a):[t,r]};a.padding=function(e){return arguments.length?(n=typeof e==="function"?e:X(+e),a):n};return a}function J(e){return function(t){if(!t.children){t.r=Math.max(0,+e(t)||0)}}}function Q(e,t){return function(r){if(n=r.children){var n,a,i=n.length,o=e(r)*t||0,s;if(o)for(a=0;a<i;++a)n[a].r+=o;s=V(n);if(o)for(a=0;a<i;++a)n[a].r-=o;r.r=s+o}}}function $(e){return function(t){var r=t.parent;t.r*=e;if(r){t.x=r.x+e*t.x;t.y=r.y+e*t.y}}}function ee(e){e.x0=Math.round(e.x0);e.y0=Math.round(e.y0);e.x1=Math.round(e.x1);e.y1=Math.round(e.y1)}function te(e,t,r,n,a){var i=e.children,o,s=-1,l=i.length,u=e.value&&(n-t)/e.value;while(++s<l){o=i[s],o.y0=r,o.y1=a;o.x0=t,o.x1=t+=o.value*u}}function re(){var e=1,t=1,r=0,n=false;function a(a){var o=a.height+1;a.x0=a.y0=r;a.x1=e;a.y1=t/o;a.eachBefore(i(t,o));if(n)a.eachBefore(ee);return a}function i(e,t){return function(n){if(n.children){te(n,n.x0,e*(n.depth+1)/t,n.x1,e*(n.depth+2)/t)}var a=n.x0,i=n.y0,o=n.x1-r,s=n.y1-r;if(o<a)a=o=(a+o)/2;if(s<i)i=s=(i+s)/2;n.x0=a;n.y0=i;n.x1=o;n.y1=s}}a.round=function(e){return arguments.length?(n=!!e,a):n};a.size=function(r){return arguments.length?(e=+r[0],t=+r[1],a):[e,t]};a.padding=function(e){return arguments.length?(r=+e,a):r};return a}var ne="$",ae={depth:-1},ie={};function oe(e){return e.id}function se(e){return e.parentId}function le(){var e=oe,t=se;function r(r){var n,a,i=r.length,o,s,l,u=new Array(i),c,f,h={};for(a=0;a<i;++a){n=r[a],l=u[a]=new E(n);if((c=e(n,a,r))!=null&&(c+="")){f=ne+(l.id=c);h[f]=f in h?ie:l}}for(a=0;a<i;++a){l=u[a],c=t(r[a],a,r);if(c==null||!(c+="")){if(o)throw new Error("multiple roots");o=l}else{s=h[ne+c];if(!s)throw new Error("missing: "+c);if(s===ie)throw new Error("ambiguous: "+c);if(s.children)s.children.push(l);else s.children=[l];l.parent=s}}if(!o)throw new Error("no root");o.parent=ae;o.eachBefore(function(e){e.depth=e.parent.depth+1;--i}).eachBefore(M);o.parent=null;if(i>0)throw new Error("cycle");return o}r.id=function(t){return arguments.length?(e=Y(t),r):e};r.parentId=function(e){return arguments.length?(t=Y(e),r):t};return r}function ue(e,t){return e.parent===t.parent?1:2}function ce(e){var t=e.children;return t?t[0]:e.t}function fe(e){var t=e.children;return t?t[t.length-1]:e.t}function he(e,t,r){var n=r/(t.i-e.i);t.c-=n;t.s+=r;e.c+=n;t.z+=r;t.m+=r}function pe(e){var t=0,r=0,n=e.children,a=n.length,i;while(--a>=0){i=n[a];i.z+=t;i.m+=t;t+=i.s+(r+=i.c)}}function de(e,t,r){return e.a.parent===t.parent?e.a:r}function ve(e,t){this._=e;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=t}ve.prototype=Object.create(E.prototype);function me(e){var t=new ve(e,0),r,n=[t],a,i,o,s;while(r=n.pop()){if(i=r._.children){r.children=new Array(s=i.length);for(o=s-1;o>=0;--o){n.push(a=r.children[o]=new ve(i[o],o));a.parent=r}}}(t.parent=new ve(null,0)).children=[t];return t}function ge(){var e=ue,t=1,r=1,n=null;function a(a){var s=me(a);s.eachAfter(i),s.parent.m=-s.z;s.eachBefore(o);if(n)a.eachBefore(l);else{var u=a,c=a,f=a;a.eachBefore(function(e){if(e.x<u.x)u=e;if(e.x>c.x)c=e;if(e.depth>f.depth)f=e});var h=u===c?1:e(u,c)/2,p=h-u.x,d=t/(c.x+h+p),v=r/(f.depth||1);a.eachBefore(function(e){e.x=(e.x+p)*d;e.y=e.depth*v})}return a}function i(t){var r=t.children,n=t.parent.children,a=t.i?n[t.i-1]:null;if(r){pe(t);var i=(r[0].z+r[r.length-1].z)/2;if(a){t.z=a.z+e(t._,a._);t.m=t.z-i}else{t.z=i}}else if(a){t.z=a.z+e(t._,a._)}t.parent.A=s(t,a,t.parent.A||n[0])}function o(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function s(t,r,n){if(r){var a=t,i=t,o=r,s=a.parent.children[0],l=a.m,u=i.m,c=o.m,f=s.m,h;while(o=fe(o),a=ce(a),o&&a){s=ce(s);i=fe(i);i.a=t;h=o.z+c-a.z-l+e(o._,a._);if(h>0){he(de(o,t,n),t,h);l+=h;u+=h}c+=o.m;l+=a.m;f+=s.m;u+=i.m}if(o&&!fe(i)){i.t=o;i.m+=c-u}if(a&&!ce(s)){s.t=a;s.m+=l-f;n=t}}return n}function l(e){e.x*=t;e.y=e.depth*r}a.separation=function(t){return arguments.length?(e=t,a):e};a.size=function(e){return arguments.length?(n=false,t=+e[0],r=+e[1],a):n?null:[t,r]};a.nodeSize=function(e){return arguments.length?(n=true,t=+e[0],r=+e[1],a):n?[t,r]:null};return a}function ye(e,t,r,n,a){var i=e.children,o,s=-1,l=i.length,u=e.value&&(a-r)/e.value;while(++s<l){o=i[s],o.x0=t,o.x1=n;o.y0=r,o.y1=r+=o.value*u}}var xe=(1+Math.sqrt(5))/2;function _e(e,t,r,n,a,i){var o=[],s=t.children,l,u,c=0,f=0,h=s.length,p,d,v=t.value,m,g,y,x,_,b,w;while(c<h){p=a-r,d=i-n;do{m=s[f++].value}while(!m&&f<h);g=y=m;b=Math.max(d/p,p/d)/(v*e);w=m*m*b;_=Math.max(y/w,w/g);for(;f<h;++f){m+=u=s[f].value;if(u<g)g=u;if(u>y)y=u;w=m*m*b;x=Math.max(y/w,w/g);if(x>_){m-=u;break}_=x}o.push(l={value:m,dice:p<d,children:s.slice(c,f)});if(l.dice)te(l,r,n,a,v?n+=d*m/v:i);else ye(l,r,n,v?r+=p*m/v:a,i);v-=m,c=f}return o}var be=function e(t){function r(e,r,n,a,i){_e(t,e,r,n,a,i)}r.ratio=function(t){return e((t=+t)>1?t:1)};return r}(xe);function we(){var e=be,t=false,r=1,n=1,a=[0],i=W,o=W,s=W,l=W,u=W;function c(e){e.x0=e.y0=0;e.x1=r;e.y1=n;e.eachBefore(f);a=[0];if(t)e.eachBefore(ee);return e}function f(t){var r=a[t.depth],n=t.x0+r,c=t.y0+r,f=t.x1-r,h=t.y1-r;if(f<n)n=f=(n+f)/2;if(h<c)c=h=(c+h)/2;t.x0=n;t.y0=c;t.x1=f;t.y1=h;if(t.children){r=a[t.depth+1]=i(t)/2;n+=u(t)-r;c+=o(t)-r;f-=s(t)-r;h-=l(t)-r;if(f<n)n=f=(n+f)/2;if(h<c)c=h=(c+h)/2;e(t,n,c,f,h)}}c.round=function(e){return arguments.length?(t=!!e,c):t};c.size=function(e){return arguments.length?(r=+e[0],n=+e[1],c):[r,n]};c.tile=function(t){return arguments.length?(e=Y(t),c):e};c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()};c.paddingInner=function(e){return arguments.length?(i=typeof e==="function"?e:X(+e),c):i};c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()};c.paddingTop=function(e){return arguments.length?(o=typeof e==="function"?e:X(+e),c):o};c.paddingRight=function(e){return arguments.length?(s=typeof e==="function"?e:X(+e),c):s};c.paddingBottom=function(e){return arguments.length?(l=typeof e==="function"?e:X(+e),c):l};c.paddingLeft=function(e){return arguments.length?(u=typeof e==="function"?e:X(+e),c):u};return c}function Te(e,t,r,n,a){var i=e.children,o,s=i.length,l,u=new Array(s+1);for(u[0]=l=o=0;o<s;++o){u[o+1]=l+=i[o].value}c(0,s,e.value,t,r,n,a);function c(e,t,r,n,a,o,s){if(e>=t-1){var l=i[e];l.x0=n,l.y0=a;l.x1=o,l.y1=s;return}var f=u[e],h=r/2+f,p=e+1,d=t-1;while(p<d){var v=p+d>>>1;if(u[v]<h)p=v+1;else d=v}if(h-u[p-1]<u[p]-h&&e+1<p)--p;var m=u[p]-f,g=r-m;if(o-n>s-a){var y=(n*g+o*m)/r;c(e,p,m,n,a,y,s);c(p,t,g,y,a,o,s)}else{var x=(a*g+s*m)/r;c(e,p,m,n,a,o,x);c(p,t,g,n,x,o,s)}}}function ke(e,t,r,n,a){(e.depth&1?ye:te)(e,t,r,n,a)}var Ae=function e(t){function r(e,r,n,a,i){if((o=e._squarify)&&o.ratio===t){var o,s,l,u,c=-1,f,h=o.length,p=e.value;while(++c<h){s=o[c],l=s.children;for(u=s.value=0,f=l.length;u<f;++u)s.value+=l[u].value;if(s.dice)te(s,r,n,a,n+=(i-n)*s.value/p);else ye(s,r,n,r+=(a-r)*s.value/p,i);p-=s.value}}else{e._squarify=o=_e(t,e,r,n,a,i);o.ratio=t}}r.ratio=function(t){return e((t=+t)>1?t:1)};return r}(xe);e.cluster=l;e.hierarchy=w;e.pack=K;e.packEnclose=L;e.packSiblings=G;e.partition=re;e.stratify=le;e.tree=ge;e.treemap=we;e.treemapBinary=Te;e.treemapDice=te;e.treemapResquarify=Ae;e.treemapSlice=ye;e.treemapSliceDice=ke;e.treemapSquarify=be;Object.defineProperty(e,"__esModule",{value:true})})},{}],162:[function(t,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,t("d3-color")):typeof e==="function"&&e.amd?e(["exports","d3-color"],i):(a=a||self,i(a.d3=a.d3||{},a.d3))})(this,function(e,t){"use strict";function r(e,t,r,n,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*r+(1+3*e+3*i-3*o)*n+o*a)/6}function n(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[a],o=e[a+1],s=a>0?e[a-1]:2*i-o,l=a<t-1?e[a+2]:2*o-i;return r((n-a/t)*t,s,i,o,l)}}function a(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),i=e[(a+t-1)%t],o=e[a%t],s=e[(a+1)%t],l=e[(a+2)%t];return r((n-a/t)*t,i,o,s,l)}}function i(e){return function(){return e}}function o(e,t){return function(r){return e+r*t}}function s(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function l(e,t){var r=t-e;return r?o(e,r>180||r<-180?r-360*Math.round(r/360):r):i(isNaN(e)?t:e)}function u(e){return(e=+e)===1?c:function(t,r){return r-t?s(t,r,e):i(isNaN(t)?r:t)}}function c(e,t){var r=t-e;return r?o(e,r):i(isNaN(e)?t:e)}var f=function e(r){var n=u(r);function a(e,r){var a=n((e=t.rgb(e)).r,(r=t.rgb(r)).r),i=n(e.g,r.g),o=n(e.b,r.b),s=c(e.opacity,r.opacity);return function(t){e.r=a(t);e.g=i(t);e.b=o(t);e.opacity=s(t);return e+""}}a.gamma=e;return a}(1);function h(e){return function(r){var n=r.length,a=new Array(n),i=new Array(n),o=new Array(n),s,l;for(s=0;s<n;++s){l=t.rgb(r[s]);a[s]=l.r||0;i[s]=l.g||0;o[s]=l.b||0}a=e(a);i=e(i);o=e(o);l.opacity=1;return function(e){l.r=a(e);l.g=i(e);l.b=o(e);return l+""}}}var p=h(n);var d=h(a);function v(e,t){if(!t)t=[];var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function m(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function g(e,t){return(m(t)?v:y)(e,t)}function y(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=E(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(e){for(o=0;o<n;++o)i[o]=a[o](e);return i}}function x(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function _(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function b(e,t){var r={},n={},a;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(a in t){if(a in e){r[a]=E(e[a],t[a])}else{n[a]=t[a]}}return function(e){for(a in r)n[a]=r[a](e);return n}}var w=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,T=new RegExp(w.source,"g");function k(e){return function(){return e}}function A(e){return function(t){return e(t)+""}}function M(e,t){var r=w.lastIndex=T.lastIndex=0,n,a,i,o=-1,s=[],l=[];e=e+"",t=t+"";while((n=w.exec(e))&&(a=T.exec(t))){if((i=a.index)>r){i=t.slice(r,i);if(s[o])s[o]+=i;else s[++o]=i}if((n=n[0])===(a=a[0])){if(s[o])s[o]+=a;else s[++o]=a}else{s[++o]=null;l.push({i:o,x:_(n,a)})}r=T.lastIndex}if(r<t.length){i=t.slice(r);if(s[o])s[o]+=i;else s[++o]=i}return s.length<2?l[0]?A(l[0].x):k(t):(t=l.length,function(e){for(var r=0,n;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function E(e,r){var n=typeof r,a;return r==null||n==="boolean"?i(r):(n==="number"?_:n==="string"?(a=t.color(r))?(r=a,f):M:r instanceof t.color?f:r instanceof Date?x:m(r)?v:Array.isArray(r)?y:typeof r.valueOf!=="function"&&typeof r.toString!=="function"||isNaN(r)?b:_)(e,r)}function S(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}function C(e,t){var r=l(+e,+t);return function(e){var t=r(e);return t-360*Math.floor(t/360)}}function L(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var I=180/Math.PI;var O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function P(e,t,r,n,a,i){var o,s,l;if(o=Math.sqrt(e*e+t*t))e/=o,t/=o;if(l=e*r+t*n)r-=e*l,n-=t*l;if(s=Math.sqrt(r*r+n*n))r/=s,n/=s,l/=s;if(e*n<t*r)e=-e,t=-t,l=-l,o=-o;return{translateX:a,translateY:i,rotate:Math.atan2(t,e)*I,skewX:Math.atan(l)*I,scaleX:o,scaleY:s}}var D,R,z,N;function F(e){if(e==="none")return O;if(!D)D=document.createElement("DIV"),R=document.documentElement,z=document.defaultView;D.style.transform=e;e=z.getComputedStyle(R.appendChild(D),null).getPropertyValue("transform");R.removeChild(D);e=e.slice(7,-1).split(",");return P(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5])}function B(e){if(e==null)return O;if(!N)N=document.createElementNS("http://www.w3.org/2000/svg","g");N.setAttribute("transform",e);if(!(e=N.transform.baseVal.consolidate()))return O;e=e.matrix;return P(e.a,e.b,e.c,e.d,e.e,e.f)}function j(e,t,r,n){function a(e){return e.length?e.pop()+" ":""}function i(e,n,a,i,o,s){if(e!==a||n!==i){var l=o.push("translate(",null,t,null,r);s.push({i:l-4,x:_(e,a)},{i:l-2,x:_(n,i)})}else if(a||i){o.push("translate("+a+t+i+r)}}function o(e,t,r,i){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;i.push({i:r.push(a(r)+"rotate(",null,n)-2,x:_(e,t)})}else if(t){r.push(a(r)+"rotate("+t+n)}}function s(e,t,r,i){if(e!==t){i.push({i:r.push(a(r)+"skewX(",null,n)-2,x:_(e,t)})}else if(t){r.push(a(r)+"skewX("+t+n)}}function l(e,t,r,n,i,o){if(e!==r||t!==n){var s=i.push(a(i)+"scale(",null,",",null,")");o.push({i:s-4,x:_(e,r)},{i:s-2,x:_(t,n)})}else if(r!==1||n!==1){i.push(a(i)+"scale("+r+","+n+")")}}return function(t,r){var n=[],a=[];t=e(t),r=e(r);i(t.translateX,t.translateY,r.translateX,r.translateY,n,a);o(t.rotate,r.rotate,n,a);s(t.skewX,r.skewX,n,a);l(t.scaleX,t.scaleY,r.scaleX,r.scaleY,n,a);t=r=null;return function(e){var t=-1,r=a.length,i;while(++t<r)n[(i=a[t]).i]=i.x(e);return n.join("")}}}var U=j(F,"px, ","px)","deg)");var H=j(B,", ",")",")");var V=Math.SQRT2,G=2,q=4,Y=1e-12;function W(e){return((e=Math.exp(e))+1/e)/2}function X(e){return((e=Math.exp(e))-1/e)/2}function Z(e){return((e=Math.exp(2*e))-1)/(e+1)}function K(e,t){var r=e[0],n=e[1],a=e[2],i=t[0],o=t[1],s=t[2],l=i-r,u=o-n,c=l*l+u*u,f,h;if(c<Y){h=Math.log(s/a)/V;f=function(e){return[r+e*l,n+e*u,a*Math.exp(V*e*h)]}}else{var p=Math.sqrt(c),d=(s*s-a*a+q*c)/(2*a*G*p),v=(s*s-a*a-q*c)/(2*s*G*p),m=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(v*v+1)-v);h=(g-m)/V;f=function(e){var t=e*h,i=W(m),o=a/(G*p)*(i*Z(V*t+m)-X(m));return[r+o*l,n+o*u,a*i/W(V*t+m)]}}f.duration=h*1e3;return f}function J(e){return function(r,n){var a=e((r=t.hsl(r)).h,(n=t.hsl(n)).h),i=c(r.s,n.s),o=c(r.l,n.l),s=c(r.opacity,n.opacity);return function(e){r.h=a(e);r.s=i(e);r.l=o(e);r.opacity=s(e);return r+""}}}var Q=J(l);var $=J(c);function ee(e,r){var n=c((e=t.lab(e)).l,(r=t.lab(r)).l),a=c(e.a,r.a),i=c(e.b,r.b),o=c(e.opacity,r.opacity);return function(t){e.l=n(t);e.a=a(t);e.b=i(t);e.opacity=o(t);return e+""}}function te(e){return function(r,n){var a=e((r=t.hcl(r)).h,(n=t.hcl(n)).h),i=c(r.c,n.c),o=c(r.l,n.l),s=c(r.opacity,n.opacity);return function(e){r.h=a(e);r.c=i(e);r.l=o(e);r.opacity=s(e);return r+""}}}var re=te(l);var ne=te(c);function ae(e){return function r(n){n=+n;function a(r,a){var i=e((r=t.cubehelix(r)).h,(a=t.cubehelix(a)).h),o=c(r.s,a.s),s=c(r.l,a.l),l=c(r.opacity,a.opacity);return function(e){r.h=i(e);r.s=o(e);r.l=s(Math.pow(e,n));r.opacity=l(e);return r+""}}a.gamma=r;return a}(1)}var ie=ae(l);var oe=ae(c);function se(e,t){var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);while(r<n)i[r]=e(a,a=t[++r]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return i[t](e-t)}}function le(e,t){var r=new Array(t);for(var n=0;n<t;++n)r[n]=e(n/(t-1));return r}e.interpolate=E;e.interpolateArray=g;e.interpolateBasis=n;e.interpolateBasisClosed=a;e.interpolateCubehelix=ie;e.interpolateCubehelixLong=oe;e.interpolateDate=x;e.interpolateDiscrete=S;e.interpolateHcl=re;e.interpolateHclLong=ne;e.interpolateHsl=Q;e.interpolateHslLong=$;e.interpolateHue=C;e.interpolateLab=ee;e.interpolateNumber=_;e.interpolateNumberArray=v;e.interpolateObject=b;e.interpolateRgb=f;e.interpolateRgbBasis=p;e.interpolateRgbBasisClosed=d;e.interpolateRound=L;e.interpolateString=M;e.interpolateTransformCss=U;e.interpolateTransformSvg=H;e.interpolateZoom=K;e.piecewise=se;e.quantize=le;Object.defineProperty(e,"__esModule",{value:true})})},{"d3-color":158}],163:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";var t=Math.PI,r=2*t,n=1e-6,a=r-n;function i(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function o(){return new i}i.prototype=o.prototype={constructor:i,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,r,n){this._+="Q"+ +e+","+ +t+","+(this._x1=+r)+","+(this._y1=+n)},bezierCurveTo:function(e,t,r,n,a,i){this._+="C"+ +e+","+ +t+","+ +r+","+ +n+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(e,r,a,i,o){e=+e,r=+r,a=+a,i=+i,o=+o;var s=this._x1,l=this._y1,u=a-e,c=i-r,f=s-e,h=l-r,p=f*f+h*h;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=r)}else if(!(p>n));else if(!(Math.abs(h*u-c*f)>n)||!o){this._+="L"+(this._x1=e)+","+(this._y1=r)}else{var d=a-s,v=i-l,m=u*u+c*c,g=d*d+v*v,y=Math.sqrt(m),x=Math.sqrt(p),_=o*Math.tan((t-Math.acos((m+p-g)/(2*y*x)))/2),b=_/x,w=_/y;if(Math.abs(b-1)>n){this._+="L"+(e+b*f)+","+(r+b*h)}this._+="A"+o+","+o+",0,0,"+ +(h*d>f*v)+","+(this._x1=e+w*u)+","+(this._y1=r+w*c)}},arc:function(e,i,o,s,l,u){e=+e,i=+i,o=+o,u=!!u;var c=o*Math.cos(s),f=o*Math.sin(s),h=e+c,p=i+f,d=1^u,v=u?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null){this._+="M"+h+","+p}else if(Math.abs(this._x1-h)>n||Math.abs(this._y1-p)>n){this._+="L"+h+","+p}if(!o)return;if(v<0)v=v%r+r;if(v>a){this._+="A"+o+","+o+",0,1,"+d+","+(e-c)+","+(i-f)+"A"+o+","+o+",0,1,"+d+","+(this._x1=h)+","+(this._y1=p)}else if(v>n){this._+="A"+o+","+o+",0,"+ +(v>=t)+","+d+","+(this._x1=e+o*Math.cos(l))+","+(this._y1=i+o*Math.sin(l))}},rect:function(e,t,r,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +r+"v"+ +n+"h"+-r+"Z"},toString:function(){return this._}};e.path=o;Object.defineProperty(e,"__esModule",{value:true})})},{}],164:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";function t(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return r(this.cover(t,n),t,n,e)}function r(e,t,r,n){if(isNaN(t)||isNaN(r))return e;var a,i=e._root,o={data:n},s=e._x0,l=e._y0,u=e._x1,c=e._y1,f,h,p,d,v,m,g,y;if(!i)return e._root=o,e;while(i.length){if(v=t>=(f=(s+u)/2))s=f;else u=f;if(m=r>=(h=(l+c)/2))l=h;else c=h;if(a=i,!(i=i[g=m<<1|v]))return a[g]=o,e}p=+e._x.call(null,i.data);d=+e._y.call(null,i.data);if(t===p&&r===d)return o.next=i,a?a[g]=o:e._root=o,e;do{a=a?a[g]=new Array(4):e._root=new Array(4);if(v=t>=(f=(s+u)/2))s=f;else u=f;if(m=r>=(h=(l+c)/2))l=h;else c=h}while((g=m<<1|v)===(y=(d>=h)<<1|p>=f));return a[y]=i,a[g]=o,e}function n(e){var t,n,a=e.length,i,o,s=new Array(a),l=new Array(a),u=Infinity,c=Infinity,f=-Infinity,h=-Infinity;for(n=0;n<a;++n){if(isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t)))continue;s[n]=i;l[n]=o;if(i<u)u=i;if(i>f)f=i;if(o<c)c=o;if(o>h)h=o}if(u>f||c>h)return this;this.cover(u,c).cover(f,h);for(n=0;n<a;++n){r(this,s[n],l[n],e[n])}return this}function a(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,n=this._y0,a=this._x1,i=this._y1;if(isNaN(r)){a=(r=Math.floor(e))+1;i=(n=Math.floor(t))+1}else{var o=a-r,s=this._root,l,u;while(r>e||e>=a||n>t||t>=i){u=(t<n)<<1|e<r;l=new Array(4),l[u]=s,s=l,o*=2;switch(u){case 0:a=r+o,i=n+o;break;case 1:r=a-o,i=n+o;break;case 2:a=r+o,n=i-o;break;case 3:r=a-o,n=i-o;break}}if(this._root&&this._root.length)this._root=s}this._x0=r;this._y0=n;this._x1=a;this._y1=i;return this}function i(){var e=[];this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)});return e}function o(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]}function s(e,t,r,n,a){this.node=e;this.x0=t;this.y0=r;this.x1=n;this.y1=a}function l(e,t,r){var n,a=this._x0,i=this._y0,o,l,u,c,f=this._x1,h=this._y1,p=[],d=this._root,v,m;if(d)p.push(new s(d,a,i,f,h));if(r==null)r=Infinity;else{a=e-r,i=t-r;f=e+r,h=t+r;r*=r}while(v=p.pop()){if(!(d=v.node)||(o=v.x0)>f||(l=v.y0)>h||(u=v.x1)<a||(c=v.y1)<i)continue;if(d.length){var g=(o+u)/2,y=(l+c)/2;p.push(new s(d[3],g,y,u,c),new s(d[2],o,y,g,c),new s(d[1],g,l,u,y),new s(d[0],o,l,g,y));if(m=(t>=y)<<1|e>=g){v=p[p.length-1];p[p.length-1]=p[p.length-1-m];p[p.length-1-m]=v}}else{var x=e-+this._x.call(null,d.data),_=t-+this._y.call(null,d.data),b=x*x+_*_;if(b<r){var w=Math.sqrt(r=b);a=e-w,i=t-w;f=e+w,h=t+w;n=d.data}}}return n}function u(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,r=this._root,n,a,i,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,f,h,p,d,v,m,g;if(!r)return this;if(r.length)while(true){if(d=c>=(h=(o+l)/2))o=h;else l=h;if(v=f>=(p=(s+u)/2))s=p;else u=p;if(!(t=r,r=r[m=v<<1|d]))return this;if(!r.length)break;if(t[m+1&3]||t[m+2&3]||t[m+3&3])n=t,g=m}while(r.data!==e)if(!(a=r,r=r.next))return this;if(i=r.next)delete r.next;if(a)return i?a.next=i:delete a.next,this;if(!t)return this._root=i,this;i?t[m]=i:delete t[m];if((r=t[0]||t[1]||t[2]||t[3])&&r===(t[3]||t[2]||t[1]||t[0])&&!r.length){if(n)n[g]=r;else this._root=r}return this}function c(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function f(){return this._root}function h(){var e=0;this.visit(function(t){if(!t.length)do{++e}while(t=t.next)});return e}function p(e){var t=[],r,n=this._root,a,i,o,l,u;if(n)t.push(new s(n,this._x0,this._y0,this._x1,this._y1));while(r=t.pop()){if(!e(n=r.node,i=r.x0,o=r.y0,l=r.x1,u=r.y1)&&n.length){var c=(i+l)/2,f=(o+u)/2;if(a=n[3])t.push(new s(a,c,f,l,u));if(a=n[2])t.push(new s(a,i,f,c,u));if(a=n[1])t.push(new s(a,c,o,l,f));if(a=n[0])t.push(new s(a,i,o,c,f))}}return this}function d(e){var t=[],r=[],n;if(this._root)t.push(new s(this._root,this._x0,this._y0,this._x1,this._y1));while(n=t.pop()){var a=n.node;if(a.length){var i,o=n.x0,l=n.y0,u=n.x1,c=n.y1,f=(o+u)/2,h=(l+c)/2;if(i=a[0])t.push(new s(i,o,l,f,h));if(i=a[1])t.push(new s(i,f,l,u,h));if(i=a[2])t.push(new s(i,o,h,f,c));if(i=a[3])t.push(new s(i,f,h,u,c))}r.push(n)}while(n=r.pop()){e(n.node,n.x0,n.y0,n.x1,n.y1)}return this}function v(e){return e[0]}function m(e){return arguments.length?(this._x=e,this):this._x}function g(e){return e[1]}function y(e){return arguments.length?(this._y=e,this):this._y}function x(e,t,r){var n=new _(t==null?v:t,r==null?g:r,NaN,NaN,NaN,NaN);return e==null?n:n.addAll(e)}function _(e,t,r,n,a,i){this._x=e;this._y=t;this._x0=r;this._y0=n;this._x1=a;this._y1=i;this._root=undefined}function b(e){var t={data:e.data},r=t;while(e=e.next)r=r.next={data:e.data};return t}var w=x.prototype=_.prototype;w.copy=function(){var e=new _(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,r,n;if(!t)return e;if(!t.length)return e._root=b(t),e;r=[{source:t,target:e._root=new Array(4)}];while(t=r.pop()){for(var a=0;a<4;++a){if(n=t.source[a]){if(n.length)r.push({source:n,target:t.target[a]=new Array(4)});else t.target[a]=b(n)}}}return e};w.add=t;w.addAll=n;w.cover=a;w.data=i;w.extent=o;w.find=l;w.remove=u;w.removeAll=c;w.root=f;w.size=h;w.visit=p;w.visitAfter=d;w.x=m;w.y=y;e.quadtree=x;Object.defineProperty(e,"__esModule",{value:true})})},{}],165:[function(t,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,t("d3-path")):typeof e==="function"&&e.amd?e(["exports","d3-path"],i):(a=a||self,i(a.d3=a.d3||{},a.d3))})(this,function(e,t){"use strict";function r(e){return function t(){return e}}var n=Math.abs;var a=Math.atan2;var i=Math.cos;var o=Math.max;var s=Math.min;var l=Math.sin;var u=Math.sqrt;var c=1e-12;var f=Math.PI;var h=f/2;var p=2*f;function d(e){return e>1?0:e<-1?f:Math.acos(e)}function v(e){return e>=1?h:e<=-1?-h:Math.asin(e)}function m(e){return e.innerRadius}function g(e){return e.outerRadius}function y(e){return e.startAngle}function x(e){return e.endAngle}function _(e){return e&&e.padAngle}function b(e,t,r,n,a,i,o,s){var l=r-e,u=n-t,f=o-a,h=s-i,p=h*l-f*u;if(p*p<c)return;p=(f*(t-i)-h*(e-a))/p;return[e+p*l,t+p*u]}function w(e,t,r,n,a,i,s){var l=e-r,c=t-n,f=(s?i:-i)/u(l*l+c*c),h=f*c,p=-f*l,d=e+h,v=t+p,m=r+h,g=n+p,y=(d+m)/2,x=(v+g)/2,_=m-d,b=g-v,w=_*_+b*b,T=a-i,k=d*g-m*v,A=(b<0?-1:1)*u(o(0,T*T*w-k*k)),M=(k*b-_*A)/w,E=(-k*_-b*A)/w,S=(k*b+_*A)/w,C=(-k*_+b*A)/w,L=M-y,I=E-x,O=S-y,P=C-x;if(L*L+I*I>O*O+P*P)M=S,E=C;return{cx:M,cy:E,x01:-h,y01:-p,x11:M*(a/T-1),y11:E*(a/T-1)}}function T(){var e=m,o=g,T=r(0),k=null,A=y,M=x,E=_,S=null;function C(){var r,m,g=+e.apply(this,arguments),y=+o.apply(this,arguments),x=A.apply(this,arguments)-h,_=M.apply(this,arguments)-h,C=n(_-x),L=_>x;if(!S)S=r=t.path();if(y<g)m=y,y=g,g=m;if(!(y>c))S.moveTo(0,0);else if(C>p-c){S.moveTo(y*i(x),y*l(x));S.arc(0,0,y,x,_,!L);if(g>c){S.moveTo(g*i(_),g*l(_));S.arc(0,0,g,_,x,L)}}else{var I=x,O=_,P=x,D=_,R=C,z=C,N=E.apply(this,arguments)/2,F=N>c&&(k?+k.apply(this,arguments):u(g*g+y*y)),B=s(n(y-g)/2,+T.apply(this,arguments)),j=B,U=B,H,V;if(F>c){var G=v(F/g*l(N)),q=v(F/y*l(N));if((R-=G*2)>c)G*=L?1:-1,P+=G,D-=G;else R=0,P=D=(x+_)/2;if((z-=q*2)>c)q*=L?1:-1,I+=q,O-=q;else z=0,I=O=(x+_)/2}var Y=y*i(I),W=y*l(I),X=g*i(D),Z=g*l(D);if(B>c){var K=y*i(O),J=y*l(O),Q=g*i(P),$=g*l(P),ee;if(C<f&&(ee=b(Y,W,Q,$,K,J,X,Z))){var te=Y-ee[0],re=W-ee[1],ne=K-ee[0],ae=J-ee[1],ie=1/l(d((te*ne+re*ae)/(u(te*te+re*re)*u(ne*ne+ae*ae)))/2),oe=u(ee[0]*ee[0]+ee[1]*ee[1]);j=s(B,(g-oe)/(ie-1));U=s(B,(y-oe)/(ie+1))}}if(!(z>c))S.moveTo(Y,W);else if(U>c){H=w(Q,$,Y,W,y,U,L);V=w(K,J,X,Z,y,U,L);S.moveTo(H.cx+H.x01,H.cy+H.y01);if(U<B)S.arc(H.cx,H.cy,U,a(H.y01,H.x01),a(V.y01,V.x01),!L);else{S.arc(H.cx,H.cy,U,a(H.y01,H.x01),a(H.y11,H.x11),!L);S.arc(0,0,y,a(H.cy+H.y11,H.cx+H.x11),a(V.cy+V.y11,V.cx+V.x11),!L);S.arc(V.cx,V.cy,U,a(V.y11,V.x11),a(V.y01,V.x01),!L)}}else S.moveTo(Y,W),S.arc(0,0,y,I,O,!L);if(!(g>c)||!(R>c))S.lineTo(X,Z);else if(j>c){H=w(X,Z,K,J,g,-j,L);V=w(Y,W,Q,$,g,-j,L);S.lineTo(H.cx+H.x01,H.cy+H.y01);if(j<B)S.arc(H.cx,H.cy,j,a(H.y01,H.x01),a(V.y01,V.x01),!L);else{S.arc(H.cx,H.cy,j,a(H.y01,H.x01),a(H.y11,H.x11),!L);S.arc(0,0,g,a(H.cy+H.y11,H.cx+H.x11),a(V.cy+V.y11,V.cx+V.x11),L);S.arc(V.cx,V.cy,j,a(V.y11,V.x11),a(V.y01,V.x01),!L)}}else S.arc(0,0,g,D,P,L)}S.closePath();if(r)return S=null,r+""||null}C.centroid=function(){var t=(+e.apply(this,arguments)+ +o.apply(this,arguments))/2,r=(+A.apply(this,arguments)+ +M.apply(this,arguments))/2-f/2;return[i(r)*t,l(r)*t]};C.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),C):e};C.outerRadius=function(e){return arguments.length?(o=typeof e==="function"?e:r(+e),C):o};C.cornerRadius=function(e){return arguments.length?(T=typeof e==="function"?e:r(+e),C):T};C.padRadius=function(e){return arguments.length?(k=e==null?null:typeof e==="function"?e:r(+e),C):k};C.startAngle=function(e){return arguments.length?(A=typeof e==="function"?e:r(+e),C):A};C.endAngle=function(e){return arguments.length?(M=typeof e==="function"?e:r(+e),C):M};C.padAngle=function(e){return arguments.length?(E=typeof e==="function"?e:r(+e),C):E};C.context=function(e){return arguments.length?(S=e==null?null:e,C):S};return C}function k(e){this._context=e}k.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function A(e){return new k(e)}function M(e){return e[0]}function E(e){return e[1]}function S(){var e=M,n=E,a=r(true),i=null,o=A,s=null;function l(r){var l,u=r.length,c,f=false,h;if(i==null)s=o(h=t.path());for(l=0;l<=u;++l){if(!(l<u&&a(c=r[l],l,r))===f){if(f=!f)s.lineStart();else s.lineEnd()}if(f)s.point(+e(c,l,r),+n(c,l,r))}if(h)return s=null,h+""||null}l.x=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),l):e};l.y=function(e){return arguments.length?(n=typeof e==="function"?e:r(+e),l):n};l.defined=function(e){return arguments.length?(a=typeof e==="function"?e:r(!!e),l):a};l.curve=function(e){return arguments.length?(o=e,i!=null&&(s=o(i)),l):o};l.context=function(e){return arguments.length?(e==null?i=s=null:s=o(i=e),l):i};return l}function C(){var e=M,n=null,a=r(0),i=E,o=r(true),s=null,l=A,u=null;function c(r){var c,f,h,p=r.length,d,v=false,m,g=new Array(p),y=new Array(p);if(s==null)u=l(m=t.path());for(c=0;c<=p;++c){if(!(c<p&&o(d=r[c],c,r))===v){if(v=!v){f=c;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(h=c-1;h>=f;--h){u.point(g[h],y[h])}u.lineEnd();u.areaEnd()}}if(v){g[c]=+e(d,c,r),y[c]=+a(d,c,r);u.point(n?+n(d,c,r):g[c],i?+i(d,c,r):y[c])}}if(m)return u=null,m+""||null}function f(){return S().defined(o).curve(l).context(s)}c.x=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),n=null,c):e};c.x0=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),c):e};c.x1=function(e){return arguments.length?(n=e==null?null:typeof e==="function"?e:r(+e),c):n};c.y=function(e){return arguments.length?(a=typeof e==="function"?e:r(+e),i=null,c):a};c.y0=function(e){return arguments.length?(a=typeof e==="function"?e:r(+e),c):a};c.y1=function(e){return arguments.length?(i=e==null?null:typeof e==="function"?e:r(+e),c):i};c.lineX0=c.lineY0=function(){return f().x(e).y(a)};c.lineY1=function(){return f().x(e).y(i)};c.lineX1=function(){return f().x(n).y(a)};c.defined=function(e){return arguments.length?(o=typeof e==="function"?e:r(!!e),c):o};c.curve=function(e){return arguments.length?(l=e,s!=null&&(u=l(s)),c):l};c.context=function(e){return arguments.length?(e==null?s=u=null:u=l(s=e),c):s};return c}function L(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function I(e){return e}function O(){var e=I,t=L,n=null,a=r(0),i=r(p),o=r(0);function s(r){var s,l=r.length,u,c,f=0,h=new Array(l),d=new Array(l),v=+a.apply(this,arguments),m=Math.min(p,Math.max(-p,i.apply(this,arguments)-v)),g,y=Math.min(Math.abs(m)/l,o.apply(this,arguments)),x=y*(m<0?-1:1),_;for(s=0;s<l;++s){if((_=d[h[s]=s]=+e(r[s],s,r))>0){f+=_}}if(t!=null)h.sort(function(e,r){return t(d[e],d[r])});else if(n!=null)h.sort(function(e,t){return n(r[e],r[t])});for(s=0,c=f?(m-l*x)/f:0;s<l;++s,v=g){u=h[s],_=d[u],g=v+(_>0?_*c:0)+x,d[u]={data:r[u],index:s,value:_,startAngle:v,endAngle:g,padAngle:y}}return d}s.value=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),s):e};s.sortValues=function(e){return arguments.length?(t=e,n=null,s):t};s.sort=function(e){return arguments.length?(n=e,t=null,s):n};s.startAngle=function(e){return arguments.length?(a=typeof e==="function"?e:r(+e),s):a};s.endAngle=function(e){return arguments.length?(i=typeof e==="function"?e:r(+e),s):i};s.padAngle=function(e){return arguments.length?(o=typeof e==="function"?e:r(+e),s):o};return s}var P=R(A);function D(e){this._curve=e}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function R(e){function t(t){return new D(e(t))}t._curve=e;return t}function z(e){var t=e.curve;e.angle=e.x,delete e.x;e.radius=e.y,delete e.y;e.curve=function(e){return arguments.length?t(R(e)):t()._curve};return e}function N(){return z(S().curve(P))}function F(){var e=C().curve(P),t=e.curve,r=e.lineX0,n=e.lineX1,a=e.lineY0,i=e.lineY1;e.angle=e.x,delete e.x;e.startAngle=e.x0,delete e.x0;e.endAngle=e.x1,delete e.x1;e.radius=e.y,delete e.y;e.innerRadius=e.y0,delete e.y0;e.outerRadius=e.y1,delete e.y1;e.lineStartAngle=function(){return z(r())},delete e.lineX0;e.lineEndAngle=function(){return z(n())},delete e.lineX1;e.lineInnerRadius=function(){return z(a())},delete e.lineY0;e.lineOuterRadius=function(){return z(i())},delete e.lineY1;e.curve=function(e){return arguments.length?t(R(e)):t()._curve};return e}function B(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}var j=Array.prototype.slice;function U(e){return e.source}function H(e){return e.target}function V(e){var n=U,a=H,i=M,o=E,s=null;function l(){var r,l=j.call(arguments),u=n.apply(this,l),c=a.apply(this,l);if(!s)s=r=t.path();e(s,+i.apply(this,(l[0]=u,l)),+o.apply(this,l),+i.apply(this,(l[0]=c,l)),+o.apply(this,l));if(r)return s=null,r+""||null}l.source=function(e){return arguments.length?(n=e,l):n};l.target=function(e){return arguments.length?(a=e,l):a};l.x=function(e){return arguments.length?(i=typeof e==="function"?e:r(+e),l):i};l.y=function(e){return arguments.length?(o=typeof e==="function"?e:r(+e),l):o};l.context=function(e){return arguments.length?(s=e==null?null:e,l):s};return l}function G(e,t,r,n,a){e.moveTo(t,r);e.bezierCurveTo(t=(t+n)/2,r,t,a,n,a)}function q(e,t,r,n,a){e.moveTo(t,r);e.bezierCurveTo(t,r=(r+a)/2,n,r,n,a)}function Y(e,t,r,n,a){var i=B(t,r),o=B(t,r=(r+a)/2),s=B(n,r),l=B(n,a);e.moveTo(i[0],i[1]);e.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function W(){return V(G)}function X(){return V(q)}function Z(){var e=V(Y);e.angle=e.x,delete e.x;e.radius=e.y,delete e.y;return e}var K={draw:function(e,t){var r=Math.sqrt(t/f);e.moveTo(r,0);e.arc(0,0,r,0,p)}};var J={draw:function(e,t){var r=Math.sqrt(t/5)/2;e.moveTo(-3*r,-r);e.lineTo(-r,-r);e.lineTo(-r,-3*r);e.lineTo(r,-3*r);e.lineTo(r,-r);e.lineTo(3*r,-r);e.lineTo(3*r,r);e.lineTo(r,r);e.lineTo(r,3*r);e.lineTo(-r,3*r);e.lineTo(-r,r);e.lineTo(-3*r,r);e.closePath()}};var Q=Math.sqrt(1/3),$=Q*2;var ee={draw:function(e,t){var r=Math.sqrt(t/$),n=r*Q;e.moveTo(0,-r);e.lineTo(n,0);e.lineTo(0,r);e.lineTo(-n,0);e.closePath()}};var te=.8908130915292852,re=Math.sin(f/10)/Math.sin(7*f/10),ne=Math.sin(p/10)*re,ae=-Math.cos(p/10)*re;var ie={draw:function(e,t){var r=Math.sqrt(t*te),n=ne*r,a=ae*r;e.moveTo(0,-r);e.lineTo(n,a);for(var i=1;i<5;++i){var o=p*i/5,s=Math.cos(o),l=Math.sin(o);e.lineTo(l*r,-s*r);e.lineTo(s*n-l*a,l*n+s*a)}e.closePath()}};var oe={draw:function(e,t){var r=Math.sqrt(t),n=-r/2;e.rect(n,n,r,r)}};var se=Math.sqrt(3);var le={draw:function(e,t){var r=-Math.sqrt(t/(se*3));e.moveTo(0,r*2);e.lineTo(-se*r,-r);e.lineTo(se*r,-r);e.closePath()}};var ue=-.5,ce=Math.sqrt(3)/2,fe=1/Math.sqrt(12),he=(fe/2+1)*3;var pe={draw:function(e,t){var r=Math.sqrt(t/he),n=r/2,a=r*fe,i=n,o=r*fe+r,s=-i,l=o;e.moveTo(n,a);e.lineTo(i,o);e.lineTo(s,l);e.lineTo(ue*n-ce*a,ce*n+ue*a);e.lineTo(ue*i-ce*o,ce*i+ue*o);e.lineTo(ue*s-ce*l,ce*s+ue*l);e.lineTo(ue*n+ce*a,ue*a-ce*n);e.lineTo(ue*i+ce*o,ue*o-ce*i);e.lineTo(ue*s+ce*l,ue*l-ce*s);e.closePath()}};var de=[K,J,ee,oe,ie,le,pe];function ve(){var e=r(K),n=r(64),a=null;function i(){var r;if(!a)a=r=t.path();e.apply(this,arguments).draw(a,+n.apply(this,arguments));if(r)return a=null,r+""||null}i.type=function(t){return arguments.length?(e=typeof t==="function"?t:r(t),i):e};i.size=function(e){return arguments.length?(n=typeof e==="function"?e:r(+e),i):n};i.context=function(e){return arguments.length?(a=e==null?null:e,i):a};return i}function me(){}function ge(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ye(e){this._context=e}ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:ge(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ge(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function xe(e){return new ye(e)}function _e(e){this._context=e}_e.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ge(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function be(e){return new _e(e)}function we(e){this._context=e}we.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ge(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Te(e){return new we(e)}function ke(e,t){this._basis=new ye(e);this._beta=t}ke.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(r>0){var n=e[0],a=t[0],i=e[r]-n,o=t[r]-a,s=-1,l;while(++s<=r){l=s/r;this._basis.point(this._beta*e[s]+(1-this._beta)*(n+l*i),this._beta*t[s]+(1-this._beta)*(a+l*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var Ae=function e(t){function r(e){return t===1?new ye(e):new ke(e,t)}r.beta=function(t){return e(+t)};return r}(.85);function Me(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function Ee(e,t){this._context=e;this._k=(1-t)/6}Ee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Me(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:Me(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Se=function e(t){function r(e){return new Ee(e,t)}r.tension=function(t){return e(+t)};return r}(0);function Ce(e,t){this._context=e;this._k=(1-t)/6}Ce.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Me(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Le=function e(t){function r(e){return new Ce(e,t)}r.tension=function(t){return e(+t)};return r}(0);function Ie(e,t){this._context=e;this._k=(1-t)/6}Ie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Me(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Oe=function e(t){function r(e){return new Ie(e,t)}r.tension=function(t){return e(+t)};return r}(0);function Pe(e,t,r){var n=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>c){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);n=(n*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l;a=(a*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>c){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*u+e._x1*e._l23_2a-t*e._l12_2a)/f;o=(o*u+e._y1*e._l23_2a-r*e._l12_2a)/f}e._context.bezierCurveTo(n,a,i,o,e._x2,e._y2)}function De(e,t){this._context=e;this._alpha=t}De.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Pe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Re=function e(t){function r(e){return t?new De(e,t):new Ee(e,0)}r.alpha=function(t){return e(+t)};return r}(.5);function ze(e,t){this._context=e;this._alpha=t}ze.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Pe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ne=function e(t){function r(e){return t?new ze(e,t):new Ce(e,0)}r.alpha=function(t){return e(+t)};return r}(.5);function Fe(e,t){this._context=e;this._alpha=t}Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Pe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Be=function e(t){function r(e){return t?new Fe(e,t):new Ie(e,0)}r.alpha=function(t){return e(+t)};return r}(.5);function je(e){this._context=e}je.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function Ue(e){return new je(e)}function He(e){return e<0?-1:1}function Ve(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),s=(i*a+o*n)/(n+a);return(He(i)+He(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function Ge(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function qe(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-n)/3;e._context.bezierCurveTo(n+s,a+s*t,i-s,o-s*r,i,o)}function Ye(e){this._context=e}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:qe(this,this._t0,Ge(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var r=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;qe(this,Ge(this,r=Ve(this,e,t)),r);break;default:qe(this,this._t0,r=Ve(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=r}};function We(e){this._context=new Xe(e)}(We.prototype=Object.create(Ye.prototype)).point=function(e,t){Ye.prototype.point.call(this,t,e)};function Xe(e){this._context=e}Xe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function Ze(e){return new Ye(e)}function Ke(e){return new We(e)}function Je(e){this._context=e}Je.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(r===2){this._context.lineTo(e[1],t[1])}else{var n=Qe(e),a=Qe(t);for(var i=0,o=1;o<r;++i,++o){this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o])}}}if(this._line||this._line!==0&&r===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function Qe(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);a[0]=0,i[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r];for(t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];a[r-1]=o[r-1]/i[r-1];for(t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];i[r-1]=(e[r]+a[r-1])/2;for(t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function $e(e){return new Je(e)}function et(e,t){this._context=e;this._t=t}et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y);this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function tt(e){return new et(e,.5)}function rt(e){return new et(e,0)}function nt(e){return new et(e,1)}function at(e,t){if(!((o=e.length)>1))return;for(var r=1,n,a,i=e[t[0]],o,s=i.length;r<o;++r){a=i,i=e[t[r]];for(n=0;n<s;++n){i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}}}function it(e){var t=e.length,r=new Array(t);while(--t>=0)r[t]=t;return r}function ot(e,t){return e[t]}function st(){var e=r([]),t=it,n=at,a=ot;function i(r){var i=e.apply(this,arguments),o,s=r.length,l=i.length,u=new Array(l),c;for(o=0;o<l;++o){for(var f=i[o],h=u[o]=new Array(s),p=0,d;p<s;++p){h[p]=d=[0,+a(r[p],f,p,r)];d.data=r[p]}h.key=f}for(o=0,c=t(u);o<l;++o){u[c[o]].index=o}n(u,c);return u}i.keys=function(t){return arguments.length?(e=typeof t==="function"?t:r(j.call(t)),i):e};i.value=function(e){return arguments.length?(a=typeof e==="function"?e:r(+e),i):a};i.order=function(e){return arguments.length?(t=e==null?it:typeof e==="function"?e:r(j.call(e)),i):t};i.offset=function(e){return arguments.length?(n=e==null?at:e,i):n};return i}function lt(e,t){if(!((n=e.length)>0))return;for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}at(e,t)}function ut(e,t){if(!((l=e.length)>0))return;for(var r,n=0,a,i,o,s,l,u=e[t[0]].length;n<u;++n){for(o=s=0,r=0;r<l;++r){if((i=(a=e[t[r]][n])[1]-a[0])>0){a[0]=o,a[1]=o+=i}else if(i<0){a[1]=s,a[0]=s+=i}else{a[0]=0,a[1]=i}}}}function ct(e,t){if(!((a=e.length)>0))return;for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,s=0;o<a;++o)s+=e[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}at(e,t)}function ft(e,t){if(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))return;for(var r=0,n=1,a,i,o;n<i;++n){for(var s=0,l=0,u=0;s<o;++s){var c=e[t[s]],f=c[n][1]||0,h=c[n-1][1]||0,p=(f-h)/2;for(var d=0;d<s;++d){var v=e[t[d]],m=v[n][1]||0,g=v[n-1][1]||0;p+=m-g}l+=f,u+=p*f}a[n-1][1]+=a[n-1][0]=r;if(l)r-=u/l}a[n-1][1]+=a[n-1][0]=r;at(e,t)}function ht(e){var t=e.map(pt);return it(e).sort(function(e,r){return t[e]-t[r]})}function pt(e){var t=-1,r=0,n=e.length,a,i=-Infinity;while(++t<n)if((a=+e[t][1])>i)i=a,r=t;return r}function dt(e){var t=e.map(vt);return it(e).sort(function(e,r){return t[e]-t[r]})}function vt(e){var t=0,r=-1,n=e.length,a;while(++r<n)if(a=+e[r][1])t+=a;return t}function mt(e){return dt(e).reverse()}function gt(e){var t=e.length,r,n,a=e.map(vt),i=ht(e),o=0,s=0,l=[],u=[];for(r=0;r<t;++r){n=i[r];if(o<s){o+=a[n];l.push(n)}else{s+=a[n];u.push(n)}}return u.reverse().concat(l)}function yt(e){return it(e).reverse()}e.arc=T;e.area=C;e.areaRadial=F;e.curveBasis=xe;e.curveBasisClosed=be;e.curveBasisOpen=Te;e.curveBundle=Ae;e.curveCardinal=Se;e.curveCardinalClosed=Le;e.curveCardinalOpen=Oe;e.curveCatmullRom=Re;e.curveCatmullRomClosed=Ne;e.curveCatmullRomOpen=Be;e.curveLinear=A;e.curveLinearClosed=Ue;e.curveMonotoneX=Ze;e.curveMonotoneY=Ke;e.curveNatural=$e;e.curveStep=tt;e.curveStepAfter=nt;e.curveStepBefore=rt;e.line=S;e.lineRadial=N;e.linkHorizontal=W;e.linkRadial=Z;e.linkVertical=X;e.pie=O;e.pointRadial=B;e.radialArea=F;e.radialLine=N;e.stack=st;e.stackOffsetDiverging=ut;e.stackOffsetExpand=lt;e.stackOffsetNone=at;e.stackOffsetSilhouette=ct;e.stackOffsetWiggle=ft;e.stackOrderAppearance=ht;e.stackOrderAscending=dt;e.stackOrderDescending=mt;e.stackOrderInsideOut=gt;e.stackOrderNone=it;e.stackOrderReverse=yt;e.symbol=ve;e.symbolCircle=K;e.symbolCross=J;e.symbolDiamond=ee;e.symbolSquare=oe;e.symbolStar=ie;e.symbolTriangle=le;e.symbolWye=pe;e.symbols=de;Object.defineProperty(e,"__esModule",{value:true})})},{"d3-path":163}],166:[function(t,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,t("d3-time")):typeof e==="function"&&e.amd?e(["exports","d3-time"],i):(a=a||self,i(a.d3=a.d3||{},a.d3))})(this,function(e,t){"use strict";function r(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function a(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function i(e){var i=e.dateTime,s=e.date,l=e.time,u=e.periods,c=e.days,f=e.shortDays,ge=e.months,ye=e.shortMonths;var xe=h(u),_e=p(u),be=h(c),we=p(c),Te=h(f),ke=p(f),Ae=h(ge),Me=p(ge),Ee=h(ye),Se=p(ye);var Ce={a:Ve,A:Ge,b:qe,B:Ye,c:null,d:D,e:D,f:B,H:R,I:z,j:N,L:F,m:j,M:U,p:We,q:Xe,Q:ve,s:me,S:H,u:V,U:G,V:q,w:Y,W:W,x:null,X:null,y:X,Y:Z,Z:K,"%":de};var Le={a:Ze,A:Ke,b:Je,B:Qe,c:null,d:J,e:J,f:re,H:Q,I:$,j:ee,L:te,m:ne,M:ae,p:$e,q:et,Q:ve,s:me,S:ie,u:oe,U:se,V:le,w:ue,W:ce,x:null,X:null,y:fe,Y:he,Z:pe,"%":de};var Ie={a:ze,A:Ne,b:Fe,B:Be,c:je,d:k,e:k,f:L,H:M,I:M,j:A,L:C,m:T,M:E,p:Re,q:w,Q:O,s:P,S:S,u:v,U:m,V:g,w:d,W:y,x:Ue,X:He,y:_,Y:x,Z:b,"%":I};Ce.x=Oe(s,Ce);Ce.X=Oe(l,Ce);Ce.c=Oe(i,Ce);Le.x=Oe(s,Le);Le.X=Oe(l,Le);Le.c=Oe(i,Le);function Oe(e,t){return function(r){var n=[],a=-1,i=0,s=e.length,l,u,c;if(!(r instanceof Date))r=new Date(+r);while(++a<s){if(e.charCodeAt(a)===37){n.push(e.slice(i,a));if((u=o[l=e.charAt(++a)])!=null)l=e.charAt(++a);else u=l==="e"?" ":"0";if(c=t[l])l=c(r,u);n.push(l);i=a+1}}n.push(e.slice(i,a));return n.join("")}}function Pe(e,i){return function(o){var s=a(1900,undefined,1),l=De(s,e,o+="",0),u,c;if(l!=o.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(s.s*1e3+("L"in s?s.L:0));if(i&&!("Z"in s))s.Z=0;if("p"in s)s.H=s.H%12+s.p*12;if(s.m===undefined)s.m="q"in s?s.q:0;if("V"in s){if(s.V<1||s.V>53)return null;if(!("w"in s))s.w=1;if("Z"in s){u=n(a(s.y,0,1)),c=u.getUTCDay();u=c>4||c===0?t.utcMonday.ceil(u):t.utcMonday(u);u=t.utcDay.offset(u,(s.V-1)*7);s.y=u.getUTCFullYear();s.m=u.getUTCMonth();s.d=u.getUTCDate()+(s.w+6)%7}else{u=r(a(s.y,0,1)),c=u.getDay();u=c>4||c===0?t.timeMonday.ceil(u):t.timeMonday(u);u=t.timeDay.offset(u,(s.V-1)*7);s.y=u.getFullYear();s.m=u.getMonth();s.d=u.getDate()+(s.w+6)%7}}else if("W"in s||"U"in s){if(!("w"in s))s.w="u"in s?s.u%7:"W"in s?1:0;c="Z"in s?n(a(s.y,0,1)).getUTCDay():r(a(s.y,0,1)).getDay();s.m=0;s.d="W"in s?(s.w+6)%7+s.W*7-(c+5)%7:s.w+s.U*7-(c+6)%7}if("Z"in s){s.H+=s.Z/100|0;s.M+=s.Z%100;return n(s)}return r(s)}}function De(e,t,r,n){var a=0,i=t.length,s=r.length,l,u;while(a<i){if(n>=s)return-1;l=t.charCodeAt(a++);if(l===37){l=t.charAt(a++);u=Ie[l in o?t.charAt(a++):l];if(!u||(n=u(e,r,n))<0)return-1}else if(l!=r.charCodeAt(n++)){return-1}}return n}function Re(e,t,r){var n=xe.exec(t.slice(r));return n?(e.p=_e[n[0].toLowerCase()],r+n[0].length):-1}function ze(e,t,r){var n=Te.exec(t.slice(r));return n?(e.w=ke[n[0].toLowerCase()],r+n[0].length):-1}function Ne(e,t,r){var n=be.exec(t.slice(r));return n?(e.w=we[n[0].toLowerCase()],r+n[0].length):-1}function Fe(e,t,r){var n=Ee.exec(t.slice(r));return n?(e.m=Se[n[0].toLowerCase()],r+n[0].length):-1}function Be(e,t,r){var n=Ae.exec(t.slice(r));return n?(e.m=Me[n[0].toLowerCase()],r+n[0].length):-1}function je(e,t,r){return De(e,i,t,r)}function Ue(e,t,r){return De(e,s,t,r)}function He(e,t,r){return De(e,l,t,r)}function Ve(e){return f[e.getDay()]}function Ge(e){return c[e.getDay()]}function qe(e){return ye[e.getMonth()]}function Ye(e){return ge[e.getMonth()]}function We(e){return u[+(e.getHours()>=12)]}function Xe(e){return 1+~~(e.getMonth()/3)}function Ze(e){return f[e.getUTCDay()]}function Ke(e){return c[e.getUTCDay()]}function Je(e){return ye[e.getUTCMonth()]}function Qe(e){return ge[e.getUTCMonth()]}function $e(e){return u[+(e.getUTCHours()>=12)]}function et(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=Oe(e+="",Ce);t.toString=function(){return e};return t},parse:function(e){var t=Pe(e+="",false);t.toString=function(){return e};return t},utcFormat:function(e){var t=Oe(e+="",Le);t.toString=function(){return e};return t},utcParse:function(e){var t=Pe(e+="",true);t.toString=function(){return e};return t}}}var o={"-":"",_:" ",0:"0"},s=/^\s*\d+/,l=/^%/,u=/[\\^$*+?|[\]().{}]/g;function c(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function f(e){return e.replace(u,"\\$&")}function h(e){return new RegExp("^(?:"+e.map(f).join("|")+")","i")}function p(e){var t={},r=-1,n=e.length;while(++r<n)t[e[r].toLowerCase()]=r;return t}function d(e,t,r){var n=s.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function v(e,t,r){var n=s.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function m(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function g(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function y(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function x(e,t,r){var n=s.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function _(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function b(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function w(e,t,r){var n=s.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function T(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function k(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function A(e,t,r){var n=s.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function M(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function E(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function S(e,t,r){var n=s.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function C(e,t,r){var n=s.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function L(e,t,r){var n=s.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function I(e,t,r){var n=l.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function O(e,t,r){var n=s.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function P(e,t,r){var n=s.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function D(e,t){return c(e.getDate(),t,2)}function R(e,t){return c(e.getHours(),t,2)}function z(e,t){return c(e.getHours()%12||12,t,2)}function N(e,r){return c(1+t.timeDay.count(t.timeYear(e),e),r,3)}function F(e,t){return c(e.getMilliseconds(),t,3)}function B(e,t){return F(e,t)+"000"}function j(e,t){return c(e.getMonth()+1,t,2)}function U(e,t){return c(e.getMinutes(),t,2)}function H(e,t){return c(e.getSeconds(),t,2)}function V(e){var t=e.getDay();return t===0?7:t}function G(e,r){return c(t.timeSunday.count(t.timeYear(e)-1,e),r,2)}function q(e,r){var n=e.getDay();e=n>=4||n===0?t.timeThursday(e):t.timeThursday.ceil(e);return c(t.timeThursday.count(t.timeYear(e),e)+(t.timeYear(e).getDay()===4),r,2)}function Y(e){return e.getDay()}function W(e,r){return c(t.timeMonday.count(t.timeYear(e)-1,e),r,2)}function X(e,t){return c(e.getFullYear()%100,t,2)}function Z(e,t){return c(e.getFullYear()%1e4,t,4)}function K(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+c(t/60|0,"0",2)+c(t%60,"0",2)}function J(e,t){return c(e.getUTCDate(),t,2)}function Q(e,t){return c(e.getUTCHours(),t,2)}function $(e,t){return c(e.getUTCHours()%12||12,t,2)}function ee(e,r){return c(1+t.utcDay.count(t.utcYear(e),e),r,3)}function te(e,t){return c(e.getUTCMilliseconds(),t,3)}function re(e,t){return te(e,t)+"000"}function ne(e,t){return c(e.getUTCMonth()+1,t,2)}function ae(e,t){return c(e.getUTCMinutes(),t,2)}function ie(e,t){return c(e.getUTCSeconds(),t,2)}function oe(e){var t=e.getUTCDay();return t===0?7:t}function se(e,r){return c(t.utcSunday.count(t.utcYear(e)-1,e),r,2)}function le(e,r){var n=e.getUTCDay();e=n>=4||n===0?t.utcThursday(e):t.utcThursday.ceil(e);return c(t.utcThursday.count(t.utcYear(e),e)+(t.utcYear(e).getUTCDay()===4),r,2)}function ue(e){return e.getUTCDay()}function ce(e,r){return c(t.utcMonday.count(t.utcYear(e)-1,e),r,2)}function fe(e,t){return c(e.getUTCFullYear()%100,t,2)}function he(e,t){return c(e.getUTCFullYear()%1e4,t,4)}function pe(){return"+0000"}function de(){return"%"}function ve(e){return+e}function me(e){return Math.floor(+e/1e3)}var ge;ye({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ye(t){ge=i(t);e.timeFormat=ge.format;e.timeParse=ge.parse;e.utcFormat=ge.utcFormat;e.utcParse=ge.utcParse;return ge}var xe="%Y-%m-%dT%H:%M:%S.%LZ";function _e(e){return e.toISOString()}var be=Date.prototype.toISOString?_e:e.utcFormat(xe);function we(e){var t=new Date(e);return isNaN(t)?null:t}var Te=+new Date("2000-01-01T00:00:00.000Z")?we:e.utcParse(xe);e.isoFormat=be;e.isoParse=Te;e.timeFormatDefaultLocale=ye;e.timeFormatLocale=i;Object.defineProperty(e,"__esModule",{value:true})})},{"d3-time":167}],167:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";var t=new Date,r=new Date;function n(e,a,i,o){function s(t){return e(t=arguments.length===0?new Date:new Date(+t)),t}s.floor=function(t){return e(t=new Date(+t)),t};s.ceil=function(t){return e(t=new Date(t-1)),a(t,1),e(t),t};s.round=function(e){var t=s(e),r=s.ceil(e);return e-t<r-e?t:r};s.offset=function(e,t){return a(e=new Date(+e),t==null?1:Math.floor(t)),e};s.range=function(t,r,n){var i=[],o;t=s.ceil(t);n=n==null?1:Math.floor(n);if(!(t<r)||!(n>0))return i;do{i.push(o=new Date(+t)),a(t,n),e(t)}while(o<t&&t<r);return i};s.filter=function(t){return n(function(r){if(r>=r)while(e(r),!t(r))r.setTime(r-1)},function(e,r){if(e>=e){if(r<0)while(++r<=0){while(a(e,-1),!t(e)){}}else while(--r>=0){while(a(e,+1),!t(e)){}}}})};if(i){s.count=function(n,a){t.setTime(+n),r.setTime(+a);e(t),e(r);return Math.floor(i(t,r))};s.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?s:s.filter(o?function(t){return o(t)%e===0}:function(t){return s.count(0,t)%e===0})}}return s}var a=n(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});a.every=function(e){e=Math.floor(e);if(!isFinite(e)||!(e>0))return null;if(!(e>1))return a;return n(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e})};var i=a.range;var o=1e3;var s=6e4;var l=36e5;var u=864e5;var c=6048e5;var f=n(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*o)},function(e,t){return(t-e)/o},function(e){return e.getUTCSeconds()});var h=f.range;var p=n(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o)},function(e,t){e.setTime(+e+t*s)},function(e,t){return(t-e)/s},function(e){return e.getMinutes()});var d=p.range;var v=n(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o-e.getMinutes()*s)},function(e,t){e.setTime(+e+t*l)},function(e,t){return(t-e)/l},function(e){return e.getHours()});var m=v.range;var g=n(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/u},function(e){return e.getDate()-1});var y=g.range;function x(e){return n(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/c})}var _=x(0);var b=x(1);var w=x(2);var T=x(3);var k=x(4);var A=x(5);var M=x(6);var E=_.range;var S=b.range;var C=w.range;var L=T.range;var I=k.range;var O=A.range;var P=M.range;var D=n(function(e){e.setDate(1);e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});var R=D.range;var z=n(function(e){e.setMonth(0,1);e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});z.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:n(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e);t.setMonth(0,1);t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)})};var N=z.range;var F=n(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*s)},function(e,t){return(t-e)/s},function(e){return e.getUTCMinutes()});var B=F.range;var j=n(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*l)},function(e,t){return(t-e)/l},function(e){return e.getUTCHours()});var U=j.range;var H=n(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/u},function(e){return e.getUTCDate()-1});var V=H.range;function G(e){return n(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/c})}var q=G(0);var Y=G(1);var W=G(2);var X=G(3);var Z=G(4);var K=G(5);var J=G(6);var Q=q.range;var $=Y.range;var ee=W.range;var te=X.range;var re=Z.range;var ne=K.range;var ae=J.range;var ie=n(function(e){e.setUTCDate(1);e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()});var oe=ie.range;var se=n(function(e){e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});se.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:n(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)})};var le=se.range;e.timeDay=g;e.timeDays=y;e.timeFriday=A;e.timeFridays=O;e.timeHour=v;e.timeHours=m;e.timeInterval=n;e.timeMillisecond=a;e.timeMilliseconds=i;e.timeMinute=p;e.timeMinutes=d;e.timeMonday=b;e.timeMondays=S;e.timeMonth=D;e.timeMonths=R;e.timeSaturday=M;e.timeSaturdays=P;e.timeSecond=f;e.timeSeconds=h;e.timeSunday=_;e.timeSundays=E;e.timeThursday=k;e.timeThursdays=I;e.timeTuesday=w;e.timeTuesdays=C;e.timeWednesday=T;e.timeWednesdays=L;e.timeWeek=_;e.timeWeeks=E;e.timeYear=z;e.timeYears=N;e.utcDay=H;e.utcDays=V;e.utcFriday=K;e.utcFridays=ne;e.utcHour=j;e.utcHours=U;e.utcMillisecond=a;e.utcMilliseconds=i;e.utcMinute=F;e.utcMinutes=B;e.utcMonday=Y;e.utcMondays=$;e.utcMonth=ie;e.utcMonths=oe;e.utcSaturday=J;e.utcSaturdays=ae;e.utcSecond=f;e.utcSeconds=h;e.utcSunday=q;e.utcSundays=Q;e.utcThursday=Z;e.utcThursdays=re;e.utcTuesday=W;e.utcTuesdays=ee;e.utcWednesday=X;e.utcWednesdays=te;e.utcWeek=q;e.utcWeeks=Q;e.utcYear=se;e.utcYears=le;Object.defineProperty(e,"__esModule",{value:true})})},{}],168:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.d3=t.d3||{}))})(this,function(e){"use strict";var t=0,r=0,n=0,a=1e3,i,o,s=0,l=0,u=0,c=typeof performance==="object"&&performance.now?performance:Date,f=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function h(){return l||(f(p),l=c.now()+u)}function p(){l=0}function d(){this._call=this._time=this._next=null}d.prototype=v.prototype={constructor:d,restart:function(e,t,r){if(typeof e!=="function")throw new TypeError("callback is not a function");r=(r==null?h():+r)+(t==null?0:+t);if(!this._next&&o!==this){if(o)o._next=this;else i=this;o=this}this._call=e;this._time=r;_()},stop:function(){if(this._call){this._call=null;this._time=Infinity;_()}}};function v(e,t,r){var n=new d;n.restart(e,t,r);return n}function m(){h();++t;var e=i,r;while(e){if((r=l-e._time)>=0)e._call.call(null,r);e=e._next}--t}function g(){l=(s=c.now())+u;t=r=0;try{m()}finally{t=0;x();l=0}}function y(){var e=c.now(),t=e-s;if(t>a)u-=t,s=e}function x(){var e,t=i,r,n=Infinity;while(t){if(t._call){if(n>t._time)n=t._time;e=t,t=t._next}else{r=t._next,t._next=null;t=e?e._next=r:i=r}}o=e;_(n)}function _(e){if(t)return;if(r)r=clearTimeout(r);var i=e-l;if(i>24){if(e<Infinity)r=setTimeout(g,e-c.now()-u);if(n)n=clearInterval(n)}else{if(!n)s=c.now(),n=setInterval(y,a);t=1,f(g)}}function b(e,t,r){var n=new d;t=t==null?0:+t;n.restart(function(r){n.stop();e(r+t)},t,r);return n}function w(e,t,r){var n=new d,a=t;if(t==null)return n.restart(e,t,r),n;t=+t,r=r==null?h():+r;n.restart(function i(o){o+=a;n.restart(i,a+=t,r);e(o)},t,r);return n}e.interval=w;e.now=h;e.timeout=b;e.timer=v;e.timerFlush=m;Object.defineProperty(e,"__esModule",{value:true})})},{}],169:[function(t,r,n){!function(){var t={version:"3.5.17"};var n=[].slice,a=function(e){return n.call(e)};var i=this.document;function o(e){return e&&(e.ownerDocument||e.document||e).documentElement}function s(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}if(i){try{a(i.documentElement.childNodes)[0].nodeType}catch(e){a=function(e){var t=e.length,r=new Array(t);while(t--)r[t]=e[t];return r}}}if(!Date.now)Date.now=function(){return+new Date};if(i){try{i.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var l=this.Element.prototype,u=l.setAttribute,c=l.setAttributeNS,f=this.CSSStyleDeclaration.prototype,h=f.setProperty;l.setAttribute=function(e,t){u.call(this,e,t+"")};l.setAttributeNS=function(e,t,r){c.call(this,e,t,r+"")};f.setProperty=function(e,t,r){h.call(this,e,t+"",r)}}}t.ascending=p;function p(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}t.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};t.min=function(e,t){var r=-1,n=e.length,a,i;if(arguments.length===1){while(++r<n)if((i=e[r])!=null&&i>=i){a=i;break}while(++r<n)if((i=e[r])!=null&&a>i)a=i}else{while(++r<n)if((i=t.call(e,e[r],r))!=null&&i>=i){a=i;break}while(++r<n)if((i=t.call(e,e[r],r))!=null&&a>i)a=i}return a};t.max=function(e,t){var r=-1,n=e.length,a,i;if(arguments.length===1){while(++r<n)if((i=e[r])!=null&&i>=i){a=i;break}while(++r<n)if((i=e[r])!=null&&i>a)a=i}else{while(++r<n)if((i=t.call(e,e[r],r))!=null&&i>=i){a=i;break}while(++r<n)if((i=t.call(e,e[r],r))!=null&&i>a)a=i}return a};t.extent=function(e,t){var r=-1,n=e.length,a,i,o;if(arguments.length===1){while(++r<n)if((i=e[r])!=null&&i>=i){a=o=i;break}while(++r<n)if((i=e[r])!=null){if(a>i)a=i;if(o<i)o=i}}else{while(++r<n)if((i=t.call(e,e[r],r))!=null&&i>=i){a=o=i;break}while(++r<n)if((i=t.call(e,e[r],r))!=null){if(a>i)a=i;if(o<i)o=i}}return[a,o]};function d(e){return e===null?NaN:+e}function v(e){return!isNaN(e)}t.sum=function(e,t){var r=0,n=e.length,a,i=-1;if(arguments.length===1){while(++i<n)if(v(a=+e[i]))r+=a}else{while(++i<n)if(v(a=+t.call(e,e[i],i)))r+=a}return r};t.mean=function(e,t){var r=0,n=e.length,a,i=-1,o=n;if(arguments.length===1){while(++i<n)if(v(a=d(e[i])))r+=a;else--o}else{while(++i<n)if(v(a=d(t.call(e,e[i],i))))r+=a;else--o}if(o)return r/o};t.quantile=function(e,t){var r=(e.length-1)*t+1,n=Math.floor(r),a=+e[n-1],i=r-n;return i?a+i*(e[n]-a):a};t.median=function(e,r){var n=[],a=e.length,i,o=-1;if(arguments.length===1){while(++o<a)if(v(i=d(e[o])))n.push(i)}else{while(++o<a)if(v(i=d(r.call(e,e[o],o))))n.push(i)}if(n.length)return t.quantile(n.sort(p),.5)};t.variance=function(e,t){var r=e.length,n=0,a,i,o=0,s=-1,l=0;if(arguments.length===1){while(++s<r){if(v(a=d(e[s]))){i=a-n;n+=i/++l;o+=i*(a-n)}}}else{while(++s<r){if(v(a=d(t.call(e,e[s],s)))){i=a-n;n+=i/++l;o+=i*(a-n)}}}if(l>1)return o/(l-1)};t.deviation=function(){var e=t.variance.apply(this,arguments);return e?Math.sqrt(e):e};function m(e){return{left:function(t,r,n,a){if(arguments.length<3)n=0;if(arguments.length<4)a=t.length;while(n<a){var i=n+a>>>1;if(e(t[i],r)<0)n=i+1;else a=i}return n},right:function(t,r,n,a){if(arguments.length<3)n=0;if(arguments.length<4)a=t.length;while(n<a){var i=n+a>>>1;if(e(t[i],r)>0)a=i;else n=i+1}return n}}}var g=m(p);t.bisectLeft=g.left;t.bisect=t.bisectRight=g.right;t.bisector=function(e){return m(e.length===1?function(t,r){return p(e(t),r)}:e)};t.shuffle=function(e,t,r){if((n=arguments.length)<3){r=e.length;if(n<2)t=0}var n=r-t,a,i;while(n){i=Math.random()*n--|0;a=e[n+t],e[n+t]=e[i+t],e[i+t]=a}return e};t.permute=function(e,t){var r=t.length,n=new Array(r);while(r--)n[r]=e[t[r]];return n};t.pairs=function(e){var t=0,r=e.length-1,n,a=e[0],i=new Array(r<0?0:r);while(t<r)i[t]=[n=a,a=e[++t]];return i};t.transpose=function(e){if(!(o=e.length))return[];for(var r=-1,n=t.min(e,y),a=new Array(n);++r<n;){for(var i=-1,o,s=a[r]=new Array(o);++i<o;){s[i]=e[i][r]}}return a};function y(e){return e.length}t.zip=function(){return t.transpose(arguments)};t.keys=function(e){var t=[];for(var r in e)t.push(r);return t};t.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t};t.entries=function(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t};t.merge=function(e){var t=e.length,r,n=-1,a=0,i,o;while(++n<t)a+=e[n].length;i=new Array(a);while(--t>=0){o=e[t];r=o.length;while(--r>=0){i[--a]=o[r]}}return i};var x=Math.abs;t.range=function(e,t,r){if(arguments.length<3){r=1;if(arguments.length<2){t=e;e=0}}if((t-e)/r===Infinity)throw new Error("infinite range");var n=[],a=_(x(r)),i=-1,o;e*=a,t*=a,r*=a;if(r<0)while((o=e+r*++i)>t)n.push(o/a);else while((o=e+r*++i)<t)n.push(o/a);return n};function _(e){var t=1;while(e*t%1)t*=10;return t}function b(e,t){for(var r in t){Object.defineProperty(e.prototype,r,{value:t[r],enumerable:false})}}t.map=function(e,t){var r=new w;if(e instanceof w){e.forEach(function(e,t){r.set(e,t)})}else if(Array.isArray(e)){var n=-1,a=e.length,i;if(arguments.length===1)while(++n<a)r.set(n,e[n]);else while(++n<a)r.set(t.call(e,i=e[n],n),i)}else{for(var o in e)r.set(o,e[o])}return r};function w(){this._=Object.create(null)}var T="__proto__",k="\0";b(w,{has:E,get:function(e){return this._[A(e)]},set:function(e,t){return this._[A(e)]=t},remove:S,keys:C,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:M(t),value:this._[t]});return e},size:L,empty:I,forEach:function(e){for(var t in this._)e.call(this,M(t),this._[t])}});function A(e){return(e+="")===T||e[0]===k?k+e:e}function M(e){return(e+="")[0]===k?e.slice(1):e}function E(e){return A(e)in this._}function S(e){return(e=A(e))in this._&&delete this._[e]}function C(){var e=[];for(var t in this._)e.push(M(t));return e}function L(){var e=0;for(var t in this._)++e;return e}function I(){for(var e in this._)return false;return true}t.nest=function(){var e={},r=[],n=[],a,i;function o(t,n,s){if(s>=r.length)return i?i.call(e,n):a?n.sort(a):n;var l=-1,u=n.length,c=r[s++],f,h,p,d=new w,v;while(++l<u){if(v=d.get(f=c(h=n[l]))){v.push(h)}else{d.set(f,[h])}}if(t){h=t();p=function(e,r){h.set(e,o(t,r,s))}}else{h={};p=function(e,r){h[e]=o(t,r,s)}}d.forEach(p);return h}function s(e,t){if(t>=r.length)return e;var a=[],i=n[t++];e.forEach(function(e,r){a.push({key:e,values:s(r,t)})});return i?a.sort(function(e,t){return i(e.key,t.key)}):a}e.map=function(e,t){return o(t,e,0)};e.entries=function(e){return s(o(t.map,e,0),0)};e.key=function(t){r.push(t);return e};e.sortKeys=function(t){n[r.length-1]=t;return e};e.sortValues=function(t){a=t;return e};e.rollup=function(t){i=t;return e};return e};t.set=function(e){var t=new O;if(e)for(var r=0,n=e.length;r<n;++r)t.add(e[r]);return t};function O(){this._=Object.create(null)}b(O,{has:E,add:function(e){this._[A(e+="")]=true;return e},remove:S,values:C,size:L,empty:I,forEach:function(e){for(var t in this._)e.call(this,M(t))}});t.behavior={};function P(e){return e}t.rebind=function(e,t){var r=1,n=arguments.length,a;while(++r<n)e[a=arguments[r]]=D(e,t,t[a]);return e};function D(e,t,r){return function(){var n=r.apply(t,arguments);return n===t?e:n}}function R(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var r=0,n=z.length;r<n;++r){var a=z[r]+t;if(a in e)return a}}var z=["webkit","ms","moz","Moz","o","O"];function N(){}t.dispatch=function(){var e=new F,t=-1,r=arguments.length;while(++t<r)e[arguments[t]]=B(e);return e};function F(){}F.prototype.on=function(e,t){var r=e.indexOf("."),n="";if(r>=0){n=e.slice(r+1);e=e.slice(0,r)}if(e)return arguments.length<2?this[e].on(n):this[e].on(n,t);if(arguments.length===2){if(t==null)for(e in this){if(this.hasOwnProperty(e))this[e].on(n,null)}return this}};function B(e){var t=[],r=new w;function n(){var r=t,n=-1,a=r.length,i;while(++n<a)if(i=r[n].on)i.apply(this,arguments);return e}n.on=function(n,a){var i=r.get(n),o;if(arguments.length<2)return i&&i.on;if(i){i.on=null;t=t.slice(0,o=t.indexOf(i)).concat(t.slice(o+1));r.remove(n)}if(a)t.push(r.set(n,{on:a}));return e};return n}t.event=null;function j(){t.event.preventDefault()}function U(){var e=t.event,r;while(r=e.sourceEvent)e=r;return e}function H(e){var r=new F,n=0,a=arguments.length;while(++n<a)r[arguments[n]]=B(r);r.of=function(n,a){return function(i){try{var o=i.sourceEvent=t.event;i.target=e;t.event=i;r[i.type].apply(n,a)}finally{t.event=o}}};return r}t.requote=function(e){return e.replace(V,"\\$&")};var V=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var G={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)e[r]=t[r]};function q(e){G(e,Z);return e}var Y=function(e,t){return t.querySelector(e)},W=function(e,t){return t.querySelectorAll(e)},X=function(e,t){var r=e.matches||e[R(e,"matchesSelector")];X=function(e,t){return r.call(e,t)};return X(e,t)};if(typeof Sizzle==="function"){Y=function(e,t){return Sizzle(e,t)[0]||null};W=Sizzle;X=Sizzle.matchesSelector}t.selection=function(){return t.select(i.documentElement)};var Z=t.selection.prototype=[];Z.select=function(e){var t=[],r,n,a,i;e=K(e);for(var o=-1,s=this.length;++o<s;){t.push(r=[]);r.parentNode=(a=this[o]).parentNode;for(var l=-1,u=a.length;++l<u;){if(i=a[l]){r.push(n=e.call(i,i.__data__,l,o));if(n&&"__data__"in i)n.__data__=i.__data__}else{r.push(null)}}}return q(t)};function K(e){return typeof e==="function"?e:function(){return Y(e,this)}}Z.selectAll=function(e){var t=[],r,n;e=J(e);for(var i=-1,o=this.length;++i<o;){for(var s=this[i],l=-1,u=s.length;++l<u;){if(n=s[l]){t.push(r=a(e.call(n,n.__data__,l,i)));r.parentNode=n}}}return q(t)};function J(e){return typeof e==="function"?e:function(){return W(e,this)}}var Q="http://www.w3.org/1999/xhtml";var $={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};t.ns={prefix:$,qualify:function(e){var t=e.indexOf(":"),r=e;if(t>=0&&(r=e.slice(0,t))!=="xmlns")e=e.slice(t+1);return $.hasOwnProperty(r)?{space:$[r],local:e}:e}};Z.attr=function(e,r){if(arguments.length<2){if(typeof e==="string"){var n=this.node();e=t.ns.qualify(e);return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(r in e)this.each(ee(r,e[r]));return this}return this.each(ee(e,r))};function ee(e,r){e=t.ns.qualify(e);function n(){this.removeAttribute(e)}function a(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,r)}function o(){this.setAttributeNS(e.space,e.local,r)}function s(){var t=r.apply(this,arguments);if(t==null)this.removeAttribute(e);else this.setAttribute(e,t)}function l(){var t=r.apply(this,arguments);if(t==null)this.removeAttributeNS(e.space,e.local);else this.setAttributeNS(e.space,e.local,t)}return r==null?e.local?a:n:typeof r==="function"?e.local?l:s:e.local?o:i}function te(e){return e.trim().replace(/\s+/g," ")}Z.classed=function(e,t){if(arguments.length<2){if(typeof e==="string"){var r=this.node(),n=(e=ne(e)).length,a=-1;if(t=r.classList){while(++a<n)if(!t.contains(e[a]))return false}else{t=r.getAttribute("class");while(++a<n)if(!re(e[a]).test(t))return false}return true}for(t in e)this.each(ae(t,e[t]));return this}return this.each(ae(e,t))};function re(e){return new RegExp("(?:^|\\s+)"+t.requote(e)+"(?:\\s+|$)","g")}function ne(e){return(e+"").trim().split(/^|\s+/)}function ae(e,t){e=ne(e).map(ie);var r=e.length;function n(){var n=-1;while(++n<r)e[n](this,t)}function a(){var n=-1,a=t.apply(this,arguments);while(++n<r)e[n](this,a)}return typeof t==="function"?a:n}function ie(e){var t=re(e);return function(r,n){if(a=r.classList)return n?a.add(e):a.remove(e);var a=r.getAttribute("class")||"";if(n){t.lastIndex=0;if(!t.test(a))r.setAttribute("class",te(a+" "+e))}else{r.setAttribute("class",te(a.replace(t," ")))}}}Z.style=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(r in e)this.each(oe(r,e[r],t));return this}if(n<2){var a=this.node();return s(a).getComputedStyle(a,null).getPropertyValue(e)}r=""}return this.each(oe(e,t,r))};function oe(e,t,r){function n(){this.style.removeProperty(e)}function a(){this.style.setProperty(e,t,r)}function i(){var n=t.apply(this,arguments);if(n==null)this.style.removeProperty(e);else this.style.setProperty(e,n,r)}return t==null?n:typeof t==="function"?i:a}Z.property=function(e,t){if(arguments.length<2){if(typeof e==="string")return this.node()[e];for(t in e)this.each(se(t,e[t]));return this}return this.each(se(e,t))};function se(e,t){function r(){delete this[e]}function n(){this[e]=t}function a(){var r=t.apply(this,arguments);if(r==null)delete this[e];else this[e]=r}return t==null?r:typeof t==="function"?a:n}Z.text=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent};Z.html=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML};Z.append=function(e){e=le(e);return this.select(function(){return this.appendChild(e.apply(this,arguments))})};function le(e){function r(){var t=this.ownerDocument,r=this.namespaceURI;return r===Q&&t.documentElement.namespaceURI===Q?t.createElement(e):t.createElementNS(r,e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return typeof e==="function"?e:(e=t.ns.qualify(e)).local?n:r}Z.insert=function(e,t){e=le(e);t=K(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})};Z.remove=function(){return this.each(ue)};function ue(){var e=this.parentNode;if(e)e.removeChild(this)}Z.data=function(e,t){var r=-1,n=this.length,a,i;if(!arguments.length){e=new Array(n=(a=this[0]).length);while(++r<n){if(i=a[r]){e[r]=i.__data__}}return e}function o(e,r){var n,a=e.length,i=r.length,o=Math.min(a,i),c=new Array(i),f=new Array(i),h=new Array(a),p,d;if(t){var v=new w,m=new Array(a),g;for(n=-1;++n<a;){if(p=e[n]){if(v.has(g=t.call(p,p.__data__,n))){h[n]=p}else{v.set(g,p)}m[n]=g}}for(n=-1;++n<i;){if(!(p=v.get(g=t.call(r,d=r[n],n)))){f[n]=ce(d)}else if(p!==true){c[n]=p;p.__data__=d}v.set(g,true)}for(n=-1;++n<a;){if(n in m&&v.get(m[n])!==true){h[n]=e[n]}}}else{for(n=-1;++n<o;){p=e[n];d=r[n];if(p){p.__data__=d;c[n]=p}else{f[n]=ce(d)}}for(;n<i;++n){f[n]=ce(r[n])}for(;n<a;++n){h[n]=e[n]}}f.update=c;f.parentNode=c.parentNode=h.parentNode=e.parentNode;s.push(f);l.push(c);u.push(h)}var s=de([]),l=q([]),u=q([]);if(typeof e==="function"){while(++r<n){o(a=this[r],e.call(a,a.parentNode.__data__,r))}}else{while(++r<n){o(a=this[r],e)}}l.enter=function(){return s};l.exit=function(){return u};return l};function ce(e){return{__data__:e}}Z.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")};Z.filter=function(e){var t=[],r,n,a;if(typeof e!=="function")e=fe(e);for(var i=0,o=this.length;i<o;i++){t.push(r=[]);r.parentNode=(n=this[i]).parentNode;for(var s=0,l=n.length;s<l;s++){if((a=n[s])&&e.call(a,a.__data__,s,i)){r.push(a)}}}return q(t)};function fe(e){return function(){return X(this,e)}}Z.order=function(){for(var e=-1,t=this.length;++e<t;){for(var r=this[e],n=r.length-1,a=r[n],i;--n>=0;){if(i=r[n]){if(a&&a!==i.nextSibling)a.parentNode.insertBefore(i,a);a=i}}}return this};Z.sort=function(e){e=he.apply(this,arguments);for(var t=-1,r=this.length;++t<r;)this[t].sort(e);return this.order()};function he(e){if(!arguments.length)e=p;return function(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}}Z.each=function(e){return pe(this,function(t,r,n){e.call(t,t.__data__,r,n)})};function pe(e,t){for(var r=0,n=e.length;r<n;r++){for(var a=e[r],i=0,o=a.length,s;i<o;i++){if(s=a[i])t(s,i,r)}}return e}Z.call=function(e){var t=a(arguments);e.apply(t[0]=this,t);return this};Z.empty=function(){return!this.node()};Z.node=function(){for(var e=0,t=this.length;e<t;e++){for(var r=this[e],n=0,a=r.length;n<a;n++){var i=r[n];if(i)return i}}return null};Z.size=function(){var e=0;pe(this,function(){++e});return e};function de(e){G(e,ve);return e}var ve=[];t.selection.enter=de;t.selection.enter.prototype=ve;ve.append=Z.append;ve.empty=Z.empty;ve.node=Z.node;ve.call=Z.call;ve.size=Z.size;ve.select=function(e){var t=[],r,n,a,i,o;for(var s=-1,l=this.length;++s<l;){a=(i=this[s]).update;t.push(r=[]);r.parentNode=i.parentNode;for(var u=-1,c=i.length;++u<c;){if(o=i[u]){r.push(a[u]=n=e.call(i.parentNode,o.__data__,u,s));n.__data__=o.__data__}else{r.push(null)}}}return q(t)};ve.insert=function(e,t){if(arguments.length<2)t=me(this);return Z.insert.call(this,e,t)};function me(e){var t,r;return function(n,a,i){var o=e[i].update,s=o.length,l;if(i!=r)r=i,t=0;if(a>=t)t=a+1;while(!(l=o[t])&&++t<s);return l}}t.select=function(e){var t;if(typeof e==="string"){t=[Y(e,i)];t.parentNode=i.documentElement}else{t=[e];t.parentNode=o(e)}return q([t])};t.selectAll=function(e){var t;if(typeof e==="string"){t=a(W(e,i));t.parentNode=i.documentElement}else{t=a(e);t.parentNode=null}return q([t])};Z.on=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t=false;for(r in e)this.each(ge(r,e[r],t));return this}if(n<2)return(n=this.node()["__on"+e])&&n._;r=false}return this.each(ge(e,t,r))};function ge(e,r,n){var i="__on"+e,o=e.indexOf("."),s=xe;if(o>0)e=e.slice(0,o);var l=ye.get(e);if(l)e=l,s=_e;function u(){var t=this[i];if(t){this.removeEventListener(e,t,t.$);delete this[i]}}function c(){var t=s(r,a(arguments));u.call(this);this.addEventListener(e,this[i]=t,t.$=n);t._=r}function f(){var r=new RegExp("^__on([^.]+)"+t.requote(e)+"$"),n;for(var a in this){if(n=a.match(r)){var i=this[a];this.removeEventListener(n[1],i,i.$);delete this[a]}}}return o?r?c:u:r?N:f}var ye=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(i){ye.forEach(function(e){if("on"+e in i)ye.remove(e)})}function xe(e,r){return function(n){var a=t.event;t.event=n;r[0]=this.__data__;try{e.apply(this,r)}finally{t.event=a}}}function _e(e,t){var r=xe(e,t);return function(e){var t=this,n=e.relatedTarget;if(!n||n!==t&&!(n.compareDocumentPosition(t)&8)){r.call(t,e)}}}var be,we=0;function Te(e){var r=".dragsuppress-"+ ++we,n="click"+r,a=t.select(s(e)).on("touchmove"+r,j).on("dragstart"+r,j).on("selectstart"+r,j);if(be==null){be="onselectstart"in e?false:R(e.style,"userSelect")}if(be){var i=o(e).style,l=i[be];i[be]="none"}return function(e){a.on(r,null);if(be)i[be]=l;if(e){var t=function(){a.on(n,null)};a.on(n,function(){j();t()},true);setTimeout(t,0)}}}t.mouse=function(e){return Ae(e,U())};var ke=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Ae(e,r){if(r.changedTouches)r=r.changedTouches[0];var n=e.ownerSVGElement||e;if(n.createSVGPoint){var a=n.createSVGPoint();if(ke<0){var i=s(e);if(i.scrollX||i.scrollY){n=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=n[0][0].getScreenCTM();ke=!(o.f||o.e);n.remove()}}if(ke)a.x=r.pageX,a.y=r.pageY;else a.x=r.clientX,a.y=r.clientY;a=a.matrixTransform(e.getScreenCTM().inverse());return[a.x,a.y]}var l=e.getBoundingClientRect();return[r.clientX-l.left-e.clientLeft,r.clientY-l.top-e.clientTop]}t.touch=function(e,t,r){if(arguments.length<3)r=t,t=U().changedTouches;if(t)for(var n=0,a=t.length,i;n<a;++n){if((i=t[n]).identifier===r){return Ae(e,i)}}};t.behavior.drag=function(){var e=H(i,"drag","dragstart","dragend"),r=null,n=o(N,t.mouse,s,"mousemove","mouseup"),a=o(Me,t.touch,P,"touchmove","touchend");function i(){this.on("mousedown.drag",n).on("touchstart.drag",a)}function o(n,a,i,o,s){return function(){var l=this,u=t.event.target.correspondingElement||t.event.target,c=l.parentNode,f=e.of(l,arguments),h=0,p=n(),d=".drag"+(p==null?"":"-"+p),v,m=t.select(i(u)).on(o+d,x).on(s+d,_),g=Te(u),y=a(c,p);if(r){v=r.apply(l,arguments);v=[v.x-y[0],v.y-y[1]]}else{v=[0,0]}f({type:"dragstart"});function x(){var e=a(c,p),t,r;if(!e)return;t=e[0]-y[0];r=e[1]-y[1];h|=t|r;y=e;f({type:"drag",x:e[0]+v[0],y:e[1]+v[1],dx:t,dy:r})}function _(){if(!a(c,p))return;m.on(o+d,null).on(s+d,null);g(h);f({type:"dragend"})}}}i.origin=function(e){if(!arguments.length)return r;r=e;return i};return t.rebind(i,e,"on")};function Me(){return t.event.changedTouches[0].identifier}t.touches=function(e,t){if(arguments.length<2)t=U().touches;return t?a(t).map(function(t){var r=Ae(e,t);r.identifier=t.identifier;return r}):[]};var Ee=1e-6,Se=Ee*Ee,Ce=Math.PI,Le=2*Ce,Ie=Le-Ee,Oe=Ce/2,Pe=Ce/180,De=180/Ce;function Re(e){return e>0?1:e<0?-1:0}function ze(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function Ne(e){return e>1?0:e<-1?Ce:Math.acos(e)}function Fe(e){return e>1?Oe:e<-1?-Oe:Math.asin(e)}function Be(e){return((e=Math.exp(e))-1/e)/2}function je(e){return((e=Math.exp(e))+1/e)/2}function Ue(e){return((e=Math.exp(2*e))-1)/(e+1)}function He(e){return(e=Math.sin(e/2))*e}var Ve=Math.SQRT2,Ge=2,qe=4;t.interpolateZoom=function(e,t){var r=e[0],n=e[1],a=e[2],i=t[0],o=t[1],s=t[2],l=i-r,u=o-n,c=l*l+u*u,f,h;if(c<Se){h=Math.log(s/a)/Ve;f=function(e){return[r+e*l,n+e*u,a*Math.exp(Ve*e*h)]}}else{var p=Math.sqrt(c),d=(s*s-a*a+qe*c)/(2*a*Ge*p),v=(s*s-a*a-qe*c)/(2*s*Ge*p),m=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(v*v+1)-v);h=(g-m)/Ve;f=function(e){var t=e*h,i=je(m),o=a/(Ge*p)*(i*Ue(Ve*t+m)-Be(m));return[r+o*l,n+o*u,a*i/je(Ve*t+m)]}}f.duration=h*1e3;return f};t.behavior.zoom=function(){var e={x:0,y:0,k:1},r,n,a,o=[960,500],l=Ye,u=250,c=0,f="mousedown.zoom",h="mousemove.zoom",p="mouseup.zoom",d,v="touchstart.zoom",m,g=H(w,"zoomstart","zoom","zoomend"),y,x,_,b;if(!Xe){Xe="onwheel"in i?(We=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in i?(We=function(){return t.event.wheelDelta},"mousewheel"):(We=function(){return-t.event.detail},"MozMousePixelScroll")}function w(e){e.on(f,O).on(Xe+".zoom",D).on("dblclick.zoom",R).on(v,P)}w.event=function(r){r.each(function(){var r=g.of(this,arguments),a=e;if(Ol){t.select(this).transition().each("start.zoom",function(){e=this.__chart__||{x:0,y:0,k:1};C(r)}).tween("zoom:zoom",function(){var i=o[0],s=o[1],l=n?n[0]:i/2,u=n?n[1]:s/2,c=t.interpolateZoom([(l-e.x)/e.k,(u-e.y)/e.k,i/e.k],[(l-a.x)/a.k,(u-a.y)/a.k,i/a.k]);return function(t){var n=c(t),a=i/n[2];this.__chart__=e={x:l-n[0]*a,y:u-n[1]*a,k:a};L(r)}}).each("interrupt.zoom",function(){I(r)}).each("end.zoom",function(){I(r)})}else{this.__chart__=e;C(r);L(r);I(r)}})};w.translate=function(t){if(!arguments.length)return[e.x,e.y];e={x:+t[0],y:+t[1],k:e.k};S();return w};w.scale=function(t){if(!arguments.length)return e.k;e={x:e.x,y:e.y,k:null};A(+t);S();return w};w.scaleExtent=function(e){if(!arguments.length)return l;l=e==null?Ye:[+e[0],+e[1]];return w};w.center=function(e){if(!arguments.length)return a;a=e&&[+e[0],+e[1]];return w};w.size=function(e){if(!arguments.length)return o;o=e&&[+e[0],+e[1]];return w};w.duration=function(e){if(!arguments.length)return u;u=+e;return w};w.x=function(t){if(!arguments.length)return x;x=t;y=t.copy();e={x:0,y:0,k:1};return w};w.y=function(t){if(!arguments.length)return b;b=t;_=t.copy();e={x:0,y:0,k:1};return w};function T(t){return[(t[0]-e.x)/e.k,(t[1]-e.y)/e.k]}function k(t){return[t[0]*e.k+e.x,t[1]*e.k+e.y]}function A(t){e.k=Math.max(l[0],Math.min(l[1],t))}function M(t,r){r=k(r);e.x+=t[0]-r[0];e.y+=t[1]-r[1]}function E(r,a,i,o){r.__chart__={x:e.x,y:e.y,k:e.k};A(Math.pow(2,o));M(n=a,i);r=t.select(r);if(u>0)r=r.transition().duration(u);r.call(w.event)}function S(){if(x)x.domain(y.range().map(function(t){return(t-e.x)/e.k}).map(y.invert));if(b)b.domain(_.range().map(function(t){return(t-e.y)/e.k}).map(_.invert))}function C(e){if(!c++)e({type:"zoomstart"})}function L(t){S();t({type:"zoom",scale:e.k,translate:[e.x,e.y]})}function I(e){if(!--c)e({type:"zoomend"}),n=null}function O(){var e=this,r=g.of(e,arguments),n=0,a=t.select(s(e)).on(h,l).on(p,u),i=T(t.mouse(e)),o=Te(e);El.call(e);C(r);function l(){n=1;M(t.mouse(e),i);L(r)}function u(){a.on(h,null).on(p,null);o(n);I(r)}}function P(){var r=this,n=g.of(r,arguments),a={},i=0,o,s=".zoom-"+t.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],h=t.select(r),p=Te(r);y();C(n);h.on(f,null).on(v,y);function d(){var n=t.touches(r);o=e.k;n.forEach(function(e){if(e.identifier in a)a[e.identifier]=T(e)});return n}function y(){var n=t.event.target;t.select(n).on(l,x).on(u,_);c.push(n);var o=t.event.changedTouches;for(var s=0,f=o.length;s<f;++s){a[o[s].identifier]=null}var h=d(),p=Date.now();if(h.length===1){if(p-m<500){var v=h[0];E(r,v,a[v.identifier],Math.floor(Math.log(e.k)/Math.LN2)+1);j()}m=p}else if(h.length>1){var v=h[0],g=h[1],y=v[0]-g[0],b=v[1]-g[1];i=y*y+b*b}}function x(){var e=t.touches(r),s,l,u,c;El.call(r);for(var f=0,h=e.length;f<h;++f,c=null){u=e[f];if(c=a[u.identifier]){if(l)break;s=u,l=c}}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,d=i&&Math.sqrt(p/i);s=[(s[0]+u[0])/2,(s[1]+u[1])/2];l=[(l[0]+c[0])/2,(l[1]+c[1])/2];A(d*o)}m=null;M(s,l);L(n)}function _(){if(t.event.touches.length){var e=t.event.changedTouches;for(var r=0,i=e.length;r<i;++r){delete a[e[r].identifier]}for(var o in a){return void d()}}t.selectAll(c).on(s,null);h.on(f,O).on(v,P);p();I(n)}}function D(){var i=g.of(this,arguments);if(d)clearTimeout(d);else El.call(this),r=T(n=a||t.mouse(this)),C(i);d=setTimeout(function(){d=null;I(i)},50);j();A(Math.pow(2,We()*.002)*e.k);M(n,r);L(i)}function R(){var r=t.mouse(this),n=Math.log(e.k)/Math.LN2;E(this,r,T(r),t.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}return t.rebind(w,g,"on")};var Ye=[0,Infinity],We,Xe;t.color=Ze;function Ze(){}Ze.prototype.toString=function(){return this.rgb()+""};t.hsl=Ke;function Ke(e,t,r){return this instanceof Ke?void(this.h=+e,this.s=+t,this.l=+r):arguments.length<2?e instanceof Ke?new Ke(e.h,e.s,e.l):yt(""+e,xt,Ke):new Ke(e,t,r)}var Je=Ke.prototype=new Ze;Je.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);return new Ke(this.h,this.s,this.l/e)};Je.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new Ke(this.h,this.s,e*this.l)};Je.rgb=function(){return Qe(this.h,this.s,this.l)};function Qe(e,t,r){var n,a;e=isNaN(e)?0:(e%=360)<0?e+360:e;t=isNaN(t)?0:t<0?0:t>1?1:t;r=r<0?0:r>1?1:r;a=r<=.5?r*(1+t):r+t-r*t;n=2*r-a;function i(e){if(e>360)e-=360;else if(e<0)e+=360;if(e<60)return n+(a-n)*e/60;if(e<180)return a;if(e<240)return n+(a-n)*(240-e)/60;return n}function o(e){return Math.round(i(e)*255)}return new pt(o(e+120),o(e),o(e-120))}t.hcl=$e;function $e(e,r,n){return this instanceof $e?void(this.h=+e,this.c=+r,this.l=+n):arguments.length<2?e instanceof $e?new $e(e.h,e.c,e.l):e instanceof rt?ut(e.l,e.a,e.b):ut((e=_t((e=t.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new $e(e,r,n)}var et=$e.prototype=new Ze;et.brighter=function(e){return new $e(this.h,this.c,Math.min(100,this.l+nt*(arguments.length?e:1)))};et.darker=function(e){return new $e(this.h,this.c,Math.max(0,this.l-nt*(arguments.length?e:1)))};et.rgb=function(){return tt(this.h,this.c,this.l).rgb()};function tt(e,t,r){if(isNaN(e))e=0;if(isNaN(t))t=0;return new rt(r,Math.cos(e*=Pe)*t,Math.sin(e)*t)}t.lab=rt;function rt(e,t,r){return this instanceof rt?void(this.l=+e,this.a=+t,this.b=+r):arguments.length<2?e instanceof rt?new rt(e.l,e.a,e.b):e instanceof $e?tt(e.h,e.c,e.l):_t((e=pt(e)).r,e.g,e.b):new rt(e,t,r)}var nt=18;var at=.95047,it=1,ot=1.08883;var st=rt.prototype=new Ze;st.brighter=function(e){return new rt(Math.min(100,this.l+nt*(arguments.length?e:1)),this.a,this.b)};st.darker=function(e){return new rt(Math.max(0,this.l-nt*(arguments.length?e:1)),this.a,this.b)};st.rgb=function(){return lt(this.l,this.a,this.b)};function lt(e,t,r){var n=(e+16)/116,a=n+t/500,i=n-r/200;a=ct(a)*at;n=ct(n)*it;i=ct(i)*ot;return new pt(ht(3.2404542*a-1.5371385*n-.4985314*i),ht(-.969266*a+1.8760108*n+.041556*i),ht(.0556434*a-.2040259*n+1.0572252*i))}function ut(e,t,r){return e>0?new $e(Math.atan2(r,t)*De,Math.sqrt(t*t+r*r),e):new $e(NaN,NaN,e)}function ct(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ft(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function ht(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}t.rgb=pt;function pt(e,t,r){return this instanceof pt?void(this.r=~~e,this.g=~~t,this.b=~~r):arguments.length<2?e instanceof pt?new pt(e.r,e.g,e.b):yt(""+e,pt,Qe):new pt(e,t,r)}function dt(e){return new pt(e>>16,e>>8&255,e&255)}function vt(e){return dt(e)+""}var mt=pt.prototype=new Ze;mt.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,r=this.g,n=this.b,a=30;if(!t&&!r&&!n)return new pt(a,a,a);if(t&&t<a)t=a;if(r&&r<a)r=a;if(n&&n<a)n=a;return new pt(Math.min(255,t/e),Math.min(255,r/e),Math.min(255,n/e))};mt.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new pt(e*this.r,e*this.g,e*this.b)};mt.hsl=function(){return xt(this.r,this.g,this.b)};mt.toString=function(){return"#"+gt(this.r)+gt(this.g)+gt(this.b)};function gt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function yt(e,t,r){var n=0,a=0,i=0,o,s,l;o=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase());if(o){s=o[2].split(",");switch(o[1]){case"hsl":{return r(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100)}case"rgb":{return t(wt(s[0]),wt(s[1]),wt(s[2]))}}}if(l=Tt.get(e)){return t(l.r,l.g,l.b)}if(e!=null&&e.charAt(0)==="#"&&!isNaN(l=parseInt(e.slice(1),16))){if(e.length===4){n=(l&3840)>>4;n=n>>4|n;a=l&240;a=a>>4|a;i=l&15;i=i<<4|i}else if(e.length===7){n=(l&16711680)>>16;a=(l&65280)>>8;i=l&255}}return t(n,a,i)}function xt(e,t,r){var n=Math.min(e/=255,t/=255,r/=255),a=Math.max(e,t,r),i=a-n,o,s,l=(a+n)/2;if(i){s=l<.5?i/(a+n):i/(2-a-n);if(e==a)o=(t-r)/i+(t<r?6:0);else if(t==a)o=(r-e)/i+2;else o=(e-t)/i+4;o*=60}else{o=NaN;s=l>0&&l<1?0:o}return new Ke(o,s,l)}function _t(e,t,r){e=bt(e);t=bt(t);r=bt(r);var n=ft((.4124564*e+.3575761*t+.1804375*r)/at),a=ft((.2126729*e+.7151522*t+.072175*r)/it),i=ft((.0193339*e+.119192*t+.9503041*r)/ot);return rt(116*a-16,500*(n-a),200*(a-i))}function bt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}var Tt=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Tt.forEach(function(e,t){Tt.set(e,dt(t))});function kt(e){return typeof e==="function"?e:function(){return e}}t.functor=kt;t.xhr=At(P);function At(e){return function(t,r,n){if(arguments.length===2&&typeof r==="function")n=r,r=null;return Mt(t,r,e,n)}}function Mt(e,r,n,i){var o={},s=t.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;if(this.XDomainRequest&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(e))u=new XDomainRequest;"onload"in u?u.onload=u.onerror=f:u.onreadystatechange=function(){u.readyState>3&&f()};function f(){var e=u.status,t;if(!e&&St(u)||e>=200&&e<300||e===304){try{t=n.call(o,u)}catch(e){s.error.call(o,e);return}s.load.call(o,t)}else{s.error.call(o,u)}}u.onprogress=function(e){var r=t.event;t.event=e;try{s.progress.call(o,u)}finally{t.event=r}};o.header=function(e,t){e=(e+"").toLowerCase();if(arguments.length<2)return l[e];if(t==null)delete l[e];else l[e]=t+"";return o};o.mimeType=function(e){if(!arguments.length)return r;r=e==null?null:e+"";return o};o.responseType=function(e){if(!arguments.length)return c;c=e;return o};o.response=function(e){n=e;return o};["get","post"].forEach(function(e){o[e]=function(){return o.send.apply(o,[e].concat(a(arguments)))}});o.send=function(t,n,a){if(arguments.length===2&&typeof n==="function")a=n,n=null;u.open(t,e,true);if(r!=null&&!("accept"in l))l["accept"]=r+",*/*";if(u.setRequestHeader)for(var i in l)u.setRequestHeader(i,l[i]);if(r!=null&&u.overrideMimeType)u.overrideMimeType(r);if(c!=null)u.responseType=c;if(a!=null)o.on("error",a).on("load",function(e){a(null,e)});s.beforesend.call(o,u);u.send(n==null?null:n);return o};o.abort=function(){u.abort();return o};t.rebind(o,s,"on");return i==null?o:o.get(Et(i))}function Et(e){return e.length===1?function(t,r){e(t==null?r:null)}:e}function St(e){var t=e.responseType;return t&&t!=="text"?e.response:e.responseText}t.dsv=function(e,t){var r=new RegExp('["'+e+"\n]"),n=e.charCodeAt(0);function a(e,r,n){if(arguments.length<3)n=r,r=null;var a=Mt(e,t,r==null?i:o(r),n);a.row=function(e){return arguments.length?a.response((r=e)==null?i:o(e)):r};return a}function i(e){return a.parse(e.responseText)}function o(e){return function(t){return a.parse(t.responseText,e)}}a.parse=function(e,t){var r;return a.parseRows(e,function(e,n){if(r)return r(e,n-1);var a=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,r){return t(a(e),r)}:a})};a.parseRows=function(e,t){var r={},a={},i=[],o=e.length,s=0,l=0,u,c;function f(){if(s>=o)return a;if(c)return c=false,r;var t=s;if(e.charCodeAt(t)===34){var i=t;while(i++<o){if(e.charCodeAt(i)===34){if(e.charCodeAt(i+1)!==34)break;++i}}s=i+2;var l=e.charCodeAt(i+1);if(l===13){c=true;if(e.charCodeAt(i+2)===10)++s}else if(l===10){c=true}return e.slice(t+1,i).replace(/""/g,'"')}while(s<o){var l=e.charCodeAt(s++),u=1;if(l===10)c=true;else if(l===13){c=true;if(e.charCodeAt(s)===10)++s,++u}else if(l!==n)continue;return e.slice(t,s-u)}return e.slice(t)}while((u=f())!==a){var h=[];while(u!==r&&u!==a){h.push(u);u=f()}if(t&&(h=t(h,l++))==null)continue;i.push(h)}return i};a.format=function(t){if(Array.isArray(t[0]))return a.formatRows(t);var r=new O,n=[];t.forEach(function(e){for(var t in e){if(!r.has(t)){n.push(r.add(t))}}});return[n.map(l).join(e)].concat(t.map(function(t){return n.map(function(e){return l(t[e])}).join(e)})).join("\n")};a.formatRows=function(e){return e.map(s).join("\n")};function s(t){return t.map(l).join(e)}function l(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}return a};t.csv=t.dsv(",","text/csv");t.tsv=t.dsv("\t","text/tab-separated-values");var Ct,Lt,It,Ot,Pt=this[R(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};t.timer=function(){Dt.apply(this,arguments)};function Dt(e,t,r){var n=arguments.length;if(n<2)t=0;if(n<3)r=Date.now();var a=r+t,i={c:e,t:a,n:null};if(Lt)Lt.n=i;else Ct=i;Lt=i;if(!It){Ot=clearTimeout(Ot);It=1;Pt(Rt)}return i}function Rt(){var e=zt(),t=Nt()-e;if(t>24){if(isFinite(t)){clearTimeout(Ot);Ot=setTimeout(Rt,t)}It=0}else{It=1;Pt(Rt)}}t.timer.flush=function(){zt();Nt()};function zt(){var e=Date.now(),t=Ct;while(t){if(e>=t.t&&t.c(e-t.t))t.c=null;t=t.n}return e}function Nt(){var e,t=Ct,r=Infinity;while(t){if(t.c){if(t.t<r)r=t.t;t=(e=t).n}else{t=e?e.n=t.n:Ct=t.n}}Lt=e;return r}function Ft(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}t.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var Bt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(jt);t.formatPrefix=function(e,r){var n=0;if(e=+e){if(e<0)e*=-1;if(r)e=t.round(e,Ft(e,r));n=1+Math.floor(1e-12+Math.log(e)/Math.LN10);n=Math.max(-24,Math.min(24,Math.floor((n-1)/3)*3))}return Bt[8+n/3]};function jt(e,t){var r=Math.pow(10,x(8-t)*3);return{scale:t>8?function(e){return e/r}:function(e){return e*r},symbol:e}}function Ut(e){var r=e.decimal,n=e.thousands,a=e.grouping,i=e.currency,o=a&&n?function(e,t){var r=e.length,i=[],o=0,s=a[0],l=0;while(r>0&&s>0){if(l+s+1>t)s=Math.max(1,t-l);i.push(e.substring(r-=s,r+s));if((l+=s+1)>t)break;s=a[o=(o+1)%a.length]}return i.reverse().join(n)}:P;return function(e){var n=Ht.exec(e),a=n[1]||" ",s=n[2]||">",l=n[3]||"-",u=n[4]||"",c=n[5],f=+n[6],h=n[7],p=n[8],d=n[9],v=1,m="",g="",y=false,x=true;if(p)p=+p.substring(1);if(c||a==="0"&&s==="="){c=a="0";s="="}switch(d){case"n":h=true;d="g";break;case"%":v=100;g="%";d="f";break;case"p":v=100;g="%";d="r";break;case"b":case"o":case"x":case"X":if(u==="#")m="0"+d.toLowerCase();case"c":x=false;case"d":y=true;p=0;break;case"s":v=-1;d="r";break}if(u==="$")m=i[0],g=i[1];if(d=="r"&&!p)d="g";if(p!=null){if(d=="g")p=Math.max(1,Math.min(21,p));else if(d=="e"||d=="f")p=Math.max(0,Math.min(20,p))}d=Vt.get(d)||Gt;var _=c&&h;return function(e){var n=g;if(y&&e%1)return"";var i=e<0||e===0&&1/e<0?(e=-e,"-"):l==="-"?"":l;if(v<0){var u=t.formatPrefix(e,p);e=u.scale(e);n=u.symbol+g}else{e*=v}e=d(e,p);var b=e.lastIndexOf("."),w,T;if(b<0){var k=x?e.lastIndexOf("e"):-1;if(k<0)w=e,T="";else w=e.substring(0,k),T=e.substring(k)}else{w=e.substring(0,b);T=r+e.substring(b+1)}if(!c&&h)w=o(w,Infinity);var A=m.length+w.length+T.length+(_?0:i.length),M=A<f?new Array(A=f-A+1).join(a):"";if(_)w=o(M+w,M.length?f-T.length:Infinity);i+=m;e=w+T;return(s==="<"?i+e+M:s===">"?M+i+e:s==="^"?M.substring(0,A>>=1)+i+e+M.substring(A):i+(_?e:M+e))+n}}}var Ht=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var Vt=t.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,r){return(e=t.round(e,Ft(e,r))).toFixed(Math.max(0,Math.min(20,Ft(e*(1+1e-15),r))))}});function Gt(e){return e+""}var qt=t.time={},Yt=Date;function Wt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Wt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Xt.setUTCDate.apply(this._,arguments)},setDay:function(){Xt.setUTCDay.apply(this._,arguments)},setFullYear:function(){Xt.setUTCFullYear.apply(this._,arguments)},setHours:function(){Xt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Xt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Xt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Xt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Xt.setUTCSeconds.apply(this._,arguments)},setTime:function(){Xt.setTime.apply(this._,arguments)}};var Xt=Date.prototype;function Zt(e,t,r){function n(t){var r=e(t),n=i(r,1);return t-r<n-t?r:n}function a(r){t(r=e(new Yt(r-1)),1);return r}function i(e,r){t(e=new Yt(+e),r);return e}function o(e,n,i){var o=a(e),s=[];if(i>1){while(o<n){if(!(r(o)%i))s.push(new Date(+o));t(o,1)}}else{while(o<n)s.push(new Date(+o)),t(o,1)}return s}function s(e,t,r){try{Yt=Wt;var n=new Wt;n._=e;return o(n,t,r)}finally{Yt=Date}}e.floor=e;e.round=n;e.ceil=a;e.offset=i;e.range=o;var l=e.utc=Kt(e);l.floor=l;l.round=Kt(n);l.ceil=Kt(a);l.offset=Kt(i);l.range=s;return e}function Kt(e){return function(t,r){try{Yt=Wt;var n=new Wt;n._=t;return e(n,r)._}finally{Yt=Date}}}qt.year=Zt(function(e){e=qt.day(e);e.setMonth(0,1);return e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()});qt.years=qt.year.range;qt.years.utc=qt.year.utc.range;qt.day=Zt(function(e){var t=new Yt(2e3,0);t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate());return t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1});qt.days=qt.day.range;qt.days.utc=qt.day.utc.range;qt.dayOfYear=function(e){var t=qt.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var r=qt[e]=Zt(function(e){(e=qt.day(e)).setDate(e.getDate()-(e.getDay()+t)%7);return e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var r=qt.year(e).getDay();return Math.floor((qt.dayOfYear(e)+(r+t)%7)/7)-(r!==t)});qt[e+"s"]=r.range;qt[e+"s"].utc=r.utc.range;qt[e+"OfYear"]=function(e){var r=qt.year(e).getDay();return Math.floor((qt.dayOfYear(e)+(r+t)%7)/7)}});qt.week=qt.sunday;qt.weeks=qt.sunday.range;qt.weeks.utc=qt.sunday.utc.range;qt.weekOfYear=qt.sundayOfYear;function Jt(e){var r=e.dateTime,n=e.date,a=e.time,i=e.periods,o=e.days,s=e.shortDays,l=e.months,u=e.shortMonths;function c(e){var t=e.length;function r(r){var n=[],a=-1,i=0,o,s,l;while(++a<t){if(e.charCodeAt(a)===37){n.push(e.slice(i,a));if((s=Qt[o=e.charAt(++a)])!=null)o=e.charAt(++a);if(l=b[o])o=l(r,s==null?o==="e"?" ":"0":s);n.push(o);i=a+1}}n.push(e.slice(i,a));return n.join("")}r.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},n=f(r,e,t,0);if(n!=t.length)return null;if("p"in r)r.H=r.H%12+r.p*12;var a=r.Z!=null&&Yt!==Wt,i=new(a?Wt:Yt);if("j"in r)i.setFullYear(r.y,0,r.j);else if("W"in r||"U"in r){if(!("w"in r))r.w="W"in r?1:0;i.setFullYear(r.y,0,1);i.setFullYear(r.y,0,"W"in r?(r.w+6)%7+r.W*7-(i.getDay()+5)%7:r.w+r.U*7-(i.getDay()+6)%7)}else i.setFullYear(r.y,r.m,r.d);i.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L);return a?i._:i};r.toString=function(){return e};return r}function f(e,t,r,n){var a,i,o,s=0,l=t.length,u=r.length;while(s<l){if(n>=u)return-1;a=t.charCodeAt(s++);if(a===37){o=t.charAt(s++);i=w[o in Qt?t.charAt(s++):o];if(!i||(n=i(e,r,n))<0)return-1}else if(a!=r.charCodeAt(n++)){return-1}}return n}c.utc=function(e){var t=c(e);function r(e){try{Yt=Wt;var r=new Yt;r._=e;return t(r)}finally{Yt=Date}}r.parse=function(e){try{Yt=Wt;var r=t.parse(e);return r&&r._}finally{Yt=Date}};r.toString=t.toString;return r};c.multi=c.utc.multi=_r;var h=t.map(),p=rr(o),d=nr(o),v=rr(s),m=nr(s),g=rr(l),y=nr(l),x=rr(u),_=nr(u);i.forEach(function(e,t){h.set(e.toLowerCase(),t)});var b={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return l[e.getMonth()]},c:c(r),d:function(e,t){return tr(e.getDate(),t,2)},e:function(e,t){return tr(e.getDate(),t,2)},H:function(e,t){return tr(e.getHours(),t,2)},I:function(e,t){return tr(e.getHours()%12||12,t,2)},j:function(e,t){return tr(1+qt.dayOfYear(e),t,3)},L:function(e,t){return tr(e.getMilliseconds(),t,3)},m:function(e,t){return tr(e.getMonth()+1,t,2)},M:function(e,t){return tr(e.getMinutes(),t,2)},p:function(e){return i[+(e.getHours()>=12)]},S:function(e,t){return tr(e.getSeconds(),t,2)},U:function(e,t){return tr(qt.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return tr(qt.mondayOfYear(e),t,2)},x:c(n),X:c(a),y:function(e,t){return tr(e.getFullYear()%100,t,2)},Y:function(e,t){return tr(e.getFullYear()%1e4,t,4)},Z:yr,"%":function(){return"%"}};var w={a:T,A:k,b:A,B:M,c:E,d:hr,e:hr,H:dr,I:dr,j:pr,L:gr,m:fr,M:vr,p:L,S:mr,U:ir,w:ar,W:or,x:S,X:C,y:lr,Y:sr,Z:ur,"%":xr};function T(e,t,r){v.lastIndex=0;var n=v.exec(t.slice(r));return n?(e.w=m.get(n[0].toLowerCase()),r+n[0].length):-1}function k(e,t,r){p.lastIndex=0;var n=p.exec(t.slice(r));return n?(e.w=d.get(n[0].toLowerCase()),r+n[0].length):-1}function A(e,t,r){x.lastIndex=0;var n=x.exec(t.slice(r));return n?(e.m=_.get(n[0].toLowerCase()),r+n[0].length):-1}function M(e,t,r){g.lastIndex=0;var n=g.exec(t.slice(r));return n?(e.m=y.get(n[0].toLowerCase()),r+n[0].length):-1}function E(e,t,r){return f(e,b.c.toString(),t,r)}function S(e,t,r){return f(e,b.x.toString(),t,r)}function C(e,t,r){return f(e,b.X.toString(),t,r)}function L(e,t,r){var n=h.get(t.slice(r,r+=2).toLowerCase());return n==null?-1:(e.p=n,r)}return c}var Qt={"-":"",_:" ",0:"0"},$t=/^\s*\d+/,er=/^%/;function tr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function rr(e){return new RegExp("^(?:"+e.map(t.requote).join("|")+")","i")}function nr(e){var t=new w,r=-1,n=e.length;while(++r<n)t.set(e[r].toLowerCase(),r);return t}function ar(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function ir(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r));return n?(e.U=+n[0],r+n[0].length):-1}function or(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r));return n?(e.W=+n[0],r+n[0].length):-1}function sr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function lr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.y=cr(+n[0]),r+n[0].length):-1}function ur(e,t,r){return/^[+-]\d{4}$/.test(t=t.slice(r,r+5))?(e.Z=-t,r+5):-1}function cr(e){return e+(e>68?1900:2e3)}function fr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function hr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function pr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+3));return n?(e.j=+n[0],r+n[0].length):-1}function dr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function vr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function mr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function gr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function yr(e){var t=e.getTimezoneOffset(),r=t>0?"-":"+",n=x(t)/60|0,a=x(t)%60;return r+tr(n,"0",2)+tr(a,"0",2)}function xr(e,t,r){er.lastIndex=0;var n=er.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function _r(e){var t=e.length,r=-1;while(++r<t)e[r][0]=this(e[r][0]);return function(t){var r=0,n=e[r];while(!n[1](t))n=e[++r];return n[0](t)}}t.locale=function(e){return{numberFormat:Ut(e),timeFormat:Jt(e)}};var br=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});t.format=br.numberFormat;t.geo={};function wr(){}wr.prototype={s:0,t:0,add:function(e){kr(e,this.t,Tr);kr(Tr.s,this.s,this);if(this.s)this.t+=Tr.t;else this.s=Tr.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Tr=new wr;function kr(e,t,r){var n=r.s=e+t,a=n-e,i=n-a;r.t=e-i+(t-a)}t.geo.stream=function(e,t){if(e&&Mr.hasOwnProperty(e.type)){Mr[e.type](e,t)}else{Ar(e,t)}};function Ar(e,t){if(e&&Er.hasOwnProperty(e.type)){Er[e.type](e,t)}}var Mr={Feature:function(e,t){Ar(e.geometry,t)},FeatureCollection:function(e,t){var r=e.features,n=-1,a=r.length;while(++n<a)Ar(r[n].geometry,t)}};var Er={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var r=e.coordinates,n=-1,a=r.length;while(++n<a)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){Sr(e.coordinates,t,0)},MultiLineString:function(e,t){var r=e.coordinates,n=-1,a=r.length;while(++n<a)Sr(r[n],t,0)},Polygon:function(e,t){Cr(e.coordinates,t)},MultiPolygon:function(e,t){var r=e.coordinates,n=-1,a=r.length;while(++n<a)Cr(r[n],t)},GeometryCollection:function(e,t){var r=e.geometries,n=-1,a=r.length;while(++n<a)Ar(r[n],t)}};function Sr(e,t,r){var n=-1,a=e.length-r,i;t.lineStart();while(++n<a)i=e[n],t.point(i[0],i[1],i[2]);t.lineEnd()}function Cr(e,t){var r=-1,n=e.length;t.polygonStart();while(++r<n)Sr(e[r],t,1);t.polygonEnd()}t.geo.area=function(e){Lr=0;t.geo.stream(e,Or);return Lr};var Lr,Ir=new wr;var Or={sphere:function(){Lr+=4*Ce},point:N,lineStart:N,lineEnd:N,polygonStart:function(){Ir.reset();Or.lineStart=Pr},polygonEnd:function(){var e=2*Ir;Lr+=e<0?4*Ce+e:e;Or.lineStart=Or.lineEnd=Or.point=N}};function Pr(){var e,t,r,n,a;Or.point=function(o,s){Or.point=i;r=(e=o)*Pe,n=Math.cos(s=(t=s)*Pe/2+Ce/4),a=Math.sin(s)};function i(e,t){e*=Pe;t=t*Pe/2+Ce/4;var i=e-r,o=i>=0?1:-1,s=o*i,l=Math.cos(t),u=Math.sin(t),c=a*u,f=n*l+c*Math.cos(s),h=c*o*Math.sin(s);Ir.add(Math.atan2(h,f));r=e,n=l,a=u}Or.lineEnd=function(){i(e,t)}}function Dr(e){var t=e[0],r=e[1],n=Math.cos(r);return[n*Math.cos(t),n*Math.sin(t),Math.sin(r)]}function Rr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function zr(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Nr(e,t){e[0]+=t[0];e[1]+=t[1];e[2]+=t[2]}function Fr(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Br(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t;e[1]/=t;e[2]/=t}function jr(e){return[Math.atan2(e[1],e[0]),Fe(e[2])]}function Ur(e,t){return x(e[0]-t[0])<Ee&&x(e[1]-t[1])<Ee}t.geo.bounds=function(){var e,r,n,a,i,o,s,l,u,c,f;var h={point:p,lineStart:v,lineEnd:m,polygonStart:function(){h.point=g;h.lineStart=y;h.lineEnd=_;u=0;Or.polygonStart()},polygonEnd:function(){Or.polygonEnd();h.point=p;h.lineStart=v;h.lineEnd=m;if(Ir<0)e=-(n=180),r=-(a=90);else if(u>Ee)a=90;else if(u<-Ee)r=-90;f[0]=e,f[1]=n}};function p(t,i){c.push(f=[e=t,n=t]);if(i<r)r=i;if(i>a)a=i}function d(t,o){var s=Dr([t*Pe,o*Pe]);if(l){var u=zr(l,s),c=[u[1],-u[0],0],f=zr(c,u);Br(f);f=jr(f);var h=t-i,d=h>0?1:-1,v=f[0]*De*d,m=x(h)>180;if(m^(d*i<v&&v<d*t)){var g=f[1]*De;if(g>a)a=g}else if(v=(v+360)%360-180,m^(d*i<v&&v<d*t)){var g=-f[1]*De;if(g<r)r=g}else{if(o<r)r=o;if(o>a)a=o}if(m){if(t<i){if(b(e,t)>b(e,n))n=t}else{if(b(t,n)>b(e,n))e=t}}else{if(n>=e){if(t<e)e=t;if(t>n)n=t}else{if(t>i){if(b(e,t)>b(e,n))n=t}else{if(b(t,n)>b(e,n))e=t}}}}else{p(t,o)}l=s,i=t}function v(){h.point=d}function m(){f[0]=e,f[1]=n;h.point=p;l=null}function g(e,t){if(l){var r=e-i;u+=x(r)>180?r+(r>0?360:-360):r}else o=e,s=t;Or.point(e,t);d(e,t)}function y(){Or.lineStart()}function _(){g(o,s);Or.lineEnd();if(x(u)>Ee)e=-(n=180);f[0]=e,f[1]=n;l=null}function b(e,t){return(t-=e)<0?t+360:t}function w(e,t){return e[0]-t[0]}function T(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}return function(i){a=n=-(e=r=Infinity);c=[];t.geo.stream(i,h);var o=c.length;if(o){c.sort(w);for(var s=1,l=c[0],u,p=[l];s<o;++s){u=c[s];if(T(u[0],l)||T(u[1],l)){if(b(l[0],u[1])>b(l[0],l[1]))l[1]=u[1];if(b(u[0],l[1])>b(l[0],l[1]))l[0]=u[0]}else{p.push(l=u)}}var d=-Infinity,v;for(var o=p.length-1,s=0,l=p[o],u;s<=o;l=u,++s){u=p[s];if((v=b(l[1],u[0]))>d)d=v,e=u[0],n=l[1]}}c=f=null;return e===Infinity||r===Infinity?[[NaN,NaN],[NaN,NaN]]:[[e,r],[n,a]]}}();t.geo.centroid=function(e){Hr=Vr=Gr=qr=Yr=Wr=Xr=Zr=Kr=Jr=Qr=0;t.geo.stream(e,$r);var r=Kr,n=Jr,a=Qr,i=r*r+n*n+a*a;if(i<Se){r=Wr,n=Xr,a=Zr;if(Vr<Ee)r=Gr,n=qr,a=Yr;i=r*r+n*n+a*a;if(i<Se)return[NaN,NaN]}return[Math.atan2(n,r)*De,Fe(a/Math.sqrt(i))*De]};var Hr,Vr,Gr,qr,Yr,Wr,Xr,Zr,Kr,Jr,Qr;var $r={sphere:N,point:en,lineStart:rn,lineEnd:nn,polygonStart:function(){$r.lineStart=an},polygonEnd:function(){$r.lineStart=rn}};function en(e,t){e*=Pe;var r=Math.cos(t*=Pe);tn(r*Math.cos(e),r*Math.sin(e),Math.sin(t))}function tn(e,t,r){++Hr;Gr+=(e-Gr)/Hr;qr+=(t-qr)/Hr;Yr+=(r-Yr)/Hr}function rn(){var e,t,r;$r.point=function(a,i){a*=Pe;var o=Math.cos(i*=Pe);e=o*Math.cos(a);t=o*Math.sin(a);r=Math.sin(i);$r.point=n;tn(e,t,r)};function n(n,a){n*=Pe;var i=Math.cos(a*=Pe),o=i*Math.cos(n),s=i*Math.sin(n),l=Math.sin(a),u=Math.atan2(Math.sqrt((u=t*l-r*s)*u+(u=r*o-e*l)*u+(u=e*s-t*o)*u),e*o+t*s+r*l);Vr+=u;Wr+=u*(e+(e=o));Xr+=u*(t+(t=s));Zr+=u*(r+(r=l));tn(e,t,r)}}function nn(){$r.point=en}function an(){var e,t,r,n,a;$r.point=function(o,s){e=o,t=s;$r.point=i;o*=Pe;var l=Math.cos(s*=Pe);r=l*Math.cos(o);n=l*Math.sin(o);a=Math.sin(s);tn(r,n,a)};$r.lineEnd=function(){i(e,t);$r.lineEnd=nn;$r.point=en};function i(e,t){e*=Pe;var i=Math.cos(t*=Pe),o=i*Math.cos(e),s=i*Math.sin(e),l=Math.sin(t),u=n*l-a*s,c=a*o-r*l,f=r*s-n*o,h=Math.sqrt(u*u+c*c+f*f),p=r*o+n*s+a*l,d=h&&-Ne(p)/h,v=Math.atan2(h,p);Kr+=d*u;Jr+=d*c;Qr+=d*f;Vr+=v;Wr+=v*(r+(r=o));Xr+=v*(n+(n=s));Zr+=v*(a+(a=l));tn(r,n,a)}}function on(e,t){function r(r,n){return r=e(r,n),t(r[0],r[1])}if(e.invert&&t.invert)r.invert=function(r,n){return r=t.invert(r,n),r&&e.invert(r[0],r[1])};return r}function sn(){return true}function ln(e,t,r,n,a){var i=[],o=[];e.forEach(function(e){if((t=e.length-1)<=0)return;var t,r=e[0],n=e[t];if(Ur(r,n)){a.lineStart();for(var s=0;s<t;++s)a.point((r=e[s])[0],r[1]);a.lineEnd();return}var l=new cn(r,e,null,true),u=new cn(r,null,l,false);l.o=u;i.push(l);o.push(u);l=new cn(n,e,null,false);u=new cn(n,null,l,true);l.o=u;i.push(l);o.push(u)});o.sort(t);un(i);un(o);if(!i.length)return;for(var s=0,l=r,u=o.length;s<u;++s){o[s].e=l=!l}var c=i[0],f,h;while(1){var p=c,d=true;while(p.v)if((p=p.n)===c)return;f=p.z;a.lineStart();do{p.v=p.o.v=true;if(p.e){if(d){for(var s=0,u=f.length;s<u;++s)a.point((h=f[s])[0],h[1])}else{n(p.x,p.n.x,1,a)}p=p.n}else{if(d){f=p.p.z;for(var s=f.length-1;s>=0;--s)a.point((h=f[s])[0],h[1])}else{n(p.x,p.p.x,-1,a)}p=p.p}p=p.o;f=p.z;d=!d}while(!p.v);a.lineEnd()}}function un(e){if(!(t=e.length))return;var t,r=0,n=e[0],a;while(++r<t){n.n=a=e[r];a.p=n;n=a}n.n=a=e[0];a.p=n}function cn(e,t,r,n){this.x=e;this.z=t;this.o=r;this.e=n;this.v=false;this.n=this.p=null}function fn(e,r,n,a){return function(i,o){var s=r(o),l=i.invert(a[0],a[1]);var u={point:c,lineStart:h,lineEnd:p,polygonStart:function(){u.point=_;u.lineStart=b;u.lineEnd=w;d=[];y=[]},polygonEnd:function(){u.point=c;u.lineStart=h;u.lineEnd=p;d=t.merge(d);var e=xn(l,y);if(d.length){if(!g)o.polygonStart(),g=true;ln(d,dn,e,n,o)}else if(e){if(!g)o.polygonStart(),g=true;o.lineStart();n(null,null,1,o);o.lineEnd()}if(g)o.polygonEnd(),g=false;d=y=null},sphere:function(){o.polygonStart();o.lineStart();n(null,null,1,o);o.lineEnd();o.polygonEnd()}};function c(t,r){var n=i(t,r);if(e(t=n[0],r=n[1]))o.point(t,r)}function f(e,t){var r=i(e,t);s.point(r[0],r[1])}function h(){u.point=f;s.lineStart()}function p(){u.point=c;s.lineEnd()}var d;var v=pn(),m=r(v),g=false,y,x;function _(e,t){x.push([e,t]);var r=i(e,t);m.point(r[0],r[1])}function b(){m.lineStart();x=[]}function w(){_(x[0][0],x[0][1]);m.lineEnd();var e=m.clean(),t=v.buffer(),r,n=t.length;x.pop();y.push(x);x=null;if(!n)return;if(e&1){r=t[0];var n=r.length-1,a=-1,i;if(n>0){if(!g)o.polygonStart(),g=true;o.lineStart();while(++a<n)o.point((i=r[a])[0],i[1]);o.lineEnd()}return}if(n>1&&e&2)t.push(t.pop().concat(t.shift()));d.push(t.filter(hn))}return u}}function hn(e){return e.length>1}function pn(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,r){t.push([e,r])},lineEnd:N,buffer:function(){var r=e;e=[];t=null;return r},rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))}}}function dn(e,t){return((e=e.x)[0]<0?e[1]-Oe-Ee:Oe-e[1])-((t=t.x)[0]<0?t[1]-Oe-Ee:Oe-t[1])}var vn=fn(sn,mn,yn,[-Ce,-Ce/2]);function mn(e){var t=NaN,r=NaN,n=NaN,a;return{lineStart:function(){e.lineStart();a=1},point:function(i,o){var s=i>0?Ce:-Ce,l=x(i-t);if(x(l-Ce)<Ee){e.point(t,r=(r+o)/2>0?Oe:-Oe);e.point(n,r);e.lineEnd();e.lineStart();e.point(s,r);e.point(i,r);a=0}else if(n!==s&&l>=Ce){if(x(t-n)<Ee)t-=n*Ee;if(x(i-s)<Ee)i-=s*Ee;r=gn(t,r,i,o);e.point(n,r);e.lineEnd();e.lineStart();e.point(s,r);a=0}e.point(t=i,r=o);n=s},lineEnd:function(){e.lineEnd();t=r=NaN},clean:function(){return 2-a}}}function gn(e,t,r,n){var a,i,o=Math.sin(e-r);return x(o)>Ee?Math.atan((Math.sin(t)*(i=Math.cos(n))*Math.sin(r)-Math.sin(n)*(a=Math.cos(t))*Math.sin(e))/(a*i*o)):(t+n)/2}function yn(e,t,r,n){var a;if(e==null){a=r*Oe;n.point(-Ce,a);n.point(0,a);n.point(Ce,a);n.point(Ce,0);n.point(Ce,-a);n.point(0,-a);n.point(-Ce,-a);n.point(-Ce,0);n.point(-Ce,a)}else if(x(e[0]-t[0])>Ee){var i=e[0]<t[0]?Ce:-Ce;a=r*i/2;n.point(-i,a);n.point(0,a);n.point(i,a)}else{n.point(t[0],t[1])}}function xn(e,t){var r=e[0],n=e[1],a=[Math.sin(r),-Math.cos(r),0],i=0,o=0;Ir.reset();for(var s=0,l=t.length;s<l;++s){var u=t[s],c=u.length;if(!c)continue;var f=u[0],h=f[0],p=f[1]/2+Ce/4,d=Math.sin(p),v=Math.cos(p),m=1;while(true){if(m===c)m=0;e=u[m];var g=e[0],y=e[1]/2+Ce/4,x=Math.sin(y),_=Math.cos(y),b=g-h,w=b>=0?1:-1,T=w*b,k=T>Ce,A=d*x;Ir.add(Math.atan2(A*w*Math.sin(T),v*_+A*Math.cos(T)));i+=k?b+w*Le:b;if(k^h>=r^g>=r){var M=zr(Dr(f),Dr(e));Br(M);var E=zr(a,M);Br(E);var S=(k^b>=0?-1:1)*Fe(E[2]);if(n>S||n===S&&(M[0]||M[1])){o+=k^b>=0?1:-1}}if(!m++)break;h=g,d=x,v=_,f=e}}return(i<-Ee||i<Ee&&Ir<-Ee)^o&1}function _n(e){var t=Math.cos(e),r=t>0,n=x(t)>Ee,a=na(e,6*Pe);return fn(i,o,a,r?[0,-e]:[-Ce,e-Ce]);function i(e,r){return Math.cos(e)*Math.cos(r)>t}function o(e){var t,a,o,u,c;return{lineStart:function(){u=o=false;c=1},point:function(f,h){var p=[f,h],d,v=i(f,h),m=r?v?0:l(f,h):v?l(f+(f<0?Ce:-Ce),h):0;if(!t&&(u=o=v))e.lineStart();if(v!==o){d=s(t,p);if(Ur(t,d)||Ur(p,d)){p[0]+=Ee;p[1]+=Ee;v=i(p[0],p[1])}}if(v!==o){c=0;if(v){e.lineStart();d=s(p,t);e.point(d[0],d[1])}else{d=s(t,p);e.point(d[0],d[1]);e.lineEnd()}t=d}else if(n&&t&&r^v){var g;if(!(m&a)&&(g=s(p,t,true))){c=0;if(r){e.lineStart();e.point(g[0][0],g[0][1]);e.point(g[1][0],g[1][1]);e.lineEnd()}else{e.point(g[1][0],g[1][1]);e.lineEnd();e.lineStart();e.point(g[0][0],g[0][1])}}}if(v&&(!t||!Ur(t,p))){e.point(p[0],p[1])}t=p,o=v,a=m},lineEnd:function(){if(o)e.lineEnd();t=null},clean:function(){return c|(u&&o)<<1}}}function s(e,r,n){var a=Dr(e),i=Dr(r);var o=[1,0,0],s=zr(a,i),l=Rr(s,s),u=s[0],c=l-u*u;if(!c)return!n&&e;var f=t*l/c,h=-t*u/c,p=zr(o,s),d=Fr(o,f),v=Fr(s,h);Nr(d,v);var m=p,g=Rr(d,m),y=Rr(m,m),_=g*g-y*(Rr(d,d)-1);if(_<0)return;var b=Math.sqrt(_),w=Fr(m,(-g-b)/y);Nr(w,d);w=jr(w);if(!n)return w;var T=e[0],k=r[0],A=e[1],M=r[1],E;if(k<T)E=T,T=k,k=E;var S=k-T,C=x(S-Ce)<Ee,L=C||S<Ee;if(!C&&M<A)E=A,A=M,M=E;if(L?C?A+M>0^w[1]<(x(w[0]-T)<Ee?A:M):A<=w[1]&&w[1]<=M:S>Ce^(T<=w[0]&&w[0]<=k)){var I=Fr(m,(-g+b)/y);Nr(I,d);return[w,jr(I)]}}function l(t,n){var a=r?e:Ce-e,i=0;if(t<-a)i|=1;else if(t>a)i|=2;if(n<-a)i|=4;else if(n>a)i|=8;return i}}function bn(e,t,r,n){return function(a){var i=a.a,o=a.b,s=i.x,l=i.y,u=o.x,c=o.y,f=0,h=1,p=u-s,d=c-l,v;v=e-s;if(!p&&v>0)return;v/=p;if(p<0){if(v<f)return;if(v<h)h=v}else if(p>0){if(v>h)return;if(v>f)f=v}v=r-s;if(!p&&v<0)return;v/=p;if(p<0){if(v>h)return;if(v>f)f=v}else if(p>0){if(v<f)return;if(v<h)h=v}v=t-l;if(!d&&v>0)return;v/=d;if(d<0){if(v<f)return;if(v<h)h=v}else if(d>0){if(v>h)return;if(v>f)f=v}v=n-l;if(!d&&v<0)return;v/=d;if(d<0){if(v>h)return;if(v>f)f=v}else if(d>0){if(v<f)return;if(v<h)h=v}if(f>0)a.a={x:s+f*p,y:l+f*d};if(h<1)a.b={x:s+h*p,y:l+h*d};return a}}var wn=1e9;t.geo.clipExtent=function(){var e,t,r,n,a,i,o={stream:function(e){if(a)a.valid=false;a=i(e);a.valid=true;return a},extent:function(s){if(!arguments.length)return[[e,t],[r,n]];i=Tn(e=+s[0][0],t=+s[0][1],r=+s[1][0],n=+s[1][1]);if(a)a.valid=false,a=null;return o}};return o.extent([[0,0],[960,500]])};function Tn(e,r,n,a){return function(l){var u=l,c=pn(),f=bn(e,r,n,a),h,p,d;var v={point:x,lineStart:S,lineEnd:C,polygonStart:function(){l=c;h=[];p=[];E=true},polygonEnd:function(){l=u;h=t.merge(h);var r=m([e,a]),n=E&&r,i=h.length;if(n||i){l.polygonStart();if(n){l.lineStart();g(null,null,1,l);l.lineEnd()}if(i){ln(h,o,r,g,l)}l.polygonEnd()}h=p=d=null}};function m(e){var t=0,r=p.length,n=e[1];for(var a=0;a<r;++a){for(var i=1,o=p[a],s=o.length,l=o[0],u;i<s;++i){u=o[i];if(l[1]<=n){if(u[1]>n&&ze(l,u,e)>0)++t}else{if(u[1]<=n&&ze(l,u,e)<0)--t}l=u}}return t!==0}function g(t,o,l,u){var c=0,f=0;if(t==null||(c=i(t,l))!==(f=i(o,l))||s(t,o)<0^l>0){do{u.point(c===0||c===3?e:n,c>1?a:r)}while((c=(c+l+4)%4)!==f)}else{u.point(o[0],o[1])}}function y(t,i){return e<=t&&t<=n&&r<=i&&i<=a}function x(e,t){if(y(e,t))l.point(e,t)}var _,b,w,T,k,A,M,E;function S(){v.point=L;if(p)p.push(d=[]);M=true;A=false;T=k=NaN}function C(){if(h){L(_,b);if(w&&A)c.rejoin();h.push(c.buffer())}v.point=x;if(A)l.lineEnd()}function L(e,t){e=Math.max(-wn,Math.min(wn,e));t=Math.max(-wn,Math.min(wn,t));var r=y(e,t);if(p)d.push([e,t]);if(M){_=e,b=t,w=r;M=false;if(r){l.lineStart();l.point(e,t)}}else{if(r&&A)l.point(e,t);else{var n={a:{x:T,y:k},b:{x:e,y:t}};if(f(n)){if(!A){l.lineStart();l.point(n.a.x,n.a.y)}l.point(n.b.x,n.b.y);if(!r)l.lineEnd();E=false}else if(r){l.lineStart();l.point(e,t);E=false}}}T=e,k=t,A=r}return v};function i(t,a){return x(t[0]-e)<Ee?a>0?0:3:x(t[0]-n)<Ee?a>0?2:1:x(t[1]-r)<Ee?a>0?1:0:a>0?3:2}function o(e,t){return s(e.x,t.x)}function s(e,t){var r=i(e,1),n=i(t,1);return r!==n?r-n:r===0?t[1]-e[1]:r===1?e[0]-t[0]:r===2?e[1]-t[1]:t[0]-e[0]}}function kn(e){var t=0,r=Ce/3,n=Zn(e),a=n(t,r);a.parallels=function(e){if(!arguments.length)return[t/Ce*180,r/Ce*180];return n(t=e[0]*Ce/180,r=e[1]*Ce/180)};return a}function An(e,t){var r=Math.sin(e),n=(r+Math.sin(t))/2,a=1+r*(2*n-r),i=Math.sqrt(a)/n;function o(e,t){var r=Math.sqrt(a-2*n*Math.sin(t))/n;return[r*Math.sin(e*=n),i-r*Math.cos(e)]}o.invert=function(e,t){var r=i-t;return[Math.atan2(e,r)/n,Fe((a-(e*e+r*r)*n*n)/(2*n))]};return o}(t.geo.conicEqualArea=function(){return kn(An)}).raw=An;t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};t.geo.albersUsa=function(){var e=t.geo.albers();var r=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var n=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);var a,i={point:function(e,t){a=[e,t]}},o,s,l;function u(e){var t=e[0],r=e[1];a=null;(o(t,r),a)||(s(t,r),a)||l(t,r);return a}u.invert=function(t){var a=e.scale(),i=e.translate(),o=(t[0]-i[0])/a,s=(t[1]-i[1])/a;return(s>=.12&&s<.234&&o>=-.425&&o<-.214?r:s>=.166&&s<.234&&o>=-.214&&o<-.115?n:e).invert(t)};u.stream=function(t){var a=e.stream(t),i=r.stream(t),o=n.stream(t);return{point:function(e,t){a.point(e,t);i.point(e,t);o.point(e,t)},sphere:function(){a.sphere();i.sphere();o.sphere()},lineStart:function(){a.lineStart();i.lineStart();o.lineStart()},lineEnd:function(){a.lineEnd();i.lineEnd();o.lineEnd()},polygonStart:function(){a.polygonStart();i.polygonStart();o.polygonStart()},polygonEnd:function(){a.polygonEnd();i.polygonEnd();o.polygonEnd()}}};u.precision=function(t){if(!arguments.length)return e.precision();e.precision(t);r.precision(t);n.precision(t);return u};u.scale=function(t){if(!arguments.length)return e.scale();e.scale(t);r.scale(t*.35);n.scale(t);return u.translate(e.translate())};u.translate=function(t){if(!arguments.length)return e.translate();var a=e.scale(),c=+t[0],f=+t[1];o=e.translate(t).clipExtent([[c-.455*a,f-.238*a],[c+.455*a,f+.238*a]]).stream(i).point;s=r.translate([c-.307*a,f+.201*a]).clipExtent([[c-.425*a+Ee,f+.12*a+Ee],[c-.214*a-Ee,f+.234*a-Ee]]).stream(i).point;l=n.translate([c-.205*a,f+.212*a]).clipExtent([[c-.214*a+Ee,f+.166*a+Ee],[c-.115*a-Ee,f+.234*a-Ee]]).stream(i).point;return u};return u.scale(1070)};var Mn,En,Sn={point:N,lineStart:N,lineEnd:N,polygonStart:function(){En=0;Sn.lineStart=Cn},polygonEnd:function(){Sn.lineStart=Sn.lineEnd=Sn.point=N;Mn+=x(En/2)}};function Cn(){var e,t,r,n;Sn.point=function(i,o){Sn.point=a;e=r=i,t=n=o};function a(e,t){En+=n*e-r*t;r=e,n=t}Sn.lineEnd=function(){a(e,t)}}var Ln,In,On,Pn;var Dn={point:Rn,lineStart:N,lineEnd:N,polygonStart:N,polygonEnd:N};function Rn(e,t){if(e<Ln)Ln=e;if(e>On)On=e;if(t<In)In=t;if(t>Pn)Pn=t}function zn(){var e=Nn(4.5),t=[];var r={point:n,lineStart:function(){r.point=a},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(t){e=Nn(t);return r},result:function(){if(t.length){var e=t.join("");t=[];return e}}};function n(r,n){t.push("M",r,",",n,e)}function a(e,n){t.push("M",e,",",n);r.point=i}function i(e,r){t.push("L",e,",",r)}function o(){r.point=n}function s(){t.push("Z")}return r}function Nn(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var Fn={point:Bn,lineStart:jn,lineEnd:Un,polygonStart:function(){Fn.lineStart=Hn},polygonEnd:function(){Fn.point=Bn;Fn.lineStart=jn;Fn.lineEnd=Un}};function Bn(e,t){Gr+=e;qr+=t;++Yr}function jn(){var e,t;Fn.point=function(n,a){Fn.point=r;Bn(e=n,t=a)};function r(r,n){var a=r-e,i=n-t,o=Math.sqrt(a*a+i*i);Wr+=o*(e+r)/2;Xr+=o*(t+n)/2;Zr+=o;Bn(e=r,t=n)}}function Un(){Fn.point=Bn}function Hn(){var e,t,r,n;Fn.point=function(i,o){Fn.point=a;Bn(e=r=i,t=n=o)};function a(e,t){var a=e-r,i=t-n,o=Math.sqrt(a*a+i*i);Wr+=o*(r+e)/2;Xr+=o*(n+t)/2;Zr+=o;o=n*e-r*t;Kr+=o*(r+e);Jr+=o*(n+t);Qr+=o*3;Bn(r=e,n=t)}Fn.lineEnd=function(){a(e,t)}}function Vn(e){var t=4.5;var r={point:n,lineStart:function(){r.point=a},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(e){t=e;return r},result:N};function n(r,n){e.moveTo(r+t,n);e.arc(r,n,t,0,Le)}function a(t,n){e.moveTo(t,n);r.point=i}function i(t,r){e.lineTo(t,r)}function o(){r.point=n}function s(){e.closePath()}return r}function Gn(e){var t=.5,r=Math.cos(30*Pe),n=16;function a(e){return(n?o:i)(e)}function i(t){return Wn(t,function(r,n){r=e(r,n);t.point(r[0],r[1])})}function o(t){var r,a,i,o,l,u,c,f,h,p,d,v,m;var g={point:y,lineStart:x,lineEnd:b,polygonStart:function(){t.polygonStart();g.lineStart=w},polygonEnd:function(){t.polygonEnd();g.lineStart=x}};function y(r,n){r=e(r,n);t.point(r[0],r[1])}function x(){h=NaN;g.point=_;t.lineStart()}function _(r,a){var i=Dr([r,a]),o=e(r,a);s(h,p,f,d,v,m,h=o[0],p=o[1],f=r,d=i[0],v=i[1],m=i[2],n,t);t.point(h,p)}function b(){g.point=y;t.lineEnd()}function w(){x();g.point=T;g.lineEnd=k}function T(e,t){_(r=e,a=t),i=h,o=p,l=d,u=v,c=m;g.point=_}function k(){s(h,p,f,d,v,m,i,o,r,l,u,c,n,t);g.lineEnd=b;b()}return g}function s(n,a,i,o,l,u,c,f,h,p,d,v,m,g){var y=c-n,_=f-a,b=y*y+_*_;if(b>4*t&&m--){var w=o+p,T=l+d,k=u+v,A=Math.sqrt(w*w+T*T+k*k),M=Math.asin(k/=A),E=x(x(k)-1)<Ee||x(i-h)<Ee?(i+h)/2:Math.atan2(T,w),S=e(E,M),C=S[0],L=S[1],I=C-n,O=L-a,P=_*I-y*O;if(P*P/b>t||x((y*I+_*O)/b-.5)>.3||o*p+l*d+u*v<r){s(n,a,i,o,l,u,C,L,E,w/=A,T/=A,k,m,g);g.point(C,L);s(C,L,E,w,T,k,c,f,h,p,d,v,m,g)}}}a.precision=function(e){if(!arguments.length)return Math.sqrt(t);n=(t=e*e)>0&&16;return a};return a}t.geo.path=function(){var e=4.5,r,n,a,i,o;function s(r){if(r){if(typeof e==="function")i.pointRadius(+e.apply(this,arguments));if(!o||!o.valid)o=a(i);t.geo.stream(r,o)}return i.result()}s.area=function(e){Mn=0;t.geo.stream(e,a(Sn));return Mn};s.centroid=function(e){Gr=qr=Yr=Wr=Xr=Zr=Kr=Jr=Qr=0;t.geo.stream(e,a(Fn));return Qr?[Kr/Qr,Jr/Qr]:Zr?[Wr/Zr,Xr/Zr]:Yr?[Gr/Yr,qr/Yr]:[NaN,NaN]};s.bounds=function(e){On=Pn=-(Ln=In=Infinity);t.geo.stream(e,a(Dn));return[[Ln,In],[On,Pn]]};s.projection=function(e){if(!arguments.length)return r;a=(r=e)?e.stream||qn(e):P;return l()};s.context=function(t){if(!arguments.length)return n;i=(n=t)==null?new zn:new Vn(t);if(typeof e!=="function")i.pointRadius(e);return l()};s.pointRadius=function(t){if(!arguments.length)return e;e=typeof t==="function"?t:(i.pointRadius(+t),+t);return s};function l(){o=null;return s}return s.projection(t.geo.albersUsa()).context(null)};function qn(e){var t=Gn(function(t,r){return e([t*De,r*De])});return function(e){return Kn(t(e))}}t.geo.transform=function(e){return{stream:function(t){var r=new Yn(t);for(var n in e)r[n]=e[n];return r}}};function Yn(e){this.stream=e}Yn.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Wn(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}t.geo.projection=Xn;t.geo.projectionMutator=Zn;function Xn(e){return Zn(function(){return e})()}function Zn(e){var r,n,a,i=Gn(function(e,t){e=r(e,t);return[e[0]*o+d,v-e[1]*o]}),o=150,s=480,l=250,u=0,c=0,f=0,h=0,p=0,d,v,m=vn,g=P,y=null,x=null,_;function b(e){e=a(e[0]*Pe,e[1]*Pe);return[e[0]*o+d,v-e[1]*o]}function w(e){e=a.invert((e[0]-d)/o,(v-e[1])/o);return e&&[e[0]*De,e[1]*De]}b.stream=function(e){if(_)_.valid=false;_=Kn(m(n,i(g(e))));_.valid=true;return _};b.clipAngle=function(e){if(!arguments.length)return y;m=e==null?(y=e,vn):_n((y=+e)*Pe);return k()};b.clipExtent=function(e){if(!arguments.length)return x;x=e;g=e?Tn(e[0][0],e[0][1],e[1][0],e[1][1]):P;return k()};b.scale=function(e){if(!arguments.length)return o;o=+e;return T()};b.translate=function(e){if(!arguments.length)return[s,l];s=+e[0];l=+e[1];return T()};b.center=function(e){if(!arguments.length)return[u*De,c*De];u=e[0]%360*Pe;c=e[1]%360*Pe;return T()};b.rotate=function(e){if(!arguments.length)return[f*De,h*De,p*De];f=e[0]%360*Pe;h=e[1]%360*Pe;p=e.length>2?e[2]%360*Pe:0;return T()};t.rebind(b,i,"precision");function T(){a=on(n=$n(f,h,p),r);var e=r(u,c);d=s-e[0]*o;v=l+e[1]*o;return k()}function k(){if(_)_.valid=false,_=null;return b}return function(){r=e.apply(this,arguments);b.invert=r.invert&&w;return T()}}function Kn(e){return Wn(e,function(t,r){e.point(t*Pe,r*Pe)})}function Jn(e,t){return[e,t]}(t.geo.equirectangular=function(){return Xn(Jn)}).raw=Jn.invert=Jn;t.geo.rotation=function(e){e=$n(e[0]%360*Pe,e[1]*Pe,e.length>2?e[2]*Pe:0);function t(t){t=e(t[0]*Pe,t[1]*Pe);return t[0]*=De,t[1]*=De,t}t.invert=function(t){t=e.invert(t[0]*Pe,t[1]*Pe);return t[0]*=De,t[1]*=De,t};return t};function Qn(e,t){return[e>Ce?e-Le:e<-Ce?e+Le:e,t]}Qn.invert=Jn;function $n(e,t,r){return e?t||r?on(ta(e),ra(t,r)):ta(e):t||r?ra(t,r):Qn}function ea(e){return function(t,r){return t+=e,[t>Ce?t-Le:t<-Ce?t+Le:t,r]}}function ta(e){var t=ea(e);t.invert=ea(-e);return t}function ra(e,t){var r=Math.cos(e),n=Math.sin(e),a=Math.cos(t),i=Math.sin(t);function o(e,t){var o=Math.cos(t),s=Math.cos(e)*o,l=Math.sin(e)*o,u=Math.sin(t),c=u*r+s*n;return[Math.atan2(l*a-c*i,s*r-u*n),Fe(c*a+l*i)]}o.invert=function(e,t){var o=Math.cos(t),s=Math.cos(e)*o,l=Math.sin(e)*o,u=Math.sin(t),c=u*a-l*i;return[Math.atan2(l*a+u*i,s*r+c*n),Fe(c*r-s*n)]};return o}t.geo.circle=function(){var e=[0,0],t,r=6,n;function a(){var t=typeof e==="function"?e.apply(this,arguments):e,r=$n(-t[0]*Pe,-t[1]*Pe,0).invert,a=[];n(null,null,1,{point:function(e,t){a.push(e=r(e,t));e[0]*=De,e[1]*=De}});return{type:"Polygon",coordinates:[a]}}a.origin=function(t){if(!arguments.length)return e;e=t;return a};a.angle=function(e){if(!arguments.length)return t;n=na((t=+e)*Pe,r*Pe);return a};a.precision=function(e){if(!arguments.length)return r;n=na(t*Pe,(r=+e)*Pe);return a};return a.angle(90)};function na(e,t){var r=Math.cos(e),n=Math.sin(e);return function(a,i,o,s){var l=o*t;if(a!=null){a=aa(r,a);i=aa(r,i);if(o>0?a<i:a>i)a+=o*Le}else{a=e+o*Le;i=e-.5*l}for(var u,c=a;o>0?c>i:c<i;c-=l){s.point((u=jr([r,-n*Math.cos(c),-n*Math.sin(c)]))[0],u[1])}}}function aa(e,t){var r=Dr(t);r[0]-=e;Br(r);var n=Ne(-r[1]);return((-r[2]<0?-n:n)+2*Math.PI-Ee)%(2*Math.PI)}t.geo.distance=function(e,t){var r=(t[0]-e[0])*Pe,n=e[1]*Pe,a=t[1]*Pe,i=Math.sin(r),o=Math.cos(r),s=Math.sin(n),l=Math.cos(n),u=Math.sin(a),c=Math.cos(a),f;return Math.atan2(Math.sqrt((f=c*i)*f+(f=l*u-s*c*o)*f),s*u+l*c*o)};t.geo.graticule=function(){var e,r,n,a,i,o,s,l,u=10,c=u,f=90,h=360,p,d,v,m,g=2.5;function y(){return{type:"MultiLineString",coordinates:_()}}function _(){return t.range(Math.ceil(a/f)*f,n,f).map(v).concat(t.range(Math.ceil(l/h)*h,s,h).map(m)).concat(t.range(Math.ceil(r/u)*u,e,u).filter(function(e){return x(e%f)>Ee}).map(p)).concat(t.range(Math.ceil(o/c)*c,i,c).filter(function(e){return x(e%h)>Ee}).map(d))}y.lines=function(){return _().map(function(e){return{type:"LineString",coordinates:e}})};y.outline=function(){return{type:"Polygon",coordinates:[v(a).concat(m(s).slice(1),v(n).reverse().slice(1),m(l).reverse().slice(1))]}};y.extent=function(e){if(!arguments.length)return y.minorExtent();return y.majorExtent(e).minorExtent(e)};y.majorExtent=function(e){if(!arguments.length)return[[a,l],[n,s]];a=+e[0][0],n=+e[1][0];l=+e[0][1],s=+e[1][1];if(a>n)e=a,a=n,n=e;if(l>s)e=l,l=s,s=e;return y.precision(g)};y.minorExtent=function(t){if(!arguments.length)return[[r,o],[e,i]];r=+t[0][0],e=+t[1][0];o=+t[0][1],i=+t[1][1];if(r>e)t=r,r=e,e=t;if(o>i)t=o,o=i,i=t;return y.precision(g)};y.step=function(e){if(!arguments.length)return y.minorStep();return y.majorStep(e).minorStep(e)};y.majorStep=function(e){if(!arguments.length)return[f,h];f=+e[0],h=+e[1];return y};y.minorStep=function(e){if(!arguments.length)return[u,c];u=+e[0],c=+e[1];return y};y.precision=function(t){if(!arguments.length)return g;g=+t;p=ia(o,i,90);d=oa(r,e,g);v=ia(l,s,90);m=oa(a,n,g);return y};return y.majorExtent([[-180,-90+Ee],[180,90-Ee]]).minorExtent([[-180,-80-Ee],[180,80+Ee]])};function ia(e,r,n){var a=t.range(e,r-Ee,n).concat(r);return function(e){return a.map(function(t){return[e,t]})}}function oa(e,r,n){var a=t.range(e,r-Ee,n).concat(r);return function(e){return a.map(function(t){return[t,e]})}}function sa(e){return e.source}function la(e){return e.target}t.geo.greatArc=function(){var e=sa,r,n=la,a;function i(){return{type:"LineString",coordinates:[r||e.apply(this,arguments),a||n.apply(this,arguments)]}}i.distance=function(){return t.geo.distance(r||e.apply(this,arguments),a||n.apply(this,arguments))};i.source=function(t){if(!arguments.length)return e;e=t,r=typeof t==="function"?null:t;return i};i.target=function(e){if(!arguments.length)return n;n=e,a=typeof e==="function"?null:e;return i};i.precision=function(){return arguments.length?i:0};return i};t.geo.interpolate=function(e,t){return ua(e[0]*Pe,e[1]*Pe,t[0]*Pe,t[1]*Pe)};function ua(e,t,r,n){var a=Math.cos(t),i=Math.sin(t),o=Math.cos(n),s=Math.sin(n),l=a*Math.cos(e),u=a*Math.sin(e),c=o*Math.cos(r),f=o*Math.sin(r),h=2*Math.asin(Math.sqrt(He(n-t)+a*o*He(r-e))),p=1/Math.sin(h);var d=h?function(e){var t=Math.sin(e*=h)*p,r=Math.sin(h-e)*p,n=r*l+t*c,a=r*u+t*f,o=r*i+t*s;return[Math.atan2(a,n)*De,Math.atan2(o,Math.sqrt(n*n+a*a))*De]}:function(){return[e*De,t*De]};d.distance=h;return d}t.geo.length=function(e){ca=0;t.geo.stream(e,fa);return ca};var ca;var fa={sphere:N,point:N,lineStart:ha,lineEnd:N,polygonStart:N,polygonEnd:N};function ha(){var e,t,r;fa.point=function(a,i){e=a*Pe,t=Math.sin(i*=Pe),r=Math.cos(i);fa.point=n};fa.lineEnd=function(){fa.point=fa.lineEnd=N};function n(n,a){var i=Math.sin(a*=Pe),o=Math.cos(a),s=x((n*=Pe)-e),l=Math.cos(s);ca+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=r*i-t*o*l)*s),t*i+r*o*l);e=n,t=i,r=o}}function pa(e,t){function r(t,r){var n=Math.cos(t),a=Math.cos(r),i=e(n*a);return[i*a*Math.sin(t),i*Math.sin(r)]}r.invert=function(e,r){var n=Math.sqrt(e*e+r*r),a=t(n),i=Math.sin(a),o=Math.cos(a);return[Math.atan2(e*i,n*o),Math.asin(n&&r*i/n)]};return r}var da=pa(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(t.geo.azimuthalEqualArea=function(){return Xn(da)}).raw=da;var va=pa(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},P);(t.geo.azimuthalEquidistant=function(){return Xn(va)}).raw=va;function ma(e,t){var r=Math.cos(e),n=function(e){return Math.tan(Ce/4+e/2)},a=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(n(t)/n(e)),i=r*Math.pow(n(e),a)/a;if(!a)return xa;function o(e,t){if(i>0){if(t<-Oe+Ee)t=-Oe+Ee}else{if(t>Oe-Ee)t=Oe-Ee}var r=i/Math.pow(n(t),a);return[r*Math.sin(a*e),i-r*Math.cos(a*e)]}o.invert=function(e,t){var r=i-t,n=Re(a)*Math.sqrt(e*e+r*r);return[Math.atan2(e,r)/a,2*Math.atan(Math.pow(i/n,1/a))-Oe]};return o}(t.geo.conicConformal=function(){return kn(ma)}).raw=ma;function ga(e,t){var r=Math.cos(e),n=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),a=r/n+e;if(x(n)<Ee)return Jn;function i(e,t){var r=a-t;return[r*Math.sin(n*e),a-r*Math.cos(n*e)]}i.invert=function(e,t){var r=a-t;return[Math.atan2(e,r)/n,a-Re(n)*Math.sqrt(e*e+r*r)]};return i}(t.geo.conicEquidistant=function(){return kn(ga)}).raw=ga;var ya=pa(function(e){return 1/e},Math.atan);(t.geo.gnomonic=function(){return Xn(ya)}).raw=ya;function xa(e,t){return[e,Math.log(Math.tan(Ce/4+t/2))]}xa.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Oe]};function _a(e){var t=Xn(e),r=t.scale,n=t.translate,a=t.clipExtent,i;t.scale=function(){var e=r.apply(t,arguments);return e===t?i?t.clipExtent(null):t:e};t.translate=function(){var e=n.apply(t,arguments);return e===t?i?t.clipExtent(null):t:e};t.clipExtent=function(e){var o=a.apply(t,arguments);if(o===t){if(i=e==null){var s=Ce*r(),l=n();a([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else if(i){o=null}return o};return t.clipExtent(null)}(t.geo.mercator=function(){return _a(xa)}).raw=xa;var ba=pa(function(){return 1},Math.asin);(t.geo.orthographic=function(){return Xn(ba)}).raw=ba;var wa=pa(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(t.geo.stereographic=function(){return Xn(wa)}).raw=wa;function Ta(e,t){return[Math.log(Math.tan(Ce/4+t/2)),-e]}Ta.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Oe]};(t.geo.transverseMercator=function(){var e=_a(Ta),t=e.center,r=e.rotate;e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return e?r([e[0],e[1],e.length>2?e[2]+90:90]):(e=r(),[e[0],e[1],e[2]-90])};return r([0,0,90])}).raw=Ta;t.geom={};function ka(e){return e[0]}function Aa(e){return e[1]}t.geom.hull=function(e){var t=ka,r=Aa;if(arguments.length)return n(e);function n(e){if(e.length<3)return[];var n=kt(t),a=kt(r),i,o=e.length,s=[],l=[];for(i=0;i<o;i++){s.push([+n.call(this,e[i],i),+a.call(this,e[i],i),i])}s.sort(Ea);for(i=0;i<o;i++)l.push([s[i][0],-s[i][1]]);var u=Ma(s),c=Ma(l);var f=c[0]===u[0],h=c[c.length-1]===u[u.length-1],p=[];for(i=u.length-1;i>=0;--i)p.push(e[s[u[i]][2]]);for(i=+f;i<c.length-h;++i)p.push(e[s[c[i]][2]]);return p}n.x=function(e){return arguments.length?(t=e,n):t};n.y=function(e){return arguments.length?(r=e,n):r};return n};function Ma(e){var t=e.length,r=[0,1],n=2;for(var a=2;a<t;a++){while(n>1&&ze(e[r[n-2]],e[r[n-1]],e[a])<=0)--n;r[n++]=a}return r.slice(0,n)}function Ea(e,t){return e[0]-t[0]||e[1]-t[1]}t.geom.polygon=function(e){G(e,Sa);return e};var Sa=t.geom.polygon.prototype=[];Sa.area=function(){var e=-1,t=this.length,r,n=this[t-1],a=0;while(++e<t){r=n;n=this[e];a+=r[1]*n[0]-r[0]*n[1]}return a*.5};Sa.centroid=function(e){var t=-1,r=this.length,n=0,a=0,i,o=this[r-1],s;if(!arguments.length)e=-1/(6*this.area());while(++t<r){i=o;o=this[t];s=i[0]*o[1]-o[0]*i[1];n+=(i[0]+o[0])*s;a+=(i[1]+o[1])*s}return[n*e,a*e]};Sa.clip=function(e){var t,r=Ia(e),n=-1,a=this.length-Ia(this),i,o,s=this[a-1],l,u,c;while(++n<a){t=e.slice();e.length=0;l=this[n];u=t[(o=t.length-r)-1];i=-1;while(++i<o){c=t[i];if(Ca(c,s,l)){if(!Ca(u,s,l)){e.push(La(u,c,s,l))}e.push(c)}else if(Ca(u,s,l)){e.push(La(u,c,s,l))}u=c}if(r)e.push(e[0]);s=l}return e};function Ca(e,t,r){return(r[0]-t[0])*(e[1]-t[1])<(r[1]-t[1])*(e[0]-t[0])}function La(e,t,r,n){var a=e[0],i=r[0],o=t[0]-a,s=n[0]-i,l=e[1],u=r[1],c=t[1]-l,f=n[1]-u,h=(s*(l-u)-f*(a-i))/(f*o-s*c);return[a+h*o,l+h*c]}function Ia(e){var t=e[0],r=e[e.length-1];return!(t[0]-r[0]||t[1]-r[1])}var Oa,Pa,Da,Ra=[],za,Na,Fa=[];function Ba(){oi(this);this.edge=this.site=this.circle=null}function ja(e){var t=Ra.pop()||new Ba;t.site=e;return t}function Ua(e){Ja(e);Da.remove(e);Ra.push(e);oi(e)}function Ha(e){var t=e.circle,r=t.x,n=t.cy,a={x:r,y:n},i=e.P,o=e.N,s=[e];Ua(e);var l=i;while(l.circle&&x(r-l.circle.x)<Ee&&x(n-l.circle.cy)<Ee){i=l.P;s.unshift(l);Ua(l);l=i}s.unshift(l);Ja(l);var u=o;while(u.circle&&x(r-u.circle.x)<Ee&&x(n-u.circle.cy)<Ee){o=u.N;s.push(u);Ua(u);u=o}s.push(u);Ja(u);var c=s.length,f;for(f=1;f<c;++f){u=s[f];l=s[f-1];ni(u.edge,l.site,u.site,a)}l=s[0];u=s[c-1];u.edge=ti(l.site,u.site,null,a);Ka(l);Ka(u)}function Va(e){var t=e.x,r=e.y,n,a,i,o,s=Da._;while(s){i=Ga(s,r)-t;if(i>Ee)s=s.L;else{o=t-qa(s,r);if(o>Ee){if(!s.R){n=s;break}s=s.R}else{if(i>-Ee){n=s.P;a=s}else if(o>-Ee){n=s;a=s.N}else{n=a=s}break}}}var l=ja(e);Da.insert(n,l);if(!n&&!a)return;if(n===a){Ja(n);a=ja(n.site);Da.insert(l,a);l.edge=a.edge=ti(n.site,l.site);Ka(n);Ka(a);return}if(!a){l.edge=ti(n.site,l.site);return}Ja(n);Ja(a);var u=n.site,c=u.x,f=u.y,h=e.x-c,p=e.y-f,d=a.site,v=d.x-c,m=d.y-f,g=2*(h*m-p*v),y=h*h+p*p,x=v*v+m*m,_={x:(m*y-p*x)/g+c,y:(h*x-v*y)/g+f};ni(a.edge,u,d,_);l.edge=ti(u,e,null,_);a.edge=ti(e,d,null,_);Ka(n);Ka(a)}function Ga(e,t){var r=e.site,n=r.x,a=r.y,i=a-t;if(!i)return n;var o=e.P;if(!o)return-Infinity;r=o.site;var s=r.x,l=r.y,u=l-t;if(!u)return s;var c=s-n,f=1/i-1/u,h=c/u;if(f)return(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+a-i/2)))/f+n;return(n+s)/2}function qa(e,t){var r=e.N;if(r)return Ga(r,t);var n=e.site;return n.y===t?n.x:Infinity}function Ya(e){this.site=e;this.edges=[]}Ya.prototype.prepare=function(){var e=this.edges,t=e.length,r;while(t--){r=e[t].edge;if(!r.b||!r.a)e.splice(t,1)}e.sort(Xa);return e.length};function Wa(e){var t=e[0][0],r=e[1][0],n=e[0][1],a=e[1][1],i,o,s,l,u=Pa,c=u.length,f,h,p,d,v,m;while(c--){f=u[c];if(!f||!f.prepare())continue;p=f.edges;d=p.length;h=0;while(h<d){m=p[h].end(),s=m.x,l=m.y;v=p[++h%d].start(),i=v.x,o=v.y;if(x(s-i)>Ee||x(l-o)>Ee){p.splice(h,0,new ai(ri(f.site,m,x(s-t)<Ee&&a-l>Ee?{x:t,y:x(i-t)<Ee?o:a}:x(l-a)<Ee&&r-s>Ee?{x:x(o-a)<Ee?i:r,y:a}:x(s-r)<Ee&&l-n>Ee?{x:r,y:x(i-r)<Ee?o:n}:x(l-n)<Ee&&s-t>Ee?{x:x(o-n)<Ee?i:t,y:n}:null),f.site,null));++d}}}}function Xa(e,t){return t.angle-e.angle}function Za(){oi(this);this.x=this.y=this.arc=this.site=this.cy=null}function Ka(e){var t=e.P,r=e.N;if(!t||!r)return;var n=t.site,a=e.site,i=r.site;if(n===i)return;var o=a.x,s=a.y,l=n.x-o,u=n.y-s,c=i.x-o,f=i.y-s;var h=2*(l*f-u*c);if(h>=-Se)return;var p=l*l+u*u,d=c*c+f*f,v=(f*p-u*d)/h,m=(l*d-c*p)/h,f=m+s;var g=Fa.pop()||new Za;g.arc=e;g.site=a;g.x=v+o;g.y=f+Math.sqrt(v*v+m*m);g.cy=f;e.circle=g;var y=null,x=Na._;while(x){if(g.y<x.y||g.y===x.y&&g.x<=x.x){if(x.L)x=x.L;else{y=x.P;break}}else{if(x.R)x=x.R;else{y=x;break}}}Na.insert(y,g);if(!y)za=g}function Ja(e){var t=e.circle;if(t){if(!t.P)za=t.N;Na.remove(t);Fa.push(t);oi(t);e.circle=null}}function Qa(e){var t=Oa,r=bn(e[0][0],e[0][1],e[1][0],e[1][1]),n=t.length,a;while(n--){a=t[n];if(!$a(a,e)||!r(a)||x(a.a.x-a.b.x)<Ee&&x(a.a.y-a.b.y)<Ee){a.a=a.b=null;t.splice(n,1)}}}function $a(e,t){var r=e.b;if(r)return true;var n=e.a,a=t[0][0],i=t[1][0],o=t[0][1],s=t[1][1],l=e.l,u=e.r,c=l.x,f=l.y,h=u.x,p=u.y,d=(c+h)/2,v=(f+p)/2,m,g;if(p===f){if(d<a||d>=i)return;if(c>h){if(!n)n={x:d,y:o};else if(n.y>=s)return;r={x:d,y:s}}else{if(!n)n={x:d,y:s};else if(n.y<o)return;r={x:d,y:o}}}else{m=(c-h)/(p-f);g=v-m*d;if(m<-1||m>1){if(c>h){if(!n)n={x:(o-g)/m,y:o};else if(n.y>=s)return;r={x:(s-g)/m,y:s}}else{if(!n)n={x:(s-g)/m,y:s};else if(n.y<o)return;r={x:(o-g)/m,y:o}}}else{if(f<p){if(!n)n={x:a,y:m*a+g};else if(n.x>=i)return;r={x:i,y:m*i+g}}else{if(!n)n={x:i,y:m*i+g};else if(n.x<a)return;r={x:a,y:m*a+g}}}}e.a=n;e.b=r;return true}function ei(e,t){this.l=e;this.r=t;this.a=this.b=null}function ti(e,t,r,n){var a=new ei(e,t);Oa.push(a);if(r)ni(a,e,t,r);if(n)ni(a,t,e,n);Pa[e.i].edges.push(new ai(a,e,t));Pa[t.i].edges.push(new ai(a,t,e));return a}function ri(e,t,r){var n=new ei(e,null);n.a=t;n.b=r;Oa.push(n);return n}function ni(e,t,r,n){if(!e.a&&!e.b){e.a=n;e.l=t;e.r=r}else if(e.l===r){e.b=n}else{e.a=n}}function ai(e,t,r){var n=e.a,a=e.b;this.edge=e;this.site=t;this.angle=r?Math.atan2(r.y-t.y,r.x-t.x):e.l===t?Math.atan2(a.x-n.x,n.y-a.y):Math.atan2(n.x-a.x,a.y-n.y)}ai.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function ii(){this._=null}function oi(e){e.U=e.C=e.L=e.R=e.P=e.N=null}ii.prototype={insert:function(e,t){var r,n,a;if(e){t.P=e;t.N=e.N;if(e.N)e.N.P=t;e.N=t;if(e.R){e=e.R;while(e.L)e=e.L;e.L=t}else{e.R=t}r=e}else if(this._){e=ui(this._);t.P=null;t.N=e;e.P=e.L=t;r=e}else{t.P=t.N=null;this._=t;r=null}t.L=t.R=null;t.U=r;t.C=true;e=t;while(r&&r.C){n=r.U;if(r===n.L){a=n.R;if(a&&a.C){r.C=a.C=false;n.C=true;e=n}else{if(e===r.R){si(this,r);e=r;r=e.U}r.C=false;n.C=true;li(this,n)}}else{a=n.L;if(a&&a.C){r.C=a.C=false;n.C=true;e=n}else{if(e===r.L){li(this,r);e=r;r=e.U}r.C=false;n.C=true;si(this,n)}}r=e.U}this._.C=false},remove:function(e){if(e.N)e.N.P=e.P;if(e.P)e.P.N=e.N;e.N=e.P=null;var t=e.U,r,n=e.L,a=e.R,i,o;if(!n)i=a;else if(!a)i=n;else i=ui(a);if(t){if(t.L===e)t.L=i;else t.R=i}else{this._=i}if(n&&a){o=i.C;i.C=e.C;i.L=n;n.U=i;if(i!==a){t=i.U;i.U=e.U;e=i.R;t.L=e;i.R=a;a.U=i}else{i.U=t;t=i;e=i.R}}else{o=e.C;e=i}if(e)e.U=t;if(o)return;if(e&&e.C){e.C=false;return}do{if(e===this._)break;if(e===t.L){r=t.R;if(r.C){r.C=false;t.C=true;si(this,t);r=t.R}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.R||!r.R.C){r.L.C=false;r.C=true;li(this,r);r=t.R}r.C=t.C;t.C=r.R.C=false;si(this,t);e=this._;break}}else{r=t.L;if(r.C){r.C=false;t.C=true;li(this,t);r=t.L}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.L||!r.L.C){r.R.C=false;r.C=true;si(this,r);r=t.L}r.C=t.C;t.C=r.L.C=false;li(this,t);e=this._;break}}r.C=true;e=t;t=t.U}while(!e.C);if(e)e.C=false}};function si(e,t){var r=t,n=t.R,a=r.U;if(a){if(a.L===r)a.L=n;else a.R=n}else{e._=n}n.U=a;r.U=n;r.R=n.L;if(r.R)r.R.U=r;n.L=r}function li(e,t){var r=t,n=t.L,a=r.U;if(a){if(a.L===r)a.L=n;else a.R=n}else{e._=n}n.U=a;r.U=n;r.L=n.R;if(r.L)r.L.U=r;n.R=r}function ui(e){while(e.L)e=e.L;return e}function ci(e,t){var r=e.sort(fi).pop(),n,a,i;Oa=[];Pa=new Array(e.length);Da=new ii;Na=new ii;while(true){i=za;if(r&&(!i||r.y<i.y||r.y===i.y&&r.x<i.x)){if(r.x!==n||r.y!==a){Pa[r.i]=new Ya(r);Va(r);n=r.x,a=r.y}r=e.pop()}else if(i){Ha(i.arc)}else{break}}if(t)Qa(t),Wa(t);var o={cells:Pa,edges:Oa};Da=Na=Oa=Pa=null;return o}function fi(e,t){return t.y-e.y||t.x-e.x}t.geom.voronoi=function(e){var t=ka,r=Aa,n=t,a=r,i=hi;if(e)return o(e);function o(e){var t=new Array(e.length),r=i[0][0],n=i[0][1],a=i[1][0],o=i[1][1];ci(s(e),i).cells.forEach(function(i,s){var l=i.edges,u=i.site,c=t[s]=l.length?l.map(function(e){var t=e.start();return[t.x,t.y]}):u.x>=r&&u.x<=a&&u.y>=n&&u.y<=o?[[r,o],[a,o],[a,n],[r,n]]:[];c.point=e[s]});return t}function s(e){return e.map(function(e,t){return{x:Math.round(n(e,t)/Ee)*Ee,y:Math.round(a(e,t)/Ee)*Ee,i:t}})}o.links=function(e){return ci(s(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})};o.triangles=function(e){var t=[];ci(s(e)).cells.forEach(function(r,n){var a=r.site,i=r.edges.sort(Xa),o=-1,s=i.length,l,u,c=i[s-1].edge,f=c.l===a?c.r:c.l;while(++o<s){l=c;u=f;c=i[o].edge;f=c.l===a?c.r:c.l;if(n<u.i&&n<f.i&&pi(a,u,f)<0){t.push([e[n],e[u.i],e[f.i]])}}});return t};o.x=function(e){return arguments.length?(n=kt(t=e),o):t};o.y=function(e){return arguments.length?(a=kt(r=e),o):r};o.clipExtent=function(e){if(!arguments.length)return i===hi?null:i;i=e==null?hi:e;return o};o.size=function(e){if(!arguments.length)return i===hi?null:i&&i[1];return o.clipExtent(e&&[[0,0],e])};return o};var hi=[[-1e6,-1e6],[1e6,1e6]];function pi(e,t,r){return(e.x-r.x)*(t.y-e.y)-(e.x-t.x)*(r.y-e.y)}t.geom.delaunay=function(e){return t.geom.voronoi().triangles(e)};t.geom.quadtree=function(e,t,r,n,a){var i=ka,o=Aa,s;if(s=arguments.length){i=di;o=vi;if(s===3){a=r;n=t;r=t=0}return l(e)}function l(e){var l,u=kt(i),c=kt(o),f,h,p,d,v,m,g,y;if(t!=null){v=t,m=r,g=n,y=a}else{g=y=-(v=m=Infinity);f=[],h=[];d=e.length;if(s)for(p=0;p<d;++p){l=e[p];if(l.x<v)v=l.x;if(l.y<m)m=l.y;if(l.x>g)g=l.x;if(l.y>y)y=l.y;f.push(l.x);h.push(l.y)}else for(p=0;p<d;++p){var _=+u(l=e[p],p),b=+c(l,p);if(_<v)v=_;if(b<m)m=b;if(_>g)g=_;if(b>y)y=b;f.push(_);h.push(b)}}var w=g-v,T=y-m;if(w>T)y=m+w;else g=v+T;function k(e,t,r,n,a,i,o,s){if(isNaN(r)||isNaN(n))return;if(e.leaf){var l=e.x,u=e.y;if(l!=null){if(x(l-r)+x(u-n)<.01){A(e,t,r,n,a,i,o,s)}else{var c=e.point;e.x=e.y=e.point=null;A(e,c,l,u,a,i,o,s);A(e,t,r,n,a,i,o,s)}}else{e.x=r,e.y=n,e.point=t}}else{A(e,t,r,n,a,i,o,s)}}function A(e,t,r,n,a,i,o,s){var l=(a+o)*.5,u=(i+s)*.5,c=r>=l,f=n>=u,h=f<<1|c;e.leaf=false;e=e.nodes[h]||(e.nodes[h]=mi());if(c)a=l;else o=l;if(f)i=u;else s=u;k(e,t,r,n,a,i,o,s)}var M=mi();M.add=function(e){k(M,e,+u(e,++p),+c(e,p),v,m,g,y)};M.visit=function(e){gi(e,M,v,m,g,y)};M.find=function(e){return yi(M,e[0],e[1],v,m,g,y)};p=-1;if(t==null){while(++p<d){k(M,e[p],f[p],h[p],v,m,g,y)}--p}else e.forEach(M.add);f=h=e=l=null;return M}l.x=function(e){return arguments.length?(i=e,l):i};l.y=function(e){return arguments.length?(o=e,l):o};l.extent=function(e){if(!arguments.length)return t==null?null:[[t,r],[n,a]];if(e==null)t=r=n=a=null;else t=+e[0][0],r=+e[0][1],n=+e[1][0],a=+e[1][1];return l};l.size=function(e){if(!arguments.length)return t==null?null:[n-t,a-r];if(e==null)t=r=n=a=null;else t=r=0,n=+e[0],a=+e[1];return l};return l};function di(e){return e.x}function vi(e){return e.y}function mi(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function gi(e,t,r,n,a,i){if(!e(t,r,n,a,i)){var o=(r+a)*.5,s=(n+i)*.5,l=t.nodes;if(l[0])gi(e,l[0],r,n,o,s);if(l[1])gi(e,l[1],o,n,a,s);if(l[2])gi(e,l[2],r,s,o,i);if(l[3])gi(e,l[3],o,s,a,i)}}function yi(e,t,r,n,a,i,o){var s=Infinity,l;(function e(u,c,f,h,p){if(c>i||f>o||h<n||p<a)return;if(d=u.point){var d,v=t-u.x,m=r-u.y,g=v*v+m*m;if(g<s){var y=Math.sqrt(s=g);n=t-y,a=r-y;i=t+y,o=r+y;l=d}}var x=u.nodes,_=(c+h)*.5,b=(f+p)*.5,w=t>=_,T=r>=b;for(var k=T<<1|w,A=k+4;k<A;++k){if(u=x[k&3])switch(k&3){case 0:e(u,c,f,_,b);break;case 1:e(u,_,f,h,b);break;case 2:e(u,c,b,_,p);break;case 3:e(u,_,b,h,p);break}}})(e,n,a,i,o);return l}t.interpolateRgb=xi;function xi(e,r){e=t.rgb(e);r=t.rgb(r);var n=e.r,a=e.g,i=e.b,o=r.r-n,s=r.g-a,l=r.b-i;return function(e){return"#"+gt(Math.round(n+o*e))+gt(Math.round(a+s*e))+gt(Math.round(i+l*e))}}t.interpolateObject=_i;function _i(e,t){var r={},n={},a;for(a in e){if(a in t){r[a]=Ai(e[a],t[a])}else{n[a]=e[a]}}for(a in t){if(!(a in e)){n[a]=t[a]}}return function(e){for(a in r)n[a]=r[a](e);return n}}t.interpolateNumber=bi;function bi(e,t){e=+e,t=+t;return function(r){return e*(1-r)+t*r}}t.interpolateString=wi;function wi(e,t){var r=Ti.lastIndex=ki.lastIndex=0,n,a,i,o=-1,s=[],l=[];e=e+"",t=t+"";while((n=Ti.exec(e))&&(a=ki.exec(t))){if((i=a.index)>r){i=t.slice(r,i);if(s[o])s[o]+=i;else s[++o]=i}if((n=n[0])===(a=a[0])){if(s[o])s[o]+=a;else s[++o]=a}else{s[++o]=null;l.push({i:o,x:bi(n,a)})}r=ki.lastIndex}if(r<t.length){i=t.slice(r);if(s[o])s[o]+=i;else s[++o]=i}return s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var r=0,n;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}var Ti=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ki=new RegExp(Ti.source,"g");t.interpolate=Ai;function Ai(e,r){var n=t.interpolators.length,a;while(--n>=0&&!(a=t.interpolators[n](e,r)));return a}t.interpolators=[function(e,t){var r=typeof t;return(r==="string"?Tt.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?xi:wi:t instanceof Ze?xi:Array.isArray(t)?Mi:r==="object"&&isNaN(t)?_i:bi)(e,t)}];t.interpolateArray=Mi;function Mi(e,t){var r=[],n=[],a=e.length,i=t.length,o=Math.min(e.length,t.length),s;for(s=0;s<o;++s)r.push(Ai(e[s],t[s]));for(;s<a;++s)n[s]=e[s];for(;s<i;++s)n[s]=t[s];return function(e){for(s=0;s<o;++s)n[s]=r[s](e);return n}}var Ei=function(){return P};var Si=t.map({linear:Ei,poly:zi,quad:function(){return Pi},cubic:function(){return Di},sin:function(){return Ni},exp:function(){return Fi},circle:function(){return Bi},elastic:ji,back:Ui,bounce:function(){return Hi}});var Ci=t.map({in:P,out:Ii,"in-out":Oi,"out-in":function(e){return Oi(Ii(e))}});t.ease=function(e){var t=e.indexOf("-"),r=t>=0?e.slice(0,t):e,a=t>=0?e.slice(t+1):"in";r=Si.get(r)||Ei;a=Ci.get(a)||P;return Li(a(r.apply(null,n.call(arguments,1))))};function Li(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function Ii(e){return function(t){return 1-e(1-t)}}function Oi(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function Pi(e){return e*e}function Di(e){return e*e*e}function Ri(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function zi(e){return function(t){return Math.pow(t,e)}}function Ni(e){return 1-Math.cos(e*Oe)}function Fi(e){return Math.pow(2,10*(e-1))}function Bi(e){return 1-Math.sqrt(1-e*e)}function ji(e,t){var r;if(arguments.length<2)t=.45;if(arguments.length)r=t/Le*Math.asin(1/e);else e=1,r=t/4;return function(n){return 1+e*Math.pow(2,-10*n)*Math.sin((n-r)*Le/t)}}function Ui(e){if(!e)e=1.70158;return function(t){return t*t*((e+1)*t-e)}}function Hi(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}t.interpolateHcl=Vi;function Vi(e,r){e=t.hcl(e);r=t.hcl(r);var n=e.h,a=e.c,i=e.l,o=r.h-n,s=r.c-a,l=r.l-i;if(isNaN(s))s=0,a=isNaN(a)?r.c:a;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return tt(n+o*e,a+s*e,i+l*e)+""}}t.interpolateHsl=Gi;function Gi(e,r){e=t.hsl(e);r=t.hsl(r);var n=e.h,a=e.s,i=e.l,o=r.h-n,s=r.s-a,l=r.l-i;if(isNaN(s))s=0,a=isNaN(a)?r.s:a;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return Qe(n+o*e,a+s*e,i+l*e)+""}}t.interpolateLab=qi;function qi(e,r){e=t.lab(e);r=t.lab(r);var n=e.l,a=e.a,i=e.b,o=r.l-n,s=r.a-a,l=r.b-i;return function(e){return lt(n+o*e,a+s*e,i+l*e)+""}}t.interpolateRound=Yi;function Yi(e,t){t-=e;return function(r){return Math.round(e+t*r)}}t.transform=function(e){var r=i.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(e){if(e!=null){r.setAttribute("transform",e);var t=r.transform.baseVal.consolidate()}return new Wi(t?t.matrix:Ji)})(e)};function Wi(e){var t=[e.a,e.b],r=[e.c,e.d],n=Zi(t),a=Xi(t,r),i=Zi(Ki(r,t,-a))||0;if(t[0]*r[1]<r[0]*t[1]){t[0]*=-1;t[1]*=-1;n*=-1;a*=-1}this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-r[0],r[1]))*De;this.translate=[e.e,e.f];this.scale=[n,i];this.skew=i?Math.atan2(a,i)*De:0}Wi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Xi(e,t){return e[0]*t[0]+e[1]*t[1]}function Zi(e){var t=Math.sqrt(Xi(e,e));if(t){e[0]/=t;e[1]/=t}return t}function Ki(e,t,r){e[0]+=r*t[0];e[1]+=r*t[1];return e}var Ji={a:1,b:0,c:0,d:1,e:0,f:0};t.interpolateTransform=no;function Qi(e){return e.length?e.pop()+",":""}function $i(e,t,r,n){if(e[0]!==t[0]||e[1]!==t[1]){var a=r.push("translate(",null,",",null,")");n.push({i:a-4,x:bi(e[0],t[0])},{i:a-2,x:bi(e[1],t[1])})}else if(t[0]||t[1]){r.push("translate("+t+")")}}function eo(e,t,r,n){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;n.push({i:r.push(Qi(r)+"rotate(",null,")")-2,x:bi(e,t)})}else if(t){r.push(Qi(r)+"rotate("+t+")")}}function to(e,t,r,n){if(e!==t){n.push({i:r.push(Qi(r)+"skewX(",null,")")-2,x:bi(e,t)})}else if(t){r.push(Qi(r)+"skewX("+t+")")}}function ro(e,t,r,n){if(e[0]!==t[0]||e[1]!==t[1]){var a=r.push(Qi(r)+"scale(",null,",",null,")");n.push({i:a-4,x:bi(e[0],t[0])},{i:a-2,x:bi(e[1],t[1])})}else if(t[0]!==1||t[1]!==1){r.push(Qi(r)+"scale("+t+")")}}function no(e,r){var n=[],a=[];e=t.transform(e),r=t.transform(r);$i(e.translate,r.translate,n,a);eo(e.rotate,r.rotate,n,a);to(e.skew,r.skew,n,a);ro(e.scale,r.scale,n,a);e=r=null;return function(e){var t=-1,r=a.length,i;while(++t<r)n[(i=a[t]).i]=i.x(e);return n.join("")}}function ao(e,t){t=(t-=e=+e)||1/t;return function(r){return(r-e)/t}}function io(e,t){t=(t-=e=+e)||1/t;return function(r){return Math.max(0,Math.min(1,(r-e)/t))}}t.layout={};t.layout.bundle=function(){return function(e){var t=[],r=-1,n=e.length;while(++r<n)t.push(oo(e[r]));return t}};function oo(e){var t=e.source,r=e.target,n=lo(t,r),a=[t];while(t!==n){t=t.parent;a.push(t)}var i=a.length;while(r!==n){a.splice(i,0,r);r=r.parent}return a}function so(e){var t=[],r=e.parent;while(r!=null){t.push(e);e=r;r=r.parent}t.push(e);return t}function lo(e,t){if(e===t)return e;var r=so(e),n=so(t),a=r.pop(),i=n.pop(),o=null;while(a===i){o=a;a=r.pop();i=n.pop()}return o}t.layout.chord=function(){var e={},r,n,a,i,o=0,s,l,u;function c(){var e={},c=[],h=t.range(i),p=[],d,v,m,g,y;r=[];n=[];d=0,g=-1;while(++g<i){v=0,y=-1;while(++y<i){v+=a[g][y]}c.push(v);p.push(t.range(i));d+=v}if(s){h.sort(function(e,t){return s(c[e],c[t])})}if(l){p.forEach(function(e,t){e.sort(function(e,r){return l(a[t][e],a[t][r])})})}d=(Le-o*i)/d;v=0,g=-1;while(++g<i){m=v,y=-1;while(++y<i){var x=h[g],_=p[x][y],b=a[x][_],w=v,T=v+=b*d;e[x+"-"+_]={index:x,subindex:_,startAngle:w,endAngle:T,value:b}}n[x]={index:x,startAngle:m,endAngle:v,value:c[x]};v+=o}g=-1;while(++g<i){y=g-1;while(++y<i){var k=e[g+"-"+y],A=e[y+"-"+g];if(k.value||A.value){r.push(k.value<A.value?{source:A,target:k}:{source:k,target:A})}}}if(u)f()}function f(){r.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}e.matrix=function(t){if(!arguments.length)return a;i=(a=t)&&a.length;r=n=null;return e};e.padding=function(t){if(!arguments.length)return o;o=t;r=n=null;return e};e.sortGroups=function(t){if(!arguments.length)return s;s=t;r=n=null;return e};e.sortSubgroups=function(t){if(!arguments.length)return l;l=t;r=null;return e};e.sortChords=function(t){if(!arguments.length)return u;u=t;if(r)f();return e};e.chords=function(){if(!r)c();return r};e.groups=function(){if(!n)c();return n};return e};t.layout.force=function(){var e={},r=t.dispatch("start","tick","end"),n,a=[1,1],i,o,s=.9,l=vo,u=mo,c=-30,f=go,h=.1,p=.64,d=[],v=[],m,g,y;function x(e){return function(t,r,n,a){if(t.point!==e){var i=t.cx-e.x,o=t.cy-e.y,s=a-r,l=i*i+o*o;if(s*s/p<l){if(l<f){var u=t.charge/l;e.px-=i*u;e.py-=o*u}return true}if(t.point&&l&&l<f){var u=t.pointCharge/l;e.px-=i*u;e.py-=o*u}}return!t.charge}}e.tick=function(){if((o*=.99)<.005){n=null;r.end({type:"end",alpha:o=0});return true}var e=d.length,i=v.length,l,u,f,p,_,b,w,T,k;for(u=0;u<i;++u){f=v[u];p=f.source;_=f.target;T=_.x-p.x;k=_.y-p.y;if(b=T*T+k*k){b=o*g[u]*((b=Math.sqrt(b))-m[u])/b;T*=b;k*=b;_.x-=T*(w=p.weight+_.weight?p.weight/(p.weight+_.weight):.5);_.y-=k*w;p.x+=T*(w=1-w);p.y+=k*w}}if(w=o*h){T=a[0]/2;k=a[1]/2;u=-1;if(w)while(++u<e){f=d[u];f.x+=(T-f.x)*w;f.y+=(k-f.y)*w}}if(c){po(l=t.geom.quadtree(d),o,y);u=-1;while(++u<e){if(!(f=d[u]).fixed){l.visit(x(f))}}}u=-1;while(++u<e){f=d[u];if(f.fixed){f.x=f.px;f.y=f.py}else{f.x-=(f.px-(f.px=f.x))*s;f.y-=(f.py-(f.py=f.y))*s}}r.tick({type:"tick",alpha:o})};e.nodes=function(t){if(!arguments.length)return d;d=t;return e};e.links=function(t){if(!arguments.length)return v;v=t;return e};e.size=function(t){if(!arguments.length)return a;a=t;return e};e.linkDistance=function(t){if(!arguments.length)return l;l=typeof t==="function"?t:+t;return e};e.distance=e.linkDistance;e.linkStrength=function(t){if(!arguments.length)return u;u=typeof t==="function"?t:+t;return e};e.friction=function(t){if(!arguments.length)return s;s=+t;return e};e.charge=function(t){if(!arguments.length)return c;c=typeof t==="function"?t:+t;return e};e.chargeDistance=function(t){if(!arguments.length)return Math.sqrt(f);f=t*t;return e};e.gravity=function(t){if(!arguments.length)return h;h=+t;return e};e.theta=function(t){if(!arguments.length)return Math.sqrt(p);p=t*t;return e};e.alpha=function(t){if(!arguments.length)return o;t=+t;if(o){if(t>0){o=t}else{n.c=null,n.t=NaN,n=null;r.end({type:"end",alpha:o=0})}}else if(t>0){r.start({type:"start",alpha:o=t});n=Dt(e.tick)}return e};e.start=function(){var t,r=d.length,n=v.length,i=a[0],o=a[1],s,f;for(t=0;t<r;++t){(f=d[t]).index=t;f.weight=0}for(t=0;t<n;++t){f=v[t];if(typeof f.source=="number")f.source=d[f.source];if(typeof f.target=="number")f.target=d[f.target];++f.source.weight;++f.target.weight}for(t=0;t<r;++t){f=d[t];if(isNaN(f.x))f.x=h("x",i);if(isNaN(f.y))f.y=h("y",o);if(isNaN(f.px))f.px=f.x;if(isNaN(f.py))f.py=f.y}m=[];if(typeof l==="function")for(t=0;t<n;++t)m[t]=+l.call(this,v[t],t);else for(t=0;t<n;++t)m[t]=l;g=[];if(typeof u==="function")for(t=0;t<n;++t)g[t]=+u.call(this,v[t],t);else for(t=0;t<n;++t)g[t]=u;y=[];if(typeof c==="function")for(t=0;t<r;++t)y[t]=+c.call(this,d[t],t);else for(t=0;t<r;++t)y[t]=c;function h(e,a){if(!s){s=new Array(r);for(l=0;l<r;++l){s[l]=[]}for(l=0;l<n;++l){var i=v[l];s[i.source.index].push(i.target);s[i.target.index].push(i.source)}}var o=s[t],l=-1,u=o.length,c;while(++l<u)if(!isNaN(c=o[l][e]))return c;return Math.random()*a}return e.resume()};e.resume=function(){return e.alpha(.1)};e.stop=function(){return e.alpha(0)};e.drag=function(){if(!i)i=t.behavior.drag().origin(P).on("dragstart.force",uo).on("drag.force",_).on("dragend.force",co);if(!arguments.length)return i;this.on("mouseover.force",fo).on("mouseout.force",ho).call(i)};function _(r){r.px=t.event.x,r.py=t.event.y;e.resume()}return t.rebind(e,r,"on")};function uo(e){e.fixed|=2}function co(e){e.fixed&=~6}function fo(e){e.fixed|=4;e.px=e.x,e.py=e.y}function ho(e){e.fixed&=~4}function po(e,t,r){var n=0,a=0;e.charge=0;if(!e.leaf){var i=e.nodes,o=i.length,s=-1,l;while(++s<o){l=i[s];if(l==null)continue;po(l,t,r);e.charge+=l.charge;n+=l.charge*l.cx;a+=l.charge*l.cy}}if(e.point){if(!e.leaf){e.point.x+=Math.random()-.5;e.point.y+=Math.random()-.5}var u=t*r[e.point.index];e.charge+=e.pointCharge=u;n+=u*e.point.x;a+=u*e.point.y}e.cx=n/e.charge;e.cy=a/e.charge}var vo=20,mo=1,go=Infinity;t.layout.hierarchy=function(){var e=To,t=bo,r=wo;function n(a){var i=[a],o=[],s;a.depth=0;while((s=i.pop())!=null){o.push(s);if((u=t.call(n,s,s.depth))&&(l=u.length)){var l,u,c;while(--l>=0){i.push(c=u[l]);c.parent=s;c.depth=s.depth+1}if(r)s.value=0;s.children=u}else{if(r)s.value=+r.call(n,s,s.depth)||0;delete s.children}}_o(a,function(t){var n,a;if(e&&(n=t.children))n.sort(e);if(r&&(a=t.parent))a.value+=t.value});return o}n.sort=function(t){if(!arguments.length)return e;e=t;return n};n.children=function(e){if(!arguments.length)return t;t=e;return n};n.value=function(e){if(!arguments.length)return r;r=e;return n};n.revalue=function(e){if(r){xo(e,function(e){if(e.children)e.value=0});_o(e,function(e){var t;if(!e.children)e.value=+r.call(n,e,e.depth)||0;if(t=e.parent)t.value+=e.value})}return e};return n};function yo(e,r){t.rebind(e,r,"sort","children","value");e.nodes=e;e.links=ko;return e}function xo(e,t){var r=[e];while((e=r.pop())!=null){t(e);if((a=e.children)&&(n=a.length)){var n,a;while(--n>=0)r.push(a[n])}}}function _o(e,t){var r=[e],n=[];while((e=r.pop())!=null){n.push(e);if((o=e.children)&&(i=o.length)){var a=-1,i,o;while(++a<i)r.push(o[a])}}while((e=n.pop())!=null){t(e)}}function bo(e){return e.children}function wo(e){return e.value}function To(e,t){return t.value-e.value}function ko(e){return t.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}t.layout.partition=function(){var e=t.layout.hierarchy(),r=[1,1];function n(e,t,r,a){var i=e.children;e.x=t;e.y=e.depth*a;e.dx=r;e.dy=a;if(i&&(s=i.length)){var o=-1,s,l,u;r=e.value?r/e.value:0;while(++o<s){n(l=i[o],t,u=l.value*r,a);t+=u}}}function a(e){var t=e.children,r=0;if(t&&(i=t.length)){var n=-1,i;while(++n<i)r=Math.max(r,a(t[n]))}return 1+r}function i(t,i){var o=e.call(this,t,i);n(o[0],0,r[0],r[1]/a(o[0]));return o}i.size=function(e){if(!arguments.length)return r;r=e;return i};return yo(i,e)};t.layout.pie=function(){var e=Number,r=Ao,n=0,a=Le,i=0;function o(s){var l=s.length,u=s.map(function(t,r){return+e.call(o,t,r)}),c=+(typeof n==="function"?n.apply(this,arguments):n),f=(typeof a==="function"?a.apply(this,arguments):a)-c,h=Math.min(Math.abs(f)/l,+(typeof i==="function"?i.apply(this,arguments):i)),p=h*(f<0?-1:1),d=t.sum(u),v=d?(f-l*p)/d:0,m=t.range(l),g=[],y;if(r!=null)m.sort(r===Ao?function(e,t){return u[t]-u[e]}:function(e,t){return r(s[e],s[t])});m.forEach(function(e){g[e]={data:s[e],value:y=u[e],startAngle:c,endAngle:c+=y*v+p,padAngle:h}});return g}o.value=function(t){if(!arguments.length)return e;e=t;return o};o.sort=function(e){if(!arguments.length)return r;r=e;return o};o.startAngle=function(e){if(!arguments.length)return n;n=e;return o};o.endAngle=function(e){if(!arguments.length)return a;a=e;return o};o.padAngle=function(e){if(!arguments.length)return i;i=e;return o};return o};var Ao={};t.layout.stack=function(){var e=P,r=Io,n=Oo,a=So,i=Mo,o=Eo;function s(l,u){if(!(v=l.length))return l;var c=l.map(function(t,r){return e.call(s,t,r)});var f=c.map(function(e){return e.map(function(e,t){return[i.call(s,e,t),o.call(s,e,t)]})});var h=r.call(s,f,u);c=t.permute(c,h);f=t.permute(f,h);var p=n.call(s,f,u);var d=c[0].length,v,m,g,y;for(g=0;g<d;++g){a.call(s,c[0][g],y=p[g],f[0][g][1]);for(m=1;m<v;++m){a.call(s,c[m][g],y+=f[m-1][g][1],f[m][g][1])}}return l}s.values=function(t){if(!arguments.length)return e;e=t;return s};s.order=function(e){if(!arguments.length)return r;r=typeof e==="function"?e:Co.get(e)||Io;return s};s.offset=function(e){if(!arguments.length)return n;n=typeof e==="function"?e:Lo.get(e)||Oo;return s};s.x=function(e){if(!arguments.length)return i;i=e;return s};s.y=function(e){if(!arguments.length)return o;o=e;return s};s.out=function(e){if(!arguments.length)return a;a=e;return s};return s};function Mo(e){return e.x}function Eo(e){return e.y}function So(e,t,r){e.y0=t;e.y=r}var Co=t.map({"inside-out":function(e){var r=e.length,n,a,i=e.map(Po),o=e.map(Do),s=t.range(r).sort(function(e,t){return i[e]-i[t]}),l=0,u=0,c=[],f=[];for(n=0;n<r;++n){a=s[n];if(l<u){l+=o[a];c.push(a)}else{u+=o[a];f.push(a)}}return f.reverse().concat(c)},reverse:function(e){return t.range(e.length).reverse()},default:Io});var Lo=t.map({silhouette:function(e){var t=e.length,r=e[0].length,n=[],a=0,i,o,s,l=[];for(o=0;o<r;++o){for(i=0,s=0;i<t;i++)s+=e[i][o][1];if(s>a)a=s;n.push(s)}for(o=0;o<r;++o){l[o]=(a-n[o])/2}return l},wiggle:function(e){var t=e.length,r=e[0],n=r.length,a,i,o,s,l,u,c,f,h,p=[];p[0]=f=h=0;for(i=1;i<n;++i){for(a=0,s=0;a<t;++a)s+=e[a][i][1];for(a=0,l=0,c=r[i][0]-r[i-1][0];a<t;++a){for(o=0,u=(e[a][i][1]-e[a][i-1][1])/(2*c);o<a;++o){u+=(e[o][i][1]-e[o][i-1][1])/c}l+=u*e[a][i][1]}p[i]=f-=s?l/s*c:0;if(f<h)h=f}for(i=0;i<n;++i)p[i]-=h;return p},expand:function(e){var t=e.length,r=e[0].length,n=1/t,a,i,o,s=[];for(i=0;i<r;++i){for(a=0,o=0;a<t;a++)o+=e[a][i][1];if(o)for(a=0;a<t;a++)e[a][i][1]/=o;else for(a=0;a<t;a++)e[a][i][1]=n}for(i=0;i<r;++i)s[i]=0;return s},zero:Oo});function Io(e){return t.range(e.length)}function Oo(e){var t=-1,r=e[0].length,n=[];while(++t<r)n[t]=0;return n}function Po(e){var t=1,r=0,n=e[0][1],a,i=e.length;for(;t<i;++t){if((a=e[t][1])>n){r=t;n=a}}return r}function Do(e){return e.reduce(Ro,0)}function Ro(e,t){return e+t[1]}t.layout.histogram=function(){var e=true,r=Number,n=Fo,a=zo;function i(i,o){var s=[],l=i.map(r,this),u=n.call(this,l,o),c=a.call(this,u,l,o),f,o=-1,h=l.length,p=c.length-1,d=e?1:1/h,v;while(++o<p){f=s[o]=[];f.dx=c[o+1]-(f.x=c[o]);f.y=0}if(p>0){o=-1;while(++o<h){v=l[o];if(v>=u[0]&&v<=u[1]){f=s[t.bisect(c,v,1,p)-1];f.y+=d;f.push(i[o])}}}return s}i.value=function(e){if(!arguments.length)return r;r=e;return i};i.range=function(e){if(!arguments.length)return n;n=kt(e);return i};i.bins=function(e){if(!arguments.length)return a;a=typeof e==="number"?function(t){return No(t,e)}:kt(e);return i};i.frequency=function(t){if(!arguments.length)return e;e=!!t;return i};return i};function zo(e,t){return No(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function No(e,t){var r=-1,n=+e[0],a=(e[1]-n)/t,i=[];while(++r<=t)i[r]=a*r+n;return i}function Fo(e){return[t.min(e),t.max(e)]}t.layout.pack=function(){var e=t.layout.hierarchy().sort(Bo),r=0,n=[1,1],a;function i(t,i){var o=e.call(this,t,i),s=o[0],l=n[0],u=n[1],c=a==null?Math.sqrt:typeof a==="function"?a:function(){return a};s.x=s.y=0;_o(s,function(e){e.r=+c(e.value)});_o(s,Vo);if(r){var f=r*(a?1:Math.max(2*s.r/l,2*s.r/u))/2;_o(s,function(e){e.r+=f});_o(s,Vo);_o(s,function(e){e.r-=f})}Yo(s,l/2,u/2,a?1:1/Math.max(2*s.r/l,2*s.r/u));return o}i.size=function(e){if(!arguments.length)return n;n=e;return i};i.radius=function(e){if(!arguments.length)return a;a=e==null||typeof e==="function"?e:+e;return i};i.padding=function(e){if(!arguments.length)return r;r=+e;return i};return yo(i,e)};function Bo(e,t){return e.value-t.value}function jo(e,t){var r=e._pack_next;e._pack_next=t;t._pack_prev=e;t._pack_next=r;r._pack_prev=t}function Uo(e,t){e._pack_next=t;t._pack_prev=e}function Ho(e,t){var r=t.x-e.x,n=t.y-e.y,a=e.r+t.r;return.999*a*a>r*r+n*n}function Vo(e){if(!(t=e.children)||!(h=t.length))return;var t,r=Infinity,n=-Infinity,a=Infinity,i=-Infinity,o,s,l,u,c,f,h;function p(e){r=Math.min(e.x-e.r,r);n=Math.max(e.x+e.r,n);a=Math.min(e.y-e.r,a);i=Math.max(e.y+e.r,i)}t.forEach(Go);o=t[0];o.x=-o.r;o.y=0;p(o);if(h>1){s=t[1];s.x=s.r;s.y=0;p(s);if(h>2){l=t[2];Wo(o,s,l);p(l);jo(o,l);o._pack_prev=l;jo(l,s);s=o._pack_next;for(u=3;u<h;u++){Wo(o,s,l=t[u]);var d=0,v=1,m=1;for(c=s._pack_next;c!==s;c=c._pack_next,v++){if(Ho(c,l)){d=1;break}}if(d==1){for(f=o._pack_prev;f!==c._pack_prev;f=f._pack_prev,m++){if(Ho(f,l)){break}}}if(d){if(v<m||v==m&&s.r<o.r)Uo(o,s=c);else Uo(o=f,s);u--}else{jo(o,l);s=l;p(l)}}}}var g=(r+n)/2,y=(a+i)/2,x=0;for(u=0;u<h;u++){l=t[u];l.x-=g;l.y-=y;x=Math.max(x,l.r+Math.sqrt(l.x*l.x+l.y*l.y))}e.r=x;t.forEach(qo)}function Go(e){e._pack_next=e._pack_prev=e}function qo(e){delete e._pack_next;delete e._pack_prev}function Yo(e,t,r,n){var a=e.children;e.x=t+=n*e.x;e.y=r+=n*e.y;e.r*=n;if(a){var i=-1,o=a.length;while(++i<o)Yo(a[i],t,r,n)}}function Wo(e,t,r){var n=e.r+r.r,a=t.x-e.x,i=t.y-e.y;if(n&&(a||i)){var o=t.r+r.r,s=a*a+i*i;o*=o;n*=n;var l=.5+(n-o)/(2*s),u=Math.sqrt(Math.max(0,2*o*(n+s)-(n-=s)*n-o*o))/(2*s);r.x=e.x+l*a+u*i;r.y=e.y+l*i-u*a}else{r.x=e.x+n;r.y=e.y}}t.layout.tree=function(){var e=t.layout.hierarchy().sort(null).value(null),r=Xo,n=[1,1],a=null;function i(t,i){var u=e.call(this,t,i),f=u[0],h=o(f);_o(h,s),h.parent.m=-h.z;xo(h,l);if(a)xo(f,c);else{var p=f,d=f,v=f;xo(f,function(e){if(e.x<p.x)p=e;if(e.x>d.x)d=e;if(e.depth>v.depth)v=e});var m=r(p,d)/2-p.x,g=n[0]/(d.x+r(d,p)/2+m),y=n[1]/(v.depth||1);xo(f,function(e){e.x=(e.x+m)*g;e.y=e.depth*y})}return u}function o(e){var t={A:null,children:[e]},r=[t],n;while((n=r.pop())!=null){for(var a=n.children,i,o=0,s=a.length;o<s;++o){r.push((a[o]=i={_:a[o],parent:n,children:(i=a[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i)}}return t.children[0]}function s(e){var t=e.children,n=e.parent.children,a=e.i?n[e.i-1]:null;if(t.length){Qo(e);var i=(t[0].z+t[t.length-1].z)/2;if(a){e.z=a.z+r(e._,a._);e.m=e.z-i}else{e.z=i}}else if(a){e.z=a.z+r(e._,a._)}e.parent.A=u(e,a,e.parent.A||n[0])}function l(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(e,t,n){if(t){var a=e,i=e,o=t,s=a.parent.children[0],l=a.m,u=i.m,c=o.m,f=s.m,h;while(o=Ko(o),a=Zo(a),o&&a){s=Zo(s);i=Ko(i);i.a=e;h=o.z+c-a.z-l+r(o._,a._);if(h>0){Jo($o(o,e,n),e,h);l+=h;u+=h}c+=o.m;l+=a.m;f+=s.m;u+=i.m}if(o&&!Ko(i)){i.t=o;i.m+=c-u}if(a&&!Zo(s)){s.t=a;s.m+=l-f;n=e}}return n}function c(e){e.x*=n[0];e.y=e.depth*n[1]}i.separation=function(e){if(!arguments.length)return r;r=e;return i};i.size=function(e){if(!arguments.length)return a?null:n;a=(n=e)==null?c:null;return i};i.nodeSize=function(e){if(!arguments.length)return a?n:null;a=(n=e)==null?null:c;return i};return yo(i,e)};function Xo(e,t){return e.parent==t.parent?1:2}function Zo(e){var t=e.children;return t.length?t[0]:e.t}function Ko(e){var t=e.children,r;return(r=t.length)?t[r-1]:e.t}function Jo(e,t,r){var n=r/(t.i-e.i);t.c-=n;t.s+=r;e.c+=n;t.z+=r;t.m+=r}function Qo(e){var t=0,r=0,n=e.children,a=n.length,i;while(--a>=0){i=n[a];i.z+=t;i.m+=t;t+=i.s+(r+=i.c)}}function $o(e,t,r){return e.a.parent===t.parent?e.a:r}t.layout.cluster=function(){var e=t.layout.hierarchy().sort(null).value(null),r=Xo,n=[1,1],a=false;function i(t,i){var o=e.call(this,t,i),s=o[0],l,u=0;_o(s,function(e){var t=e.children;if(t&&t.length){e.x=ts(t);e.y=es(t)}else{e.x=l?u+=r(e,l):0;e.y=0;l=e}});var c=rs(s),f=ns(s),h=c.x-r(c,f)/2,p=f.x+r(f,c)/2;_o(s,a?function(e){e.x=(e.x-s.x)*n[0];e.y=(s.y-e.y)*n[1]}:function(e){e.x=(e.x-h)/(p-h)*n[0];e.y=(1-(s.y?e.y/s.y:1))*n[1]});return o}i.separation=function(e){if(!arguments.length)return r;r=e;return i};i.size=function(e){if(!arguments.length)return a?null:n;a=(n=e)==null;return i};i.nodeSize=function(e){if(!arguments.length)return a?n:null;a=(n=e)!=null;return i};return yo(i,e)};function es(e){return 1+t.max(e,function(e){return e.y})}function ts(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function rs(e){var t=e.children;return t&&t.length?rs(t[0]):e}function ns(e){var t=e.children,r;return t&&(r=t.length)?ns(t[r-1]):e}t.layout.treemap=function(){var e=t.layout.hierarchy(),r=Math.round,n=[1,1],a=null,i=as,o=false,s,l="squarify",u=.5*(1+Math.sqrt(5));function c(e,t){var r=-1,n=e.length,a,i;while(++r<n){i=(a=e[r]).value*(t<0?0:t);a.area=isNaN(i)||i<=0?0:i}}function f(e){var t=e.children;if(t&&t.length){var r=i(e),n=[],a=t.slice(),o,s=Infinity,u,h=l==="slice"?r.dx:l==="dice"?r.dy:l==="slice-dice"?e.depth&1?r.dy:r.dx:Math.min(r.dx,r.dy),v;c(a,r.dx*r.dy/e.value);n.area=0;while((v=a.length)>0){n.push(o=a[v-1]);n.area+=o.area;if(l!=="squarify"||(u=p(n,h))<=s){a.pop();s=u}else{n.area-=n.pop().area;d(n,h,r,false);h=Math.min(r.dx,r.dy);n.length=n.area=0;s=Infinity}}if(n.length){d(n,h,r,true);n.length=n.area=0}t.forEach(f)}}function h(e){var t=e.children;if(t&&t.length){var r=i(e),n=t.slice(),a,o=[];c(n,r.dx*r.dy/e.value);o.area=0;while(a=n.pop()){o.push(a);o.area+=a.area;if(a.z!=null){d(o,a.z?r.dx:r.dy,r,!n.length);o.length=o.area=0}}t.forEach(h)}}function p(e,t){var r=e.area,n,a=0,i=Infinity,o=-1,s=e.length;while(++o<s){if(!(n=e[o].area))continue;if(n<i)i=n;if(n>a)a=n}r*=r;t*=t;return r?Math.max(t*a*u/r,r/(t*i*u)):Infinity}function d(e,t,n,a){var i=-1,o=e.length,s=n.x,l=n.y,u=t?r(e.area/t):0,c;if(t==n.dx){if(a||u>n.dy)u=n.dy;while(++i<o){c=e[i];c.x=s;c.y=l;c.dy=u;s+=c.dx=Math.min(n.x+n.dx-s,u?r(c.area/u):0)}c.z=true;c.dx+=n.x+n.dx-s;n.y+=u;n.dy-=u}else{if(a||u>n.dx)u=n.dx;while(++i<o){c=e[i];c.x=s;c.y=l;c.dx=u;l+=c.dy=Math.min(n.y+n.dy-l,u?r(c.area/u):0)}c.z=false;c.dy+=n.y+n.dy-l;n.x+=u;n.dx-=u}}function v(t){var r=s||e(t),a=r[0];a.x=a.y=0;if(a.value)a.dx=n[0],a.dy=n[1];else a.dx=a.dy=0;if(s)e.revalue(a);c([a],a.dx*a.dy/a.value);(s?h:f)(a);if(o)s=r;return r}v.size=function(e){if(!arguments.length)return n;n=e;return v};v.padding=function(e){if(!arguments.length)return a;function t(t){var r=e.call(v,t,t.depth);return r==null?as(t):is(t,typeof r==="number"?[r,r,r,r]:r)}function r(t){return is(t,e)}var n;i=(a=e)==null?as:(n=typeof e)==="function"?t:n==="number"?(e=[e,e,e,e],r):r;return v};v.round=function(e){if(!arguments.length)return r!=Number;r=e?Math.round:Number;return v};v.sticky=function(e){if(!arguments.length)return o;o=e;s=null;return v};v.ratio=function(e){if(!arguments.length)return u;u=e;return v};v.mode=function(e){if(!arguments.length)return l;l=e+"";return v};return yo(v,e)};function as(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function is(e,t){var r=e.x+t[3],n=e.y+t[0],a=e.dx-t[1]-t[3],i=e.dy-t[0]-t[2];if(a<0){r+=a/2;a=0}if(i<0){n+=i/2;i=0}return{x:r,y:n,dx:a,dy:i}}t.random={normal:function(e,t){var r=arguments.length;if(r<2)t=1;if(r<1)e=0;return function(){var r,n,a;do{r=Math.random()*2-1;n=Math.random()*2-1;a=r*r+n*n}while(!a||a>1);return e+t*r*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var e=t.random.normal.apply(t,arguments);return function(){return Math.exp(e())}},bates:function(e){var r=t.random.irwinHall(e);return function(){return r()/e}},irwinHall:function(e){return function(){for(var t=0,r=0;r<e;r++)t+=Math.random();return t}}};t.scale={};function os(e){var t=e[0],r=e[e.length-1];return t<r?[t,r]:[r,t]}function ss(e){return e.rangeExtent?e.rangeExtent():os(e.range())}function ls(e,t,r,n){var a=r(e[0],e[1]),i=n(t[0],t[1]);return function(e){return i(a(e))}}function us(e,t){var r=0,n=e.length-1,a=e[r],i=e[n],o;if(i<a){o=r,r=n,n=o;o=a,a=i,i=o}e[r]=t.floor(a);e[n]=t.ceil(i);return e}function cs(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:fs}var fs={floor:P,ceil:P};function hs(e,r,n,a){var i=[],o=[],s=0,l=Math.min(e.length,r.length)-1;if(e[l]<e[0]){e=e.slice().reverse();r=r.slice().reverse()}while(++s<=l){i.push(n(e[s-1],e[s]));o.push(a(r[s-1],r[s]))}return function(r){var n=t.bisect(e,r,1,l)-1;return o[n](i[n](r))}}t.scale.linear=function(){return ps([0,1],[0,1],Ai,false)};function ps(e,t,r,n){var a,i;function o(){var o=Math.min(e.length,t.length)>2?hs:ls,l=n?io:ao;a=o(e,t,l,r);i=o(t,e,l,Ai);return s}function s(e){return a(e)}s.invert=function(e){return i(e)};s.domain=function(t){if(!arguments.length)return e;e=t.map(Number);return o()};s.range=function(e){if(!arguments.length)return t;t=e;return o()};s.rangeRound=function(e){return s.range(e).interpolate(Yi)};s.clamp=function(e){if(!arguments.length)return n;n=e;return o()};s.interpolate=function(e){if(!arguments.length)return r;r=e;return o()};s.ticks=function(t){return gs(e,t)};s.tickFormat=function(t,r){return ys(e,t,r)};s.nice=function(t){vs(e,t);return o()};s.copy=function(){return ps(e,t,r,n)};return o()}function ds(e,r){return t.rebind(e,r,"range","rangeRound","interpolate","clamp")}function vs(e,t){us(e,cs(ms(e,t)[2]));us(e,cs(ms(e,t)[2]));return e}function ms(e,t){if(t==null)t=10;var r=os(e),n=r[1]-r[0],a=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),i=t/n*a;if(i<=.15)a*=10;else if(i<=.35)a*=5;else if(i<=.75)a*=2;r[0]=Math.ceil(r[0]/a)*a;r[1]=Math.floor(r[1]/a)*a+a*.5;r[2]=a;return r}function gs(e,r){return t.range.apply(t,ms(e,r))}function ys(e,r,n){var a=ms(e,r);if(n){var i=Ht.exec(n);i.shift();if(i[8]==="s"){var o=t.formatPrefix(Math.max(x(a[0]),x(a[1])));if(!i[7])i[7]="."+_s(o.scale(a[2]));i[8]="f";n=t.format(i.join(""));return function(e){return n(o.scale(e))+o.symbol}}if(!i[7])i[7]="."+bs(i[8],a);n=i.join("")}else{n=",."+_s(a[2])+"f"}return t.format(n)}var xs={s:1,g:1,p:1,r:1,e:1};function _s(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function bs(e,t){var r=_s(t[2]);return e in xs?Math.abs(r-_s(Math.max(x(t[0]),x(t[1]))))+ +(e!=="e"):r-(e==="%")*2}t.scale.log=function(){return ws(t.scale.linear().domain([0,1]),10,true,[1,10])};function ws(e,r,n,a){function i(e){return(n?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(r)}function o(e){return n?Math.pow(r,e):-Math.pow(r,-e)}function s(t){return e(i(t))}s.invert=function(t){return o(e.invert(t))};s.domain=function(t){if(!arguments.length)return a;n=t[0]>=0;e.domain((a=t.map(Number)).map(i));return s};s.base=function(t){if(!arguments.length)return r;r=+t;e.domain(a.map(i));return s};s.nice=function(){var t=us(a.map(i),n?Math:ks);e.domain(t);a=t.map(o);return s};s.ticks=function(){var e=os(a),t=[],s=e[0],l=e[1],u=Math.floor(i(s)),c=Math.ceil(i(l)),f=r%1?2:r;if(isFinite(c-u)){if(n){for(;u<c;u++)for(var h=1;h<f;h++)t.push(o(u)*h);t.push(o(u))}else{t.push(o(u));for(;u++<c;)for(var h=f-1;h>0;h--)t.push(o(u)*h)}for(u=0;t[u]<s;u++){}for(c=t.length;t[c-1]>l;c--){}t=t.slice(u,c)}return t};s.tickFormat=function(e,n){if(!arguments.length)return Ts;if(arguments.length<2)n=Ts;else if(typeof n!=="function")n=t.format(n);var a=Math.max(1,r*e/s.ticks().length);return function(e){var t=e/o(Math.round(i(e)));if(t*r<r-.5)t*=r;return t<=a?n(e):""}};s.copy=function(){return ws(e.copy(),r,n,a)};return ds(s,e)}var Ts=t.format(".0e"),ks={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};t.scale.pow=function(){return As(t.scale.linear(),1,[0,1])};function As(e,t,r){var n=Ms(t),a=Ms(1/t);function i(t){return e(n(t))}i.invert=function(t){return a(e.invert(t))};i.domain=function(t){if(!arguments.length)return r;e.domain((r=t.map(Number)).map(n));return i};i.ticks=function(e){return gs(r,e)};i.tickFormat=function(e,t){return ys(r,e,t)};i.nice=function(e){return i.domain(vs(r,e))};i.exponent=function(o){if(!arguments.length)return t;n=Ms(t=o);a=Ms(1/t);e.domain(r.map(n));return i};i.copy=function(){return As(e.copy(),t,r)};return ds(i,e)}function Ms(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}t.scale.sqrt=function(){return t.scale.pow().exponent(.5)};t.scale.ordinal=function(){return Es([],{t:"range",a:[[]]})};function Es(e,r){var n,a,i;function o(t){return a[((n.get(t)||(r.t==="range"?n.set(t,e.push(t)):NaN))-1)%a.length]}function s(r,n){return t.range(e.length).map(function(e){return r+n*e})}o.domain=function(t){if(!arguments.length)return e;e=[];n=new w;var a=-1,i=t.length,s;while(++a<i)if(!n.has(s=t[a]))n.set(s,e.push(s));return o[r.t].apply(o,r.a)};o.range=function(e){if(!arguments.length)return a;a=e;i=0;r={t:"range",a:arguments};return o};o.rangePoints=function(t,n){if(arguments.length<2)n=0;var l=t[0],u=t[1],c=e.length<2?(l=(l+u)/2,0):(u-l)/(e.length-1+n);a=s(l+c*n/2,c);i=0;r={t:"rangePoints",a:arguments};return o};o.rangeRoundPoints=function(t,n){if(arguments.length<2)n=0;var l=t[0],u=t[1],c=e.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(e.length-1+n)|0;a=s(l+Math.round(c*n/2+(u-l-(e.length-1+n)*c)/2),c);i=0;r={t:"rangeRoundPoints",a:arguments};return o};o.rangeBands=function(t,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=(f-c)/(e.length-n+2*l);a=s(c+h*l,h);if(u)a.reverse();i=h*(1-n);r={t:"rangeBands",a:arguments};return o};o.rangeRoundBands=function(t,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=Math.floor((f-c)/(e.length-n+2*l));a=s(c+Math.round((f-c-(e.length-n)*h)/2),h);if(u)a.reverse();i=Math.round(h*(1-n));r={t:"rangeRoundBands",a:arguments};return o};o.rangeBand=function(){return i};o.rangeExtent=function(){return os(r.a[0])};o.copy=function(){return Es(e,r)};return o.domain(e)}t.scale.category10=function(){return t.scale.ordinal().range(Ss)};t.scale.category20=function(){return t.scale.ordinal().range(Cs)};t.scale.category20b=function(){return t.scale.ordinal().range(Ls)};t.scale.category20c=function(){return t.scale.ordinal().range(Is)};var Ss=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(vt);var Cs=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(vt);var Ls=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(vt);var Is=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(vt);t.scale.quantile=function(){return Os([],[])};function Os(e,r){var n;function a(){var a=0,o=r.length;n=[];while(++a<o)n[a-1]=t.quantile(e,a/o);return i}function i(e){if(!isNaN(e=+e))return r[t.bisect(n,e)]}i.domain=function(t){if(!arguments.length)return e;e=t.map(d).filter(v).sort(p);return a()};i.range=function(e){if(!arguments.length)return r;r=e;return a()};i.quantiles=function(){return n};i.invertExtent=function(t){t=r.indexOf(t);return t<0?[NaN,NaN]:[t>0?n[t-1]:e[0],t<n.length?n[t]:e[e.length-1]]};i.copy=function(){return Os(e,r)};return a()}t.scale.quantize=function(){return Ps(0,1,[0,1])};function Ps(e,t,r){var n,a;function i(t){return r[Math.max(0,Math.min(a,Math.floor(n*(t-e))))]}function o(){n=r.length/(t-e);a=r.length-1;return i}i.domain=function(r){if(!arguments.length)return[e,t];e=+r[0];t=+r[r.length-1];return o()};i.range=function(e){if(!arguments.length)return r;r=e;return o()};i.invertExtent=function(t){t=r.indexOf(t);t=t<0?NaN:t/n+e;return[t,t+1/n]};i.copy=function(){return Ps(e,t,r)};return o()}t.scale.threshold=function(){return Ds([.5],[0,1])};function Ds(e,r){function n(n){if(n<=n)return r[t.bisect(e,n)]}n.domain=function(t){if(!arguments.length)return e;e=t;return n};n.range=function(e){if(!arguments.length)return r;r=e;return n};n.invertExtent=function(t){t=r.indexOf(t);return[e[t-1],e[t]]};n.copy=function(){return Ds(e,r)};return n}t.scale.identity=function(){return Rs([0,1])};function Rs(e){function t(e){return+e}t.invert=t;t.domain=t.range=function(r){if(!arguments.length)return e;e=r.map(t);return t};t.ticks=function(t){return gs(e,t)};t.tickFormat=function(t,r){return ys(e,t,r)};t.copy=function(){return Rs(e)};return t}t.svg={};function zs(){return 0}t.svg.arc=function(){var e=Fs,t=Bs,r=zs,n=Ns,a=js,i=Us,o=Hs;function s(){var s=Math.max(0,+e.apply(this,arguments)),u=Math.max(0,+t.apply(this,arguments)),c=a.apply(this,arguments)-Oe,f=i.apply(this,arguments)-Oe,h=Math.abs(f-c),p=c>f?0:1;if(u<s)d=u,u=s,s=d;if(h>=Ie)return l(u,p)+(s?l(s,1-p):"")+"Z";var d,v,m,g,y=0,x=0,_,b,w,T,k,A,M,E,S=[];if(g=(+o.apply(this,arguments)||0)/2){m=n===Ns?Math.sqrt(s*s+u*u):+n.apply(this,arguments);if(!p)x*=-1;if(u)x=Fe(m/u*Math.sin(g));if(s)y=Fe(m/s*Math.sin(g))}if(u){_=u*Math.cos(c+x);b=u*Math.sin(c+x);w=u*Math.cos(f-x);T=u*Math.sin(f-x);var C=Math.abs(f-c-2*x)<=Ce?0:1;if(x&&Vs(_,b,w,T)===p^C){var L=(c+f)/2;_=u*Math.cos(L);b=u*Math.sin(L);w=T=null}}else{_=b=0}if(s){k=s*Math.cos(f-y);A=s*Math.sin(f-y);M=s*Math.cos(c+y);E=s*Math.sin(c+y);var I=Math.abs(c-f+2*y)<=Ce?0:1;if(y&&Vs(k,A,M,E)===1-p^I){var O=(c+f)/2;k=s*Math.cos(O);A=s*Math.sin(O);M=E=null}}else{k=A=0}if(h>Ee&&(d=Math.min(Math.abs(u-s)/2,+r.apply(this,arguments)))>.001){v=s<u^p?0:1;var P=d,D=d;if(h<Ce){var R=M==null?[k,A]:w==null?[_,b]:La([_,b],[M,E],[w,T],[k,A]),z=_-R[0],N=b-R[1],F=w-R[0],B=T-R[1],j=1/Math.sin(Math.acos((z*F+N*B)/(Math.sqrt(z*z+N*N)*Math.sqrt(F*F+B*B)))/2),U=Math.sqrt(R[0]*R[0]+R[1]*R[1]);D=Math.min(d,(s-U)/(j-1));P=Math.min(d,(u-U)/(j+1))}if(w!=null){var H=Gs(M==null?[k,A]:[M,E],[_,b],u,P,p),V=Gs([w,T],[k,A],u,P,p);if(d===P){S.push("M",H[0],"A",P,",",P," 0 0,",v," ",H[1],"A",u,",",u," 0 ",1-p^Vs(H[1][0],H[1][1],V[1][0],V[1][1]),",",p," ",V[1],"A",P,",",P," 0 0,",v," ",V[0])}else{S.push("M",H[0],"A",P,",",P," 0 1,",v," ",V[0])}}else{S.push("M",_,",",b)}if(M!=null){var G=Gs([_,b],[M,E],s,-D,p),q=Gs([k,A],w==null?[_,b]:[w,T],s,-D,p);if(d===D){S.push("L",q[0],"A",D,",",D," 0 0,",v," ",q[1],"A",s,",",s," 0 ",p^Vs(q[1][0],q[1][1],G[1][0],G[1][1]),",",1-p," ",G[1],"A",D,",",D," 0 0,",v," ",G[0])}else{S.push("L",q[0],"A",D,",",D," 0 0,",v," ",G[0])}}else{S.push("L",k,",",A)}}else{S.push("M",_,",",b);if(w!=null)S.push("A",u,",",u," 0 ",C,",",p," ",w,",",T);S.push("L",k,",",A);if(M!=null)S.push("A",s,",",s," 0 ",I,",",1-p," ",M,",",E)}S.push("Z");return S.join("")}function l(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}s.innerRadius=function(t){if(!arguments.length)return e;e=kt(t);return s};s.outerRadius=function(e){if(!arguments.length)return t;t=kt(e);return s};s.cornerRadius=function(e){if(!arguments.length)return r;r=kt(e);return s};s.padRadius=function(e){if(!arguments.length)return n;n=e==Ns?Ns:kt(e);return s};s.startAngle=function(e){if(!arguments.length)return a;a=kt(e);return s};s.endAngle=function(e){if(!arguments.length)return i;i=kt(e);return s};s.padAngle=function(e){if(!arguments.length)return o;o=kt(e);return s};s.centroid=function(){var r=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,n=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-Oe;return[Math.cos(n)*r,Math.sin(n)*r]};return s};var Ns="auto";function Fs(e){return e.innerRadius}function Bs(e){return e.outerRadius}function js(e){return e.startAngle}function Us(e){return e.endAngle}function Hs(e){return e&&e.padAngle}function Vs(e,t,r,n){return(e-r)*t-(t-n)*e>0?0:1}function Gs(e,t,r,n,a){var i=e[0]-t[0],o=e[1]-t[1],s=(a?n:-n)/Math.sqrt(i*i+o*o),l=s*o,u=-s*i,c=e[0]+l,f=e[1]+u,h=t[0]+l,p=t[1]+u,d=(c+h)/2,v=(f+p)/2,m=h-c,g=p-f,y=m*m+g*g,x=r-n,_=c*p-h*f,b=(g<0?-1:1)*Math.sqrt(Math.max(0,x*x*y-_*_)),w=(_*g-m*b)/y,T=(-_*m-g*b)/y,k=(_*g+m*b)/y,A=(-_*m+g*b)/y,M=w-d,E=T-v,S=k-d,C=A-v;if(M*M+E*E>S*S+C*C)w=k,T=A;return[[w-l,T-u],[w*r/x,T*r/x]]}function qs(e){var t=ka,r=Aa,n=sn,a=Ws,i=a.key,o=.7;function s(i){var s=[],l=[],u=-1,c=i.length,f,h=kt(t),p=kt(r);function d(){s.push("M",a(e(l),o))}while(++u<c){if(n.call(this,f=i[u],u)){l.push([+h.call(this,f,u),+p.call(this,f,u)])}else if(l.length){d();l=[]}}if(l.length)d();return s.length?s.join(""):null}s.x=function(e){if(!arguments.length)return t;t=e;return s};s.y=function(e){if(!arguments.length)return r;r=e;return s};s.defined=function(e){if(!arguments.length)return n;n=e;return s};s.interpolate=function(e){if(!arguments.length)return i;if(typeof e==="function")i=a=e;else i=(a=Ys.get(e)||Ws).key;return s};s.tension=function(e){if(!arguments.length)return o;o=e;return s};return s}t.svg.line=function(){return qs(P)};var Ys=t.map({linear:Ws,"linear-closed":Xs,step:Zs,"step-before":Ks,"step-after":Js,basis:nl,"basis-open":al,"basis-closed":il,bundle:ol,cardinal:el,"cardinal-open":Qs,"cardinal-closed":$s,monotone:vl});Ys.forEach(function(e,t){t.key=e;t.closed=/-closed$/.test(e)});function Ws(e){return e.length>1?e.join("L"):e+"Z"}function Xs(e){return e.join("L")+"Z"}function Zs(e){var t=0,r=e.length,n=e[0],a=[n[0],",",n[1]];while(++t<r)a.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);if(r>1)a.push("H",n[0]);return a.join("")}function Ks(e){var t=0,r=e.length,n=e[0],a=[n[0],",",n[1]];while(++t<r)a.push("V",(n=e[t])[1],"H",n[0]);return a.join("")}function Js(e){var t=0,r=e.length,n=e[0],a=[n[0],",",n[1]];while(++t<r)a.push("H",(n=e[t])[0],"V",n[1]);return a.join("")}function Qs(e,t){return e.length<4?Ws(e):e[1]+tl(e.slice(1,-1),rl(e,t))}function $s(e,t){return e.length<3?Xs(e):e[0]+tl((e.push(e[0]),e),rl([e[e.length-2]].concat(e,[e[1]]),t))}function el(e,t){return e.length<3?Ws(e):e[0]+tl(e,rl(e,t))}function tl(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2){return Ws(e)}var r=e.length!=t.length,n="",a=e[0],i=e[1],o=t[0],s=o,l=1;if(r){n+="Q"+(i[0]-o[0]*2/3)+","+(i[1]-o[1]*2/3)+","+i[0]+","+i[1];a=e[1];l=2}if(t.length>1){s=t[1];i=e[l];l++;n+="C"+(a[0]+o[0])+","+(a[1]+o[1])+","+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1];for(var u=2;u<t.length;u++,l++){i=e[l];s=t[u];n+="S"+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1]}}if(r){var c=e[l];n+="Q"+(i[0]+s[0]*2/3)+","+(i[1]+s[1]*2/3)+","+c[0]+","+c[1]}return n}function rl(e,t){var r=[],n=(1-t)/2,a,i=e[0],o=e[1],s=1,l=e.length;while(++s<l){a=i;i=o;o=e[s];r.push([n*(o[0]-a[0]),n*(o[1]-a[1])])}return r}function nl(e){if(e.length<3)return Ws(e);var t=1,r=e.length,n=e[0],a=n[0],i=n[1],o=[a,a,a,(n=e[1])[0]],s=[i,i,i,n[1]],l=[a,",",i,"L",sl(cl,o),",",sl(cl,s)];e.push(e[r-1]);while(++t<=r){n=e[t];o.shift();o.push(n[0]);s.shift();s.push(n[1]);fl(l,o,s)}e.pop();l.push("L",n);return l.join("")}function al(e){if(e.length<4)return Ws(e);var t=[],r=-1,n=e.length,a,i=[0],o=[0];while(++r<3){a=e[r];i.push(a[0]);o.push(a[1])}t.push(sl(cl,i)+","+sl(cl,o));--r;while(++r<n){a=e[r];i.shift();i.push(a[0]);o.shift();o.push(a[1]);fl(t,i,o)}return t.join("")}function il(e){var t,r=-1,n=e.length,a=n+4,i,o=[],s=[];while(++r<4){i=e[r%n];o.push(i[0]);s.push(i[1])}t=[sl(cl,o),",",sl(cl,s)];--r;while(++r<a){i=e[r%n];o.shift();o.push(i[0]);s.shift();s.push(i[1]);fl(t,o,s)}return t.join("")}function ol(e,t){var r=e.length-1;if(r){var n=e[0][0],a=e[0][1],i=e[r][0]-n,o=e[r][1]-a,s=-1,l,u;while(++s<=r){l=e[s];u=s/r;l[0]=t*l[0]+(1-t)*(n+u*i);l[1]=t*l[1]+(1-t)*(a+u*o)}}return nl(e)}function sl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}var ll=[0,2/3,1/3,0],ul=[0,1/3,2/3,0],cl=[0,1/6,2/3,1/6];function fl(e,t,r){e.push("C",sl(ll,t),",",sl(ll,r),",",sl(ul,t),",",sl(ul,r),",",sl(cl,t),",",sl(cl,r))}function hl(e,t){return(t[1]-e[1])/(t[0]-e[0])}function pl(e){var t=0,r=e.length-1,n=[],a=e[0],i=e[1],o=n[0]=hl(a,i);while(++t<r){n[t]=(o+(o=hl(a=i,i=e[t+1])))/2}n[t]=o;return n}function dl(e){var t=[],r,n,a,i,o=pl(e),s=-1,l=e.length-1;while(++s<l){r=hl(e[s],e[s+1]);if(x(r)<Ee){o[s]=o[s+1]=0}else{n=o[s]/r;a=o[s+1]/r;i=n*n+a*a;if(i>9){i=r*3/Math.sqrt(i);o[s]=i*n;o[s+1]=i*a}}}s=-1;while(++s<=l){i=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s]));t.push([i||0,o[s]*i||0])}return t}function vl(e){return e.length<3?Ws(e):e[0]+tl(e,dl(e))}t.svg.line.radial=function(){var e=qs(ml);e.radius=e.x,delete e.x;e.angle=e.y,delete e.y;return e};function ml(e){var t,r=-1,n=e.length,a,i;while(++r<n){t=e[r];a=t[0];i=t[1]-Oe;t[0]=a*Math.cos(i);t[1]=a*Math.sin(i)}return e}function gl(e){var t=ka,r=ka,n=0,a=Aa,i=sn,o=Ws,s=o.key,l=o,u="L",c=.7;function f(s){var f=[],h=[],p=[],d=-1,v=s.length,m,g=kt(t),y=kt(n),x=t===r?function(){return b}:kt(r),_=n===a?function(){return w}:kt(a),b,w;function T(){f.push("M",o(e(p),c),u,l(e(h.reverse()),c),"Z")}while(++d<v){if(i.call(this,m=s[d],d)){h.push([b=+g.call(this,m,d),w=+y.call(this,m,d)]);p.push([+x.call(this,m,d),+_.call(this,m,d)])}else if(h.length){T();h=[];p=[]}}if(h.length)T();return f.length?f.join(""):null}f.x=function(e){if(!arguments.length)return r;t=r=e;return f};f.x0=function(e){if(!arguments.length)return t;t=e;return f};f.x1=function(e){if(!arguments.length)return r;r=e;return f};f.y=function(e){if(!arguments.length)return a;n=a=e;return f};f.y0=function(e){if(!arguments.length)return n;n=e;return f};f.y1=function(e){if(!arguments.length)return a;a=e;return f};f.defined=function(e){if(!arguments.length)return i;i=e;return f};f.interpolate=function(e){if(!arguments.length)return s;if(typeof e==="function")s=o=e;else s=(o=Ys.get(e)||Ws).key;l=o.reverse||o;u=o.closed?"M":"L";return f};f.tension=function(e){if(!arguments.length)return c;c=e;return f};return f}Ks.reverse=Js;Js.reverse=Ks;t.svg.area=function(){return gl(P)};t.svg.area.radial=function(){var e=gl(ml);e.radius=e.x,delete e.x;e.innerRadius=e.x0,delete e.x0;e.outerRadius=e.x1,delete e.x1;e.angle=e.y,delete e.y;e.startAngle=e.y0,delete e.y0;e.endAngle=e.y1,delete e.y1;return e};t.svg.chord=function(){var e=sa,t=la,r=yl,n=js,a=Us;function i(r,n){var a=o(this,e,r,n),i=o(this,t,r,n);return"M"+a.p0+l(a.r,a.p1,a.a1-a.a0)+(s(a,i)?u(a.r,a.p1,a.r,a.p0):u(a.r,a.p1,i.r,i.p0)+l(i.r,i.p1,i.a1-i.a0)+u(i.r,i.p1,a.r,a.p0))+"Z"}function o(e,t,i,o){var s=t.call(e,i,o),l=r.call(e,s,o),u=n.call(e,s,o)-Oe,c=a.call(e,s,o)-Oe;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(e,t){return e.a0==t.a0&&e.a1==t.a1}function l(e,t,r){return"A"+e+","+e+" 0 "+ +(r>Ce)+",1 "+t}function u(e,t,r,n){return"Q 0,0 "+n}i.radius=function(e){if(!arguments.length)return r;r=kt(e);return i};i.source=function(t){if(!arguments.length)return e;e=kt(t);return i};i.target=function(e){if(!arguments.length)return t;t=kt(e);return i};i.startAngle=function(e){if(!arguments.length)return n;n=kt(e);return i};i.endAngle=function(e){if(!arguments.length)return a;a=kt(e);return i};return i};function yl(e){return e.radius}t.svg.diagonal=function(){var e=sa,t=la,r=xl;function n(n,a){var i=e.call(this,n,a),o=t.call(this,n,a),s=(i.y+o.y)/2,l=[i,{x:i.x,y:s},{x:o.x,y:s},o];l=l.map(r);return"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}n.source=function(t){if(!arguments.length)return e;e=kt(t);return n};n.target=function(e){if(!arguments.length)return t;t=kt(e);return n};n.projection=function(e){if(!arguments.length)return r;r=e;return n};return n};function xl(e){return[e.x,e.y]}t.svg.diagonal.radial=function(){var e=t.svg.diagonal(),r=xl,n=e.projection;e.projection=function(e){return arguments.length?n(_l(r=e)):r};return e};function _l(e){return function(){var t=e.apply(this,arguments),r=t[0],n=t[1]-Oe;return[r*Math.cos(n),r*Math.sin(n)]}}t.svg.symbol=function(){var e=wl,t=bl;function r(r,n){return(kl.get(e.call(this,r,n))||Tl)(t.call(this,r,n))}r.type=function(t){if(!arguments.length)return e;e=kt(t);return r};r.size=function(e){if(!arguments.length)return t;t=kt(e);return r};return r};function bl(){return 64}function wl(){return"circle"}function Tl(e){var t=Math.sqrt(e/Ce);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}var kl=t.map({circle:Tl,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Ml)),r=t*Ml;return"M0,"+-t+"L"+r+",0"+" 0,"+t+" "+-r+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Al),r=t*Al/2;return"M0,"+r+"L"+t+","+-r+" "+-t+","+-r+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Al),r=t*Al/2;return"M0,"+-r+"L"+t+","+r+" "+-t+","+r+"Z"}});t.svg.symbolTypes=kl.keys();var Al=Math.sqrt(3),Ml=Math.tan(30*Pe);Z.transition=function(e){var t=Ol||++Il,r=zl(e),n=[],a,i,o=Pl||{time:Date.now(),ease:Ri,delay:0,duration:250};for(var s=-1,l=this.length;++s<l;){n.push(a=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if(i=u[c])Nl(i,c,r,t,o);a.push(i)}}return Cl(n,r,t)};Z.interrupt=function(e){return this.each(e==null?El:Sl(zl(e)))};var El=Sl(zl());function Sl(e){return function(){var t,r,n;if((t=this[e])&&(n=t[r=t.active])){n.timer.c=null;n.timer.t=NaN;if(--t.count)delete t[r];else delete this[e];t.active+=.5;n.event&&n.event.interrupt.call(this,this.__data__,n.index)}}}function Cl(e,t,r){G(e,Ll);e.namespace=t;e.id=r;return e}var Ll=[],Il=0,Ol,Pl;Ll.call=Z.call;Ll.empty=Z.empty;Ll.node=Z.node;Ll.size=Z.size;t.transition=function(e,r){return e&&e.transition?Ol?e.transition(r):e:t.selection().transition(e)};t.transition.prototype=Ll;Ll.select=function(e){var t=this.id,r=this.namespace,n=[],a,i,o;e=K(e);for(var s=-1,l=this.length;++s<l;){n.push(a=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if((o=u[c])&&(i=e.call(o,o.__data__,c,s))){if("__data__"in o)i.__data__=o.__data__;Nl(i,c,r,t,o[r][t]);a.push(i)}else{a.push(null)}}}return Cl(n,r,t)};Ll.selectAll=function(e){var t=this.id,r=this.namespace,n=[],a,i,o,s,l;e=J(e);for(var u=-1,c=this.length;++u<c;){for(var f=this[u],h=-1,p=f.length;++h<p;){if(o=f[h]){l=o[r][t];i=e.call(o,o.__data__,h,u);n.push(a=[]);for(var d=-1,v=i.length;++d<v;){if(s=i[d])Nl(s,d,r,t,l);a.push(s)}}}}return Cl(n,r,t)};Ll.filter=function(e){var t=[],r,n,a;if(typeof e!=="function")e=fe(e);for(var i=0,o=this.length;i<o;i++){t.push(r=[]);for(var n=this[i],s=0,l=n.length;s<l;s++){if((a=n[s])&&e.call(a,a.__data__,s,i)){r.push(a)}}}return Cl(t,this.namespace,this.id)};Ll.tween=function(e,t){var r=this.id,n=this.namespace;if(arguments.length<2)return this.node()[n][r].tween.get(e);return pe(this,t==null?function(t){t[n][r].tween.remove(e)}:function(a){a[n][r].tween.set(e,t)})};function Dl(e,t,r,n){var a=e.id,i=e.namespace;return pe(e,typeof r==="function"?function(e,o,s){e[i][a].tween.set(t,n(r.call(e,e.__data__,o,s)))}:(r=n(r),function(e){e[i][a].tween.set(t,r)}))}Ll.attr=function(e,r){if(arguments.length<2){for(r in e)this.attr(r,e[r]);return this}var n=e=="transform"?no:Ai,a=t.ns.qualify(e);function i(){this.removeAttribute(a)}function o(){this.removeAttributeNS(a.space,a.local)}function s(e){return e==null?i:(e+="",function(){var t=this.getAttribute(a),r;return t!==e&&(r=n(t,e),function(e){this.setAttribute(a,r(e))})})}function l(e){return e==null?o:(e+="",function(){var t=this.getAttributeNS(a.space,a.local),r;return t!==e&&(r=n(t,e),function(e){this.setAttributeNS(a.space,a.local,r(e))})})}return Dl(this,"attr."+e,r,a.local?l:s)};Ll.attrTween=function(e,r){var n=t.ns.qualify(e);function a(e,t){var a=r.call(this,e,t,this.getAttribute(n));return a&&function(e){this.setAttribute(n,a(e))}}function i(e,t){var a=r.call(this,e,t,this.getAttributeNS(n.space,n.local));return a&&function(e){this.setAttributeNS(n.space,n.local,a(e))}}return this.tween("attr."+e,n.local?i:a)};Ll.style=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(r in e)this.style(r,e[r],t);return this}r=""}function a(){this.style.removeProperty(e)}function i(t){return t==null?a:(t+="",function(){var n=s(this).getComputedStyle(this,null).getPropertyValue(e),a;return n!==t&&(a=Ai(n,t),function(t){this.style.setProperty(e,a(t),r)})})}return Dl(this,"style."+e,t,i)};Ll.styleTween=function(e,t,r){if(arguments.length<3)r="";function n(n,a){var i=t.call(this,n,a,s(this).getComputedStyle(this,null).getPropertyValue(e));return i&&function(t){this.style.setProperty(e,i(t),r)}}return this.tween("style."+e,n)};Ll.text=function(e){return Dl(this,"text",e,Rl)};function Rl(e){if(e==null)e="";return function(){this.textContent=e}}Ll.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;if(this[e].count<2&&(t=this.parentNode))t.removeChild(this)})};Ll.ease=function(e){var r=this.id,n=this.namespace;if(arguments.length<1)return this.node()[n][r].ease;if(typeof e!=="function")e=t.ease.apply(t,arguments);return pe(this,function(t){t[n][r].ease=e})};Ll.delay=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].delay;return pe(this,typeof e==="function"?function(n,a,i){n[r][t].delay=+e.call(n,n.__data__,a,i)}:(e=+e,function(n){n[r][t].delay=e}))};Ll.duration=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].duration;return pe(this,typeof e==="function"?function(n,a,i){n[r][t].duration=Math.max(1,e.call(n,n.__data__,a,i))}:(e=Math.max(1,e),function(n){n[r][t].duration=e}))};Ll.each=function(e,r){var n=this.id,a=this.namespace;if(arguments.length<2){var i=Pl,o=Ol;try{Ol=n;pe(this,function(t,r,i){Pl=t[a][n];e.call(t,t.__data__,r,i)})}finally{Pl=i;Ol=o}}else{pe(this,function(i){var o=i[a][n];(o.event||(o.event=t.dispatch("start","end","interrupt"))).on(e,r)})}return this};Ll.transition=function(){var e=this.id,t=++Il,r=this.namespace,n=[],a,i,o,s;for(var l=0,u=this.length;l<u;l++){n.push(a=[]);for(var i=this[l],c=0,f=i.length;c<f;c++){if(o=i[c]){s=o[r][e];Nl(o,c,r,t,{time:s.time,ease:s.ease,delay:s.delay+s.duration,duration:s.duration})}a.push(o)}}return Cl(n,r,t)};function zl(e){return e==null?"__transition__":"__transition_"+e+"__"}function Nl(e,t,r,n,a){var i=e[r]||(e[r]={active:0,count:0}),o=i[n],s,l,u,c,f;function h(e){var t=o.delay;l.t=t+s;if(t<=e)return p(e-t);l.c=p}function p(r){var a=i.active,h=i[a];if(h){h.timer.c=null;h.timer.t=NaN;--i.count;delete i[a];h.event&&h.event.interrupt.call(e,e.__data__,h.index)}for(var p in i){if(+p<n){var v=i[p];v.timer.c=null;v.timer.t=NaN;--i.count;delete i[p]}}l.c=d;Dt(function(){if(l.c&&d(r||1)){l.c=null;l.t=NaN}return 1},0,s);i.active=n;o.event&&o.event.start.call(e,e.__data__,t);f=[];o.tween.forEach(function(r,n){if(n=n.call(e,e.__data__,t)){f.push(n)}});c=o.ease;u=o.duration}function d(a){var s=a/u,l=c(s),h=f.length;while(h>0){f[--h].call(e,l)}if(s>=1){o.event&&o.event.end.call(e,e.__data__,t);if(--i.count)delete i[n];else delete e[r];return 1}}if(!o){s=a.time;l=Dt(h,0,s);o=i[n]={tween:new w,time:s,timer:l,delay:a.delay,duration:a.duration,ease:a.ease,index:t};a=null;++i.count}}t.svg.axis=function(){var e=t.scale.linear(),r=Fl,n=6,i=6,o=3,s=[10],l=null,u;function c(a){a.each(function(){var a=t.select(this);var c=this.__chart__||e,f=this.__chart__=e.copy();var h=l==null?f.ticks?f.ticks.apply(f,s):f.domain():l,p=u==null?f.tickFormat?f.tickFormat.apply(f,s):P:u,d=a.selectAll(".tick").data(h,f),v=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Ee),m=t.transition(d.exit()).style("opacity",Ee).remove(),g=t.transition(d.order()).style("opacity",1),y=Math.max(n,0)+o,x;var _=ss(f),b=a.selectAll(".domain").data([0]),w=(b.enter().append("path").attr("class","domain"),t.transition(b));v.append("line");v.append("text");var T=v.select("line"),k=g.select("line"),A=d.select("text").text(p),M=v.select("text"),E=g.select("text"),S=r==="top"||r==="left"?-1:1,C,L,I,O;if(r==="bottom"||r==="top"){x=jl,C="x",I="y",L="x2",O="y2";A.attr("dy",S<0?"0em":".71em").style("text-anchor","middle");w.attr("d","M"+_[0]+","+S*i+"V0H"+_[1]+"V"+S*i)}else{x=Ul,C="y",I="x",L="y2",O="x2";A.attr("dy",".32em").style("text-anchor",S<0?"end":"start");w.attr("d","M"+S*i+","+_[0]+"H0V"+_[1]+"H"+S*i)}T.attr(O,S*n);M.attr(I,S*y);k.attr(L,0).attr(O,S*n);E.attr(C,0).attr(I,S*y);if(f.rangeBand){var D=f,R=D.rangeBand()/2;c=f=function(e){return D(e)+R}}else if(c.rangeBand){c=f}else{m.call(x,f,c)}v.call(x,c,f);g.call(x,f,f)})}c.scale=function(t){if(!arguments.length)return e;e=t;return c};c.orient=function(e){if(!arguments.length)return r;r=e in Bl?e+"":Fl;return c};c.ticks=function(){if(!arguments.length)return s;s=a(arguments);return c};c.tickValues=function(e){if(!arguments.length)return l;l=e;return c};c.tickFormat=function(e){if(!arguments.length)return u;u=e;return c};c.tickSize=function(e){var t=arguments.length;if(!t)return n;n=+e;i=+arguments[t-1];return c};c.innerTickSize=function(e){if(!arguments.length)return n;n=+e;return c};c.outerTickSize=function(e){if(!arguments.length)return i;i=+e;return c};c.tickPadding=function(e){if(!arguments.length)return o;o=+e;return c};c.tickSubdivide=function(){return arguments.length&&c};return c};var Fl="bottom",Bl={top:1,right:1,bottom:1,left:1};function jl(e,t,r){e.attr("transform",function(e){var n=t(e);return"translate("+(isFinite(n)?n:r(e))+",0)"})}function Ul(e,t,r){e.attr("transform",function(e){var n=t(e);return"translate(0,"+(isFinite(n)?n:r(e))+")"})}t.svg.brush=function(){var e=H(h,"brushstart","brush","brushend"),r=null,n=null,a=[0,0],i=[0,0],o,l,u=true,c=true,f=Vl[0];function h(e){e.each(function(){var e=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",m).on("touchstart.brush",m);var a=e.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var i=e.selectAll(".resize").data(f,P);i.exit().remove();i.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Hl[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");i.style("display",h.empty()?"none":null);var o=t.transition(e),s=t.transition(a),l;if(r){l=ss(r);s.attr("x",l[0]).attr("width",l[1]-l[0]);d(o)}if(n){l=ss(n);s.attr("y",l[0]).attr("height",l[1]-l[0]);v(o)}p(o)})}h.event=function(r){r.each(function(){var r=e.of(this,arguments),n={x:a,y:i,i:o,j:l},s=this.__chart__||n;this.__chart__=n;if(Ol){t.select(this).transition().each("start.brush",function(){o=s.i;l=s.j;a=s.x;i=s.y;r({type:"brushstart"})}).tween("brush:brush",function(){var e=Mi(a,n.x),t=Mi(i,n.y);o=l=null;return function(o){a=n.x=e(o);i=n.y=t(o);r({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=n.i;l=n.j;r({type:"brush",mode:"resize"});r({type:"brushend"})})}else{r({type:"brushstart"});r({type:"brush",mode:"resize"});r({type:"brushend"})}})};function p(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+a[+/e$/.test(e)]+","+i[+/^s/.test(e)]+")"})}function d(e){e.select(".extent").attr("x",a[0]);e.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function v(e){e.select(".extent").attr("y",i[0]);e.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function m(){var f=this,m=t.select(t.event.target),g=e.of(f,arguments),y=t.select(f),x=m.datum(),_=!/^(n|s)$/.test(x)&&r,b=!/^(e|w)$/.test(x)&&n,w=m.classed("extent"),T=Te(f),k,A=t.mouse(f),M;var E=t.select(s(f)).on("keydown.brush",L).on("keyup.brush",I);if(t.event.changedTouches){E.on("touchmove.brush",O).on("touchend.brush",D)}else{E.on("mousemove.brush",O).on("mouseup.brush",D)}y.interrupt().selectAll("*").interrupt();if(w){A[0]=a[0]-A[0];A[1]=i[0]-A[1]}else if(x){var S=+/w$/.test(x),C=+/^n/.test(x);M=[a[1-S]-A[0],i[1-C]-A[1]];A[0]=a[S];A[1]=i[C]}else if(t.event.altKey)k=A.slice();y.style("pointer-events","none").selectAll(".resize").style("display",null);t.select("body").style("cursor",m.style("cursor"));g({type:"brushstart"});O();function L(){if(t.event.keyCode==32){if(!w){k=null;A[0]-=a[1];A[1]-=i[1];w=2}j()}}function I(){if(t.event.keyCode==32&&w==2){A[0]+=a[1];A[1]+=i[1];w=0;j()}}function O(){var e=t.mouse(f),o=false;if(M){e[0]+=M[0];e[1]+=M[1]}if(!w){if(t.event.altKey){if(!k)k=[(a[0]+a[1])/2,(i[0]+i[1])/2];A[0]=a[+(e[0]<k[0])];A[1]=i[+(e[1]<k[1])]}else k=null}if(_&&P(e,r,0)){d(y);o=true}if(b&&P(e,n,1)){v(y);o=true}if(o){p(y);g({type:"brush",mode:w?"move":"resize"})}}function P(e,t,r){var n=ss(t),s=n[0],f=n[1],h=A[r],p=r?i:a,d=p[1]-p[0],v,m;if(w){s-=h;f-=d+h}v=(r?c:u)?Math.max(s,Math.min(f,e[r])):e[r];if(w){m=(v+=h)+d}else{if(k)h=Math.max(s,Math.min(f,2*k[r]-v));if(h<v){m=v;v=h}else{m=h}}if(p[0]!=v||p[1]!=m){if(r)l=null;else o=null;p[0]=v;p[1]=m;return true}}function D(){O();y.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null);t.select("body").style("cursor",null);E.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);T();g({type:"brushend"})}}h.x=function(e){if(!arguments.length)return r;r=e;f=Vl[!r<<1|!n];return h};h.y=function(e){if(!arguments.length)return n;n=e;f=Vl[!r<<1|!n];return h};h.clamp=function(e){if(!arguments.length)return r&&n?[u,c]:r?u:n?c:null;if(r&&n)u=!!e[0],c=!!e[1];else if(r)u=!!e;else if(n)c=!!e;return h};h.extent=function(e){var t,s,u,c,f;if(!arguments.length){if(r){if(o){t=o[0],s=o[1]}else{t=a[0],s=a[1];if(r.invert)t=r.invert(t),s=r.invert(s);if(s<t)f=t,t=s,s=f}}if(n){if(l){u=l[0],c=l[1]}else{u=i[0],c=i[1];if(n.invert)u=n.invert(u),c=n.invert(c);if(c<u)f=u,u=c,c=f}}return r&&n?[[t,u],[s,c]]:r?[t,s]:n&&[u,c]}if(r){t=e[0],s=e[1];if(n)t=t[0],s=s[0];o=[t,s];if(r.invert)t=r(t),s=r(s);if(s<t)f=t,t=s,s=f;if(t!=a[0]||s!=a[1])a=[t,s]}if(n){u=e[0],c=e[1];if(r)u=u[1],c=c[1];l=[u,c];if(n.invert)u=n(u),c=n(c);if(c<u)f=u,u=c,c=f;if(u!=i[0]||c!=i[1])i=[u,c]}return h};h.clear=function(){if(!h.empty()){a=[0,0],i=[0,0];o=l=null}return h};h.empty=function(){return!!r&&a[0]==a[1]||!!n&&i[0]==i[1]};return t.rebind(h,e,"on")};var Hl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var Vl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var Gl=qt.format=br.timeFormat;var ql=Gl.utc;var Yl=ql("%Y-%m-%dT%H:%M:%S.%LZ");Gl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Wl:Yl;function Wl(e){return e.toISOString()}Wl.parse=function(e){var t=new Date(e);return isNaN(t)?null:t};Wl.toString=Yl.toString;qt.second=Zt(function(e){return new Yt(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()});qt.seconds=qt.second.range;qt.seconds.utc=qt.second.utc.range;qt.minute=Zt(function(e){return new Yt(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()});qt.minutes=qt.minute.range;qt.minutes.utc=qt.minute.utc.range;qt.hour=Zt(function(e){var t=e.getTimezoneOffset()/60;return new Yt((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()});qt.hours=qt.hour.range;qt.hours.utc=qt.hour.utc.range;qt.month=Zt(function(e){e=qt.day(e);e.setDate(1);return e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()});qt.months=qt.month.range;qt.months.utc=qt.month.utc.range;function Xl(e,r,n){function a(t){return e(t)}a.invert=function(t){return Zl(e.invert(t))};a.domain=function(t){if(!arguments.length)return e.domain().map(Zl);e.domain(t);return a};function i(e,n){var a=e[1]-e[0],i=a/n,o=t.bisect(Kl,i);return o==Kl.length?[r.year,ms(e.map(function(e){return e/31536e6}),n)[2]]:!o?[$l,ms(e,n)[2]]:r[i/Kl[o-1]<Kl[o]/i?o-1:o]}a.nice=function(e,t){var r=a.domain(),n=os(r),o=e==null?i(n,10):typeof e==="number"&&i(n,e);if(o)e=o[0],t=o[1];function s(r){return!isNaN(r)&&!e.range(r,Zl(+r+1),t).length}return a.domain(us(r,t>1?{floor:function(t){while(s(t=e.floor(t)))t=Zl(t-1);return t},ceil:function(t){while(s(t=e.ceil(t)))t=Zl(+t+1);return t}}:e))};a.ticks=function(e,t){var r=os(a.domain()),n=e==null?i(r,10):typeof e==="number"?i(r,e):!e.range&&[{range:e},t];if(n)e=n[0],t=n[1];return e.range(r[0],Zl(+r[1]+1),t<1?1:t)};a.tickFormat=function(){return n};a.copy=function(){return Xl(e.copy(),r,n)};return ds(a,e)}function Zl(e){return new Date(e)}var Kl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6];var Jl=[[qt.second,1],[qt.second,5],[qt.second,15],[qt.second,30],[qt.minute,1],[qt.minute,5],[qt.minute,15],[qt.minute,30],[qt.hour,1],[qt.hour,3],[qt.hour,6],[qt.hour,12],[qt.day,1],[qt.day,2],[qt.week,1],[qt.month,1],[qt.month,3],[qt.year,1]];var Ql=Gl.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&e.getDate()!=1}],["%b %d",function(e){return e.getDate()!=1}],["%B",function(e){return e.getMonth()}],["%Y",sn]]);var $l={range:function(e,r,n){return t.range(Math.ceil(e/n)*n,+r,n).map(Zl)},floor:P,ceil:P};Jl.year=qt.year;qt.scale=function(){return Xl(t.scale.linear(),Jl,Ql)};var eu=Jl.map(function(e){return[e[0].utc,e[1]]});var tu=ql.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],["%b %d",function(e){return e.getUTCDate()!=1}],["%B",function(e){return e.getUTCMonth()}],["%Y",sn]]);eu.year=qt.year.utc;qt.scale.utc=function(){return Xl(t.scale.linear(),eu,tu)};t.text=At(function(e){return e.responseText});t.json=function(e,t){return Mt(e,"application/json",ru,t)};function ru(e){return JSON.parse(e.responseText)}t.html=function(e,t){return Mt(e,"text/html",nu,t)};function nu(e){var t=i.createRange();t.selectNode(i.body);return t.createContextualFragment(e.responseText)}t.xml=At(function(e){return e.responseXML});if(typeof e==="function"&&e.amd)this.d3=t,e(t);else if(typeof r==="object"&&r.exports)r.exports=t;else this.d3=t}()},{}],170:[function(e,t,r){t.exports=function(){for(var e=0;e<arguments.length;e++){if(arguments[e]!==undefined)return arguments[e]}}},{}],171:[function(e,t,r){"use strict";var n=e("incremental-convex-hull");var a=e("uniq");t.exports=l;function i(e,t){this.point=e;this.index=t}function o(e,t){var r=e.point;var n=t.point;var a=r.length;for(var i=0;i<a;++i){var o=n[i]-r[i];if(o){return o}}return 0}function s(e,t,r){if(e===1){if(r){return[[-1,0]]}else{return[]}}var n=t.map(function(e,t){return[e[0],t]});n.sort(function(e,t){return e[0]-t[0]});var a=new Array(e-1);for(var i=1;i<e;++i){var o=n[i-1];var s=n[i];a[i-1]=[o[1],s[1]]}if(r){a.push([-1,a[0][1]],[a[e-1][1],-1])}return a}function l(e,t){var r=e.length;if(r===0){return[]}var l=e[0].length;if(l<1){return[]}if(l===1){return s(r,e,t)}var u=new Array(r);var c=1;for(var f=0;f<r;++f){var h=e[f];var p=new Array(l+1);var d=0;for(var v=0;v<l;++v){var m=h[v];p[v]=m;d+=m*m}p[l]=d;u[f]=new i(p,f);c=Math.max(d,c)}a(u,o);r=u.length;var g=new Array(r+l+1);var y=new Array(r+l+1);var x=(l+1)*(l+1)*c;var _=new Array(l+1);for(var f=0;f<=l;++f){_[f]=0}_[l]=x;g[0]=_.slice();y[0]=-1;for(var f=0;f<=l;++f){var p=_.slice();p[f]=1;g[f+1]=p;y[f+1]=-1}for(var f=0;f<r;++f){var b=u[f];g[f+l+1]=b.point;y[f+l+1]=b.index}var w=n(g,false);if(t){w=w.filter(function(e){var t=0;for(var r=0;r<=l;++r){var n=y[e[r]];if(n<0){if(++t>=2){return false}}e[r]=n}return true})}else{w=w.filter(function(e){for(var t=0;t<=l;++t){var r=y[e[t]];if(r<0){return false}e[t]=r}return true})}if(l&1){for(var f=0;f<w.length;++f){var b=w[f];var p=b[0];b[0]=b[1];b[1]=p}}return w}},{"incremental-convex-hull":459,uniq:597}],172:[function(e,t,r){"use strict";t.exports=o;var n=o.canvas=document.createElement("canvas");var a=n.getContext("2d");var i=s([32,126]);o.createPairs=s;o.ascii=i;function o(e,t){if(Array.isArray(e))e=e.join(", ");var r={},n,o=16,l=.05;if(t){if(t.length===2&&typeof t[0]==="number"){n=s(t)}else if(Array.isArray(t)){n=t}else{if(t.o)n=s(t.o);else if(t.pairs)n=t.pairs;if(t.fontSize)o=t.fontSize;if(t.threshold!=null)l=t.threshold}}if(!n)n=i;a.font=o+"px "+e;for(var u=0;u<n.length;u++){var c=n[u];var f=a.measureText(c[0]).width+a.measureText(c[1]).width;var h=a.measureText(c).width;if(Math.abs(f-h)>o*l){var p=(h-f)/o;r[c]=p*1e3}}return r}function s(e){var t=[];for(var r=e[0];r<=e[1];r++){var n=String.fromCharCode(r);for(var a=e[0];a<e[1];a++){var i=String.fromCharCode(a);var o=n+i;t.push(o)}}return t}},{}],173:[function(e,t,r){(function(e){(function(){var r=false;if(typeof Float64Array!=="undefined"){var n=new Float64Array(1),a=new Uint32Array(n.buffer);n[0]=1;r=true;if(a[1]===1072693248){t.exports=function e(t){n[0]=t;return[a[0],a[1]]};function i(e,t){a[0]=e;a[1]=t;return n[0]}t.exports.pack=i;function o(e){n[0]=e;return a[0]}t.exports.lo=o;function s(e){n[0]=e;return a[1]}t.exports.hi=s}else if(a[0]===1072693248){t.exports=function e(t){n[0]=t;return[a[1],a[0]]};function l(e,t){a[1]=e;a[0]=t;return n[0]}t.exports.pack=l;function u(e){n[0]=e;return a[1]}t.exports.lo=u;function c(e){n[0]=e;return a[0]}t.exports.hi=c}else{r=false}}if(!r){var f=new e(8);t.exports=function e(t){f.writeDoubleLE(t,0,true);return[f.readUInt32LE(0,true),f.readUInt32LE(4,true)]};function h(e,t){f.writeUInt32LE(e,0,true);f.writeUInt32LE(t,4,true);return f.readDoubleLE(0,true)}t.exports.pack=h;function p(e){f.writeDoubleLE(e,0,true);return f.readUInt32LE(0,true)}t.exports.lo=p;function d(e){f.writeDoubleLE(e,0,true);return f.readUInt32LE(4,true)}t.exports.hi=d}t.exports.sign=function(e){return t.exports.hi(e)>>>31};t.exports.exponent=function(e){var r=t.exports.hi(e);return(r<<1>>>21)-1023};t.exports.fraction=function(e){var r=t.exports.lo(e);var n=t.exports.hi(e);var a=n&(1<<20)-1;if(n&2146435072){a+=1<<20}return[r,a]};t.exports.denormalized=function(e){var r=t.exports.hi(e);return!(r&2146435072)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:111}],174:[function(e,t,r){var n=e("abs-svg-path");var a=e("normalize-svg-path");var i={M:"moveTo",C:"bezierCurveTo"};t.exports=function(e,t){e.beginPath();a(n(t)).forEach(function(t){var r=t[0];var n=t.slice(1);e[i[r]].apply(e,n)});e.closePath()}},{"abs-svg-path":65,"normalize-svg-path":497}],175:[function(e,t,r){t.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],176:[function(e,t,r){"use strict";function n(e,t,r){var a=e[r]|0;if(a<=0){return[]}var i=new Array(a),o;if(r===e.length-1){for(o=0;o<a;++o){i[o]=t}}else{for(o=0;o<a;++o){i[o]=n(e,t,r+1)}}return i}function a(e,t){var r,n;r=new Array(e);for(n=0;n<e;++n){r[n]=t}return r}function i(e,t){if(typeof t==="undefined"){t=0}switch(typeof e){case"number":if(e>0){return a(e|0,t)}break;case"object":if(typeof e.length==="number"){return n(e,t,0)}break}return[]}t.exports=i},{}],177:[function(e,t,r){"use strict";t.exports=n;t.exports.default=n;function n(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,s=a(e,0,i,r,true),l=[];if(!s||s.next===s.prev)return l;var u,c,h,p,d,v,m;if(n)s=f(e,t,s,r);if(e.length>80*r){u=h=e[0];c=p=e[1];for(var g=r;g<i;g+=r){d=e[g];v=e[g+1];if(d<u)u=d;if(v<c)c=v;if(d>h)h=d;if(v>p)p=v}m=Math.max(h-u,p-c);m=m!==0?1/m:0}o(s,l,r,u,c,m);return l}function a(e,t,r,n,a){var i,o;if(a===D(e,t,r,n)>0){for(i=t;i<r;i+=n)o=I(i,e[i],e[i+1],o)}else{for(i=r-n;i>=t;i-=n)o=I(i,e[i],e[i+1],o)}if(o&&T(o,o.next)){O(o);o=o.next}return o}function i(e,t){if(!e)return e;if(!t)t=e;var r=e,n;do{n=false;if(!r.steiner&&(T(r,r.next)||w(r.prev,r,r.next)===0)){O(r);r=t=r.prev;if(r===r.next)break;n=true}else{r=r.next}}while(n||r!==t);return t}function o(e,t,r,n,a,f,h){if(!e)return;if(!h&&f)m(e,n,a,f);var p=e,d,v;while(e.prev!==e.next){d=e.prev;v=e.next;if(f?l(e,n,a,f):s(e)){t.push(d.i/r);t.push(e.i/r);t.push(v.i/r);O(e);e=v.next;p=v.next;continue}e=v;if(e===p){if(!h){o(i(e),t,r,n,a,f,1)}else if(h===1){e=u(i(e),t,r);o(e,t,r,n,a,f,2)}else if(h===2){c(e,t,r,n,a,f)}break}}}function s(e){var t=e.prev,r=e,n=e.next;if(w(t,r,n)>=0)return false;var a=e.next.next;while(a!==e.prev){if(_(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&w(a.prev,a,a.next)>=0)return false;a=a.next}return true}function l(e,t,r,n){var a=e.prev,i=e,o=e.next;if(w(a,i,o)>=0)return false;var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,l=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,u=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,c=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y;var f=y(s,l,t,r,n),h=y(u,c,t,r,n);var p=e.prevZ,d=e.nextZ;while(p&&p.z>=f&&d&&d.z<=h){if(p!==e.prev&&p!==e.next&&_(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return false;p=p.prevZ;if(d!==e.prev&&d!==e.next&&_(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return false;d=d.nextZ}while(p&&p.z>=f){if(p!==e.prev&&p!==e.next&&_(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return false;p=p.prevZ}while(d&&d.z<=h){if(d!==e.prev&&d!==e.next&&_(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return false;d=d.nextZ}return true}function u(e,t,r){var n=e;do{var a=n.prev,o=n.next.next;if(!T(a,o)&&k(a,n,n.next,o)&&S(a,o)&&S(o,a)){t.push(a.i/r);t.push(n.i/r);t.push(o.i/r);O(n);O(n.next);n=e=o}n=n.next}while(n!==e);return i(n)}function c(e,t,r,n,a,s){var l=e;do{var u=l.next.next;while(u!==l.prev){if(l.i!==u.i&&b(l,u)){var c=L(l,u);l=i(l,l.next);c=i(c,c.next);o(l,t,r,n,a,s);o(c,t,r,n,a,s);return}u=u.next}l=l.next}while(l!==e)}function f(e,t,r,n){var o=[],s,l,u,c,f;for(s=0,l=t.length;s<l;s++){u=t[s]*n;c=s<l-1?t[s+1]*n:e.length;f=a(e,u,c,n,false);if(f===f.next)f.steiner=true;o.push(x(f))}o.sort(h);for(s=0;s<o.length;s++){p(o[s],r);r=i(r,r.next)}return r}function h(e,t){return e.x-t.x}function p(e,t){t=d(e,t);if(t){var r=L(t,e);i(t,t.next);i(r,r.next)}}function d(e,t){var r=t,n=e.x,a=e.y,i=-Infinity,o;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>i){i=s;if(s===n){if(a===r.y)return r;if(a===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(n===i)return o;var l=o,u=o.x,c=o.y,f=Infinity,h;r=o;do{if(n>=r.x&&r.x>=u&&n!==r.x&&_(a<c?n:i,a,u,c,a<c?i:n,a,r.x,r.y)){h=Math.abs(a-r.y)/(n-r.x);if(S(r,e)&&(h<f||h===f&&(r.x>o.x||r.x===o.x&&v(o,r)))){o=r;f=h}}r=r.next}while(r!==l);return o}function v(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function m(e,t,r,n){var a=e;do{if(a.z===null)a.z=y(a.x,a.y,t,r,n);a.prevZ=a.prev;a.nextZ=a.next;a=a.next}while(a!==e);a.prevZ.nextZ=null;a.prevZ=null;g(a)}function g(e){var t,r,n,a,i,o,s,l,u=1;do{r=e;e=null;i=null;o=0;while(r){o++;n=r;s=0;for(t=0;t<u;t++){s++;n=n.nextZ;if(!n)break}l=u;while(s>0||l>0&&n){if(s!==0&&(l===0||!n||r.z<=n.z)){a=r;r=r.nextZ;s--}else{a=n;n=n.nextZ;l--}if(i)i.nextZ=a;else e=a;a.prevZ=i;i=a}r=n}i.nextZ=null;u*=2}while(o>1);return e}function y(e,t,r,n,a){e=32767*(e-r)*a;t=32767*(t-n)*a;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function x(e){var t=e,r=e;do{if(t.x<r.x||t.x===r.x&&t.y<r.y)r=t;t=t.next}while(t!==e);return r}function _(e,t,r,n,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function b(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!E(e,t)&&(S(e,t)&&S(t,e)&&C(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||T(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function T(e,t){return e.x===t.x&&e.y===t.y}function k(e,t,r,n){var a=M(w(e,t,r));var i=M(w(e,t,n));var o=M(w(r,n,e));var s=M(w(r,n,t));if(a!==i&&o!==s)return true;if(a===0&&A(e,r,t))return true;if(i===0&&A(e,n,t))return true;if(o===0&&A(r,e,n))return true;if(s===0&&A(r,t,n))return true;return false}function A(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function M(e){return e>0?1:e<0?-1:0}function E(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&k(r,r.next,e,t))return true;r=r.next}while(r!==e);return false}function S(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function C(e,t){var r=e,n=false,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{if(r.y>i!==r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x)n=!n;r=r.next}while(r!==e);return n}function L(e,t){var r=new P(e.i,e.x,e.y),n=new P(t.i,t.x,t.y),a=e.next,i=t.prev;e.next=t;t.prev=e;r.next=a;a.prev=r;n.next=r;r.prev=n;i.next=n;n.prev=i;return n}function I(e,t,r,n){var a=new P(e,t,r);if(!n){a.prev=a;a.next=a}else{a.next=n.next;a.prev=n;n.next.prev=a;n.next=a}return a}function O(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ)e.prevZ.nextZ=e.nextZ;if(e.nextZ)e.nextZ.prevZ=e.prevZ}function P(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}n.deviation=function(e,t,r,n){var a=t&&t.length;var i=a?t[0]*r:e.length;var o=Math.abs(D(e,0,i,r));if(a){for(var s=0,l=t.length;s<l;s++){var u=t[s]*r;var c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(D(e,u,c,r))}}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r;var p=n[s+1]*r;var d=n[s+2]*r;f+=Math.abs((e[h]-e[d])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[d+1]-e[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function D(e,t,r,n){var a=0;for(var i=t,o=r-n;i<r;i+=n){a+=(e[o]-e[i])*(e[i+1]+e[o+1]);o=i}return a}n.flatten=function(e){var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0;for(var a=0;a<e.length;a++){for(var i=0;i<e[a].length;i++){for(var o=0;o<t;o++)r.vertices.push(e[a][i][o])}if(a>0){n+=e[a-1].length;r.holes.push(n)}}return r}},{}],178:[function(e,t,r){"use strict";t.exports=a;var n=e("uniq");function a(e,t){var r=e.length;if(typeof t!=="number"){t=0;for(var a=0;a<r;++a){var i=e[a];t=Math.max(t,i[0],i[1])}t=(t|0)+1}t=t|0;var o=new Array(t);for(var a=0;a<t;++a){o[a]=[]}for(var a=0;a<r;++a){var i=e[a];o[i[0]].push(i[1]);o[i[1]].push(i[0])}for(var s=0;s<t;++s){n(o[s],function(e,t){return e-t})}return o}},{uniq:597}],179:[function(e,t,r){var n=e("strongly-connected-components");t.exports=function e(t,r){var a=[];var i=[];var o=[];var s={};var l=[];var u;function c(e){o[e]=false;if(s.hasOwnProperty(e)){Object.keys(s[e]).forEach(function(t){delete s[e][t];if(o[t]){c(t)}})}}function f(e){var t=false;i.push(e);o[e]=true;var r;var n;for(r=0;r<l[e].length;r++){n=l[e][r];if(n===u){h(u,i);t=true}else if(!o[n]){t=f(n)}}if(t){c(e)}else{for(r=0;r<l[e].length;r++){n=l[e][r];var a=s[n];if(!a){a={};s[n]=a}a[n]=true}}i.pop();return t}function h(e,t){var n=[].concat(t).concat(e);if(r){r(f)}else{a.push(n)}}function p(e){for(var r=0;r<t.length;r++){if(r<e)t[r]=[];t[r]=t[r].filter(function(t){return t>=e})}}function d(e){p(e);var r=t;var a=n(r);var i=a.components.filter(function(e){return e.length>1});var o=Infinity;var s;for(var l=0;l<i.length;l++){for(var u=0;u<i[l].length;u++){if(i[l][u]<o){o=i[l][u];s=l}}}var c=i[s];if(!c)return false;var f=t.map(function(e,t){if(c.indexOf(t)===-1)return[];return e.filter(function(e){return c.indexOf(e)!==-1})});return{leastVertex:o,adjList:f}}u=0;var v=t.length;while(u<v){var m=d(u);u=m.leastVertex;l=m.adjList;if(l){for(var g=0;g<l.length;g++){for(var y=0;y<l[g].length;y++){var x=l[g][y];o[+x]=false;s[x]={}}}f(u);u=u+1}else{u=v}}if(r){return}else{return a}}},{"strongly-connected-components":569}],180:[function(e,t,r){"use strict";var n=e("../../object/valid-value");t.exports=function(){n(this).length=0;return this}},{"../../object/valid-value":211}],181:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Array.from:e("./shim")},{"./is-implemented":182,"./shim":183}],182:[function(e,t,r){"use strict";t.exports=function(){var e=Array.from,t,r;if(typeof e!=="function")return false;t=["raz","dwa"];r=e(t);return Boolean(r&&r!==t&&r[1]==="dwa")}},{}],183:[function(e,t,r){"use strict";var n=e("es6-symbol").iterator,a=e("../../function/is-arguments"),i=e("../../function/is-function"),o=e("../../number/to-pos-integer"),s=e("../../object/valid-callable"),l=e("../../object/valid-value"),u=e("../../object/is-value"),c=e("../../string/is-string"),f=Array.isArray,h=Function.prototype.call,p={configurable:true,enumerable:true,writable:true,value:null},d=Object.defineProperty;t.exports=function(e){var t=arguments[1],r=arguments[2],v,m,g,y,x,_,b,w,T,k;e=Object(l(e));if(u(t))s(t);if(!this||this===Array||!i(this)){if(!t){if(a(e)){x=e.length;if(x!==1)return Array.apply(null,e);y=new Array(1);y[0]=e[0];return y}if(f(e)){y=new Array(x=e.length);for(m=0;m<x;++m)y[m]=e[m];return y}}y=[]}else{v=this}if(!f(e)){if((T=e[n])!==undefined){b=s(T).call(e);if(v)y=new v;w=b.next();m=0;while(!w.done){k=t?h.call(t,r,w.value,m):w.value;if(v){p.value=k;d(y,m,p)}else{y[m]=k}w=b.next();++m}x=m}else if(c(e)){x=e.length;if(v)y=new v;for(m=0,g=0;m<x;++m){k=e[m];if(m+1<x){_=k.charCodeAt(0);if(_>=55296&&_<=56319)k+=e[++m]}k=t?h.call(t,r,k,g):k;if(v){p.value=k;d(y,g,p)}else{y[g]=k}++g}x=g}}if(x===undefined){x=o(e.length);if(v)y=new v(x);for(m=0;m<x;++m){k=t?h.call(t,r,e[m],m):e[m];if(v){p.value=k;d(y,m,p)}else{y[m]=k}}}if(v){p.value=null;y.length=x}return y}},{"../../function/is-arguments":184,"../../function/is-function":185,"../../number/to-pos-integer":191,"../../object/is-value":200,"../../object/valid-callable":209,"../../object/valid-value":211,"../../string/is-string":215,"es6-symbol":225}],184:[function(e,t,r){"use strict";var n=Object.prototype.toString,a=n.call(function(){return arguments}());t.exports=function(e){return n.call(e)===a}},{}],185:[function(e,t,r){"use strict";var n=Object.prototype.toString,a=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);t.exports=function(e){return typeof e==="function"&&a(n.call(e))}},{}],186:[function(e,t,r){"use strict";t.exports=function(){}},{}],187:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Math.sign:e("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(e,t,r){"use strict";t.exports=function(){var e=Math.sign;if(typeof e!=="function")return false;return e(10)===1&&e(-20)===-1}},{}],189:[function(e,t,r){"use strict";t.exports=function(e){e=Number(e);if(isNaN(e)||e===0)return e;return e>0?1:-1}},{}],190:[function(e,t,r){"use strict";var n=e("../math/sign"),a=Math.abs,i=Math.floor;t.exports=function(e){if(isNaN(e))return 0;e=Number(e);if(e===0||!isFinite(e))return e;return n(e)*i(a(e))}},{"../math/sign":187}],191:[function(e,t,r){"use strict";var n=e("./to-integer"),a=Math.max;t.exports=function(e){return a(0,n(e))}},{"./to-integer":190}],192:[function(e,t,r){"use strict";var n=e("./valid-callable"),a=e("./valid-value"),i=Function.prototype.bind,o=Function.prototype.call,s=Object.keys,l=Object.prototype.propertyIsEnumerable;t.exports=function(e,t){return function(r,u){var c,f=arguments[2],h=arguments[3];r=Object(a(r));n(u);c=s(r);if(h){c.sort(typeof h==="function"?i.call(h,r):undefined)}if(typeof e!=="function")e=c[e];return o.call(e,c,function(e,n){if(!l.call(r,e))return t;return o.call(u,f,r[e],e,r,n)})}}},{"./valid-callable":209,"./valid-value":211}],193:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(e,t,r){"use strict";t.exports=function(){var e=Object.assign,t;if(typeof e!=="function")return false;t={foo:"raz"};e(t,{bar:"dwa"},{trzy:"trzy"});return t.foo+t.bar+t.trzy==="razdwatrzy"}},{}],195:[function(e,t,r){"use strict";var n=e("../keys"),a=e("../valid-value"),i=Math.max;t.exports=function(e,t){var r,o,s=i(arguments.length,2),l;e=Object(a(e));l=function(n){try{e[n]=t[n]}catch(e){if(!r)r=e}};for(o=1;o<s;++o){t=arguments[o];n(t).forEach(l)}if(r!==undefined)throw r;return e}},{"../keys":201,"../valid-value":211}],196:[function(e,t,r){"use strict";var n=e("../array/from"),a=e("./assign"),i=e("./valid-value");t.exports=function(e){var t=Object(i(e)),r=arguments[1],o=Object(arguments[2]);if(t!==e&&!r)return t;var s={};if(r){n(r,function(t){if(o.ensure||t in e)s[t]=e[t]})}else{a(s,e)}return s}},{"../array/from":181,"./assign":193,"./valid-value":211}],197:[function(e,t,r){"use strict";var n=Object.create,a;if(!e("./set-prototype-of/is-implemented")()){a=e("./set-prototype-of/shim")}t.exports=function(){var e,t,r;if(!a)return n;if(a.level!==1)return n;e={};t={};r={configurable:false,enumerable:false,writable:true,value:undefined};Object.getOwnPropertyNames(Object.prototype).forEach(function(e){if(e==="__proto__"){t[e]={configurable:true,enumerable:false,writable:true,value:undefined};return}t[e]=r});Object.defineProperties(e,t);Object.defineProperty(a,"nullPolyfill",{configurable:false,enumerable:false,writable:false,value:e});return function(t,r){return n(t===null?e:t,r)}}()},{"./set-prototype-of/is-implemented":207,"./set-prototype-of/shim":208}],198:[function(e,t,r){"use strict";t.exports=e("./_iterate")("forEach")},{"./_iterate":192}],199:[function(e,t,r){"use strict";var n=e("./is-value");var a={function:true,object:true};t.exports=function(e){return n(e)&&a[typeof e]||false}},{"./is-value":200}],200:[function(e,t,r){"use strict";var n=e("../function/noop")();t.exports=function(e){return e!==n&&e!==null}},{"../function/noop":186}],201:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":202,"./shim":203}],202:[function(e,t,r){"use strict";t.exports=function(){try{Object.keys("primitive");return true}catch(e){return false}}},{}],203:[function(e,t,r){"use strict";var n=e("../is-value");var a=Object.keys;t.exports=function(e){return a(n(e)?Object(e):e)}},{"../is-value":200}],204:[function(e,t,r){"use strict";var n=e("./valid-callable"),a=e("./for-each"),i=Function.prototype.call;t.exports=function(e,t){var r={},o=arguments[2];n(t);a(e,function(e,n,a,s){r[n]=i.call(t,o,e,n,a,s)});return r}},{"./for-each":198,"./valid-callable":209}],205:[function(e,t,r){"use strict";var n=e("./is-value");var a=Array.prototype.forEach,i=Object.create;var o=function(e,t){var r;for(r in e)t[r]=e[r]};t.exports=function(e){var t=i(null);a.call(arguments,function(e){if(!n(e))return;o(Object(e),t)});return t}},{"./is-value":200}],206:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.setPrototypeOf:e("./shim")},{"./is-implemented":207,"./shim":208}],207:[function(e,t,r){"use strict";var n=Object.create,a=Object.getPrototypeOf,i={};t.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||n;if(typeof e!=="function")return false;return a(e(t(null),i))===i}},{}],208:[function(e,t,r){"use strict";var n=e("../is-object"),a=e("../valid-value"),i=Object.prototype.isPrototypeOf,o=Object.defineProperty,s={configurable:true,enumerable:false,writable:true,value:undefined},l;l=function(e,t){a(e);if(t===null||n(t))return e;throw new TypeError("Prototype must be null or an object")};t.exports=function(e){var t,r;if(!e)return null;if(e.level===2){if(e.set){r=e.set;t=function(e,t){r.call(l(e,t),t);return e}}else{t=function(e,t){l(e,t).__proto__=t;return e}}}else{t=function e(t,r){var n;l(t,r);n=i.call(e.nullPolyfill,t);if(n)delete e.nullPolyfill.__proto__;if(r===null)r=e.nullPolyfill;t.__proto__=r;if(n)o(e.nullPolyfill,"__proto__",s);return t}}return Object.defineProperty(t,"level",{configurable:false,enumerable:false,writable:false,value:e.level})}(function(){var e=Object.create(null),t={},r,n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(n){try{r=n.set;r.call(e,t)}catch(e){}if(Object.getPrototypeOf(e)===t)return{set:r,level:2}}e.__proto__=t;if(Object.getPrototypeOf(e)===t)return{level:2};e={};e.__proto__=t;if(Object.getPrototypeOf(e)===t)return{level:1};return false}());e("../create")},{"../create":197,"../is-object":199,"../valid-value":211}],209:[function(e,t,r){"use strict";t.exports=function(e){if(typeof e!=="function")throw new TypeError(e+" is not a function");return e}},{}],210:[function(e,t,r){"use strict";var n=e("./is-object");t.exports=function(e){if(!n(e))throw new TypeError(e+" is not an Object");return e}},{"./is-object":199}],211:[function(e,t,r){"use strict";var n=e("./is-value");t.exports=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":200}],212:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(e,t,r){"use strict";var n="razdwatrzy";t.exports=function(){if(typeof n.contains!=="function")return false;return n.contains("dwa")===true&&n.contains("foo")===false}},{}],214:[function(e,t,r){"use strict";var n=String.prototype.indexOf;t.exports=function(e){return n.call(this,e,arguments[1])>-1}},{}],215:[function(e,t,r){"use strict";var n=Object.prototype.toString,a=n.call("");t.exports=function(e){return typeof e==="string"||e&&typeof e==="object"&&(e instanceof String||n.call(e)===a)||false}},{}],216:[function(e,t,r){"use strict";var n=Object.create(null),a=Math.random;t.exports=function(){var e;do{e=a().toString(36).slice(2)}while(n[e]);return e}},{}],217:[function(e,t,r){"use strict";var n=e("es5-ext/object/set-prototype-of"),a=e("es5-ext/string/#/contains"),i=e("d"),o=e("es6-symbol"),s=e("./");var l=Object.defineProperty,u;u=t.exports=function(e,t){if(!(this instanceof u))throw new TypeError("Constructor requires 'new'");s.call(this,e);if(!t)t="value";else if(a.call(t,"key+value"))t="key+value";else if(a.call(t,"key"))t="key";else t="value";l(this,"__kind__",i("",t))};if(n)n(u,s);delete u.prototype.constructor;u.prototype=Object.create(s.prototype,{_resolve:i(function(e){if(this.__kind__==="value")return this.__list__[e];if(this.__kind__==="key+value")return[e,this.__list__[e]];return e})});l(u.prototype,o.toStringTag,i("c","Array Iterator"))},{"./":220,d:155,"es5-ext/object/set-prototype-of":206,"es5-ext/string/#/contains":212,"es6-symbol":225}],218:[function(e,t,r){"use strict";var n=e("es5-ext/function/is-arguments"),a=e("es5-ext/object/valid-callable"),i=e("es5-ext/string/is-string"),o=e("./get");var s=Array.isArray,l=Function.prototype.call,u=Array.prototype.some;t.exports=function(e,t){var r,c=arguments[2],f,h,p,d,v,m,g;if(s(e)||n(e))r="array";else if(i(e))r="string";else e=o(e);a(t);h=function(){p=true};if(r==="array"){u.call(e,function(e){l.call(t,c,e,h);return p});return}if(r==="string"){v=e.length;for(d=0;d<v;++d){m=e[d];if(d+1<v){g=m.charCodeAt(0);if(g>=55296&&g<=56319)m+=e[++d]}l.call(t,c,m,h);if(p)break}return}f=e.next();while(!f.done){l.call(t,c,f.value,h);if(p)return;f=e.next()}}},{"./get":219,"es5-ext/function/is-arguments":184,"es5-ext/object/valid-callable":209,"es5-ext/string/is-string":215}],219:[function(e,t,r){"use strict";var n=e("es5-ext/function/is-arguments"),a=e("es5-ext/string/is-string"),i=e("./array"),o=e("./string"),s=e("./valid-iterable"),l=e("es6-symbol").iterator;t.exports=function(e){if(typeof s(e)[l]==="function")return e[l]();if(n(e))return new i(e);if(a(e))return new o(e);return new i(e)}},{"./array":217,"./string":222,"./valid-iterable":223,"es5-ext/function/is-arguments":184,"es5-ext/string/is-string":215,"es6-symbol":225}],220:[function(e,t,r){"use strict";var n=e("es5-ext/array/#/clear"),a=e("es5-ext/object/assign"),i=e("es5-ext/object/valid-callable"),o=e("es5-ext/object/valid-value"),s=e("d"),l=e("d/auto-bind"),u=e("es6-symbol");var c=Object.defineProperty,f=Object.defineProperties,h;t.exports=h=function(e,t){if(!(this instanceof h))throw new TypeError("Constructor requires 'new'");f(this,{__list__:s("w",o(e)),__context__:s("w",t),__nextIndex__:s("w",0)});if(!t)return;i(t.on);t.on("_add",this._onAdd);t.on("_delete",this._onDelete);t.on("_clear",this._onClear)};delete h.prototype.constructor;f(h.prototype,a({_next:s(function(){var e;if(!this.__list__)return undefined;if(this.__redo__){e=this.__redo__.shift();if(e!==undefined)return e}if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind();return undefined}),next:s(function(){return this._createResult(this._next())}),_createResult:s(function(e){if(e===undefined)return{done:true,value:undefined};return{done:false,value:this._resolve(e)}}),_resolve:s(function(e){return this.__list__[e]}),_unBind:s(function(){this.__list__=null;delete this.__redo__;if(!this.__context__)return;this.__context__.off("_add",this._onAdd);this.__context__.off("_delete",this._onDelete);this.__context__.off("_clear",this._onClear);this.__context__=null}),toString:s(function(){return"[object "+(this[u.toStringTag]||"Object")+"]"})},l({_onAdd:s(function(e){if(e>=this.__nextIndex__)return;++this.__nextIndex__;if(!this.__redo__){c(this,"__redo__",s("c",[e]));return}this.__redo__.forEach(function(t,r){if(t>=e)this.__redo__[r]=++t},this);this.__redo__.push(e)}),_onDelete:s(function(e){var t;if(e>=this.__nextIndex__)return;--this.__nextIndex__;if(!this.__redo__)return;t=this.__redo__.indexOf(e);if(t!==-1)this.__redo__.splice(t,1);this.__redo__.forEach(function(t,r){if(t>e)this.__redo__[r]=--t},this)}),_onClear:s(function(){if(this.__redo__)n.call(this.__redo__);this.__nextIndex__=0})})));c(h.prototype,u.iterator,s(function(){return this}))},{d:155,"d/auto-bind":154,"es5-ext/array/#/clear":180,"es5-ext/object/assign":193,"es5-ext/object/valid-callable":209,"es5-ext/object/valid-value":211,"es6-symbol":225}],221:[function(e,t,r){"use strict";var n=e("es5-ext/function/is-arguments"),a=e("es5-ext/object/is-value"),i=e("es5-ext/string/is-string");var o=e("es6-symbol").iterator,s=Array.isArray;t.exports=function(e){if(!a(e))return false;if(s(e))return true;if(i(e))return true;if(n(e))return true;return typeof e[o]==="function"}},{"es5-ext/function/is-arguments":184,"es5-ext/object/is-value":200,"es5-ext/string/is-string":215,"es6-symbol":225}],222:[function(e,t,r){"use strict";var n=e("es5-ext/object/set-prototype-of"),a=e("d"),i=e("es6-symbol"),o=e("./");var s=Object.defineProperty,l;l=t.exports=function(e){if(!(this instanceof l))throw new TypeError("Constructor requires 'new'");e=String(e);o.call(this,e);s(this,"__length__",a("",e.length))};if(n)n(l,o);delete l.prototype.constructor;l.prototype=Object.create(o.prototype,{_next:a(function(){if(!this.__list__)return undefined;if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind();return undefined}),_resolve:a(function(e){var t=this.__list__[e],r;if(this.__nextIndex__===this.__length__)return t;r=t.charCodeAt(0);if(r>=55296&&r<=56319)return t+this.__list__[this.__nextIndex__++];return t})});s(l.prototype,i.toStringTag,a("c","String Iterator"))},{"./":220,d:155,"es5-ext/object/set-prototype-of":206,"es6-symbol":225}],223:[function(e,t,r){"use strict";var n=e("./is-iterable");t.exports=function(e){if(!n(e))throw new TypeError(e+" is not iterable");return e}},{"./is-iterable":221}],224:[function(r,n,a){(function(t,i){(function(){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
(function(t,r){typeof a==="object"&&typeof n!=="undefined"?n.exports=r():typeof e==="function"&&e.amd?e(r):t.ES6Promise=r()})(this,function(){"use strict";function e(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}function n(e){return typeof e==="function"}var a=void 0;if(Array.isArray){a=Array.isArray}else{a=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}var o=a;var s=0;var l=void 0;var u=void 0;var c=function e(t,r){T[s]=t;T[s+1]=r;s+=2;if(s===2){if(u){u(k)}else{M()}}};function f(e){u=e}function h(e){c=e}var p=typeof window!=="undefined"?window:undefined;var d=p||{};var v=d.MutationObserver||d.WebKitMutationObserver;var m=typeof self==="undefined"&&typeof t!=="undefined"&&{}.toString.call(t)==="[object process]";var g=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function y(){return function(){return t.nextTick(k)}}function x(){if(typeof l!=="undefined"){return function(){l(k)}}return w()}function _(){var e=0;var t=new v(k);var r=document.createTextNode("");t.observe(r,{characterData:true});return function(){r.data=e=++e%2}}function b(){var e=new MessageChannel;e.port1.onmessage=k;return function(){return e.port2.postMessage(0)}}function w(){var e=setTimeout;return function(){return e(k,1)}}var T=new Array(1e3);function k(){for(var e=0;e<s;e+=2){var t=T[e];var r=T[e+1];t(r);T[e]=undefined;T[e+1]=undefined}s=0}function A(){try{var e=Function("return this")().require("vertx");l=e.runOnLoop||e.runOnContext;return x()}catch(e){return w()}}var M=void 0;if(m){M=y()}else if(v){M=_()}else if(g){M=b()}else if(p===undefined&&typeof r==="function"){M=A()}else{M=w()}function E(e,t){var r=this;var n=new this.constructor(L);if(n[C]===undefined){K(n)}var a=r._state;if(a){var i=arguments[a-1];c(function(){return Y(a,n,i,r._result)})}else{G(r,n,e,t)}return n}function S(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var r=new t(L);j(r,e);return r}var C=Math.random().toString(36).substring(2);function L(){}var I=void 0;var O=1;var P=2;function D(){return new TypeError("You cannot resolve a promise with itself")}function R(){return new TypeError("A promises callback cannot return that same promise.")}function z(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function N(e,t,r){c(function(e){var n=false;var a=z(r,t,function(r){if(n){return}n=true;if(t!==r){j(e,r)}else{H(e,r)}},function(t){if(n){return}n=true;V(e,t)},"Settle: "+(e._label||" unknown promise"));if(!n&&a){n=true;V(e,a)}},e)}function F(e,t){if(t._state===O){H(e,t._result)}else if(t._state===P){V(e,t._result)}else{G(t,undefined,function(t){return j(e,t)},function(t){return V(e,t)})}}function B(e,t,r){if(t.constructor===e.constructor&&r===E&&t.constructor.resolve===S){F(e,t)}else{if(r===undefined){H(e,t)}else if(n(r)){N(e,t,r)}else{H(e,t)}}}function j(t,r){if(t===r){V(t,D())}else if(e(r)){var n=void 0;try{n=r.then}catch(e){V(t,e);return}B(t,r,n)}else{H(t,r)}}function U(e){if(e._onerror){e._onerror(e._result)}q(e)}function H(e,t){if(e._state!==I){return}e._result=t;e._state=O;if(e._subscribers.length!==0){c(q,e)}}function V(e,t){if(e._state!==I){return}e._state=P;e._result=t;c(U,e)}function G(e,t,r,n){var a=e._subscribers;var i=a.length;e._onerror=null;a[i]=t;a[i+O]=r;a[i+P]=n;if(i===0&&e._state){c(q,e)}}function q(e){var t=e._subscribers;var r=e._state;if(t.length===0){return}var n=void 0,a=void 0,i=e._result;for(var o=0;o<t.length;o+=3){n=t[o];a=t[o+r];if(n){Y(r,n,a,i)}else{a(i)}}e._subscribers.length=0}function Y(e,t,r,a){var i=n(r),o=void 0,s=void 0,l=true;if(i){try{o=r(a)}catch(e){l=false;s=e}if(t===o){V(t,R());return}}else{o=a}if(t._state!==I){}else if(i&&l){j(t,o)}else if(l===false){V(t,s)}else if(e===O){H(t,o)}else if(e===P){V(t,o)}}function W(e,t){try{t(function t(r){j(e,r)},function t(r){V(e,r)})}catch(t){V(e,t)}}var X=0;function Z(){return X++}function K(e){e[C]=X++;e._state=undefined;e._result=undefined;e._subscribers=[]}function J(){return new Error("Array Methods must be provided an Array")}var Q=function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(L);if(!this.promise[C]){K(this.promise)}if(o(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){H(this.promise,this._result)}else{this.length=this.length||0;this._enumerate(t);if(this._remaining===0){H(this.promise,this._result)}}}else{V(this.promise,J())}}e.prototype._enumerate=function e(t){for(var r=0;this._state===I&&r<t.length;r++){this._eachEntry(t[r],r)}};e.prototype._eachEntry=function e(t,r){var n=this._instanceConstructor;var a=n.resolve;if(a===S){var i=void 0;var o=void 0;var s=false;try{i=t.then}catch(e){s=true;o=e}if(i===E&&t._state!==I){this._settledAt(t._state,r,t._result)}else if(typeof i!=="function"){this._remaining--;this._result[r]=t}else if(n===ae){var l=new n(L);if(s){V(l,o)}else{B(l,t,i)}this._willSettleAt(l,r)}else{this._willSettleAt(new n(function(e){return e(t)}),r)}}else{this._willSettleAt(a(t),r)}};e.prototype._settledAt=function e(t,r,n){var a=this.promise;if(a._state===I){this._remaining--;if(t===P){V(a,n)}else{this._result[r]=n}}if(this._remaining===0){H(a,this._result)}};e.prototype._willSettleAt=function e(t,r){var n=this;G(t,undefined,function(e){return n._settledAt(O,r,e)},function(e){return n._settledAt(P,r,e)})};return e}();function $(e){return new Q(this,e).promise}function ee(e){var t=this;if(!o(e)){return new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}else{return new t(function(r,n){var a=e.length;for(var i=0;i<a;i++){t.resolve(e[i]).then(r,n)}})}}function te(e){var t=this;var r=new t(L);V(r,e);return r}function re(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ne(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ae=function(){function e(t){this[C]=Z();this._result=this._state=undefined;this._subscribers=[];if(L!==t){typeof t!=="function"&&re();this instanceof e?W(this,t):ne()}}e.prototype.catch=function e(t){return this.then(null,t)};e.prototype.finally=function e(t){var r=this;var a=r.constructor;if(n(t)){return r.then(function(e){return a.resolve(t()).then(function(){return e})},function(e){return a.resolve(t()).then(function(){throw e})})}return r.then(t,t)};return e}();ae.prototype.then=E;ae.all=$;ae.race=ee;ae.resolve=S;ae.reject=te;ae._setScheduler=f;ae._setAsap=h;ae._asap=c;function ie(){var e=void 0;if(typeof i!=="undefined"){e=i}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if(r==="[object Promise]"&&!t.cast){return}}e.Promise=ae}ae.polyfill=ie;ae.Promise=ae;return ae})}).call(this)}).call(this,r("_process"),typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:526}],225:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?e("ext/global-this").Symbol:e("./polyfill")},{"./is-implemented":226,"./polyfill":231,"ext/global-this":238}],226:[function(e,t,r){"use strict";var n=e("ext/global-this"),a={object:true,symbol:true};t.exports=function(){var e=n.Symbol;var t;if(typeof e!=="function")return false;t=e("test symbol");try{String(t)}catch(e){return false}if(!a[typeof e.iterator])return false;if(!a[typeof e.toPrimitive])return false;if(!a[typeof e.toStringTag])return false;return true}},{"ext/global-this":238}],227:[function(e,t,r){"use strict";t.exports=function(e){if(!e)return false;if(typeof e==="symbol")return true;if(!e.constructor)return false;if(e.constructor.name!=="Symbol")return false;return e[e.constructor.toStringTag]==="Symbol"}},{}],228:[function(e,t,r){"use strict";var n=e("d");var a=Object.create,i=Object.defineProperty,o=Object.prototype;var s=a(null);t.exports=function(e){var t=0,r,a;while(s[e+(t||"")])++t;e+=t||"";s[e]=true;r="@@"+e;i(o,r,n.gs(null,function(e){if(a)return;a=true;i(this,r,n(e));a=false}));return r}},{d:155}],229:[function(e,t,r){"use strict";var n=e("d"),a=e("ext/global-this").Symbol;t.exports=function(e){return Object.defineProperties(e,{hasInstance:n("",a&&a.hasInstance||e("hasInstance")),isConcatSpreadable:n("",a&&a.isConcatSpreadable||e("isConcatSpreadable")),iterator:n("",a&&a.iterator||e("iterator")),match:n("",a&&a.match||e("match")),replace:n("",a&&a.replace||e("replace")),search:n("",a&&a.search||e("search")),species:n("",a&&a.species||e("species")),split:n("",a&&a.split||e("split")),toPrimitive:n("",a&&a.toPrimitive||e("toPrimitive")),toStringTag:n("",a&&a.toStringTag||e("toStringTag")),unscopables:n("",a&&a.unscopables||e("unscopables"))})}},{d:155,"ext/global-this":238}],230:[function(e,t,r){"use strict";var n=e("d"),a=e("../../../validate-symbol");var i=Object.create(null);t.exports=function(e){return Object.defineProperties(e,{for:n(function(t){if(i[t])return i[t];return i[t]=e(String(t))}),keyFor:n(function(e){var t;a(e);for(t in i){if(i[t]===e)return t}return undefined})})}},{"../../../validate-symbol":232,d:155}],231:[function(e,t,r){"use strict";var n=e("d"),a=e("./validate-symbol"),i=e("ext/global-this").Symbol,o=e("./lib/private/generate-name"),s=e("./lib/private/setup/standard-symbols"),l=e("./lib/private/setup/symbol-registry");var u=Object.create,c=Object.defineProperties,f=Object.defineProperty;var h,p,d;if(typeof i==="function"){try{String(i());d=true}catch(e){}}else{i=null}p=function e(t){if(this instanceof p)throw new TypeError("Symbol is not a constructor");return h(t)};t.exports=h=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");if(d)return i(t);r=u(p.prototype);t=t===undefined?"":String(t);return c(r,{__description__:n("",t),__name__:n("",o(t))})};s(h);l(h);c(p.prototype,{constructor:n(h),toString:n("",function(){return this.__name__})});c(h.prototype,{toString:n(function(){return"Symbol ("+a(this).__description__+")"}),valueOf:n(function(){return a(this)})});f(h.prototype,h.toPrimitive,n("",function(){var e=a(this);if(typeof e==="symbol")return e;return e.toString()}));f(h.prototype,h.toStringTag,n("c","Symbol"));f(p.prototype,h.toStringTag,n("c",h.prototype[h.toStringTag]));f(p.prototype,h.toPrimitive,n("c",h.prototype[h.toPrimitive]))},{"./lib/private/generate-name":228,"./lib/private/setup/standard-symbols":229,"./lib/private/setup/symbol-registry":230,"./validate-symbol":232,d:155,"ext/global-this":238}],232:[function(e,t,r){"use strict";var n=e("./is-symbol");t.exports=function(e){if(!n(e))throw new TypeError(e+" is not a symbol");return e}},{"./is-symbol":227}],233:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?WeakMap:e("./polyfill")},{"./is-implemented":234,"./polyfill":236}],234:[function(e,t,r){"use strict";t.exports=function(){var e,t;if(typeof WeakMap!=="function")return false;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(e){return false}if(String(e)!=="[object WeakMap]")return false;if(typeof e.set!=="function")return false;if(e.set({},1)!==e)return false;if(typeof e.delete!=="function")return false;if(typeof e.has!=="function")return false;if(e.get(t)!=="one")return false;return true}},{}],235:[function(e,t,r){"use strict";t.exports=function(){if(typeof WeakMap!=="function")return false;return Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],236:[function(e,t,r){"use strict";var n=e("es5-ext/object/is-value"),a=e("es5-ext/object/set-prototype-of"),i=e("es5-ext/object/valid-object"),o=e("es5-ext/object/valid-value"),s=e("es5-ext/string/random-uniq"),l=e("d"),u=e("es6-iterator/get"),c=e("es6-iterator/for-of"),f=e("es6-symbol").toStringTag,h=e("./is-native-implemented"),p=Array.isArray,d=Object.defineProperty,v=Object.prototype.hasOwnProperty,m=Object.getPrototypeOf,g;t.exports=g=function(){var e=arguments[0],t;if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");t=h&&a&&WeakMap!==g?a(new WeakMap,m(this)):this;if(n(e)){if(!p(e))e=u(e)}d(t,"__weakMapData__",l("c","$weakMap$"+s()));if(!e)return t;c(e,function(e){o(e);t.set(e[0],e[1])});return t};if(h){if(a)a(g,WeakMap);g.prototype=Object.create(WeakMap.prototype,{constructor:l(g)})}Object.defineProperties(g.prototype,{delete:l(function(e){if(v.call(i(e),this.__weakMapData__)){delete e[this.__weakMapData__];return true}return false}),get:l(function(e){if(!v.call(i(e),this.__weakMapData__))return undefined;return e[this.__weakMapData__]}),has:l(function(e){return v.call(i(e),this.__weakMapData__)}),set:l(function(e,t){d(i(e),this.__weakMapData__,l("c",t));return this}),toString:l(function(){return"[object WeakMap]"})});d(g.prototype,f,l("c","WeakMap"))},{"./is-native-implemented":235,d:155,"es5-ext/object/is-value":200,"es5-ext/object/set-prototype-of":206,"es5-ext/object/valid-object":210,"es5-ext/object/valid-value":211,"es5-ext/string/random-uniq":216,"es6-iterator/for-of":218,"es6-iterator/get":219,"es6-symbol":225}],237:[function(e,t,r){var n=function(){if(typeof self==="object"&&self)return self;if(typeof window==="object"&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:true})}catch(e){return n()}try{if(!__global__)return n();return __global__}finally{delete Object.prototype.__global__}}()},{}],238:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?globalThis:e("./implementation")},{"./implementation":237,"./is-implemented":239}],239:[function(e,t,r){"use strict";t.exports=function(){if(typeof globalThis!=="object")return false;if(!globalThis)return false;return globalThis.Array===Array}},{}],240:[function(e,t,r){"use strict";t.exports=n;function n(e,t,r){var n=t||0;var a=r||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[n*e[12]+e[8],n*e[13]+e[9],n*e[14]+e[10],n*e[15]+e[11]],[a*e[12]-e[8],a*e[13]-e[9],a*e[14]-e[10],a*e[15]-e[11]]]}},{}],241:[function(e,t,r){"use strict";var n=e("is-string-blank");t.exports=function(e){var t=typeof e;if(t==="string"){var r=e;e=+e;if(e===0&&n(r))return false}else if(t!=="number")return false;return e-e<1}},{"is-string-blank":470}],242:[function(e,t,r){"use strict";t.exports=u;var n=e("cubic-hermite");var a=e("binary-search-bounds");function i(e,t,r){return Math.min(t,Math.max(e,r))}function o(e,t,r){this.dimension=e.length;this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var n=0;n<this.dimension;++n){this.bounds[0][n]=-Infinity;this.bounds[1][n]=Infinity}this._state=e.slice().reverse();this._velocity=t.slice().reverse();this._time=[r];this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}var s=o.prototype;s.flush=function(e){var t=a.gt(this._time,e)-1;if(t<=0){return}this._time.splice(0,t);this._state.splice(0,t*this.dimension);this._velocity.splice(0,t*this.dimension)};s.curve=function(e){var t=this._time;var r=t.length;var o=a.le(t,e);var s=this._scratch[0];var l=this._state;var u=this._velocity;var c=this.dimension;var f=this.bounds;if(o<0){var h=c-1;for(var p=0;p<c;++p,--h){s[p]=l[h]}}else if(o>=r-1){var h=l.length-1;var d=e-t[r-1];for(var p=0;p<c;++p,--h){s[p]=l[h]+d*u[h]}}else{var h=c*(o+1)-1;var v=t[o];var m=t[o+1];var g=m-v||1;var y=this._scratch[1];var x=this._scratch[2];var _=this._scratch[3];var b=this._scratch[4];var w=true;for(var p=0;p<c;++p,--h){y[p]=l[h];_[p]=u[h]*g;x[p]=l[h+c];b[p]=u[h+c]*g;w=w&&(y[p]===x[p]&&_[p]===b[p]&&_[p]===0)}if(w){for(var p=0;p<c;++p){s[p]=y[p]}}else{n(y,_,x,b,(e-v)/g,s)}}var T=f[0];var k=f[1];for(var p=0;p<c;++p){s[p]=i(T[p],k[p],s[p])}return s};s.dcurve=function(e){var t=this._time;var r=t.length;var i=a.le(t,e);var o=this._scratch[0];var s=this._state;var l=this._velocity;var u=this.dimension;if(i>=r-1){var c=s.length-1;var f=e-t[r-1];for(var h=0;h<u;++h,--c){o[h]=l[c]}}else{var c=u*(i+1)-1;var p=t[i];var d=t[i+1];var v=d-p||1;var m=this._scratch[1];var g=this._scratch[2];var y=this._scratch[3];var x=this._scratch[4];var _=true;for(var h=0;h<u;++h,--c){m[h]=s[c];y[h]=l[c]*v;g[h]=s[c+u];x[h]=l[c+u]*v;_=_&&(m[h]===g[h]&&y[h]===x[h]&&y[h]===0)}if(_){for(var h=0;h<u;++h){o[h]=0}}else{n.derivative(m,y,g,x,(e-p)/v,o);for(var h=0;h<u;++h){o[h]/=v}}}return o};s.lastT=function(){var e=this._time;return e[e.length-1]};s.stable=function(){var e=this._velocity;var t=e.length;for(var r=this.dimension-1;r>=0;--r){if(e[--t]){return false}}return true};s.jump=function(e){var t=this.lastT();var r=this.dimension;if(e<t||arguments.length!==r+1){return}var n=this._state;var a=this._velocity;var o=n.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];this._time.push(t,e);for(var c=0;c<2;++c){for(var f=0;f<r;++f){n.push(n[o++]);a.push(0)}}this._time.push(e);for(var f=r;f>0;--f){n.push(i(l[f-1],u[f-1],arguments[f]));a.push(0)}};s.push=function(e){var t=this.lastT();var r=this.dimension;if(e<t||arguments.length!==r+1){return}var n=this._state;var a=this._velocity;var o=n.length-this.dimension;var s=e-t;var l=this.bounds;var u=l[0];var c=l[1];var f=s>1e-6?1/s:0;this._time.push(e);for(var h=r;h>0;--h){var p=i(u[h-1],c[h-1],arguments[h]);n.push(p);a.push((p-n[o++])*f)}};s.set=function(e){var t=this.dimension;if(e<this.lastT()||arguments.length!==t+1){return}var r=this._state;var n=this._velocity;var a=this.bounds;var o=a[0];var s=a[1];this._time.push(e);for(var l=t;l>0;--l){r.push(i(o[l-1],s[l-1],arguments[l]));n.push(0)}};s.move=function(e){var t=this.lastT();var r=this.dimension;if(e<=t||arguments.length!==r+1){return}var n=this._state;var a=this._velocity;var o=n.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];var c=e-t;var f=c>1e-6?1/c:0;this._time.push(e);for(var h=r;h>0;--h){var p=arguments[h];n.push(i(l[h-1],u[h-1],n[o++]+p));a.push(p*f)}};s.idle=function(e){var t=this.lastT();if(e<t){return}var r=this.dimension;var n=this._state;var a=this._velocity;var o=n.length-r;var s=this.bounds;var l=s[0];var u=s[1];var c=e-t;this._time.push(e);for(var f=r-1;f>=0;--f){n.push(i(l[f],u[f],n[o]+c*a[o]));a.push(0);o+=1}};function l(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=0}return t}function u(e,t,r){switch(arguments.length){case 0:return new o([0],[0],0);case 1:if(typeof e==="number"){var n=l(e);return new o(n,n,0)}else{return new o(e,l(e.length),0)}case 2:if(typeof t==="number"){var n=l(e.length);return new o(e,n,+t)}else{r=0}case 3:if(e.length!==t.length){throw new Error("state and velocity lengths must match")}return new o(e,t,r)}}},{"binary-search-bounds":243,"cubic-hermite":150}],243:[function(e,t,r){"use strict";function n(e,t,r,n,a,i){var o=["function ",e,"(a,l,h,",n.join(","),"){",i?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",a?".get(m)":"[m]"];if(i){if(t.indexOf("c")<0){o.push(";if(x===y){return m}else if(x<=y){")}else{o.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{o.push(";if(",t,"){i=m;")}if(r){o.push("l=m+1}else{h=m-1}")}else{o.push("h=m-1}else{l=m+1}")}o.push("}");if(i){o.push("return -1};")}else{o.push("return i};")}return o.join("")}function a(e,t,r,a){var i=new Function([n("A","x"+e+"y",t,["y"],false,a),n("B","x"+e+"y",t,["y"],true,a),n("P","c(x,y)"+e+"0",t,["y","c"],false,a),n("Q","c(x,y)"+e+"0",t,["y","c"],true,a),"function dispatchBsearch",r,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",r].join(""));return i()}t.exports={ge:a(">=",false,"GE"),gt:a(">",false,"GT"),lt:a("<",true,"LT"),le:a("<=",true,"LE"),eq:a("-",true,"EQ",true)}},{}],244:[function(e,t,r){var n=e("dtype");t.exports=a;function a(e,t,r){if(!e)throw new TypeError("must specify data as first parameter");r=+(r||0)|0;if(Array.isArray(e)&&(e[0]&&typeof e[0][0]==="number")){var a=e[0].length;var i=e.length*a;var o,s,l,u;if(!t||typeof t==="string"){t=new(n(t||"float32"))(i+r)}var c=t.length-r;if(i!==c){throw new Error("source length "+i+" ("+a+"x"+e.length+")"+" does not match destination length "+c)}for(o=0,l=r;o<e.length;o++){for(s=0;s<a;s++){t[l++]=e[o][s]===null?NaN:e[o][s]}}}else{if(!t||typeof t==="string"){var f=n(t||"float32");if(Array.isArray(e)||t==="array"){t=new f(e.length+r);for(o=0,l=r,u=t.length;l<u;l++,o++){t[l]=e[o]===null?NaN:e[o]}}else{if(r===0){t=new f(e)}else{t=new f(e.length+r);t.set(e,r)}}}else{t.set(e,r)}}return t}},{dtype:175}],245:[function(e,t,r){"use strict";var n=e("css-font/stringify");var a=[32,126];t.exports=i;function i(e){e=e||{};var t=e.shape?e.shape:e.canvas?[e.canvas.width,e.canvas.height]:[512,512];var r=e.canvas||document.createElement("canvas");var i=e.font;var o=typeof e.step==="number"?[e.step,e.step]:e.step||[32,32];var s=e.chars||a;if(i&&typeof i!=="string")i=n(i);if(!Array.isArray(s)){s=String(s).split("")}else if(s.length===2&&typeof s[0]==="number"&&typeof s[1]==="number"){var l=[];for(var u=s[0],c=0;u<=s[1];u++){l[c++]=String.fromCharCode(u)}s=l}t=t.slice();r.width=t[0];r.height=t[1];var f=r.getContext("2d");f.fillStyle="#000";f.fillRect(0,0,r.width,r.height);f.font=i;f.textAlign="center";f.textBaseline="middle";f.fillStyle="#fff";var h=o[0]/2;var p=o[1]/2;for(var u=0;u<s.length;u++){f.fillText(s[u],h,p);if((h+=o[0])>t[0]-o[0]/2)h=o[0]/2,p+=o[1]}return r}},{"css-font/stringify":147}],246:[function(e,t,r){"use strict";t.exports=n;n.canvas=document.createElement("canvas");n.cache={};function n(e,t){if(!t)t={};if(typeof e==="string"||Array.isArray(e)){t.family=e}var r=Array.isArray(t.family)?t.family.join(", "):t.family;if(!r)throw Error("`family` must be defined");var s=t.size||t.fontSize||t.em||48;var l=t.weight||t.fontWeight||"";var u=t.style||t.fontStyle||"";var e=[u,l,s].join(" ")+"px "+r;var c=t.origin||"top";if(n.cache[r]){if(s<=n.cache[r].em){return a(n.cache[r],c)}}var f=t.canvas||n.canvas;var h=f.getContext("2d");var p={upper:t.upper!==undefined?t.upper:"H",lower:t.lower!==undefined?t.lower:"x",descent:t.descent!==undefined?t.descent:"p",ascent:t.ascent!==undefined?t.ascent:"h",tittle:t.tittle!==undefined?t.tittle:"i",overshoot:t.overshoot!==undefined?t.overshoot:"O"};var d=Math.ceil(s*1.5);f.height=d;f.width=d*.5;h.font=e;var v="H";var m={top:0};h.clearRect(0,0,d,d);h.textBaseline="top";h.fillStyle="black";h.fillText(v,0,0);var g=i(h.getImageData(0,0,d,d));h.clearRect(0,0,d,d);h.textBaseline="bottom";h.fillText(v,0,d);var y=i(h.getImageData(0,0,d,d));m.lineHeight=m.bottom=d-y+g;h.clearRect(0,0,d,d);h.textBaseline="alphabetic";h.fillText(v,0,d);var x=i(h.getImageData(0,0,d,d));var _=d-x-1+g;m.baseline=m.alphabetic=_;h.clearRect(0,0,d,d);h.textBaseline="middle";h.fillText(v,0,d*.5);var b=i(h.getImageData(0,0,d,d));m.median=m.middle=d-b-1+g-d*.5;h.clearRect(0,0,d,d);h.textBaseline="hanging";h.fillText(v,0,d*.5);var w=i(h.getImageData(0,0,d,d));m.hanging=d-w-1+g-d*.5;h.clearRect(0,0,d,d);h.textBaseline="ideographic";h.fillText(v,0,d);var T=i(h.getImageData(0,0,d,d));m.ideographic=d-T-1+g;if(p.upper){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.upper,0,0);m.upper=i(h.getImageData(0,0,d,d));m.capHeight=m.baseline-m.upper}if(p.lower){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.lower,0,0);m.lower=i(h.getImageData(0,0,d,d));m.xHeight=m.baseline-m.lower}if(p.tittle){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.tittle,0,0);m.tittle=i(h.getImageData(0,0,d,d))}if(p.ascent){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.ascent,0,0);m.ascent=i(h.getImageData(0,0,d,d))}if(p.descent){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.descent,0,0);m.descent=o(h.getImageData(0,0,d,d))}if(p.overshoot){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.overshoot,0,0);var k=o(h.getImageData(0,0,d,d));m.overshoot=k-_}for(var A in m){m[A]/=s}m.em=s;n.cache[r]=m;return a(m,c)}function a(e,t){var r={};if(typeof t==="string")t=e[t];for(var n in e){if(n==="em")continue;r[n]=e[n]-t}return r}function i(e){var t=e.height;var r=e.data;for(var n=3;n<r.length;n+=4){if(r[n]!==0){return Math.floor((n-3)*.25/t)}}}function o(e){var t=e.height;var r=e.data;for(var n=r.length-1;n>0;n-=4){if(r[n]!==0){return Math.floor((n-3)*.25/t)}}}},{}],247:[function(e,t,r){"use strict";t.exports=x;var n=0;var a=1;function i(e,t,r,n,a,i){this._color=e;this.key=t;this.value=r;this.left=n;this.right=a;this._count=i}function o(e){return new i(e._color,e.key,e.value,e.left,e.right,e._count)}function s(e,t){return new i(e,t.key,t.value,t.left,t.right,t._count)}function l(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function u(e,t){this._compare=e;this.root=t}var c=u.prototype;Object.defineProperty(c,"keys",{get:function(){var e=[];this.forEach(function(t,r){e.push(t)});return e}});Object.defineProperty(c,"values",{get:function(){var e=[];this.forEach(function(t,r){e.push(r)});return e}});Object.defineProperty(c,"length",{get:function(){if(this.root){return this.root._count}return 0}});c.insert=function(e,t){var r=this._compare;var o=this.root;var c=[];var f=[];while(o){var h=r(e,o.key);c.push(o);f.push(h);if(h<=0){o=o.left}else{o=o.right}}c.push(new i(n,e,t,null,null,1));for(var p=c.length-2;p>=0;--p){var o=c[p];if(f[p]<=0){c[p]=new i(o._color,o.key,o.value,c[p+1],o.right,o._count+1)}else{c[p]=new i(o._color,o.key,o.value,o.left,c[p+1],o._count+1)}}for(var p=c.length-1;p>1;--p){var d=c[p-1];var o=c[p];if(d._color===a||o._color===a){break}var v=c[p-2];if(v.left===d){if(d.left===o){var m=v.right;if(m&&m._color===n){d._color=a;v.right=s(a,m);v._color=n;p-=1}else{v._color=n;v.left=d.right;d._color=a;d.right=v;c[p-2]=d;c[p-1]=o;l(v);l(d);if(p>=3){var g=c[p-3];if(g.left===v){g.left=d}else{g.right=d}}break}}else{var m=v.right;if(m&&m._color===n){d._color=a;v.right=s(a,m);v._color=n;p-=1}else{d.right=o.left;v._color=n;v.left=o.right;o._color=a;o.left=d;o.right=v;c[p-2]=o;c[p-1]=d;l(v);l(d);l(o);if(p>=3){var g=c[p-3];if(g.left===v){g.left=o}else{g.right=o}}break}}}else{if(d.right===o){var m=v.left;if(m&&m._color===n){d._color=a;v.left=s(a,m);v._color=n;p-=1}else{v._color=n;v.right=d.left;d._color=a;d.left=v;c[p-2]=d;c[p-1]=o;l(v);l(d);if(p>=3){var g=c[p-3];if(g.right===v){g.right=d}else{g.left=d}}break}}else{var m=v.left;if(m&&m._color===n){d._color=a;v.left=s(a,m);v._color=n;p-=1}else{d.left=o.right;v._color=n;v.right=o.left;o._color=a;o.right=d;o.left=v;c[p-2]=o;c[p-1]=d;l(v);l(d);l(o);if(p>=3){var g=c[p-3];if(g.right===v){g.right=o}else{g.left=o}}break}}}}c[0]._color=a;return new u(r,c[0])};function f(e,t){if(t.left){var r=f(e,t.left);if(r){return r}}var r=e(t.key,t.value);if(r){return r}if(t.right){return f(e,t.right)}}function h(e,t,r,n){var a=t(e,n.key);if(a<=0){if(n.left){var i=h(e,t,r,n.left);if(i){return i}}var i=r(n.key,n.value);if(i){return i}}if(n.right){return h(e,t,r,n.right)}}function p(e,t,r,n,a){var i=r(e,a.key);var o=r(t,a.key);var s;if(i<=0){if(a.left){s=p(e,t,r,n,a.left);if(s){return s}}if(o>0){s=n(a.key,a.value);if(s){return s}}}if(o>0&&a.right){return p(e,t,r,n,a.right)}}c.forEach=function e(t,r,n){if(!this.root){return}switch(arguments.length){case 1:return f(t,this.root);break;case 2:return h(r,this._compare,t,this.root);break;case 3:if(this._compare(r,n)>=0){return}return p(r,n,this._compare,t,this.root);break}};Object.defineProperty(c,"begin",{get:function(){var e=[];var t=this.root;while(t){e.push(t);t=t.left}return new d(this,e)}});Object.defineProperty(c,"end",{get:function(){var e=[];var t=this.root;while(t){e.push(t);t=t.right}return new d(this,e)}});c.at=function(e){if(e<0){return new d(this,[])}var t=this.root;var r=[];while(true){r.push(t);if(t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e){return new d(this,r)}e-=1;if(t.right){if(e>=t.right._count){break}t=t.right}else{break}}return new d(this,[])};c.ge=function(e){var t=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=t(e,r.key);n.push(r);if(i<=0){a=n.length}if(i<=0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.gt=function(e){var t=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=t(e,r.key);n.push(r);if(i<0){a=n.length}if(i<0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.lt=function(e){var t=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=t(e,r.key);n.push(r);if(i>0){a=n.length}if(i<=0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.le=function(e){var t=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=t(e,r.key);n.push(r);if(i>=0){a=n.length}if(i<0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.find=function(e){var t=this._compare;var r=this.root;var n=[];while(r){var a=t(e,r.key);n.push(r);if(a===0){return new d(this,n)}if(a<=0){r=r.left}else{r=r.right}}return new d(this,[])};c.remove=function(e){var t=this.find(e);if(t){return t.remove()}return this};c.get=function(e){var t=this._compare;var r=this.root;while(r){var n=t(e,r.key);if(n===0){return r.value}if(n<=0){r=r.left}else{r=r.right}}return};function d(e,t){this.tree=e;this._stack=t}var v=d.prototype;Object.defineProperty(v,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(v,"node",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1]}return null},enumerable:true});v.clone=function(){return new d(this.tree,this._stack.slice())};function m(e,t){e.key=t.key;e.value=t.value;e.left=t.left;e.right=t.right;e._color=t._color;e._count=t._count}function g(e){var t,r,i,u;for(var c=e.length-1;c>=0;--c){t=e[c];if(c===0){t._color=a;return}r=e[c-1];if(r.left===t){i=r.right;if(i.right&&i.right._color===n){i=r.right=o(i);u=i.right=o(i.right);r.right=i.left;i.left=r;i.right=u;i._color=r._color;t._color=a;r._color=a;u._color=a;l(r);l(i);if(c>1){var f=e[c-2];if(f.left===r){f.left=i}else{f.right=i}}e[c-1]=i;return}else if(i.left&&i.left._color===n){i=r.right=o(i);u=i.left=o(i.left);r.right=u.left;i.left=u.right;u.left=r;u.right=i;u._color=r._color;r._color=a;i._color=a;t._color=a;l(r);l(i);l(u);if(c>1){var f=e[c-2];if(f.left===r){f.left=u}else{f.right=u}}e[c-1]=u;return}if(i._color===a){if(r._color===n){r._color=a;r.right=s(n,i);return}else{r.right=s(n,i);continue}}else{i=o(i);r.right=i.left;i.left=r;i._color=r._color;r._color=n;l(r);l(i);if(c>1){var f=e[c-2];if(f.left===r){f.left=i}else{f.right=i}}e[c-1]=i;e[c]=r;if(c+1<e.length){e[c+1]=t}else{e.push(t)}c=c+2}}else{i=r.left;if(i.left&&i.left._color===n){i=r.left=o(i);u=i.left=o(i.left);r.left=i.right;i.right=r;i.left=u;i._color=r._color;t._color=a;r._color=a;u._color=a;l(r);l(i);if(c>1){var f=e[c-2];if(f.right===r){f.right=i}else{f.left=i}}e[c-1]=i;return}else if(i.right&&i.right._color===n){i=r.left=o(i);u=i.right=o(i.right);r.left=u.right;i.right=u.left;u.right=r;u.left=i;u._color=r._color;r._color=a;i._color=a;t._color=a;l(r);l(i);l(u);if(c>1){var f=e[c-2];if(f.right===r){f.right=u}else{f.left=u}}e[c-1]=u;return}if(i._color===a){if(r._color===n){r._color=a;r.left=s(n,i);return}else{r.left=s(n,i);continue}}else{i=o(i);r.left=i.right;i.right=r;i._color=r._color;r._color=n;l(r);l(i);if(c>1){var f=e[c-2];if(f.right===r){f.right=i}else{f.left=i}}e[c-1]=i;e[c]=r;if(c+1<e.length){e[c+1]=t}else{e.push(t)}c=c+2}}}}v.remove=function(){var e=this._stack;if(e.length===0){return this.tree}var t=new Array(e.length);var r=e[e.length-1];t[t.length-1]=new i(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=e.length-2;o>=0;--o){var r=e[o];if(r.left===e[o+1]){t[o]=new i(r._color,r.key,r.value,t[o+1],r.right,r._count)}else{t[o]=new i(r._color,r.key,r.value,r.left,t[o+1],r._count)}}r=t[t.length-1];if(r.left&&r.right){var s=t.length;r=r.left;while(r.right){t.push(r);r=r.right}var l=t[s-1];t.push(new i(r._color,l.key,l.value,r.left,r.right,r._count));t[s-1].key=r.key;t[s-1].value=r.value;for(var o=t.length-2;o>=s;--o){r=t[o];t[o]=new i(r._color,r.key,r.value,r.left,t[o+1],r._count)}t[s-1].left=t[s]}r=t[t.length-1];if(r._color===n){var c=t[t.length-2];if(c.left===r){c.left=null}else if(c.right===r){c.right=null}t.pop();for(var o=0;o<t.length;++o){t[o]._count--}return new u(this.tree._compare,t[0])}else{if(r.left||r.right){if(r.left){m(r,r.left)}else if(r.right){m(r,r.right)}r._color=a;for(var o=0;o<t.length-1;++o){t[o]._count--}return new u(this.tree._compare,t[0])}else if(t.length===1){return new u(this.tree._compare,null)}else{for(var o=0;o<t.length;++o){t[o]._count--}var f=t[t.length-2];g(t);if(f.left===r){f.left=null}else{f.right=null}}}return new u(this.tree._compare,t[0])};Object.defineProperty(v,"key",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].key}return},enumerable:true});Object.defineProperty(v,"value",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].value}return},enumerable:true});Object.defineProperty(v,"index",{get:function(){var e=0;var t=this._stack;if(t.length===0){var r=this.tree.root;if(r){return r._count}return 0}else if(t[t.length-1].left){e=t[t.length-1].left._count}for(var n=t.length-2;n>=0;--n){if(t[n+1]===t[n].right){++e;if(t[n].left){e+=t[n].left._count}}}return e},enumerable:true});v.next=function(){var e=this._stack;if(e.length===0){return}var t=e[e.length-1];if(t.right){t=t.right;while(t){e.push(t);t=t.left}}else{e.pop();while(e.length>0&&e[e.length-1].right===t){t=e[e.length-1];e.pop()}}};Object.defineProperty(v,"hasNext",{get:function(){var e=this._stack;if(e.length===0){return false}if(e[e.length-1].right){return true}for(var t=e.length-1;t>0;--t){if(e[t-1].left===e[t]){return true}}return false}});v.update=function(e){var t=this._stack;if(t.length===0){throw new Error("Can't update empty node!")}var r=new Array(t.length);var n=t[t.length-1];r[r.length-1]=new i(n._color,n.key,e,n.left,n.right,n._count);for(var a=t.length-2;a>=0;--a){n=t[a];if(n.left===t[a+1]){r[a]=new i(n._color,n.key,n.value,r[a+1],n.right,n._count)}else{r[a]=new i(n._color,n.key,n.value,n.left,r[a+1],n._count)}}return new u(this.tree._compare,r[0])};v.prev=function(){var e=this._stack;if(e.length===0){return}var t=e[e.length-1];if(t.left){t=t.left;while(t){e.push(t);t=t.right}}else{e.pop();while(e.length>0&&e[e.length-1].left===t){t=e[e.length-1];e.pop()}}};Object.defineProperty(v,"hasPrev",{get:function(){var e=this._stack;if(e.length===0){return false}if(e[e.length-1].left){return true}for(var t=e.length-1;t>0;--t){if(e[t-1].right===e[t]){return true}}return false}});function y(e,t){if(e<t){return-1}if(e>t){return 1}return 0}function x(e){return new u(e||y,null)}},{}],248:[function(e,t,r){var n=7;var a=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];var i=607/128;var o=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function s(e){if(e<0)return Number("0/0");var t=o[0];for(var r=o.length-1;r>0;--r)t+=o[r]/(e+r);var n=e+i+.5;return.5*Math.log(2*Math.PI)+(e+.5)*Math.log(n)-n+Math.log(t)-Math.log(e)}t.exports=function e(t){if(t<.5){return Math.PI/(Math.sin(Math.PI*t)*e(1-t))}else if(t>100)return Math.exp(s(t));else{t-=1;var r=a[0];for(var i=1;i<n+2;i++){r+=a[i]/(t+i)}var o=t+n+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,t+.5)*Math.exp(-o)*r}};t.exports.log=s},{}],249:[function(e,t,r){t.exports=n;function n(e,t){if(typeof e!=="string"){throw new TypeError("must specify type string")}t=t||{};if(typeof document==="undefined"&&!t.canvas){return null}var r=t.canvas||document.createElement("canvas");if(typeof t.width==="number"){r.width=t.width}if(typeof t.height==="number"){r.height=t.height}var n=t;var a;try{var i=[e];if(e.indexOf("webgl")===0){i.push("experimental-"+e)}for(var o=0;o<i.length;o++){a=r.getContext(i[o],n);if(a)return a}}catch(e){a=null}return a||null}},{}],250:[function(e,t,r){"use strict";t.exports=b;var n=e("./lib/text.js");var a=e("./lib/lines.js");var i=e("./lib/background.js");var o=e("./lib/cube.js");var s=e("./lib/ticks.js");var l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function c(e){this.gl=e;this.pixelRatio=1;this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.autoTicks=true;this.tickSpacing=[1,1,1];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickAlign=["auto","auto","auto"];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[10,10,10];this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]};this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont="sans-serif";this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelAlign=["auto","auto","auto"];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[10,10,10];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[0,0,0];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[false,false,false];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._firstInit=true;this._text=null;this._lines=null;this._background=i(e)}var f=c.prototype;f.update=function(e){e=e||{};function t(t,r,n){if(n in e){var a=e[n];var i=this[n];var o;if(t?Array.isArray(a)&&Array.isArray(a[0]):Array.isArray(a)){this[n]=o=[r(a[0]),r(a[1]),r(a[2])]}else{this[n]=o=[r(a),r(a),r(a)]}for(var s=0;s<3;++s){if(o[s]!==i[s]){return true}}}return false}var r=t.bind(this,false,Number);var i=t.bind(this,false,Boolean);var o=t.bind(this,false,String);var l=t.bind(this,true,function(e){if(Array.isArray(e)){if(e.length===3){return[+e[0],+e[1],+e[2],1]}else if(e.length===4){return[+e[0],+e[1],+e[2],+e[3]]}}return[0,0,0,1]});var u;var c=false;var f=false;if("bounds"in e){var h=e.bounds;e:for(var p=0;p<2;++p){for(var d=0;d<3;++d){if(h[p][d]!==this.bounds[p][d]){f=true}this.bounds[p][d]=h[p][d]}}}if("ticks"in e){u=e.ticks;c=true;this.autoTicks=false;for(var p=0;p<3;++p){this.tickSpacing[p]=0}}else if(r("tickSpacing")){this.autoTicks=true;f=true}if(this._firstInit){if(!("ticks"in e||"tickSpacing"in e)){this.autoTicks=true}f=true;c=true;this._firstInit=false}if(f&&this.autoTicks){u=s.create(this.bounds,this.tickSpacing);c=true}if(c){for(var p=0;p<3;++p){u[p].sort(function(e,t){return e.x-t.x})}if(s.equal(u,this.ticks)){c=false}else{this.ticks=u}}i("tickEnable");if(o("tickFont")){c=true}r("tickSize");r("tickAngle");r("tickPad");l("tickColor");var v=o("labels");if(o("labelFont")){v=true}i("labelEnable");r("labelSize");r("labelPad");l("labelColor");i("lineEnable");i("lineMirror");r("lineWidth");l("lineColor");i("lineTickEnable");i("lineTickMirror");r("lineTickLength");r("lineTickWidth");l("lineTickColor");i("gridEnable");r("gridWidth");l("gridColor");i("zeroEnable");l("zeroLineColor");r("zeroLineWidth");i("backgroundEnable");l("backgroundColor");if(!this._text){this._text=n(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}else if(this._text&&(v||c)){this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}if(this._lines&&c){this._lines.dispose();this._lines=null}if(!this._lines){this._lines=a(this.gl,this.bounds,this.ticks)}};function h(){this.primalOffset=[0,0,0];this.primalMinor=[0,0,0];this.mirrorOffset=[0,0,0];this.mirrorMinor=[0,0,0]}var p=[new h,new h,new h];function d(e,t,r,n,a){var i=e.primalOffset;var o=e.primalMinor;var s=e.mirrorOffset;var l=e.mirrorMinor;var u=n[t];for(var c=0;c<3;++c){if(t===c){continue}var f=i,h=s,p=o,d=l;if(u&1<<c){f=s;h=i;p=l;d=o}f[c]=r[0][c];h[c]=r[1][c];if(a[c]>0){p[c]=-1;d[c]=0}else{p[c]=0;d[c]=+1}}}var v=[0,0,0];var m={model:l,view:l,projection:l,_ortho:false};f.isOpaque=function(){return true};f.isTransparent=function(){return false};f.drawTransparent=function(e){};var g=0;var y=[0,0,0];var x=[0,0,0];var _=[0,0,0];f.draw=function(e){e=e||m;var t=this.gl;var r=e.model||l;var n=e.view||l;var a=e.projection||l;var i=this.bounds;var s=e._ortho||false;var c=o(r,n,a,i,s);var f=c.cubeEdges;var h=c.axis;var b=n[12];var w=n[13];var T=n[14];var k=n[15];var A=s?2:1;var M=A*this.pixelRatio*(a[3]*b+a[7]*w+a[11]*T+a[15]*k)/t.drawingBufferHeight;for(var E=0;E<3;++E){this.lastCubeProps.cubeEdges[E]=f[E];this.lastCubeProps.axis[E]=h[E]}var S=p;for(var E=0;E<3;++E){d(p[E],E,this.bounds,f,h)}var t=this.gl;var C=v;for(var E=0;E<3;++E){if(this.backgroundEnable[E]){C[E]=h[E]}else{C[E]=0}}this._background.draw(r,n,a,i,C,this.backgroundColor);this._lines.bind(r,n,a,this);for(var E=0;E<3;++E){var L=[0,0,0];if(h[E]>0){L[E]=i[1][E]}else{L[E]=i[0][E]}for(var I=0;I<2;++I){var O=(E+1+I)%3;var P=(E+1+(I^1))%3;if(this.gridEnable[O]){this._lines.drawGrid(O,P,this.bounds,L,this.gridColor[O],this.gridWidth[O]*this.pixelRatio)}}for(var I=0;I<2;++I){var O=(E+1+I)%3;var P=(E+1+(I^1))%3;if(this.zeroEnable[P]){if(Math.min(i[0][P],i[1][P])<=0&&Math.max(i[0][P],i[1][P])>=0){this._lines.drawZero(O,P,this.bounds,L,this.zeroLineColor[P],this.zeroLineWidth[P]*this.pixelRatio)}}}}for(var E=0;E<3;++E){if(this.lineEnable[E]){this._lines.drawAxisLine(E,this.bounds,S[E].primalOffset,this.lineColor[E],this.lineWidth[E]*this.pixelRatio)}if(this.lineMirror[E]){this._lines.drawAxisLine(E,this.bounds,S[E].mirrorOffset,this.lineColor[E],this.lineWidth[E]*this.pixelRatio)}var D=u(y,S[E].primalMinor);var R=u(x,S[E].mirrorMinor);var z=this.lineTickLength;for(var I=0;I<3;++I){var N=M/r[5*I];D[I]*=z[I]*N;R[I]*=z[I]*N}if(this.lineTickEnable[E]){this._lines.drawAxisTicks(E,S[E].primalOffset,D,this.lineTickColor[E],this.lineTickWidth[E]*this.pixelRatio)}if(this.lineTickMirror[E]){this._lines.drawAxisTicks(E,S[E].mirrorOffset,R,this.lineTickColor[E],this.lineTickWidth[E]*this.pixelRatio)}}this._lines.unbind();this._text.bind(r,n,a,this.pixelRatio);var F;var B=.5;var j;var U;function H(e){U=[0,0,0];U[e]=1}function V(e,t,r){var n=(e+1)%3;var a=(e+2)%3;var i=t[n];var o=t[a];var s=r[n];var l=r[a];if(i>0&&l>0){H(n);return}else if(i>0&&l<0){H(n);return}else if(i<0&&l>0){H(n);return}else if(i<0&&l<0){H(n);return}else if(o>0&&s>0){H(a);return}else if(o>0&&s<0){H(a);return}else if(o<0&&s>0){H(a);return}else if(o<0&&s<0){H(a);return}}for(var E=0;E<3;++E){var G=S[E].primalMinor;var q=S[E].mirrorMinor;var Y=u(_,S[E].primalOffset);for(var I=0;I<3;++I){if(this.lineTickEnable[E]){Y[I]+=M*G[I]*Math.max(this.lineTickLength[I],0)/r[5*I]}}var W=[0,0,0];W[E]=1;if(this.tickEnable[E]){if(this.tickAngle[E]===-3600){this.tickAngle[E]=0;this.tickAlign[E]="auto"}else{this.tickAlign[E]=-1}j=1;F=[this.tickAlign[E],B,j];if(F[0]==="auto")F[0]=g;else F[0]=parseInt(""+F[0]);U=[0,0,0];V(E,G,q);for(var I=0;I<3;++I){Y[I]+=M*G[I]*this.tickPad[I]/r[5*I]}this._text.drawTicks(E,this.tickSize[E],this.tickAngle[E],Y,this.tickColor[E],W,U,F)}if(this.labelEnable[E]){j=0;U=[0,0,0];if(this.labels[E].length>4){H(E);j=1}F=[this.labelAlign[E],B,j];if(F[0]==="auto")F[0]=g;else F[0]=parseInt(""+F[0]);for(var I=0;I<3;++I){Y[I]+=M*G[I]*this.labelPad[I]/r[5*I]}Y[E]+=.5*(i[0][E]+i[1][E]);this._text.drawLabel(E,this.labelSize[E],this.labelAngle[E],Y,this.labelColor[E],[0,0,0],U,F)}}this._text.unbind()};f.dispose=function(){this._text.dispose();this._lines.dispose();this._background.dispose();this._lines=null;this._text=null;this._background=null;this.gl=null};function b(e,t){var r=new c(e);r.update(t);return r}},{"./lib/background.js":251,"./lib/cube.js":252,"./lib/lines.js":253,"./lib/text.js":255,"./lib/ticks.js":256}],251:[function(e,t,r){"use strict";t.exports=l;var n=e("gl-buffer");var a=e("gl-vao");var i=e("./shaders").bg;function o(e,t,r,n){this.gl=e;this.buffer=t;this.vao=r;this.shader=n}var s=o.prototype;s.draw=function(e,t,r,n,a,i){var o=false;for(var s=0;s<3;++s){o=o||a[s]}if(!o){return}var l=this.gl;l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(1,2);this.shader.bind();this.shader.uniforms={model:e,view:t,projection:r,bounds:n,enable:a,colors:i};this.vao.bind();this.vao.draw(this.gl.TRIANGLES,36);this.vao.unbind();l.disable(l.POLYGON_OFFSET_FILL)};s.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function l(e){var t=[];var r=[];var s=0;for(var l=0;l<3;++l){var u=(l+1)%3;var c=(l+2)%3;var f=[0,0,0];var h=[0,0,0];for(var p=-1;p<=1;p+=2){r.push(s,s+2,s+1,s+1,s+2,s+3);f[l]=p;h[l]=p;for(var d=-1;d<=1;d+=2){f[u]=d;for(var v=-1;v<=1;v+=2){f[c]=v;t.push(f[0],f[1],f[2],h[0],h[1],h[2]);s+=1}}var m=u;u=c;c=m}}var g=n(e,new Float32Array(t));var y=n(e,new Uint16Array(r),e.ELEMENT_ARRAY_BUFFER);var x=a(e,[{buffer:g,type:e.FLOAT,size:3,offset:0,stride:24},{buffer:g,type:e.FLOAT,size:3,offset:12,stride:24}],y);var _=i(e);_.attributes.position.location=0;_.attributes.normal.location=1;return new o(e,g,x,_)}},{"./shaders":254,"gl-buffer":259,"gl-vao":358}],252:[function(e,t,r){"use strict";t.exports=y;var n=e("bit-twiddle");var a=e("gl-mat4/multiply");var i=e("split-polygon");var o=e("robust-orientation");var s=new Array(16);var l=new Array(8);var u=new Array(8);var c=new Array(3);var f=[0,0,0];(function(){for(var e=0;e<8;++e){l[e]=[1,1,1,1];u[e]=[1,1,1]}})();function h(e,t,r){for(var n=0;n<4;++n){e[n]=r[12+n];for(var a=0;a<3;++a){e[n]+=t[a]*r[4*a+n]}}}var p=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function d(e){for(var t=0;t<p.length;++t){e=i.positive(e,p[t]);if(e.length<3){return 0}}var r=e[0];var n=r[0]/r[3];var a=r[1]/r[3];var o=0;for(var t=1;t+1<e.length;++t){var s=e[t];var l=e[t+1];var u=s[0]/s[3];var c=s[1]/s[3];var f=l[0]/l[3];var h=l[1]/l[3];var d=u-n;var v=c-a;var m=f-n;var g=h-a;o+=Math.abs(d*g-v*m)}return o}var v=[1,1,1];var m=[0,0,0];var g={cubeEdges:v,axis:m};function y(e,t,r,i,p){a(s,t,e);a(s,r,s);var y=0;for(var x=0;x<2;++x){c[2]=i[x][2];for(var _=0;_<2;++_){c[1]=i[_][1];for(var b=0;b<2;++b){c[0]=i[b][0];h(l[y],c,s);y+=1}}}var w=-1;for(var x=0;x<8;++x){var T=l[x][3];for(var k=0;k<3;++k){u[x][k]=l[x][k]/T}if(p)u[x][2]*=-1;if(T<0){if(w<0){w=x}else if(u[x][2]<u[w][2]){w=x}}}if(w<0){w=0;for(var A=0;A<3;++A){var M=(A+2)%3;var E=(A+1)%3;var S=-1;var C=-1;for(var L=0;L<2;++L){var I=L<<A;var O=I+(L<<M)+(1-L<<E);var P=I+(1-L<<M)+(L<<E);if(o(u[I],u[O],u[P],f)<0){continue}if(L){S=1}else{C=1}}if(S<0||C<0){if(C>S){w|=1<<A}continue}for(var L=0;L<2;++L){var I=L<<A;var O=I+(L<<M)+(1-L<<E);var P=I+(1-L<<M)+(L<<E);var D=d([l[I],l[O],l[P],l[I+(1<<M)+(1<<E)]]);if(L){S=D}else{C=D}}if(C>S){w|=1<<A;continue}}}var R=7^w;var z=-1;for(var x=0;x<8;++x){if(x===w||x===R){continue}if(z<0){z=x}else if(u[z][1]>u[x][1]){z=x}}var N=-1;for(var x=0;x<3;++x){var F=z^1<<x;if(F===w||F===R){continue}if(N<0){N=F}var E=u[F];if(E[0]<u[N][0]){N=F}}var B=-1;for(var x=0;x<3;++x){var F=z^1<<x;if(F===w||F===R||F===N){continue}if(B<0){B=F}var E=u[F];if(E[0]>u[B][0]){B=F}}var j=v;j[0]=j[1]=j[2]=0;j[n.log2(N^z)]=z&N;j[n.log2(z^B)]=z&B;var U=B^7;if(U===w||U===R){U=N^7;j[n.log2(B^U)]=U&B}else{j[n.log2(N^U)]=U&N}var H=m;var V=w;for(var A=0;A<3;++A){if(V&1<<A){H[A]=-1}else{H[A]=1}}return g}},{"bit-twiddle":97,"gl-mat4/multiply":295,"robust-orientation":548,"split-polygon":566}],253:[function(e,t,r){"use strict";t.exports=v;var n=e("gl-buffer");var a=e("gl-vao");var i=e("./shaders").line;var o=[0,0,0];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var c=[1,1];function f(e){e[0]=e[1]=e[2]=0;return e}function h(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function p(e,t,r,n,a,i,o,s){this.gl=e;this.vertBuffer=t;this.vao=r;this.shader=n;this.tickCount=a;this.tickOffset=i;this.gridCount=o;this.gridOffset=s}var d=p.prototype;d.bind=function(e,t,r){this.shader.bind();this.shader.uniforms.model=e;this.shader.uniforms.view=t;this.shader.uniforms.projection=r;c[0]=this.gl.drawingBufferWidth;c[1]=this.gl.drawingBufferHeight;this.shader.uniforms.screenShape=c;this.vao.bind()};d.unbind=function(){this.vao.unbind()};d.drawAxisLine=function(e,t,r,n,a){var i=f(s);this.shader.uniforms.majorAxis=s;i[e]=t[1][e]-t[0][e];this.shader.uniforms.minorAxis=i;var o=h(u,r);o[e]+=t[0][e];this.shader.uniforms.offset=o;this.shader.uniforms.lineWidth=a;this.shader.uniforms.color=n;var c=f(l);c[(e+2)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6);var c=f(l);c[(e+1)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6)};d.drawAxisTicks=function(e,t,r,n,a){if(!this.tickCount[e]){return}var i=f(o);i[e]=1;this.shader.uniforms.majorAxis=i;this.shader.uniforms.offset=t;this.shader.uniforms.minorAxis=r;this.shader.uniforms.color=n;this.shader.uniforms.lineWidth=a;var s=f(l);s[e]=1;this.shader.uniforms.screenAxis=s;this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])};d.drawGrid=function(e,t,r,n,a,i){if(!this.gridCount[e]){return}var c=f(s);c[t]=r[1][t]-r[0][t];this.shader.uniforms.minorAxis=c;var p=h(u,n);p[t]+=r[0][t];this.shader.uniforms.offset=p;var d=f(o);d[e]=1;this.shader.uniforms.majorAxis=d;var v=f(l);v[e]=1;this.shader.uniforms.screenAxis=v;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=a;this.vao.draw(this.gl.TRIANGLES,this.gridCount[e],this.gridOffset[e])};d.drawZero=function(e,t,r,n,a,i){var o=f(s);this.shader.uniforms.majorAxis=o;o[e]=r[1][e]-r[0][e];this.shader.uniforms.minorAxis=o;var c=h(u,n);c[e]+=r[0][e];this.shader.uniforms.offset=c;var p=f(l);p[t]=1;this.shader.uniforms.screenAxis=p;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=a;this.vao.draw(this.gl.TRIANGLES,6)};d.dispose=function(){this.vao.dispose();this.vertBuffer.dispose();this.shader.dispose()};function v(e,t,r){var o=[];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var c=[0,0,0];o.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var f=0;f<3;++f){var h=o.length/3|0;for(var d=0;d<r[f].length;++d){var v=+r[f][d].x;o.push(v,0,1,v,1,1,v,0,-1,v,0,-1,v,1,1,v,1,-1)}var m=o.length/3|0;s[f]=h;l[f]=m-h;var h=o.length/3|0;for(var g=0;g<r[f].length;++g){var v=+r[f][g].x;o.push(v,0,1,v,1,1,v,0,-1,v,0,-1,v,1,1,v,1,-1)}var m=o.length/3|0;u[f]=h;c[f]=m-h}var y=n(e,new Float32Array(o));var x=a(e,[{buffer:y,type:e.FLOAT,size:3,stride:0,offset:0}]);var _=i(e);_.attributes.position.location=0;return new p(e,y,x,_,l,s,c,u)}},{"./shaders":254,"gl-buffer":259,"gl-vao":358}],254:[function(e,t,r){"use strict";var n=e("glslify");var a=e("gl-shader");var i=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.line=function(e){return a(e,i,o,null,[{name:"position",type:"vec3"}])};var s=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]);var l=n(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.text=function(e){return a(e,s,l,null,[{name:"position",type:"vec3"}])};var u=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]);var c=n(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);r.bg=function(e){return a(e,u,c,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":335,glslify:257}],255:[function(e,t,r){(function(r){(function(){"use strict";t.exports=d;var n=e("gl-buffer");var a=e("gl-vao");var i=e("vectorize-text");var o=e("./shaders").text;var s=window||r.global||{};var l=s.__TEXT_CACHE||{};s.__TEXT_CACHE={};var u=3;function c(e,t,r,n){this.gl=e;this.shader=t;this.buffer=r;this.vao=n;this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var f=c.prototype;var h=[0,0];f.bind=function(e,t,r,n){this.vao.bind();this.shader.bind();var a=this.shader.uniforms;a.model=e;a.view=t;a.projection=r;a.pixelScale=n;h[0]=this.gl.drawingBufferWidth;h[1]=this.gl.drawingBufferHeight;this.shader.uniforms.resolution=h};f.unbind=function(){this.vao.unbind()};f.update=function(e,t,r,n,a){var i=[];function o(e,t,r,n,a,o){var s=l[r];if(!s){s=l[r]={}}var u=s[t];if(!u){u=s[t]=p(t,{triangles:true,font:r,textAlign:"center",textBaseline:"middle",lineSpacing:a,styletags:o})}var c=(n||12)/12;var f=u.positions;var h=u.cells;for(var d=0,v=h.length;d<v;++d){var m=h[d];for(var g=2;g>=0;--g){var y=f[m[g]];i.push(c*y[0],-c*y[1],e)}}}var s=[0,0,0];var c=[0,0,0];var f=[0,0,0];var h=[0,0,0];var d=1.25;var v={breaklines:true,bolds:true,italics:true,subscripts:true,superscripts:true};for(var m=0;m<3;++m){f[m]=i.length/u|0;o(.5*(e[0][m]+e[1][m]),t[m],r[m],12,d,v);h[m]=(i.length/u|0)-f[m];s[m]=i.length/u|0;for(var g=0;g<n[m].length;++g){if(!n[m][g].text){continue}o(n[m][g].x,n[m][g].text,n[m][g].font||a,n[m][g].fontSize||12,d,v)}c[m]=(i.length/u|0)-s[m]}this.buffer.update(i);this.tickOffset=s;this.tickCount=c;this.labelOffset=f;this.labelCount=h};f.drawTicks=function(e,t,r,n,a,i,o,s){if(!this.tickCount[e]){return}this.shader.uniforms.axis=i;this.shader.uniforms.color=a;this.shader.uniforms.angle=r;this.shader.uniforms.scale=t;this.shader.uniforms.offset=n;this.shader.uniforms.alignDir=o;this.shader.uniforms.alignOpt=s;this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])};f.drawLabel=function(e,t,r,n,a,i,o,s){if(!this.labelCount[e]){return}this.shader.uniforms.axis=i;this.shader.uniforms.color=a;this.shader.uniforms.angle=r;this.shader.uniforms.scale=t;this.shader.uniforms.offset=n;this.shader.uniforms.alignDir=o;this.shader.uniforms.alignOpt=s;this.vao.draw(this.gl.TRIANGLES,this.labelCount[e],this.labelOffset[e])};f.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};function p(e,t){try{return i(e,t)}catch(t){console.warn('error vectorizing text:"'+e+'" error:',t);return{cells:[],positions:[]}}}function d(e,t,r,i,s,l){var u=n(e);var f=a(e,[{buffer:u,size:3}]);var h=o(e);h.attributes.position.location=0;var p=new c(e,h,u,f);p.update(t,r,i,s,l);return p}}).call(this)}).call(this,e("_process"))},{"./shaders":254,_process:526,"gl-buffer":259,"gl-vao":358,"vectorize-text":600}],256:[function(e,t,r){"use strict";r.create=a;r.equal=i;function n(e,t){var r=e+"";var n=r.indexOf(".");var a=0;if(n>=0){a=r.length-n-1}var i=Math.pow(10,a);var o=Math.round(e*t*i);var s=o+"";if(s.indexOf("e")>=0){return s}var l=o/i,u=o%i;if(o<0){l=-Math.ceil(l)|0;u=-u|0}else{l=Math.floor(l)|0;u=u|0}var c=""+l;if(o<0){c="-"+c}if(a){var f=""+u;while(f.length<a){f="0"+f}return c+"."+f}else{return c}}function a(e,t){var r=[];for(var a=0;a<3;++a){var i=[];var o=.5*(e[0][a]+e[1][a]);for(var s=0;s*t[a]<=e[1][a];++s){i.push({x:s*t[a],text:n(t[a],s)})}for(var s=-1;s*t[a]>=e[0][a];--s){i.push({x:s*t[a],text:n(t[a],s)})}r.push(i)}return r}function i(e,t){for(var r=0;r<3;++r){if(e[r].length!==t[r].length){return false}for(var n=0;n<e[r].length;++n){var a=e[r][n];var i=t[r][n];if(a.x!==i.x||a.text!==i.text||a.font!==i.font||a.fontColor!==i.fontColor||a.fontSize!==i.fontSize||a.dx!==i.dx||a.dy!==i.dy){return false}}}return true}},{}],257:[function(e,t,r){t.exports=function(e){if(typeof e==="string")e=[e];var t=[].slice.call(arguments,1);var r=[];for(var n=0;n<e.length-1;n++){r.push(e[n],t[n]||"")}r.push(e[n]);return r.join("")}},{}],258:[function(e,t,r){"use strict";t.exports=g;var n=e("extract-frustum-planes");var a=e("split-polygon");var i=e("./lib/cube.js");var o=e("gl-mat4/multiply");var s=e("gl-mat4/transpose");var l=e("gl-vec4/transformMat4");var u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var c=new Float32Array(16);function f(e,t,r){this.lo=e;this.hi=t;this.pixelsPerDataUnit=r}var h=[0,0,0,1];var p=[0,0,0,1];function d(e,t,r,n,a){for(var i=0;i<3;++i){var o=h;var s=p;for(var u=0;u<3;++u){s[u]=o[u]=r[u]}s[3]=o[3]=1;s[i]+=1;l(s,s,t);if(s[3]<0){e[i]=Infinity}o[i]-=1;l(o,o,t);if(o[3]<0){e[i]=Infinity}var c=(o[0]/o[3]-s[0]/s[3])*n;var f=(o[1]/o[3]-s[1]/s[3])*a;e[i]=.25*Math.sqrt(c*c+f*f)}return e}var v=[new f(Infinity,-Infinity,Infinity),new f(Infinity,-Infinity,Infinity),new f(Infinity,-Infinity,Infinity)];var m=[0,0,0];function g(e,t,r,l,f){var h=t.model||u;var p=t.view||u;var g=t.projection||u;var y=t._ortho||false;var x=e.bounds;var f=f||i(h,p,g,x,y);var _=f.axis;o(c,p,h);o(c,g,c);var b=v;for(var w=0;w<3;++w){b[w].lo=Infinity;b[w].hi=-Infinity;b[w].pixelsPerDataUnit=Infinity}var T=n(s(c,c));s(c,c);for(var k=0;k<3;++k){var A=(k+1)%3;var M=(k+2)%3;var E=m;e:for(var w=0;w<2;++w){var S=[];if(_[k]<0===!!w){continue}E[k]=x[w][k];for(var C=0;C<2;++C){E[A]=x[C^w][A];for(var L=0;L<2;++L){E[M]=x[L^C^w][M];S.push(E.slice())}}var I=y?5:4;for(var C=I;C===I;++C){if(S.length===0){continue e}S=a.positive(S,T[C])}for(var C=0;C<S.length;++C){var M=S[C];var O=d(m,c,M,r,l);for(var L=0;L<3;++L){b[L].lo=Math.min(b[L].lo,M[L]);b[L].hi=Math.max(b[L].hi,M[L]);if(L!==k){b[L].pixelsPerDataUnit=Math.min(b[L].pixelsPerDataUnit,Math.abs(O[L]))}}}}}return b}},{"./lib/cube.js":252,"extract-frustum-planes":240,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":429,"split-polygon":566}],259:[function(e,t,r){"use strict";var n=e("typedarray-pool");var a=e("ndarray-ops");var i=e("ndarray");var o=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function s(e,t,r,n,a){this.gl=e;this.type=t;this.handle=r;this.length=n;this.usage=a}var l=s.prototype;l.bind=function(){this.gl.bindBuffer(this.type,this.handle)};l.unbind=function(){this.gl.bindBuffer(this.type,null)};l.dispose=function(){this.gl.deleteBuffer(this.handle)};function u(e,t,r,n,a,i){var o=a.length*a.BYTES_PER_ELEMENT;if(i<0){e.bufferData(t,a,n);return o}if(o+i>r){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}e.bufferSubData(t,i,a);return r}function c(e,t){var r=n.malloc(e.length,t);var a=e.length;for(var i=0;i<a;++i){r[i]=e[i]}return r}function f(e,t){var r=1;for(var n=t.length-1;n>=0;--n){if(t[n]!==r){return false}r*=e[n]}return true}l.update=function(e,t){if(typeof t!=="number"){t=-1}this.bind();if(typeof e==="object"&&typeof e.shape!=="undefined"){var r=e.dtype;if(o.indexOf(r)<0){r="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var s=gl.getExtension("OES_element_index_uint");if(s&&r!=="uint16"){r="uint32"}else{r="uint16"}}if(r===e.dtype&&f(e.shape,e.stride)){if(e.offset===0&&e.data.length===e.shape[0]){this.length=u(this.gl,this.type,this.length,this.usage,e.data,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t)}}else{var l=n.malloc(e.size,r);var h=i(l,e.shape);a.assign(h,e);if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,l,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,l.subarray(0,e.size),t)}n.free(l)}}else if(Array.isArray(e)){var p;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){p=c(e,"uint16")}else{p=c(e,"float32")}if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,p,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,p.subarray(0,e.length),t)}n.free(p)}else if(typeof e==="object"&&typeof e.length==="number"){this.length=u(this.gl,this.type,this.length,this.usage,e,t)}else if(typeof e==="number"||e===undefined){if(t>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}e=e|0;if(e<=0){e=1}this.gl.bufferData(this.type,e|0,this.usage);this.length=e}else{throw new Error("gl-buffer: Invalid data type")}};function h(e,t,r,n){r=r||e.ARRAY_BUFFER;n=n||e.DYNAMIC_DRAW;if(r!==e.ARRAY_BUFFER&&r!==e.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(n!==e.DYNAMIC_DRAW&&n!==e.STATIC_DRAW&&n!==e.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var a=e.createBuffer();var i=new s(e,r,a,0,n);i.update(t);return i}t.exports=h},{ndarray:495,"ndarray-ops":490,"typedarray-pool":595}],260:[function(e,t,r){"use strict";var n=e("gl-vec3");t.exports=function(e,t){var r=e.positions;var a=e.vectors;var i={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(e.positions.length===0){if(t){t[0]=[0,0,0];t[1]=[0,0,0]}return i}var o=0;var s=Infinity,l=-Infinity;var u=Infinity,c=-Infinity;var f=Infinity,h=-Infinity;var p=null;var d=null;var v=[];var m=Infinity;var g=false;for(var y=0;y<r.length;y++){var x=r[y];s=Math.min(x[0],s);l=Math.max(x[0],l);u=Math.min(x[1],u);c=Math.max(x[1],c);f=Math.min(x[2],f);h=Math.max(x[2],h);var _=a[y];if(n.length(_)>o){o=n.length(_)}if(y){var b=2*n.distance(p,x)/(n.length(d)+n.length(_));if(b){m=Math.min(m,b);g=false}else{g=true}}if(!g){p=x;d=_}v.push(_)}var w=[s,u,f];var T=[l,c,h];if(t){t[0]=w;t[1]=T}if(o===0){o=1}var k=1/o;if(!isFinite(m)){m=1}i.vectorScale=m;var A=e.coneSize||.5;if(e.absoluteConeSize){A=e.absoluteConeSize*k}i.coneScale=A;for(var y=0,M=0;y<r.length;y++){var x=r[y];var E=x[0],S=x[1],C=x[2];var L=v[y];var I=n.length(L)*k;for(var O=0,P=8;O<P;O++){i.positions.push([E,S,C,M++]);i.positions.push([E,S,C,M++]);i.positions.push([E,S,C,M++]);i.positions.push([E,S,C,M++]);i.positions.push([E,S,C,M++]);i.positions.push([E,S,C,M++]);i.vectors.push(L);i.vectors.push(L);i.vectors.push(L);i.vectors.push(L);i.vectors.push(L);i.vectors.push(L);i.vertexIntensity.push(I,I,I);i.vertexIntensity.push(I,I,I);var D=i.positions.length;i.cells.push([D-6,D-5,D-4],[D-3,D-2,D-1])}}return i};var a=e("./lib/shaders");t.exports.createMesh=e("./create_mesh");t.exports.createConeMesh=function(e,r){return t.exports.createMesh(e,r,{shaders:a,traceType:"cone"})}},{"./create_mesh":261,"./lib/shaders":262,"gl-vec3":377}],261:[function(e,t,r){"use strict";var n=e("gl-shader");var a=e("gl-buffer");var i=e("gl-vao");var o=e("gl-texture2d");var s=e("gl-mat4/multiply");var l=e("gl-mat4/invert");var u=e("ndarray");var c=e("colormap");var f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function h(e,t,r,n,a,i,o,s,l,u,c){this.gl=e;this.pixelRatio=1;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.pickShader=n;this.trianglePositions=a;this.triangleVectors=i;this.triangleColors=s;this.triangleUVs=l;this.triangleIds=o;this.triangleVAO=u;this.triangleCount=0;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.traceType=c;this.tubeScale=1;this.coneScale=2;this.vectorScale=1;this.coneOffset=.25;this._model=f;this._view=f;this._projection=f;this._resolution=[1,1]}var p=h.prototype;p.isOpaque=function(){return this.opacity>=1};p.isTransparent=function(){return this.opacity<1};p.pickSlots=1;p.setPickBase=function(e){this.pickId=e};function d(e){var t=c({colormap:e,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var a=t[n];for(var i=0;i<3;++i){r[4*n+i]=a[i]}r[4*n+3]=a[3]*255}return u(r,[256,256,4],[4,0,1])}function v(e){var t=e.length;var r=new Array(t);for(var n=0;n<t;++n){r[n]=e[n][2]}return r}p.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("lightPosition"in e){this.lightPosition=e.lightPosition}if("opacity"in e){this.opacity=e.opacity}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.tubeScale!==undefined){this.tubeScale=e.tubeScale}if(e.vectorScale!==undefined){this.vectorScale=e.vectorScale}if(e.coneScale!==undefined){this.coneScale=e.coneScale}if(e.coneOffset!==undefined){this.coneOffset=e.coneOffset}if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(d(e.colormap));this.texture.generateMipmap()}var r=e.cells;var n=e.positions;var a=e.vectors;if(!n||!r||!a){return}var i=[];var o=[];var s=[];var l=[];var u=[];this.cells=r;this.positions=n;this.vectors=a;var c=e.meshColor||[1,1,1,1];var f=e.vertexIntensity;var h=Infinity;var p=-Infinity;if(f){if(e.vertexIntensityBounds){h=+e.vertexIntensityBounds[0];p=+e.vertexIntensityBounds[1]}else{for(var m=0;m<f.length;++m){var g=f[m];h=Math.min(h,g);p=Math.max(p,g)}}}else{for(var m=0;m<n.length;++m){var g=n[m][2];h=Math.min(h,g);p=Math.max(p,g)}}if(f){this.intensity=f}else{this.intensity=v(n)}this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var m=0;m<n.length;++m){var y=n[m];for(var x=0;x<3;++x){if(isNaN(y[x])||!isFinite(y[x])){continue}this.bounds[0][x]=Math.min(this.bounds[0][x],y[x]);this.bounds[1][x]=Math.max(this.bounds[1][x],y[x])}}var _=0;e:for(var m=0;m<r.length;++m){var b=r[m];switch(b.length){case 3:for(var x=0;x<3;++x){var w=b[x];var y=n[w];for(var T=0;T<3;++T){if(isNaN(y[T])||!isFinite(y[T])){continue e}}}for(var x=0;x<3;++x){var w=b[2-x];var y=n[w];i.push(y[0],y[1],y[2],y[3]);var k=a[w];o.push(k[0],k[1],k[2],k[3]||0);var A=c;if(A.length===3){s.push(A[0],A[1],A[2],1)}else{s.push(A[0],A[1],A[2],A[3])}var M;if(f){M=[(f[w]-h)/(p-h),0]}else{M=[(y[2]-h)/(p-h),0]}l.push(M[0],M[1]);u.push(m)}_+=1;break;default:break}}this.triangleCount=_;this.trianglePositions.update(i);this.triangleVectors.update(o);this.triangleColors.update(s);this.triangleUVs.update(l);this.triangleIds.update(new Uint32Array(u))};p.drawTransparent=p.draw=function(e){e=e||{};var t=this.gl;var r=e.model||f;var n=e.view||f;var a=e.projection||f;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var u={model:r,view:n,projection:a,inverseModel:f.slice(),clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};u.inverseModel=l(u.inverseModel,u.model);t.disable(t.CULL_FACE);this.texture.bind(0);var c=new Array(16);s(c,u.view,u.model);s(c,u.projection,c);l(c,c);for(var o=0;o<3;++o){u.eyePosition[o]=c[12+o]/c[15]}var h=c[15];for(var o=0;o<3;++o){h+=this.lightPosition[o]*c[4*o+3]}for(var o=0;o<3;++o){var p=c[12+o];for(var d=0;d<3;++d){p+=c[4*d+o]*this.lightPosition[d]}u.lightPosition[o]=p/h}if(this.triangleCount>0){var v=this.triShader;v.bind();v.uniforms=u;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}};p.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||f;var n=e.view||f;var a=e.projection||f;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(a);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:n,projection:a,clipBounds:i,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}};p.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var n=this.positions[r[1]].slice(0,3);var a={position:n,dataCoordinate:n,index:Math.floor(r[1]/48)};if(this.traceType==="cone"){a.index=Math.floor(r[1]/48)}else if(this.traceType==="streamtube"){a.intensity=this.intensity[r[1]];a.velocity=this.vectors[r[1]].slice(0,3);a.divergence=this.vectors[r[1]][3];a.index=t}return a};p.dispose=function(){this.texture.dispose();this.triShader.dispose();this.pickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleVectors.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleIds.dispose()};function m(e,t){var r=n(e,t.meshShader.vertex,t.meshShader.fragment,null,t.meshShader.attributes);r.attributes.position.location=0;r.attributes.color.location=2;r.attributes.uv.location=3;r.attributes.vector.location=4;return r}function g(e,t){var r=n(e,t.pickShader.vertex,t.pickShader.fragment,null,t.pickShader.attributes);r.attributes.position.location=0;r.attributes.id.location=1;r.attributes.vector.location=4;return r}function y(e,t,r){var n=r.shaders;if(arguments.length===1){t=e;e=t.gl}var s=m(e,n);var l=g(e,n);var c=o(e,u(new Uint8Array([255,255,255,255]),[1,1,4]));c.generateMipmap();c.minFilter=e.LINEAR_MIPMAP_LINEAR;c.magFilter=e.LINEAR;var f=a(e);var p=a(e);var d=a(e);var v=a(e);var y=a(e);var x=i(e,[{buffer:f,type:e.FLOAT,size:4},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:d,type:e.FLOAT,size:4},{buffer:v,type:e.FLOAT,size:2},{buffer:p,type:e.FLOAT,size:4}]);var _=new h(e,c,s,l,f,p,y,d,v,x,r.traceType||"cone");_.update(t);return _}t.exports=y},{colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":335,"gl-texture2d":353,"gl-vao":358,ndarray:495}],262:[function(e,t,r){var n=e("glslify");var a=n(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]);var i=n(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]);var o=n(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:a,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:263}],263:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],264:[function(e,t,r){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34000:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],265:[function(e,t,r){var n=e("./1.0/numbers");t.exports=function e(t){return n[t]}},{"./1.0/numbers":264}],266:[function(e,t,r){"use strict";t.exports=h;var n=e("gl-buffer");var a=e("gl-vao");var i=e("./shaders/index");var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(e,t,r,n){this.gl=e;this.shader=n;this.buffer=t;this.vao=r;this.pixelRatio=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lineWidth=[1,1,1];this.capSize=[10,10,10];this.lineCount=[0,0,0];this.lineOffset=[0,0,0];this.opacity=1;this.hasAlpha=false}var l=s.prototype;l.isOpaque=function(){return!this.hasAlpha};l.isTransparent=function(){return this.hasAlpha};l.drawTransparent=l.draw=function(e){var t=this.gl;var r=this.shader.uniforms;this.shader.bind();var n=r.view=e.view||o;var a=r.projection=e.projection||o;r.model=e.model||o;r.clipBounds=this.clipBounds;r.opacity=this.opacity;var i=n[12];var s=n[13];var l=n[14];var u=n[15];var c=e._ortho||false;var f=c?2:1;var h=f*this.pixelRatio*(a[3]*i+a[7]*s+a[11]*l+a[15]*u)/t.drawingBufferHeight;this.vao.bind();for(var p=0;p<3;++p){t.lineWidth(this.lineWidth[p]*this.pixelRatio);r.capSize=this.capSize[p]*h;if(this.lineCount[p]){t.drawArrays(t.LINES,this.lineOffset[p],this.lineCount[p])}}this.vao.unbind()};function u(e,t){for(var r=0;r<3;++r){e[0][r]=Math.min(e[0][r],t[r]);e[1][r]=Math.max(e[1][r],t[r])}}var c=function(){var e=new Array(3);for(var t=0;t<3;++t){var r=[];for(var n=1;n<=2;++n){for(var a=-1;a<=1;a+=2){var i=(n+t)%3;var o=[0,0,0];o[i]=a;r.push(o)}}e[t]=r}return e}();function f(e,t,r,n){var a=c[n];for(var i=0;i<a.length;++i){var o=a[i];e.push(t[0],t[1],t[2],r[0],r[1],r[2],r[3],o[0],o[1],o[2])}return a.length}l.update=function(e){e=e||{};if("lineWidth"in e){this.lineWidth=e.lineWidth;if(!Array.isArray(this.lineWidth)){this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth]}}if("capSize"in e){this.capSize=e.capSize;if(!Array.isArray(this.capSize)){this.capSize=[this.capSize,this.capSize,this.capSize]}}this.hasAlpha=false;if("opacity"in e){this.opacity=+e.opacity;if(this.opacity<1){this.hasAlpha=true}}var t=e.color||[[0,0,0],[0,0,0],[0,0,0]];var r=e.position;var n=e.error;if(!Array.isArray(t[0])){t=[t,t,t]}if(r&&n){var a=[];var i=r.length;var o=0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.lineCount=[0,0,0];for(var s=0;s<3;++s){this.lineOffset[s]=o;e:for(var l=0;l<i;++l){var c=r[l];for(var h=0;h<3;++h){if(isNaN(c[h])||!isFinite(c[h])){continue e}}var p=n[l];var d=t[s];if(Array.isArray(d[0])){d=t[l]}if(d.length===3){d=[d[0],d[1],d[2],1]}else if(d.length===4){d=[d[0],d[1],d[2],d[3]];if(!this.hasAlpha&&d[3]<1)this.hasAlpha=true}if(isNaN(p[0][s])||isNaN(p[1][s])){continue}if(p[0][s]<0){var v=c.slice();v[s]+=p[0][s];a.push(c[0],c[1],c[2],d[0],d[1],d[2],d[3],0,0,0,v[0],v[1],v[2],d[0],d[1],d[2],d[3],0,0,0);u(this.bounds,v);o+=2+f(a,v,d,s)}if(p[1][s]>0){var v=c.slice();v[s]+=p[1][s];a.push(c[0],c[1],c[2],d[0],d[1],d[2],d[3],0,0,0,v[0],v[1],v[2],d[0],d[1],d[2],d[3],0,0,0);u(this.bounds,v);o+=2+f(a,v,d,s)}}this.lineCount[s]=o-this.lineOffset[s]}this.buffer.update(a)}};l.dispose=function(){this.shader.dispose();this.buffer.dispose();this.vao.dispose()};function h(e){var t=e.gl;var r=n(t);var o=a(t,[{buffer:r,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:r,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:r,type:t.FLOAT,size:3,offset:28,stride:40}]);var l=i(t);l.attributes.position.location=0;l.attributes.color.location=1;l.attributes.offset.location=2;var u=new s(t,r,o,l);u.update(e);return u}},{"./shaders/index":268,"gl-buffer":259,"gl-vao":358}],267:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],268:[function(e,t,r){"use strict";var n=e("glslify");var a=e("gl-shader");var i=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);t.exports=function(e){return a(e,i,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":335,glslify:267}],269:[function(e,t,r){"use strict";var n=e("gl-texture2d");t.exports=x;var a=null;var i;var o;var s;var l;function u(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING);var r=e.getParameter(e.RENDERBUFFER_BINDING);var n=e.getParameter(e.TEXTURE_BINDING_2D);return[t,r,n]}function c(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]);e.bindRenderbuffer(e.RENDERBUFFER,t[1]);e.bindTexture(e.TEXTURE_2D,t[2])}function f(e,t){var r=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);a=new Array(r+1);for(var n=0;n<=r;++n){var i=new Array(r);for(var o=0;o<n;++o){i[o]=e.COLOR_ATTACHMENT0+o}for(var o=n;o<r;++o){i[o]=e.NONE}a[n]=i}}function h(e){switch(e){case i:throw new Error("gl-fbo: Framebuffer unsupported");case o:throw new Error("gl-fbo: Framebuffer incomplete attachment");case s:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case l:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function p(e,t,r,a,i,o){if(!a){return null}var s=n(e,t,r,i,a);s.magFilter=e.NEAREST;s.minFilter=e.NEAREST;s.mipSamples=1;s.bind();e.framebufferTexture2D(e.FRAMEBUFFER,o,e.TEXTURE_2D,s.handle,0);return s}function d(e,t,r,n,a){var i=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,i);e.renderbufferStorage(e.RENDERBUFFER,n,t,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,a,e.RENDERBUFFER,i);return i}function v(e){var t=u(e.gl);var r=e.gl;var n=e.handle=r.createFramebuffer();var i=e._shape[0];var o=e._shape[1];var s=e.color.length;var l=e._ext;var f=e._useStencil;var v=e._useDepth;var m=e._colorType;r.bindFramebuffer(r.FRAMEBUFFER,n);for(var g=0;g<s;++g){e.color[g]=p(r,i,o,m,r.RGBA,r.COLOR_ATTACHMENT0+g)}if(s===0){e._color_rb=d(r,i,o,r.RGBA4,r.COLOR_ATTACHMENT0);if(l){l.drawBuffersWEBGL(a[0])}}else if(s>1){l.drawBuffersWEBGL(a[s])}var y=r.getExtension("WEBGL_depth_texture");if(y){if(f){e.depth=p(r,i,o,y.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(v){e.depth=p(r,i,o,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)}}else{if(v&&f){e._depth_rb=d(r,i,o,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(v){e._depth_rb=d(r,i,o,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT)}else if(f){e._depth_rb=d(r,i,o,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT)}}var x=r.checkFramebufferStatus(r.FRAMEBUFFER);if(x!==r.FRAMEBUFFER_COMPLETE){e._destroyed=true;r.bindFramebuffer(r.FRAMEBUFFER,null);r.deleteFramebuffer(e.handle);e.handle=null;if(e.depth){e.depth.dispose();e.depth=null}if(e._depth_rb){r.deleteRenderbuffer(e._depth_rb);e._depth_rb=null}for(var g=0;g<e.color.length;++g){e.color[g].dispose();e.color[g]=null}if(e._color_rb){r.deleteRenderbuffer(e._color_rb);e._color_rb=null}c(r,t);h(x)}c(r,t)}function m(e,t,r,n,a,i,o,s){this.gl=e;this._shape=[t|0,r|0];this._destroyed=false;this._ext=s;this.color=new Array(a);for(var l=0;l<a;++l){this.color[l]=null}this._color_rb=null;this.depth=null;this._depth_rb=null;this._colorType=n;this._useDepth=i;this._useStencil=o;var u=this;var c=[t|0,r|0];Object.defineProperties(c,{0:{get:function(){return u._shape[0]},set:function(e){return u.width=e}},1:{get:function(){return u._shape[1]},set:function(e){return u.height=e}}});this._shapeVector=c;v(this)}var g=m.prototype;function y(e,t,r){if(e._destroyed){throw new Error("gl-fbo: Can't resize destroyed FBO")}if(e._shape[0]===t&&e._shape[1]===r){return}var n=e.gl;var a=n.getParameter(n.MAX_RENDERBUFFER_SIZE);if(t<0||t>a||r<0||r>a){throw new Error("gl-fbo: Can't resize FBO, invalid dimensions")}e._shape[0]=t;e._shape[1]=r;var i=u(n);for(var o=0;o<e.color.length;++o){e.color[o].shape=e._shape}if(e._color_rb){n.bindRenderbuffer(n.RENDERBUFFER,e._color_rb);n.renderbufferStorage(n.RENDERBUFFER,n.RGBA4,e._shape[0],e._shape[1])}if(e.depth){e.depth.shape=e._shape}if(e._depth_rb){n.bindRenderbuffer(n.RENDERBUFFER,e._depth_rb);if(e._useDepth&&e._useStencil){n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e._shape[0],e._shape[1])}else if(e._useDepth){n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e._shape[0],e._shape[1])}else if(e._useStencil){n.renderbufferStorage(n.RENDERBUFFER,n.STENCIL_INDEX,e._shape[0],e._shape[1])}}n.bindFramebuffer(n.FRAMEBUFFER,e.handle);var s=n.checkFramebufferStatus(n.FRAMEBUFFER);if(s!==n.FRAMEBUFFER_COMPLETE){e.dispose();c(n,i);h(s)}c(n,i)}Object.defineProperties(g,{shape:{get:function(){if(this._destroyed){return[0,0]}return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}if(e.length!==2){throw new Error("gl-fbo: Shape vector must be length 2")}var t=e[0]|0;var r=e[1]|0;y(this,t,r);return[t,r]},enumerable:false},width:{get:function(){if(this._destroyed){return 0}return this._shape[0]},set:function(e){e=e|0;y(this,e,this._shape[1]);return e},enumerable:false},height:{get:function(){if(this._destroyed){return 0}return this._shape[1]},set:function(e){e=e|0;y(this,this._shape[0],e);return e},enumerable:false}});g.bind=function(){if(this._destroyed){return}var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle);e.viewport(0,0,this._shape[0],this._shape[1])};g.dispose=function(){if(this._destroyed){return}this._destroyed=true;var e=this.gl;e.deleteFramebuffer(this.handle);this.handle=null;if(this.depth){this.depth.dispose();this.depth=null}if(this._depth_rb){e.deleteRenderbuffer(this._depth_rb);this._depth_rb=null}for(var t=0;t<this.color.length;++t){this.color[t].dispose();this.color[t]=null}if(this._color_rb){e.deleteRenderbuffer(this._color_rb);this._color_rb=null}};function x(e,t,r,n){if(!i){i=e.FRAMEBUFFER_UNSUPPORTED;o=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;s=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS;l=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT}var u=e.getExtension("WEBGL_draw_buffers");if(!a&&u){f(e,u)}if(Array.isArray(t)){n=r;r=t[1]|0;t=t[0]|0}if(typeof t!=="number"){throw new Error("gl-fbo: Missing shape parameter")}var c=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(t<0||t>c||r<0||r>c){throw new Error("gl-fbo: Parameters are too large for FBO")}n=n||{};var h=1;if("color"in n){h=Math.max(n.color|0,0);if(h<0){throw new Error("gl-fbo: Must specify a nonnegative number of colors")}if(h>1){if(!u){throw new Error("gl-fbo: Multiple draw buffer extension not supported")}else if(h>e.getParameter(u.MAX_COLOR_ATTACHMENTS_WEBGL)){throw new Error("gl-fbo: Context does not support "+h+" draw buffers")}}}var p=e.UNSIGNED_BYTE;var d=e.getExtension("OES_texture_float");if(n.float&&h>0){if(!d){throw new Error("gl-fbo: Context does not support floating point textures")}p=e.FLOAT}else if(n.preferFloat&&h>0){if(d){p=e.FLOAT}}var v=true;if("depth"in n){v=!!n.depth}var g=false;if("stencil"in n){g=!!n.stencil}return new m(e,t,r,p,h,v,g,u)}},{"gl-texture2d":353}],270:[function(e,t,r){var n=e("sprintf-js").sprintf;var a=e("gl-constants/lookup");var i=e("glsl-shader-name");var o=e("add-line-numbers");t.exports=s;function s(e,t,r){"use strict";var s=i(t)||"of unknown name (see npm glsl-shader-name)";var l="unknown type";if(r!==undefined){l=r===a.FRAGMENT_SHADER?"fragment":"vertex"}var u=n("Error compiling %s shader %s:\n",l,s);var c=n("%s%s",u,e);var f=e.split("\n");var h={};for(var p=0;p<f.length;p++){var d=f[p];if(d===""||d==="\0")continue;var v=parseInt(d.split(":")[2]);if(isNaN(v)){throw new Error(n("Could not parse error: %s",d))}h[v]=d}var m=o(t).split("\n");for(var p=0;p<m.length;p++){if(!h[p+3]&&!h[p+2]&&!h[p+1])continue;var g=m[p];u+=g+"\n";if(h[p+1]){var y=h[p+1];y=y.substr(y.split(":",3).join(":").length+1).trim();u+=n("^^^ %s\n\n",y)}}return{long:u.trim(),short:c.trim()}}},{"add-line-numbers":66,"gl-constants/lookup":265,"glsl-shader-name":431,"sprintf-js":567}],271:[function(e,t,r){"use strict";t.exports=h;var n=e("binary-search-bounds");var a=e("iota-array");var i=e("typedarray-pool");var o=e("gl-shader");var s=e("gl-buffer");var l=e("./lib/shaders");function u(e,t,r,n,a,i,o){this.plot=e;this.shader=t;this.pickShader=r;this.positionBuffer=n;this.weightBuffer=a;this.colorBuffer=i;this.idBuffer=o;this.xData=[];this.yData=[];this.shape=[0,0];this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.pickOffset=0}var c=u.prototype;var f=[0,0,1,0,0,1,1,0,1,1,0,1];c.draw=function(){var e=[1,0,0,0,1,0,0,0,1];return function(){var t=this.plot;var r=this.shader;var n=this.bounds;var a=this.numVertices;if(a<=0){return}var i=t.gl;var o=t.dataBox;var s=n[2]-n[0];var l=n[3]-n[1];var u=o[2]-o[0];var c=o[3]-o[1];e[0]=2*s/u;e[4]=2*l/c;e[6]=2*(n[0]-o[0])/u-1;e[7]=2*(n[1]-o[1])/c-1;r.bind();var f=r.uniforms;f.viewTransform=e;f.shape=this.shape;var h=r.attributes;this.positionBuffer.bind();h.position.pointer();this.weightBuffer.bind();h.weight.pointer(i.UNSIGNED_BYTE,false);this.colorBuffer.bind();h.color.pointer(i.UNSIGNED_BYTE,true);i.drawArrays(i.TRIANGLES,0,a)}}();c.drawPick=function(){var e=[1,0,0,0,1,0,0,0,1];var t=[0,0,0,0];return function(r){var n=this.plot;var a=this.pickShader;var i=this.bounds;var o=this.numVertices;if(o<=0){return}var s=n.gl;var l=n.dataBox;var u=i[2]-i[0];var c=i[3]-i[1];var f=l[2]-l[0];var h=l[3]-l[1];e[0]=2*u/f;e[4]=2*c/h;e[6]=2*(i[0]-l[0])/f-1;e[7]=2*(i[1]-l[1])/h-1;for(var p=0;p<4;++p){t[p]=r>>p*8&255}this.pickOffset=r;a.bind();var d=a.uniforms;d.viewTransform=e;d.pickOffset=t;d.shape=this.shape;var v=a.attributes;this.positionBuffer.bind();v.position.pointer();this.weightBuffer.bind();v.weight.pointer(s.UNSIGNED_BYTE,false);this.idBuffer.bind();v.pickId.pointer(s.UNSIGNED_BYTE,false);s.drawArrays(s.TRIANGLES,0,o);return r+this.shape[0]*this.shape[1]}}();c.pick=function(e,t,r){var n=this.pickOffset;var a=this.shape[0]*this.shape[1];if(r<n||r>=n+a){return null}var i=r-n;var o=this.xData;var s=this.yData;return{object:this,pointId:i,dataCoord:[o[i%this.shape[0]],s[i/this.shape[0]|0]]}};c.update=function(e){e=e||{};var t=e.shape||[0,0];var r=e.x||a(t[0]);var o=e.y||a(t[1]);var s=e.z||new Float32Array(t[0]*t[1]);var l=e.zsmooth!==false;this.xData=r;this.yData=o;var u=e.colorLevels||[0];var c=e.colorValues||[0,0,0,1];var h=u.length;var p=this.bounds;var d,v,m,g;if(l){d=p[0]=r[0];v=p[1]=o[0];m=p[2]=r[r.length-1];g=p[3]=o[o.length-1]}else{d=p[0]=r[0]+(r[1]-r[0])/2;v=p[1]=o[0]+(o[1]-o[0])/2;m=p[2]=r[r.length-1]+(r[r.length-1]-r[r.length-2])/2;g=p[3]=o[o.length-1]+(o[o.length-1]-o[o.length-2])/2}var y=1/(m-d);var x=1/(g-v);var _=t[0];var b=t[1];this.shape=[_,b];var w=(l?(_-1)*(b-1):_*b)*(f.length>>>1);this.numVertices=w;var T=i.mallocUint8(w*4);var k=i.mallocFloat32(w*2);var A=i.mallocUint8(w*2);var M=i.mallocUint32(w);var E=0;var S=l?_-1:_;var C=l?b-1:b;for(var L=0;L<C;++L){var I,O;if(l){I=x*(o[L]-v);O=x*(o[L+1]-v)}else{I=L<b-1?x*(o[L]-(o[L+1]-o[L])/2-v):x*(o[L]-(o[L]-o[L-1])/2-v);O=L<b-1?x*(o[L]+(o[L+1]-o[L])/2-v):x*(o[L]+(o[L]-o[L-1])/2-v)}for(var P=0;P<S;++P){var D,R;if(l){D=y*(r[P]-d);R=y*(r[P+1]-d)}else{D=P<_-1?y*(r[P]-(r[P+1]-r[P])/2-d):y*(r[P]-(r[P]-r[P-1])/2-d);R=P<_-1?y*(r[P]+(r[P+1]-r[P])/2-d):y*(r[P]+(r[P]-r[P-1])/2-d)}for(var z=0;z<f.length;z+=2){var N=f[z];var F=f[z+1];var B=l?(L+F)*_+(P+N):L*_+P;var j=s[B];var U=n.le(u,j);var H,V,G,q;if(U<0){H=c[0];V=c[1];G=c[2];q=c[3]}else if(U===h-1){H=c[4*h-4];V=c[4*h-3];G=c[4*h-2];q=c[4*h-1]}else{var Y=(j-u[U])/(u[U+1]-u[U]);var W=1-Y;var X=4*U;var Z=4*(U+1);H=W*c[X]+Y*c[Z];V=W*c[X+1]+Y*c[Z+1];G=W*c[X+2]+Y*c[Z+2];q=W*c[X+3]+Y*c[Z+3]}T[4*E]=255*H;T[4*E+1]=255*V;T[4*E+2]=255*G;T[4*E+3]=255*q;k[2*E]=D*.5+R*.5;k[2*E+1]=I*.5+O*.5;A[2*E]=N;A[2*E+1]=F;M[E]=L*_+P;E+=1}}}this.positionBuffer.update(k);this.weightBuffer.update(A);this.colorBuffer.update(T);this.idBuffer.update(M);i.free(k);i.free(T);i.free(A);i.free(M)};c.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.positionBuffer.dispose();this.weightBuffer.dispose();this.colorBuffer.dispose();this.idBuffer.dispose();this.plot.removeObject(this)};function h(e,t){var r=e.gl;var n=o(r,l.vertex,l.fragment);var a=o(r,l.pickVertex,l.pickFragment);var i=s(r);var c=s(r);var f=s(r);var h=s(r);var p=new u(e,n,a,i,c,f,h);p.update(t);e.addObject(p);return p}},{"./lib/shaders":272,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335,"iota-array":463,"typedarray-pool":595}],272:[function(e,t,r){"use strict";var n=e("glslify");t.exports={fragment:n(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:273}],273:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],274:[function(e,t,r){var n=e("glslify");var a=e("gl-shader");var i=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]);var s=n(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]);var l=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];r.createShader=function(e){return a(e,i,o,null,l)};r.createPickShader=function(e){return a(e,i,s,null,l)}},{"gl-shader":335,glslify:276}],275:[function(e,t,r){"use strict";t.exports=_;var n=e("gl-buffer");var a=e("gl-vao");var i=e("gl-texture2d");var o=new Uint8Array(4);var s=new Float32Array(o.buffer);function l(e,t,r,n){o[0]=n;o[1]=r;o[2]=t;o[3]=e;return s[0]}var u=e("binary-search-bounds");var c=e("ndarray");var f=e("./lib/shaders");var h=f.createShader;var p=f.createPickShader;var d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function v(e,t){var r=0;for(var n=0;n<3;++n){var a=e[n]-t[n];r+=a*a}return Math.sqrt(r)}function m(e){var t=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var r=0;r<3;++r){t[0][r]=Math.max(e[0][r],t[0][r]);t[1][r]=Math.min(e[1][r],t[1][r])}return t}function g(e,t,r,n){this.arcLength=e;this.position=t;this.index=r;this.dataCoordinate=n}function y(e,t,r,n,a,i){this.gl=e;this.shader=t;this.pickShader=r;this.buffer=n;this.vao=a;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.points=[];this.arcLength=[];this.vertexCount=0;this.bounds=[[0,0,0],[0,0,0]];this.pickId=0;this.lineWidth=1;this.texture=i;this.dashScale=1;this.opacity=1;this.hasAlpha=false;this.dirty=true;this.pixelRatio=1}var x=y.prototype;x.isTransparent=function(){return this.hasAlpha};x.isOpaque=function(){return!this.hasAlpha};x.pickSlots=1;x.setPickBase=function(e){this.pickId=e};x.drawTransparent=x.draw=function(e){if(!this.vertexCount)return;var t=this.gl;var r=this.shader;var n=this.vao;r.bind();r.uniforms={model:e.model||d,view:e.view||d,projection:e.projection||d,clipBounds:m(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};n.bind();n.draw(t.TRIANGLE_STRIP,this.vertexCount);n.unbind()};x.drawPick=function(e){if(!this.vertexCount)return;var t=this.gl;var r=this.pickShader;var n=this.vao;r.bind();r.uniforms={model:e.model||d,view:e.view||d,projection:e.projection||d,pickId:this.pickId,clipBounds:m(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};n.bind();n.draw(t.TRIANGLE_STRIP,this.vertexCount);n.unbind()};x.update=function(e){var t,r;this.dirty=true;var n=!!e.connectGaps;if("dashScale"in e){this.dashScale=e.dashScale}this.hasAlpha=false;if("opacity"in e){this.opacity=+e.opacity;if(this.opacity<1){this.hasAlpha=true}}var a=[];var i=[];var o=[];var s=0;var l=0;var f=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var h=e.position||e.positions;if(h){var p=e.color||e.colors||[0,0,0,1];var d=e.lineWidth||1;var m=false;e:for(t=1;t<h.length;++t){var g=h[t-1];var y=h[t];i.push(s);o.push(g.slice());for(r=0;r<3;++r){if(isNaN(g[r])||isNaN(y[r])||!isFinite(g[r])||!isFinite(y[r])){if(!n&&a.length>0){for(var x=0;x<24;++x){a.push(a[a.length-12])}l+=2;m=true}continue e}f[0][r]=Math.min(f[0][r],g[r],y[r]);f[1][r]=Math.max(f[1][r],g[r],y[r])}var _,b;if(Array.isArray(p[0])){_=p.length>t-1?p[t-1]:p.length>0?p[p.length-1]:[0,0,0,1];b=p.length>t?p[t]:p.length>0?p[p.length-1]:[0,0,0,1]}else{_=b=p}if(_.length===3){_=[_[0],_[1],_[2],1]}if(b.length===3){b=[b[0],b[1],b[2],1]}if(!this.hasAlpha&&_[3]<1)this.hasAlpha=true;var w;if(Array.isArray(d)){w=d.length>t-1?d[t-1]:d.length>0?d[d.length-1]:[0,0,0,1]}else{w=d}var T=s;s+=v(g,y);if(m){for(r=0;r<2;++r){a.push(g[0],g[1],g[2],y[0],y[1],y[2],T,w,_[0],_[1],_[2],_[3])}l+=2;m=false}a.push(g[0],g[1],g[2],y[0],y[1],y[2],T,w,_[0],_[1],_[2],_[3],g[0],g[1],g[2],y[0],y[1],y[2],T,-w,_[0],_[1],_[2],_[3],y[0],y[1],y[2],g[0],g[1],g[2],s,-w,b[0],b[1],b[2],b[3],y[0],y[1],y[2],g[0],g[1],g[2],s,w,b[0],b[1],b[2],b[3]);l+=4}}this.buffer.update(a);i.push(s);o.push(h[h.length-1].slice());this.bounds=f;this.vertexCount=l;this.points=o;this.arcLength=i;if("dashes"in e){var k=e.dashes;var A=k.slice();A.unshift(0);for(t=1;t<A.length;++t){A[t]=A[t-1]+A[t]}var M=c(new Array(256*4),[256,1,4]);for(t=0;t<256;++t){for(r=0;r<4;++r){M.set(t,0,r,0)}if(u.le(A,A[A.length-1]*t/255)&1){M.set(t,0,0,0)}else{M.set(t,0,0,255)}}this.texture.setPixels(M)}};x.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};x.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=l(e.value[0],e.value[1],e.value[2],0);var r=u.le(this.arcLength,t);if(r<0){return null}if(r===this.arcLength.length-1){return new g(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),r)}var n=this.points[r];var a=this.points[Math.min(r+1,this.points.length-1)];var i=(t-this.arcLength[r])/(this.arcLength[r+1]-this.arcLength[r]);var o=1-i;var s=[0,0,0];for(var c=0;c<3;++c){s[c]=o*n[c]+i*a[c]}var f=Math.min(i<.5?r:r+1,this.points.length-1);return new g(t,s,f,this.points[f])};function _(e){var t=e.gl||e.scene&&e.scene.gl;var r=h(t);r.attributes.position.location=0;r.attributes.nextPosition.location=1;r.attributes.arcLength.location=2;r.attributes.lineWidth.location=3;r.attributes.color.location=4;var o=p(t);o.attributes.position.location=0;o.attributes.nextPosition.location=1;o.attributes.arcLength.location=2;o.attributes.lineWidth.location=3;o.attributes.color.location=4;var s=n(t);var l=a(t,[{buffer:s,size:3,offset:0,stride:48},{buffer:s,size:3,offset:12,stride:48},{buffer:s,size:1,offset:24,stride:48},{buffer:s,size:1,offset:28,stride:48},{buffer:s,size:4,offset:32,stride:48}]);var u=c(new Array(256*4),[256,1,4]);for(var f=0;f<256*4;++f){u.data[f]=255}var d=i(t,u);d.wrap=t.REPEAT;var v=new y(t,r,o,s,l,d);v.update(e);return v}},{"./lib/shaders":274,"binary-search-bounds":96,"gl-buffer":259,"gl-texture2d":353,"gl-vao":358,ndarray:495}],276:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],277:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15];e[0]=s*(h*g-p*m)-f*(l*g-u*m)+v*(l*p-u*h);e[1]=-(n*(h*g-p*m)-f*(a*g-i*m)+v*(a*p-i*h));e[2]=n*(l*g-u*m)-s*(a*g-i*m)+v*(a*u-i*l);e[3]=-(n*(l*p-u*h)-s*(a*p-i*h)+f*(a*u-i*l));e[4]=-(o*(h*g-p*m)-c*(l*g-u*m)+d*(l*p-u*h));e[5]=r*(h*g-p*m)-c*(a*g-i*m)+d*(a*p-i*h);e[6]=-(r*(l*g-u*m)-o*(a*g-i*m)+d*(a*u-i*l));e[7]=r*(l*p-u*h)-o*(a*p-i*h)+c*(a*u-i*l);e[8]=o*(f*g-p*v)-c*(s*g-u*v)+d*(s*p-u*f);e[9]=-(r*(f*g-p*v)-c*(n*g-i*v)+d*(n*p-i*f));e[10]=r*(s*g-u*v)-o*(n*g-i*v)+d*(n*u-i*s);e[11]=-(r*(s*p-u*f)-o*(n*p-i*f)+c*(n*u-i*s));e[12]=-(o*(f*m-h*v)-c*(s*m-l*v)+d*(s*h-l*f));e[13]=r*(f*m-h*v)-c*(n*m-a*v)+d*(n*h-a*f);e[14]=-(r*(s*m-l*v)-o*(n*m-a*v)+d*(n*l-a*s));e[15]=r*(s*h-l*f)-o*(n*h-a*f)+c*(n*l-a*s);return e}},{}],278:[function(e,t,r){t.exports=n;function n(e){var t=new Float32Array(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}},{}],279:[function(e,t,r){t.exports=n;function n(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],280:[function(e,t,r){t.exports=n;function n(){var e=new Float32Array(16);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],281:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15],g=t*o-r*i,y=t*s-n*i,x=t*l-a*i,_=r*s-n*o,b=r*l-a*o,w=n*l-a*s,T=u*d-c*p,k=u*v-f*p,A=u*m-h*p,M=c*v-f*d,E=c*m-h*d,S=f*m-h*v;return g*S-y*E+x*M+_*A-b*k+w*T}},{}],282:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r+r,s=n+n,l=a+a,u=r*o,c=n*o,f=n*s,h=a*o,p=a*s,d=a*l,v=i*o,m=i*s,g=i*l;e[0]=1-f-d;e[1]=c+g;e[2]=h-m;e[3]=0;e[4]=c-g;e[5]=1-u-d;e[6]=p+v;e[7]=0;e[8]=h+m;e[9]=p-v;e[10]=1-u-f;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],283:[function(e,t,r){t.exports=n;function n(e,t,r){var n,a,i;var o=r[0];var s=r[1];var l=r[2];var u=Math.sqrt(o*o+s*s+l*l);if(Math.abs(u)<1e-6){return null}u=1/u;o*=u;s*=u;l*=u;n=Math.sin(t);a=Math.cos(t);i=1-a;e[0]=o*o*i+a;e[1]=s*o*i+l*n;e[2]=l*o*i-s*n;e[3]=0;e[4]=o*s*i-l*n;e[5]=s*s*i+a;e[6]=l*s*i+o*n;e[7]=0;e[8]=o*l*i+s*n;e[9]=s*l*i-o*n;e[10]=l*l*i+a;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],284:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=n+n,l=a+a,u=i+i,c=n*s,f=n*l,h=n*u,p=a*l,d=a*u,v=i*u,m=o*s,g=o*l,y=o*u;e[0]=1-(p+v);e[1]=f+y;e[2]=h-g;e[3]=0;e[4]=f-y;e[5]=1-(c+v);e[6]=d+m;e[7]=0;e[8]=h+g;e[9]=d-m;e[10]=1-(c+p);e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}},{}],285:[function(e,t,r){t.exports=n;function n(e,t){e[0]=t[0];e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=t[1];e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=t[2];e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],286:[function(e,t,r){t.exports=n;function n(e,t){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=t[0];e[13]=t[1];e[14]=t[2];e[15]=1;return e}},{}],287:[function(e,t,r){t.exports=n;function n(e,t){var r=Math.sin(t),n=Math.cos(t);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=n;e[6]=r;e[7]=0;e[8]=0;e[9]=-r;e[10]=n;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],288:[function(e,t,r){t.exports=n;function n(e,t){var r=Math.sin(t),n=Math.cos(t);e[0]=n;e[1]=0;e[2]=-r;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=r;e[9]=0;e[10]=n;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],289:[function(e,t,r){t.exports=n;function n(e,t){var r=Math.sin(t),n=Math.cos(t);e[0]=n;e[1]=r;e[2]=0;e[3]=0;e[4]=-r;e[5]=n;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],290:[function(e,t,r){t.exports=n;function n(e,t,r,n,a,i,o){var s=1/(r-t),l=1/(a-n),u=1/(i-o);e[0]=i*2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=i*2*l;e[6]=0;e[7]=0;e[8]=(r+t)*s;e[9]=(a+n)*l;e[10]=(o+i)*u;e[11]=-1;e[12]=0;e[13]=0;e[14]=o*i*2*u;e[15]=0;return e}},{}],291:[function(e,t,r){t.exports=n;function n(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],292:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotation:e("./fromRotation"),fromRotationTranslation:e("./fromRotationTranslation"),fromScaling:e("./fromScaling"),fromTranslation:e("./fromTranslation"),fromXRotation:e("./fromXRotation"),fromYRotation:e("./fromYRotation"),fromZRotation:e("./fromZRotation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=r*s-n*o,x=r*l-a*o,_=r*u-i*o,b=n*l-a*s,w=n*u-i*s,T=a*u-i*l,k=c*v-f*d,A=c*m-h*d,M=c*g-p*d,E=f*m-h*v,S=f*g-p*v,C=h*g-p*m,L=y*C-x*S+_*E+b*M-w*A+T*k;if(!L){return null}L=1/L;e[0]=(s*C-l*S+u*E)*L;e[1]=(a*S-n*C-i*E)*L;e[2]=(v*T-m*w+g*b)*L;e[3]=(h*w-f*T-p*b)*L;e[4]=(l*M-o*C-u*A)*L;e[5]=(r*C-a*M+i*A)*L;e[6]=(m*_-d*T-g*x)*L;e[7]=(c*T-h*_+p*x)*L;e[8]=(o*S-s*M+u*k)*L;e[9]=(n*M-r*S-i*k)*L;e[10]=(d*w-v*_+g*y)*L;e[11]=(f*_-c*w-p*y)*L;e[12]=(s*A-o*E-l*k)*L;e[13]=(r*E-n*A+a*k)*L;e[14]=(v*x-d*b-m*y)*L;e[15]=(c*b-f*x+h*y)*L;return e}},{}],294:[function(e,t,r){var n=e("./identity");t.exports=a;function a(e,t,r,a){var i,o,s,l,u,c,f,h,p,d,v=t[0],m=t[1],g=t[2],y=a[0],x=a[1],_=a[2],b=r[0],w=r[1],T=r[2];if(Math.abs(v-b)<1e-6&&Math.abs(m-w)<1e-6&&Math.abs(g-T)<1e-6){return n(e)}f=v-b;h=m-w;p=g-T;d=1/Math.sqrt(f*f+h*h+p*p);f*=d;h*=d;p*=d;i=x*p-_*h;o=_*f-y*p;s=y*h-x*f;d=Math.sqrt(i*i+o*o+s*s);if(!d){i=0;o=0;s=0}else{d=1/d;i*=d;o*=d;s*=d}l=h*s-p*o;u=p*i-f*s;c=f*o-h*i;d=Math.sqrt(l*l+u*u+c*c);if(!d){l=0;u=0;c=0}else{d=1/d;l*=d;u*=d;c*=d}e[0]=i;e[1]=l;e[2]=f;e[3]=0;e[4]=o;e[5]=u;e[6]=h;e[7]=0;e[8]=s;e[9]=c;e[10]=p;e[11]=0;e[12]=-(i*v+o*m+s*g);e[13]=-(l*v+u*m+c*g);e[14]=-(f*v+h*m+p*g);e[15]=1;return e}},{"./identity":291}],295:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],p=t[10],d=t[11],v=t[12],m=t[13],g=t[14],y=t[15];var x=r[0],_=r[1],b=r[2],w=r[3];e[0]=x*n+_*s+b*f+w*v;e[1]=x*a+_*l+b*h+w*m;e[2]=x*i+_*u+b*p+w*g;e[3]=x*o+_*c+b*d+w*y;x=r[4];_=r[5];b=r[6];w=r[7];e[4]=x*n+_*s+b*f+w*v;e[5]=x*a+_*l+b*h+w*m;e[6]=x*i+_*u+b*p+w*g;e[7]=x*o+_*c+b*d+w*y;x=r[8];_=r[9];b=r[10];w=r[11];e[8]=x*n+_*s+b*f+w*v;e[9]=x*a+_*l+b*h+w*m;e[10]=x*i+_*u+b*p+w*g;e[11]=x*o+_*c+b*d+w*y;x=r[12];_=r[13];b=r[14];w=r[15];e[12]=x*n+_*s+b*f+w*v;e[13]=x*a+_*l+b*h+w*m;e[14]=x*i+_*u+b*p+w*g;e[15]=x*o+_*c+b*d+w*y;return e}},{}],296:[function(e,t,r){t.exports=n;function n(e,t,r,n,a,i,o){var s=1/(t-r),l=1/(n-a),u=1/(i-o);e[0]=-2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*l;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*u;e[11]=0;e[12]=(t+r)*s;e[13]=(a+n)*l;e[14]=(o+i)*u;e[15]=1;return e}},{}],297:[function(e,t,r){t.exports=n;function n(e,t,r,n,a){var i=1/Math.tan(t/2),o=1/(n-a);e[0]=i/r;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=i;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(a+n)*o;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*a*n*o;e[15]=0;return e}},{}],298:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(a+i);e[0]=l;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=u;e[6]=0;e[7]=0;e[8]=-((o-s)*l*.5);e[9]=(a-i)*u*.5;e[10]=n/(r-n);e[11]=-1;e[12]=0;e[13]=0;e[14]=n*r/(r-n);e[15]=0;return e}},{}],299:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=n[0],i=n[1],o=n[2],s=Math.sqrt(a*a+i*i+o*o),l,u,c,f,h,p,d,v,m,g,y,x,_,b,w,T,k,A,M,E,S,C,L,I;if(Math.abs(s)<1e-6){return null}s=1/s;a*=s;i*=s;o*=s;l=Math.sin(r);u=Math.cos(r);c=1-u;f=t[0];h=t[1];p=t[2];d=t[3];v=t[4];m=t[5];g=t[6];y=t[7];x=t[8];_=t[9];b=t[10];w=t[11];T=a*a*c+u;k=i*a*c+o*l;A=o*a*c-i*l;M=a*i*c-o*l;E=i*i*c+u;S=o*i*c+a*l;C=a*o*c+i*l;L=i*o*c-a*l;I=o*o*c+u;e[0]=f*T+v*k+x*A;e[1]=h*T+m*k+_*A;e[2]=p*T+g*k+b*A;e[3]=d*T+y*k+w*A;e[4]=f*M+v*E+x*S;e[5]=h*M+m*E+_*S;e[6]=p*M+g*E+b*S;e[7]=d*M+y*E+w*S;e[8]=f*C+v*L+x*I;e[9]=h*C+m*L+_*I;e[10]=p*C+g*L+b*I;e[11]=d*C+y*L+w*I;if(t!==e){e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}return e}},{}],300:[function(e,t,r){t.exports=n;function n(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=i*a+u*n;e[5]=o*a+c*n;e[6]=s*a+f*n;e[7]=l*a+h*n;e[8]=u*a-i*n;e[9]=c*a-o*n;e[10]=f*a-s*n;e[11]=h*a-l*n;return e}},{}],301:[function(e,t,r){t.exports=n;function n(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],f=t[10],h=t[11];if(t!==e){e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=i*a-u*n;e[1]=o*a-c*n;e[2]=s*a-f*n;e[3]=l*a-h*n;e[8]=i*n+u*a;e[9]=o*n+c*a;e[10]=s*n+f*a;e[11]=l*n+h*a;return e}},{}],302:[function(e,t,r){t.exports=n;function n(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],f=t[6],h=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=i*a+u*n;e[1]=o*a+c*n;e[2]=s*a+f*n;e[3]=l*a+h*n;e[4]=u*a-i*n;e[5]=c*a-o*n;e[6]=f*a-s*n;e[7]=h*a-l*n;return e}},{}],303:[function(e,t,r){t.exports=n;function n(e,t,r){var n=r[0],a=r[1],i=r[2];e[0]=t[0]*n;e[1]=t[1]*n;e[2]=t[2]*n;e[3]=t[3]*n;e[4]=t[4]*a;e[5]=t[5]*a;e[6]=t[6]*a;e[7]=t[7]*a;e[8]=t[8]*i;e[9]=t[9]*i;e[10]=t[10]*i;e[11]=t[11]*i;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],304:[function(e,t,r){t.exports=n;function n(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],305:[function(e,t,r){t.exports=n;function n(e,t,r){var n=r[0],a=r[1],i=r[2],o,s,l,u,c,f,h,p,d,v,m,g;if(t===e){e[12]=t[0]*n+t[4]*a+t[8]*i+t[12];e[13]=t[1]*n+t[5]*a+t[9]*i+t[13];e[14]=t[2]*n+t[6]*a+t[10]*i+t[14];e[15]=t[3]*n+t[7]*a+t[11]*i+t[15]}else{o=t[0];s=t[1];l=t[2];u=t[3];c=t[4];f=t[5];h=t[6];p=t[7];d=t[8];v=t[9];m=t[10];g=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=c;e[5]=f;e[6]=h;e[7]=p;e[8]=d;e[9]=v;e[10]=m;e[11]=g;e[12]=o*n+c*a+d*i+t[12];e[13]=s*n+f*a+v*i+t[13];e[14]=l*n+h*a+m*i+t[14];e[15]=u*n+p*a+g*i+t[15]}return e}},{}],306:[function(e,t,r){t.exports=n;function n(e,t){if(e===t){var r=t[1],n=t[2],a=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=r;e[6]=t[9];e[7]=t[13];e[8]=n;e[9]=i;e[11]=t[14];e[12]=a;e[13]=o;e[14]=s}else{e[0]=t[0];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=t[1];e[5]=t[5];e[6]=t[9];e[7]=t[13];e[8]=t[2];e[9]=t[6];e[10]=t[10];e[11]=t[14];e[12]=t[3];e[13]=t[7];e[14]=t[11];e[15]=t[15]}return e}},{}],307:[function(e,t,r){"use strict";var n=e("barycentric");var a=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=u;function i(e,t){var r=[0,0,0,0];for(var n=0;n<4;++n){for(var a=0;a<4;++a){r[a]+=e[4*n+a]*t[n]}}return r}function o(e,t,r,n,a){var o=i(n,i(r,i(t,[e[0],e[1],e[2],1])));for(var s=0;s<3;++s){o[s]/=o[3]}return[.5*a[0]*(1+o[0]),.5*a[1]*(1-o[1])]}function s(e,t){if(e.length===2){var r=0;var i=0;for(var o=0;o<2;++o){r+=Math.pow(t[o]-e[0][o],2);i+=Math.pow(t[o]-e[1][o],2)}r=Math.sqrt(r);i=Math.sqrt(i);if(r+i<1e-6){return[1,0]}return[i/(r+i),r/(i+r)]}else if(e.length===3){var s=[0,0];a(e[0],e[1],e[2],t,s);return n(e,s)}return[]}function l(e,t){var r=[0,0,0];for(var n=0;n<e.length;++n){var a=e[n];var i=t[n];for(var o=0;o<3;++o){r[o]+=i*a[o]}}return r}function u(e,t,r,n,a,i){if(e.length===1){return[0,e[0].slice()]}var u=new Array(e.length);for(var c=0;c<e.length;++c){u[c]=o(e[c],r,n,a,i)}var f=0;var h=Infinity;for(var c=0;c<u.length;++c){var p=0;for(var d=0;d<2;++d){p+=Math.pow(u[c][d]-t[d],2)}if(p<h){h=p;f=c}}var v=s(u,t);var m=0;for(var c=0;c<3;++c){if(v[c]<-.001||v[c]>1.0001){return null}m+=v[c]}if(Math.abs(m-1)>.001){return null}return[f,l(e,v),v]}},{barycentric:78,"polytope-closest-point/lib/closest_point_2d.js":525}],308:[function(e,t,r){var n=e("glslify");var a=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]);var i=n(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]);var s=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var l=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]);var u=n(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var c=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]);var f=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);var h=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]);var p=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]);var d=n(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);r.meshShader={vertex:a,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.wireShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.pointShader={vertex:l,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]};r.pickShader={vertex:c,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]};r.pointPickShader={vertex:h,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]};r.contourShader={vertex:p,fragment:d,attributes:[{name:"position",type:"vec3"}]}},{glslify:310}],309:[function(e,t,r){"use strict";var n=1e-6;var a=1e-6;var i=e("gl-shader");var o=e("gl-buffer");var s=e("gl-vao");var l=e("gl-texture2d");var u=e("normals");var c=e("gl-mat4/multiply");var f=e("gl-mat4/invert");var h=e("ndarray");var p=e("colormap");var d=e("simplicial-complex-contour");var v=e("typedarray-pool");var m=e("./lib/shaders");var g=e("./lib/closest-point");var y=m.meshShader;var x=m.wireShader;var _=m.pointShader;var b=m.pickShader;var w=m.pointPickShader;var T=m.contourShader;var k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function A(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m,g,y,x,_,b,w,T,A,M,E){this.gl=e;this.pixelRatio=1;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=a;this.pickShader=i;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleColors=c;this.triangleNormals=h;this.triangleUVs=f;this.triangleIds=u;this.triangleVAO=p;this.triangleCount=0;this.lineWidth=1;this.edgePositions=d;this.edgeColors=m;this.edgeUVs=g;this.edgeIds=v;this.edgeVAO=y;this.edgeCount=0;this.pointPositions=x;this.pointColors=b;this.pointUVs=w;this.pointSizes=T;this.pointIds=_;this.pointVAO=A;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=M;this.contourVAO=E;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=true;this.pickVertex=true;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.hasAlpha=false;this.opacityscale=false;this._model=k;this._view=k;this._projection=k;this._resolution=[1,1]}var M=A.prototype;M.isOpaque=function(){return!this.hasAlpha};M.isTransparent=function(){return this.hasAlpha};M.pickSlots=1;M.setPickBase=function(e){this.pickId=e};function E(e,t){if(!t)return 1;if(!t.length)return 1;for(var r=0;r<t.length;++r){if(t.length<2)return 1;if(t[r][0]===e)return t[r][1];if(t[r][0]>e&&r>0){var n=(t[r][0]-e)/(t[r][0]-t[r-1][0]);return t[r][1]*(1-n)+n*t[r-1][1]}}return 1}function S(e,t){var r=p({colormap:e,nshades:256,format:"rgba"});var n=new Uint8Array(256*4);for(var a=0;a<256;++a){var i=r[a];for(var o=0;o<3;++o){n[4*a+o]=i[o]}if(!t){n[4*a+3]=255*i[3]}else{n[4*a+3]=255*E(a/255,t)}}return h(n,[256,256,4],[4,0,1])}function C(e){var t=e.length;var r=new Array(t);for(var n=0;n<t;++n){r[n]=e[n][2]}return r}M.highlight=function(e){if(!e||!this.contourEnable){this.contourCount=0;return}var t=d(this.cells,this.intensity,e.intensity);var r=t.cells;var n=t.vertexIds;var a=t.vertexWeights;var i=r.length;var o=v.mallocFloat32(2*3*i);var s=0;for(var l=0;l<i;++l){var u=r[l];for(var c=0;c<2;++c){var f=u[0];if(u.length===2){f=u[c]}var h=n[f][0];var p=n[f][1];var m=a[f];var g=1-m;var y=this.positions[h];var x=this.positions[p];for(var _=0;_<3;++_){o[s++]=m*y[_]+g*x[_]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));v.free(o)};M.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("contourEnable"in e){this.contourEnable=e.contourEnable}if("contourColor"in e){this.contourColor=e.contourColor}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("lightPosition"in e){this.lightPosition=e.lightPosition}this.hasAlpha=false;if("opacity"in e){this.opacity=e.opacity;if(this.opacity<1){this.hasAlpha=true}}if("opacityscale"in e){this.opacityscale=e.opacityscale;this.hasAlpha=true}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.texture){this.texture.dispose();this.texture=l(t,e.texture)}else if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(S(e.colormap,this.opacityscale));this.texture.generateMipmap()}var r=e.cells;var i=e.positions;if(!i||!r){return}var o=[];var s=[];var c=[];var f=[];var h=[];var p=[];var d=[];var v=[];var m=[];var g=[];var y=[];var x=[];var _=[];var b=[];this.cells=r;this.positions=i;var w=e.vertexNormals;var T=e.cellNormals;var k=e.vertexNormalsEpsilon===void 0?n:e.vertexNormalsEpsilon;var A=e.faceNormalsEpsilon===void 0?a:e.faceNormalsEpsilon;if(e.useFacetNormals&&!T){T=u.faceNormals(r,i,A)}if(!T&&!w){w=u.vertexNormals(r,i,k)}var M=e.vertexColors;var L=e.cellColors;var I=e.meshColor||[1,1,1,1];var O=e.vertexUVs;var P=e.vertexIntensity;var D=e.cellUVs;var R=e.cellIntensity;var z=Infinity;var N=-Infinity;if(!O&&!D){if(P){if(e.vertexIntensityBounds){z=+e.vertexIntensityBounds[0];N=+e.vertexIntensityBounds[1]}else{for(var F=0;F<P.length;++F){var B=P[F];z=Math.min(z,B);N=Math.max(N,B)}}}else if(R){if(e.cellIntensityBounds){z=+e.cellIntensityBounds[0];N=+e.cellIntensityBounds[1]}else{for(var F=0;F<R.length;++F){var B=R[F];z=Math.min(z,B);N=Math.max(N,B)}}}else{for(var F=0;F<i.length;++F){var B=i[F][2];z=Math.min(z,B);N=Math.max(N,B)}}}if(P){this.intensity=P}else if(R){this.intensity=R}else{this.intensity=C(i)}this.pickVertex=!(R||L);var j=e.pointSizes;var U=e.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var F=0;F<i.length;++F){var H=i[F];for(var V=0;V<3;++V){if(isNaN(H[V])||!isFinite(H[V])){continue}this.bounds[0][V]=Math.min(this.bounds[0][V],H[V]);this.bounds[1][V]=Math.max(this.bounds[1][V],H[V])}}var G=0;var q=0;var Y=0;e:for(var F=0;F<r.length;++F){var W=r[F];switch(W.length){case 1:var X=W[0];var H=i[X];for(var V=0;V<3;++V){if(isNaN(H[V])||!isFinite(H[V])){continue e}}g.push(H[0],H[1],H[2]);var Z;if(M){Z=M[X]}else if(L){Z=L[F]}else{Z=I}if(this.opacityscale&&P){s.push(Z[0],Z[1],Z[2],this.opacity*E((P[X]-z)/(N-z),this.opacityscale))}else if(Z.length===3){y.push(Z[0],Z[1],Z[2],this.opacity)}else{y.push(Z[0],Z[1],Z[2],Z[3]*this.opacity);if(Z[3]<1)this.hasAlpha=true}var K;if(O){K=O[X]}else if(P){K=[(P[X]-z)/(N-z),0]}else if(D){K=D[F]}else if(R){K=[(R[F]-z)/(N-z),0]}else{K=[(H[2]-z)/(N-z),0]}x.push(K[0],K[1]);if(j){_.push(j[X])}else{_.push(U)}b.push(F);Y+=1;break;case 2:for(var V=0;V<2;++V){var X=W[V];var H=i[X];for(var J=0;J<3;++J){if(isNaN(H[J])||!isFinite(H[J])){continue e}}}for(var V=0;V<2;++V){var X=W[V];var H=i[X];p.push(H[0],H[1],H[2]);var Z;if(M){Z=M[X]}else if(L){Z=L[F]}else{Z=I}if(this.opacityscale&&P){s.push(Z[0],Z[1],Z[2],this.opacity*E((P[X]-z)/(N-z),this.opacityscale))}else if(Z.length===3){d.push(Z[0],Z[1],Z[2],this.opacity)}else{d.push(Z[0],Z[1],Z[2],Z[3]*this.opacity);if(Z[3]<1)this.hasAlpha=true}var K;if(O){K=O[X]}else if(P){K=[(P[X]-z)/(N-z),0]}else if(D){K=D[F]}else if(R){K=[(R[F]-z)/(N-z),0]}else{K=[(H[2]-z)/(N-z),0]}v.push(K[0],K[1]);m.push(F)}q+=1;break;case 3:for(var V=0;V<3;++V){var X=W[V];var H=i[X];for(var J=0;J<3;++J){if(isNaN(H[J])||!isFinite(H[J])){continue e}}}for(var V=0;V<3;++V){var X=W[2-V];var H=i[X];o.push(H[0],H[1],H[2]);var Z;if(M){Z=M[X]}else if(L){Z=L[F]}else{Z=I}if(!Z){s.push(.5,.5,.5,1)}else if(this.opacityscale&&P){s.push(Z[0],Z[1],Z[2],this.opacity*E((P[X]-z)/(N-z),this.opacityscale))}else if(Z.length===3){s.push(Z[0],Z[1],Z[2],this.opacity)}else{s.push(Z[0],Z[1],Z[2],Z[3]*this.opacity);if(Z[3]<1)this.hasAlpha=true}var K;if(O){K=O[X]}else if(P){K=[(P[X]-z)/(N-z),0]}else if(D){K=D[F]}else if(R){K=[(R[F]-z)/(N-z),0]}else{K=[(H[2]-z)/(N-z),0]}f.push(K[0],K[1]);var Q;if(w){Q=w[X]}else{Q=T[F]}c.push(Q[0],Q[1],Q[2]);h.push(F)}G+=1;break;default:break}}this.pointCount=Y;this.edgeCount=q;this.triangleCount=G;this.pointPositions.update(g);this.pointColors.update(y);this.pointUVs.update(x);this.pointSizes.update(_);this.pointIds.update(new Uint32Array(b));this.edgePositions.update(p);this.edgeColors.update(d);this.edgeUVs.update(v);this.edgeIds.update(new Uint32Array(m));this.trianglePositions.update(o);this.triangleColors.update(s);this.triangleUVs.update(f);this.triangleNormals.update(c);this.triangleIds.update(new Uint32Array(h))};M.drawTransparent=M.draw=function(e){e=e||{};var t=this.gl;var r=e.model||k;var n=e.view||k;var a=e.projection||k;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:a,inverseModel:k.slice(),clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};s.inverseModel=f(s.inverseModel,s.model);t.disable(t.CULL_FACE);this.texture.bind(0);var l=new Array(16);c(l,s.view,s.model);c(l,s.projection,l);f(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var p=0;p<3;++p){h+=l[4*p+o]*this.lightPosition[p]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();t.lineWidth(this.lineWidth*this.pixelRatio);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();t.drawArrays(t.LINES,0,this.contourCount);this.contourVAO.unbind()}};M.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||k;var n=e.view||k;var a=e.projection||k;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(a);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:n,projection:a,clipBounds:i,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();t.lineWidth(this.lineWidth*this.pixelRatio);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}};M.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var n=this.positions;var a=new Array(r.length);for(var i=0;i<r.length;++i){a[i]=n[r[i]]}var o=e.coord[0];var s=e.coord[1];if(!this.pickVertex){var l=this.positions[r[0]];var u=this.positions[r[1]];var c=this.positions[r[2]];var f=[(l[0]+u[0]+c[0])/3,(l[1]+u[1]+c[1])/3,(l[2]+u[2]+c[2])/3];return{_cellCenter:true,position:[o,s],index:t,cell:r,cellId:t,intensity:this.intensity[t],dataCoordinate:f}}var h=g(a,[o*this.pixelRatio,this._resolution[1]-s*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!h){return null}var p=h[2];var d=0;for(var i=0;i<r.length;++i){d+=p[i]*this.intensity[r[i]]}return{position:h[1],index:r[h[0]],cell:r,cellId:t,intensity:d,dataCoordinate:this.positions[r[h[0]]]}};M.dispose=function(){this.texture.dispose();this.triShader.dispose();this.lineShader.dispose();this.pointShader.dispose();this.pickShader.dispose();this.pointPickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose();this.contourShader.dispose()};function L(e){var t=i(e,y.vertex,y.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.normal.location=4;return t}function I(e){var t=i(e,x.vertex,x.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;return t}function O(e){var t=i(e,_.vertex,_.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.pointSize.location=4;return t}function P(e){var t=i(e,b.vertex,b.fragment);t.attributes.position.location=0;t.attributes.id.location=1;return t}function D(e){var t=i(e,w.vertex,w.fragment);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.pointSize.location=4;return t}function R(e){var t=i(e,T.vertex,T.fragment);t.attributes.position.location=0;return t}function z(e,t){if(arguments.length===1){t=e;e=t.gl}var r=e.getExtension("OES_standard_derivatives")||e.getExtension("MOZ_OES_standard_derivatives")||e.getExtension("WEBKIT_OES_standard_derivatives");if(!r)throw new Error("derivatives not supported");var n=L(e);var a=I(e);var i=O(e);var u=P(e);var c=D(e);var f=R(e);var p=l(e,h(new Uint8Array([255,255,255,255]),[1,1,4]));p.generateMipmap();p.minFilter=e.LINEAR_MIPMAP_LINEAR;p.magFilter=e.LINEAR;var d=o(e);var v=o(e);var m=o(e);var g=o(e);var y=o(e);var x=s(e,[{buffer:d,type:e.FLOAT,size:3},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:v,type:e.FLOAT,size:4},{buffer:m,type:e.FLOAT,size:2},{buffer:g,type:e.FLOAT,size:3}]);var _=o(e);var b=o(e);var w=o(e);var T=o(e);var k=s(e,[{buffer:_,type:e.FLOAT,size:3},{buffer:T,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:b,type:e.FLOAT,size:4},{buffer:w,type:e.FLOAT,size:2}]);var M=o(e);var E=o(e);var S=o(e);var C=o(e);var z=o(e);var N=s(e,[{buffer:M,type:e.FLOAT,size:3},{buffer:z,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:E,type:e.FLOAT,size:4},{buffer:S,type:e.FLOAT,size:2},{buffer:C,type:e.FLOAT,size:1}]);var F=o(e);var B=s(e,[{buffer:F,type:e.FLOAT,size:3}]);var j=new A(e,p,n,a,i,u,c,f,d,y,v,m,g,x,_,T,b,w,k,M,z,E,S,C,N,F,B);j.update(t);return j}t.exports=z},{"./lib/closest-point":307,"./lib/shaders":308,colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":335,"gl-texture2d":353,"gl-vao":358,ndarray:495,normals:498,"simplicial-complex-contour":556,"typedarray-pool":595}],310:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],311:[function(e,t,r){"use strict";t.exports=l;var n=e("gl-buffer");var a=e("gl-shader");var i=e("./shaders");function o(e,t,r){this.plot=e;this.vbo=t;this.shader=r}var s=o.prototype;s.bind=function(){var e=this.shader;this.vbo.bind();this.shader.bind();e.attributes.coord.pointer();e.uniforms.screenBox=this.plot.screenBox};s.drawBox=function(){var e=[0,0];var t=[0,0];return function(r,n,a,i,o){var s=this.plot;var l=this.shader;var u=s.gl;e[0]=r;e[1]=n;t[0]=a;t[1]=i;l.uniforms.lo=e;l.uniforms.hi=t;l.uniforms.color=o;u.drawArrays(u.TRIANGLE_STRIP,0,4)}}();s.dispose=function(){this.vbo.dispose();this.shader.dispose()};function l(e){var t=e.gl;var r=n(t,[0,0,0,1,1,0,1,1]);var s=a(t,i.boxVert,i.lineFrag);return new o(e,r,s)}},{"./shaders":314,"gl-buffer":259,"gl-shader":335}],312:[function(e,t,r){"use strict";t.exports=c;var n=e("gl-buffer");var a=e("gl-shader");var i=e("binary-search-bounds");var o=e("./shaders");function s(e,t,r,n){this.plot=e;this.vbo=t;this.shader=r;this.tickShader=n;this.ticks=[[],[]]}function l(e,t){return e-t}var u=s.prototype;u.draw=function(){var e=[0,0];var t=[0,0];var r=[0,0];return function(){var n=this.plot;var a=this.vbo;var i=this.shader;var o=this.ticks;var s=n.gl;var l=n._tickBounds;var u=n.dataBox;var c=n.viewBox;var f=n.gridLineWidth;var h=n.gridLineColor;var p=n.gridLineEnable;var d=n.pixelRatio;for(var v=0;v<2;++v){var m=l[v];var g=l[v+2];var y=g-m;var x=.5*(u[v+2]+u[v]);var _=u[v+2]-u[v];t[v]=2*y/_;e[v]=2*(m-x)/_}i.bind();a.bind();i.attributes.dataCoord.pointer();i.uniforms.dataShift=e;i.uniforms.dataScale=t;var b=0;for(var v=0;v<2;++v){r[0]=r[1]=0;r[v]=1;i.uniforms.dataAxis=r;i.uniforms.lineWidth=f[v]/(c[v+2]-c[v])*d;i.uniforms.color=h[v];var w=o[v].length*6;if(p[v]&&w){s.drawArrays(s.TRIANGLES,b,w)}b+=w}}}();u.drawTickMarks=function(){var e=[0,0];var t=[0,0];var r=[1,0];var n=[0,1];var a=[0,0];var o=[0,0];return function(){var s=this.plot;var u=this.vbo;var c=this.tickShader;var f=this.ticks;var h=s.gl;var p=s._tickBounds;var d=s.dataBox;var v=s.viewBox;var m=s.pixelRatio;var g=s.screenBox;var y=g[2]-g[0];var x=g[3]-g[1];var _=v[2]-v[0];var b=v[3]-v[1];for(var w=0;w<2;++w){var T=p[w];var k=p[w+2];var A=k-T;var M=.5*(d[w+2]+d[w]);var E=d[w+2]-d[w];t[w]=2*A/E;e[w]=2*(T-M)/E}t[0]*=_/y;e[0]*=_/y;t[1]*=b/x;e[1]*=b/x;c.bind();u.bind();c.attributes.dataCoord.pointer();var S=c.uniforms;S.dataShift=e;S.dataScale=t;var C=s.tickMarkLength;var L=s.tickMarkWidth;var I=s.tickMarkColor;var O=0;var P=f[0].length*6;var D=Math.min(i.ge(f[0],(d[0]-p[0])/(p[2]-p[0]),l),f[0].length);var R=Math.min(i.gt(f[0],(d[2]-p[0])/(p[2]-p[0]),l),f[0].length);var z=O+6*D;var N=6*Math.max(0,R-D);var F=Math.min(i.ge(f[1],(d[1]-p[1])/(p[3]-p[1]),l),f[1].length);var B=Math.min(i.gt(f[1],(d[3]-p[1])/(p[3]-p[1]),l),f[1].length);var j=P+6*F;var U=6*Math.max(0,B-F);a[0]=2*(v[0]-C[1])/y-1;a[1]=(v[3]+v[1])/x-1;o[0]=C[1]*m/y;o[1]=L[1]*m/x;if(U){S.color=I[1];S.tickScale=o;S.dataAxis=n;S.screenOffset=a;h.drawArrays(h.TRIANGLES,j,U)}a[0]=(v[2]+v[0])/y-1;a[1]=2*(v[1]-C[0])/x-1;o[0]=L[0]*m/y;o[1]=C[0]*m/x;if(N){S.color=I[0];S.tickScale=o;S.dataAxis=r;S.screenOffset=a;h.drawArrays(h.TRIANGLES,z,N)}a[0]=2*(v[2]+C[3])/y-1;a[1]=(v[3]+v[1])/x-1;o[0]=C[3]*m/y;o[1]=L[3]*m/x;if(U){S.color=I[3];S.tickScale=o;S.dataAxis=n;S.screenOffset=a;h.drawArrays(h.TRIANGLES,j,U)}a[0]=(v[2]+v[0])/y-1;a[1]=2*(v[3]+C[2])/x-1;o[0]=L[2]*m/y;o[1]=C[2]*m/x;if(N){S.color=I[2];S.tickScale=o;S.dataAxis=r;S.screenOffset=a;h.drawArrays(h.TRIANGLES,z,N)}}}();u.update=function(){var e=[1,1,-1,-1,1,-1];var t=[1,-1,1,1,-1,-1];return function(r){var n=r.ticks;var a=r.bounds;var i=new Float32Array(6*3*(n[0].length+n[1].length));var o=this.plot.zeroLineEnable;var s=0;var l=[[],[]];for(var u=0;u<2;++u){var c=l[u];var f=n[u];var h=a[u];var p=a[u+2];for(var d=0;d<f.length;++d){var v=(f[d].x-h)/(p-h);c.push(v);for(var m=0;m<6;++m){i[s++]=v;i[s++]=e[m];i[s++]=t[m]}}}this.ticks=l;this.vbo.update(i)}}();u.dispose=function(){this.vbo.dispose();this.shader.dispose();this.tickShader.dispose()};function c(e){var t=e.gl;var r=n(t);var i=a(t,o.gridVert,o.gridFrag);var l=a(t,o.tickVert,o.gridFrag);var u=new s(e,r,i,l);return u}},{"./shaders":314,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335}],313:[function(e,t,r){"use strict";t.exports=l;var n=e("gl-buffer");var a=e("gl-shader");var i=e("./shaders");function o(e,t,r){this.plot=e;this.vbo=t;this.shader=r}var s=o.prototype;s.bind=function(){var e=this.shader;this.vbo.bind();this.shader.bind();e.attributes.coord.pointer();e.uniforms.screenBox=this.plot.screenBox};s.drawLine=function(){var e=[0,0];var t=[0,0];return function(r,n,a,i,o,s){var l=this.plot;var u=this.shader;var c=l.gl;e[0]=r;e[1]=n;t[0]=a;t[1]=i;u.uniforms.start=e;u.uniforms.end=t;u.uniforms.width=o*l.pixelRatio;u.uniforms.color=s;c.drawArrays(c.TRIANGLE_STRIP,0,4)}}();s.dispose=function(){this.vbo.dispose();this.shader.dispose()};function l(e){var t=e.gl;var r=n(t,[-1,-1,-1,1,1,-1,1,1]);var s=a(t,i.lineVert,i.lineFrag);var l=new o(e,r,s);return l}},{"./shaders":314,"gl-buffer":259,"gl-shader":335}],314:[function(e,t,r){"use strict";var n=e("glslify");var a=n(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);t.exports={lineVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:a,textVert:n(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:a,gridVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:a,boxVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:316}],315:[function(e,t,r){"use strict";t.exports=c;var n=e("gl-buffer");var a=e("gl-shader");var i=e("text-cache");var o=e("binary-search-bounds");var s=e("./shaders");function l(e,t,r){this.plot=e;this.vbo=t;this.shader=r;this.tickOffset=[[],[]];this.tickX=[[],[]];this.labelOffset=[0,0];this.labelCount=[0,0]}var u=l.prototype;u.drawTicks=function(){var e=[0,0];var t=[0,0];var r=[0,0];return function(n){var a=this.plot;var i=this.shader;var s=this.tickX[n];var l=this.tickOffset[n];var u=a.gl;var c=a.viewBox;var f=a.dataBox;var h=a.screenBox;var p=a.pixelRatio;var d=a.tickEnable;var v=a.tickPad;var m=a.tickColor;var g=a.tickAngle;var y=a.labelEnable;var x=a.labelPad;var _=a.labelColor;var b=a.labelAngle;var w=this.labelOffset[n];var T=this.labelCount[n];var k=o.lt(s,f[n]);var A=o.le(s,f[n+2]);e[0]=e[1]=0;e[n]=1;t[n]=(c[2+n]+c[n])/(h[2+n]-h[n])-1;var M=2/h[2+(n^1)]-h[n^1];t[n^1]=M*c[n^1]-1;if(d[n]){t[n^1]-=M*p*v[n];if(k<A&&l[A]>l[k]){i.uniforms.dataAxis=e;i.uniforms.screenOffset=t;i.uniforms.color=m[n];i.uniforms.angle=g[n];u.drawArrays(u.TRIANGLES,l[k],l[A]-l[k])}}if(y[n]&&T){t[n^1]-=M*p*x[n];i.uniforms.dataAxis=r;i.uniforms.screenOffset=t;i.uniforms.color=_[n];i.uniforms.angle=b[n];u.drawArrays(u.TRIANGLES,w,T)}t[n^1]=M*c[2+(n^1)]-1;if(d[n+2]){t[n^1]+=M*p*v[n+2];if(k<A&&l[A]>l[k]){i.uniforms.dataAxis=e;i.uniforms.screenOffset=t;i.uniforms.color=m[n+2];i.uniforms.angle=g[n+2];u.drawArrays(u.TRIANGLES,l[k],l[A]-l[k])}}if(y[n+2]&&T){t[n^1]+=M*p*x[n+2];i.uniforms.dataAxis=r;i.uniforms.screenOffset=t;i.uniforms.color=_[n+2];i.uniforms.angle=b[n+2];u.drawArrays(u.TRIANGLES,w,T)}}}();u.drawTitle=function(){var e=[0,0];var t=[0,0];return function(){var r=this.plot;var n=this.shader;var a=r.gl;var i=r.screenBox;var o=r.titleCenter;var s=r.titleAngle;var l=r.titleColor;var u=r.pixelRatio;if(!this.titleCount){return}for(var c=0;c<2;++c){t[c]=2*(o[c]*u-i[c])/(i[2+c]-i[c])-1}n.bind();n.uniforms.dataAxis=e;n.uniforms.screenOffset=t;n.uniforms.angle=s;n.uniforms.color=l;a.drawArrays(a.TRIANGLES,this.titleOffset,this.titleCount)}}();u.bind=function(){var e=[0,0];var t=[0,0];var r=[0,0];return function(){var n=this.plot;var a=this.shader;var i=n._tickBounds;var o=n.dataBox;var s=n.screenBox;var l=n.viewBox;a.bind();for(var u=0;u<2;++u){var c=i[u];var f=i[u+2];var h=f-c;var p=.5*(o[u+2]+o[u]);var d=o[u+2]-o[u];var v=l[u];var m=l[u+2];var g=m-v;var y=s[u];var x=s[u+2];var _=x-y;t[u]=2*h/d*g/_;e[u]=2*(c-p)/d*g/_}r[1]=2*n.pixelRatio/(s[3]-s[1]);r[0]=r[1]*(s[3]-s[1])/(s[2]-s[0]);a.uniforms.dataScale=t;a.uniforms.dataShift=e;a.uniforms.textScale=r;this.vbo.bind();a.attributes.textCoordinate.pointer()}}();u.update=function(e){var t=[];var r=e.ticks;var n=e.bounds;var a,o,s,l,u,c;for(c=0;c<2;++c){var f=[Math.floor(t.length/3)],h=[-Infinity];var p=r[c];for(a=0;a<p.length;++a){var d=p[a];var v=d.x;var m=d.text;var g=d.font||"sans-serif";u=d.fontSize||12;var y=1/(n[c+2]-n[c]);var x=n[c];var _=m.split("\n");for(var b=0;b<_.length;b++){l=i(g,_[b]).data;for(o=0;o<l.length;o+=2){t.push(l[o]*u,-l[o+1]*u-b*u*1.2,(v-x)*y)}}f.push(Math.floor(t.length/3));h.push(v)}this.tickOffset[c]=f;this.tickX[c]=h}for(c=0;c<2;++c){this.labelOffset[c]=Math.floor(t.length/3);l=i(e.labelFont[c],e.labels[c],{textAlign:"center"}).data;u=e.labelSize[c];for(a=0;a<l.length;a+=2){t.push(l[a]*u,-l[a+1]*u,0)}this.labelCount[c]=Math.floor(t.length/3)-this.labelOffset[c]}this.titleOffset=Math.floor(t.length/3);l=i(e.titleFont,e.title).data;u=e.titleSize;for(a=0;a<l.length;a+=2){t.push(l[a]*u,-l[a+1]*u,0)}this.titleCount=Math.floor(t.length/3)-this.titleOffset;this.vbo.update(t)};u.dispose=function(){this.vbo.dispose();this.shader.dispose()};function c(e){var t=e.gl;var r=n(t);var i=a(t,s.textVert,s.textFrag);var o=new l(e,r,i);return o}},{"./shaders":314,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335,"text-cache":575}],316:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],317:[function(e,t,r){"use strict";t.exports=p;var n=e("gl-select-static");var a=e("./lib/grid");var i=e("./lib/text");var o=e("./lib/line");var s=e("./lib/box");function l(e,t){this.gl=e;this.pickBuffer=t;this.screenBox=[0,0,e.drawingBufferWidth,e.drawingBufferHeight];this.viewBox=[0,0,0,0];this.dataBox=[-10,-10,10,10];this.gridLineEnable=[true,true];this.gridLineWidth=[1,1];this.gridLineColor=[[0,0,0,1],[0,0,0,1]];this.pixelRatio=1;this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickEnable=[true,true,true,true];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[15,15,15,15];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelEnable=[true,true,true,true];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.titleCenter=[0,0];this.titleEnable=true;this.titleAngle=0;this.titleColor=[0,0,0,1];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.zeroLineEnable=[true,true];this.zeroLineWidth=[4,4];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderLineEnable=[true,true,true,true];this.borderLineWidth=[2,2,2,2];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.grid=null;this.text=null;this.line=null;this.box=null;this.objects=[];this.overlays=[];this._tickBounds=[Infinity,Infinity,-Infinity,-Infinity];this.static=false;this.dirty=false;this.pickDirty=false;this.pickDelay=120;this.pickRadius=10;this._pickTimeout=null;this._drawPick=this.drawPick.bind(this);this._depthCounter=0}var u=l.prototype;u.setDirty=function(){this.dirty=this.pickDirty=true};u.setOverlayDirty=function(){this.dirty=true};u.nextDepthValue=function(){return this._depthCounter++/65536};function c(e,t,r){var n=.5*(r+1);return Math.floor((1-n)*e+n*t)|0}u.draw=function(){var e=[0,0,0,0];return function(){var e=this.gl;var t=this.screenBox;var r=this.viewBox;var n=this.dataBox;var a=this.pixelRatio;var i=this.grid;var o=this.line;var s=this.text;var l=this.objects;this._depthCounter=0;if(this.pickDirty){if(this._pickTimeout){clearTimeout(this._pickTimeout)}this.pickDirty=false;this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)}if(!this.dirty){return}this.dirty=false;e.bindFramebuffer(e.FRAMEBUFFER,null);e.enable(e.SCISSOR_TEST);e.disable(e.DEPTH_TEST);e.depthFunc(e.LESS);e.depthMask(false);e.enable(e.BLEND);e.blendEquation(e.FUNC_ADD,e.FUNC_ADD);e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);if(this.borderColor){e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);var u=this.borderColor;e.clearColor(u[0]*u[3],u[1]*u[3],u[2]*u[3],u[3]);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}e.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]);e.viewport(r[0],r[1],r[2]-r[0],r[3]-r[1]);var c=this.backgroundColor;e.clearColor(c[0]*c[3],c[1]*c[3],c[2]*c[3],c[3]);e.clear(e.COLOR_BUFFER_BIT);i.draw();var f=this.zeroLineEnable;var h=this.zeroLineColor;var p=this.zeroLineWidth;if(f[0]||f[1]){o.bind();for(var d=0;d<2;++d){if(!f[d]||!(n[d]<=0&&n[d+2]>=0)){continue}var v=t[d]-n[d]*(t[d+2]-t[d])/(n[d+2]-n[d]);if(d===0){o.drawLine(v,t[1],v,t[3],p[d],h[d])}else{o.drawLine(t[0],v,t[2],v,p[d],h[d])}}}for(var d=0;d<l.length;++d){l[d].draw()}e.viewport(t[0],t[1],t[2]-t[0],t[3]-t[1]);e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);this.grid.drawTickMarks();o.bind();var m=this.borderLineEnable;var g=this.borderLineWidth;var y=this.borderLineColor;if(m[1]){o.drawLine(r[0],r[1]-.5*g[1]*a,r[0],r[3]+.5*g[3]*a,g[1],y[1])}if(m[0]){o.drawLine(r[0]-.5*g[0]*a,r[1],r[2]+.5*g[2]*a,r[1],g[0],y[0])}if(m[3]){o.drawLine(r[2],r[1]-.5*g[1]*a,r[2],r[3]+.5*g[3]*a,g[3],y[3])}if(m[2]){o.drawLine(r[0]-.5*g[0]*a,r[3],r[2]+.5*g[2]*a,r[3],g[2],y[2])}s.bind();for(var d=0;d<2;++d){s.drawTicks(d)}if(this.titleEnable){s.drawTitle()}var x=this.overlays;for(var d=0;d<x.length;++d){x[d].draw()}e.disable(e.SCISSOR_TEST);e.disable(e.BLEND);e.depthMask(true)}}();u.drawPick=function(){return function(){if(this.static)return;var e=this.pickBuffer;var t=this.gl;this._pickTimeout=null;e.begin();var r=1;var n=this.objects;for(var a=0;a<n.length;++a){r=n[a].drawPick(r)}e.end()}}();u.pick=function(){return function(e,t){if(this.static)return;var r=this.pixelRatio;var n=this.pickPixelRatio;var a=this.viewBox;var i=Math.round((e-a[0]/r)*n)|0;var o=Math.round((t-a[1]/r)*n)|0;var s=this.pickBuffer.query(i,o,this.pickRadius);if(!s){return null}var l=s.id+(s.value[0]<<8)+(s.value[1]<<16)+(s.value[2]<<24);var u=this.objects;for(var c=0;c<u.length;++c){var f=u[c].pick(i,o,l);if(f){return f}}return null}}();function f(e){var t=e.slice();for(var r=0;r<t.length;++r){t[r]=t[r].slice()}return t}function h(e,t){return e.x-t.x}u.setScreenBox=function(e){var t=this.screenBox;var r=this.pixelRatio;t[0]=Math.round(e[0]*r)|0;t[1]=Math.round(e[1]*r)|0;t[2]=Math.round(e[2]*r)|0;t[3]=Math.round(e[3]*r)|0;this.setDirty()};u.setDataBox=function(e){var t=this.dataBox;var r=t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3];if(r){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];this.setDirty()}};u.setViewBox=function(e){var t=this.pixelRatio;var r=this.viewBox;r[0]=Math.round(e[0]*t)|0;r[1]=Math.round(e[1]*t)|0;r[2]=Math.round(e[2]*t)|0;r[3]=Math.round(e[3]*t)|0;var n=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((e[2]-e[0])*n)|0,Math.round((e[3]-e[1])*n)|0];this.setDirty()};u.update=function(e){e=e||{};var t=this.gl;this.pixelRatio=e.pixelRatio||1;var r=this.pixelRatio;this.pickPixelRatio=Math.max(r,1);this.setScreenBox(e.screenBox||[0,0,t.drawingBufferWidth/r,t.drawingBufferHeight/r]);var n=this.screenBox;this.setViewBox(e.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/r,.125*(this.screenBox[3]-this.screenBox[1])/r,.875*(this.screenBox[2]-this.screenBox[0])/r,.875*(this.screenBox[3]-this.screenBox[1])/r]);var a=this.viewBox;var i=(a[2]-a[0])/(a[3]-a[1]);this.setDataBox(e.dataBox||[-10,-10/i,10,10/i]);this.borderColor=e.borderColor!==false?(e.borderColor||[0,0,0,0]).slice():false;this.backgroundColor=(e.backgroundColor||[0,0,0,0]).slice();this.gridLineEnable=(e.gridLineEnable||[true,true]).slice();this.gridLineWidth=(e.gridLineWidth||[1,1]).slice();this.gridLineColor=f(e.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]);this.zeroLineEnable=(e.zeroLineEnable||[true,true]).slice();this.zeroLineWidth=(e.zeroLineWidth||[4,4]).slice();this.zeroLineColor=f(e.zeroLineColor||[[0,0,0,1],[0,0,0,1]]);this.tickMarkLength=(e.tickMarkLength||[0,0,0,0]).slice();this.tickMarkWidth=(e.tickMarkWidth||[0,0,0,0]).slice();this.tickMarkColor=f(e.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.titleCenter=(e.titleCenter||[.5*(a[0]+a[2])/r,(a[3]+120)/r]).slice();this.titleEnable=!("titleEnable"in e)||!!e.titleEnable;this.titleAngle=e.titleAngle||0;this.titleColor=(e.titleColor||[0,0,0,1]).slice();this.labelPad=(e.labelPad||[15,15,15,15]).slice();this.labelAngle=(e.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice();this.labelEnable=(e.labelEnable||[true,true,true,true]).slice();this.labelColor=f(e.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.tickPad=(e.tickPad||[15,15,15,15]).slice();this.tickAngle=(e.tickAngle||[0,0,0,0]).slice();this.tickEnable=(e.tickEnable||[true,true,true,true]).slice();this.tickColor=f(e.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.borderLineEnable=(e.borderLineEnable||[true,true,true,true]).slice();this.borderLineWidth=(e.borderLineWidth||[2,2,2,2]).slice();this.borderLineColor=f(e.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var o=e.ticks||[[],[]];var s=this._tickBounds;s[0]=s[1]=Infinity;s[2]=s[3]=-Infinity;for(var l=0;l<2;++l){var u=o[l].slice(0);if(u.length===0){continue}u.sort(h);s[l]=Math.min(s[l],u[0].x);s[l+2]=Math.max(s[l+2],u[u.length-1].x)}this.grid.update({bounds:s,ticks:o});this.text.update({bounds:s,ticks:o,labels:e.labels||["x","y"],labelSize:e.labelSize||[12,12],labelFont:e.labelFont||["sans-serif","sans-serif"],title:e.title||"",titleSize:e.titleSize||18,titleFont:e.titleFont||"sans-serif"});this.static=!!e.static;this.setDirty()};u.dispose=function(){this.box.dispose();this.grid.dispose();this.text.dispose();this.line.dispose();for(var e=this.objects.length-1;e>=0;--e){this.objects[e].dispose()}this.objects.length=0;for(var e=this.overlays.length-1;e>=0;--e){this.overlays[e].dispose()}this.overlays.length=0;this.gl=null};u.addObject=function(e){if(this.objects.indexOf(e)<0){this.objects.push(e);this.setDirty()}};u.removeObject=function(e){var t=this.objects;for(var r=0;r<t.length;++r){if(t[r]===e){t.splice(r,1);this.setDirty();break}}};u.addOverlay=function(e){if(this.overlays.indexOf(e)<0){this.overlays.push(e);this.setOverlayDirty()}};u.removeOverlay=function(e){var t=this.overlays;for(var r=0;r<t.length;++r){if(t[r]===e){t.splice(r,1);this.setOverlayDirty();break}}};function p(e){var t=e.gl;var r=n(t,[t.drawingBufferWidth,t.drawingBufferHeight]);var u=new l(t,r);u.grid=a(u);u.text=i(u);u.line=o(u);u.box=s(u);u.update(e);return u}},{"./lib/box":311,"./lib/grid":312,"./lib/line":313,"./lib/text":315,"gl-select-static":334}],318:[function(e,t,r){"use strict";t.exports=u;var n=e("right-now");var a=e("3d-view");var i=e("mouse-change");var o=e("mouse-wheel");var s=e("mouse-event-offset");var l=e("has-passive-events");function u(e,t){e=e||document.body;t=t||{};var r=[.01,Infinity];if("distanceLimits"in t){r[0]=t.distanceLimits[0];r[1]=t.distanceLimits[1]}if("zoomMin"in t){r[0]=t.zoomMin}if("zoomMax"in t){r[1]=t.zoomMax}var u=a({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:r});var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var f=0;var h=e.clientWidth;var p=e.clientHeight;var d={keyBindingMode:"rotate",enableWheel:true,view:u,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:u.modes,_ortho:t._ortho||t.projection&&t.projection.type==="orthographic"||false,tick:function(){var t=n();var r=this.delay;var a=t-2*r;u.idle(t-r);u.recalcMatrix(a);u.flush(t-(100+r*2));var i=true;var o=u.computedMatrix;for(var s=0;s<16;++s){i=i&&c[s]===o[s];c[s]=o[s]}var l=e.clientWidth===h&&e.clientHeight===p;h=e.clientWidth;p=e.clientHeight;if(i){return!l}f=Math.exp(u.computedRadius[0]);return true},lookAt:function(e,t,r){u.lookAt(u.lastT(),e,t,r)},rotate:function(e,t,r){u.rotate(u.lastT(),e,t,r)},pan:function(e,t,r){u.pan(u.lastT(),e,t,r)},translate:function(e,t,r){u.translate(u.lastT(),e,t,r)}};Object.defineProperties(d,{matrix:{get:function(){return u.computedMatrix},set:function(e){u.setMatrix(u.lastT(),e);return u.computedMatrix},enumerable:true},mode:{get:function(){return u.getMode()},set:function(e){var t=u.computedUp.slice();var r=u.computedEye.slice();var a=u.computedCenter.slice();u.setMode(e);if(e==="turntable"){var i=n();u._active.lookAt(i,r,a,t);u._active.lookAt(i+500,r,a,[0,0,1]);u._active.flush(i)}return u.getMode()},enumerable:true},center:{get:function(){return u.computedCenter},set:function(e){u.lookAt(u.lastT(),null,e);return u.computedCenter},enumerable:true},eye:{get:function(){return u.computedEye},set:function(e){u.lookAt(u.lastT(),e);return u.computedEye},enumerable:true},up:{get:function(){return u.computedUp},set:function(e){u.lookAt(u.lastT(),null,null,e);return u.computedUp},enumerable:true},distance:{get:function(){return f},set:function(e){u.setDistance(u.lastT(),e);return e},enumerable:true},distanceLimits:{get:function(){return u.getDistanceLimits(r)},set:function(e){u.setDistanceLimits(e);return e},enumerable:true}});e.addEventListener("contextmenu",function(e){e.preventDefault();return false});d._lastX=-1;d._lastY=-1;d._lastMods={shift:false,control:false,alt:false,meta:false};d.enableMouseListeners=function(){d.mouseListener=i(e,t);e.addEventListener("touchstart",function(r){var n=s(r.changedTouches[0],e);t(0,n[0],n[1],d._lastMods);t(1,n[0],n[1],d._lastMods)},l?{passive:true}:false);e.addEventListener("touchmove",function(r){var n=s(r.changedTouches[0],e);t(1,n[0],n[1],d._lastMods);r.preventDefault()},l?{passive:false}:false);e.addEventListener("touchend",function(e){t(0,d._lastX,d._lastY,d._lastMods)},l?{passive:true}:false);function t(t,r,a,i){var o=d.keyBindingMode;if(o===false)return;var s=o==="rotate";var l=o==="pan";var c=o==="zoom";var h=!!i.control;var p=!!i.alt;var v=!!i.shift;var m=!!(t&1);var g=!!(t&2);var y=!!(t&4);var x=1/e.clientHeight;var _=x*(r-d._lastX);var b=x*(a-d._lastY);var w=d.flipX?1:-1;var T=d.flipY?1:-1;var k=Math.PI*d.rotateSpeed;var A=n();if(d._lastX!==-1&&d._lastY!==-1){if(s&&m&&!h&&!p&&!v||m&&!h&&!p&&v){u.rotate(A,w*k*_,-T*k*b,0)}if(l&&m&&!h&&!p&&!v||g||m&&h&&!p&&!v){u.pan(A,-d.translateSpeed*_*f,d.translateSpeed*b*f,0)}if(c&&m&&!h&&!p&&!v||y||m&&!h&&p&&!v){var M=-d.zoomSpeed*b/window.innerHeight*(A-u.lastT())*100;u.pan(A,0,0,f*(Math.exp(M)-1))}}d._lastX=r;d._lastY=a;d._lastMods=i;return true}d.wheelListener=o(e,function(e,t){if(d.keyBindingMode===false)return;if(!d.enableWheel)return;var r=d.flipX?1:-1;var a=d.flipY?1:-1;var i=n();if(Math.abs(e)>Math.abs(t)){u.rotate(i,0,0,-e*r*Math.PI*d.rotateSpeed/window.innerWidth)}else{if(!d._ortho){var o=-d.zoomSpeed*a*t/window.innerHeight*(i-u.lastT())/20;u.pan(i,0,0,f*(Math.exp(o)-1))}}},true)};d.enableMouseListeners();return d}},{"3d-view":54,"has-passive-events":441,"mouse-change":483,"mouse-event-offset":484,"mouse-wheel":486,"right-now":542}],319:[function(e,t,r){var n=e("glslify");var a=e("gl-shader");var i=n(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);t.exports=function(e){return a(e,i,o,null,[{name:"position",type:"vec2"}])}},{"gl-shader":335,glslify:320}],320:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],321:[function(e,t,r){"use strict";var n=e("./camera.js");var a=e("gl-axes3d");var i=e("gl-axes3d/properties");var o=e("gl-spikes3d");var s=e("gl-select-static");var l=e("gl-fbo");var u=e("a-big-triangle");var c=e("mouse-change");var f=e("gl-mat4/perspective");var h=e("gl-mat4/ortho");var p=e("./lib/shader");var d=e("is-mobile")({tablet:true,featureDetect:true});t.exports={createScene:x,createCamera:n};function v(){this.mouse=[-1,-1];this.screen=null;this.distance=Infinity;this.index=null;this.dataCoordinate=null;this.dataPosition=null;this.object=null;this.data=null}function m(e,t){var r=null;try{r=e.getContext("webgl",t);if(!r){r=e.getContext("experimental-webgl",t)}}catch(e){return null}return r}function g(e){var t=Math.round(Math.log(Math.abs(e))/Math.log(10));if(t<0){var r=Math.round(Math.pow(10,-t));return Math.ceil(e*r)/r}else if(t>0){var r=Math.round(Math.pow(10,t));return Math.ceil(e/r)*r}return Math.ceil(e)}function y(e){if(typeof e==="boolean"){return e}return true}function x(e){e=e||{};e.camera=e.camera||{};var t=e.canvas;if(!t){t=document.createElement("canvas");if(e.container){var r=e.container;r.appendChild(t)}else{document.body.appendChild(t)}}var f=e.gl;if(!f){if(e.glOptions){d=!!e.glOptions.preserveDrawingBuffer}f=m(t,e.glOptions||{premultipliedAlpha:true,antialias:true,preserveDrawingBuffer:d})}if(!f){throw new Error("webgl not supported")}var h=e.bounds||[[-10,-10,-10],[10,10,10]];var x=new v;var b=l(f,f.drawingBufferWidth,f.drawingBufferHeight,{preferFloat:!d});var w=p(f);var T=e.cameraObject&&e.cameraObject._ortho===true||e.camera.projection&&e.camera.projection.type==="orthographic"||false;var k={eye:e.camera.eye||[2,0,0],center:e.camera.center||[0,0,0],up:e.camera.up||[0,1,0],zoomMin:e.camera.zoomMax||.1,zoomMax:e.camera.zoomMin||100,mode:e.camera.mode||"turntable",_ortho:T};var A=e.axes||{};var M=a(f,A);M.enable=!A.disable;var E=e.spikes||{};var S=o(f,E);var C=[];var L=[];var I=[];var O=[];var P=true;var D=true;var R=new Array(16);var z=new Array(16);var N={view:null,projection:R,model:z,_ortho:false};var D=true;var F=[f.drawingBufferWidth,f.drawingBufferHeight];var B=e.cameraObject||n(t,k);var j={gl:f,contextLost:false,pixelRatio:e.pixelRatio||1,canvas:t,selection:x,camera:B,axes:M,axesPixels:null,spikes:S,bounds:h,objects:C,shape:F,aspect:e.aspectRatio||[1,1,1],pickRadius:e.pickRadius||10,zNear:e.zNear||.01,zFar:e.zFar||1e3,fovy:e.fovy||Math.PI/4,clearColor:e.clearColor||[0,0,0,0],autoResize:y(e.autoResize),autoBounds:y(e.autoBounds),autoScale:!!e.autoScale,autoCenter:y(e.autoCenter),clipToBounds:y(e.clipToBounds),snapToData:!!e.snapToData,onselect:e.onselect||null,onrender:e.onrender||null,onclick:e.onclick||null,cameraParams:N,oncontextloss:null,mouseListener:null,_stopped:false,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(e){this.aspect[0]=e.x;this.aspect[1]=e.y;this.aspect[2]=e.z;D=true},setBounds:function(e,t){this.bounds[0][e]=t.min;this.bounds[1][e]=t.max},setClearColor:function(e){this.clearColor=e},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}};var U=[f.drawingBufferWidth/j.pixelRatio|0,f.drawingBufferHeight/j.pixelRatio|0];function H(){if(j._stopped){return}if(!j.autoResize){return}var e=t.parentNode;var r=1;var n=1;if(e&&e!==document.body){r=e.clientWidth;n=e.clientHeight}else{r=window.innerWidth;n=window.innerHeight}var a=Math.ceil(r*j.pixelRatio)|0;var i=Math.ceil(n*j.pixelRatio)|0;if(a!==t.width||i!==t.height){t.width=a;t.height=i;var o=t.style;o.position=o.position||"absolute";o.left="0px";o.top="0px";o.width=r+"px";o.height=n+"px";P=true}}if(j.autoResize){H()}window.addEventListener("resize",H);function V(){var e=C.length;var t=O.length;for(var r=0;r<t;++r){I[r]=0}e:for(var r=0;r<e;++r){var n=C[r];var a=n.pickSlots;if(!a){L[r]=-1;continue}for(var i=0;i<t;++i){if(I[i]+a<255){L[r]=i;n.setPickBase(I[i]+1);I[i]+=a;continue e}}var o=s(f,F);L[r]=t;O.push(o);I.push(a);n.setPickBase(1);t+=1}while(t>0&&I[t-1]===0){I.pop();O.pop().dispose()}}j.update=function(e){if(j._stopped){return}e=e||{};P=true;D=true};j.add=function(e){if(j._stopped){return}e.axes=M;C.push(e);L.push(-1);P=true;D=true;V()};j.remove=function(e){if(j._stopped){return}var t=C.indexOf(e);if(t<0){return}C.splice(t,1);L.pop();P=true;D=true;V()};j.dispose=function(){if(j._stopped){return}j._stopped=true;window.removeEventListener("resize",H);t.removeEventListener("webglcontextlost",G);j.mouseListener.enabled=false;if(j.contextLost){return}M.dispose();S.dispose();for(var e=0;e<C.length;++e){C[e].dispose()}b.dispose();for(var e=0;e<O.length;++e){O[e].dispose()}w.dispose();f=null;M=null;S=null;C=[]};j._mouseRotating=false;j._prevButtons=0;j.enableMouseListeners=function(){j.mouseListener=c(t,function(e,t,r){if(j._stopped){return}var n=O.length;var a=C.length;var i=x.object;x.distance=Infinity;x.mouse[0]=t;x.mouse[1]=r;x.object=null;x.screen=null;x.dataCoordinate=x.dataPosition=null;var o=false;if(e&&j._prevButtons){j._mouseRotating=true}else{if(j._mouseRotating){D=true}j._mouseRotating=false;for(var s=0;s<n;++s){var l=O[s].query(t,U[1]-r-1,j.pickRadius);if(l){if(l.distance>x.distance){continue}for(var u=0;u<a;++u){var c=C[u];if(L[u]!==s){continue}var f=c.pick(l);if(f){x.buttons=e;x.screen=l.coord;x.distance=l.distance;x.object=c;x.index=f.distance;x.dataPosition=f.position;x.dataCoordinate=f.dataCoordinate;x.data=f;o=true}}}}}if(i&&i!==x.object){if(i.highlight){i.highlight(null)}P=true}if(x.object){if(x.object.highlight){x.object.highlight(x.data)}P=true}o=o||x.object!==i;if(o&&j.onselect){j.onselect(x)}if(e&1&&!(j._prevButtons&1)&&j.onclick){j.onclick(x)}j._prevButtons=e})};function G(){if(j.contextLost){return true}if(f.isContextLost()){j.contextLost=true;j.mouseListener.enabled=false;j.selection.object=null;if(j.oncontextloss){j.oncontextloss()}}}t.addEventListener("webglcontextlost",G);function q(){if(G()){return}f.colorMask(true,true,true,true);f.depthMask(true);f.disable(f.BLEND);f.enable(f.DEPTH_TEST);f.depthFunc(f.LEQUAL);var e=C.length;var t=O.length;for(var r=0;r<t;++r){var n=O[r];n.shape=U;n.begin();for(var a=0;a<e;++a){if(L[a]!==r){continue}var i=C[a];if(i.drawPick){i.pixelRatio=1;i.drawPick(N)}}n.end()}}var Y=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var W=[Y[0].slice(),Y[1].slice()];function X(){if(G()){return}H();var e=j.camera.tick();N.view=j.camera.matrix;P=P||e;D=D||e;M.pixelRatio=j.pixelRatio;S.pixelRatio=j.pixelRatio;var t=C.length;var r=Y[0];var n=Y[1];r[0]=r[1]=r[2]=Infinity;n[0]=n[1]=n[2]=-Infinity;for(var a=0;a<t;++a){var o=C[a];o.pixelRatio=j.pixelRatio;o.axes=j.axes;P=P||!!o.dirty;D=D||!!o.dirty;var s=o.bounds;if(s){var l=s[0];var c=s[1];for(var h=0;h<3;++h){r[h]=Math.min(r[h],l[h]);n[h]=Math.max(n[h],c[h])}}}var p=j.bounds;if(j.autoBounds){for(var h=0;h<3;++h){if(n[h]<r[h]){r[h]=-1;n[h]=1}else{if(r[h]===n[h]){r[h]-=1;n[h]+=1}var d=.05*(n[h]-r[h]);r[h]=r[h]-d;n[h]=n[h]+d}p[0][h]=r[h];p[1][h]=n[h]}}var v=false;for(var h=0;h<3;++h){v=v||W[0][h]!==p[0][h]||W[1][h]!==p[1][h];W[0][h]=p[0][h];W[1][h]=p[1][h]}D=D||v;P=P||v;if(!P){return}if(v){var m=[0,0,0];for(var a=0;a<3;++a){m[a]=g((p[1][a]-p[0][a])/10)}if(M.autoTicks){M.update({bounds:p,tickSpacing:m})}else{M.update({bounds:p})}}var y=f.drawingBufferWidth;var k=f.drawingBufferHeight;F[0]=y;F[1]=k;U[0]=Math.max(y/j.pixelRatio,1)|0;U[1]=Math.max(k/j.pixelRatio,1)|0;_(j,T);for(var a=0;a<t;++a){var o=C[a];o.axesBounds=p;if(j.clipToBounds){o.clipBounds=p}}if(x.object){if(j.snapToData){S.position=x.dataCoordinate}else{S.position=x.dataPosition}S.bounds=p}if(D){D=false;q()}j.axesPixels=i(j.axes,N,y,k);if(j.onrender){j.onrender()}f.bindFramebuffer(f.FRAMEBUFFER,null);f.viewport(0,0,y,k);j.clearRGBA();f.depthMask(true);f.colorMask(true,true,true,true);f.enable(f.DEPTH_TEST);f.depthFunc(f.LEQUAL);f.disable(f.BLEND);f.disable(f.CULL_FACE);var A=false;if(M.enable){A=A||M.isTransparent();M.draw(N)}S.axes=M;if(x.object){S.draw(N)}f.disable(f.CULL_FACE);for(var a=0;a<t;++a){var o=C[a];o.axes=M;o.pixelRatio=j.pixelRatio;if(o.isOpaque&&o.isOpaque()){o.draw(N)}if(o.isTransparent&&o.isTransparent()){A=true}}if(A){b.shape=F;b.bind();f.clear(f.DEPTH_BUFFER_BIT);f.colorMask(false,false,false,false);f.depthMask(true);f.depthFunc(f.LESS);if(M.enable&&M.isTransparent()){M.drawTransparent(N)}for(var a=0;a<t;++a){var o=C[a];if(o.isOpaque&&o.isOpaque()){o.draw(N)}}f.enable(f.BLEND);f.blendEquation(f.FUNC_ADD);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.colorMask(true,true,true,true);f.depthMask(false);f.clearColor(0,0,0,0);f.clear(f.COLOR_BUFFER_BIT);if(M.isTransparent()){M.drawTransparent(N)}for(var a=0;a<t;++a){var o=C[a];if(o.isTransparent&&o.isTransparent()){o.drawTransparent(N)}}f.bindFramebuffer(f.FRAMEBUFFER,null);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.disable(f.DEPTH_TEST);w.bind();b.color[0].bind(0);w.uniforms.accumBuffer=0;u(f);f.disable(f.BLEND)}P=false;for(var a=0;a<t;++a){C[a].dirty=false}}function Z(){if(j._stopped||j.contextLost){return}X();requestAnimationFrame(Z)}j.enableMouseListeners();Z();j.redraw=function(){if(j._stopped){return}P=true;X()};return j}function _(e,t){var r=e.bounds;var n=e.cameraParams;var a=n.projection;var i=n.model;var o=e.gl.drawingBufferWidth;var s=e.gl.drawingBufferHeight;var l=e.zNear;var u=e.zFar;var c=e.fovy;var p=o/s;if(t){h(a,-p,p,-1,1,l,u);n._ortho=true}else{f(a,c,p,l,u);n._ortho=false}for(var d=0;d<16;++d){i[d]=0}i[15]=1;var v=0;for(var d=0;d<3;++d){v=Math.max(v,r[1][d]-r[0][d])}for(var d=0;d<3;++d){if(e.autoScale){i[5*d]=e.aspect[d]/(r[1][d]-r[0][d])}else{i[5*d]=1/v}if(e.autoCenter){i[12+d]=-i[5*d]*.5*(r[0][d]+r[1][d])}}}},{"./camera.js":318,"./lib/shader":319,"a-big-triangle":64,"gl-axes3d":250,"gl-axes3d/properties":258,"gl-fbo":269,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":334,"gl-spikes3d":345,"is-mobile":467,"mouse-change":483}],322:[function(e,t,r){var n=e("glslify");r.pointVertex=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]);r.pointFragment=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]);r.pickVertex=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]);r.pickFragment=n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:323}],323:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],324:[function(e,t,r){"use strict";var n=e("gl-shader");var a=e("gl-buffer");var i=e("typedarray-pool");var o=e("./lib/shader");t.exports=c;function s(e,t,r,n,a){this.plot=e;this.offsetBuffer=t;this.pickBuffer=r;this.shader=n;this.pickShader=a;this.sizeMin=.5;this.sizeMinCap=2;this.sizeMax=20;this.areaRatio=1;this.pointCount=0;this.color=[1,0,0,1];this.borderColor=[0,0,0,1];this.blend=false;this.pickOffset=0;this.points=null}var l=s.prototype;l.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.offsetBuffer.dispose();this.pickBuffer.dispose();this.plot.removeObject(this)};l.update=function(e){var t;e=e||{};function r(t,r){if(t in e){return e[t]}return r}this.sizeMin=r("sizeMin",.5);this.sizeMax=r("sizeMax",20);this.color=r("color",[1,0,0,1]).slice();this.areaRatio=r("areaRatio",1);this.borderColor=r("borderColor",[0,0,0,1]).slice();this.blend=r("blend",false);var n=e.positions.length>>>1;var a=e.positions instanceof Float32Array;var o=e.idToIndex instanceof Int32Array&&e.idToIndex.length>=n;var s=e.positions;var l=a?s:i.mallocFloat32(s.length);var u=o?e.idToIndex:i.mallocInt32(n);if(!a){l.set(s)}if(!o){l.set(s);for(t=0;t<n;t++){u[t]=t}}this.points=s;this.offsetBuffer.update(l);this.pickBuffer.update(u);if(!a){i.free(l)}if(!o){i.free(u)}this.pointCount=n;this.pickOffset=0};function u(e,t){var r=0;var n=e.length>>>1;var a;for(a=0;a<n;a++){var i=e[a*2];var o=e[a*2+1];if(i>=t[0]&&i<=t[2]&&o>=t[1]&&o<=t[3])r++}return r}l.unifiedDraw=function(){var e=[1,0,0,0,1,0,0,0,1];var t=[0,0,0,0];return function(r){var n=r!==void 0;var a=n?this.pickShader:this.shader;var i=this.plot.gl;var o=this.plot.dataBox;if(this.pointCount===0){return r}var s=o[2]-o[0];var l=o[3]-o[1];var c=u(this.points,o);var f=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(c,.33333)));e[0]=2/s;e[4]=2/l;e[6]=-2*o[0]/s-1;e[7]=-2*o[1]/l-1;this.offsetBuffer.bind();a.bind();a.attributes.position.pointer();a.uniforms.matrix=e;a.uniforms.color=this.color;a.uniforms.borderColor=this.borderColor;a.uniforms.pointCloud=f<5;a.uniforms.pointSize=f;a.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio)));if(n){t[0]=r&255;t[1]=r>>8&255;t[2]=r>>16&255;t[3]=r>>24&255;this.pickBuffer.bind();a.attributes.pickId.pointer(i.UNSIGNED_BYTE);a.uniforms.pickOffset=t;this.pickOffset=r}var h=i.getParameter(i.BLEND);var p=i.getParameter(i.DITHER);if(h&&!this.blend)i.disable(i.BLEND);if(p)i.disable(i.DITHER);i.drawArrays(i.POINTS,0,this.pointCount);if(h&&!this.blend)i.enable(i.BLEND);if(p)i.enable(i.DITHER);return r+this.pointCount}}();l.draw=l.unifiedDraw;l.drawPick=l.unifiedDraw;l.pick=function(e,t,r){var n=this.pickOffset;var a=this.pointCount;if(r<n||r>=n+a){return null}var i=r-n;var o=this.points;return{object:this,pointId:i,dataCoord:[o[2*i],o[2*i+1]]}};function c(e,t){var r=e.gl;var i=a(r);var l=a(r);var u=n(r,o.pointVertex,o.pointFragment);var c=n(r,o.pickVertex,o.pickFragment);var f=new s(e,i,l,u,c);f.update(t);e.addObject(f);return f}},{"./lib/shader":322,"gl-buffer":259,"gl-shader":335,"typedarray-pool":595}],325:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3],l=r[0],u=r[1],c=r[2],f=r[3];var h,p,d,v,m;p=a*l+i*u+o*c+s*f;if(p<0){p=-p;l=-l;u=-u;c=-c;f=-f}if(1-p>1e-6){h=Math.acos(p);d=Math.sin(h);v=Math.sin((1-n)*h)/d;m=Math.sin(n*h)/d}else{v=1-n;m=n}e[0]=v*a+m*l;e[1]=v*i+m*u;e[2]=v*o+m*c;e[3]=v*s+m*f;return e}},{}],326:[function(e,t,r){"use strict";t.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],327:[function(e,t,r){"use strict";var n=e("vectorize-text");t.exports=i;var a={};function i(e,t,r){var i=a[t];if(!i){i=a[t]={}}if(e in i){return i[e]}var o={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:true,bolds:true,italics:true,subscripts:true,superscripts:true}};o.triangles=true;var s=n(e,o);o.triangles=false;var l=n(e,o);var u,c;if(r&&r!==1){for(u=0;u<s.positions.length;++u){for(c=0;c<s.positions[u].length;++c){s.positions[u][c]/=r}}for(u=0;u<l.positions.length;++u){for(c=0;c<l.positions[u].length;++c){l.positions[u][c]/=r}}}var f=[[Infinity,Infinity],[-Infinity,-Infinity]];var h=l.positions.length;for(u=0;u<h;++u){var p=l.positions[u];for(c=0;c<2;++c){f[0][c]=Math.min(f[0][c],p[c]);f[1][c]=Math.max(f[1][c],p[c])}}return i[e]=[s,l,f]}},{"vectorize-text":600}],328:[function(e,t,r){var n=e("gl-shader");var a=e("glslify");var i=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var o=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var s=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]);var l=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]);var u=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]);var c=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}];var f={vertex:i,fragment:l,attributes:c},h={vertex:o,fragment:l,attributes:c},p={vertex:s,fragment:l,attributes:c},d={vertex:i,fragment:u,attributes:c},v={vertex:o,fragment:u,attributes:c},m={vertex:s,fragment:u,attributes:c};function g(e,t){var r=n(e,t);var a=r.attributes;a.position.location=0;a.color.location=1;a.glyph.location=2;a.id.location=3;return r}r.createPerspective=function(e){return g(e,f)};r.createOrtho=function(e){return g(e,h)};r.createProject=function(e){return g(e,p)};r.createPickPerspective=function(e){return g(e,d)};r.createPickOrtho=function(e){return g(e,v)};r.createPickProject=function(e){return g(e,m)}},{"gl-shader":335,glslify:329}],329:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],330:[function(e,t,r){"use strict";var n=e("is-string-blank");var a=e("gl-buffer");var i=e("gl-vao");var o=e("typedarray-pool");var s=e("gl-mat4/multiply");var l=e("./lib/shaders");var u=e("./lib/glyphs");var c=e("./lib/get-simple-string");var f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.exports=z;function h(e,t){var r=e[0];var n=e[1];var a=e[2];var i=e[3];e[0]=t[0]*r+t[4]*n+t[8]*a+t[12]*i;e[1]=t[1]*r+t[5]*n+t[9]*a+t[13]*i;e[2]=t[2]*r+t[6]*n+t[10]*a+t[14]*i;e[3]=t[3]*r+t[7]*n+t[11]*a+t[15]*i;return e}function p(e,t,r,n){h(n,n,r);h(n,n,t);return h(n,n,e)}function d(e,t){this.index=e;this.dataCoordinate=this.position=t}function v(e){if(e===true)return 1;if(e>1)return 1;return e}function m(e,t,r,n,a,i,o,s,l,u,c,f){this.gl=e;this.pixelRatio=1;this.shader=t;this.orthoShader=r;this.projectShader=n;this.pointBuffer=a;this.colorBuffer=i;this.glyphBuffer=o;this.idBuffer=s;this.vao=l;this.vertexCount=0;this.lineVertexCount=0;this.opacity=1;this.hasAlpha=false;this.lineWidth=0;this.projectScale=[2/3,2/3,2/3];this.projectOpacity=[1,1,1];this.projectHasAlpha=false;this.pickId=0;this.pickPerspectiveShader=u;this.pickOrthoShader=c;this.pickProjectShader=f;this.points=[];this._selectResult=new d(0,[0,0,0]);this.useOrtho=true;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.axesProject=[true,true,true];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.highlightId=[1,1,1,1];this.highlightScale=2;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.dirty=true}var g=m.prototype;g.pickSlots=1;g.setPickBase=function(e){this.pickId=e};g.isTransparent=function(){if(this.hasAlpha){return true}for(var e=0;e<3;++e){if(this.axesProject[e]&&this.projectHasAlpha){return true}}return false};g.isOpaque=function(){if(!this.hasAlpha){return true}for(var e=0;e<3;++e){if(this.axesProject[e]&&!this.projectHasAlpha){return true}}return false};var y=[0,0];var x=[0,0,0];var _=[0,0,0];var b=[0,0,0,1];var w=[0,0,0,1];var T=f.slice();var k=[0,0,0];var A=[[0,0,0],[0,0,0]];function M(e){e[0]=e[1]=e[2]=0;return e}function E(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=1;return e}function S(e,t,r,n){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[r]=n;return e}function C(e){var t=A;for(var r=0;r<2;++r){for(var n=0;n<3;++n){t[r][n]=Math.max(Math.min(e[r][n],1e8),-1e8)}}return t}function L(e,t,r,n){var a=t.axesProject;var i=t.gl;var o=e.uniforms;var l=r.model||f;var u=r.view||f;var c=r.projection||f;var h=t.axesBounds;var d=C(t.clipBounds);var v;if(t.axes&&t.axes.lastCubeProps){v=t.axes.lastCubeProps.axis}else{v=[1,1,1]}y[0]=2/i.drawingBufferWidth;y[1]=2/i.drawingBufferHeight;e.bind();o.view=u;o.projection=c;o.screenSize=y;o.highlightId=t.highlightId;o.highlightScale=t.highlightScale;o.clipBounds=d;o.pickGroup=t.pickId/255;o.pixelRatio=n;for(var m=0;m<3;++m){if(!a[m]){continue}o.scale=t.projectScale[m];o.opacity=t.projectOpacity[m];var g=T;for(var A=0;A<16;++A){g[A]=0}for(var A=0;A<4;++A){g[5*A]=1}g[5*m]=0;if(v[m]<0){g[12+m]=h[0][m]}else{g[12+m]=h[1][m]}s(g,l,g);o.model=g;var L=(m+1)%3;var I=(m+2)%3;var O=M(x);var P=M(_);O[L]=1;P[I]=1;var D=p(c,u,l,E(b,O));var R=p(c,u,l,E(w,P));if(Math.abs(D[1])>Math.abs(R[1])){var z=D;D=R;R=z;z=O;O=P;P=z;var N=L;L=I;I=N}if(D[0]<0){O[L]=-1}if(R[1]>0){P[I]=-1}var F=0;var B=0;for(var A=0;A<4;++A){F+=Math.pow(l[4*L+A],2);B+=Math.pow(l[4*I+A],2)}O[L]/=Math.sqrt(F);P[I]/=Math.sqrt(B);o.axes[0]=O;o.axes[1]=P;o.fragClipBounds[0]=S(k,d[0],m,-1e8);o.fragClipBounds[1]=S(k,d[1],m,1e8);t.vao.bind();t.vao.draw(i.TRIANGLES,t.vertexCount);if(t.lineWidth>0){i.lineWidth(t.lineWidth*n);t.vao.draw(i.LINES,t.lineVertexCount,t.vertexCount)}t.vao.unbind()}}var I=[-1e8,-1e8,-1e8];var O=[1e8,1e8,1e8];var P=[I,O];function D(e,t,r,n,a,i,o){var s=r.gl;if(i===r.projectHasAlpha||o){L(t,r,n,a)}if(i===r.hasAlpha||o){e.bind();var l=e.uniforms;l.model=n.model||f;l.view=n.view||f;l.projection=n.projection||f;y[0]=2/s.drawingBufferWidth;y[1]=2/s.drawingBufferHeight;l.screenSize=y;l.highlightId=r.highlightId;l.highlightScale=r.highlightScale;l.fragClipBounds=P;l.clipBounds=r.axes.bounds;l.opacity=r.opacity;l.pickGroup=r.pickId/255;l.pixelRatio=a;r.vao.bind();r.vao.draw(s.TRIANGLES,r.vertexCount);if(r.lineWidth>0){s.lineWidth(r.lineWidth*a);r.vao.draw(s.LINES,r.lineVertexCount,r.vertexCount)}r.vao.unbind()}}g.draw=function(e){var t=this.useOrtho?this.orthoShader:this.shader;D(t,this.projectShader,this,e,this.pixelRatio,false,false)};g.drawTransparent=function(e){var t=this.useOrtho?this.orthoShader:this.shader;D(t,this.projectShader,this,e,this.pixelRatio,true,false)};g.drawPick=function(e){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;D(t,this.pickProjectShader,this,e,1,true,true)};g.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[2]+(e.value[1]<<8)+(e.value[0]<<16);if(t>=this.pointCount||t<0){return null}var r=this.points[t];var n=this._selectResult;n.index=t;for(var a=0;a<3;++a){n.position[a]=n.dataCoordinate[a]=r[a]}return n};g.highlight=function(e){if(!e){this.highlightId=[1,1,1,1]}else{var t=e.index;var r=t&255;var n=t>>8&255;var a=t>>16&255;this.highlightId=[r/255,n/255,a/255,0]}};function R(e,t,r,a){var i;if(Array.isArray(e)){if(t<e.length){i=e[t]}else{i=undefined}}else{i=e}i=c(i);var o=true;if(n(i)){i="▼";o=false}var s=u(i,r,a);return{mesh:s[0],lines:s[1],bounds:s[2],visible:o}}g.update=function(e){e=e||{};if("perspective"in e){this.useOrtho=!e.perspective}if("orthographic"in e){this.useOrtho=!!e.orthographic}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("project"in e){if(Array.isArray(e.project)){this.axesProject=e.project}else{var t=!!e.project;this.axesProject=[t,t,t]}}if("projectScale"in e){if(Array.isArray(e.projectScale)){this.projectScale=e.projectScale.slice()}else{var r=+e.projectScale;this.projectScale=[r,r,r]}}this.projectHasAlpha=false;if("projectOpacity"in e){if(Array.isArray(e.projectOpacity)){this.projectOpacity=e.projectOpacity.slice()}else{var r=+e.projectOpacity;this.projectOpacity=[r,r,r]}for(var n=0;n<3;++n){this.projectOpacity[n]=v(this.projectOpacity[n]);if(this.projectOpacity[n]<1){this.projectHasAlpha=true}}}this.hasAlpha=false;if("opacity"in e){this.opacity=v(e.opacity);if(this.opacity<1){this.hasAlpha=true}}this.dirty=true;var a=e.position;var i=e.font||"normal";var s=e.alignment||[0,0];var l;var u;if(s.length===2){l=s[0];u=s[1]}else{l=[];u=[];for(var n=0;n<s.length;++n){l[n]=s[n][0];u[n]=s[n][1]}}var c=[Infinity,Infinity,Infinity];var f=[-Infinity,-Infinity,-Infinity];var h=e.glyph;var p=e.color;var d=e.size;var m=e.angle;var g=e.lineColor;var y=-1;var x=0;var _=0;var b=0;if(a.length){b=a.length;e:for(var n=0;n<b;++n){var w=a[n];for(var T=0;T<3;++T){if(isNaN(w[T])||!isFinite(w[T])){continue e}}var k=R(h,n,i,this.pixelRatio);var A=k.mesh;var M=k.lines;var E=k.bounds;x+=A.cells.length*3;_+=M.edges.length*2}}var S=x+_;var C=o.mallocFloat(3*S);var L=o.mallocFloat(4*S);var I=o.mallocFloat(2*S);var O=o.mallocUint32(S);if(S>0){var P=0;var D=x;var z=[0,0,0,1];var N=[0,0,0,1];var F=Array.isArray(p)&&Array.isArray(p[0]);var B=Array.isArray(g)&&Array.isArray(g[0]);e:for(var n=0;n<b;++n){y+=1;var w=a[n];for(var T=0;T<3;++T){if(isNaN(w[T])||!isFinite(w[T])){continue e}f[T]=Math.max(f[T],w[T]);c[T]=Math.min(c[T],w[T])}var k=R(h,n,i,this.pixelRatio);var A=k.mesh;var M=k.lines;var E=k.bounds;var j=k.visible;if(!j)z=[1,1,1,0];else if(Array.isArray(p)){var U;if(F){if(n<p.length){U=p[n]}else{U=[0,0,0,0]}}else{U=p}if(U.length===3){for(var T=0;T<3;++T){z[T]=U[T]}z[3]=1}else if(U.length===4){for(var T=0;T<4;++T){z[T]=U[T]}if(!this.hasAlpha&&U[3]<1)this.hasAlpha=true}}else{z[0]=z[1]=z[2]=0;z[3]=1}if(!j)N=[1,1,1,0];else if(Array.isArray(g)){var U;if(B){if(n<g.length){U=g[n]}else{U=[0,0,0,0]}}else{U=g}if(U.length===3){for(var T=0;T<3;++T){N[T]=U[T]}N[T]=1}else if(U.length===4){for(var T=0;T<4;++T){N[T]=U[T]}if(!this.hasAlpha&&U[3]<1)this.hasAlpha=true}}else{N[0]=N[1]=N[2]=0;N[3]=1}var H=.5;if(!j)H=0;else if(Array.isArray(d)){if(n<d.length){H=+d[n]}else{H=12}}else if(d){H=+d}else if(this.useOrtho){H=12}var V=0;if(Array.isArray(m)){if(n<m.length){V=+m[n]}else{V=0}}else if(m){V=+m}var G=Math.cos(V);var q=Math.sin(V);var w=a[n];for(var T=0;T<3;++T){f[T]=Math.max(f[T],w[T]);c[T]=Math.min(c[T],w[T])}var Y=l;var W=u;var Y=0;if(Array.isArray(l)){if(n<l.length){Y=l[n]}else{Y=0}}else if(l){Y=l}var W=0;if(Array.isArray(u)){if(n<u.length){W=u[n]}else{W=0}}else if(u){W=u}Y*=Y>0?1-E[0][0]:Y<0?1+E[1][0]:1;W*=W>0?1-E[0][1]:W<0?1+E[1][1]:1;var X=[Y,W];var Z=A.cells||[];var K=A.positions||[];for(var T=0;T<Z.length;++T){var J=Z[T];for(var Q=0;Q<3;++Q){for(var $=0;$<3;++$){C[3*P+$]=w[$]}for(var $=0;$<4;++$){L[4*P+$]=z[$]}O[P]=y;var ee=K[J[Q]];I[2*P]=H*(G*ee[0]-q*ee[1]+X[0]);I[2*P+1]=H*(q*ee[0]+G*ee[1]+X[1]);P+=1}}var Z=M.edges;var K=M.positions;for(var T=0;T<Z.length;++T){var J=Z[T];for(var Q=0;Q<2;++Q){for(var $=0;$<3;++$){C[3*D+$]=w[$]}for(var $=0;$<4;++$){L[4*D+$]=N[$]}O[D]=y;var ee=K[J[Q]];I[2*D]=H*(G*ee[0]-q*ee[1]+X[0]);I[2*D+1]=H*(q*ee[0]+G*ee[1]+X[1]);D+=1}}}}this.bounds=[c,f];this.points=a;this.pointCount=a.length;this.vertexCount=x;this.lineVertexCount=_;this.pointBuffer.update(C);this.colorBuffer.update(L);this.glyphBuffer.update(I);this.idBuffer.update(O);o.free(C);o.free(L);o.free(I);o.free(O)};g.dispose=function(){this.shader.dispose();this.orthoShader.dispose();this.pickPerspectiveShader.dispose();this.pickOrthoShader.dispose();this.vao.dispose();this.pointBuffer.dispose();this.colorBuffer.dispose();this.glyphBuffer.dispose();this.idBuffer.dispose()};function z(e){var t=e.gl;var r=l.createPerspective(t);var n=l.createOrtho(t);var o=l.createProject(t);var s=l.createPickPerspective(t);var u=l.createPickOrtho(t);var c=l.createPickProject(t);var f=a(t);var h=a(t);var p=a(t);var d=a(t);var v=i(t,[{buffer:f,size:3,type:t.FLOAT},{buffer:h,size:4,type:t.FLOAT},{buffer:p,size:2,type:t.FLOAT},{buffer:d,size:4,type:t.UNSIGNED_BYTE,normalized:true}]);var g=new m(t,r,n,o,f,h,p,d,v,s,u,c);g.update(e);return g}},{"./lib/get-simple-string":326,"./lib/glyphs":327,"./lib/shaders":328,"gl-buffer":259,"gl-mat4/multiply":295,"gl-vao":358,"is-string-blank":470,"typedarray-pool":595}],331:[function(e,t,r){"use strict";var n=e("glslify");r.boxVertex=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]);r.boxFragment=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:332}],332:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],333:[function(e,t,r){"use strict";var n=e("gl-shader");var a=e("gl-buffer");var i=e("./lib/shaders");t.exports=l;function o(e,t,r){this.plot=e;this.boxBuffer=t;this.boxShader=r;this.enabled=true;this.selectBox=[Infinity,Infinity,-Infinity,-Infinity];this.borderColor=[0,0,0,1];this.innerFill=false;this.innerColor=[0,0,0,.25];this.outerFill=true;this.outerColor=[0,0,0,.5];this.borderWidth=10}var s=o.prototype;s.draw=function(){if(!this.enabled){return}var e=this.plot;var t=this.selectBox;var r=this.borderWidth;var n=this.innerFill;var a=this.innerColor;var i=this.outerFill;var o=this.outerColor;var s=this.borderColor;var l=e.box;var u=e.screenBox;var c=e.dataBox;var f=e.viewBox;var h=e.pixelRatio;var p=(t[0]-c[0])*(f[2]-f[0])/(c[2]-c[0])+f[0];var d=(t[1]-c[1])*(f[3]-f[1])/(c[3]-c[1])+f[1];var v=(t[2]-c[0])*(f[2]-f[0])/(c[2]-c[0])+f[0];var m=(t[3]-c[1])*(f[3]-f[1])/(c[3]-c[1])+f[1];p=Math.max(p,f[0]);d=Math.max(d,f[1]);v=Math.min(v,f[2]);m=Math.min(m,f[3]);if(v<p||m<d){return}l.bind();var g=u[2]-u[0];var y=u[3]-u[1];if(this.outerFill){l.drawBox(0,0,g,d,o);l.drawBox(0,d,p,m,o);l.drawBox(0,m,g,y,o);l.drawBox(v,d,g,m,o)}if(this.innerFill){l.drawBox(p,d,v,m,a)}if(r>0){var x=r*h;l.drawBox(p-x,d-x,v+x,d+x,s);l.drawBox(p-x,m-x,v+x,m+x,s);l.drawBox(p-x,d-x,p+x,m+x,s);l.drawBox(v-x,d-x,v+x,m+x,s)}};s.update=function(e){e=e||{};this.innerFill=!!e.innerFill;this.outerFill=!!e.outerFill;this.innerColor=(e.innerColor||[0,0,0,.5]).slice();this.outerColor=(e.outerColor||[0,0,0,.5]).slice();this.borderColor=(e.borderColor||[0,0,0,1]).slice();this.borderWidth=e.borderWidth||0;this.selectBox=(e.selectBox||this.selectBox).slice()};s.dispose=function(){this.boxBuffer.dispose();this.boxShader.dispose();this.plot.removeOverlay(this)};function l(e,t){var r=e.gl;var s=a(r,[0,0,0,1,1,0,1,1]);var l=n(r,i.boxVertex,i.boxFragment);var u=new o(e,s,l);u.update(t);e.addOverlay(u);return u}},{"./lib/shaders":331,"gl-buffer":259,"gl-shader":335}],334:[function(e,t,r){"use strict";t.exports=f;var n=e("gl-fbo");var a=e("typedarray-pool");var i=e("ndarray");var o=e("bit-twiddle").nextPow2;var s=function(e,t,r){var n=1e8;var a=-1;var i=-1;var o=e.shape[0];var s=e.shape[1];for(var l=0;l<o;l++){for(var u=0;u<s;u++){var c=e.get(l,u,0);var f=e.get(l,u,1);var h=e.get(l,u,2);var p=e.get(l,u,3);if(c<255||f<255||h<255||p<255){var d=t-l;var v=r-u;var m=d*d+v*v;if(m<n){n=m;a=l;i=u}}}}return[a,i,n]};function l(e,t,r,n,a){this.coord=[e,t];this.id=r;this.value=n;this.distance=a}function u(e,t,r){this.gl=e;this.fbo=t;this.buffer=r;this._readTimeout=null;var n=this;this._readCallback=function(){if(!n.gl){return}t.bind();e.readPixels(0,0,t.shape[0],t.shape[1],e.RGBA,e.UNSIGNED_BYTE,n.buffer);n._readTimeout=null}}var c=u.prototype;Object.defineProperty(c,"shape",{get:function(){if(!this.gl){return[0,0]}return this.fbo.shape.slice()},set:function(e){if(!this.gl){return}this.fbo.shape=e;var t=this.fbo.shape[0];var r=this.fbo.shape[1];if(r*t*4>this.buffer.length){a.free(this.buffer);var n=this.buffer=a.mallocUint8(o(r*t*4));for(var i=0;i<r*t*4;++i){n[i]=255}}return e}});c.begin=function(){var e=this.gl;var t=this.shape;if(!e){return}this.fbo.bind();e.clearColor(1,1,1,1);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};c.end=function(){var e=this.gl;if(!e){return}e.bindFramebuffer(e.FRAMEBUFFER,null);if(!this._readTimeout){clearTimeout(this._readTimeout)}this._readTimeout=setTimeout(this._readCallback,1)};c.query=function(e,t,r){if(!this.gl){return null}var n=this.fbo.shape.slice();e=e|0;t=t|0;if(typeof r!=="number"){r=1}var a=Math.min(Math.max(e-r,0),n[0])|0;var o=Math.min(Math.max(e+r,0),n[0])|0;var u=Math.min(Math.max(t-r,0),n[1])|0;var c=Math.min(Math.max(t+r,0),n[1])|0;if(o<=a||c<=u){return null}var f=[o-a,c-u];var h=i(this.buffer,[f[0],f[1],4],[4,n[0]*4,1],4*(a+n[0]*u));var p=s(h.hi(f[0],f[1],1),r,r);var d=p[0];var v=p[1];if(d<0||Math.pow(this.radius,2)<p[2]){return null}var m=h.get(d,v,0);var g=h.get(d,v,1);var y=h.get(d,v,2);var x=h.get(d,v,3);return new l(d+a|0,v+u|0,m,[g,y,x],Math.sqrt(p[2]))};c.dispose=function(){if(!this.gl){return}this.fbo.dispose();a.free(this.buffer);this.gl=null;if(this._readTimeout){clearTimeout(this._readTimeout)}};function f(e,t){var r=t[0];var i=t[1];var o={};var s=n(e,r,i,o);var l=a.mallocUint8(r*i*4);return new u(e,s,l)}},{"bit-twiddle":97,"gl-fbo":269,ndarray:495,"typedarray-pool":595}],335:[function(e,t,r){"use strict";var n=e("./lib/create-uniforms");var a=e("./lib/create-attributes");var i=e("./lib/reflect");var o=e("./lib/shader-cache");var s=e("./lib/runtime-reflect");var l=e("./lib/GLError");function u(e){this.gl=e;this.gl.lastAttribCount=0;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var c=u.prototype;c.bind=function(){if(!this.program){this._relink()}var e;var t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);var r=this.gl.lastAttribCount;if(t>r){for(e=r;e<t;e++){this.gl.enableVertexAttribArray(e)}}else if(r>t){for(e=t;e<r;e++){this.gl.disableVertexAttribArray(e)}}this.gl.lastAttribCount=t;this.gl.useProgram(this.program)};c.dispose=function(){var e=this.gl.lastAttribCount;for(var t=0;t<e;t++){this.gl.disableVertexAttribArray(t)}this.gl.lastAttribCount=0;if(this._fref){this._fref.dispose()}if(this._vref){this._vref.dispose()}this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function f(e,t){if(e.name<t.name){return-1}return 1}c.update=function(e,t,r,u){if(!t||arguments.length===1){var c=e;e=c.vertex;t=c.fragment;r=c.uniforms;u=c.attributes}var h=this;var p=h.gl;var d=h._vref;h._vref=o.shader(p,p.VERTEX_SHADER,e);if(d){d.dispose()}h.vertShader=h._vref.shader;var v=this._fref;h._fref=o.shader(p,p.FRAGMENT_SHADER,t);if(v){v.dispose()}h.fragShader=h._fref.shader;if(!r||!u){var m=p.createProgram();p.attachShader(m,h.fragShader);p.attachShader(m,h.vertShader);p.linkProgram(m);if(!p.getProgramParameter(m,p.LINK_STATUS)){var g=p.getProgramInfoLog(m);throw new l(g,"Error linking program:"+g)}r=r||s.uniforms(p,m);u=u||s.attributes(p,m);p.deleteProgram(m)}u=u.slice();u.sort(f);var y=[];var x=[];var _=[];var b;for(b=0;b<u.length;++b){var w=u[b];if(w.type.indexOf("mat")>=0){var T=w.type.charAt(w.type.length-1)|0;var k=new Array(T);for(var A=0;A<T;++A){k[A]=_.length;x.push(w.name+"["+A+"]");if(typeof w.location==="number"){_.push(w.location+A)}else if(Array.isArray(w.location)&&w.location.length===T&&typeof w.location[A]==="number"){_.push(w.location[A]|0)}else{_.push(-1)}}y.push({name:w.name,type:w.type,locations:k})}else{y.push({name:w.name,type:w.type,locations:[_.length]});x.push(w.name);if(typeof w.location==="number"){_.push(w.location|0)}else{_.push(-1)}}}var M=0;for(b=0;b<_.length;++b){if(_[b]<0){while(_.indexOf(M)>=0){M+=1}_[b]=M}}var E=new Array(r.length);function S(){h.program=o.program(p,h._vref,h._fref,x,_);for(var e=0;e<r.length;++e){E[e]=p.getUniformLocation(h.program,r[e].name)}}S();h._relink=S;h.types={uniforms:i(r),attributes:i(u)};h.attributes=a(p,h,y,_);Object.defineProperty(h,"uniforms",n(p,h,r,E))};function h(e,t,r,n,a){var i=new u(e);i.update(t,r,n,a);return i}t.exports=h},{"./lib/GLError":336,"./lib/create-attributes":337,"./lib/create-uniforms":338,"./lib/reflect":339,"./lib/runtime-reflect":340,"./lib/shader-cache":341}],336:[function(e,t,r){function n(e,t,r){this.shortMessage=t||"";this.longMessage=r||"";this.rawError=e||"";this.message="gl-shader: "+(t||e||"")+(r?"\n"+r:"");this.stack=(new Error).stack}n.prototype=new Error;n.prototype.name="GLError";n.prototype.constructor=n;t.exports=n},{}],337:[function(e,t,r){"use strict";t.exports=l;var n=e("./GLError");function a(e,t,r,n,a,i){this._gl=e;this._wrapper=t;this._index=r;this._locations=n;this._dimension=a;this._constFunc=i}var i=a.prototype;i.pointer=function e(t,r,n,a){var i=this;var o=i._gl;var s=i._locations[i._index];o.vertexAttribPointer(s,i._dimension,t||o.FLOAT,!!r,n||0,a||0);o.enableVertexAttribArray(s)};i.set=function(e,t,r,n){return this._constFunc(this._locations[this._index],e,t,r,n)};Object.defineProperty(i,"location",{get:function(){return this._locations[this._index]},set:function(e){if(e!==this._locations[this._index]){this._locations[this._index]=e|0;this._wrapper.program=null}return e|0}});function o(e,t,r,n,i,o,s){var l=["gl","v"];var u=[];for(var c=0;c<i;++c){l.push("x"+c);u.push("x"+c)}l.push("if(x0.length===void 0){return gl.vertexAttrib"+i+"f(v,"+u.join()+")}else{return gl.vertexAttrib"+i+"fv(v,x0)}");var f=Function.apply(null,l);var h=new a(e,t,r,n,i,f);Object.defineProperty(o,s,{set:function(t){e.disableVertexAttribArray(n[r]);f(e,n[r],t);return t},get:function(){return h},enumerable:true})}function s(e,t,r,n,a,i,s){var l=new Array(a);var u=new Array(a);for(var c=0;c<a;++c){o(e,t,r[c],n,a,l,c);u[c]=l[c]}Object.defineProperty(l,"location",{set:function(e){if(Array.isArray(e)){for(var t=0;t<a;++t){u[t].location=e[t]}}else{for(var t=0;t<a;++t){u[t].location=e+t}}return e},get:function(){var e=new Array(a);for(var t=0;t<a;++t){e[t]=n[r[t]]}return e},enumerable:true});l.pointer=function(t,i,o,s){t=t||e.FLOAT;i=!!i;o=o||a*a;s=s||0;for(var l=0;l<a;++l){var u=n[r[l]];e.vertexAttribPointer(u,a,t,i,o,s+l*a);e.enableVertexAttribArray(u)}};var f=new Array(a);var h=e["vertexAttrib"+a+"fv"];Object.defineProperty(i,s,{set:function(t){for(var i=0;i<a;++i){var o=n[r[i]];e.disableVertexAttribArray(o);if(Array.isArray(t[0])){h.call(e,o,t[i])}else{for(var s=0;s<a;++s){f[s]=t[a*i+s]}h.call(e,o,f)}}return t},get:function(){return l},enumerable:true})}function l(e,t,r,a){var i={};for(var l=0,u=r.length;l<u;++l){var c=r[l];var f=c.name;var h=c.type;var p=c.locations;switch(h){case"bool":case"int":case"float":o(e,t,p[0],a,1,i,f);break;default:if(h.indexOf("vec")>=0){var d=h.charCodeAt(h.length-1)-48;if(d<2||d>4){throw new n("","Invalid data type for attribute "+f+": "+h)}o(e,t,p[0],a,d,i,f)}else if(h.indexOf("mat")>=0){var d=h.charCodeAt(h.length-1)-48;if(d<2||d>4){throw new n("","Invalid data type for attribute "+f+": "+h)}s(e,t,p,a,d,i,f)}else{throw new n("","Unknown data type for attribute "+f+": "+h)}break}}return i}},{"./GLError":336}],338:[function(e,t,r){"use strict";var n=e("./reflect");var a=e("./GLError");t.exports=s;function i(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=t}return r}function s(e,t,r,s){function l(r){var n=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+r+"])}");return n(e,t,s)}function u(e,t,r){switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var n=r.indexOf("vec");if(0<=n&&n<=1&&r.length===4+n){var i=r.charCodeAt(r.length-1)-48;if(i<2||i>4){throw new a("","Invalid data type")}switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+i+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+i+"fv(locations["+t+"],obj"+e+")";default:throw new a("","Unrecognized data type for vector "+name+": "+r)}}else if(r.indexOf("mat")===0&&r.length===4){var i=r.charCodeAt(r.length-1)-48;if(i<2||i>4){throw new a("","Invalid uniform dimension type for matrix "+name+": "+r)}return"gl.uniformMatrix"+i+"fv(locations["+t+"],false,obj"+e+")"}else{throw new a("","Unknown uniform data type for "+name+": "+r)}break}}function c(e,t){if(typeof t!=="object"){return[[e,t]]}var r=[];for(var n in t){var a=t[n];var i=e;if(parseInt(n)+""===n){i+="["+n+"]"}else{i+="."+n}if(typeof a==="object"){r.push.apply(r,c(i,a))}else{r.push([i,a])}}return r}function f(t){var n=["return function updateProperty(obj){"];var a=c("",t);for(var i=0;i<a.length;++i){var o=a[i];var l=o[0];var f=o[1];if(s[f]){n.push(u(l,f,r[f].type))}}n.push("return obj}");var h=new Function("gl","locations",n.join("\n"));return h(e,s)}function h(e){switch(e){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new a("","Invalid data type")}if(e.charAt(0)==="b"){return o(r,false)}return o(r,0)}else if(e.indexOf("mat")===0&&e.length===4){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new a("","Invalid uniform dimension type for matrix "+name+": "+e)}return o(r*r,0)}else{throw new a("","Unknown uniform data type for "+name+": "+e)}break}}function p(e,t,n){if(typeof n==="object"){var a=d(n);Object.defineProperty(e,t,{get:i(a),set:f(n),enumerable:true,configurable:false})}else{if(s[n]){Object.defineProperty(e,t,{get:l(n),set:f(n),enumerable:true,configurable:false})}else{e[t]=h(r[n].type)}}}function d(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var r=0;r<e.length;++r){p(t,r,e[r])}}else{t={};for(var n in e){p(t,n,e[n])}}return t}var v=n(r,true);return{get:i(d(v)),set:f(v),enumerable:true,configurable:true}}},{"./GLError":336,"./reflect":339}],339:[function(e,t,r){"use strict";t.exports=n;function n(e,t){var r={};for(var n=0;n<e.length;++n){var a=e[n].name;var i=a.split(".");var o=r;for(var s=0;s<i.length;++s){var l=i[s].split("[");if(l.length>1){if(!(l[0]in o)){o[l[0]]=[]}o=o[l[0]];for(var u=1;u<l.length;++u){var c=parseInt(l[u]);if(u<l.length-1||s<i.length-1){if(!(c in o)){if(u<l.length-1){o[c]=[]}else{o[c]={}}}o=o[c]}else{if(t){o[c]=n}else{o[c]=e[n].type}}}}else if(s<i.length-1){if(!(l[0]in o)){o[l[0]]={}}o=o[l[0]]}else{if(t){o[l[0]]=n}else{o[l[0]]=e[n].type}}}}return r}},{}],340:[function(e,t,r){"use strict";r.uniforms=o;r.attributes=s;var n={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"};var a=null;function i(e,t){if(!a){var r=Object.keys(n);a={};for(var i=0;i<r.length;++i){var o=r[i];a[e[o]]=n[o]}}return a[t]}function o(e,t){var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);var n=[];for(var a=0;a<r;++a){var o=e.getActiveUniform(t,a);if(o){var s=i(e,o.type);if(o.size>1){for(var l=0;l<o.size;++l){n.push({name:o.name.replace("[0]","["+l+"]"),type:s})}}else{n.push({name:o.name,type:s})}}}return n}function s(e,t){var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);var n=[];for(var a=0;a<r;++a){var o=e.getActiveAttrib(t,a);if(o){n.push({name:o.name,type:i(e,o.type)})}}return n}},{}],341:[function(e,t,r){"use strict";r.shader=d;r.program=v;var n=e("./GLError");var a=e("gl-format-compiler-error");var i=typeof WeakMap==="undefined"?e("weakmap-shim"):WeakMap;var o=new i;var s=0;function l(e,t,r,n,a,i,o){this.id=e;this.src=t;this.type=r;this.shader=n;this.count=i;this.programs=[];this.cache=o}l.prototype.dispose=function(){if(--this.count===0){var e=this.cache;var t=e.gl;var r=this.programs;for(var n=0,a=r.length;n<a;++n){var i=e.programs[r[n]];if(i){delete e.programs[n];t.deleteProgram(i)}}t.deleteShader(this.shader);delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};function u(e){this.gl=e;this.shaders=[{},{}];this.programs={}}var c=u.prototype;function f(e,t,r){var i=e.createShader(t);e.shaderSource(i,r);e.compileShader(i);if(!e.getShaderParameter(i,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(i);try{var s=a(o,r,t)}catch(e){console.warn("Failed to format compiler error: "+e);throw new n(o,"Error compiling shader:\n"+o)}throw new n(o,s.short,s.long)}return i}c.getShaderReference=function(e,t){var r=this.gl;var n=this.shaders[e===r.FRAGMENT_SHADER|0];var a=n[t];if(!a||!r.isShader(a.shader)){var i=f(r,e,t);a=n[t]=new l(s++,t,e,i,[],1,this)}else{a.count+=1}return a};function h(e,t,r,a,i){var o=e.createProgram();e.attachShader(o,t);e.attachShader(o,r);for(var s=0;s<a.length;++s){e.bindAttribLocation(o,i[s],a[s])}e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS)){var l=e.getProgramInfoLog(o);throw new n(l,"Error linking program: "+l)}return o}c.getProgram=function(e,t,r,n){var a=[e.id,t.id,r.join(":"),n.join(":")].join("@");var i=this.programs[a];if(!i||!this.gl.isProgram(i)){this.programs[a]=i=h(this.gl,e.shader,t.shader,r,n);e.programs.push(a);t.programs.push(a)}return i};function p(e){var t=o.get(e);if(!t){t=new u(e);o.set(e,t)}return t}function d(e,t,r){return p(e).getShaderReference(t,r)}function v(e,t,r,n,a){return p(e).getProgram(t,r,n,a)}},{"./GLError":336,"gl-format-compiler-error":270,"weakmap-shim":605}],342:[function(e,t,r){"use strict";t.exports=i;function n(e){this.plot=e;this.enable=[true,true,false,false];this.width=[1,1,1,1];this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.center=[Infinity,Infinity]}var a=n.prototype;a.update=function(e){e=e||{};this.enable=(e.enable||[true,true,false,false]).slice();this.width=(e.width||[1,1,1,1]).slice();this.color=(e.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(e){return e.slice()});this.center=(e.center||[Infinity,Infinity]).slice();this.plot.setOverlayDirty()};a.draw=function(){var e=this.enable;var t=this.width;var r=this.color;var n=this.center;var a=this.plot;var i=a.line;var o=a.dataBox;var s=a.viewBox;i.bind();if(o[0]<=n[0]&&n[0]<=o[2]&&o[1]<=n[1]&&n[1]<=o[3]){var l=s[0]+(n[0]-o[0])/(o[2]-o[0])*(s[2]-s[0]);var u=s[1]+(n[1]-o[1])/(o[3]-o[1])*(s[3]-s[1]);if(e[0]){i.drawLine(l,u,s[0],u,t[0],r[0])}if(e[1]){i.drawLine(l,u,l,s[1],t[1],r[1])}if(e[2]){i.drawLine(l,u,s[2],u,t[2],r[2])}if(e[3]){i.drawLine(l,u,l,s[3],t[3],r[3])}}};a.dispose=function(){this.plot.removeOverlay(this)};function i(e,t){var r=new n(e);r.update(t);e.addOverlay(r);return r}},{}],343:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],344:[function(e,t,r){"use strict";var n=e("glslify");var a=e("gl-shader");var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);t.exports=function(e){return a(e,i,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":335,glslify:343}],345:[function(e,t,r){"use strict";var n=e("gl-buffer");var a=e("gl-vao");var i=e("./shaders/index");t.exports=h;var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(e,t,r,n){this.gl=e;this.buffer=t;this.vao=r;this.shader=n;this.pixelRatio=1;this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]];this.position=[0,0,0];this.lineWidth=[2,2,2];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.enabled=[true,true,true];this.drawSides=[true,true,true];this.axes=null}var l=s.prototype;var u=[0,0,0];var c=[0,0,0];var f=[0,0];l.isTransparent=function(){return false};l.drawTransparent=function(e){};l.draw=function(e){var t=this.gl;var r=this.vao;var n=this.shader;r.bind();n.bind();var a=e.model||o;var i=e.view||o;var s=e.projection||o;var l;if(this.axes){l=this.axes.lastCubeProps.axis}var h=u;var p=c;for(var d=0;d<3;++d){if(l&&l[d]<0){h[d]=this.bounds[0][d];p[d]=this.bounds[1][d]}else{h[d]=this.bounds[1][d];p[d]=this.bounds[0][d]}}f[0]=t.drawingBufferWidth;f[1]=t.drawingBufferHeight;n.uniforms.model=a;n.uniforms.view=i;n.uniforms.projection=s;n.uniforms.coordinates=[this.position,h,p];n.uniforms.colors=this.colors;n.uniforms.screenShape=f;for(var d=0;d<3;++d){n.uniforms.lineWidth=this.lineWidth[d]*this.pixelRatio;if(this.enabled[d]){r.draw(t.TRIANGLES,6,6*d);if(this.drawSides[d]){r.draw(t.TRIANGLES,12,18+12*d)}}}r.unbind()};l.update=function(e){if(!e){return}if("bounds"in e){this.bounds=e.bounds}if("position"in e){this.position=e.position}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("colors"in e){this.colors=e.colors}if("enabled"in e){this.enabled=e.enabled}if("drawSides"in e){this.drawSides=e.drawSides}};l.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function h(e,t){var r=[];function o(e,t,n,a,i,o){var s=[e,t,n,0,0,0,1];s[a+3]=1;s[a]=i;r.push.apply(r,s);s[6]=-1;r.push.apply(r,s);s[a]=o;r.push.apply(r,s);r.push.apply(r,s);s[6]=1;r.push.apply(r,s);s[a]=i;r.push.apply(r,s)}o(0,0,0,0,0,1);o(0,0,0,1,0,1);o(0,0,0,2,0,1);o(1,0,0,1,-1,1);o(1,0,0,2,-1,1);o(0,1,0,0,-1,1);o(0,1,0,2,-1,1);o(0,0,1,0,-1,1);o(0,0,1,1,-1,1);var l=n(e,r);var u=a(e,[{type:e.FLOAT,buffer:l,size:3,offset:0,stride:28},{type:e.FLOAT,buffer:l,size:3,offset:12,stride:28},{type:e.FLOAT,buffer:l,size:1,offset:24,stride:28}]);var c=i(e);c.attributes.position.location=0;c.attributes.color.location=1;c.attributes.weight.location=2;var f=new s(e,l,u,c);f.update(t);return f}},{"./shaders/index":344,"gl-buffer":259,"gl-vao":358}],346:[function(e,t,r){var n=e("glslify");var a=n(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]);var i=n(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]);var o=n(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:a,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:347}],347:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],348:[function(e,t,r){"use strict";var n=e("gl-vec3");var a=e("gl-vec4");var i=["xyz","xzy","yxz","yzx","zxy","zyx"];var o=function(e,t,r,i){var o=e.points;var s=e.velocities;var l=e.divergences;var u=[];var c=[];var f=[];var h=[];var p=[];var d=[];var v=0;var m=0;var g=a.create();var y=a.create();var x=8;for(var _=0;_<o.length;_++){var b=o[_];var w=s[_];var T=l[_];if(t===0){T=r*.05}m=n.length(w)/i;g=a.create();n.copy(g,w);g[3]=T;for(var k=0;k<x;k++){p[k]=[b[0],b[1],b[2],k]}if(h.length>0){for(var k=0;k<x;k++){var A=(k+1)%x;u.push(h[k],p[k],p[A],p[A],h[A],h[k]);f.push(y,g,g,g,y,y);d.push(v,m,m,m,v,v);var M=u.length;c.push([M-6,M-5,M-4],[M-3,M-2,M-1])}}var E=h;h=p;p=E;var S=y;y=g;g=S;var C=v;v=m;m=C}return{positions:u,cells:c,vectors:f,vertexIntensity:d}};var s=function(e,t,r,a){var i=0;for(var s=0;s<e.length;s++){var l=e[s].velocities;for(var u=0;u<l.length;u++){i=Math.max(i,n.length(l[u]))}}var c=e.map(function(e){return o(e,r,a,i)});var f=[];var h=[];var p=[];var d=[];for(var s=0;s<c.length;s++){var v=c[s];var m=f.length;f=f.concat(v.positions);p=p.concat(v.vectors);d=d.concat(v.vertexIntensity);for(var u=0;u<v.cells.length;u++){var g=v.cells[u];var y=[];h.push(y);for(var x=0;x<g.length;x++){y.push(g[x]+m)}}}return{positions:f,cells:h,vectors:p,vertexIntensity:d,colormap:t}};var l=function(e,t){var r=e.length;var n;for(n=0;n<r;n++){var a=e[n];if(a===t)return n;else if(a>t)return n-1}return n};var u=function(e,t,r){return e<t?t:e>r?r:e};var c=function(e,t,r){var a=t.vectors;var i=t.meshgrid;var o=e[0];var s=e[1];var c=e[2];var f=i[0].length;var h=i[1].length;var p=i[2].length;var d=l(i[0],o);var v=l(i[1],s);var m=l(i[2],c);var g=d+1;var y=v+1;var x=m+1;d=u(d,0,f-1);g=u(g,0,f-1);v=u(v,0,h-1);y=u(y,0,h-1);m=u(m,0,p-1);x=u(x,0,p-1);if(d<0||v<0||m<0||g>f-1||y>h-1||x>p-1){return n.create()}var _=i[0][d];var b=i[0][g];var w=i[1][v];var T=i[1][y];var k=i[2][m];var A=i[2][x];var M=(o-_)/(b-_);var E=(s-w)/(T-w);var S=(c-k)/(A-k);if(!isFinite(M))M=.5;if(!isFinite(E))E=.5;if(!isFinite(S))S=.5;var C;var L;var I;var O;var P;var D;if(r.reversedX){d=f-1-d;g=f-1-g}if(r.reversedY){v=h-1-v;y=h-1-y}if(r.reversedZ){m=p-1-m;x=p-1-x}switch(r.filled){case 5:P=m;D=x;I=v*p;O=y*p;C=d*p*h;L=g*p*h;break;case 4:P=m;D=x;C=d*p;L=g*p;I=v*p*f;O=y*p*f;break;case 3:I=v;O=y;P=m*h;D=x*h;C=d*h*p;L=g*h*p;break;case 2:I=v;O=y;C=d*h;L=g*h;P=m*h*f;D=x*h*f;break;case 1:C=d;L=g;P=m*f;D=x*f;I=v*f*p;O=y*f*p;break;default:C=d;L=g;I=v*f;O=y*f;P=m*f*h;D=x*f*h;break}var R=a[C+I+P];var z=a[C+I+D];var N=a[C+O+P];var F=a[C+O+D];var B=a[L+I+P];var j=a[L+I+D];var U=a[L+O+P];var H=a[L+O+D];var V=n.create();var G=n.create();var q=n.create();var Y=n.create();n.lerp(V,R,B,M);n.lerp(G,z,j,M);n.lerp(q,N,U,M);n.lerp(Y,F,H,M);var W=n.create();var X=n.create();n.lerp(W,V,q,E);n.lerp(X,G,Y,E);var Z=n.create();n.lerp(Z,W,X,S);return Z};var f=function(e,t){var r=t[0];var n=t[1];var a=t[2];e[0]=r<0?-r:r;e[1]=n<0?-n:n;e[2]=a<0?-a:a;return e};var h=function(e){var t=Infinity;e.sort(function(e,t){return e-t});var r=e.length;for(var n=1;n<r;n++){var a=Math.abs(e[n]-e[n-1]);if(a<t){t=a}}return t};var p=function(e){var t=[],r=[],n=[];var a={},i={},o={};var s=e.length;for(var l=0;l<s;l++){var u=e[l];var c=u[0],f=u[1],p=u[2];if(!a[c]){t.push(c);a[c]=true}if(!i[f]){r.push(f);i[f]=true}if(!o[p]){n.push(p);o[p]=true}}var d=h(t);var v=h(r);var m=h(n);var g=Math.min(d,v,m);return isFinite(g)?g:1};t.exports=function(e,t){var r=e.startingPositions;var a=e.maxLength||1e3;var o=e.tubeSize||1;var l=e.absoluteTubeSize;var u=e.gridFill||"+x+y+z";var f={};if(u.indexOf("-x")!==-1){f.reversedX=true}if(u.indexOf("-y")!==-1){f.reversedY=true}if(u.indexOf("-z")!==-1){f.reversedZ=true}f.filled=i.indexOf(u.replace(/-/g,"").replace(/\+/g,""));var h=e.getVelocity||function(t){return c(t,e,f)};var d=e.getDivergence||function(e,t){var r=n.create();var a=1e-4;n.add(r,e,[a,0,0]);var i=h(r);n.subtract(i,i,t);n.scale(i,i,1/a);n.add(r,e,[0,a,0]);var o=h(r);n.subtract(o,o,t);n.scale(o,o,1/a);n.add(r,e,[0,0,a]);var s=h(r);n.subtract(s,s,t);n.scale(s,s,1/a);n.add(r,i,o);n.add(r,r,s);return r};var v=[];var m=t[0][0],g=t[0][1],y=t[0][2];var x=t[1][0],_=t[1][1],b=t[1][2];var w=function(e){var t=e[0];var r=e[1];var n=e[2];return!(t<m||t>x||r<g||r>_||n<y||n>b)};var T=n.distance(t[0],t[1]);var k=10*T/a;var A=k*k;var M=1;var E=0;var S=r.length;if(S>1){M=p(r)}for(var C=0;C<S;C++){var L=n.create();n.copy(L,r[C]);var I=[L];var O=[];var P=h(L);var D=L;O.push(P);var R=[];var z=d(L,P);var N=n.length(z);if(isFinite(N)&&N>E){E=N}R.push(N);v.push({points:I,velocities:O,divergences:R});var F=0;while(F<a*100&&I.length<a&&w(L)){F++;var B=n.clone(P);var j=n.squaredLength(B);if(j===0){break}else if(j>A){n.scale(B,B,k/Math.sqrt(j))}n.add(B,B,L);P=h(B);if(n.squaredDistance(D,B)-A>-1e-4*A){I.push(B);D=B;O.push(P);var z=d(B,P);var N=n.length(z);if(isFinite(N)&&N>E){E=N}R.push(N)}L=B}}var U=s(v,e.colormap,E,M);if(l){U.tubeScale=l}else{if(E===0){E=1}U.tubeScale=o*.5*M/E}return U};var d=e("./lib/shaders");var v=e("gl-cone3d").createMesh;t.exports.createTubeMesh=function(e,t){return v(e,t,{shaders:d,traceType:"streamtube"})}},{"./lib/shaders":346,"gl-cone3d":260,"gl-vec3":377,"gl-vec4":413}],349:[function(e,t,r){var n=e("gl-shader");var a=e("glslify");var i=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]);var o=a(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color — in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]);var s=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]);var l=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);r.createShader=function(e){var t=n(e,i,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);t.attributes.uv.location=0;t.attributes.f.location=1;t.attributes.normal.location=2;return t};r.createPickShader=function(e){var t=n(e,i,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);t.attributes.uv.location=0;t.attributes.f.location=1;t.attributes.normal.location=2;return t};r.createContourShader=function(e){var t=n(e,s,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);t.attributes.uv.location=0;t.attributes.f.location=1;return t};r.createPickContourShader=function(e){var t=n(e,s,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);t.attributes.uv.location=0;t.attributes.f.location=1;return t}},{"gl-shader":335,glslify:350}],350:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],351:[function(e,t,r){"use strict";t.exports=H;var n=e("bit-twiddle");var a=e("gl-buffer");var i=e("gl-vao");var o=e("gl-texture2d");var s=e("typedarray-pool");var l=e("colormap");var u=e("ndarray-ops");var c=e("ndarray-pack");var f=e("ndarray");var h=e("surface-nets");var p=e("gl-mat4/multiply");var d=e("gl-mat4/invert");var v=e("binary-search-bounds");var m=e("ndarray-gradient");var g=e("./lib/shaders");var y=g.createShader;var x=g.createContourShader;var _=g.createPickShader;var b=g.createPickContourShader;var w=4*(4+3+3);var T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var k=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]];var A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var e=0;e<3;++e){var t=A[e];var r=(e+1)%3;var n=(e+2)%3;t[r+0]=1;t[n+3]=1;t[e+6]=1}})();function M(e,t,r,n,a){this.position=e;this.index=t;this.uv=r;this.level=n;this.dataCoordinate=a}var E=256;function S(e,t,r,n,a,i,o,l,u,c,h,p,d,v,m){this.gl=e;this.shape=t;this.bounds=r;this.objectOffset=m;this.intensityBounds=[];this._shader=n;this._pickShader=a;this._coordinateBuffer=i;this._vao=o;this._colorMap=l;this._contourShader=u;this._contourPickShader=c;this._contourBuffer=h;this._contourVAO=p;this._contourOffsets=[[],[],[]];this._contourCounts=[[],[],[]];this._vertexCount=0;this._pickResult=new M([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]);this._dynamicBuffer=d;this._dynamicVAO=v;this._dynamicOffsets=[0,0,0];this._dynamicCounts=[0,0,0];this.contourWidth=[1,1,1];this.contourLevels=[[1],[1],[1]];this.contourTint=[0,0,0];this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]];this.showContour=true;this.showSurface=true;this.enableHighlight=[true,true,true];this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.highlightTint=[1,1,1];this.highlightLevel=[-1,-1,-1];this.enableDynamic=[true,true,true];this.dynamicLevel=[NaN,NaN,NaN];this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.dynamicTint=[1,1,1];this.dynamicWidth=[1,1,1];this.axesBounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.surfaceProject=[false,false,false];this.contourProject=[[false,false,false],[false,false,false],[false,false,false]];this.colorBounds=[false,false];this._field=[f(s.mallocFloat(1024),[0,0]),f(s.mallocFloat(1024),[0,0]),f(s.mallocFloat(1024),[0,0])];this.pickId=1;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.snapToData=false;this.pixelRatio=1;this.opacity=1;this.lightPosition=[10,1e4,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.vertexColor=0;this.dirty=true}var C=S.prototype;C.genColormap=function(e,t){var r=false;var n=c([l({colormap:e,nshades:E,format:"rgba"}).map(function(e,n){var a=t?L(n/255,t):e[3];if(a<1)r=true;return[e[0],e[1],e[2],255*a]})]);u.divseq(n,255);this.hasAlphaScale=r;return n};C.isTransparent=function(){return this.opacity<1||this.hasAlphaScale};C.isOpaque=function(){return!this.isTransparent()};C.pickSlots=1;C.setPickBase=function(e){this.pickId=e};function L(e,t){if(!t)return 1;if(!t.length)return 1;for(var r=0;r<t.length;++r){if(t.length<2)return 1;if(t[r][0]===e)return t[r][1];if(t[r][0]>e&&r>0){var n=(t[r][0]-e)/(t[r][0]-t[r-1][0]);return t[r][1]*(1-n)+n*t[r-1][1]}}return 1}var I=[0,0,0];var O={showSurface:false,showContour:false,projections:[T.slice(),T.slice(),T.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function P(e,t){var r,n,a;var i=t.axes&&t.axes.lastCubeProps.axis||I;var o=t.showSurface;var s=t.showContour;for(r=0;r<3;++r){o=o||t.surfaceProject[r];for(n=0;n<3;++n){s=s||t.contourProject[r][n]}}for(r=0;r<3;++r){var l=O.projections[r];for(n=0;n<16;++n){l[n]=0}for(n=0;n<4;++n){l[5*n]=1}l[5*r]=0;l[12+r]=t.axesBounds[+(i[r]>0)][r];p(l,e.model,l);var u=O.clipBounds[r];for(a=0;a<2;++a){for(n=0;n<3;++n){u[a][n]=e.clipBounds[a][n]}}u[0][r]=-1e8;u[1][r]=1e8}O.showSurface=o;O.showContour=s;return O}var D={model:T,view:T,projection:T,inverseModel:T.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0};var R=T.slice();var z=[1,0,0,0,1,0,0,0,1];function N(e,t){e=e||{};var r=this.gl;r.disable(r.CULL_FACE);this._colorMap.bind(0);var n=D;n.model=e.model||T;n.view=e.view||T;n.projection=e.projection||T;n.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]];n.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]];n.objectOffset=this.objectOffset;n.contourColor=this.contourColor[0];n.inverseModel=d(n.inverseModel,n.model);for(var a=0;a<2;++a){var i=n.clipBounds[a];for(var o=0;o<3;++o){i[o]=Math.min(Math.max(this.clipBounds[a][o],-1e8),1e8)}}n.kambient=this.ambientLight;n.kdiffuse=this.diffuseLight;n.kspecular=this.specularLight;n.roughness=this.roughness;n.fresnel=this.fresnel;n.opacity=this.opacity;n.height=0;n.permutation=z;n.vertexColor=this.vertexColor;var s=R;p(s,n.view,n.model);p(s,n.projection,s);d(s,s);for(a=0;a<3;++a){n.eyePosition[a]=s[12+a]/s[15]}var l=s[15];for(a=0;a<3;++a){l+=this.lightPosition[a]*s[4*a+3]}for(a=0;a<3;++a){var u=s[12+a];for(o=0;o<3;++o){u+=s[4*o+a]*this.lightPosition[o]}n.lightPosition[a]=u/l}var c=P(n,this);if(c.showSurface){this._shader.bind();this._shader.uniforms=n;this._vao.bind();if(this.showSurface&&this._vertexCount){this._vao.draw(r.TRIANGLES,this._vertexCount)}for(a=0;a<3;++a){if(!this.surfaceProject[a]||!this.vertexCount){continue}this._shader.uniforms.model=c.projections[a];this._shader.uniforms.clipBounds=c.clipBounds[a];this._vao.draw(r.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(c.showContour){var f=this._contourShader;n.kambient=1;n.kdiffuse=0;n.kspecular=0;n.opacity=1;f.bind();f.uniforms=n;var h=this._contourVAO;h.bind();for(a=0;a<3;++a){f.uniforms.permutation=A[a];r.lineWidth(this.contourWidth[a]*this.pixelRatio);for(o=0;o<this.contourLevels[a].length;++o){if(o===this.highlightLevel[a]){f.uniforms.contourColor=this.highlightColor[a];f.uniforms.contourTint=this.highlightTint[a]}else if(o===0||o-1===this.highlightLevel[a]){f.uniforms.contourColor=this.contourColor[a];f.uniforms.contourTint=this.contourTint[a]}if(!this._contourCounts[a][o]){continue}f.uniforms.height=this.contourLevels[a][o];h.draw(r.LINES,this._contourCounts[a][o],this._contourOffsets[a][o])}}for(a=0;a<3;++a){f.uniforms.model=c.projections[a];f.uniforms.clipBounds=c.clipBounds[a];for(o=0;o<3;++o){if(!this.contourProject[a][o]){continue}f.uniforms.permutation=A[o];r.lineWidth(this.contourWidth[o]*this.pixelRatio);for(var v=0;v<this.contourLevels[o].length;++v){if(v===this.highlightLevel[o]){f.uniforms.contourColor=this.highlightColor[o];f.uniforms.contourTint=this.highlightTint[o]}else if(v===0||v-1===this.highlightLevel[o]){f.uniforms.contourColor=this.contourColor[o];f.uniforms.contourTint=this.contourTint[o]}if(!this._contourCounts[o][v]){continue}f.uniforms.height=this.contourLevels[o][v];h.draw(r.LINES,this._contourCounts[o][v],this._contourOffsets[o][v])}}}h.unbind();h=this._dynamicVAO;h.bind();for(a=0;a<3;++a){if(this._dynamicCounts[a]===0){continue}f.uniforms.model=n.model;f.uniforms.clipBounds=n.clipBounds;f.uniforms.permutation=A[a];r.lineWidth(this.dynamicWidth[a]*this.pixelRatio);f.uniforms.contourColor=this.dynamicColor[a];f.uniforms.contourTint=this.dynamicTint[a];f.uniforms.height=this.dynamicLevel[a];h.draw(r.LINES,this._dynamicCounts[a],this._dynamicOffsets[a]);for(o=0;o<3;++o){if(!this.contourProject[o][a]){continue}f.uniforms.model=c.projections[o];f.uniforms.clipBounds=c.clipBounds[o];h.draw(r.LINES,this._dynamicCounts[a],this._dynamicOffsets[a])}}h.unbind()}}C.draw=function(e){return N.call(this,e,false)};C.drawTransparent=function(e){return N.call(this,e,true)};var F={model:T,view:T,projection:T,inverseModel:T,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};C.drawPick=function(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE);var r=F;r.model=e.model||T;r.view=e.view||T;r.projection=e.projection||T;r.shape=this._field[2].shape;r.pickId=this.pickId/255;r.lowerBound=this.bounds[0];r.upperBound=this.bounds[1];r.objectOffset=this.objectOffset;r.permutation=z;for(var n=0;n<2;++n){var a=r.clipBounds[n];for(var i=0;i<3;++i){a[i]=Math.min(Math.max(this.clipBounds[n][i],-1e8),1e8)}}var o=P(r,this);if(o.showSurface){this._pickShader.bind();this._pickShader.uniforms=r;this._vao.bind();this._vao.draw(t.TRIANGLES,this._vertexCount);for(n=0;n<3;++n){if(!this.surfaceProject[n]){continue}this._pickShader.uniforms.model=o.projections[n];this._pickShader.uniforms.clipBounds=o.clipBounds[n];this._vao.draw(t.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(o.showContour){var s=this._contourPickShader;s.bind();s.uniforms=r;var l=this._contourVAO;l.bind();for(i=0;i<3;++i){t.lineWidth(this.contourWidth[i]*this.pixelRatio);s.uniforms.permutation=A[i];for(n=0;n<this.contourLevels[i].length;++n){if(this._contourCounts[i][n]){s.uniforms.height=this.contourLevels[i][n];l.draw(t.LINES,this._contourCounts[i][n],this._contourOffsets[i][n])}}}for(n=0;n<3;++n){s.uniforms.model=o.projections[n];s.uniforms.clipBounds=o.clipBounds[n];for(i=0;i<3;++i){if(!this.contourProject[n][i]){continue}s.uniforms.permutation=A[i];t.lineWidth(this.contourWidth[i]*this.pixelRatio);for(var u=0;u<this.contourLevels[i].length;++u){if(this._contourCounts[i][u]){s.uniforms.height=this.contourLevels[i][u];l.draw(t.LINES,this._contourCounts[i][u],this._contourOffsets[i][u])}}}}l.unbind()}};C.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=this._field[2].shape;var r=this._pickResult;var n=t[0]*(e.value[0]+(e.value[2]>>4)/16)/255;var a=Math.floor(n);var i=n-a;var o=t[1]*(e.value[1]+(e.value[2]&15)/16)/255;var s=Math.floor(o);var l=o-s;a+=1;s+=1;var u=r.position;u[0]=u[1]=u[2]=0;for(var c=0;c<2;++c){var f=c?i:1-i;for(var h=0;h<2;++h){var p=h?l:1-l;var d=a+c;var m=s+h;var g=f*p;for(var y=0;y<3;++y){u[y]+=this._field[y].get(d,m)*g}}}var x=this._pickResult.level;for(var _=0;_<3;++_){x[_]=v.le(this.contourLevels[_],u[_]);if(x[_]<0){if(this.contourLevels[_].length>0){x[_]=0}}else if(x[_]<this.contourLevels[_].length-1){var b=this.contourLevels[_][x[_]];var w=this.contourLevels[_][x[_]+1];if(Math.abs(b-u[_])>Math.abs(w-u[_])){x[_]+=1}}}r.index[0]=i<.5?a:a+1;r.index[1]=l<.5?s:s+1;r.uv[0]=n/t[0];r.uv[1]=o/t[1];for(y=0;y<3;++y){r.dataCoordinate[y]=this._field[y].get(r.index[0],r.index[1])}return r};C.padField=function(e,t){var r=t.shape.slice();var n=e.shape.slice();u.assign(e.lo(1,1).hi(r[0],r[1]),t);u.assign(e.lo(1).hi(r[0],1),t.hi(r[0],1));u.assign(e.lo(1,n[1]-1).hi(r[0],1),t.lo(0,r[1]-1).hi(r[0],1));u.assign(e.lo(0,1).hi(1,r[1]),t.hi(1));u.assign(e.lo(n[0]-1,1).hi(1,r[1]),t.lo(r[0]-1));e.set(0,0,t.get(0,0));e.set(0,n[1]-1,t.get(0,r[1]-1));e.set(n[0]-1,0,t.get(r[0]-1,0));e.set(n[0]-1,n[1]-1,t.get(r[0]-1,r[1]-1))};function B(e,t){if(Array.isArray(e)){return[t(e[0]),t(e[1]),t(e[2])]}return[t(e),t(e),t(e)]}function j(e){if(Array.isArray(e)){if(e.length===3){return[e[0],e[1],e[2],1]}return[e[0],e[1],e[2],e[3]]}return[0,0,0,1]}function U(e){if(Array.isArray(e)){if(Array.isArray(e)){return[j(e[0]),j(e[1]),j(e[2])]}else{var t=j(e);return[t.slice(),t.slice(),t.slice()]}}}C.update=function(e){e=e||{};this.objectOffset=e.objectOffset||this.objectOffset;this.dirty=true;if("contourWidth"in e){this.contourWidth=B(e.contourWidth,Number)}if("showContour"in e){this.showContour=B(e.showContour,Boolean)}if("showSurface"in e){this.showSurface=!!e.showSurface}if("contourTint"in e){this.contourTint=B(e.contourTint,Boolean)}if("contourColor"in e){this.contourColor=U(e.contourColor)}if("contourProject"in e){this.contourProject=B(e.contourProject,function(e){return B(e,Boolean)})}if("surfaceProject"in e){this.surfaceProject=e.surfaceProject}if("dynamicColor"in e){this.dynamicColor=U(e.dynamicColor)}if("dynamicTint"in e){this.dynamicTint=B(e.dynamicTint,Number)}if("dynamicWidth"in e){this.dynamicWidth=B(e.dynamicWidth,Number)}if("opacity"in e){this.opacity=e.opacity}if("opacityscale"in e){this.opacityscale=e.opacityscale}if("colorBounds"in e){this.colorBounds=e.colorBounds}if("vertexColor"in e){this.vertexColor=e.vertexColor?1:0}if("colormap"in e){this._colorMap.setPixels(this.genColormap(e.colormap,this.opacityscale))}var t=e.field||e.coords&&e.coords[2]||null;var r=false;if(!t){if(this._field[2].shape[0]||this._field[2].shape[2]){t=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2)}else{t=this._field[2].hi(0,0)}}if("field"in e||"coords"in e){var a=(t.shape[0]+2)*(t.shape[1]+2);if(a>this._field[2].data.length){s.freeFloat(this._field[2].data);this._field[2].data=s.mallocFloat(n.nextPow2(a))}this._field[2]=f(this._field[2].data,[t.shape[0]+2,t.shape[1]+2]);this.padField(this._field[2],t);this.shape=t.shape.slice();var i=this.shape;for(var o=0;o<2;++o){if(this._field[2].size>this._field[o].data.length){s.freeFloat(this._field[o].data);this._field[o].data=s.mallocFloat(this._field[2].size)}this._field[o]=f(this._field[o].data,[i[0]+2,i[1]+2])}if(e.coords){var l=e.coords;if(!Array.isArray(l)||l.length!==3){throw new Error("gl-surface: invalid coordinates for x/y")}for(o=0;o<2;++o){var u=l[o];for(g=0;g<2;++g){if(u.shape[g]!==i[g]){throw new Error("gl-surface: coords have incorrect shape")}}this.padField(this._field[o],u)}}else if(e.ticks){var c=e.ticks;if(!Array.isArray(c)||c.length!==2){throw new Error("gl-surface: invalid ticks")}for(o=0;o<2;++o){var p=c[o];if(Array.isArray(p)||p.length){p=f(p)}if(p.shape[0]!==i[o]){throw new Error("gl-surface: invalid tick length")}var d=f(p.data,i);d.stride[o]=p.stride[0];d.stride[o^1]=0;this.padField(this._field[o],d)}}else{for(o=0;o<2;++o){var v=[0,0];v[o]=1;this._field[o]=f(this._field[o].data,[i[0]+2,i[1]+2],v,0)}this._field[0].set(0,0,0);for(var g=0;g<i[0];++g){this._field[0].set(g+1,0,g)}this._field[0].set(i[0]+1,0,i[0]-1);this._field[1].set(0,0,0);for(g=0;g<i[1];++g){this._field[1].set(0,g+1,g)}this._field[1].set(0,i[1]+1,i[1]-1)}var y=this._field;var x=f(s.mallocFloat(y[2].size*3*2),[3,i[0]+2,i[1]+2,2]);for(o=0;o<3;++o){m(x.pick(o),y[o],"mirror")}var _=f(s.mallocFloat(y[2].size*3),[i[0]+2,i[1]+2,3]);for(o=0;o<i[0]+2;++o){for(g=0;g<i[1]+2;++g){var b=x.get(0,o,g,0);var w=x.get(0,o,g,1);var T=x.get(1,o,g,0);var A=x.get(1,o,g,1);var M=x.get(2,o,g,0);var E=x.get(2,o,g,1);var S=T*E-A*M;var C=M*w-E*b;var L=b*A-w*T;var I=Math.sqrt(S*S+C*C+L*L);if(I<1e-8){I=Math.max(Math.abs(S),Math.abs(C),Math.abs(L));if(I<1e-8){L=1;C=S=0;I=1}else{I=1/I}}else{I=1/Math.sqrt(I)}_.set(o,g,0,S*I);_.set(o,g,1,C*I);_.set(o,g,2,L*I)}}s.free(x.data);var O=[Infinity,Infinity,Infinity];var P=[-Infinity,-Infinity,-Infinity];var D=Infinity;var R=-Infinity;var z=(i[0]-1)*(i[1]-1)*6;var N=s.mallocFloat(n.nextPow2(10*z));var F=0;var j=0;for(o=0;o<i[0]-1;++o){e:for(g=0;g<i[1]-1;++g){for(var H=0;H<2;++H){for(var V=0;V<2;++V){for(var G=0;G<3;++G){var q=this._field[G].get(1+o+H,1+g+V);if(isNaN(q)||!isFinite(q)){continue e}}}}for(G=0;G<6;++G){var Y=o+k[G][0];var W=g+k[G][1];var X=this._field[0].get(Y+1,W+1);var Z=this._field[1].get(Y+1,W+1);q=this._field[2].get(Y+1,W+1);S=_.get(Y+1,W+1,0);C=_.get(Y+1,W+1,1);L=_.get(Y+1,W+1,2);if(e.intensity){K=e.intensity.get(Y,W)}var K=e.intensity?e.intensity.get(Y,W):q+this.objectOffset[2];N[F++]=Y;N[F++]=W;N[F++]=X;N[F++]=Z;N[F++]=q;N[F++]=0;N[F++]=K;N[F++]=S;N[F++]=C;N[F++]=L;O[0]=Math.min(O[0],X+this.objectOffset[0]);O[1]=Math.min(O[1],Z+this.objectOffset[1]);O[2]=Math.min(O[2],q+this.objectOffset[2]);D=Math.min(D,K);P[0]=Math.max(P[0],X+this.objectOffset[0]);P[1]=Math.max(P[1],Z+this.objectOffset[1]);P[2]=Math.max(P[2],q+this.objectOffset[2]);R=Math.max(R,K);j+=1}}}if(e.intensityBounds){D=+e.intensityBounds[0];R=+e.intensityBounds[1]}for(o=6;o<F;o+=10){N[o]=(N[o]-D)/(R-D)}this._vertexCount=j;this._coordinateBuffer.update(N.subarray(0,F));s.freeFloat(N);s.free(_.data);this.bounds=[O,P];this.intensity=e.intensity||this._field[2];if(this.intensityBounds[0]!==D||this.intensityBounds[1]!==R){r=true}this.intensityBounds=[D,R]}if("levels"in e){var J=e.levels;if(!Array.isArray(J[0])){J=[[],[],J]}else{J=J.slice()}for(o=0;o<3;++o){J[o]=J[o].slice();J[o].sort(function(e,t){return e-t})}for(o=0;o<3;++o){for(g=0;g<J[o].length;++g){J[o][g]-=this.objectOffset[o]}}e:for(o=0;o<3;++o){if(J[o].length!==this.contourLevels[o].length){r=true;break}for(g=0;g<J[o].length;++g){if(J[o][g]!==this.contourLevels[o][g]){r=true;break e}}}this.contourLevels=J}if(r){y=this._field;i=this.shape;var Q=[];for(var $=0;$<3;++$){var ee=this.contourLevels[$];var te=[];var re=[];var ne=[0,0,0];for(o=0;o<ee.length;++o){var ae=h(this._field[$],ee[o]);te.push(Q.length/5|0);j=0;e:for(g=0;g<ae.cells.length;++g){var ie=ae.cells[g];for(G=0;G<2;++G){var oe=ae.positions[ie[G]];var se=oe[0];var le=Math.floor(se)|0;var ue=se-le;var ce=oe[1];var fe=Math.floor(ce)|0;var he=ce-fe;var pe=false;t:for(var de=0;de<3;++de){ne[de]=0;var ve=($+de+1)%3;for(H=0;H<2;++H){var me=H?ue:1-ue;Y=Math.min(Math.max(le+H,0),i[0])|0;for(V=0;V<2;++V){var ge=V?he:1-he;W=Math.min(Math.max(fe+V,0),i[1])|0;if(de<2){q=this._field[ve].get(Y,W)}else{q=(this.intensity.get(Y,W)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0])}if(!isFinite(q)||isNaN(q)){pe=true;break t}var ye=me*ge;ne[de]+=ye*q}}}if(!pe){Q.push(ne[0],ne[1],oe[0],oe[1],ne[2]);j+=1}else{if(G>0){for(var xe=0;xe<5;++xe){Q.pop()}j-=1}continue e}}}re.push(j)}this._contourOffsets[$]=te;this._contourCounts[$]=re}var _e=s.mallocFloat(Q.length);for(o=0;o<Q.length;++o){_e[o]=Q[o]}this._contourBuffer.update(_e);s.freeFloat(_e)}};C.dispose=function(){this._shader.dispose();this._vao.dispose();this._coordinateBuffer.dispose();this._colorMap.dispose();this._contourBuffer.dispose();this._contourVAO.dispose();this._contourShader.dispose();this._contourPickShader.dispose();this._dynamicBuffer.dispose();this._dynamicVAO.dispose();for(var e=0;e<3;++e){s.freeFloat(this._field[e].data)}};C.highlight=function(e){var t;if(!e){this._dynamicCounts=[0,0,0];this.dyanamicLevel=[NaN,NaN,NaN];this.highlightLevel=[-1,-1,-1];return}for(t=0;t<3;++t){if(this.enableHighlight[t]){this.highlightLevel[t]=e.level[t]}else{this.highlightLevel[t]=-1}}var r;if(this.snapToData){r=e.dataCoordinate}else{r=e.position}for(t=0;t<3;++t){r[t]-=this.objectOffset[t]}if((!this.enableDynamic[0]||r[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||r[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||r[2]===this.dynamicLevel[2])){return}var n=0;var a=this.shape;var i=s.mallocFloat(12*a[0]*a[1]);for(var o=0;o<3;++o){if(!this.enableDynamic[o]){this.dynamicLevel[o]=NaN;this._dynamicCounts[o]=0;continue}this.dynamicLevel[o]=r[o];var l=(o+1)%3;var u=(o+2)%3;var c=this._field[o];var f=this._field[l];var p=this._field[u];var d=h(c,r[o]);var v=d.cells;var m=d.positions;this._dynamicOffsets[o]=n;for(t=0;t<v.length;++t){var g=v[t];for(var y=0;y<2;++y){var x=m[g[y]];var _=+x[0];var b=_|0;var w=Math.min(b+1,a[0])|0;var T=_-b;var k=1-T;var A=+x[1];var M=A|0;var E=Math.min(M+1,a[1])|0;var S=A-M;var C=1-S;var L=k*C;var I=k*S;var O=T*C;var P=T*S;var D=L*f.get(b,M)+I*f.get(b,E)+O*f.get(w,M)+P*f.get(w,E);var R=L*p.get(b,M)+I*p.get(b,E)+O*p.get(w,M)+P*p.get(w,E);if(isNaN(D)||isNaN(R)){if(y){n-=1}break}i[2*n+0]=D;i[2*n+1]=R;n+=1}}this._dynamicCounts[o]=n-this._dynamicOffsets[o]}this._dynamicBuffer.update(i.subarray(0,2*n));s.freeFloat(i)};function H(e){var t=e.gl;var r=y(t);var n=_(t);var s=x(t);var l=b(t);var u=a(t);var c=i(t,[{buffer:u,size:4,stride:w,offset:0},{buffer:u,size:3,stride:w,offset:16},{buffer:u,size:3,stride:w,offset:28}]);var f=a(t);var h=i(t,[{buffer:f,size:4,stride:20,offset:0},{buffer:f,size:1,stride:20,offset:16}]);var p=a(t);var d=i(t,[{buffer:p,size:2,type:t.FLOAT}]);var v=o(t,1,E,t.RGBA,t.UNSIGNED_BYTE);v.minFilter=t.LINEAR;v.magFilter=t.LINEAR;var m=new S(t,[0,0],[[0,0,0],[0,0,0]],r,n,u,c,v,s,l,f,h,p,d,[0,0,0]);var g={levels:[[],[],[]]};for(var T in e){g[T]=e[T]}g.colormap=g.colormap||"jet";m.update(g);return m}},{"./lib/shaders":349,"binary-search-bounds":96,"bit-twiddle":97,colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":353,"gl-vao":358,ndarray:495,"ndarray-gradient":488,"ndarray-ops":490,"ndarray-pack":491,"surface-nets":570,"typedarray-pool":595}],352:[function(e,t,r){"use strict";var n=e("css-font");var a=e("pick-by-alias");var i=e("regl");var o=e("gl-util/context");var s=e("es6-weak-map");var l=e("color-normalize");var u=e("font-atlas");var c=e("typedarray-pool");var f=e("parse-rect");var h=e("is-plain-obj");var p=e("parse-unit");var d=e("to-px");var v=e("detect-kerning");var m=e("object-assign");var g=e("font-measure");var y=e("flatten-vertex-data");var x=e("bit-twiddle");var _=x.nextPow2;var b=new s;var w=false;if(document.body){var T=document.body.appendChild(document.createElement("div"));T.style.font="italic small-caps bold condensed 16px/2 cursive";if(getComputedStyle(T).fontStretch){w=true}document.body.removeChild(T)}var k=function e(t){if(A(t)){t={regl:t};this.gl=t.regl._gl}else{this.gl=o(t)}this.shader=b.get(this.gl);if(!this.shader){this.regl=t.regl||i({gl:this.gl})}else{this.regl=this.shader.regl}this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"});this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"});if(!this.shader){this.shader=this.createShader();b.set(this.gl,this.shader)}this.batch=[];this.fontSize=[];this.font=[];this.fontAtlas=[];this.draw=this.shader.draw.bind(this);this.render=function(){this.regl._refresh();this.draw(this.batch)};this.canvas=this.gl.canvas;this.update(h(t)?t:{})};k.prototype.createShader=function e(){var t=this.regl;var r=t({blend:{enable:true,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:false},depth:{enable:false},count:t.prop("count"),offset:t.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:t.this("sizeBuffer")},width:{offset:0,stride:8,buffer:t.this("sizeBuffer")},char:t.this("charBuffer"),position:t.this("position")},uniforms:{atlasSize:function(e,t){return[t.atlas.width,t.atlas.height]},atlasDim:function(e,t){return[t.atlas.cols,t.atlas.rows]},atlas:function(e,t){return t.atlas.texture},charStep:function(e,t){return t.atlas.step},em:function(e,t){return t.atlas.em},color:t.prop("color"),opacity:t.prop("opacity"),viewport:t.this("viewportArray"),scale:t.this("scale"),align:t.prop("align"),baseline:t.prop("baseline"),translate:t.this("translate"),positionOffset:t.prop("positionOffset")},primitive:"points",viewport:t.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(!k.normalViewport?"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);":"")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(k.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});var n={};return{regl:t,draw:r,atlas:n}};k.prototype.update=function e(t){var r=this;if(typeof t==="string"){t={text:t}}else if(!t){return}t=a(t,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},true);if(t.opacity!=null){if(Array.isArray(t.opacity)){this.opacity=t.opacity.map(function(e){return parseFloat(e)})}else{this.opacity=parseFloat(t.opacity)}}if(t.viewport!=null){this.viewport=f(t.viewport);if(k.normalViewport){this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height}this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]}if(this.viewport==null){this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight};this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]}if(t.kerning!=null){this.kerning=t.kerning}if(t.offset!=null){if(typeof t.offset==="number"){t.offset=[t.offset,0]}this.positionOffset=y(t.offset)}if(t.direction){this.direction=t.direction}if(t.range){this.range=t.range;this.scale=[1/(t.range[2]-t.range[0]),1/(t.range[3]-t.range[1])];this.translate=[-t.range[0],-t.range[1]]}if(t.scale){this.scale=t.scale}if(t.translate){this.translate=t.translate}if(!this.scale){this.scale=[1/this.viewport.width,1/this.viewport.height]}if(!this.translate){this.translate=[0,0]}if(!this.font.length&&!t.font){t.font=k.baseFontSize+"px sans-serif"}var i=false,o=false;if(t.font){(Array.isArray(t.font)?t.font:[t.font]).forEach(function(e,t){if(typeof e==="string"){try{e=n.parse(e)}catch(t){e=n.parse(k.baseFontSize+"px "+e)}}else{e=n.parse(n.stringify(e))}var a=n.stringify({size:k.baseFontSize,family:e.family,stretch:w?e.stretch:undefined,variant:e.variant,weight:e.weight,style:e.style});var s=p(e.size);var l=Math.round(s[0]*d(s[1]));if(l!==r.fontSize[t]){o=true;r.fontSize[t]=l}if(!r.font[t]||a!=r.font[t].baseString){i=true;r.font[t]=k.fonts[a];if(!r.font[t]){var u=e.family.join(", ");var c=[e.style];if(e.style!=e.variant){c.push(e.variant)}if(e.variant!=e.weight){c.push(e.weight)}if(w&&e.weight!=e.stretch){c.push(e.stretch)}r.font[t]={baseString:a,family:u,weight:e.weight,stretch:e.stretch,style:e.style,variant:e.variant,width:{},kerning:{},metrics:g(u,{origin:"top",fontSize:k.baseFontSize,fontStyle:c.join(" ")})};k.fonts[a]=r.font[t]}}})}if(i||o){this.font.forEach(function(e,a){var i=n.stringify({size:r.fontSize[a],family:e.family,stretch:w?e.stretch:undefined,variant:e.variant,weight:e.weight,style:e.style});r.fontAtlas[a]=r.shader.atlas[i];if(!r.fontAtlas[a]){var o=e.metrics;r.shader.atlas[i]=r.fontAtlas[a]={fontString:i,step:Math.ceil(r.fontSize[a]*o.bottom*.5)*2,em:r.fontSize[a],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:r.regl.texture()}}if(t.text==null){t.text=r.text}})}if(typeof t.text==="string"&&t.position&&t.position.length>2){var s=Array(t.position.length*.5);for(var h=0;h<s.length;h++){s[h]=t.text}t.text=s}var x;if(t.text!=null||i){this.textOffsets=[0];if(Array.isArray(t.text)){this.count=t.text[0].length;this.counts=[this.count];for(var b=1;b<t.text.length;b++){this.textOffsets[b]=this.textOffsets[b-1]+t.text[b-1].length;this.count+=t.text[b].length;this.counts.push(t.text[b].length)}this.text=t.text.join("")}else{this.text=t.text;this.count=this.text.length;this.counts=[this.count]}x=[];this.font.forEach(function(e,t){k.atlasContext.font=e.baseString;var n=r.fontAtlas[t];for(var a=0;a<r.text.length;a++){var i=r.text.charAt(a);if(n.ids[i]==null){n.ids[i]=n.chars.length;n.chars.push(i);x.push(i)}if(e.width[i]==null){e.width[i]=k.atlasContext.measureText(i).width/k.baseFontSize;if(r.kerning){var o=[];for(var s in e.width){o.push(s+i,i+s)}m(e.kerning,v(e.family,{pairs:o}))}}}})}if(t.position){if(t.position.length>2){var T=!t.position[0].length;var A=c.mallocFloat(this.count*2);for(var M=0,E=0;M<this.counts.length;M++){var S=this.counts[M];if(T){for(var C=0;C<S;C++){A[E++]=t.position[M*2];A[E++]=t.position[M*2+1]}}else{for(var L=0;L<S;L++){A[E++]=t.position[M][0];A[E++]=t.position[M][1]}}}if(this.position.call){this.position({type:"float",data:A})}else{this.position=this.regl.buffer({type:"float",data:A})}c.freeFloat(A)}else{if(this.position.destroy){this.position.destroy()}this.position={constant:t.position}}}if(t.text||i){var I=c.mallocUint8(this.count);var O=c.mallocFloat(this.count*2);this.textWidth=[];for(var P=0,D=0;P<this.counts.length;P++){var R=this.counts[P];var z=this.font[P]||this.font[0];var N=this.fontAtlas[P]||this.fontAtlas[0];for(var F=0;F<R;F++){var B=this.text.charAt(D);var j=this.text.charAt(D-1);I[D]=N.ids[B];O[D*2]=z.width[B];if(F){var U=O[D*2-2];var H=O[D*2];var V=O[D*2-1];var G=V+U*.5+H*.5;if(this.kerning){var q=z.kerning[j+B];if(q){G+=q*.001}}O[D*2+1]=G}else{O[D*2+1]=O[D*2]*.5}D++}this.textWidth.push(!O.length?0:O[D*2-2]*.5+O[D*2-1])}if(!t.align){t.align=this.align}this.charBuffer({data:I,type:"uint8",usage:"stream"});this.sizeBuffer({data:O,type:"float",usage:"stream"});c.freeUint8(I);c.freeFloat(O);if(x.length){this.font.forEach(function(e,t){var n=r.fontAtlas[t];var a=n.step;var i=Math.floor(k.maxAtlasSize/a);var o=Math.min(i,n.chars.length);var s=Math.ceil(n.chars.length/o);var l=_(o*a);var c=_(s*a);n.width=l;n.height=c;n.rows=s;n.cols=o;if(!n.em){return}n.texture({data:u({canvas:k.atlasCanvas,font:n.fontString,chars:n.chars,shape:[l,c],step:[a,a]})})})}}if(t.align){this.align=t.align;this.alignOffset=this.textWidth.map(function(e,t){var n=!Array.isArray(r.align)?r.align:r.align.length>1?r.align[t]:r.align[0];if(typeof n==="number"){return n}switch(n){case"right":case"end":return-e;case"center":case"centre":case"middle":return-e*.5}return 0})}if(this.baseline==null&&t.baseline==null){t.baseline=0}if(t.baseline!=null){this.baseline=t.baseline;if(!Array.isArray(this.baseline)){this.baseline=[this.baseline]}this.baselineOffset=this.baseline.map(function(e,t){var n=(r.font[t]||r.font[0]).metrics;var a=0;a+=n.bottom*.5;if(typeof e==="number"){a+=e-n.baseline}else{a+=-n[e]}if(!k.normalViewport){a*=-1}return a})}if(t.color!=null){if(!t.color){t.color="transparent"}if(typeof t.color==="string"||!isNaN(t.color)){this.color=l(t.color,"uint8")}else{var Y;if(typeof t.color[0]==="number"&&t.color.length>this.counts.length){var W=t.color.length;Y=c.mallocUint8(W);var X=(t.color.subarray||t.color.slice).bind(t.color);for(var Z=0;Z<W;Z+=4){Y.set(l(X(Z,Z+4),"uint8"),Z)}}else{var K=t.color.length;Y=c.mallocUint8(K*4);for(var J=0;J<K;J++){Y.set(l(t.color[J]||0,"uint8"),J*4)}}this.color=Y}}if(t.position||t.text||t.color||t.baseline||t.align||t.font||t.offset||t.opacity){var Q=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(Q){var $=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array($);for(var ee=0;ee<this.batch.length;ee++){this.batch[ee]={count:this.counts.length>1?this.counts[ee]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[ee]:this.textOffsets[0],color:!this.color?[0,0,0,255]:this.color.length<=4?this.color:this.color.subarray(ee*4,ee*4+4),opacity:Array.isArray(this.opacity)?this.opacity[ee]:this.opacity,baseline:this.baselineOffset[ee]!=null?this.baselineOffset[ee]:this.baselineOffset[0],align:!this.align?0:this.alignOffset[ee]!=null?this.alignOffset[ee]:this.alignOffset[0],atlas:this.fontAtlas[ee]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(ee*2,ee*2+2):this.positionOffset}}}else{if(this.count){this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]}else{this.batch=[]}}}};k.prototype.destroy=function e(){};k.prototype.kerning=true;k.prototype.position={constant:new Float32Array(2)};k.prototype.translate=null;k.prototype.scale=null;k.prototype.font=null;k.prototype.text="";k.prototype.positionOffset=[0,0];k.prototype.opacity=1;k.prototype.color=new Uint8Array([0,0,0,255]);k.prototype.alignOffset=[0,0];k.normalViewport=false;k.maxAtlasSize=1024;k.atlasCanvas=document.createElement("canvas");k.atlasContext=k.atlasCanvas.getContext("2d",{alpha:false});k.baseFontSize=64;k.fonts={};function A(e){return typeof e==="function"&&e._gl&&e.prop&&e.texture&&e.buffer}t.exports=k},{"bit-twiddle":97,"color-normalize":125,"css-font":144,"detect-kerning":172,"es6-weak-map":233,"flatten-vertex-data":244,"font-atlas":245,"font-measure":246,"gl-util/context":354,"is-plain-obj":469,"object-assign":499,"parse-rect":504,"parse-unit":506,"pick-by-alias":511,regl:540,"to-px":578,"typedarray-pool":595}],353:[function(e,t,r){"use strict";var n=e("ndarray");var a=e("ndarray-ops");var i=e("typedarray-pool");t.exports=b;var o=null;var s=null;var l=null;function u(e){o=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST];s=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR];l=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function c(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}var f=function(e,t){a.muls(e,t,255)};function h(e,t,r){var n=e.gl;var a=n.getParameter(n.MAX_TEXTURE_SIZE);if(t<0||t>a||r<0||r>a){throw new Error("gl-texture2d: Invalid texture size")}e._shape=[t,r];e.bind();n.texImage2D(n.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null);e._mipLevels=[0];return e}function p(e,t,r,n,a,i){this.gl=e;this.handle=t;this.format=a;this.type=i;this._shape=[r,n];this._mipLevels=[0];this._magFilter=e.NEAREST;this._minFilter=e.NEAREST;this._wrapS=e.CLAMP_TO_EDGE;this._wrapT=e.CLAMP_TO_EDGE;this._anisoSamples=1;var o=this;var s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return o._wrapS},set:function(e){return o.wrapS=e}},{get:function(){return o._wrapT},set:function(e){return o.wrapT=e}}]);this._wrapVector=s;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return o._shape[0]},set:function(e){return o.width=e}},{get:function(){return o._shape[1]},set:function(e){return o.height=e}}]);this._shapeVector=l}var d=p.prototype;Object.defineProperties(d,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&o.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e);return this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&o.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);return this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;this._anisoSamples=Math.max(e,1)|0;if(t!==this._anisoSamples){var r=this.gl.getExtension("EXT_texture_filter_anisotropic");if(r){this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e);return this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e);return this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(!Array.isArray(e)){e=[e,e]}if(e.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var t=0;t<2;++t){if(l.indexOf(e[t])<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}}this._wrapS=e[0];this._wrapT=e[1];var r=this.gl;this.bind();r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT);return e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}else{if(e.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}h(this,e[0]|0,e[1]|0);return[e[0]|0,e[1]|0]}},width:{get:function(){return this._shape[0]},set:function(e){e=e|0;h(this,e,this._shape[1]);return e}},height:{get:function(){return this._shape[1]},set:function(e){e=e|0;h(this,this._shape[0],e);return e}}});d.bind=function(e){var t=this.gl;if(e!==undefined){t.activeTexture(t.TEXTURE0+(e|0))}t.bindTexture(t.TEXTURE_2D,this.handle);if(e!==undefined){return e|0}return t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0};d.dispose=function(){this.gl.deleteTexture(this.handle)};d.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var e=Math.min(this._shape[0],this._shape[1]);for(var t=0;e>0;++t,e>>>=1){if(this._mipLevels.indexOf(t)<0){this._mipLevels.push(t)}}};d.setPixels=function(e,t,r,n){var a=this.gl;this.bind();if(Array.isArray(t)){n=r;r=t[1]|0;t=t[0]|0}else{t=t||0;r=r||0}n=n||0;var i=c(e)?e:e.raw;if(i){var o=this._mipLevels.indexOf(n)<0;if(o){a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,this.type,i);this._mipLevels.push(n)}else{a.texSubImage2D(a.TEXTURE_2D,n,t,r,this.format,this.type,i)}}else if(e.shape&&e.stride&&e.data){if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>n||r+e.shape[0]>this._shape[0]>>>n||t<0||r<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}m(a,t,r,n,this.format,this.type,this._mipLevels,e)}else{throw new Error("gl-texture2d: Unsupported data type")}};function v(e,t){if(e.length===3){return t[2]===1&&t[1]===e[0]*e[2]&&t[0]===e[2]}return t[0]===1&&t[1]===e[0]}function m(e,t,r,o,s,l,u,c){var h=c.dtype;var p=c.shape.slice();if(p.length<2||p.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var d=0,m=0;var g=v(p,c.stride.slice());if(h==="float32"){d=e.FLOAT}else if(h==="float64"){d=e.FLOAT;g=false;h="float32"}else if(h==="uint8"){d=e.UNSIGNED_BYTE}else{d=e.UNSIGNED_BYTE;g=false;h="uint8"}var y=1;if(p.length===2){m=e.LUMINANCE;p=[p[0],p[1],1];c=n(c.data,p,[c.stride[0],c.stride[1],1],c.offset)}else if(p.length===3){if(p[2]===1){m=e.ALPHA}else if(p[2]===2){m=e.LUMINANCE_ALPHA}else if(p[2]===3){m=e.RGB}else if(p[2]===4){m=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}y=p[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((m===e.LUMINANCE||m===e.ALPHA)&&(s===e.LUMINANCE||s===e.ALPHA)){m=s}if(m!==s){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var x=c.size;var _=u.indexOf(o)<0;if(_){u.push(o)}if(d===l&&g){if(c.offset===0&&c.data.length===x){if(_){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,c.data)}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,c.data)}}else{if(_){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,c.data.subarray(c.offset,c.offset+x))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,c.data.subarray(c.offset,c.offset+x))}}}else{var b;if(l===e.FLOAT){b=i.mallocFloat32(x)}else{b=i.mallocUint8(x)}var w=n(b,p,[p[2],p[2]*p[0],1]);if(d===e.FLOAT&&l===e.UNSIGNED_BYTE){f(w,c)}else{a.assign(w,c)}if(_){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,b.subarray(0,x))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,b.subarray(0,x))}if(l===e.FLOAT){i.freeFloat32(b)}else{i.freeUint8(b)}}}function g(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);return t}function y(e,t,r,n,a){var i=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>i||r<0||r>i){throw new Error("gl-texture2d: Invalid texture shape")}if(a===e.FLOAT&&!e.getExtension("OES_texture_float")){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var o=g(e);e.texImage2D(e.TEXTURE_2D,0,n,t,r,0,n,a,null);return new p(e,o,t,r,n,a)}function x(e,t,r,n,a,i){var o=g(e);e.texImage2D(e.TEXTURE_2D,0,a,a,i,t);return new p(e,o,r,n,a,i)}function _(e,t){var r=t.dtype;var o=t.shape.slice();var s=e.getParameter(e.MAX_TEXTURE_SIZE);if(o[0]<0||o[0]>s||o[1]<0||o[1]>s){throw new Error("gl-texture2d: Invalid texture size")}var l=v(o,t.stride.slice());var u=0;if(r==="float32"){u=e.FLOAT}else if(r==="float64"){u=e.FLOAT;l=false;r="float32"}else if(r==="uint8"){u=e.UNSIGNED_BYTE}else{u=e.UNSIGNED_BYTE;l=false;r="uint8"}var c=0;if(o.length===2){c=e.LUMINANCE;o=[o[0],o[1],1];t=n(t.data,o,[t.stride[0],t.stride[1],1],t.offset)}else if(o.length===3){if(o[2]===1){c=e.ALPHA}else if(o[2]===2){c=e.LUMINANCE_ALPHA}else if(o[2]===3){c=e.RGB}else if(o[2]===4){c=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(u===e.FLOAT&&!e.getExtension("OES_texture_float")){u=e.UNSIGNED_BYTE;l=false}var h,d;var m=t.size;if(!l){var y=[o[2],o[2]*o[0],1];d=i.malloc(m,r);var x=n(d,o,y,0);if((r==="float32"||r==="float64")&&u===e.UNSIGNED_BYTE){f(x,t)}else{a.assign(x,t)}h=d.subarray(0,m)}else if(t.offset===0&&t.data.length===m){h=t.data}else{h=t.data.subarray(t.offset,t.offset+m)}var _=g(e);e.texImage2D(e.TEXTURE_2D,0,c,o[0],o[1],0,c,u,h);if(!l){i.free(d)}return new p(e,_,o[0],o[1],c,u)}function b(e){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!o){u(e)}if(typeof arguments[1]==="number"){return y(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return y(e,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var t=arguments[1];var r=c(t)?t:t.raw;if(r){return x(e,r,t.width|0,t.height|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}else if(t.shape&&t.data&&t.stride){return _(e,t)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:495,"ndarray-ops":490,"typedarray-pool":595}],354:[function(e,r,n){(function(t){(function(){"use strict";var n=e("pick-by-alias");r.exports=function e(r){if(!r)r={};else if(typeof r==="string")r={container:r};if(i(r)){r={container:r}}else if(o(r)){r={container:r}}else if(s(r)){r={gl:r}}else{r=n(r,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},true)}if(!r.pixelRatio)r.pixelRatio=t.pixelRatio||1;if(r.gl){return r.gl}if(r.canvas){r.container=r.canvas.parentNode}if(r.container){if(typeof r.container==="string"){var u=document.querySelector(r.container);if(!u)throw Error("Element "+r.container+" is not found");r.container=u}if(i(r.container)){r.canvas=r.container;r.container=r.canvas.parentNode}else if(!r.canvas){r.canvas=l();r.container.appendChild(r.canvas);a(r)}}else if(!r.canvas){if(typeof document!=="undefined"){r.container=document.body||document.documentElement;r.canvas=l();r.container.appendChild(r.canvas);a(r)}else{throw Error("Not DOM environment. Use headless-gl.")}}if(!r.gl){try{r.gl=r.canvas.getContext("webgl",r.attrs)}catch(e){try{r.gl=r.canvas.getContext("experimental-webgl",r.attrs)}catch(e){r.gl=r.canvas.getContext("webgl-experimental",r.attrs)}}}return r.gl};function a(e){if(e.container){if(e.container==document.body){if(!document.body.style.width)e.canvas.width=e.width||e.pixelRatio*t.innerWidth;if(!document.body.style.height)e.canvas.height=e.height||e.pixelRatio*t.innerHeight}else{var r=e.container.getBoundingClientRect();e.canvas.width=e.width||r.right-r.left;e.canvas.height=e.height||r.bottom-r.top}}}function i(e){return typeof e.getContext==="function"&&"width"in e&&"height"in e}function o(e){return typeof e.nodeName==="string"&&typeof e.appendChild==="function"&&typeof e.getBoundingClientRect==="function"}function s(e){return typeof e.drawArrays==="function"||typeof e.drawElements==="function"}function l(){var e=document.createElement("canvas");e.style.position="absolute";e.style.top=0;e.style.left=0;return e}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"pick-by-alias":511}],355:[function(e,t,r){"use strict";function n(e,t,r){if(t){t.bind()}else{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}var n=e.getParameter(e.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>n){throw new Error("gl-vao: Too many vertex attributes")}for(var a=0;a<r.length;++a){var i=r[a];if(i.buffer){var o=i.buffer;var s=i.size||4;var l=i.type||e.FLOAT;var u=!!i.normalized;var c=i.stride||0;var f=i.offset||0;o.bind();e.enableVertexAttribArray(a);e.vertexAttribPointer(a,s,l,u,c,f)}else{if(typeof i==="number"){e.vertexAttrib1f(a,i)}else if(i.length===1){e.vertexAttrib1f(a,i[0])}else if(i.length===2){e.vertexAttrib2f(a,i[0],i[1])}else if(i.length===3){e.vertexAttrib3f(a,i[0],i[1],i[2])}else if(i.length===4){e.vertexAttrib4f(a,i[0],i[1],i[2],i[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}e.disableVertexAttribArray(a)}}for(;a<n;++a){e.disableVertexAttribArray(a)}}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var a=0;a<n;++a){e.disableVertexAttribArray(a)}}}t.exports=n},{}],356:[function(e,t,r){"use strict";var n=e("./do-bind.js");function a(e){this.gl=e;this._elements=null;this._attributes=null;this._elementsType=e.UNSIGNED_SHORT}a.prototype.bind=function(){n(this.gl,this._elements,this._attributes)};a.prototype.update=function(e,t,r){this._elements=t;this._attributes=e;this._elementsType=r||this.gl.UNSIGNED_SHORT};a.prototype.dispose=function(){};a.prototype.unbind=function(){};a.prototype.draw=function(e,t,r){r=r||0;var n=this.gl;if(this._elements){n.drawElements(e,t,this._elementsType,r)}else{n.drawArrays(e,r,t)}};function i(e){return new a(e)}t.exports=i},{"./do-bind.js":355}],357:[function(e,t,r){"use strict";var n=e("./do-bind.js");function a(e,t,r,n,a,i){this.location=e;this.dimension=t;this.a=r;this.b=n;this.c=a;this.d=i}a.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function i(e,t,r){this.gl=e;this._ext=t;this.handle=r;this._attribs=[];this._useElements=false;this._elementsType=e.UNSIGNED_SHORT}i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e){this._attribs[e].bind(this.gl)}};i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};i.prototype.update=function(e,t,r){this.bind();n(this.gl,t,e);this.unbind();this._attribs.length=0;if(e)for(var i=0;i<e.length;++i){var o=e[i];if(typeof o==="number"){this._attribs.push(new a(i,1,o))}else if(Array.isArray(o)){this._attribs.push(new a(i,o.length,o[0],o[1],o[2],o[3]))}}this._useElements=!!t;this._elementsType=r||this.gl.UNSIGNED_SHORT};i.prototype.draw=function(e,t,r){r=r||0;var n=this.gl;if(this._useElements){n.drawElements(e,t,this._elementsType,r)}else{n.drawArrays(e,r,t)}};function o(e,t){return new i(e,t,t.createVertexArrayOES())}t.exports=o},{"./do-bind.js":355}],358:[function(e,t,r){"use strict";var n=e("./lib/vao-native.js");var a=e("./lib/vao-emulated.js");function i(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e);this.createVertexArrayOES=e.createVertexArray.bind(e);this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}function o(e,t,r,o){var s=e.createVertexArray?new i(e):e.getExtension("OES_vertex_array_object");var l;if(s){l=n(e,s)}else{l=a(e)}l.update(t,r,o);return l}t.exports=o},{"./lib/vao-emulated.js":356,"./lib/vao-native.js":357}],359:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];return e}},{}],360:[function(e,t,r){t.exports=o;var n=e("./fromValues");var a=e("./normalize");var i=e("./dot");function o(e,t){var r=n(e[0],e[1],e[2]);var o=n(t[0],t[1],t[2]);a(r,r);a(o,o);var s=i(r,o);if(s>1){return 0}else{return Math.acos(s)}}},{"./dot":370,"./fromValues":376,"./normalize":387}],361:[function(e,t,r){t.exports=n;function n(e,t){e[0]=Math.ceil(t[0]);e[1]=Math.ceil(t[1]);e[2]=Math.ceil(t[2]);return e}},{}],362:[function(e,t,r){t.exports=n;function n(e){var t=new Float32Array(3);t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}},{}],363:[function(e,t,r){t.exports=n;function n(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}},{}],364:[function(e,t,r){t.exports=n;function n(){var e=new Float32Array(3);e[0]=0;e[1]=0;e[2]=0;return e}},{}],365:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2];e[0]=a*l-i*s;e[1]=i*o-n*l;e[2]=n*s-a*o;return e}},{}],366:[function(e,t,r){t.exports=e("./distance")},{"./distance":367}],367:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(r*r+n*n+a*a)}},{}],368:[function(e,t,r){t.exports=e("./divide")},{"./divide":369}],369:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];return e}},{}],370:[function(e,t,r){t.exports=n;function n(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],371:[function(e,t,r){t.exports=1e-6},{}],372:[function(e,t,r){t.exports=a;var n=e("./epsilon");function a(e,t){var r=e[0];var a=e[1];var i=e[2];var o=t[0];var s=t[1];var l=t[2];return Math.abs(r-o)<=n*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-s)<=n*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-l)<=n*Math.max(1,Math.abs(i),Math.abs(l))}},{"./epsilon":371}],373:[function(e,t,r){t.exports=n;function n(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],374:[function(e,t,r){t.exports=n;function n(e,t){e[0]=Math.floor(t[0]);e[1]=Math.floor(t[1]);e[2]=Math.floor(t[2]);return e}},{}],375:[function(e,t,r){t.exports=a;var n=e("./create")();function a(e,t,r,a,i,o){var s,l;if(!t){t=3}if(!r){r=0}if(a){l=Math.min(a*t+r,e.length)}else{l=e.length}for(s=r;s<l;s+=t){n[0]=e[s];n[1]=e[s+1];n[2]=e[s+2];i(n,n,o);e[s]=n[0];e[s+1]=n[1];e[s+2]=n[2]}return e}},{"./create":364}],376:[function(e,t,r){t.exports=n;function n(e,t,r){var n=new Float32Array(3);n[0]=e;n[1]=t;n[2]=r;return n}},{}],377:[function(e,t,r){t.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":359,"./angle":360,"./ceil":361,"./clone":362,"./copy":363,"./create":364,"./cross":365,"./dist":366,"./distance":367,"./div":368,"./divide":369,"./dot":370,"./epsilon":371,"./equals":372,"./exactEquals":373,"./floor":374,"./forEach":375,"./fromValues":376,"./inverse":378,"./len":379,"./length":380,"./lerp":381,"./max":382,"./min":383,"./mul":384,"./multiply":385,"./negate":386,"./normalize":387,"./random":388,"./rotateX":389,"./rotateY":390,"./rotateZ":391,"./round":392,"./scale":393,"./scaleAndAdd":394,"./set":395,"./sqrDist":396,"./sqrLen":397,"./squaredDistance":398,"./squaredLength":399,"./sub":400,"./subtract":401,"./transformMat3":402,"./transformMat4":403,"./transformQuat":404}],378:[function(e,t,r){t.exports=n;function n(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];return e}},{}],379:[function(e,t,r){t.exports=e("./length")},{"./length":380}],380:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}},{}],381:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=t[0],i=t[1],o=t[2];e[0]=a+n*(r[0]-a);e[1]=i+n*(r[1]-i);e[2]=o+n*(r[2]-o);return e}},{}],382:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);return e}},{}],383:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);return e}},{}],384:[function(e,t,r){t.exports=e("./multiply")},{"./multiply":385}],385:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];return e}},{}],386:[function(e,t,r){t.exports=n;function n(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];return e}},{}],387:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],a=t[2];var i=r*r+n*n+a*a;if(i>0){i=1/Math.sqrt(i);e[0]=t[0]*i;e[1]=t[1]*i;e[2]=t[2]*i}return e}},{}],388:[function(e,t,r){t.exports=n;function n(e,t){t=t||1;var r=Math.random()*2*Math.PI;var n=Math.random()*2-1;var a=Math.sqrt(1-n*n)*t;e[0]=Math.cos(r)*a;e[1]=Math.sin(r)*a;e[2]=n*t;return e}},{}],389:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=r[1];var i=r[2];var o=t[1]-a;var s=t[2]-i;var l=Math.sin(n);var u=Math.cos(n);e[0]=t[0];e[1]=a+o*u-s*l;e[2]=i+o*l+s*u;return e}},{}],390:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=r[0];var i=r[2];var o=t[0]-a;var s=t[2]-i;var l=Math.sin(n);var u=Math.cos(n);e[0]=a+s*l+o*u;e[1]=t[1];e[2]=i+s*u-o*l;return e}},{}],391:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=r[0];var i=r[1];var o=t[0]-a;var s=t[1]-i;var l=Math.sin(n);var u=Math.cos(n);e[0]=a+o*u-s*l;e[1]=i+o*l+s*u;e[2]=t[2];return e}},{}],392:[function(e,t,r){t.exports=n;function n(e,t){e[0]=Math.round(t[0]);e[1]=Math.round(t[1]);e[2]=Math.round(t[2]);return e}},{}],393:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;return e}},{}],394:[function(e,t,r){t.exports=n;function n(e,t,r,n){e[0]=t[0]+r[0]*n;e[1]=t[1]+r[1]*n;e[2]=t[2]+r[2]*n;return e}},{}],395:[function(e,t,r){t.exports=n;function n(e,t,r,n){e[0]=t;e[1]=r;e[2]=n;return e}},{}],396:[function(e,t,r){t.exports=e("./squaredDistance")},{"./squaredDistance":398}],397:[function(e,t,r){t.exports=e("./squaredLength")},{"./squaredLength":399}],398:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a}},{}],399:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}},{}],400:[function(e,t,r){t.exports=e("./subtract")},{"./subtract":401}],401:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];return e}},{}],402:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2];e[0]=n*r[0]+a*r[3]+i*r[6];e[1]=n*r[1]+a*r[4]+i*r[7];e[2]=n*r[2]+a*r[5]+i*r[8];return e}},{}],403:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];o=o||1;e[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o;e[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o;e[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o;return e}},{}],404:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*i-l*a,f=u*a+l*n-o*i,h=u*i+o*a-s*n,p=-o*n-s*a-l*i;e[0]=c*u+p*-o+f*-l-h*-s;e[1]=f*u+p*-s+h*-o-c*-l;e[2]=h*u+p*-l+c*-s-f*-o;return e}},{}],405:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];return e}},{}],406:[function(e,t,r){t.exports=n;function n(e){var t=new Float32Array(4);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}},{}],407:[function(e,t,r){t.exports=n;function n(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}},{}],408:[function(e,t,r){t.exports=n;function n(){var e=new Float32Array(4);e[0]=0;e[1]=0;e[2]=0;e[3]=0;return e}},{}],409:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(r*r+n*n+a*a+i*i)}},{}],410:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];e[3]=t[3]/r[3];return e}},{}],411:[function(e,t,r){t.exports=n;function n(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],412:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=new Float32Array(4);a[0]=e;a[1]=t;a[2]=r;a[3]=n;return a}},{}],413:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":405,"./clone":406,"./copy":407,"./create":408,"./distance":409,"./divide":410,"./dot":411,"./fromValues":412,"./inverse":414,"./length":415,"./lerp":416,"./max":417,"./min":418,"./multiply":419,"./negate":420,"./normalize":421,"./random":422,"./scale":423,"./scaleAndAdd":424,"./set":425,"./squaredDistance":426,"./squaredLength":427,"./subtract":428,"./transformMat4":429,"./transformQuat":430}],414:[function(e,t,r){t.exports=n;function n(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];e[3]=1/t[3];return e}},{}],415:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2],a=e[3];return Math.sqrt(t*t+r*r+n*n+a*a)}},{}],416:[function(e,t,r){t.exports=n;function n(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3];e[0]=a+n*(r[0]-a);e[1]=i+n*(r[1]-i);e[2]=o+n*(r[2]-o);e[3]=s+n*(r[3]-s);return e}},{}],417:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);e[3]=Math.max(t[3],r[3]);return e}},{}],418:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);e[3]=Math.min(t[3],r[3]);return e}},{}],419:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];e[3]=t[3]*r[3];return e}},{}],420:[function(e,t,r){t.exports=n;function n(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];e[3]=-t[3];return e}},{}],421:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];var o=r*r+n*n+a*a+i*i;if(o>0){o=1/Math.sqrt(o);e[0]=r*o;e[1]=n*o;e[2]=a*o;e[3]=i*o}return e}},{}],422:[function(e,t,r){var n=e("./normalize");var a=e("./scale");t.exports=i;function i(e,t){t=t||1;e[0]=Math.random();e[1]=Math.random();e[2]=Math.random();e[3]=Math.random();n(e,e);a(e,e,t);return e}},{"./normalize":421,"./scale":423}],423:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;return e}},{}],424:[function(e,t,r){t.exports=n;function n(e,t,r,n){e[0]=t[0]+r[0]*n;e[1]=t[1]+r[1]*n;e[2]=t[2]+r[2]*n;e[3]=t[3]+r[3]*n;return e}},{}],425:[function(e,t,r){t.exports=n;function n(e,t,r,n,a){e[0]=t;e[1]=r;e[2]=n;e[3]=a;return e}},{}],426:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return r*r+n*n+a*a+i*i}},{}],427:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a}},{}],428:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];return e}},{}],429:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o;e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o;e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o;e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o;return e}},{}],430:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*i-l*a,f=u*a+l*n-o*i,h=u*i+o*a-s*n,p=-o*n-s*a-l*i;e[0]=c*u+p*-o+f*-l-h*-s;e[1]=f*u+p*-s+h*-o-c*-l;e[2]=h*u+p*-l+c*-s-f*-o;e[3]=t[3];return e}},{}],431:[function(e,t,r){var n=e("glsl-tokenizer");var a=e("atob-lite");t.exports=i;function i(e){var t=Array.isArray(e)?e:n(e);for(var r=0;r<t.length;r++){var i=t[r];if(i.type!=="preprocessor")continue;var o=i.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!o)continue;if(!o[2])continue;var s=o[1];var l=o[2];return(s?a(l):l).trim()}}},{"atob-lite":77,"glsl-tokenizer":438}],432:[function(e,t,r){t.exports=T;var n=e("./lib/literals"),a=e("./lib/operators"),i=e("./lib/builtins"),o=e("./lib/literals-300es"),s=e("./lib/builtins-300es");var l=999,u=9999,c=0,f=1,h=2,p=3,d=4,v=5,m=6,g=7,y=8,x=9,_=10,b=11;var w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function T(e){var t=0,r=0,T=l,k,A,M=[],E=[],S=0,C=0,L=1,I=0,O=0,P=false,D=false,R="",z;e=e||{};var N=i;var F=n;if(e.version==="300 es"){N=s;F=o}var B={},j={};for(var t=0;t<N.length;t++){B[N[t]]=true}for(var t=0;t<F.length;t++){j[F[t]]=true}return function(e){E=[];if(e!==null)return H(e);return V()};function U(e){if(e.length){E.push({type:w[T],data:e,position:O,line:L,column:I})}}function H(e){t=0;if(e.toString)e=e.toString();R+=e.replace(/\r\n/g,"\n");z=R.length;var n;while(k=R[t],t<z){n=t;switch(T){case c:t=X();break;case f:t=W();break;case h:t=Y();break;case p:t=Z();break;case d:t=Q();break;case b:t=J();break;case v:t=$();break;case u:t=ee();break;case x:t=q();break;case l:t=G();break}if(n!==t){switch(R[n]){case"\n":I=0;++L;break;default:++I;break}}}r+=t;R=R.slice(t);return E}function V(e){if(M.length){U(M.join(""))}T=_;U("(eof)");return E}function G(){M=M.length?[]:M;if(A==="/"&&k==="*"){O=r+t-1;T=c;A=k;return t+1}if(A==="/"&&k==="/"){O=r+t-1;T=f;A=k;return t+1}if(k==="#"){T=h;O=r+t;return t}if(/\s/.test(k)){T=x;O=r+t;return t}P=/\d/.test(k);D=/[^\w_]/.test(k);O=r+t;T=P?d:D?p:u;return t}function q(){if(/[^\s]/g.test(k)){U(M.join(""));T=l;return t}M.push(k);A=k;return t+1}function Y(){if((k==="\r"||k==="\n")&&A!=="\\"){U(M.join(""));T=l;return t}M.push(k);A=k;return t+1}function W(){return Y()}function X(){if(k==="/"&&A==="*"){M.push(k);U(M.join(""));T=l;return t+1}M.push(k);A=k;return t+1}function Z(){if(A==="."&&/\d/.test(k)){T=v;return t}if(A==="/"&&k==="*"){T=c;return t}if(A==="/"&&k==="/"){T=f;return t}if(k==="."&&M.length){while(K(M));T=v;return t}if(k===";"||k===")"||k==="("){if(M.length)while(K(M));U(k);T=l;return t+1}var e=M.length===2&&k!=="=";if(/[\w_\d\s]/.test(k)||e){while(K(M));T=l;return t}M.push(k);A=k;return t+1}function K(e){var t=0,r,n;do{r=a.indexOf(e.slice(0,e.length+t).join(""));n=a[r];if(r===-1){if(t--+e.length>0)continue;n=e.slice(0,1).join("")}U(n);O+=n.length;M=M.slice(n.length);return M.length}while(1)}function J(){if(/[^a-fA-F0-9]/.test(k)){U(M.join(""));T=l;return t}M.push(k);A=k;return t+1}function Q(){if(k==="."){M.push(k);T=v;A=k;return t+1}if(/[eE]/.test(k)){M.push(k);T=v;A=k;return t+1}if(k==="x"&&M.length===1&&M[0]==="0"){T=b;M.push(k);A=k;return t+1}if(/[^\d]/.test(k)){U(M.join(""));T=l;return t}M.push(k);A=k;return t+1}function $(){if(k==="f"){M.push(k);A=k;t+=1}if(/[eE]/.test(k)){M.push(k);A=k;return t+1}if((k==="-"||k==="+")&&/[eE]/.test(A)){M.push(k);A=k;return t+1}if(/[^\d]/.test(k)){U(M.join(""));T=l;return t}M.push(k);A=k;return t+1}function ee(){if(/[^\d\w_]/.test(k)){var e=M.join("");if(j[e]){T=y}else if(B[e]){T=g}else{T=m}U(M.join(""));T=l;return t}M.push(k);A=k;return t+1}}},{"./lib/builtins":434,"./lib/builtins-300es":433,"./lib/literals":436,"./lib/literals-300es":435,"./lib/operators":437}],433:[function(e,t,r){var n=e("./builtins");n=n.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)});t.exports=n.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":434}],434:[function(e,t,r){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],435:[function(e,t,r){var n=e("./literals");t.exports=n.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":436}],436:[function(e,t,r){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],437:[function(e,t,r){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],438:[function(e,t,r){var n=e("./index");t.exports=a;function a(e,t){var r=n(t);var a=[];a=a.concat(r(e));a=a.concat(r(null));return a}},{"./index":432}],439:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],440:[function(e,r,n){(function(t){(function(){"use strict";var n=e("is-browser");var a;if(typeof t.matchMedia==="function"){a=!t.matchMedia("(hover: none)").matches}else{a=n}r.exports=a}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"is-browser":464}],441:[function(e,t,r){"use strict";var n=e("is-browser");function a(){var e=false;try{var t=Object.defineProperty({},"passive",{get:function(){e=true}});window.addEventListener("test",null,t);window.removeEventListener("test",null,t)}catch(t){e=false}return e}t.exports=n&&a()},{"is-browser":464}],442:[function(e,t,r){r.read=function(e,t,r,n,a){var i,o;var s=a*8-n-1;var l=(1<<s)-1;var u=l>>1;var c=-7;var f=r?a-1:0;var h=r?-1:1;var p=e[t+f];f+=h;i=p&(1<<-c)-1;p>>=-c;c+=s;for(;c>0;i=i*256+e[t+f],f+=h,c-=8){}o=i&(1<<-c)-1;i>>=-c;c+=n;for(;c>0;o=o*256+e[t+f],f+=h,c-=8){}if(i===0){i=1-u}else if(i===l){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,n);i=i-u}return(p?-1:1)*o*Math.pow(2,i-n)};r.write=function(e,t,r,n,a,i){var o,s,l;var u=i*8-a-1;var c=(1<<u)-1;var f=c>>1;var h=a===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=n?0:i-1;var d=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;o=c}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+f>=1){t+=h/l}else{t+=h*Math.pow(2,1-f)}if(t*l>=2){o++;l/=2}if(o+f>=c){s=0;o=c}else if(o+f>=1){s=(t*l-1)*Math.pow(2,a);o=o+f}else{s=t*Math.pow(2,f-1)*Math.pow(2,a);o=0}}for(;a>=8;e[r+p]=s&255,p+=d,s/=256,a-=8){}o=o<<a|s;u+=a;for(;u>0;e[r+p]=o&255,p+=d,o/=256,u-=8){}e[r+p-d]|=v*128}},{}],443:[function(e,t,r){"use strict";var n=e("./types");t.exports=function(e,t){var r,a;for(r in n){a=n[r].detect(e,t);if(a){return r}}}},{"./types":446}],444:[function(e,t,r){(function(r){(function(){"use strict";var n=e("fs");var a=e("path");var i=e("./types");var o=e("./detector");var s=512*1024;function l(e,t){var r=o(e,t);if(r in i){var n=i[r].calculate(e,t);if(n!==false){n.type=r;return n}}throw new TypeError("unsupported file type: "+r+" (file: "+t+")")}function u(e,t){n.open(e,"r",function(a,i){if(a){return t(a)}n.fstat(i,function(a,o){if(a){return t(a)}var l=o.size;if(l<=0){return t(new Error("File size is not greater than 0 —— "+e))}var u=Math.min(l,s);var c=r.alloc(u);n.read(i,c,0,u,0,function(e){if(e){return t(e)}n.close(i,function(e){t(e,c)})})})})}function c(e){var t=n.openSync(e,"r");var a=n.fstatSync(t).size;var i=Math.min(a,s);var o=r.alloc(i);n.readSync(t,o,0,i,0);n.closeSync(t);return o}t.exports=function(e,t){if(r.isBuffer(e)){return l(e)}if(typeof e!=="string"){throw new TypeError("invalid invocation")}var n=a.resolve(e);if(typeof t==="function"){u(n,function(e,r){if(e){return t(e)}var a;try{a=l(r,n)}catch(t){e=t}t(e,a)})}else{var i=c(n);return l(i,n)}};t.exports.types=Object.keys(i)}).call(this)}).call(this,e("buffer").Buffer)},{"./detector":443,"./types":446,buffer:111,fs:109,path:507}],445:[function(e,t,r){"use strict";function n(e,t,r,n){r=r||0;var a=n?"BE":"LE";var i=e["readUInt"+t+a];return i.call(e,r)}t.exports=n},{}],446:[function(e,t,r){"use strict";var n={bmp:e("./types/bmp"),cur:e("./types/cur"),dds:e("./types/dds"),gif:e("./types/gif"),icns:e("./types/icns"),ico:e("./types/ico"),jpg:e("./types/jpg"),png:e("./types/png"),psd:e("./types/psd"),svg:e("./types/svg"),tiff:e("./types/tiff"),webp:e("./types/webp")};t.exports=n},{"./types/bmp":447,"./types/cur":448,"./types/dds":449,"./types/gif":450,"./types/icns":451,"./types/ico":452,"./types/jpg":453,"./types/png":454,"./types/psd":455,"./types/svg":456,"./types/tiff":457,"./types/webp":458}],447:[function(e,t,r){"use strict";function n(e){return"BM"===e.toString("ascii",0,2)}function a(e){return{width:e.readUInt32LE(18),height:Math.abs(e.readInt32LE(22))}}t.exports={detect:n,calculate:a}},{}],448:[function(e,t,r){"use strict";var n=2;function a(e){var t;if(e.readUInt16LE(0)!==0){return false}t=e.readUInt16LE(2);return t===n}t.exports={detect:a,calculate:e("./ico").calculate}},{"./ico":452}],449:[function(e,t,r){"use strict";function n(e){return e.readUInt32LE(0)===542327876}function a(e){return{height:e.readUInt32LE(12),width:e.readUInt32LE(16)}}t.exports={detect:n,calculate:a}},{}],450:[function(e,t,r){"use strict";var n=/^GIF8[79]a/;function a(e){var t=e.toString("ascii",0,6);return n.test(t)}function i(e){return{width:e.readUInt16LE(6),height:e.readUInt16LE(8)}}t.exports={detect:a,calculate:i}},{}],451:[function(e,t,r){"use strict";var n=4+4;var a=4;var i=4;function o(e){return"icns"===e.toString("ascii",0,4)}var s={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function l(e,t){var r=t+i;return[e.toString("ascii",t,r),e.readUInt32BE(r)]}function u(e){var t=s[e];return{width:t,height:t,type:e}}function c(e){var t=e.length,r=n,i=e.readUInt32BE(a),o,s,c;o=l(e,r);s=u(o[0]);r+=o[1];if(r===i){return s}c={width:s.width,height:s.height,images:[s]};while(r<i&&r<t){o=l(e,r);s=u(o[0]);r+=o[1];c.images.push(s)}return c}t.exports={detect:o,calculate:c}},{}],452:[function(e,t,r){"use strict";var n=1;var a=2+2+2;var i=1+1+1+1+2+2+4+4;function o(e){var t;if(e.readUInt16LE(0)!==0){return false}t=e.readUInt16LE(2);return t===n}function s(e,t){var r=e.readUInt8(t);return r===0?256:r}function l(e,t){var r=a+t*i;return{width:s(e,r),height:s(e,r+1)}}function u(e){var t=e.readUInt16LE(4),r=l(e,0),n;if(t===1){return r}r.images=[{width:r.width,height:r.height}];for(n=1;n<t;n+=1){r.images.push(l(e,n))}return r}t.exports={detect:o,calculate:u}},{}],453:[function(e,t,r){"use strict";var n=e("../readUInt");function a(e){var t=e.toString("hex",0,2);return"ffd8"===t}function i(e){var t=e.toString("hex",2,6);return t==="45786966"}function o(e,t){return{height:e.readUInt16BE(t),width:e.readUInt16BE(t+2)}}var s=2;var l=6;var u=2;var c="4d4d";var f="4949";var h=12;var p=2;function d(e,t){var r=e.slice(s,t);var n=r.toString("hex",l,l+u);var a=n===c;var i=n===f;if(a||i){return v(r,a)}}function v(e,t){var r=8;var a=l+r;var i=n(e,16,a,t);var o;var s;for(var u=0;u<i;u++){o=a+p+u*h;s=o+h;if(o>e.length){return}var c=e.slice(o,s);var f=n(c,16,0,t);if(f===274){var d=n(c,16,2,t);if(d!==3){return}var v=n(c,32,4,t);if(v!==1){return}return n(c,16,8,t)}}}function m(e,t){if(t>e.length){throw new TypeError("Corrupt JPG, exceeded buffer limits")}if(e[t]!==255){throw new TypeError("Invalid JPG, marker table corrupted")}}function g(e){e=e.slice(4);var t;var r,n;while(e.length){r=e.readUInt16BE(0);if(i(e)){t=d(e,r)}m(e,r);n=e[r+1];if(n===192||n===193||n===194){var a=o(e,r+5);if(!t){return a}return{width:a.width,height:a.height,orientation:t}}e=e.slice(r+2)}throw new TypeError("Invalid JPG, no size found")}t.exports={detect:a,calculate:g}},{"../readUInt":445}],454:[function(e,t,r){"use strict";var n="PNG\r\n\n";var a="IHDR";var i="CgBI";function o(e){if(n===e.toString("ascii",1,8)){var t=e.toString("ascii",12,16);if(t===i){t=e.toString("ascii",28,32)}if(t!==a){throw new TypeError("invalid png")}return true}}function s(e){if(e.toString("ascii",12,16)===i){return{width:e.readUInt32BE(32),height:e.readUInt32BE(36)}}return{width:e.readUInt32BE(16),height:e.readUInt32BE(20)}}t.exports={detect:o,calculate:s}},{}],455:[function(e,t,r){"use strict";function n(e){return"8BPS"===e.toString("ascii",0,4)}function a(e){return{width:e.readUInt32BE(18),height:e.readUInt32BE(14)}}t.exports={detect:n,calculate:a}},{}],456:[function(e,t,r){"use strict";var n=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/;function a(e){return n.test(e)}var i={root:n,width:/\swidth=(['"])([^%]+?)\1/,height:/\sheight=(['"])([^%]+?)\1/,viewbox:/\sviewBox=(['"])(.+?)\1/};var o={cm:96/2.54,mm:96/2.54/10,m:96/2.54*100,pt:96/72,pc:96/72/12,em:16,ex:8};function s(e){var t=/([0-9.]+)([a-z]*)/.exec(e);if(!t){return undefined}return Math.round(parseFloat(t[1])*(o[t[2]]||1))}function l(e){var t=e.split(" ");return{width:s(t[2]),height:s(t[3])}}function u(e){var t=e.match(i.width);var r=e.match(i.height);var n=e.match(i.viewbox);return{width:t&&s(t[2]),height:r&&s(r[2]),viewbox:n&&l(n[2])}}function c(e){return{width:e.width,height:e.height}}function f(e){var t=e.viewbox.width/e.viewbox.height;if(e.width){return{width:e.width,height:Math.floor(e.width/t)}}if(e.height){return{width:Math.floor(e.height*t),height:e.height}}return{width:e.viewbox.width,height:e.viewbox.height}}function h(e){var t=e.toString("utf8").match(i.root);if(t){var r=u(t[0]);if(r.width&&r.height){return c(r)}if(r.viewbox){return f(r)}}throw new TypeError("invalid svg")}t.exports={detect:a,calculate:h}},{}],457:[function(e,t,r){(function(r){(function(){"use strict";var n=e("fs");var a=e("../readUInt");function i(e){var t=e.toString("hex",0,4);return"49492a00"===t||"4d4d002a"===t}function o(e,t,i){var o=a(e,32,4,i);var s=1024;var l=n.statSync(t).size;if(o+s>l){s=l-o-10}var u=r.alloc(s);var c=n.openSync(t,"r");n.readSync(c,u,0,s,o);var f=u.slice(2);return f}function s(e,t){var r=a(e,16,8,t);var n=a(e,16,10,t);return(n<<16)+r}function l(e){if(e.length>24){return e.slice(12)}}function u(e,t){var r={};var n,i,o;while(e&&e.length){n=a(e,16,0,t);i=a(e,16,2,t);o=a(e,32,4,t);if(n===0){break}else{if(o===1&&(i===3||i===4)){r[n]=s(e,t)}e=l(e)}}return r}function c(e){var t=e.toString("ascii",0,2);if("II"===t){return"LE"}else if("MM"===t){return"BE"}}function f(e,t){if(!t){throw new TypeError("Tiff doesn't support buffer")}var r=c(e)==="BE";var n=o(e,t,r);var a=u(n,r);var i=a[256];var s=a[257];if(!i||!s){throw new TypeError("Invalid Tiff, missing tags")}return{width:i,height:s}}t.exports={detect:i,calculate:f}}).call(this)}).call(this,e("buffer").Buffer)},{"../readUInt":445,buffer:111,fs:109}],458:[function(e,t,r){"use strict";function n(e){var t="RIFF"===e.toString("ascii",0,4);var r="WEBP"===e.toString("ascii",8,12);var n="VP8"===e.toString("ascii",12,15);return t&&r&&n}function a(e){var t=e.toString("ascii",12,16);e=e.slice(20,30);if(t==="VP8X"){var r=e[0];var n=(r&192)===0;var a=(r&1)===0;if(n&&a){return i(e)}else{return false}}if(t==="VP8 "&&e[0]!==47){return s(e)}var l=e.toString("hex",3,6);if(t==="VP8L"&&l!=="9d012a"){return o(e)}return false}function i(e){return{width:1+e.readUIntLE(4,3),height:1+e.readUIntLE(7,3)}}function o(e){return{width:1+((e[2]&63)<<8|e[1]),height:1+((e[4]&15)<<10|e[3]<<2|(e[2]&192)>>6)}}function s(e){return{width:e.readInt16LE(6)&16383,height:e.readInt16LE(8)&16383}}t.exports={detect:n,calculate:a}},{}],459:[function(e,t,r){"use strict";t.exports=p;var n=e("robust-orientation");var a=e("simplicial-complex").compareCells;function i(e,t){return e-t}function o(e,t,r){this.vertices=e;this.adjacent=t;this.boundary=r;this.lastVisited=-1}o.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1];this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=t};function s(e,t,r){this.vertices=e;this.cell=t;this.index=r}function l(e,t){return a(e.vertices,t.vertices)}function u(e){var t=["function orient(){var tuple=this.tuple;return test("];for(var r=0;r<=e;++r){if(r>0){t.push(",")}t.push("tuple[",r,"]")}t.push(")}return orient");var a=new Function("test",t.join(""));var i=n[e+1];if(!i){i=n}return a(i)}var c=[];function f(e,t,r){this.dimension=e;this.vertices=t;this.simplices=r;this.interior=r.filter(function(e){return!e.boundary});this.tuple=new Array(e+1);for(var n=0;n<=e;++n){this.tuple[n]=this.vertices[n]}var a=c[e];if(!a){a=c[e]=u(e)}this.orient=a}var h=f.prototype;h.handleBoundaryDegeneracy=function(e,t){var r=this.dimension;var n=this.vertices.length-1;var a=this.tuple;var i=this.vertices;var o=[e];e.lastVisited=-n;while(o.length>0){e=o.pop();var s=e.vertices;var l=e.adjacent;for(var u=0;u<=r;++u){var c=l[u];if(!c.boundary||c.lastVisited<=-n){continue}var f=c.vertices;for(var h=0;h<=r;++h){var p=f[h];if(p<0){a[h]=t}else{a[h]=i[p]}}var d=this.orient();if(d>0){return c}c.lastVisited=-n;if(d===0){o.push(c)}}}return null};h.walk=function(e,t){var r=this.vertices.length-1;var n=this.dimension;var a=this.vertices;var i=this.tuple;var o=t?this.interior.length*Math.random()|0:this.interior.length-1;var s=this.interior[o];e:while(!s.boundary){var l=s.vertices;var u=s.adjacent;for(var c=0;c<=n;++c){i[c]=a[l[c]]}s.lastVisited=r;for(var c=0;c<=n;++c){var f=u[c];if(f.lastVisited>=r){continue}var h=i[c];i[c]=e;var p=this.orient();i[c]=h;if(p<0){s=f;continue e}else{if(!f.boundary){f.lastVisited=r}else{f.lastVisited=-r}}}return}return s};h.addPeaks=function(e,t){var r=this.vertices.length-1;var n=this.dimension;var a=this.vertices;var i=this.tuple;var u=this.interior;var c=this.simplices;var f=[t];t.lastVisited=r;t.vertices[t.vertices.indexOf(-1)]=r;t.boundary=false;u.push(t);var h=[];while(f.length>0){var t=f.pop();var p=t.vertices;var d=t.adjacent;var v=p.indexOf(r);if(v<0){continue}for(var m=0;m<=n;++m){if(m===v){continue}var g=d[m];if(!g.boundary||g.lastVisited>=r){continue}var y=g.vertices;if(g.lastVisited!==-r){var x=0;for(var _=0;_<=n;++_){if(y[_]<0){x=_;i[_]=e}else{i[_]=a[y[_]]}}var b=this.orient();if(b>0){y[x]=r;g.boundary=false;u.push(g);f.push(g);g.lastVisited=r;continue}else{g.lastVisited=-r}}var w=g.adjacent;var T=p.slice();var k=d.slice();var A=new o(T,k,true);c.push(A);var M=w.indexOf(t);if(M<0){continue}w[M]=A;k[v]=g;T[m]=-1;k[m]=t;d[m]=A;A.flip();for(var _=0;_<=n;++_){var E=T[_];if(E<0||E===r){continue}var S=new Array(n-1);var C=0;for(var L=0;L<=n;++L){var I=T[L];if(I<0||L===_){continue}S[C++]=I}h.push(new s(S,A,_))}}}h.sort(l);for(var m=0;m+1<h.length;m+=2){var O=h[m];var P=h[m+1];var D=O.index;var R=P.index;if(D<0||R<0){continue}O.cell.adjacent[O.index]=P.cell;P.cell.adjacent[P.index]=O.cell}};h.insert=function(e,t){var r=this.vertices;r.push(e);var n=this.walk(e,t);if(!n){return}var a=this.dimension;var i=this.tuple;for(var o=0;o<=a;++o){var s=n.vertices[o];if(s<0){i[o]=e}else{i[o]=r[s]}}var l=this.orient(i);if(l<0){return}else if(l===0){n=this.handleBoundaryDegeneracy(n,e);if(!n){return}}this.addPeaks(e,n)};h.boundary=function(){var e=this.dimension;var t=[];var r=this.simplices;var n=r.length;for(var a=0;a<n;++a){var i=r[a];if(i.boundary){var o=new Array(e);var s=i.vertices;var l=0;var u=0;for(var c=0;c<=e;++c){if(s[c]>=0){o[l++]=s[c]}else{u=c&1}}if(u===(e&1)){var f=o[0];o[0]=o[1];o[1]=f}t.push(o)}}return t};function p(e,t){var r=e.length;if(r===0){throw new Error("Must have at least d+1 points")}var a=e[0].length;if(r<=a){throw new Error("Must input at least d+1 points")}var i=e.slice(0,a+1);var s=n.apply(void 0,i);if(s===0){throw new Error("Input not in general position")}var l=new Array(a+1);for(var u=0;u<=a;++u){l[u]=u}if(s<0){l[0]=1;l[1]=0}var c=new o(l,new Array(a+1),false);var h=c.adjacent;var p=new Array(a+2);for(var u=0;u<=a;++u){var d=l.slice();for(var v=0;v<=a;++v){if(v===u){d[v]=-1}}var m=d[0];d[0]=d[1];d[1]=m;var g=new o(d,new Array(a+1),true);h[u]=g;p[u]=g}p[a+1]=c;for(var u=0;u<=a;++u){var d=h[u].vertices;var y=h[u].adjacent;for(var v=0;v<=a;++v){var x=d[v];if(x<0){y[v]=c;continue}for(var _=0;_<=a;++_){if(h[_].vertices.indexOf(x)<0){y[v]=h[_]}}}}var b=new f(a,i,p);var w=!!t;for(var u=a+1;u<r;++u){b.insert(e[u],w)}return b.boundary()}},{"robust-orientation":548,"simplicial-complex":558}],460:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var a=0;var i=1;var o=2;t.exports=w;function s(e,t,r,n,a){this.mid=e;this.left=t;this.right=r;this.leftPoints=n;this.rightPoints=a;this.count=(t?t.count:0)+(r?r.count:0)+n.length}var l=s.prototype;function u(e,t){e.mid=t.mid;e.left=t.left;e.right=t.right;e.leftPoints=t.leftPoints;e.rightPoints=t.rightPoints;e.count=t.count}function c(e,t){var r=x(t);e.mid=r.mid;e.left=r.left;e.right=r.right;e.leftPoints=r.leftPoints;e.rightPoints=r.rightPoints;e.count=r.count}function f(e,t){var r=e.intervals([]);r.push(t);c(e,r)}function h(e,t){var r=e.intervals([]);var n=r.indexOf(t);if(n<0){return a}r.splice(n,1);c(e,r);return i}l.intervals=function(e){e.push.apply(e,this.leftPoints);if(this.left){this.left.intervals(e)}if(this.right){this.right.intervals(e)}return e};l.insert=function(e){var t=this.count-this.leftPoints.length;this.count+=1;if(e[1]<this.mid){if(this.left){if(4*(this.left.count+1)>3*(t+1)){f(this,e)}else{this.left.insert(e)}}else{this.left=x([e])}}else if(e[0]>this.mid){if(this.right){if(4*(this.right.count+1)>3*(t+1)){f(this,e)}else{this.right.insert(e)}}else{this.right=x([e])}}else{var r=n.ge(this.leftPoints,e,g);var a=n.ge(this.rightPoints,e,y);this.leftPoints.splice(r,0,e);this.rightPoints.splice(a,0,e)}};l.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left){return a}var r=this.right?this.right.count:0;if(4*r>3*(t-1)){return h(this,e)}var s=this.left.remove(e);if(s===o){this.left=null;this.count-=1;return i}else if(s===i){this.count-=1}return s}else if(e[0]>this.mid){if(!this.right){return a}var l=this.left?this.left.count:0;if(4*l>3*(t-1)){return h(this,e)}var s=this.right.remove(e);if(s===o){this.right=null;this.count-=1;return i}else if(s===i){this.count-=1}return s}else{if(this.count===1){if(this.leftPoints[0]===e){return o}else{return a}}if(this.leftPoints.length===1&&this.leftPoints[0]===e){if(this.left&&this.right){var c=this;var f=this.left;while(f.right){c=f;f=f.right}if(c===this){f.right=this.right}else{var p=this.left;var s=this.right;c.count-=f.count;c.right=f.left;f.left=p;f.right=s}u(this,f);this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else if(this.left){u(this,this.left)}else{u(this,this.right)}return i}for(var p=n.ge(this.leftPoints,e,g);p<this.leftPoints.length;++p){if(this.leftPoints[p][0]!==e[0]){break}if(this.leftPoints[p]===e){this.count-=1;this.leftPoints.splice(p,1);for(var s=n.ge(this.rightPoints,e,y);s<this.rightPoints.length;++s){if(this.rightPoints[s][1]!==e[1]){break}else if(this.rightPoints[s]===e){this.rightPoints.splice(s,1);return i}}}}return a}};function p(e,t,r){for(var n=0;n<e.length&&e[n][0]<=t;++n){var a=r(e[n]);if(a){return a}}}function d(e,t,r){for(var n=e.length-1;n>=0&&e[n][1]>=t;--n){var a=r(e[n]);if(a){return a}}}function v(e,t){for(var r=0;r<e.length;++r){var n=t(e[r]);if(n){return n}}}l.queryPoint=function(e,t){if(e<this.mid){if(this.left){var r=this.left.queryPoint(e,t);if(r){return r}}return p(this.leftPoints,e,t)}else if(e>this.mid){if(this.right){var r=this.right.queryPoint(e,t);if(r){return r}}return d(this.rightPoints,e,t)}else{return v(this.leftPoints,t)}};l.queryInterval=function(e,t,r){if(e<this.mid&&this.left){var n=this.left.queryInterval(e,t,r);if(n){return n}}if(t>this.mid&&this.right){var n=this.right.queryInterval(e,t,r);if(n){return n}}if(t<this.mid){return p(this.leftPoints,t,r)}else if(e>this.mid){return d(this.rightPoints,e,r)}else{return v(this.leftPoints,r)}};function m(e,t){return e-t}function g(e,t){var r=e[0]-t[0];if(r){return r}return e[1]-t[1]}function y(e,t){var r=e[1]-t[1];if(r){return r}return e[0]-t[0]}function x(e){if(e.length===0){return null}var t=[];for(var r=0;r<e.length;++r){t.push(e[r][0],e[r][1])}t.sort(m);var n=t[t.length>>1];var a=[];var i=[];var o=[];for(var r=0;r<e.length;++r){var l=e[r];if(l[1]<n){a.push(l)}else if(n<l[0]){i.push(l)}else{o.push(l)}}var u=o;var c=o.slice();u.sort(g);c.sort(y);return new s(n,x(a),x(i),u,c)}function _(e){this.root=e}var b=_.prototype;b.insert=function(e){if(this.root){this.root.insert(e)}else{this.root=new s(e[0],null,null,[e],[e])}};b.remove=function(e){if(this.root){var t=this.root.remove(e);if(t===o){this.root=null}return t!==a}return false};b.queryPoint=function(e,t){if(this.root){return this.root.queryPoint(e,t)}};b.queryInterval=function(e,t,r){if(e<=t&&this.root){return this.root.queryInterval(e,t,r)}};Object.defineProperty(b,"count",{get:function(){if(this.root){return this.root.count}return 0}});Object.defineProperty(b,"intervals",{get:function(){if(this.root){return this.root.intervals([])}return[]}});function w(e){if(!e||e.length===0){return new _(null)}return new _(x(e))}},{"binary-search-bounds":461}],461:[function(e,t,r){arguments[4][243][0].apply(r,arguments)},{dup:243}],462:[function(e,t,r){"use strict";function n(e,t){t=t||new Array(e.length);for(var r=0;r<e.length;++r){t[e[r]]=r}return t}t.exports=n},{}],463:[function(e,t,r){"use strict";function n(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=r}return t}t.exports=n},{}],464:[function(e,t,r){t.exports=true},{}],465:[function(e,t,r){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(e){return e!=null&&(n(e)||a(e)||!!e._isBuffer)};function n(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function a(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&n(e.slice(0,0))}},{}],466:[function(e,t,r){"use strict";t.exports=typeof navigator!=="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],467:[function(e,t,r){"use strict";t.exports=i;t.exports.isMobile=i;t.exports.default=i;var n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i;var a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function i(e){if(!e)e={};var t=e.ua;if(!t&&typeof navigator!=="undefined")t=navigator.userAgent;if(t&&t.headers&&typeof t.headers["user-agent"]==="string"){t=t.headers["user-agent"]}if(typeof t!=="string")return false;var r=e.tablet?a.test(t):n.test(t);if(!r&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1){r=true}return r}},{}],468:[function(e,t,r){"use strict";t.exports=function(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}},{}],469:[function(e,t,r){"use strict";var n=Object.prototype.toString;t.exports=function(e){var t;return n.call(e)==="[object Object]"&&(t=Object.getPrototypeOf(e),t===null||t===Object.getPrototypeOf({}))}},{}],470:[function(e,t,r){"use strict";t.exports=function(e){var t=e.length,r;for(var n=0;n<t;n++){r=e.charCodeAt(n);if((r<9||r>13)&&r!==32&&r!==133&&r!==160&&r!==5760&&r!==6158&&(r<8192||r>8205)&&r!==8232&&r!==8233&&r!==8239&&r!==8287&&r!==8288&&r!==12288&&r!==65279){return false}}return true}},{}],471:[function(e,t,r){"use strict";t.exports=function e(t){if(typeof t!=="string")return false;t=t.trim();if(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4)return true;return false}},{}],472:[function(e,t,r){function n(e,t,r){return e*(1-r)+t*r}t.exports=n},{}],473:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?r.exports=a():typeof e==="function"&&e.amd?e(a):(t=t||self,t.mapboxgl=a())})(this,function(){"use strict";var e,t,r;function n(n,a){if(!e){e=a}else if(!t){t=a}else{var i="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);";var o={};e(o);r=a(o);r.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}}n(["exports"],function(e){"use strict";function t(e,t){return e(t={exports:{}},t.exports),t.exports}var r=n;function n(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=r,this.p2y=n}n.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},n.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},n.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},n.prototype.solveCurveX=function(e,t){var r,n,a,i,o;for(void 0===t&&(t=1e-6),a=e,o=0;o<8;o++){if(i=this.sampleCurveX(a)-e,Math.abs(i)<t)return a;var s=this.sampleCurveDerivativeX(a);if(Math.abs(s)<1e-6)break;a-=i/s}if((a=e)<(r=0))return r;if(a>(n=1))return n;for(;r<n;){if(i=this.sampleCurveX(a),Math.abs(i-e)<t)return a;e>i?r=a:n=a,a=.5*(n-r)+r}return a},n.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var a=i;function i(e,t){this.x=e,this.y=t}function o(e,t,n,a){var i=new r(e,t,n,a);return function(e){return i.solve(e)}}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),a=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(e){return e instanceof i?e:Array.isArray(e)?new i(e[0],e[1]):e};var s=o(.25,.1,.25,1);function l(e,t,r){return Math.min(r,Math.max(t,e))}function u(e,t,r){var n=r-t,a=((e-t)%n+n)%n+t;return a===t?r:a}function c(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,a=t;n<a.length;n+=1){var i=a[n];for(var o in i)e[o]=i[o]}return e}var f=1;function h(){return f++}function p(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function d(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function v(e,t){e.forEach(function(e){t[e]&&(t[e]=t[e].bind(t))})}function m(e,t){return-1!==e.indexOf(t,e.length-t.length)}function g(e,t,r){var n={};for(var a in e)n[a]=t.call(r||this,e[a],a,e);return n}function y(e,t,r){var n={};for(var a in e)t.call(r||this,e[a],a,e)&&(n[a]=e[a]);return n}function x(e){return Array.isArray(e)?e.map(x):"object"==typeof e&&e?g(e,x):e}var _={};function b(e){_[e]||("undefined"!=typeof console&&console.warn(e),_[e]=!0)}function w(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function T(e){for(var t=0,r=0,n=e.length,a=n-1,i=void 0,o=void 0;r<n;a=r++)t+=((o=e[a]).x-(i=e[r]).x)*(i.y+o.y);return t}function k(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function A(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(e,r,n,a){var i=n||a;return t[r]=!i||i.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var M=null;function E(e){if(null==M){var t=e.navigator?e.navigator.userAgent:null;M=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return M}function S(e){try{var t=self[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}var C,L,I,O,P=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),D=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,R=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,z={now:P,frame:function(e){var t=D(e);return{cancel:function(){return R(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var r=self.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return C||(C=self.document.createElement("a")),C.href=e,C.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==L&&(L=self.matchMedia("(prefers-reduced-motion: reduce)")),L.matches)}},N={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(e){!B&&O&&(j?U(e):I=e)}},B=!1,j=!1;function U(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,O),e.isContextLost())return;F.supported=!0}catch(e){}e.deleteTexture(t),B=!0}self.document&&((O=self.document.createElement("img")).onload=function(){I&&U(I),I=null,j=!0},O.onerror=function(){B=!0,I=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var H="01",V=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function G(e){return 0===e.indexOf("mapbox:")}V.prototype._createSkuToken=function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",H,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},V.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},V.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},V.prototype.normalizeStyleURL=function(e,t){if(!G(e))return e;var r=X(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},V.prototype.normalizeGlyphsURL=function(e,t){if(!G(e))return e;var r=X(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},V.prototype.normalizeSourceURL=function(e,t){if(!G(e))return e;var r=X(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},V.prototype.normalizeSpriteURL=function(e,t,r,n){var a=X(e);return G(e)?(a.path="/styles/v1"+a.path+"/sprite"+t+r,this._makeAPIURL(a,this._customAccessToken||n)):(a.path+=""+t+r,Z(a))},V.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!G(e))return e;var r=X(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(z.devicePixelRatio>=2||512===t?"@2x":"")+(F.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var n=this._customAccessToken||function(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t].match(/^access_token=(.*)$/);if(n)return n[1]}return null}(r.params)||N.ACCESS_TOKEN;return N.REQUIRE_ACCESS_TOKEN&&n&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,n)},V.prototype.canonicalizeTileURL=function(e,t){var r=X(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var n="mapbox://tiles/";n+=r.path.replace("/v4/","");var a=r.params;return t&&(a=a.filter(function(e){return!e.match(/^access_token=/)})),a.length&&(n+="?"+a.join("&")),n},V.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&G(t),n=[],a=0,i=e.tiles||[];a<i.length;a+=1){var o=i[a];Y(o)?n.push(this.canonicalizeTileURL(o,r)):n.push(o)}return n},V.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=X(N.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"/"!==n.path&&(e.path=""+n.path+e.path),!N.REQUIRE_ACCESS_TOKEN)return Z(e);if(!(t=t||N.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(e){return-1===e.indexOf("access_token")}),e.params.push("access_token="+t),Z(e)};var q=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Y(e){return q.test(e)}var W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function X(e){var t=e.match(W);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Z(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function K(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(t[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(e){return null}}var J=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};J.prototype.getStorageKey=function(e){var t,r=K(N.ACCESS_TOKEN);return t=r&&r.u?self.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))})):N.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},J.prototype.fetchEventData=function(){var e=S("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var n=self.localStorage.getItem(t);n&&(this.eventData=JSON.parse(n));var a=self.localStorage.getItem(r);a&&(this.anonId=a)}catch(e){b("Unable to read from LocalStorage")}},J.prototype.saveEventData=function(){var e=S("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{self.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){b("Unable to write to LocalStorage")}},J.prototype.processRequests=function(e){},J.prototype.postEvent=function(e,t,r,n){var a=this;if(N.EVENTS_URL){var i=X(N.EVENTS_URL);i.params.push("access_token="+(n||N.ACCESS_TOKEN||""));var o={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:H,userId:this.anonId},s=t?c(o,t):o,l={url:Z(i),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=xe(l,function(e){a.pendingRequest=null,r(e),a.saveEventData(),a.processRequests(n)})}},J.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Q,$,ee=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(e,t,r,n){this.skuToken=r,(N.EVENTS_URL&&n||N.ACCESS_TOKEN&&Array.isArray(e)&&e.some(function(e){return G(e)||Y(e)}))&&this.queueRequest({id:t,timestamp:Date.now()},n)},t.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),n=r.id,a=r.timestamp;n&&this.success[n]||(this.anonId||this.fetchEventData(),d(this.anonId)||(this.anonId=p()),this.postEvent(a,{skuToken:this.skuToken},function(e){e||n&&(t.success[n]=!0)},e))}},t}(J),te=new(function(e){function t(t){e.call(this,"appUserTurnstile"),this._customAccessToken=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(e,t){N.EVENTS_URL&&N.ACCESS_TOKEN&&Array.isArray(e)&&e.some(function(e){return G(e)||Y(e)})&&this.queueRequest(Date.now(),t)},t.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=K(N.ACCESS_TOKEN),n=r?r.u:N.ACCESS_TOKEN,a=n!==this.eventData.tokenU;d(this.anonId)||(this.anonId=p(),a=!0);var i=this.queue.shift();if(this.eventData.lastSuccess){var o=new Date(this.eventData.lastSuccess),s=new Date(i),l=(i-this.eventData.lastSuccess)/864e5;a=a||l>=1||l<-1||o.getDate()!==s.getDate()}else a=!0;if(!a)return this.processRequests();this.postEvent(i,{"enabled.telemetry":!1},function(e){e||(t.eventData.lastSuccess=i,t.eventData.tokenU=n)},e)}},t}(J)),re=te.postTurnstileEvent.bind(te),ne=new ee,ae=ne.postMapLoadEvent.bind(ne),ie=500,oe=50;function se(){self.caches&&!Q&&(Q=self.caches.open("mapbox-tiles"))}function le(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var ue,ce=1/0;function fe(){return null==ue&&(ue=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),ue}var he={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(he);var pe=function(e){function t(t,r,n){401===r&&Y(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,t),this.status=r,this.url=n,this.name=this.constructor.name,this.message=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),de=k()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href};var ve,me,ge=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(de())&&!/^\w+:/.test(r))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return function(e,t){var r,n=new self.AbortController,a=new self.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:de(),signal:n.signal}),i=!1,o=!1,s=(r=a.url).indexOf("sku=")>0&&Y(r);"json"===e.type&&a.headers.set("Accept","application/json");var l=function(r,n,i){if(!o){if(r&&"SecurityError"!==r.message&&b(r),n&&i)return u(n);var l=Date.now();self.fetch(a).then(function(r){if(r.ok){var n=s?r.clone():null;return u(r,n,l)}return t(new pe(r.statusText,r.status,e.url))}).catch(function(e){20!==e.code&&t(new Error(e.message))})}},u=function(r,n,s){("arrayBuffer"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then(function(e){o||(n&&s&&function(e,t,r){if(se(),Q){var n={status:t.status,statusText:t.statusText,headers:new self.Headers};t.headers.forEach(function(e,t){return n.headers.set(t,e)});var a=A(t.headers.get("Cache-Control")||"");a["no-store"]||(a["max-age"]&&n.headers.set("Expires",new Date(r+1e3*a["max-age"]).toUTCString()),new Date(n.headers.get("Expires")).getTime()-r<42e4||function(e,t){if(void 0===$)try{new Response(new ReadableStream),$=!0}catch(e){$=!1}$?t(e.body):e.blob().then(t)}(t,function(t){var r=new self.Response(t,n);se(),Q&&Q.then(function(t){return t.put(le(e.url),r)}).catch(function(e){return b(e.message)})}))}}(a,n,s),i=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))}).catch(function(e){o||t(new Error(e.message))})};return s?function(e,t){if(se(),!Q)return t(null);var r=le(e.url);Q.then(function(e){e.match(r).then(function(n){var a=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),r=A(e.headers.get("Cache-Control")||"");return t>Date.now()&&!r["no-cache"]}(n);e.delete(r),a&&e.put(r,n.clone()),t(null,n,a)}).catch(t)}).catch(t)}(a,l):l(null,null),{cancel:function(){o=!0,i||n.abort()}}}(e,t);if(k()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(e,t){var r=new self.XMLHttpRequest;for(var n in r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer"),e.headers)r.setRequestHeader(n,e.headers[n]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){var n=r.response;if("json"===e.type)try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else t(new pe(r.statusText,r.status,e.url))},r.send(e.body),{cancel:function(){return r.abort()}}}(e,t)},ye=function(e,t){return ge(c(e,{type:"arrayBuffer"}),t)},xe=function(e,t){return ge(c(e,{method:"POST"}),t)};ve=[],me=0;var _e=function(e,t){if(F.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),me>=N.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return ve.push(r),r}me++;var n=!1,a=function(){if(!n)for(n=!0,me--;ve.length&&me<N.MAX_PARALLEL_IMAGE_REQUESTS;){var e=ve.shift();e.cancelled||(e.cancel=_e(e.requestParameters,e.callback).cancel)}},i=ye(e,function(e,r,n,i){a(),e?t(e):r&&(fe()?function(e,t){var r=new self.Blob([new Uint8Array(e)],{type:"image/png"});self.createImageBitmap(r).then(function(e){t(null,e)}).catch(function(e){t(new Error("Could not load image because of "+e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(r,t):function(e,t,r,n){var a=new self.Image,i=self.URL;a.onload=function(){t(null,a),i.revokeObjectURL(a.src)},a.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var o=new self.Blob([new Uint8Array(e)],{type:"image/png"});a.cacheControl=r,a.expires=n,a.src=e.byteLength?i.createObjectURL(o):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(r,t,n,i))});return{cancel:function(){i.cancel(),a()}}};function be(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function we(e,t,r){if(r&&r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}var Te=function(e,t){void 0===t&&(t={}),c(this,t),this.type=e},ke=function(e){function t(t,r){void 0===r&&(r={}),e.call(this,"error",c({error:t},r))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Te),Ae=function(){};Ae.prototype.on=function(e,t){return this._listeners=this._listeners||{},be(e,t,this._listeners),this},Ae.prototype.off=function(e,t){return we(e,t,this._listeners),we(e,t,this._oneTimeListeners),this},Ae.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},be(e,t,this._oneTimeListeners),this},Ae.prototype.fire=function(e,t){"string"==typeof e&&(e=new Te(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var n=0,a=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];n<a.length;n+=1)a[n].call(this,e);for(var i=0,o=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];i<o.length;i+=1){var s=o[i];we(r,s,this._oneTimeListeners),s.call(this,e)}var l=this._eventedParent;l&&(c(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(e))}else e instanceof ke&&console.error(e.error);return this},Ae.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ae.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ee=function(e,t,r,n){this.message=(e?e+": ":"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)};function Se(e){var t=e.value;return t?[new Ee(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,a=t;n<a.length;n+=1){var i=a[n];for(var o in i)e[o]=i[o]}return e}function Le(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ie(e){if(Array.isArray(e))return e.map(Ie);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=Ie(e[r]);return t}return Le(e)}var Oe=function(e){function t(t,r){e.call(this,r),this.message=r,this.key=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Pe=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,n=t;r<n.length;r+=1){var a=n[r];this.bindings[a[0]]=a[1]}};Pe.prototype.concat=function(e){return new Pe(this,e)},Pe.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Pe.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var De={kind:"null"},Re={kind:"number"},ze={kind:"string"},Ne={kind:"boolean"},Fe={kind:"color"},Be={kind:"object"},je={kind:"value"},Ue={kind:"collator"},He={kind:"formatted"},Ve={kind:"resolvedImage"};function Ge(e,t){return{kind:"array",itemType:e,N:t}}function qe(e){if("array"===e.kind){var t=qe(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var Ye=[De,Re,ze,Ne,Fe,He,Be,Ge(je),Ve];function We(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!We(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,n=Ye;r<n.length;r+=1)if(!We(n[r],t))return null}return"Expected "+qe(e)+" but found "+qe(t)+" instead."}function Xe(e,t){return t.some(function(t){return t.kind===e.kind})}function Ze(e,t){return t.some(function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e})}var Ke=t(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(e){return(e=Math.round(e))<0?0:e>255?255:e}function a(e){return n("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function i(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function o(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{t.parseCSSColor=function(e){var t,s=e.replace(/ /g,"").toLowerCase();if(s in r)return r[s].slice();if("#"===s[0])return 4===s.length?(t=parseInt(s.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===s.length&&(t=parseInt(s.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=s.indexOf("("),u=s.indexOf(")");if(-1!==l&&u+1===s.length){var c=s.substr(0,l),f=s.substr(l+1,u-(l+1)).split(","),h=1;switch(c){case"rgba":if(4!==f.length)return null;h=i(f.pop());case"rgb":return 3!==f.length?null:[a(f[0]),a(f[1]),a(f[2]),h];case"hsla":if(4!==f.length)return null;h=i(f.pop());case"hsl":if(3!==f.length)return null;var p=(parseFloat(f[0])%360+360)%360/360,d=i(f[1]),v=i(f[2]),m=v<=.5?v*(d+1):v+d-v*d,g=2*v-m;return[n(255*o(g,m,p+1/3)),n(255*o(g,m,p)),n(255*o(g,m,p-1/3)),h];default:return null}}return null}}catch(e){}}).parseCSSColor,Je=function(e,t,r,n){void 0===n&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n};Je.parse=function(e){if(e){if(e instanceof Je)return e;if("string"==typeof e){var t=Ke(e);if(t)return new Je(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Je.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],n=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+n+")"},Je.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Je.black=new Je(0,0,0,1),Je.white=new Je(1,1,1,1),Je.transparent=new Je(0,0,0,0),Je.red=new Je(1,0,0,1);var Qe=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Qe.prototype.compare=function(e,t){return this.collator.compare(e,t)},Qe.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $e=function(e,t,r,n,a){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=a},et=function(e){this.sections=e};et.fromString=function(e){return new et([new $e(e,null,null,null,null)])},et.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length})},et.factory=function(e){return e instanceof et?e:et.fromString(e)},et.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(e){return e.text}).join("")},et.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t];if(n.image)e.push(["image",n.image.name]);else{e.push(n.text);var a={};n.fontStack&&(a["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(a["font-scale"]=n.scale),n.textColor&&(a["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(a)}}return e};var tt=function(e){this.name=e.name,this.available=e.available};function rt(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[e,t,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function nt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Je)return!0;if(e instanceof Qe)return!0;if(e instanceof et)return!0;if(e instanceof tt)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!nt(r[t]))return!1;return!0}if("object"==typeof e){for(var n in e)if(!nt(e[n]))return!1;return!0}return!1}function at(e){if(null===e)return De;if("string"==typeof e)return ze;if("boolean"==typeof e)return Ne;if("number"==typeof e)return Re;if(e instanceof Je)return Fe;if(e instanceof Qe)return Ue;if(e instanceof et)return He;if(e instanceof tt)return Ve;if(Array.isArray(e)){for(var t,r=e.length,n=0,a=e;n<a.length;n+=1){var i=at(a[n]);if(t){if(t===i)continue;t=je;break}t=i}return Ge(t||je,r)}return Be}function it(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Je||e instanceof et||e instanceof tt?e.toString():JSON.stringify(e)}tt.prototype.toString=function(){return this.name},tt.fromString=function(e){return e?new tt({name:e,available:!1}):null},tt.prototype.serialize=function(){return["image",this.name]};var ot=function(e,t){this.type=e,this.value=t};ot.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!nt(e[1]))return t.error("invalid value");var r=e[1],n=at(r),a=t.expectedType;return"array"!==n.kind||0!==n.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(n=a),new ot(n,r)},ot.prototype.evaluate=function(){return this.value},ot.prototype.eachChild=function(){},ot.prototype.outputDefined=function(){return!0},ot.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Je?["rgba"].concat(this.value.toArray()):this.value instanceof et?this.value.serialize():this.value};var st=function(e){this.name="ExpressionEvaluationError",this.message=e};st.prototype.toJSON=function(){return this.message};var lt={string:ze,number:Re,boolean:Ne,object:Be},ut=function(e,t){this.type=e,this.args=t};ut.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,n=1,a=e[0];if("array"===a){var i,o;if(e.length>2){var s=e[1];if("string"!=typeof s||!(s in lt)||"object"===s)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=lt[s],n++}else i=je;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],n++}r=Ge(i,o)}else r=lt[a];for(var l=[];n<e.length;n++){var u=t.parse(e[n],n,je);if(!u)return null;l.push(u)}return new ut(r,l)},ut.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!We(this.type,at(r)))return r;if(t===this.args.length-1)throw new st("Expected value to be of type "+qe(this.type)+", but found "+qe(at(r))+" instead.")}return null},ut.prototype.eachChild=function(e){this.args.forEach(e)},ut.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ut.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map(function(e){return e.serialize()}))};var ct=function(e){this.type=He,this.sections=e};ct.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");for(var n=[],a=!1,i=1;i<=e.length-1;++i){var o=e[i];if(a&&"object"==typeof o&&!Array.isArray(o)){a=!1;var s=null;if(o["font-scale"]&&!(s=t.parse(o["font-scale"],1,Re)))return null;var l=null;if(o["text-font"]&&!(l=t.parse(o["text-font"],1,Ge(ze))))return null;var u=null;if(o["text-color"]&&!(u=t.parse(o["text-color"],1,Fe)))return null;var c=n[n.length-1];c.scale=s,c.font=l,c.textColor=u}else{var f=t.parse(e[i],1,je);if(!f)return null;var h=f.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,n.push({content:f,scale:null,font:null,textColor:null})}}return new ct(n)},ct.prototype.evaluate=function(e){return new et(this.sections.map(function(t){var r=t.content.evaluate(e);return at(r)===Ve?new $e("",r,null,null,null):new $e(it(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},ct.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}},ct.prototype.outputDefined=function(){return!1},ct.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e.push(n.content.serialize());var a={};n.scale&&(a["font-scale"]=n.scale.serialize()),n.font&&(a["text-font"]=n.font.serialize()),n.textColor&&(a["text-color"]=n.textColor.serialize()),e.push(a)}return e};var ft=function(e){this.type=Ve,this.input=e};ft.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,ze);return r?new ft(r):t.error("No image name provided.")},ft.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=tt.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},ft.prototype.eachChild=function(e){e(this.input)},ft.prototype.outputDefined=function(){return!1},ft.prototype.serialize=function(){return["image",this.input.serialize()]};var ht={"to-boolean":Ne,"to-color":Fe,"to-number":Re,"to-string":ze},pt=function(e,t){this.type=e,this.args=t};pt.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var n=ht[r],a=[],i=1;i<e.length;i++){var o=t.parse(e[i],i,je);if(!o)return null;a.push(o)}return new pt(n,a)},pt.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,r,n=0,a=this.args;n<a.length;n+=1){if(r=null,(t=a[n].evaluate(e))instanceof Je)return t;if("string"==typeof t){var i=e.parseColor(t);if(i)return i}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":rt(t[0],t[1],t[2],t[3])))return new Je(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new st(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){for(var o=null,s=0,l=this.args;s<l.length;s+=1){if(null===(o=l[s].evaluate(e)))return 0;var u=Number(o);if(!isNaN(u))return u}throw new st("Could not convert "+JSON.stringify(o)+" to number.")}return"formatted"===this.type.kind?et.fromString(it(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?tt.fromString(it(this.args[0].evaluate(e))):it(this.args[0].evaluate(e))},pt.prototype.eachChild=function(e){this.args.forEach(e)},pt.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},pt.prototype.serialize=function(){if("formatted"===this.type.kind)return new ct([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ft(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var dt=["Unknown","Point","LineString","Polygon"],vt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};vt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},vt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?dt[this.feature.type]:this.feature.type:null},vt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},vt.prototype.canonicalID=function(){return this.canonical},vt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},vt.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Je.parse(e)),t};var mt=function(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n};mt.prototype.evaluate=function(e){return this._evaluate(e,this.args)},mt.prototype.eachChild=function(e){this.args.forEach(e)},mt.prototype.outputDefined=function(){return!1},mt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},mt.parse=function(e,t){var r,n=e[0],a=mt.definitions[n];if(!a)return t.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(a)?a[0]:a.type,o=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,s=o.filter(function(t){var r=t[0];return!Array.isArray(r)||r.length===e.length-1}),l=null,u=0,c=s;u<c.length;u+=1){var f=c[u],h=f[0],p=f[1];l=new Ft(t.registry,t.path,null,t.scope);for(var d=[],v=!1,m=1;m<e.length;m++){var g=e[m],y=Array.isArray(h)?h[m-1]:h.type,x=l.parse(g,1+d.length,y);if(!x){v=!0;break}d.push(x)}if(!v)if(Array.isArray(h)&&h.length!==d.length)l.error("Expected "+h.length+" arguments, but found "+d.length+" instead.");else{for(var _=0;_<d.length;_++){var b=Array.isArray(h)?h[_]:h.type,w=d[_];l.concat(_+1).checkSubtype(b,w.type)}if(0===l.errors.length)return new mt(n,i,p,d)}}if(1===s.length)(r=t.errors).push.apply(r,l.errors);else{for(var T=(s.length?s:o).map(function(e){var t;return t=e[0],Array.isArray(t)?"("+t.map(qe).join(", ")+")":"("+qe(t.type)+"...)"}).join(" | "),k=[],A=1;A<e.length;A++){var M=t.parse(e[A],1+k.length);if(!M)return null;k.push(qe(M.type))}t.error("Expected arguments of type "+T+", but found ("+k.join(", ")+") instead.")}return null},mt.register=function(e,t){for(var r in mt.definitions=t,t)e[r]=mt};var gt=function(e,t,r){this.type=Ue,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function yt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function xt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function _t(e,t){var r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,a=Math.pow(2,t.z);return[Math.round(r*a*8192),Math.round(n*a*8192)]}function bt(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function wt(e,t){for(var r,n,a,i,o,s,l,u=!1,c=0,f=t.length;c<f;c++)for(var h=t[c],p=0,d=h.length;p<d-1;p++){if((i=(r=e)[0]-(n=h[p])[0])*(l=r[1]-(a=h[p+1])[1])-(s=r[0]-a[0])*(o=r[1]-n[1])==0&&i*s<=0&&o*l<=0)return!1;bt(e,h[p],h[p+1])&&(u=!u)}return u}function Tt(e,t){for(var r=0;r<t.length;r++)if(wt(e,t[r]))return!0;return!1}function kt(e,t,r,n){var a=n[0]-r[0],i=n[1]-r[1],o=(e[0]-r[0])*i-a*(e[1]-r[1]),s=(t[0]-r[0])*i-a*(t[1]-r[1]);return o>0&&s<0||o<0&&s>0}function At(e,t,r){for(var n=0,a=r;n<a.length;n+=1)for(var i=a[n],o=0;o<i.length-1;++o)if(0!=(f=[(c=i[o+1])[0]-(u=i[o])[0],c[1]-u[1]])[0]*(h=[(l=t)[0]-(s=e)[0],l[1]-s[1]])[1]-f[1]*h[0]&&kt(s,l,u,c)&&kt(u,c,s,l))return!0;var s,l,u,c,f,h;return!1}function Mt(e,t){for(var r=0;r<e.length;++r)if(!wt(e[r],t))return!1;for(var n=0;n<e.length-1;++n)if(At(e[n],e[n+1],t))return!1;return!0}function Et(e,t){for(var r=0;r<t.length;r++)if(Mt(e,t[r]))return!0;return!1}function St(e,t,r){for(var n=[],a=0;a<e.length;a++){for(var i=[],o=0;o<e[a].length;o++){var s=_t(e[a][o],r);yt(t,s),i.push(s)}n.push(i)}return n}function Ct(e,t,r){for(var n=[],a=0;a<e.length;a++){var i=St(e[a],t,r);n.push(i)}return n}function Lt(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){var a=.5*n,i=e[0]-r[0]>a?-n:r[0]-e[0]>a?n:0;0===i&&(i=e[0]-r[2]>a?-n:r[2]-e[0]>a?n:0),e[0]+=i}yt(t,e)}function It(e,t,r,n){for(var a=8192*Math.pow(2,n.z),i=[8192*n.x,8192*n.y],o=[],s=0,l=e;s<l.length;s+=1)for(var u=0,c=l[s];u<c.length;u+=1){var f=c[u],h=[f.x+i[0],f.y+i[1]];Lt(h,t,r,a),o.push(h)}return o}function Ot(e,t,r,n){for(var a,i=8192*Math.pow(2,n.z),o=[8192*n.x,8192*n.y],s=[],l=0,u=e;l<u.length;l+=1){for(var c=[],f=0,h=u[l];f<h.length;f+=1){var p=h[f],d=[p.x+o[0],p.y+o[1]];yt(t,d),c.push(d)}s.push(c)}if(t[2]-t[0]<=i/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(var v=0,m=s;v<m.length;v+=1)for(var g=0,y=m[v];g<y.length;g+=1)Lt(y[g],t,r,i)}return s}gt.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Ne);if(!n)return null;var a=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Ne);if(!a)return null;var i=null;return r.locale&&!(i=t.parse(r.locale,1,ze))?null:new gt(n,a,i)},gt.prototype.evaluate=function(e){return new Qe(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},gt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},gt.prototype.outputDefined=function(){return!1},gt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Pt=function(e,t){this.type=Ne,this.geojson=e,this.geometries=t};function Dt(e){if(e instanceof mt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Pt)return!1;var t=!0;return e.eachChild(function(e){t&&!Dt(e)&&(t=!1)}),t}function Rt(e){if(e instanceof mt&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild(function(e){t&&!Rt(e)&&(t=!1)}),t}function zt(e,t){if(e instanceof mt&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(e){r&&!zt(e,t)&&(r=!1)}),r}Pt.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(nt(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var n=0;n<r.features.length;++n){var a=r.features[n].geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new Pt(r,r.features[n].geometry)}else if("Feature"===r.type){var i=r.geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Pt(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Pt(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Pt.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],a=e.canonicalID();if("Polygon"===t.type){var i=St(t.coordinates,n,a),o=It(e.geometry(),r,n,a);if(!xt(r,n))return!1;for(var s=0,l=o;s<l.length;s+=1)if(!wt(l[s],i))return!1}if("MultiPolygon"===t.type){var u=Ct(t.coordinates,n,a),c=It(e.geometry(),r,n,a);if(!xt(r,n))return!1;for(var f=0,h=c;f<h.length;f+=1)if(!Tt(h[f],u))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],a=e.canonicalID();if("Polygon"===t.type){var i=St(t.coordinates,n,a),o=Ot(e.geometry(),r,n,a);if(!xt(r,n))return!1;for(var s=0,l=o;s<l.length;s+=1)if(!Mt(l[s],i))return!1}if("MultiPolygon"===t.type){var u=Ct(t.coordinates,n,a),c=Ot(e.geometry(),r,n,a);if(!xt(r,n))return!1;for(var f=0,h=c;f<h.length;f+=1)if(!Et(h[f],u))return!1}return!0}(e,this.geometries)}return!1},Pt.prototype.eachChild=function(){},Pt.prototype.outputDefined=function(){return!0},Pt.prototype.serialize=function(){return["within",this.geojson]};var Nt=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Nt.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Nt(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Nt.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Nt.prototype.eachChild=function(){},Nt.prototype.outputDefined=function(){return!1},Nt.prototype.serialize=function(){return["var",this.name]};var Ft=function(e,t,r,n,a){void 0===t&&(t=[]),void 0===n&&(n=new Pe),void 0===a&&(a=[]),this.registry=e,this.path=t,this.key=t.map(function(e){return"["+e+"]"}).join(""),this.scope=n,this.errors=a,this.expectedType=r};function Bt(e,t){for(var r,n=e.length-1,a=0,i=n,o=0;a<=i;)if((r=e[o=Math.floor((a+i)/2)])<=t){if(o===n||t<e[o+1])return o;a=o+1}else{if(!(r>t))throw new st("Input is not a number.");i=o-1}return 0}Ft.prototype.parse=function(e,t,r,n,a){return void 0===a&&(a={}),t?this.concat(t,r,n)._parse(e,a):this._parse(e,a)},Ft.prototype._parse=function(e,t){function r(e,t,r){return"assert"===r?new ut(t,[e]):"coerce"===r?new pt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var a=this.registry[n];if(a){var i=a.parse(e,this);if(!i)return null;if(this.expectedType){var o=this.expectedType,s=i.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind&&"array"!==o.kind||"value"!==s.kind)if("color"!==o.kind&&"formatted"!==o.kind&&"resolvedImage"!==o.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(o,s))return null}else i=r(i,o,t.typeAnnotation||"coerce");else i=r(i,o,t.typeAnnotation||"assert")}if(!(i instanceof ot)&&"resolvedImage"!==i.type.kind&&function e(t){if(t instanceof Nt)return e(t.boundExpression);if(t instanceof mt&&"error"===t.name)return!1;if(t instanceof gt)return!1;if(t instanceof Pt)return!1;var r=t instanceof pt||t instanceof ut,n=!0;return t.eachChild(function(t){n=r?n&&e(t):n&&t instanceof ot}),!!n&&Dt(t)&&zt(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(i)){var l=new vt;try{i=new ot(i.type,i.evaluate(l))}catch(e){return this.error(e.message),null}}return i}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ft.prototype.concat=function(e,t,r){var n="number"==typeof e?this.path.concat(e):this.path,a=r?this.scope.concat(r):this.scope;return new Ft(this.registry,n,t||null,a,this.errors)},Ft.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var n=""+this.key+t.map(function(e){return"["+e+"]"}).join("");this.errors.push(new Oe(n,e))},Ft.prototype.checkSubtype=function(e,t){var r=We(e,t);return r&&this.error(r),r};var jt=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var n=0,a=r;n<a.length;n+=1){var i=a[n],o=i[1];this.labels.push(i[0]),this.outputs.push(o)}};function Ut(e,t,r){return e*(1-r)+t*r}jt.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Re);if(!r)return null;var n=[],a=null;t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(var i=1;i<e.length;i+=2){var o=1===i?-1/0:e[i],s=e[i+1],l=i,u=i+1;if("number"!=typeof o)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(n.length&&n[n.length-1][0]>=o)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var c=t.parse(s,u,a);if(!c)return null;a=a||c.type,n.push([o,c])}return new jt(a,r,n)},jt.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var a=t.length;return n>=t[a-1]?r[a-1].evaluate(e):r[Bt(t,n)].evaluate(e)},jt.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},jt.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},jt.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Ht=Object.freeze({__proto__:null,number:Ut,color:function(e,t,r){return new Je(Ut(e.r,t.r,r),Ut(e.g,t.g,r),Ut(e.b,t.b,r),Ut(e.a,t.a,r))},array:function(e,t,r){return e.map(function(e,n){return Ut(e,t[n],r)})}}),Vt=6/29*3*(6/29),Gt=Math.PI/180,qt=180/Math.PI;function Yt(e){return e>.008856451679035631?Math.pow(e,1/3):e/Vt+4/29}function Wt(e){return e>6/29?e*e*e:Vt*(e-4/29)}function Xt(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Zt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Kt(e){var t=Zt(e.r),r=Zt(e.g),n=Zt(e.b),a=Yt((.4124564*t+.3575761*r+.1804375*n)/.95047),i=Yt((.2126729*t+.7151522*r+.072175*n)/1);return{l:116*i-16,a:500*(a-i),b:200*(i-Yt((.0193339*t+.119192*r+.9503041*n)/1.08883)),alpha:e.a}}function Jt(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*Wt(t),r=.95047*Wt(r),n=1.08883*Wt(n),new Je(Xt(3.2404542*r-1.5371385*t-.4985314*n),Xt(-.969266*r+1.8760108*t+.041556*n),Xt(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function Qt(e,t,r){var n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}var $t={forward:Kt,reverse:Jt,interpolate:function(e,t,r){return{l:Ut(e.l,t.l,r),a:Ut(e.a,t.a,r),b:Ut(e.b,t.b,r),alpha:Ut(e.alpha,t.alpha,r)}}},er={forward:function(e){var t=Kt(e),r=t.l,n=t.a,a=t.b,i=Math.atan2(a,n)*qt;return{h:i<0?i+360:i,c:Math.sqrt(n*n+a*a),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Gt,r=e.c;return Jt({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:Qt(e.h,t.h,r),c:Ut(e.c,t.c,r),l:Ut(e.l,t.l,r),alpha:Ut(e.alpha,t.alpha,r)}}},tr=Object.freeze({__proto__:null,lab:$t,hcl:er}),rr=function(e,t,r,n,a){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var i=0,o=a;i<o.length;i+=1){var s=o[i],l=s[1];this.labels.push(s[0]),this.outputs.push(l)}};function nr(e,t,r,n){var a=n-r,i=e-r;return 0===a?0:1===t?i/a:(Math.pow(t,i)-1)/(Math.pow(t,a)-1)}rr.interpolationFactor=function(e,t,n,a){var i=0;if("exponential"===e.name)i=nr(t,e.base,n,a);else if("linear"===e.name)i=nr(t,1,n,a);else if("cubic-bezier"===e.name){var o=e.controlPoints;i=new r(o[0],o[1],o[2],o[3]).solve(nr(t,1,n,a))}return i},rr.parse=function(e,t){var r=e[0],n=e[1],a=e[2],i=e.slice(3);if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var o=n[1];if("number"!=typeof o)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:o}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type "+String(n[0]),1,0);var s=n.slice(1);if(4!==s.length||s.some(function(e){return"number"!=typeof e||e<0||e>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:s}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(a=t.parse(a,2,Re)))return null;var l=[],u=null;"interpolate-hcl"===r||"interpolate-lab"===r?u=Fe:t.expectedType&&"value"!==t.expectedType.kind&&(u=t.expectedType);for(var c=0;c<i.length;c+=2){var f=i[c],h=i[c+1],p=c+3,d=c+4;if("number"!=typeof f)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(l.length&&l[l.length-1][0]>=f)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var v=t.parse(h,d,u);if(!v)return null;u=u||v.type,l.push([f,v])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new rr(u,r,n,a,l):t.error("Type "+qe(u)+" is not interpolatable.")},rr.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var a=t.length;if(n>=t[a-1])return r[a-1].evaluate(e);var i=Bt(t,n),o=rr.interpolationFactor(this.interpolation,n,t[i],t[i+1]),s=r[i].evaluate(e),l=r[i+1].evaluate(e);return"interpolate"===this.operator?Ht[this.type.kind.toLowerCase()](s,l,o):"interpolate-hcl"===this.operator?er.reverse(er.interpolate(er.forward(s),er.forward(l),o)):$t.reverse($t.interpolate($t.forward(s),$t.forward(l),o))},rr.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},rr.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},rr.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var ar=function(e,t){this.type=e,this.args=t};ar.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,n=t.expectedType;n&&"value"!==n.kind&&(r=n);for(var a=[],i=0,o=e.slice(1);i<o.length;i+=1){var s=t.parse(o[i],1+a.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,a.push(s)}var l=n&&a.some(function(e){return We(n,e.type)});return new ar(l?je:r,a)},ar.prototype.evaluate=function(e){for(var t,r=null,n=0,a=0,i=this.args;a<i.length&&(n++,(r=i[a].evaluate(e))&&r instanceof tt&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null===r);a+=1);return r},ar.prototype.eachChild=function(e){this.args.forEach(e)},ar.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ar.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ir=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};ir.prototype.evaluate=function(e){return this.result.evaluate(e)},ir.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},ir.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],n=1;n<e.length-1;n+=2){var a=e[n];if("string"!=typeof a)return t.error("Expected string, but found "+typeof a+" instead.",n);if(/[^a-zA-Z0-9_]/.test(a))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);var i=t.parse(e[n+1],n+1);if(!i)return null;r.push([a,i])}var o=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return o?new ir(r,o):null},ir.prototype.outputDefined=function(){return this.result.outputDefined()},ir.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var n=r[t];e.push(n[0],n[1].serialize())}return e.push(this.result.serialize()),e};var or=function(e,t,r){this.type=e,this.index=t,this.input=r};or.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Re),n=t.parse(e[2],2,Ge(t.expectedType||je));return r&&n?new or(n.type.itemType,r,n):null},or.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new st("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new st("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new st("Array index must be an integer, but found "+t+" instead.");return r[t]},or.prototype.eachChild=function(e){e(this.index),e(this.input)},or.prototype.outputDefined=function(){return!1},or.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var sr=function(e,t){this.type=Ne,this.needle=e,this.haystack=t};sr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,je),n=t.parse(e[2],2,je);return r&&n?Xe(r.type,[Ne,ze,Re,De,je])?new sr(r,n):t.error("Expected first argument to be of type boolean, string, number or null, but found "+qe(r.type)+" instead"):null},sr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Ze(t,["boolean","string","number","null"]))throw new st("Expected first argument to be of type boolean, string, number or null, but found "+qe(at(t))+" instead.");if(!Ze(r,["string","array"]))throw new st("Expected second argument to be of type array or string, but found "+qe(at(r))+" instead.");return r.indexOf(t)>=0},sr.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},sr.prototype.outputDefined=function(){return!0},sr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var lr=function(e,t,r){this.type=Re,this.needle=e,this.haystack=t,this.fromIndex=r};lr.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,je),n=t.parse(e[2],2,je);if(!r||!n)return null;if(!Xe(r.type,[Ne,ze,Re,De,je]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+qe(r.type)+" instead");if(4===e.length){var a=t.parse(e[3],3,Re);return a?new lr(r,n,a):null}return new lr(r,n)},lr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Ze(t,["boolean","string","number","null"]))throw new st("Expected first argument to be of type boolean, string, number or null, but found "+qe(at(t))+" instead.");if(!Ze(r,["string","array"]))throw new st("Expected second argument to be of type array or string, but found "+qe(at(r))+" instead.");if(this.fromIndex){var n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)},lr.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},lr.prototype.outputDefined=function(){return!1},lr.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ur=function(e,t,r,n,a,i){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=a,this.otherwise=i};ur.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var a={},i=[],o=2;o<e.length-1;o+=2){var s=e[o],l=e[o+1];Array.isArray(s)||(s=[s]);var u=t.concat(o);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,f=s;c<f.length;c+=1){var h=f[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,at(h)))return null}else r=at(h);if(void 0!==a[String(h)])return u.error("Branch labels must be unique.");a[String(h)]=i.length}var p=t.parse(l,o,n);if(!p)return null;n=n||p.type,i.push(p)}var d=t.parse(e[1],1,je);if(!d)return null;var v=t.parse(e[e.length-1],e.length-1,n);return v?"value"!==d.type.kind&&t.concat(1).checkSubtype(r,d.type)?null:new ur(r,n,d,a,i,v):null},ur.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(at(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},ur.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ur.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},ur.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],n={},a=0,i=Object.keys(this.cases).sort();a<i.length;a+=1){var o=i[a];void 0===(f=n[this.cases[o]])?(n[this.cases[o]]=r.length,r.push([this.cases[o],[o]])):r[f][1].push(o)}for(var s=function(t){return"number"===e.inputType.kind?Number(t):t},l=0,u=r;l<u.length;l+=1){var c=u[l],f=c[0],h=c[1];t.push(1===h.length?s(h[0]):h.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var cr=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};cr.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var n=[],a=1;a<e.length-1;a+=2){var i=t.parse(e[a],a,Ne);if(!i)return null;var o=t.parse(e[a+1],a+1,r);if(!o)return null;n.push([i,o]),r=r||o.type}var s=t.parse(e[e.length-1],e.length-1,r);return s?new cr(r,n,s):null},cr.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],a=n[1];if(n[0].evaluate(e))return a.evaluate(e)}return this.otherwise.evaluate(e)},cr.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],a=n[1];e(n[0]),e(a)}e(this.otherwise)},cr.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},cr.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var fr=function(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n};function hr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function pr(e,t,r,n){return 0===n.compare(t,r)}function dr(e,t,r){var n="=="!==e&&"!="!==e;return function(){function a(e,t,r){this.type=Ne,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return a.parse=function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var r=e[0],i=t.parse(e[1],1,je);if(!i)return null;if(!hr(r,i.type))return t.concat(1).error('"'+r+"\" comparisons are not supported for type '"+qe(i.type)+"'.");var o=t.parse(e[2],2,je);if(!o)return null;if(!hr(r,o.type))return t.concat(2).error('"'+r+"\" comparisons are not supported for type '"+qe(o.type)+"'.");if(i.type.kind!==o.type.kind&&"value"!==i.type.kind&&"value"!==o.type.kind)return t.error("Cannot compare types '"+qe(i.type)+"' and '"+qe(o.type)+"'.");n&&("value"===i.type.kind&&"value"!==o.type.kind?i=new ut(o.type,[i]):"value"!==i.type.kind&&"value"===o.type.kind&&(o=new ut(i.type,[o])));var s=null;if(4===e.length){if("string"!==i.type.kind&&"string"!==o.type.kind&&"value"!==i.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,Ue)))return null}return new a(i,o,s)},a.prototype.evaluate=function(a){var i=this.lhs.evaluate(a),o=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){var s=at(i),l=at(o);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new st('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var u=at(i),c=at(o);if("string"!==u.kind||"string"!==c.kind)return t(a,i,o)}return this.collator?r(a,i,o,this.collator.evaluate(a)):t(a,i,o)},a.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},a.prototype.outputDefined=function(){return!0},a.prototype.serialize=function(){var t=[e];return this.eachChild(function(e){t.push(e.serialize())}),t},a}()}fr.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,je),n=t.parse(e[2],2,Re);if(!r||!n)return null;if(!Xe(r.type,[Ge(je),ze,je]))return t.error("Expected first argument to be of type array or string, but found "+qe(r.type)+" instead");if(4===e.length){var a=t.parse(e[3],3,Re);return a?new fr(r.type,r,n,a):null}return new fr(r.type,r,n)},fr.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Ze(t,["string","array"]))throw new st("Expected first argument to be of type array or string, but found "+qe(at(t))+" instead.");if(this.endIndex){var n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)},fr.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},fr.prototype.outputDefined=function(){return!1},fr.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var vr=dr("==",function(e,t,r){return t===r},pr),mr=dr("!=",function(e,t,r){return t!==r},function(e,t,r,n){return!pr(0,t,r,n)}),gr=dr("<",function(e,t,r){return t<r},function(e,t,r,n){return n.compare(t,r)<0}),yr=dr(">",function(e,t,r){return t>r},function(e,t,r,n){return n.compare(t,r)>0}),xr=dr("<=",function(e,t,r){return t<=r},function(e,t,r,n){return n.compare(t,r)<=0}),_r=dr(">=",function(e,t,r){return t>=r},function(e,t,r,n){return n.compare(t,r)>=0}),br=function(e,t,r,n,a){this.type=ze,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=a};br.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Re);if(!r)return null;var n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");var a=null;if(n.locale&&!(a=t.parse(n.locale,1,ze)))return null;var i=null;if(n.currency&&!(i=t.parse(n.currency,1,ze)))return null;var o=null;if(n["min-fraction-digits"]&&!(o=t.parse(n["min-fraction-digits"],1,Re)))return null;var s=null;return n["max-fraction-digits"]&&!(s=t.parse(n["max-fraction-digits"],1,Re))?null:new br(r,a,i,o,s)},br.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},br.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},br.prototype.outputDefined=function(){return!1},br.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var wr=function(e){this.type=Re,this.input=e};wr.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+qe(r.type)+" instead."):new wr(r):null},wr.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new st("Expected value to be of type string or array, but found "+qe(at(t))+" instead.")},wr.prototype.eachChild=function(e){e(this.input)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Tr={"==":vr,"!=":mr,">":yr,"<":gr,">=":_r,"<=":xr,array:ut,at:or,boolean:ut,case:cr,coalesce:ar,collator:gt,format:ct,image:ft,in:sr,"index-of":lr,interpolate:rr,"interpolate-hcl":rr,"interpolate-lab":rr,length:wr,let:ir,literal:ot,match:ur,number:ut,"number-format":br,object:ut,slice:fr,step:jt,string:ut,"to-boolean":pt,"to-color":pt,"to-number":pt,"to-string":pt,var:Nt,within:Pt};function kr(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];r=r.evaluate(e),n=n.evaluate(e),a=a.evaluate(e);var o=i?i.evaluate(e):1,s=rt(r,n,a,o);if(s)throw new st(s);return new Je(r/255*o,n/255*o,a/255*o,o)}function Ar(e,t){return e in t}function Mr(e,t){var r=t[e];return void 0===r?null:r}function Er(e){return{type:e}}function Sr(e){return{result:"success",value:e}}function Cr(e){return{result:"error",value:e}}function Lr(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Ir(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Or(e){return!!e.expression&&e.expression.interpolated}function Pr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Dr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Rr(e){return e}function zr(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Nr(e,t,r,n,a){return zr(typeof r===a?n[r]:void 0,e.default,t.default)}function Fr(e,t,r){if("number"!==Pr(r))return zr(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];var a=Bt(e.stops.map(function(e){return e[0]}),r);return e.stops[a][1]}function Br(e,t,r){var n=void 0!==e.base?e.base:1;if("number"!==Pr(r))return zr(e.default,t.default);var a=e.stops.length;if(1===a)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[a-1][0])return e.stops[a-1][1];var i=Bt(e.stops.map(function(e){return e[0]}),r),o=function(e,t,r,n){var a=n-r,i=e-r;return 0===a?0:1===t?i/a:(Math.pow(t,i)-1)/(Math.pow(t,a)-1)}(r,n,e.stops[i][0],e.stops[i+1][0]),s=e.stops[i][1],l=e.stops[i+1][1],u=Ht[t.type]||Rr;if(e.colorSpace&&"rgb"!==e.colorSpace){var c=tr[e.colorSpace];u=function(e,t){return c.reverse(c.interpolate(c.forward(e),c.forward(t),o))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=s.evaluate.apply(void 0,e),n=l.evaluate.apply(void 0,e);if(void 0!==r&&void 0!==n)return u(r,n,o)}}:u(s,l,o)}function jr(e,t,r){return"color"===t.type?r=Je.parse(r):"formatted"===t.type?r=et.fromString(r.toString()):"resolvedImage"===t.type?r=tt.fromString(r.toString()):Pr(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),zr(r,e.default,t.default)}mt.register(Tr,{error:[{kind:"error"},[ze],function(e,t){throw new st(t[0].evaluate(e))}],typeof:[ze,[je],function(e,t){return qe(at(t[0].evaluate(e)))}],"to-rgba":[Ge(Re,4),[Fe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Fe,[Re,Re,Re],kr],rgba:[Fe,[Re,Re,Re,Re],kr],has:{type:Ne,overloads:[[[ze],function(e,t){return Ar(t[0].evaluate(e),e.properties())}],[[ze,Be],function(e,t){var r=t[1];return Ar(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:je,overloads:[[[ze],function(e,t){return Mr(t[0].evaluate(e),e.properties())}],[[ze,Be],function(e,t){var r=t[1];return Mr(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[je,[ze],function(e,t){return Mr(t[0].evaluate(e),e.featureState||{})}],properties:[Be,[],function(e){return e.properties()}],"geometry-type":[ze,[],function(e){return e.geometryType()}],id:[je,[],function(e){return e.id()}],zoom:[Re,[],function(e){return e.globals.zoom}],"heatmap-density":[Re,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Re,[],function(e){return e.globals.lineProgress||0}],accumulated:[je,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[Re,Er(Re),function(e,t){for(var r=0,n=0,a=t;n<a.length;n+=1)r+=a[n].evaluate(e);return r}],"*":[Re,Er(Re),function(e,t){for(var r=1,n=0,a=t;n<a.length;n+=1)r*=a[n].evaluate(e);return r}],"-":{type:Re,overloads:[[[Re,Re],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Re],function(e,t){return-t[0].evaluate(e)}]]},"/":[Re,[Re,Re],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Re,[Re,Re],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Re,[],function(){return Math.LN2}],pi:[Re,[],function(){return Math.PI}],e:[Re,[],function(){return Math.E}],"^":[Re,[Re,Re],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Re,[Re],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Re,[Re],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Re,[Re],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Re,[Re],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Re,[Re],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Re,[Re],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Re,[Re],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Re,[Re],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Re,[Re],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Re,[Re],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Re,Er(Re),function(e,t){return Math.min.apply(Math,t.map(function(t){return t.evaluate(e)}))}],max:[Re,Er(Re),function(e,t){return Math.max.apply(Math,t.map(function(t){return t.evaluate(e)}))}],abs:[Re,[Re],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Re,[Re],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Re,[Re],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Re,[Re],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ne,[ze,je],function(e,t){var r=t[0],n=t[1];return e.properties()[r.value]===n.value}],"filter-id-==":[Ne,[je],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[Ne,[ze],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[Ne,[ze,je],function(e,t){var r=t[0],n=t[1],a=e.properties()[r.value],i=n.value;return typeof a==typeof i&&a<i}],"filter-id-<":[Ne,[je],function(e,t){var r=t[0],n=e.id(),a=r.value;return typeof n==typeof a&&n<a}],"filter->":[Ne,[ze,je],function(e,t){var r=t[0],n=t[1],a=e.properties()[r.value],i=n.value;return typeof a==typeof i&&a>i}],"filter-id->":[Ne,[je],function(e,t){var r=t[0],n=e.id(),a=r.value;return typeof n==typeof a&&n>a}],"filter-<=":[Ne,[ze,je],function(e,t){var r=t[0],n=t[1],a=e.properties()[r.value],i=n.value;return typeof a==typeof i&&a<=i}],"filter-id-<=":[Ne,[je],function(e,t){var r=t[0],n=e.id(),a=r.value;return typeof n==typeof a&&n<=a}],"filter->=":[Ne,[ze,je],function(e,t){var r=t[0],n=t[1],a=e.properties()[r.value],i=n.value;return typeof a==typeof i&&a>=i}],"filter-id->=":[Ne,[je],function(e,t){var r=t[0],n=e.id(),a=r.value;return typeof n==typeof a&&n>=a}],"filter-has":[Ne,[je],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ne,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[Ne,[Ge(ze)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ne,[Ge(je)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ne,[ze,Ge(je)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[Ne,[ze,Ge(je)],function(e,t){var r=t[0],n=t[1];return function(e,t,r,n){for(;r<=n;){var a=r+n>>1;if(t[a]===e)return!0;t[a]>e?n=a-1:r=a+1}return!1}(e.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:Ne,overloads:[[[Ne,Ne],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Er(Ne),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(!n[r].evaluate(e))return!1;return!0}]]},any:{type:Ne,overloads:[[[Ne,Ne],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Er(Ne),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(n[r].evaluate(e))return!0;return!1}]]},"!":[Ne,[Ne],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ne,[ze],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[ze,[ze],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[ze,[ze],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[ze,Er(je),function(e,t){return t.map(function(t){return it(t.evaluate(e))}).join("")}],"resolved-locale":[ze,[Ue],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Ur=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new vt,this._defaultValue=t?function(e){return"color"===e.type&&Dr(e.default)?new Je(0,0,0,0):"color"===e.type?Je.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null};function Hr(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Tr}function Vr(e,t){var r=new Ft(Tr,[],t?function(e){var t={color:Fe,string:ze,number:Re,enum:ze,boolean:Ne,formatted:He,resolvedImage:Ve};return"array"===e.type?Ge(t[e.value]||je,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Sr(new Ur(n,t)):Cr(r.errors)}Ur.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,a,i){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)},Ur.prototype.evaluate=function(e,t,r,n,a,i){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=i||null;try{var o=this.expression.evaluate(this._evaluator);if(null==o||"number"==typeof o&&o!=o)return this._defaultValue;if(this._enumValues&&!(o in this._enumValues))throw new st("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(o)+" instead.");return o}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var Gr=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Rt(t.expression)};Gr.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,a,i){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,a,i)},Gr.prototype.evaluate=function(e,t,r,n,a,i){return this._styleExpression.evaluate(e,t,r,n,a,i)};var qr=function(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Rt(t.expression),this.interpolationType=n};function Yr(e,t){if("error"===(e=Vr(e,t)).result)return e;var r=e.value.expression,n=Dt(r);if(!n&&!Lr(t))return Cr([new Oe("","data expressions not supported")]);var a=zt(r,["zoom"]);if(!a&&!Ir(t))return Cr([new Oe("","zoom expressions not supported")]);var i=function e(t){var r=null;if(t instanceof ir)r=e(t.result);else if(t instanceof ar)for(var n=0,a=t.args;n<a.length&&!(r=e(a[n]));n+=1);else(t instanceof jt||t instanceof rr)&&t.input instanceof mt&&"zoom"===t.input.name&&(r=t);return r instanceof Oe||t.eachChild(function(t){var n=e(t);n instanceof Oe?r=n:!r&&n?r=new Oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new Oe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}(r);return i||a?i instanceof Oe?Cr([i]):i instanceof rr&&!Or(t)?Cr([new Oe("",'"interpolate" expressions cannot be used with this property')]):Sr(i?new qr(n?"camera":"composite",e.value,i.labels,i instanceof rr?i.interpolation:void 0):new Gr(n?"constant":"source",e.value)):Cr([new Oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}qr.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,a,i){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,a,i)},qr.prototype.evaluate=function(e,t,r,n,a,i){return this._styleExpression.evaluate(e,t,r,n,a,i)},qr.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?rr.interpolationFactor(this.interpolationType,e,t,r):0};var Wr=function(e,t){this._parameters=e,this._specification=t,Ce(this,function e(t,r){var n,a,i,o="color"===r.type,s=t.stops&&"object"==typeof t.stops[0][0],l=s||!(s||void 0!==t.property),u=t.type||(Or(r)?"exponential":"interval");if(o&&((t=Ce({},t)).stops&&(t.stops=t.stops.map(function(e){return[e[0],Je.parse(e[1])]})),t.default=Je.parse(t.default?t.default:r.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!tr[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===u)n=Br;else if("interval"===u)n=Fr;else if("categorical"===u){n=Nr,a=Object.create(null);for(var c=0,f=t.stops;c<f.length;c+=1){var h=f[c];a[h[0]]=h[1]}i=typeof t.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'+u+'"');n=jr}if(s){for(var p={},d=[],v=0;v<t.stops.length;v++){var m=t.stops[v],g=m[0].zoom;void 0===p[g]&&(p[g]={zoom:g,type:t.type,property:t.property,default:t.default,stops:[]},d.push(g)),p[g].stops.push([m[0].value,m[1]])}for(var y=[],x=0,_=d;x<_.length;x+=1){var b=_[x];y.push([p[b].zoom,e(p[b],r)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:rr.interpolationFactor.bind(void 0,w),zoomStops:y.map(function(e){return e[0]}),evaluate:function(e,n){var a=e.zoom;return Br({stops:y,base:t.base},r,a).evaluate(a,n)}}}if(l){var T="exponential"===u?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:rr.interpolationFactor.bind(void 0,T),zoomStops:t.stops.map(function(e){return e[0]}),evaluate:function(e){return n(t,r,e.zoom,a,i)}}}return{kind:"source",evaluate:function(e,o){var s=o&&o.properties?o.properties[t.property]:void 0;return void 0===s?zr(t.default,r.default):n(t,r,s,a,i)}}}(this._parameters,this._specification))};function Xr(e){var t=e.key,r=e.value,n=e.valueSpec||{},a=e.objectElementValidators||{},i=e.style,o=e.styleSpec,s=[],l=Pr(r);if("object"!==l)return[new Ee(t,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],f=n[c]||n["*"],h=void 0;if(a[c])h=a[c];else if(n[c])h=_n;else if(a["*"])h=a["*"];else{if(!n["*"]){s.push(new Ee(t,r[u],'unknown property "'+u+'"'));continue}h=_n}s=s.concat(h({key:(t?t+".":t)+u,value:r[u],valueSpec:f,style:i,styleSpec:o,object:r,objectKey:u},r))}for(var p in n)a[p]||n[p].required&&void 0===n[p].default&&void 0===r[p]&&s.push(new Ee(t,r,'missing required property "'+p+'"'));return s}function Zr(e){var t=e.value,r=e.valueSpec,n=e.style,a=e.styleSpec,i=e.key,o=e.arrayElementValidator||_n;if("array"!==Pr(t))return[new Ee(i,t,"array expected, "+Pr(t)+" found")];if(r.length&&t.length!==r.length)return[new Ee(i,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Ee(i,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var s={type:r.value,values:r.values};a.$version<7&&(s.function=r.function),"object"===Pr(r.value)&&(s=r.value);for(var l=[],u=0;u<t.length;u++)l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:n,styleSpec:a,key:i+"["+u+"]"}));return l}function Kr(e){var t=e.key,r=e.value,n=e.valueSpec,a=Pr(r);return"number"===a&&r!=r&&(a="NaN"),"number"!==a?[new Ee(t,r,"number expected, "+a+" found")]:"minimum"in n&&r<n.minimum?[new Ee(t,r,r+" is less than the minimum value "+n.minimum)]:"maximum"in n&&r>n.maximum?[new Ee(t,r,r+" is greater than the maximum value "+n.maximum)]:[]}function Jr(e){var t,r,n,a=e.valueSpec,i=Le(e.value.type),o={},s="categorical"!==i&&void 0===e.value.property,l=!s,u="array"===Pr(e.value.stops)&&"array"===Pr(e.value.stops[0])&&"object"===Pr(e.value.stops[0][0]),c=Xr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new Ee(e.key,e.value,'identity function may not have a "stops" property')];var t=[],r=e.value;return t=t.concat(Zr({key:e.key,value:r,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:f})),"array"===Pr(r)&&0===r.length&&t.push(new Ee(e.key,r,"array must have at least one stop")),t},default:function(e){return _n({key:e.key,value:e.value,valueSpec:a,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===i&&s&&c.push(new Ee(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||c.push(new Ee(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!Or(e.valueSpec)&&c.push(new Ee(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!Lr(e.valueSpec)?c.push(new Ee(e.key,e.value,"property functions not supported")):s&&!Ir(e.valueSpec)&&c.push(new Ee(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!u||void 0!==e.value.property||c.push(new Ee(e.key,e.value,'"property" property is required')),c;function f(e){var t=[],i=e.value,s=e.key;if("array"!==Pr(i))return[new Ee(s,i,"array expected, "+Pr(i)+" found")];if(2!==i.length)return[new Ee(s,i,"array length 2 expected, length "+i.length+" found")];if(u){if("object"!==Pr(i[0]))return[new Ee(s,i,"object expected, "+Pr(i[0])+" found")];if(void 0===i[0].zoom)return[new Ee(s,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new Ee(s,i,"object stop key must have value")];if(n&&n>Le(i[0].zoom))return[new Ee(s,i[0].zoom,"stop zoom values must appear in ascending order")];Le(i[0].zoom)!==n&&(n=Le(i[0].zoom),r=void 0,o={}),t=t.concat(Xr({key:s+"[0]",value:i[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Kr,value:h}}))}else t=t.concat(h({key:s+"[0]",value:i[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},i));return Hr(Ie(i[1]))?t.concat([new Ee(s+"[1]",i[1],"expressions are not allowed in function stops.")]):t.concat(_n({key:s+"[1]",value:i[1],valueSpec:a,style:e.style,styleSpec:e.styleSpec}))}function h(e,n){var s=Pr(e.value),l=Le(e.value),u=null!==e.value?e.value:n;if(t){if(s!==t)return[new Ee(e.key,u,s+" stop domain type must match previous stop domain type "+t)]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Ee(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==i){var c="number expected, "+s+" found";return Lr(a)&&void 0===i&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ee(e.key,u,c)]}return"categorical"!==i||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===s&&void 0!==r&&l<r?[new Ee(e.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in o?[new Ee(e.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new Ee(e.key,u,"integer expected, found "+l)]}}function Qr(e){var t=("property"===e.expressionContext?Yr:Vr)(Ie(e.value),e.valueSpec);if("error"===t.result)return t.value.map(function(t){return new Ee(""+e.key+t.key,e.value,t.message)});var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Ee(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Rt(r))return[new Ee(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Rt(r))return[new Ee(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!zt(r,["zoom","feature-state"]))return[new Ee(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Dt(r))return[new Ee(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $r(e){var t=e.key,r=e.value,n=e.valueSpec,a=[];return Array.isArray(n.values)?-1===n.values.indexOf(Le(r))&&a.push(new Ee(t,r,"expected one of ["+n.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(n.values).indexOf(Le(r))&&a.push(new Ee(t,r,"expected one of ["+Object.keys(n.values).join(", ")+"], "+JSON.stringify(r)+" found")),a}function en(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var n=r[t];if(!en(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}Wr.deserialize=function(e){return new Wr(e._parameters,e._specification)},Wr.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var tn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rn(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};en(e)||(e=an(e));var t=Vr(e,tn);if("error"===t.result)throw new Error(t.value.map(function(e){return e.key+": "+e.message}).join(", "));return{filter:function(e,r,n){return t.value.evaluate(e,r,{},n)},needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(e)}}function nn(e,t){return e<t?-1:e>t?1:0}function an(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?on(e[1],e[2],"=="):"!="===r?un(on(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?on(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(an))):"all"===r?["all"].concat(e.slice(1).map(an)):"none"===r?["all"].concat(e.slice(1).map(an).map(un)):"in"===r?sn(e[1],e.slice(2)):"!in"===r?un(sn(e[1],e.slice(2))):"has"===r?ln(e[1]):"!has"===r?un(ln(e[1])):"within"!==r||e}function on(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function sn(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(e){return typeof e!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(nn)]]:["filter-in-small",e,["literal",t]]}}function ln(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function un(e){return["!",e]}function cn(e){return en(Ie(e.value))?Qr(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){var r=t.value,n=t.key;if("array"!==Pr(r))return[new Ee(n,r,"array expected, "+Pr(r)+" found")];var a,i=t.styleSpec,o=[];if(r.length<1)return[new Ee(n,r,"filter array must have at least 1 element")];switch(o=o.concat($r({key:n+"[0]",value:r[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),Le(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===Le(r[1])&&o.push(new Ee(n,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&o.push(new Ee(n,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(a=Pr(r[1]))&&o.push(new Ee(n+"[1]",r[1],"string expected, "+a+" found"));for(var s=2;s<r.length;s++)a=Pr(r[s]),"$type"===Le(r[1])?o=o.concat($r({key:n+"["+s+"]",value:r[s],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==a&&"number"!==a&&"boolean"!==a&&o.push(new Ee(n+"["+s+"]",r[s],"string, number, or boolean expected, "+a+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)o=o.concat(e({key:n+"["+l+"]",value:r[l],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":a=Pr(r[1]),2!==r.length?o.push(new Ee(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==a&&o.push(new Ee(n+"[1]",r[1],"string expected, "+a+" found"));break;case"within":a=Pr(r[1]),2!==r.length?o.push(new Ee(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"object"!==a&&o.push(new Ee(n+"[1]",r[1],"object expected, "+a+" found"))}return o}(e)}function fn(e,t){var r=e.key,n=e.style,a=e.styleSpec,i=e.value,o=e.objectKey,s=a[t+"_"+e.layerType];if(!s)return[];var l=o.match(/^(.*)-transition$/);if("paint"===t&&l&&s[l[1]]&&s[l[1]].transition)return _n({key:r,value:i,valueSpec:a.transition,style:n,styleSpec:a});var u,c=e.valueSpec||s[o];if(!c)return[new Ee(r,i,'unknown property "'+o+'"')];if("string"===Pr(i)&&Lr(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(i)))return[new Ee(r,i,'"'+o+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var f=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&f.push(new Ee(r,i,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&Dr(Ie(i))&&"identity"===Le(i.type)&&f.push(new Ee(r,i,'"text-font" does not support identity functions'))),f.concat(_n({key:e.key,value:i,valueSpec:c,style:n,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:o}))}function hn(e){return fn(e,"paint")}function pn(e){return fn(e,"layout")}function dn(e){var t=[],r=e.value,n=e.key,a=e.style,i=e.styleSpec;r.type||r.ref||t.push(new Ee(n,r,'either "type" or "ref" is required'));var o,s=Le(r.type),l=Le(r.ref);if(r.id)for(var u=Le(r.id),c=0;c<e.arrayIndex;c++){var f=a.layers[c];Le(f.id)===u&&t.push(new Ee(n,r.id,'duplicate layer id "'+r.id+'", previously used at line '+f.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(e){e in r&&t.push(new Ee(n,r[e],'"'+e+'" is prohibited for ref layers'))}),a.layers.forEach(function(e){Le(e.id)===l&&(o=e)}),o?o.ref?t.push(new Ee(n,r.ref,"ref cannot reference another ref layer")):s=Le(o.type):t.push(new Ee(n,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=a.sources&&a.sources[r.source],p=h&&Le(h.type);h?"vector"===p&&"raster"===s?t.push(new Ee(n,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===p&&"raster"!==s?t.push(new Ee(n,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==p||r["source-layer"]?"raster-dem"===p&&"hillshade"!==s?t.push(new Ee(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===p&&h.lineMetrics||t.push(new Ee(n,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Ee(n,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Ee(n,r.source,'source "'+r.source+'" not found'))}else t.push(new Ee(n,r,'missing required property "source"'));return t=t.concat(Xr({key:n,value:r,valueSpec:i.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return _n({key:n+".type",value:r.type,valueSpec:i.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:cn,layout:function(e){return Xr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return pn(Ce({layerType:s},e))}}})},paint:function(e){return Xr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return hn(Ce({layerType:s},e))}}})}}}))}function vn(e){var t=e.value,r=e.key,n=Pr(t);return"string"!==n?[new Ee(r,t,"string expected, "+n+" found")]:[]}var mn={promoteId:function(e){var t=e.key,r=e.value;if("string"===Pr(r))return vn({key:t,value:r});var n=[];for(var a in r)n.push.apply(n,vn({key:t+"."+a,value:r[a]}));return n}};function gn(e){var t=e.value,r=e.key,n=e.styleSpec,a=e.style;if(!t.type)return[new Ee(r,t,'"type" is required')];var i,o=Le(t.type);switch(o){case"vector":case"raster":case"raster-dem":return Xr({key:r,value:t,valueSpec:n["source_"+o.replace("-","_")],style:e.style,styleSpec:n,objectElementValidators:mn});case"geojson":if(i=Xr({key:r,value:t,valueSpec:n.source_geojson,style:a,styleSpec:n,objectElementValidators:mn}),t.cluster)for(var s in t.clusterProperties){var l=t.clusterProperties[s],u=l[0],c="string"==typeof u?[u,["accumulated"],["get",s]]:u;i.push.apply(i,Qr({key:r+"."+s+".map",value:l[1],expressionContext:"cluster-map"})),i.push.apply(i,Qr({key:r+"."+s+".reduce",value:c,expressionContext:"cluster-reduce"}))}return i;case"video":return Xr({key:r,value:t,valueSpec:n.source_video,style:a,styleSpec:n});case"image":return Xr({key:r,value:t,valueSpec:n.source_image,style:a,styleSpec:n});case"canvas":return[new Ee(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return $r({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:a,styleSpec:n})}}function yn(e){var t=e.value,r=e.styleSpec,n=r.light,a=e.style,i=[],o=Pr(t);if(void 0===t)return i;if("object"!==o)return i.concat([new Ee("light",t,"object expected, "+o+" found")]);for(var s in t){var l=s.match(/^(.*)-transition$/);i=i.concat(l&&n[l[1]]&&n[l[1]].transition?_n({key:s,value:t[s],valueSpec:r.transition,style:a,styleSpec:r}):n[s]?_n({key:s,value:t[s],valueSpec:n[s],style:a,styleSpec:r}):[new Ee(s,t[s],'unknown property "'+s+'"')])}return i}var xn={"*":function(){return[]},array:Zr,boolean:function(e){var t=e.value,r=e.key,n=Pr(t);return"boolean"!==n?[new Ee(r,t,"boolean expected, "+n+" found")]:[]},number:Kr,color:function(e){var t=e.key,r=e.value,n=Pr(r);return"string"!==n?[new Ee(t,r,"color expected, "+n+" found")]:null===Ke(r)?[new Ee(t,r,'color expected, "'+r+'" found')]:[]},constants:Se,enum:$r,filter:cn,function:Jr,layer:dn,object:Xr,source:gn,light:yn,string:vn,formatted:function(e){return 0===vn(e).length?[]:Qr(e)},resolvedImage:function(e){return 0===vn(e).length?[]:Qr(e)}};function _n(e){var t=e.value,r=e.valueSpec,n=e.styleSpec;return r.expression&&Dr(Le(t))?Jr(e):r.expression&&Hr(Ie(t))?Qr(e):r.type&&xn[r.type]?xn[r.type](e):Xr(Ce({},e,{valueSpec:r.type?n[r.type]:r}))}function bn(e){var t=e.value,r=e.key,n=vn(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new Ee(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new Ee(r,t,'"glyphs" url must include a "{range}" token'))),n}function wn(e,t){void 0===t&&(t=Me);var r=[];return r=r.concat(_n({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:bn,"*":function(){return[]}}})),e.constants&&(r=r.concat(Se({key:"constants",value:e.constants,style:e,styleSpec:t}))),Tn(r)}function Tn(e){return[].concat(e).sort(function(e,t){return e.line-t.line})}function kn(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Tn(e.apply(this,t))}}wn.source=kn(gn),wn.light=kn(yn),wn.layer=kn(dn),wn.filter=kn(cn),wn.paintProperty=kn(hn),wn.layoutProperty=kn(pn);var An=wn,Mn=An.light,En=An.paintProperty,Sn=An.layoutProperty;function Cn(e,t){var r=!1;if(t&&t.length)for(var n=0,a=t;n<a.length;n+=1)e.fire(new ke(new Error(a[n].message))),r=!0;return r}var Ln=In;function In(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var a=new Int32Array(this.arrayBuffer);e=a[0],this.d=(t=a[1])+2*(r=a[2]);for(var i=0;i<this.d*this.d;i++){var o=a[3+i],s=a[3+i+1];n.push(o===s?null:a.subarray(o,s))}var l=a[3+n.length+1];this.keys=a.subarray(a[3+n.length],l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var u=0;u<this.d*this.d;u++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var c=r/t*e;this.min=-c,this.max=e+c}In.prototype.insert=function(e,t,r,n,a){this._forEachCell(t,r,n,a,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)},In.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},In.prototype._insertCell=function(e,t,r,n,a,i){this.cells[a].push(i)},In.prototype.query=function(e,t,r,n,a){var i=this.min,o=this.max;if(e<=i&&t<=i&&o<=r&&o<=n&&!a)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,r,n,this._queryCell,s,{},a),s},In.prototype._queryCell=function(e,t,r,n,a,i,o,s){var l=this.cells[a];if(null!==l)for(var u=this.keys,c=this.bboxes,f=0;f<l.length;f++){var h=l[f];if(void 0===o[h]){var p=4*h;(s?s(c[p+0],c[p+1],c[p+2],c[p+3]):e<=c[p+2]&&t<=c[p+3]&&r>=c[p+0]&&n>=c[p+1])?(o[h]=!0,i.push(u[h])):o[h]=!1}}},In.prototype._forEachCell=function(e,t,r,n,a,i,o,s){for(var l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(r),f=this._convertToCellCoord(n),h=l;h<=c;h++)for(var p=u;p<=f;p++){var d=this.d*p+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(p),this._convertFromCellCoord(h+1),this._convertFromCellCoord(p+1)))&&a.call(this,e,t,r,n,d,i,o,s))return}},In.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},In.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},In.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var a=new Int32Array(t+r+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var i=t,o=0;o<e.length;o++){var s=e[o];a[3+o]=i,a.set(s,i),i+=s.length}return a[3+e.length]=i,a.set(this.keys,i),a[3+e.length+1]=i+=this.keys.length,a.set(this.bboxes,i),i+=this.bboxes.length,a.buffer};var On=self.ImageData,Pn=self.ImageBitmap,Dn={};function Rn(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Dn[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var zn in Rn("Object",Object),Ln.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Ln.deserialize=function(e){return new Ln(e.buffer)},Rn("Grid",Ln),Rn("Color",Je),Rn("Error",Error),Rn("ResolvedImage",tt),Rn("StylePropertyFunction",Wr),Rn("StyleExpression",Ur,{omit:["_evaluator"]}),Rn("ZoomDependentExpression",qr),Rn("ZoomConstantExpression",Gr),Rn("CompoundExpression",mt,{omit:["_evaluate"]}),Tr)Tr[zn]._classRegistryKey||Rn("Expression_"+zn,Tr[zn]);function Nn(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Fn(e){return Pn&&e instanceof Pn}function Bn(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Nn(e)||Fn(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof On)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var n=[],a=0,i=e;a<i.length;a+=1)n.push(Bn(i[a],t));return n}if("object"==typeof e){var o=e.constructor,s=o._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var l=o.serialize?o.serialize(e,t):{};if(!o.serialize){for(var u in e)if(e.hasOwnProperty(u)&&!(Dn[s].omit.indexOf(u)>=0)){var c=e[u];l[u]=Dn[s].shallow.indexOf(u)>=0?c:Bn(c,t)}e instanceof Error&&(l.message=e.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(l.$name=s),l}throw new Error("can't serialize object of type "+typeof e)}function jn(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Nn(e)||Fn(e)||ArrayBuffer.isView(e)||e instanceof On)return e;if(Array.isArray(e))return e.map(jn);if("object"==typeof e){var t=e.$name||"Object",r=Dn[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var n=Object.create(r.prototype),a=0,i=Object.keys(e);a<i.length;a+=1){var o=i[a];if("$name"!==o){var s=e[o];n[o]=Dn[t].shallow.indexOf(o)>=0?s:jn(s)}}return n}throw new Error("can't deserialize object of type "+typeof e)}var Un=function(){this.first=!0};Un.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Hn={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Vn(e){for(var t=0,r=e;t<r.length;t+=1)if(Gn(r[t].charCodeAt(0)))return!0;return!1}function Gn(e){return!(746!==e&&747!==e&&(e<4352||!(Hn["Bopomofo Extended"](e)||Hn.Bopomofo(e)||Hn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Hn["CJK Compatibility Ideographs"](e)||Hn["CJK Compatibility"](e)||Hn["CJK Radicals Supplement"](e)||Hn["CJK Strokes"](e)||!(!Hn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||Hn["CJK Unified Ideographs Extension A"](e)||Hn["CJK Unified Ideographs"](e)||Hn["Enclosed CJK Letters and Months"](e)||Hn["Hangul Compatibility Jamo"](e)||Hn["Hangul Jamo Extended-A"](e)||Hn["Hangul Jamo Extended-B"](e)||Hn["Hangul Jamo"](e)||Hn["Hangul Syllables"](e)||Hn.Hiragana(e)||Hn["Ideographic Description Characters"](e)||Hn.Kanbun(e)||Hn["Kangxi Radicals"](e)||Hn["Katakana Phonetic Extensions"](e)||Hn.Katakana(e)&&12540!==e||!(!Hn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Hn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Hn["Unified Canadian Aboriginal Syllabics"](e)||Hn["Unified Canadian Aboriginal Syllabics Extended"](e)||Hn["Vertical Forms"](e)||Hn["Yijing Hexagram Symbols"](e)||Hn["Yi Syllables"](e)||Hn["Yi Radicals"](e))))}function qn(e){return!(Gn(e)||function(e){return!!(Hn["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Hn["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Hn["Letterlike Symbols"](e)||Hn["Number Forms"](e)||Hn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Hn["Control Pictures"](e)&&9251!==e||Hn["Optical Character Recognition"](e)||Hn["Enclosed Alphanumerics"](e)||Hn["Geometric Shapes"](e)||Hn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Hn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Hn["CJK Symbols and Punctuation"](e)||Hn.Katakana(e)||Hn["Private Use Area"](e)||Hn["CJK Compatibility Forms"](e)||Hn["Small Form Variants"](e)||Hn["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function Yn(e){return e>=1424&&e<=2303||Hn["Arabic Presentation Forms-A"](e)||Hn["Arabic Presentation Forms-B"](e)}function Wn(e,t){return!(!t&&Yn(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Hn.Khmer(e))}function Xn(e){for(var t=0,r=e;t<r.length;t+=1)if(Yn(r[t].charCodeAt(0)))return!0;return!1}var Zn=null,Kn="unavailable",Jn=null,Qn=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Kn="error"),Zn&&Zn(e)};function $n(){ea.fire(new Te("pluginStateChange",{pluginStatus:Kn,pluginURL:Jn}))}var ea=new Ae,ta=function(){return Kn},ra=function(){if("deferred"!==Kn||!Jn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Kn="loading",$n(),Jn&&ye({url:Jn},function(e){e?Qn(e):(Kn="loaded",$n())})},na={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Kn||null!=na.applyArabicShaping},isLoading:function(){return"loading"===Kn},setState:function(e){Kn=e.pluginStatus,Jn=e.pluginURL},isParsed:function(){return null!=na.applyArabicShaping&&null!=na.processBidirectionalText&&null!=na.processStyledBidirectionalText},getPluginURL:function(){return Jn}},aa=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Un,this.transition={})};aa.prototype.isSupportedScript=function(e){return function(e,t){for(var r=0,n=e;r<n.length;r+=1)if(!Wn(n[r].charCodeAt(0),t))return!1;return!0}(e,na.isLoaded())},aa.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},aa.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var ia=function(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Dr(e))return new Wr(e,t);if(Hr(e)){var r=Yr(e,t);if("error"===r.result)throw new Error(r.value.map(function(e){return e.key+": "+e.message}).join(", "));return r.value}var n=e;return"string"==typeof e&&"color"===t.type&&(n=Je.parse(e)),{kind:"constant",evaluate:function(){return n}}}(void 0===t?e.specification.default:t,e.specification)};ia.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ia.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var oa=function(e){this.property=e,this.value=new ia(e,void 0)};oa.prototype.transitioned=function(e,t){return new la(this.property,this.value,t,c({},e.transition,this.transition),e.now)},oa.prototype.untransitioned=function(){return new la(this.property,this.value,null,{},0)};var sa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};sa.prototype.getValue=function(e){return x(this._values[e].value.value)},sa.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new oa(this._values[e].property)),this._values[e].value=new ia(this._values[e].property,null===t?void 0:x(t))},sa.prototype.getTransition=function(e){return x(this._values[e].transition)},sa.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new oa(this._values[e].property)),this._values[e].transition=x(t)||void 0},sa.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],a=this.getValue(n);void 0!==a&&(e[n]=a);var i=this.getTransition(n);void 0!==i&&(e[n+"-transition"]=i)}return e},sa.prototype.transitioned=function(e,t){for(var r=new ua(this._properties),n=0,a=Object.keys(this._values);n<a.length;n+=1){var i=a[n];r._values[i]=this._values[i].transitioned(e,t._values[i])}return r},sa.prototype.untransitioned=function(){for(var e=new ua(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t];e._values[n]=this._values[n].untransitioned()}return e};var la=function(e,t,r,n,a){this.property=e,this.value=t,this.begin=a+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};la.prototype.possiblyEvaluate=function(e,t,r){var n=e.now||0,a=this.value.possiblyEvaluate(e,t,r),i=this.prior;if(i){if(n>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(n<this.begin)return i.possiblyEvaluate(e,t,r);var o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(e,t,r),a,function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}(o))}return a};var ua=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};ua.prototype.possiblyEvaluate=function(e,t,r){for(var n=new ha(this._properties),a=0,i=Object.keys(this._values);a<i.length;a+=1){var o=i[a];n._values[o]=this._values[o].possiblyEvaluate(e,t,r)}return n},ua.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ca=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ca.prototype.getValue=function(e){return x(this._values[e].value)},ca.prototype.setValue=function(e,t){this._values[e]=new ia(this._values[e].property,null===t?void 0:x(t))},ca.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],a=this.getValue(n);void 0!==a&&(e[n]=a)}return e},ca.prototype.possiblyEvaluate=function(e,t,r){for(var n=new ha(this._properties),a=0,i=Object.keys(this._values);a<i.length;a+=1){var o=i[a];n._values[o]=this._values[o].possiblyEvaluate(e,t,r)}return n};var fa=function(e,t,r){this.property=e,this.value=t,this.parameters=r};fa.prototype.isConstant=function(){return"constant"===this.value.kind},fa.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},fa.prototype.evaluate=function(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)};var ha=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ha.prototype.get=function(e){return this._values[e]};var pa=function(e){this.specification=e};pa.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},pa.prototype.interpolate=function(e,t,r){var n=Ht[this.specification.type];return n?n(e,t,r):e};var da=function(e,t){this.specification=e,this.overrides=t};da.prototype.possiblyEvaluate=function(e,t,r,n){return new fa(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)},da.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new fa(this,{kind:"constant",value:void 0},e.parameters);var n=Ht[this.specification.type];return n?new fa(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e},da.prototype.evaluate=function(e,t,r,n,a,i){return"constant"===e.kind?e.value:e.evaluate(t,r,n,a,i)};var va=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(e,t,r,n){if(void 0===e.value)return new fa(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){var a=e.expression.evaluate(t,null,{},r,n),i="resolvedImage"===e.property.specification.type&&"string"!=typeof a?a.name:a,o=this._calculate(i,i,i,t);return new fa(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){var s=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new fa(this,{kind:"constant",value:s},t)}return new fa(this,e.expression,t)},t.prototype.evaluate=function(e,t,r,n,a,i){if("source"===e.kind){var o=e.evaluate(t,r,n,a,i);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value},t.prototype._calculate=function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},t.prototype.interpolate=function(e){return e},t}(da),ma=function(e){this.specification=e};ma.prototype.possiblyEvaluate=function(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){var a=e.expression.evaluate(t,null,{},r,n);return this._calculate(a,a,a,t)}return this._calculate(e.expression.evaluate(new aa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new aa(Math.floor(t.zoom),t)),e.expression.evaluate(new aa(Math.floor(t.zoom+1),t)),t)}},ma.prototype._calculate=function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},ma.prototype.interpolate=function(e){return e};var ga=function(e){this.specification=e};ga.prototype.possiblyEvaluate=function(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)},ga.prototype.interpolate=function(){return!1};var ya=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var n=this.defaultPropertyValues[t]=new ia(r,void 0),a=this.defaultTransitionablePropertyValues[t]=new oa(r);this.defaultTransitioningPropertyValues[t]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}};Rn("DataDrivenProperty",da),Rn("DataConstantProperty",pa),Rn("CrossFadedDataDrivenProperty",va),Rn("CrossFadedProperty",ma),Rn("ColorRampProperty",ga);var xa=function(e){function t(t,r){if(e.call(this),this.id=t.id,this.type=t.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new ca(r.layout)),r.paint)){for(var n in this._transitionablePaint=new sa(r.paint),t.paint)this.setPaintProperty(n,t.paint[n],{validate:!1});for(var a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ha(r.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(e,t,r){void 0===r&&(r={}),null!=t&&this._validate(Sn,"layers."+this.id+".layout."+e,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)},t.prototype.getPaintProperty=function(e){return m(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-"-transition".length)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(e,t,r){if(void 0===r&&(r={}),null!=t&&this._validate(En,"layers."+this.id+".paint."+e,e,t,r))return!1;if(m(e,"-transition"))return this._transitionablePaint.setTransition(e.slice(0,-"-transition".length),t||void 0),!1;var n=this._transitionablePaint._values[e],a="cross-faded-data-driven"===n.property.specification["property-type"],i=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||i||a||this._handleOverridablePaintPropertyUpdate(e,o,s)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){},t.prototype._handleOverridablePaintPropertyUpdate=function(e,t,r){return!1},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),y(e,function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)})},t.prototype._validate=function(e,t,r,n,a){return void 0===a&&(a={}),(!a||!1!==a.validate)&&Cn(this,e.call(An,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:Me,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof fa&&Lr(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1},t}(Ae),_a={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ba=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},wa=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ta(e,t){void 0===t&&(t=1);var r=0,n=0;return{members:e.map(function(e){var a=_a[e.type].BYTES_PER_ELEMENT,i=r=ka(r,Math.max(t,a)),o=e.components||1;return n=Math.max(n,a),r+=a*o,{name:e.name,type:e.type,components:o,offset:i}}),size:ka(r,Math.max(n,t)),alignment:t}}function ka(e,t){return Math.ceil(e/t)*t}wa.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},wa.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},wa.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},wa.prototype.clear=function(){this.length=0},wa.prototype.resize=function(e){this.reserve(e),this.length=e},wa.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},wa.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Aa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},t.prototype.emplace=function(e,t,r){var n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e},t}(wa);Aa.prototype.bytesPerElement=4,Rn("StructArrayLayout2i4",Aa);var Ma=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)},t.prototype.emplace=function(e,t,r,n,a){var i=4*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,this.int16[i+3]=a,e},t}(wa);Ma.prototype.bytesPerElement=8,Rn("StructArrayLayout4i8",Ma);var Ea=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,a,i)},t.prototype.emplace=function(e,t,r,n,a,i,o){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=a,this.int16[s+4]=i,this.int16[s+5]=o,e},t}(wa);Ea.prototype.bytesPerElement=12,Rn("StructArrayLayout2i4i12",Ea);var Sa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,a,i)},t.prototype.emplace=function(e,t,r,n,a,i,o){var s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.uint8[l+4]=n,this.uint8[l+5]=a,this.uint8[l+6]=i,this.uint8[l+7]=o,e},t}(wa);Sa.prototype.bytesPerElement=8,Rn("StructArrayLayout2i4ub8",Sa);var Ca=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i,o,s,l,u){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,a,i,o,s,l,u)},t.prototype.emplace=function(e,t,r,n,a,i,o,s,l,u,c){var f=9*e,h=18*e;return this.uint16[f+0]=t,this.uint16[f+1]=r,this.uint16[f+2]=n,this.uint16[f+3]=a,this.uint16[f+4]=i,this.uint16[f+5]=o,this.uint16[f+6]=s,this.uint16[f+7]=l,this.uint8[h+16]=u,this.uint8[h+17]=c,e},t}(wa);Ca.prototype.bytesPerElement=18,Rn("StructArrayLayout8ui2ub18",Ca);var La=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i,o,s,l,u,c,f){var h=this.length;return this.resize(h+1),this.emplace(h,e,t,r,n,a,i,o,s,l,u,c,f)},t.prototype.emplace=function(e,t,r,n,a,i,o,s,l,u,c,f,h){var p=12*e;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=a,this.uint16[p+4]=i,this.uint16[p+5]=o,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=u,this.int16[p+9]=c,this.int16[p+10]=f,this.int16[p+11]=h,e},t}(wa);La.prototype.bytesPerElement=24,Rn("StructArrayLayout4i4ui4i24",La);var Ia=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var a=3*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,e},t}(wa);Ia.prototype.bytesPerElement=12,Rn("StructArrayLayout3f12",Ia);var Oa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.uint32[1*e+0]=t,e},t}(wa);Oa.prototype.bytesPerElement=4,Rn("StructArrayLayout1ul4",Oa);var Pa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i,o,s,l){var u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,a,i,o,s,l)},t.prototype.emplace=function(e,t,r,n,a,i,o,s,l,u){var c=10*e,f=5*e;return this.int16[c+0]=t,this.int16[c+1]=r,this.int16[c+2]=n,this.int16[c+3]=a,this.int16[c+4]=i,this.int16[c+5]=o,this.uint32[f+3]=s,this.uint16[c+8]=l,this.uint16[c+9]=u,e},t}(wa);Pa.prototype.bytesPerElement=20,Rn("StructArrayLayout6i1ul2ui20",Pa);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,a,i)},t.prototype.emplace=function(e,t,r,n,a,i,o){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=a,this.int16[s+4]=i,this.int16[s+5]=o,e},t}(wa);Da.prototype.bytesPerElement=12,Rn("StructArrayLayout2i2i2i12",Da);var Ra=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n,a)},t.prototype.emplace=function(e,t,r,n,a,i){var o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.int16[s+6]=a,this.int16[s+7]=i,e},t}(wa);Ra.prototype.bytesPerElement=16,Rn("StructArrayLayout2f1f2i16",Ra);var za=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)},t.prototype.emplace=function(e,t,r,n,a){var i=12*e,o=3*e;return this.uint8[i+0]=t,this.uint8[i+1]=r,this.float32[o+1]=n,this.float32[o+2]=a,e},t}(wa);za.prototype.bytesPerElement=12,Rn("StructArrayLayout2ub2f12",za);var Na=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var a=3*e;return this.uint16[a+0]=t,this.uint16[a+1]=r,this.uint16[a+2]=n,e},t}(wa);Na.prototype.bytesPerElement=6,Rn("StructArrayLayout3ui6",Na);var Fa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m){var g=this.length;return this.resize(g+1),this.emplace(g,e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m)},t.prototype.emplace=function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m,g){var y=24*e,x=12*e,_=48*e;return this.int16[y+0]=t,this.int16[y+1]=r,this.uint16[y+2]=n,this.uint16[y+3]=a,this.uint32[x+2]=i,this.uint32[x+3]=o,this.uint32[x+4]=s,this.uint16[y+10]=l,this.uint16[y+11]=u,this.uint16[y+12]=c,this.float32[x+7]=f,this.float32[x+8]=h,this.uint8[_+36]=p,this.uint8[_+37]=d,this.uint8[_+38]=v,this.uint32[x+10]=m,this.int16[y+22]=g,e},t}(wa);Fa.prototype.bytesPerElement=48,Rn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Fa);var Ba=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m,g,y,x,_,b,w,T,k,A,M,E){var S=this.length;return this.resize(S+1),this.emplace(S,e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m,g,y,x,_,b,w,T,k,A,M,E)},t.prototype.emplace=function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m,g,y,x,_,b,w,T,k,A,M,E,S){var C=34*e,L=17*e;return this.int16[C+0]=t,this.int16[C+1]=r,this.int16[C+2]=n,this.int16[C+3]=a,this.int16[C+4]=i,this.int16[C+5]=o,this.int16[C+6]=s,this.int16[C+7]=l,this.uint16[C+8]=u,this.uint16[C+9]=c,this.uint16[C+10]=f,this.uint16[C+11]=h,this.uint16[C+12]=p,this.uint16[C+13]=d,this.uint16[C+14]=v,this.uint16[C+15]=m,this.uint16[C+16]=g,this.uint16[C+17]=y,this.uint16[C+18]=x,this.uint16[C+19]=_,this.uint16[C+20]=b,this.uint16[C+21]=w,this.uint16[C+22]=T,this.uint32[L+12]=k,this.float32[L+13]=A,this.float32[L+14]=M,this.float32[L+15]=E,this.float32[L+16]=S,e},t}(wa);Ba.prototype.bytesPerElement=68,Rn("StructArrayLayout8i15ui1ul4f68",Ba);var ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.float32[1*e+0]=t,e},t}(wa);ja.prototype.bytesPerElement=4,Rn("StructArrayLayout1f4",ja);var Ua=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var a=3*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,e},t}(wa);Ua.prototype.bytesPerElement=6,Rn("StructArrayLayout3i6",Ua);var Ha=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)},t.prototype.emplace=function(e,t,r,n){var a=4*e;return this.uint32[2*e+0]=t,this.uint16[a+2]=r,this.uint16[a+3]=n,e},t}(wa);Ha.prototype.bytesPerElement=8,Rn("StructArrayLayout1ul2ui8",Ha);var Va=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},t.prototype.emplace=function(e,t,r){var n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e},t}(wa);Va.prototype.bytesPerElement=4,Rn("StructArrayLayout2ui4",Va);var Ga=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.uint16[1*e+0]=t,e},t}(wa);Ga.prototype.bytesPerElement=2,Rn("StructArrayLayout1ui2",Ga);var qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},t.prototype.emplace=function(e,t,r){var n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e},t}(wa);qa.prototype.bytesPerElement=8,Rn("StructArrayLayout2f8",qa);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)},t.prototype.emplace=function(e,t,r,n,a){var i=4*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,this.float32[i+3]=a,e},t}(wa);Ya.prototype.bytesPerElement=16,Rn("StructArrayLayout4f16",Ya);var Wa=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new a(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(ba);Wa.prototype.size=20;var Xa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new Wa(this,e)},t}(Pa);Rn("CollisionBoxArray",Xa);var Za=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(e){this._structArray.uint8[this._pos1+37]=e},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(e){this._structArray.uint8[this._pos1+38]=e},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(ba);Za.prototype.size=48;var Ka=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new Za(this,e)},t}(Fa);Rn("PlacedSymbolArray",Ka);var Ja=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+12]=e},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(ba);Ja.prototype.size=68;var Qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new Ja(this,e)},t}(Ba);Rn("SymbolInstanceArray",Qa);var $a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t}(ja);Rn("GlyphOffsetArray",$a);var ei=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t}(Ua);Rn("SymbolLineVertexArray",ei);var ti=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(ba);ti.prototype.size=8;var ri=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new ti(this,e)},t}(Ha);Rn("FeatureIndexArray",ri);var ni=Ta([{name:"a_pos",components:2,type:"Int16"}],4).members,ai=function(e){void 0===e&&(e=[]),this.segments=e};function ii(e,t){return 256*(e=l(Math.floor(e),0,255))+l(Math.floor(t),0,255)}ai.prototype.prepareSegment=function(e,t,r,n){var a=this.segments[this.segments.length-1];return e>ai.MAX_VERTEX_ARRAY_LENGTH&&b("Max vertices per segment is "+ai.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!a||a.vertexLength+e>ai.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==n)&&(a={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(a.sortKey=n),this.segments.push(a)),a},ai.prototype.get=function(){return this.segments},ai.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var n in r.vaos)r.vaos[n].destroy()}},ai.simpleSegment=function(e,t,r,n){return new ai([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])},ai.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn("SegmentVector",ai);var oi=Ta([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),si=t(function(e){e.exports=function(e,t){var r,n,a,i,o,s,l,u;for(n=e.length-(r=3&e.length),a=t,o=3432918353,s=461845907,u=0;u<n;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,a=27492+(65535&(i=5*(65535&(a=(a^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:a^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0}}),li=t(function(e){e.exports=function(e,t){for(var r,n=e.length,a=t^n,i=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+((1540483477*(r>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++i;switch(n){case 3:a^=(255&e.charCodeAt(i+2))<<16;case 2:a^=(255&e.charCodeAt(i+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(i)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0}}),ui=si,ci=li;ui.murmur3=si,ui.murmur2=ci;var fi=function(){this.ids=[],this.positions=[],this.indexed=!1};fi.prototype.add=function(e,t,r,n){this.ids.push(pi(e)),this.positions.push(t,r,n)},fi.prototype.getPositions=function(e){for(var t=pi(e),r=0,n=this.ids.length-1;r<n;){var a=r+n>>1;this.ids[a]>=t?n=a:r=a+1}for(var i=[];this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i},fi.serialize=function(e,t){var r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return function e(t,r,n,a){for(;n<a;){for(var i=t[n+a>>1],o=n-1,s=a+1;;){do{o++}while(t[o]<i);do{s--}while(t[s]>i);if(o>=s)break;di(t,o,s),di(r,3*o,3*s),di(r,3*o+1,3*s+1),di(r,3*o+2,3*s+2)}s-n<a-s?(e(t,r,n,s),n=s+1):(e(t,r,s+1,a),a=s)}}(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}},fi.deserialize=function(e){var t=new fi;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var hi=Math.pow(2,53)-1;function pi(e){var t=+e;return!isNaN(t)&&t<=hi?t:ui(String(e))}function di(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}Rn("FeaturePositionMap",fi);var vi=function(e,t){this.gl=e.gl,this.location=t},mi=function(e){function t(t,r){e.call(this,t,r),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))},t}(vi),gi=function(e){function t(t,r){e.call(this,t,r),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))},t}(vi),yi=function(e){function t(t,r){e.call(this,t,r),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))},t}(vi),xi=function(e){function t(t,r){e.call(this,t,r),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))},t}(vi),_i=function(e){function t(t,r){e.call(this,t,r),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))},t}(vi),bi=function(e){function t(t,r){e.call(this,t,r),this.current=Je.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))},t}(vi),wi=new Float32Array(16),Ti=function(e){function t(t,r){e.call(this,t,r),this.current=wi}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(var t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}},t}(vi);function ki(e){return[ii(255*e.r,255*e.g),ii(255*e.b,255*e.a)]}var Ai=function(e,t,r){this.value=e,this.uniformNames=t.map(function(e){return"u_"+e}),this.type=r};Ai.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Ai.prototype.getBinding=function(e,t,r){return"color"===this.type?new bi(e,t):new gi(e,t)};var Mi=function(e,t){this.uniformNames=t.map(function(e){return"u_"+e}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Mi.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Mi.prototype.setUniform=function(e,t,r,n){var a="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;a&&e.set(a)},Mi.prototype.getBinding=function(e,t,r){return"u_pattern"===r.substr(0,9)?new _i(e,t):new gi(e,t)};var Ei=function(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(e){return{name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new n};Ei.prototype.populatePaintArray=function(e,t,r,n,a){var i=this.paintVertexArray.length,o=this.expression.evaluate(new aa(0),t,{},n,[],a);this.paintVertexArray.resize(e),this._setPaintValue(i,e,o)},Ei.prototype.updatePaintArray=function(e,t,r,n){var a=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,a)},Ei.prototype._setPaintValue=function(e,t,r){if("color"===this.type)for(var n=ki(r),a=e;a<t;a++)this.paintVertexArray.emplace(a,n[0],n[1]);else{for(var i=e;i<t;i++)this.paintVertexArray.emplace(i,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Ei.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ei.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Si=function(e,t,r,n,a,i){this.expression=e,this.uniformNames=t.map(function(e){return"u_"+e+"_t"}),this.type=r,this.useIntegerZoom=n,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=t.map(function(e){return{name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new i};Si.prototype.populatePaintArray=function(e,t,r,n,a){var i=this.expression.evaluate(new aa(this.zoom),t,{},n,[],a),o=this.expression.evaluate(new aa(this.zoom+1),t,{},n,[],a),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,i,o)},Si.prototype.updatePaintArray=function(e,t,r,n){var a=this.expression.evaluate({zoom:this.zoom},r,n),i=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,a,i)},Si.prototype._setPaintValue=function(e,t,r,n){if("color"===this.type)for(var a=ki(r),i=ki(n),o=e;o<t;o++)this.paintVertexArray.emplace(o,a[0],a[1],i[0],i[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}},Si.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Si.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=l(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)},Si.prototype.getBinding=function(e,t,r){return new gi(e,t)};var Ci=function(e,t,r,n,a,i){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=i,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a};Ci.prototype.populatePaintArray=function(e,t,r){var n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)},Ci.prototype.updatePaintArray=function(e,t,r,n,a){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],a)},Ci.prototype._setPaintValues=function(e,t,r,n){if(n&&r){var a=n[r.min],i=n[r.mid],o=n[r.max];if(a&&i&&o)for(var s=e;s<t;s++)this.zoomInPaintVertexArray.emplace(s,i.tl[0],i.tl[1],i.br[0],i.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],i.pixelRatio,a.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,i.tl[0],i.tl[1],i.br[0],i.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],i.pixelRatio,o.pixelRatio)}},Ci.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,oi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,oi.members,this.expression.isStateDependent))},Ci.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Li=function(e,t,r,n){this.binders={},this.layoutAttributes=n,this._buffers=[];var a=[];for(var i in e.paint._values)if(r(i)){var o=e.paint.get(i);if(o instanceof fa&&Lr(o.property.specification)){var s=Oi(i,e.type),l=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,f=o.property.specification["property-type"],h="cross-faded"===f||"cross-faded-data-driven"===f;if("constant"===l.kind)this.binders[i]=h?new Mi(l.value,s):new Ai(l.value,s,u),a.push("/u_"+i);else if("source"===l.kind||h){var p=Pi(i,u,"source");this.binders[i]=h?new Ci(l,u,c,t,p,e.id):new Ei(l,s,u,p),a.push("/a_"+i)}else{var d=Pi(i,u,"composite");this.binders[i]=new Si(l,s,u,c,t,d),a.push("/z_"+i)}}}this.cacheKey=a.sort().join("")};Li.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ei||t instanceof Si?t.maxValue:0},Li.prototype.populatePaintArrays=function(e,t,r,n,a){for(var i in this.binders){var o=this.binders[i];(o instanceof Ei||o instanceof Si||o instanceof Ci)&&o.populatePaintArray(e,t,r,n,a)}},Li.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var n=this.binders[r];n instanceof Mi&&n.setConstantPatternPositions(e,t)}},Li.prototype.updatePaintArrays=function(e,t,r,n,a){var i=!1;for(var o in e)for(var s=0,l=t.getPositions(o);s<l.length;s+=1){var u=l[s],c=r.feature(u.index);for(var f in this.binders){var h=this.binders[f];if((h instanceof Ei||h instanceof Si||h instanceof Ci)&&!0===h.expression.isStateDependent){var p=n.paint.get(f);h.expression=p.value,h.updatePaintArray(u.start,u.end,c,e[o],a),i=!0}}}return i},Li.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Ai||r instanceof Mi)&&e.push.apply(e,r.uniformNames.map(function(e){return"#define HAS_UNIFORM_"+e}))}return e},Li.prototype.getPaintVertexBuffers=function(){return this._buffers},Li.prototype.getUniforms=function(e,t){var r=[];for(var n in this.binders){var a=this.binders[n];if(a instanceof Ai||a instanceof Mi||a instanceof Si)for(var i=0,o=a.uniformNames;i<o.length;i+=1){var s=o[i];if(t[s]){var l=a.getBinding(e,t[s],s);r.push({name:s,property:n,binding:l})}}}return r},Li.prototype.setUniforms=function(e,t,r,n){for(var a=0,i=t;a<i.length;a+=1){var o=i[a],s=o.name,l=o.property;this.binders[l].setUniform(o.binding,n,r.get(l),s)}},Li.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ci){var n=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(r instanceof Ei||r instanceof Si)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Li.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof Ei||r instanceof Si||r instanceof Ci)&&r.upload(e)}this.updatePaintBuffers()},Li.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ei||t instanceof Si||t instanceof Ci)&&t.destroy()}};var Ii=function(e,t,r,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var a=0,i=t;a<i.length;a+=1){var o=i[a];this.programConfigurations[o.id]=new Li(o,r,n,e)}this.needsUpload=!1,this._featureMap=new fi,this._bufferOffset=0};function Oi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Pi(e,t,r){var n={color:{source:qa,composite:Ya},number:{source:ja,composite:qa}},a=function(e){return{"line-pattern":{source:Ca,composite:Ca},"fill-pattern":{source:Ca,composite:Ca},"fill-extrusion-pattern":{source:Ca,composite:Ca}}[e]}(e);return a&&a[r]||n[t][r]}Ii.prototype.populatePaintArrays=function(e,t,r,n,a,i){for(var o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(e,t,n,a,i);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ii.prototype.updatePaintArrays=function(e,t,r,n){for(var a=0,i=r;a<i.length;a+=1){var o=i[a];this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,t,o,n)||this.needsUpload}},Ii.prototype.get=function(e){return this.programConfigurations[e]},Ii.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ii.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Rn("ConstantBinder",Ai),Rn("CrossFadedConstantBinder",Mi),Rn("SourceExpressionBinder",Ei),Rn("CrossFadedCompositeBinder",Ci),Rn("CompositeExpressionBinder",Si),Rn("ProgramConfiguration",Li,{omit:["_buffers"]}),Rn("ProgramConfigurationSet",Ii);var Di={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function Ri(e){for(var t=8192/e.extent,r=e.loadGeometry(),n=0;n<r.length;n++)for(var a=r[n],i=0;i<a.length;i++){var o=a[i];o.x=Math.round(o.x*t),o.y=Math.round(o.y*t),(o.x<Di.min||o.x>Di.max||o.y<Di.min||o.y>Di.max)&&(b("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o.x=l(o.x,Di.min,Di.max),o.y=l(o.y,Di.min,Di.max))}return r}function zi(e,t,r,n,a){e.emplaceBack(2*t+(n+1)/2,2*r+(a+1)/2)}var Ni=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Aa,this.indexArray=new Na,this.segments=new ai,this.programConfigurations=new Ii(ni,e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function Fi(e,t){for(var r=0;r<e.length;r++)if(Wi(t,e[r]))return!0;for(var n=0;n<t.length;n++)if(Wi(e,t[n]))return!0;return!!Hi(e,t)}function Bi(e,t,r){return!!Wi(e,t)||!!Gi(t,e,r)}function ji(e,t){if(1===e.length)return Yi(t,e[0]);for(var r=0;r<t.length;r++)for(var n=t[r],a=0;a<n.length;a++)if(Wi(e,n[a]))return!0;for(var i=0;i<e.length;i++)if(Yi(t,e[i]))return!0;for(var o=0;o<t.length;o++)if(Hi(e,t[o]))return!0;return!1}function Ui(e,t,r){if(e.length>1){if(Hi(e,t))return!0;for(var n=0;n<t.length;n++)if(Gi(t[n],e,r))return!0}for(var a=0;a<e.length;a++)if(Gi(e[a],t,r))return!0;return!1}function Hi(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var n=e[r],a=e[r+1],i=0;i<t.length-1;i++)if(Vi(n,a,t[i],t[i+1]))return!0;return!1}function Vi(e,t,r,n){return w(e,r,n)!==w(t,r,n)&&w(e,t,r)!==w(e,t,n)}function Gi(e,t,r){var n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(var a=1;a<t.length;a++)if(qi(e,t[a-1],t[a])<n)return!0;return!1}function qi(e,t,r){var n=t.distSqr(r);if(0===n)return e.distSqr(t);var a=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(a<0?t:a>1?r:r.sub(t)._mult(a)._add(t))}function Yi(e,t){for(var r,n,a,i=!1,o=0;o<e.length;o++)for(var s=0,l=(r=e[o]).length-1;s<r.length;l=s++)(n=r[s]).y>t.y!=(a=r[l]).y>t.y&&t.x<(a.x-n.x)*(t.y-n.y)/(a.y-n.y)+n.x&&(i=!i);return i}function Wi(e,t){for(var r=!1,n=0,a=e.length-1;n<e.length;a=n++){var i=e[n],o=e[a];i.y>t.y!=o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function Xi(e,t,r){var n=r[0],a=r[2];if(e.x<n.x&&t.x<n.x||e.x>a.x&&t.x>a.x||e.y<n.y&&t.y<n.y||e.y>a.y&&t.y>a.y)return!1;var i=w(e,t,r[0]);return i!==w(e,t,r[1])||i!==w(e,t,r[2])||i!==w(e,t,r[3])}function Zi(e,t,r){var n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Ki(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ji(e,t,r,n,i){if(!t[0]&&!t[1])return e;var o=a.convert(t)._mult(i);"viewport"===r&&o._rotate(-n);for(var s=[],l=0;l<e.length;l++)s.push(e[l].sub(o));return s}Ni.prototype.populate=function(e,t,r){var n=this.layers[0],a=[],i=null;"circle"===n.type&&(i=n.layout.get("circle-sort-key"));for(var o=0,s=e;o<s.length;o+=1){var l=s[o],u=l.feature,c=l.id,f=l.index,h=l.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,d={type:u.type,id:c,properties:u.properties,geometry:p?Ri(u):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),d,r)){p||(d.geometry=Ri(u));var v=i?i.evaluate(d,{},r):void 0;a.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:f,geometry:d.geometry,patterns:{},sortKey:v})}}i&&a.sort(function(e,t){return e.sortKey-t.sortKey});for(var m=0,g=a;m<g.length;m+=1){var y=g[m],x=y.geometry,_=y.index,b=y.sourceLayerIndex,w=e[_].feature;this.addFeature(y,x,_,r),t.featureIndex.insert(w,x,_,b,this.index)}},Ni.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ni.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ni.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ni.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ni),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ni.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ni.prototype.addFeature=function(e,t,r,n){for(var a=0,i=t;a<i.length;a+=1)for(var o=0,s=i[a];o<s.length;o+=1){var l=s[o],u=l.x,c=l.y;if(!(u<0||u>=8192||c<0||c>=8192)){var f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),h=f.vertexLength;zi(this.layoutVertexArray,u,c,-1,-1),zi(this.layoutVertexArray,u,c,1,-1),zi(this.layoutVertexArray,u,c,1,1),zi(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),f.vertexLength+=4,f.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)},Rn("CircleBucket",Ni,{omit:["layers"]});var Qi=new ya({"circle-sort-key":new da(Me.layout_circle["circle-sort-key"])}),$i={paint:new ya({"circle-radius":new da(Me.paint_circle["circle-radius"]),"circle-color":new da(Me.paint_circle["circle-color"]),"circle-blur":new da(Me.paint_circle["circle-blur"]),"circle-opacity":new da(Me.paint_circle["circle-opacity"]),"circle-translate":new pa(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new pa(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pa(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pa(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new da(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new da(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new da(Me.paint_circle["circle-stroke-opacity"])}),layout:Qi},eo="undefined"!=typeof Float32Array?Float32Array:Array;function to(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ro(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],p=t[10],d=t[11],v=t[12],m=t[13],g=t[14],y=t[15],x=r[0],_=r[1],b=r[2],w=r[3];return e[0]=x*n+_*s+b*f+w*v,e[1]=x*a+_*l+b*h+w*m,e[2]=x*i+_*u+b*p+w*g,e[3]=x*o+_*c+b*d+w*y,e[4]=(x=r[4])*n+(_=r[5])*s+(b=r[6])*f+(w=r[7])*v,e[5]=x*a+_*l+b*h+w*m,e[6]=x*i+_*u+b*p+w*g,e[7]=x*o+_*c+b*d+w*y,e[8]=(x=r[8])*n+(_=r[9])*s+(b=r[10])*f+(w=r[11])*v,e[9]=x*a+_*l+b*h+w*m,e[10]=x*i+_*u+b*p+w*g,e[11]=x*o+_*c+b*d+w*y,e[12]=(x=r[12])*n+(_=r[13])*s+(b=r[14])*f+(w=r[15])*v,e[13]=x*a+_*l+b*h+w*m,e[14]=x*i+_*u+b*p+w*g,e[15]=x*o+_*c+b*d+w*y,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var no,ao=ro;function io(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,e}no=new eo(3),eo!=Float32Array&&(no[0]=0,no[1]=0,no[2]=0),function(){var e=new eo(4);eo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var oo=(function(){var e=new eo(2);eo!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(t){e.call(this,t,$i)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new Ni(e)},t.prototype.queryRadius=function(e){var t=e;return Zi("circle-radius",this,t)+Zi("circle-stroke-width",this,t)+Ki(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,a,i,o,s){for(var l=Ji(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,o),u=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),c="map"===this.paint.get("circle-pitch-alignment"),f=c?l:function(e,t){return e.map(function(e){return so(e,t)})}(l,s),h=c?u*o:u,p=0,d=n;p<d.length;p+=1)for(var v=0,m=d[p];v<m.length;v+=1){var g=m[v],y=c?g:so(g,s),x=h,_=io([],[g.x,g.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?x*=_[3]/i.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(x*=i.cameraToCenterDistance/_[3]),Bi(f,y,x))return!0}return!1},t}(xa));function so(e,t){var r=io([],[e.x,e.y,0,1],t);return new a(r[0]/r[3],r[1]/r[3])}var lo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ni);function uo(e,t,r,n){var a=t.width,i=t.height;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==a*i*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(a*i*r);return e.width=a,e.height=i,e.data=n,e}function co(e,t,r){var n=t.width,a=t.height;if(n!==e.width||a!==e.height){var i=uo({},{width:n,height:a},r);fo(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,a)},r),e.width=n,e.height=a,e.data=i.data}}function fo(e,t,r,n,a,i){if(0===a.width||0===a.height)return t;if(a.width>e.width||a.height>e.height||r.x>e.width-a.width||r.y>e.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>t.width||a.height>t.height||n.x>t.width-a.width||n.y>t.height-a.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=e.data,s=t.data,l=0;l<a.height;l++)for(var u=((r.y+l)*e.width+r.x)*i,c=((n.y+l)*t.width+n.x)*i,f=0;f<a.width*i;f++)s[c+f]=o[u+f];return t}Rn("HeatmapBucket",lo,{omit:["layers"]});var ho=function(e,t){uo(this,e,1,t)};ho.prototype.resize=function(e){co(this,e,1)},ho.prototype.clone=function(){return new ho({width:this.width,height:this.height},new Uint8Array(this.data))},ho.copy=function(e,t,r,n,a){fo(e,t,r,n,a,1)};var po=function(e,t){uo(this,e,4,t)};po.prototype.resize=function(e){co(this,e,4)},po.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},po.prototype.clone=function(){return new po({width:this.width,height:this.height},new Uint8Array(this.data))},po.copy=function(e,t,r,n,a){fo(e,t,r,n,a,4)},Rn("AlphaImage",ho),Rn("RGBAImage",po);var vo={paint:new ya({"heatmap-radius":new da(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new da(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pa(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ga(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pa(Me.paint_heatmap["heatmap-opacity"])})};function mo(e,t){for(var r=new Uint8Array(1024),n={},a=0,i=0;a<256;a++,i+=4){n[t]=a/255;var o=e.evaluate(n);r[i+0]=Math.floor(255*o.r/o.a),r[i+1]=Math.floor(255*o.g/o.a),r[i+2]=Math.floor(255*o.b/o.a),r[i+3]=Math.floor(255*o.a)}return new po({width:256,height:1},r)}var go=function(e){function t(t){e.call(this,t,vo),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new lo(e)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){"heatmap-color"===e&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=mo(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(xa),yo={paint:new ya({"hillshade-illumination-direction":new pa(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pa(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pa(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pa(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pa(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pa(Me.paint_hillshade["hillshade-accent-color"])})},xo=function(e){function t(t){e.call(this,t,yo)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(xa),_o=Ta([{name:"a_pos",components:2,type:"Int16"}],4).members,bo=To,wo=To;function To(e,t,r){r=r||2;var n,a,i,o,s,l,u,c=t&&t.length,f=c?t[0]*r:e.length,h=ko(e,0,f,r,!0),p=[];if(!h||h.next===h.prev)return p;if(c&&(h=function(e,t,r,n){var a,i,o,s=[];for(a=0,i=t.length;a<i;a++)(o=ko(e,t[a]*n,a<i-1?t[a+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),s.push(Ro(o));for(s.sort(Io),a=0;a<s.length;a++)Oo(s[a],r),r=Ao(r,r.next);return r}(e,t,h,r)),e.length>80*r){n=i=e[0],a=o=e[1];for(var d=r;d<f;d+=r)(s=e[d])<n&&(n=s),(l=e[d+1])<a&&(a=l),s>i&&(i=s),l>o&&(o=l);u=0!==(u=Math.max(i-n,o-a))?1/u:0}return Mo(h,p,r,n,a,u),p}function ko(e,t,r,n,a){var i,o;if(a===Xo(e,t,r,n)>0)for(i=t;i<r;i+=n)o=qo(i,e[i],e[i+1],o);else for(i=r-n;i>=t;i-=n)o=qo(i,e[i],e[i+1],o);return o&&Bo(o,o.next)&&(Yo(o),o=o.next),o}function Ao(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!Bo(n,n.next)&&0!==Fo(n.prev,n,n.next))n=n.next;else{if(Yo(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function Mo(e,t,r,n,a,i,o){if(e){!o&&i&&function(e,t,r,n){var a=e;do{null===a.z&&(a.z=Do(a.x,a.y,t,r,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,r,n,a,i,o,s,l,u=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(a=r,r=r.nextZ,s--):(a=n,n=n.nextZ,l--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;r=n}i.nextZ=null,u*=2}while(o>1)}(a)}(e,n,a,i);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,i?So(e,n,a,i):Eo(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),Yo(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Mo(e=Co(Ao(e),t,r),t,r,n,a,i,2):2===o&&Lo(e,t,r,n,a,i):Mo(Ao(e),t,r,n,a,i,1);break}}}function Eo(e){var t=e.prev,r=e,n=e.next;if(Fo(t,r,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(zo(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&Fo(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function So(e,t,r,n){var a=e.prev,i=e,o=e.next;if(Fo(a,i,o)>=0)return!1;for(var s=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,l=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,u=Do(a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,t,r,n),c=Do(s,l,t,r,n),f=e.prevZ,h=e.nextZ;f&&f.z>=u&&h&&h.z<=c;){if(f!==e.prev&&f!==e.next&&zo(a.x,a.y,i.x,i.y,o.x,o.y,f.x,f.y)&&Fo(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,h!==e.prev&&h!==e.next&&zo(a.x,a.y,i.x,i.y,o.x,o.y,h.x,h.y)&&Fo(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;f&&f.z>=u;){if(f!==e.prev&&f!==e.next&&zo(a.x,a.y,i.x,i.y,o.x,o.y,f.x,f.y)&&Fo(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;h&&h.z<=c;){if(h!==e.prev&&h!==e.next&&zo(a.x,a.y,i.x,i.y,o.x,o.y,h.x,h.y)&&Fo(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function Co(e,t,r){var n=e;do{var a=n.prev,i=n.next.next;!Bo(a,i)&&jo(a,n,n.next,i)&&Vo(a,i)&&Vo(i,a)&&(t.push(a.i/r),t.push(n.i/r),t.push(i.i/r),Yo(n),Yo(n.next),n=e=i),n=n.next}while(n!==e);return Ao(n)}function Lo(e,t,r,n,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&No(o,s)){var l=Go(o,s);return o=Ao(o,o.next),l=Ao(l,l.next),Mo(o,t,r,n,a,i),void Mo(l,t,r,n,a,i)}s=s.next}o=o.next}while(o!==e)}function Io(e,t){return e.x-t.x}function Oo(e,t){if(t=function(e,t){var r,n=t,a=e.x,i=e.y,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=a&&s>o){if(o=s,s===a){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(a===o)return r;var l,u=r,c=r.x,f=r.y,h=1/0;n=r;do{a>=n.x&&n.x>=c&&a!==n.x&&zo(i<f?a:o,i,c,f,i<f?o:a,i,n.x,n.y)&&(l=Math.abs(i-n.y)/(a-n.x),Vo(n,e)&&(l<h||l===h&&(n.x>r.x||n.x===r.x&&Po(r,n)))&&(r=n,h=l)),n=n.next}while(n!==u);return r}(e,t)){var r=Go(t,e);Ao(t,t.next),Ao(r,r.next)}}function Po(e,t){return Fo(e.prev,e,t.prev)<0&&Fo(t.next,e,e.next)<0}function Do(e,t,r,n,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ro(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function zo(e,t,r,n,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function No(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&jo(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Vo(e,t)&&Vo(t,e)&&function(e,t){var r=e,n=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(Fo(e.prev,e,t.prev)||Fo(e,t.prev,t))||Bo(e,t)&&Fo(e.prev,e,e.next)>0&&Fo(t.prev,t,t.next)>0)}function Fo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Bo(e,t){return e.x===t.x&&e.y===t.y}function jo(e,t,r,n){var a=Ho(Fo(e,t,r)),i=Ho(Fo(e,t,n)),o=Ho(Fo(r,n,e)),s=Ho(Fo(r,n,t));return a!==i&&o!==s||!(0!==a||!Uo(e,r,t))||!(0!==i||!Uo(e,n,t))||!(0!==o||!Uo(r,e,n))||!(0!==s||!Uo(r,t,n))}function Uo(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Ho(e){return e>0?1:e<0?-1:0}function Vo(e,t){return Fo(e.prev,e,e.next)<0?Fo(e,t,e.next)>=0&&Fo(e,e.prev,t)>=0:Fo(e,t,e.prev)<0||Fo(e,e.next,t)<0}function Go(e,t){var r=new Wo(e.i,e.x,e.y),n=new Wo(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function qo(e,t,r,n){var a=new Wo(e,t,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function Yo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Wo(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xo(e,t,r,n){for(var a=0,i=t,o=r-n;i<r;i+=n)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}function Zo(e,t,r,n,a){!function e(t,r,n,a,i){for(;a>n;){if(a-n>600){var o=a-n+1,s=r-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);e(t,r,Math.max(n,Math.floor(r-s*u/o+c)),Math.min(a,Math.floor(r+(o-s)*u/o+c)),i)}var f=t[r],h=n,p=a;for(Ko(t,n,r),i(t[a],f)>0&&Ko(t,n,a);h<p;){for(Ko(t,h,p),h++,p--;i(t[h],f)<0;)h++;for(;i(t[p],f)>0;)p--}0===i(t[n],f)?Ko(t,n,p):Ko(t,++p,a),p<=r&&(n=p+1),r<=p&&(a=p-1)}}(e,t,r||0,n||e.length-1,a||Jo)}function Ko(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Jo(e,t){return e<t?-1:e>t?1:0}function Qo(e,t){var r=e.length;if(r<=1)return[e];for(var n,a,i=[],o=0;o<r;o++){var s=T(e[o]);0!==s&&(e[o].area=Math.abs(s),void 0===a&&(a=s<0),a===s<0?(n&&i.push(n),n=[e[o]]):n.push(e[o]))}if(n&&i.push(n),t>1)for(var l=0;l<i.length;l++)i[l].length<=t||(Zo(i[l],t,1,i[l].length-1,$o),i[l]=i[l].slice(0,t));return i}function $o(e,t){return t.area-e.area}function es(e,t,r){for(var n=r.patternDependencies,a=!1,i=0,o=t;i<o.length;i+=1){var s=o[i].paint.get(e+"-pattern");s.isConstant()||(a=!0);var l=s.constantOr(null);l&&(a=!0,n[l.to]=!0,n[l.from]=!0)}return a}function ts(e,t,r,n,a){for(var i=a.patternDependencies,o=0,s=t;o<s.length;o+=1){var l=s[o],u=l.paint.get(e+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:n-1},r,{},a.availableImages),f=u.evaluate({zoom:n},r,{},a.availableImages),h=u.evaluate({zoom:n+1},r,{},a.availableImages);f=f&&f.name?f.name:f,h=h&&h.name?h.name:h,i[c=c&&c.name?c.name:c]=!0,i[f]=!0,i[h]=!0,r.patterns[l.id]={min:c,mid:f,max:h}}}return r}To.deviation=function(e,t,r,n){var a=t&&t.length,i=Math.abs(Xo(e,0,a?t[0]*r:e.length,r));if(a)for(var o=0,s=t.length;o<s;o++)i-=Math.abs(Xo(e,t[o]*r,o<s-1?t[o+1]*r:e.length,r));var l=0;for(o=0;o<n.length;o+=3){var u=n[o]*r,c=n[o+1]*r,f=n[o+2]*r;l+=Math.abs((e[u]-e[f])*(e[c+1]-e[u+1])-(e[u]-e[c])*(e[f+1]-e[u+1]))}return 0===i&&0===l?0:Math.abs((l-i)/i)},To.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,a=0;a<e.length;a++){for(var i=0;i<e[a].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[a][i][o]);a>0&&r.holes.push(n+=e[a-1].length)}return r},bo.default=wo;var rs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Aa,this.indexArray=new Na,this.indexArray2=new Va,this.programConfigurations=new Ii(_o,e.layers,e.zoom),this.segments=new ai,this.segments2=new ai,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};rs.prototype.populate=function(e,t,r){this.hasPattern=es("fill",this.layers,t);for(var n=this.layers[0].layout.get("fill-sort-key"),a=[],i=0,o=e;i<o.length;i+=1){var s=o[i],l=s.feature,u=s.id,c=s.index,f=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,p={type:l.type,id:u,properties:l.properties,geometry:h?Ri(l):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),p,r)){h||(p.geometry=Ri(l));var d=n?n.evaluate(p,{},r,t.availableImages):void 0;a.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:f,index:c,geometry:p.geometry,patterns:{},sortKey:d})}}n&&a.sort(function(e,t){return e.sortKey-t.sortKey});for(var v=0,m=a;v<m.length;v+=1){var g=m[v],y=g.geometry,x=g.index,_=g.sourceLayerIndex;if(this.hasPattern){var b=ts("fill",this.layers,g,this.zoom,t);this.patternFeatures.push(b)}else this.addFeature(g,y,x,r,{});t.featureIndex.insert(e[x].feature,y,x,_,this.index)}},rs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},rs.prototype.addFeatures=function(e,t,r){for(var n=0,a=this.patternFeatures;n<a.length;n+=1){var i=a[n];this.addFeature(i,i.geometry,i.index,t,r)}},rs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},rs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_o),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},rs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},rs.prototype.addFeature=function(e,t,r,n,a){for(var i=0,o=Qo(t,500);i<o.length;i+=1){for(var s=o[i],l=0,u=0,c=s;u<c.length;u+=1)l+=c[u].length;for(var f=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),h=f.vertexLength,p=[],d=[],v=0,m=s;v<m.length;v+=1){var g=m[v];if(0!==g.length){g!==s[0]&&d.push(p.length/2);var y=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),x=y.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(x+g.length-1,x),p.push(g[0].x),p.push(g[0].y);for(var _=1;_<g.length;_++)this.layoutVertexArray.emplaceBack(g[_].x,g[_].y),this.indexArray2.emplaceBack(x+_-1,x+_),p.push(g[_].x),p.push(g[_].y);y.vertexLength+=g.length,y.primitiveLength+=g.length}}for(var b=bo(p,d),w=0;w<b.length;w+=3)this.indexArray.emplaceBack(h+b[w],h+b[w+1],h+b[w+2]);f.vertexLength+=l,f.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)},Rn("FillBucket",rs,{omit:["layers","patternFeatures"]});var ns=new ya({"fill-sort-key":new da(Me.layout_fill["fill-sort-key"])}),as={paint:new ya({"fill-antialias":new pa(Me.paint_fill["fill-antialias"]),"fill-opacity":new da(Me.paint_fill["fill-opacity"]),"fill-color":new da(Me.paint_fill["fill-color"]),"fill-outline-color":new da(Me.paint_fill["fill-outline-color"]),"fill-translate":new pa(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new pa(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new va(Me.paint_fill["fill-pattern"])}),layout:ns},is=function(e){function t(t){e.call(this,t,as)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(t,r){e.prototype.recalculate.call(this,t,r);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new rs(e)},t.prototype.queryRadius=function(){return Ki(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,a,i,o){return ji(Ji(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,o),n)},t.prototype.isTileClipped=function(){return!0},t}(xa),os=Ta([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ss=ls;function ls(e,t,r,n,a){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=a,e.readFields(us,this,t)}function us(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],a=t._values[e.readVarint()];t.properties[n]=a}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function cs(e){for(var t,r,n=0,a=0,i=e.length,o=i-1;a<i;o=a++)n+=((r=e[o]).x-(t=e[a]).x)*(t.y+r.y);return n}ls.types=["Unknown","Point","LineString","Polygon"],ls.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,o=0,s=0,l=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)o+=e.readSVarint(),s+=e.readSVarint(),1===n&&(t&&l.push(t),t=[]),t.push(new a(o,s));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&l.push(t),l},ls.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,a=0,i=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(a+=e.readSVarint())<o&&(o=a),a>s&&(s=a),(i+=e.readSVarint())<l&&(l=i),i>u&&(u=i);else if(7!==r)throw new Error("unknown command "+r)}return[o,l,s,u]},ls.prototype.toGeoJSON=function(e,t,r){var n,a,i=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,l=this.loadGeometry(),u=ls.types[this.type];function c(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+o)/i-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/i)*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(n=0;n<l.length;n++)f[n]=l[n][0];c(l=f);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,a=[],i=0;i<t;i++){var o=cs(e[i]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&a.push(r),r=[e[i]]):r.push(e[i]))}return r&&a.push(r),a}(l),n=0;n<l.length;n++)for(a=0;a<l[n].length;a++)c(l[n][a])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var fs=hs;function hs(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ps,this,t),this.length=this._features.length}function ps(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}function ds(e,t,r){if(3===e){var n=new fs(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}hs.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ss(this._pbf,t,this.extent,this._keys,this._values)};var vs={VectorTile:function(e,t){this.layers=e.readFields(ds,{},t)},VectorTileFeature:ss,VectorTileLayer:fs},ms=vs.VectorTileFeature.types,gs=Math.pow(2,13);function ys(e,t,r,n,a,i,o,s){e.emplaceBack(t,r,2*Math.floor(n*gs)+o,a*gs*2,i*gs*2,Math.round(s))}var xs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ea,this.indexArray=new Na,this.programConfigurations=new Ii(os,e.layers,e.zoom),this.segments=new ai,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function _s(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}xs.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=es("fill-extrusion",this.layers,t);for(var n=0,a=e;n<a.length;n+=1){var i=a[n],o=i.feature,s=i.id,l=i.index,u=i.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,f={type:o.type,id:s,properties:o.properties,geometry:c?Ri(o):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),f,r)){var h={id:s,sourceLayerIndex:u,index:l,geometry:c?f.geometry:Ri(o),properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(h.id=o.id),this.hasPattern?this.features.push(ts("fill-extrusion",this.layers,h,this.zoom,t)):this.addFeature(h,h.geometry,l,r,{}),t.featureIndex.insert(o,h.geometry,l,u,this.index,!0)}}},xs.prototype.addFeatures=function(e,t,r){for(var n=0,a=this.features;n<a.length;n+=1){var i=a[n];this.addFeature(i,i.geometry,i.index,t,r)}},xs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},xs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,os),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xs.prototype.addFeature=function(e,t,r,n,a){for(var i=0,o=Qo(t,500);i<o.length;i+=1){for(var s=o[i],l=0,u=0,c=s;u<c.length;u+=1)l+=c[u].length;for(var f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,p=s;h<p.length;h+=1){var d=p[h];if(0!==d.length&&!((O=d).every(function(e){return e.x<0})||O.every(function(e){return e.x>8192})||O.every(function(e){return e.y<0})||O.every(function(e){return e.y>8192})))for(var v=0,m=0;m<d.length;m++){var g=d[m];if(m>=1){var y=d[m-1];if(!_s(g,y)){f.vertexLength+4>ai.MAX_VERTEX_ARRAY_LENGTH&&(f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var x=g.sub(y)._perp()._unit(),_=y.dist(g);v+_>32768&&(v=0),ys(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,v),ys(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,v),ys(this.layoutVertexArray,y.x,y.y,x.x,x.y,0,0,v+=_),ys(this.layoutVertexArray,y.x,y.y,x.x,x.y,0,1,v);var b=f.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),f.vertexLength+=4,f.primitiveLength+=2}}}}if(f.vertexLength+l>ai.MAX_VERTEX_ARRAY_LENGTH&&(f=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===ms[e.type]){for(var w=[],T=[],k=f.vertexLength,A=0,M=s;A<M.length;A+=1){var E=M[A];if(0!==E.length){E!==s[0]&&T.push(w.length/2);for(var S=0;S<E.length;S++){var C=E[S];ys(this.layoutVertexArray,C.x,C.y,0,0,1,1,0),w.push(C.x),w.push(C.y)}}}for(var L=bo(w,T),I=0;I<L.length;I+=3)this.indexArray.emplaceBack(k+L[I],k+L[I+2],k+L[I+1]);f.primitiveLength+=L.length/3,f.vertexLength+=l}}var O;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)},Rn("FillExtrusionBucket",xs,{omit:["layers","features"]});var bs={paint:new ya({"fill-extrusion-opacity":new pa(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new da(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pa(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pa(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new va(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new da(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new da(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pa(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ws=function(e){function t(t){e.call(this,t,bs)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new xs(e)},t.prototype.queryRadius=function(){return Ki(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,o,s,l){var u=Ji(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(t,r),f=this.paint.get("fill-extrusion-base").evaluate(t,r),h=function(e,t,r,n){for(var i=[],o=0,s=e;o<s.length;o+=1){var l=s[o],u=[l.x,l.y,0,1];io(u,u,t),i.push(new a(u[0]/u[3],u[1]/u[3]))}return i}(u,l),p=function(e,t,r,n){for(var i=[],o=[],s=n[8]*t,l=n[9]*t,u=n[10]*t,c=n[11]*t,f=n[8]*r,h=n[9]*r,p=n[10]*r,d=n[11]*r,v=0,m=e;v<m.length;v+=1){for(var g=[],y=[],x=0,_=m[v];x<_.length;x+=1){var b=_[x],w=b.x,T=b.y,k=n[0]*w+n[4]*T+n[12],A=n[1]*w+n[5]*T+n[13],M=n[2]*w+n[6]*T+n[14],E=n[3]*w+n[7]*T+n[15],S=M+u,C=E+c,L=k+f,I=A+h,O=M+p,P=E+d,D=new a((k+s)/C,(A+l)/C);D.z=S/C,g.push(D);var R=new a(L/P,I/P);R.z=O/P,y.push(R)}i.push(g),o.push(y)}return[i,o]}(n,f,c,l);return function(e,t,r){var n=1/0;ji(r,t)&&(n=ks(r,t[0]));for(var a=0;a<t.length;a++)for(var i=t[a],o=e[a],s=0;s<i.length-1;s++){var l=i[s],u=[l,i[s+1],o[s+1],o[s],l];Fi(r,u)&&(n=Math.min(n,ks(r,u)))}return n!==1/0&&n}(p[0],p[1],h)},t}(xa);function Ts(e,t){return e.x*t.x+e.y*t.y}function ks(e,t){if(1===e.length){for(var r,n=0,a=t[n++];!r||a.equals(r);)if(!(r=t[n++]))return 1/0;for(;n<t.length;n++){var i=t[n],o=e[0],s=r.sub(a),l=i.sub(a),u=o.sub(a),c=Ts(s,s),f=Ts(s,l),h=Ts(l,l),p=Ts(u,s),d=Ts(u,l),v=c*h-f*f,m=(h*p-f*d)/v,g=(c*d-f*p)/v,y=a.z*(1-m-g)+r.z*m+i.z*g;if(isFinite(y))return y}return 1/0}for(var x=1/0,_=0,b=t;_<b.length;_+=1)x=Math.min(x,b[_].z);return x}var As=Ta([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Ms=vs.VectorTileFeature.types,Es=Math.cos(Math.PI/180*37.5),Ss=Math.pow(2,14)/.5,Cs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Sa,this.indexArray=new Na,this.programConfigurations=new Ii(As,e.layers,e.zoom),this.segments=new ai,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};Cs.prototype.populate=function(e,t,r){this.hasPattern=es("line",this.layers,t);for(var n=this.layers[0].layout.get("line-sort-key"),a=[],i=0,o=e;i<o.length;i+=1){var s=o[i],l=s.feature,u=s.id,c=s.index,f=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,p={type:l.type,id:u,properties:l.properties,geometry:h?Ri(l):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),p,r)){h||(p.geometry=Ri(l));var d=n?n.evaluate(p,{},r):void 0;a.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:f,index:c,geometry:p.geometry,patterns:{},sortKey:d})}}n&&a.sort(function(e,t){return e.sortKey-t.sortKey});for(var v=0,m=a;v<m.length;v+=1){var g=m[v],y=g.geometry,x=g.index,_=g.sourceLayerIndex;if(this.hasPattern){var b=ts("line",this.layers,g,this.zoom,t);this.patternFeatures.push(b)}else this.addFeature(g,y,x,r,{});t.featureIndex.insert(e[x].feature,y,x,_,this.index)}},Cs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Cs.prototype.addFeatures=function(e,t,r){for(var n=0,a=this.patternFeatures;n<a.length;n+=1){var i=a[n];this.addFeature(i,i.geometry,i.index,t,r)}},Cs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Cs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,As),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Cs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Cs.prototype.addFeature=function(e,t,r,n,a){for(var i=this.layers[0].layout,o=i.get("line-join").evaluate(e,{}),s=i.get("line-cap"),l=i.get("line-miter-limit"),u=i.get("line-round-limit"),c=0,f=t;c<f.length;c+=1)this.addLine(f[c],e,o,s,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)},Cs.prototype.addLine=function(e,t,r,n,a,i){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+t.properties.mapbox_clip_start,this.clipEnd=+t.properties.mapbox_clip_end;for(var o=0;o<e.length-1;o++)this.totalDistance+=e[o].dist(e[o+1]);this.updateScaledDistance()}for(var s="Polygon"===Ms[t.type],l=e.length;l>=2&&e[l-1].equals(e[l-2]);)l--;for(var u=0;u<l-1&&e[u].equals(e[u+1]);)u++;if(!(l<(s?3:2))){"bevel"===r&&(a=1.05);var c,f=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),p=void 0,d=void 0,v=void 0,m=void 0;this.e1=this.e2=-1,s&&(m=e[u].sub(c=e[l-2])._unit()._perp());for(var g=u;g<l;g++)if(!(d=g===l-1?s?e[u+1]:void 0:e[g+1])||!e[g].equals(d)){m&&(v=m),c&&(p=c),c=e[g],m=d?d.sub(c)._unit()._perp():v;var y=(v=v||m).add(m);0===y.x&&0===y.y||y._unit();var x=v.x*m.x+v.y*m.y,_=y.x*m.x+y.y*m.y,b=0!==_?1/_:1/0,w=2*Math.sqrt(2-2*_),T=_<Es&&p&&d,k=v.x*m.y-v.y*m.x>0;if(T&&g>u){var A=c.dist(p);if(A>2*f){var M=c.sub(c.sub(p)._mult(f/A)._round());this.updateDistance(p,M),this.addCurrentVertex(M,v,0,0,h),p=M}}var E=p&&d,S=E?r:s?"butt":n;if(E&&"round"===S&&(b<i?S="miter":b<=2&&(S="fakeround")),"miter"===S&&b>a&&(S="bevel"),"bevel"===S&&(b>2&&(S="flipbevel"),b<a&&(S="miter")),p&&this.updateDistance(p,c),"miter"===S)y._mult(b),this.addCurrentVertex(c,y,0,0,h);else if("flipbevel"===S){if(b>100)y=m.mult(-1);else{var C=b*v.add(m).mag()/v.sub(m).mag();y._perp()._mult(C*(k?-1:1))}this.addCurrentVertex(c,y,0,0,h),this.addCurrentVertex(c,y.mult(-1),0,0,h)}else if("bevel"===S||"fakeround"===S){var L=-Math.sqrt(b*b-1),I=k?L:0,O=k?0:L;if(p&&this.addCurrentVertex(c,v,I,O,h),"fakeround"===S)for(var P=Math.round(180*w/Math.PI/20),D=1;D<P;D++){var R=D/P;if(.5!==R){var z=R-.5;R+=R*z*(R-1)*((1.0904+x*(x*(3.55645-1.43519*x)-3.2452))*z*z+(.848013+x*(.215638*x-1.06021)))}var N=m.sub(v)._mult(R)._add(v)._unit()._mult(k?-1:1);this.addHalfVertex(c,N.x,N.y,!1,k,0,h)}d&&this.addCurrentVertex(c,m,-I,-O,h)}else if("butt"===S)this.addCurrentVertex(c,y,0,0,h);else if("square"===S){var F=p?1:-1;this.addCurrentVertex(c,y,F,F,h)}else"round"===S&&(p&&(this.addCurrentVertex(c,v,0,0,h),this.addCurrentVertex(c,v,1,1,h,!0)),d&&(this.addCurrentVertex(c,m,-1,-1,h,!0),this.addCurrentVertex(c,m,0,0,h)));if(T&&g<l-1){var B=c.dist(d);if(B>2*f){var j=c.add(d.sub(c)._mult(f/B)._round());this.updateDistance(c,j),this.addCurrentVertex(j,m,0,0,h),c=j}}}}},Cs.prototype.addCurrentVertex=function(e,t,r,n,a,i){void 0===i&&(i=!1);var o=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,i,!1,r,a),this.addHalfVertex(e,o,s,i,!0,-n,a),this.distance>Ss/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,n,a,i))},Cs.prototype.addHalfVertex=function(e,t,r,n,a,i,o){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((e.x<<1)+(n?1:0),(e.y<<1)+(a?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===i?0:i<0?-1:1)|(63&s)<<2,s>>6);var l=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),o.primitiveLength++),a?this.e2=l:this.e1=l},Cs.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ss-1):this.distance},Cs.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Rn("LineBucket",Cs,{omit:["layers","patternFeatures"]});var Ls=new ya({"line-cap":new pa(Me.layout_line["line-cap"]),"line-join":new da(Me.layout_line["line-join"]),"line-miter-limit":new pa(Me.layout_line["line-miter-limit"]),"line-round-limit":new pa(Me.layout_line["line-round-limit"]),"line-sort-key":new da(Me.layout_line["line-sort-key"])}),Is={paint:new ya({"line-opacity":new da(Me.paint_line["line-opacity"]),"line-color":new da(Me.paint_line["line-color"]),"line-translate":new pa(Me.paint_line["line-translate"]),"line-translate-anchor":new pa(Me.paint_line["line-translate-anchor"]),"line-width":new da(Me.paint_line["line-width"]),"line-gap-width":new da(Me.paint_line["line-gap-width"]),"line-offset":new da(Me.paint_line["line-offset"]),"line-blur":new da(Me.paint_line["line-blur"]),"line-dasharray":new ma(Me.paint_line["line-dasharray"]),"line-pattern":new va(Me.paint_line["line-pattern"]),"line-gradient":new ga(Me.paint_line["line-gradient"])}),layout:Ls},Os=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(t,r){return r=new aa(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),e.prototype.possiblyEvaluate.call(this,t,r)},t.prototype.evaluate=function(t,r,n,a){return r=c({},r,{zoom:Math.floor(r.zoom)}),e.prototype.evaluate.call(this,t,r,n,a)},t}(da))(Is.paint.properties["line-width"].specification);Os.useIntegerZoom=!0;var Ps=function(e){function t(t){e.call(this,t,Is)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(e){"line-gradient"===e&&this._updateGradient()},t.prototype._updateGradient=function(){this.gradient=mo(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(t,r){e.prototype.recalculate.call(this,t,r),this.paint._values["line-floorwidth"]=Os.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new Cs(e)},t.prototype.queryRadius=function(e){var t=e,r=Ds(Zi("line-width",this,t),Zi("line-gap-width",this,t)),n=Zi("line-offset",this,t);return r/2+Math.abs(n)+Ki(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,o,s){var l=Ji(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),u=s/2*Ds(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),c=this.paint.get("line-offset").evaluate(t,r);return c&&(n=function(e,t){for(var r=[],n=new a(0,0),i=0;i<e.length;i++){for(var o=e[i],s=[],l=0;l<o.length;l++){var u=o[l],c=o[l+1],f=0===l?n:u.sub(o[l-1])._unit()._perp(),h=l===o.length-1?n:c.sub(u)._unit()._perp(),p=f._add(h)._unit();p._mult(1/(p.x*h.x+p.y*h.y)),s.push(p._mult(t)._add(u))}r.push(s)}return r}(n,c*s)),function(e,t,r){for(var n=0;n<t.length;n++){var a=t[n];if(e.length>=3)for(var i=0;i<a.length;i++)if(Wi(e,a[i]))return!0;if(Ui(e,a,r))return!0}return!1}(l,n,u)},t.prototype.isTileClipped=function(){return!0},t}(xa);function Ds(e,t){return t>0?t+2*e:e}var Rs=Ta([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zs=Ta([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ns=(Ta([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ta([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Fs=(Ta([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ta([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Bs=Ta([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function js(e,t,r){return e.sections.forEach(function(e){e.text=function(e,t,r){var n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),na.applyArabicShaping&&(e=na.applyArabicShaping(e)),e}(e.text,t,r)}),e}Ta([{name:"triangle",components:3,type:"Uint16"}]),Ta([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ta([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ta([{type:"Float32",name:"offsetX"}]),Ta([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Us={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Hs=function(e,t,r,n,a){var i,o,s=8*a-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?a-1:0,h=r?-1:1,p=e[t+f];for(f+=h,i=p&(1<<-c)-1,p>>=-c,c+=s;c>0;i=256*i+e[t+f],f+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=n;c>0;o=256*o+e[t+f],f+=h,c-=8);if(0===i)i=1-u;else{if(i===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),i-=u}return(p?-1:1)*o*Math.pow(2,i-n)},Vs=function(e,t,r,n,a,i){var o,s,l,u=8*i-a-1,c=(1<<u)-1,f=c>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+f>=1?h/l:h*Math.pow(2,1-f))*l>=2&&(o++,l/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*l-1)*Math.pow(2,a),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,a),o=0));a>=8;e[r+p]=255&s,p+=d,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;e[r+p]=255&o,p+=d,o/=256,u-=8);e[r+p-d]|=128*v},Gs=qs;function qs(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}qs.Varint=0,qs.Fixed64=1,qs.Bytes=2,qs.Fixed32=5;var Ys="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ws(e){return e.type===qs.Bytes?e.readVarint()+e.pos:e.pos+1}function Xs(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Zs(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var a=r.pos-1;a>=e;a--)r.buf[a+n]=r.buf[a]}function Ks(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Js(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Qs(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function $s(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function el(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function tl(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function rl(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nl(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function al(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function il(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function ol(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function sl(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function ll(e,t,r){1===e&&r.readMessage(ul,t)}function ul(e,t,r){if(3===e){var n=r.readMessage(cl,{}),a=n.width,i=n.height,o=n.left,s=n.top,l=n.advance;t.push({id:n.id,bitmap:new ho({width:a+6,height:i+6},n.bitmap),metrics:{width:a,height:i,left:o,top:s,advance:l}})}}function cl(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function fl(e){for(var t=0,r=0,n=0,a=e;n<a.length;n+=1){var i=a[n];t+=i.w*i.h,r=Math.max(r,i.w)}e.sort(function(e,t){return t.h-e.h});for(var o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],s=0,l=0,u=0,c=e;u<c.length;u+=1)for(var f=c[u],h=o.length-1;h>=0;h--){var p=o[h];if(!(f.w>p.w||f.h>p.h)){if(f.x=p.x,f.y=p.y,l=Math.max(l,f.y+f.h),s=Math.max(s,f.x+f.w),f.w===p.w&&f.h===p.h){var d=o.pop();h<o.length&&(o[h]=d)}else f.h===p.h?(p.x+=f.w,p.w-=f.w):f.w===p.w?(p.y+=f.h,p.h-=f.h):(o.push({x:p.x+f.w,y:p.y,w:p.w-f.w,h:f.h}),p.y+=f.h,p.h-=f.h);break}}return{w:s,h:l,fill:t/(s*l)||0}}qs.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),a=n>>3,i=this.pos;this.type=7&n,e(a,t,this),this.pos===i&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=il(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=sl(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=il(this.buf,this.pos)+4294967296*il(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=il(this.buf,this.pos)+4294967296*sl(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Hs(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Hs(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,a,i=r.buf;if(n=(112&(a=i[r.pos++]))>>4,a<128)return Xs(e,n,t);if(n|=(127&(a=i[r.pos++]))<<3,a<128)return Xs(e,n,t);if(n|=(127&(a=i[r.pos++]))<<10,a<128)return Xs(e,n,t);if(n|=(127&(a=i[r.pos++]))<<17,a<128)return Xs(e,n,t);if(n|=(127&(a=i[r.pos++]))<<24,a<128)return Xs(e,n,t);if(n|=(1&(a=i[r.pos++]))<<31,a<128)return Xs(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Ys?function(e,t,r){return Ys.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){for(var n="",a=t;a<r;){var i,o,s,l=e[a],u=null,c=l>239?4:l>223?3:l>191?2:1;if(a+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(i=e[a+1]))&&(u=(31&l)<<6|63&i)<=127&&(u=null):3===c?(o=e[a+2],128==(192&(i=e[a+1]))&&128==(192&o)&&((u=(15&l)<<12|(63&i)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=e[a+2],s=e[a+3],128==(192&(i=e[a+1]))&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&i)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),a+=c}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==qs.Bytes)return e.push(this.readVarint(t));var r=Ws(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==qs.Bytes)return e.push(this.readSVarint());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==qs.Bytes)return e.push(this.readBoolean());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==qs.Bytes)return e.push(this.readFloat());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==qs.Bytes)return e.push(this.readDouble());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==qs.Bytes)return e.push(this.readFixed32());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==qs.Bytes)return e.push(this.readSFixed32());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==qs.Bytes)return e.push(this.readFixed64());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==qs.Bytes)return e.push(this.readSFixed64());var t=Ws(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===qs.Varint)for(;this.buf[this.pos++]>127;);else if(t===qs.Bytes)this.pos=this.readVarint()+this.pos;else if(t===qs.Fixed32)this.pos+=4;else{if(t!==qs.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ol(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ol(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ol(this.buf,-1&e,this.pos),ol(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ol(this.buf,-1&e,this.pos),ol(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,a,i=0;i<t.length;i++){if((n=t.charCodeAt(i))>55295&&n<57344){if(!a){n>56319||i+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):a=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,a=n;continue}n=a-55296<<10|n-56320|65536,a=null}else a&&(e[r++]=239,e[r++]=191,e[r++]=189,a=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Zs(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Vs(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Vs(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&Zs(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,qs.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Ks,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Js,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,el,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Qs,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,$s,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,tl,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,rl,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,nl,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,al,t)},writeBytesField:function(e,t){this.writeTag(e,qs.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,qs.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,qs.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,qs.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,qs.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,qs.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,qs.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,qs.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,qs.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,qs.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var hl=function(e,t){var r=t.pixelRatio,n=t.version,a=t.stretchX,i=t.stretchY,o=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=a,this.stretchY=i,this.content=o,this.version=n},pl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};pl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},pl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},pl.tlbr.get=function(){return this.tl.concat(this.br)},pl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(hl.prototype,pl);var dl=function(e,t){var r={},n={};this.haveRenderCallbacks=[];var a=[];this.addImages(e,r,a),this.addImages(t,n,a);var i=fl(a),o=new po({width:i.w||1,height:i.h||1});for(var s in e){var l=e[s],u=r[s].paddedRect;po.copy(l.data,o,{x:0,y:0},{x:u.x+1,y:u.y+1},l.data)}for(var c in t){var f=t[c],h=n[c].paddedRect,p=h.x+1,d=h.y+1,v=f.data.width,m=f.data.height;po.copy(f.data,o,{x:0,y:0},{x:p,y:d},f.data),po.copy(f.data,o,{x:0,y:m-1},{x:p,y:d-1},{width:v,height:1}),po.copy(f.data,o,{x:0,y:0},{x:p,y:d+m},{width:v,height:1}),po.copy(f.data,o,{x:v-1,y:0},{x:p-1,y:d},{width:1,height:m}),po.copy(f.data,o,{x:0,y:0},{x:p+v,y:d},{width:1,height:m})}this.image=o,this.iconPositions=r,this.patternPositions=n};dl.prototype.addImages=function(e,t,r){for(var n in e){var a=e[n],i={x:0,y:0,w:a.data.width+2,h:a.data.height+2};r.push(i),t[n]=new hl(i,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(n)}},dl.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},dl.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var n=e.tl;r.update(t.data,void 0,{x:n[0],y:n[1]})}},Rn("ImagePosition",hl),Rn("ImageAtlas",dl);var vl={horizontal:1,vertical:2,horizontalOnly:3},ml=function(){this.scale=1,this.fontStack="",this.imageName=null};ml.forText=function(e,t){var r=new ml;return r.scale=e||1,r.fontStack=t,r},ml.forImage=function(e){var t=new ml;return t.imageName=e,t};var gl=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function yl(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v){var m,g=gl.fromFeature(e,a);f===vl.vertical&&g.verticalizePunctuation();var y=na.processBidirectionalText,x=na.processStyledBidirectionalText;if(y&&1===g.sections.length){m=[];for(var _=0,b=y(g.toString(),Al(g,u,i,t,n,p,d));_<b.length;_+=1){var w=b[_],T=new gl;T.text=w,T.sections=g.sections;for(var k=0;k<w.length;k++)T.sectionIndex.push(0);m.push(T)}}else if(x){m=[];for(var A=0,M=x(g.text,g.sectionIndex,Al(g,u,i,t,n,p,d));A<M.length;A+=1){var E=M[A],S=new gl;S.text=E[0],S.sectionIndex=E[1],S.sections=g.sections,m.push(S)}}else m=function(e,t){for(var r=[],n=e.text,a=0,i=0,o=t;i<o.length;i+=1){var s=o[i];r.push(e.substring(a,s)),a=s}return a<n.length&&r.push(e.substring(a,n.length)),r}(g,Al(g,u,i,t,n,p,d));var C=[],L={positionedLines:C,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:f,iconsInText:!1,verticalizable:!1};return function(e,t,r,n,a,i,o,s,l,u,c,f){for(var h=0,p=-17,d=0,v=0,m="right"===s?1:"left"===s?0:.5,g=0,y=0,x=a;y<x.length;y+=1){var _=x[y];_.trim();var b=_.getMaxScale(),w=24*(b-1),T={positionedGlyphs:[],lineOffset:0};e.positionedLines[g]=T;var k=T.positionedGlyphs,A=0;if(_.length()){for(var M=0;M<_.length();M++){var E=_.getSection(M),S=_.getSectionIndex(M),C=_.getCharCode(M),L=0,I=null,O=null,P=null,D=24,R=!(l===vl.horizontal||!c&&!Gn(C)||c&&(xl[C]||(G=C,Hn.Arabic(G)||Hn["Arabic Supplement"](G)||Hn["Arabic Extended-A"](G)||Hn["Arabic Presentation Forms-A"](G)||Hn["Arabic Presentation Forms-B"](G))));if(E.imageName){var z=n[E.imageName];if(!z)continue;P=E.imageName,e.iconsInText=e.iconsInText||!0,O=z.paddedRect;var N=z.displaySize;E.scale=24*E.scale/f,L=w+(24-N[1]*E.scale),D=(I={width:N[0],height:N[1],left:1,top:-3,advance:R?N[1]:N[0]}).advance;var F=R?N[0]*E.scale-24*b:N[1]*E.scale-24*b;F>0&&F>A&&(A=F)}else{var B=r[E.fontStack],j=B&&B[C];if(j&&j.rect)O=j.rect,I=j.metrics;else{var U=t[E.fontStack],H=U&&U[C];if(!H)continue;I=H.metrics}L=24*(b-E.scale)}R?(e.verticalizable=!0,k.push({glyph:C,imageName:P,x:h,y:p+L,vertical:R,scale:E.scale,fontStack:E.fontStack,sectionIndex:S,metrics:I,rect:O}),h+=D*E.scale+u):(k.push({glyph:C,imageName:P,x:h,y:p+L,vertical:R,scale:E.scale,fontStack:E.fontStack,sectionIndex:S,metrics:I,rect:O}),h+=I.advance*E.scale+u)}0!==k.length&&(d=Math.max(h-u,d),El(k,0,k.length-1,m,A)),h=0;var V=i*b+A;T.lineOffset=Math.max(A,w),p+=V,v=Math.max(V,v),++g}else p+=i,++g}var G,q=p- -17,Y=Ml(o),W=Y.horizontalAlign,X=Y.verticalAlign;(function(e,t,r,n,a,i,o,s,l){var u,c=(t-r)*a;u=i!==o?-s*n- -17:(-n*l+.5)*o;for(var f=0,h=e;f<h.length;f+=1)for(var p=0,d=h[f].positionedGlyphs;p<d.length;p+=1){var v=d[p];v.x+=c,v.y+=u}})(e.positionedLines,m,W,X,d,v,i,q,a.length),e.top+=-X*q,e.bottom=e.top+q,e.left+=-W*d,e.right=e.left+d}(L,t,r,n,m,o,s,l,f,u,h,v),!function(e){for(var t=0,r=e;t<r.length;t+=1)if(0!==r[t].positionedGlyphs.length)return!1;return!0}(C)&&L}gl.fromFeature=function(e,t){for(var r=new gl,n=0;n<e.sections.length;n++){var a=e.sections[n];a.image?r.addImageSection(a):r.addTextSection(a,t)}return r},gl.prototype.length=function(){return this.text.length},gl.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},gl.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},gl.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},gl.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r+1)||null,a=e.charCodeAt(r-1)||null;t+=n&&qn(n)&&!Us[e[r+1]]||a&&qn(a)&&!Us[e[r-1]]||!Us[e[r]]?e[r]:Us[e[r]]}return t}(this.text)},gl.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&xl[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=e&&xl[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},gl.prototype.substring=function(e,t){var r=new gl;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},gl.prototype.toString=function(){return this.text},gl.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},gl.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(ml.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,n=0;n<e.text.length;++n)this.sectionIndex.push(r)},gl.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(ml.forImage(t)),this.sectionIndex.push(this.sections.length-1)):b("Reached maximum number of images 6401")}else b("Can't add FormattedSection with an empty image.")},gl.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var xl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_l={};function bl(e,t,r,n,a,i){if(t.imageName){var o=n[t.imageName];return o?o.displaySize[0]*t.scale*24/i+a:0}var s=r[t.fontStack],l=s&&s[e];return l?l.metrics.advance*t.scale+a:0}function wl(e,t,r,n){var a=Math.pow(e-t,2);return n?e<t?a/2:2*a:a+Math.abs(r)*r}function Tl(e,t,r){var n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function kl(e,t,r,n,a,i){for(var o=null,s=wl(t,r,a,i),l=0,u=n;l<u.length;l+=1){var c=u[l],f=wl(t-c.x,r,a,i)+c.badness;f<=s&&(o=c,s=f)}return{index:e,x:t,priorBreak:o,badness:s}}function Al(e,t,r,n,a,i,o){if("point"!==i)return[];if(!e)return[];for(var s,l=[],u=function(e,t,r,n,a,i){for(var o=0,s=0;s<e.length();s++){var l=e.getSection(s);o+=bl(e.getCharCode(s),l,n,a,t,i)}return o/Math.max(1,Math.ceil(o/r))}(e,t,r,n,a,o),c=e.text.indexOf("​")>=0,f=0,h=0;h<e.length();h++){var p=e.getSection(h),d=e.getCharCode(h);if(xl[d]||(f+=bl(d,p,n,a,t,o)),h<e.length()-1){var v=!((s=d)<11904||!(Hn["Bopomofo Extended"](s)||Hn.Bopomofo(s)||Hn["CJK Compatibility Forms"](s)||Hn["CJK Compatibility Ideographs"](s)||Hn["CJK Compatibility"](s)||Hn["CJK Radicals Supplement"](s)||Hn["CJK Strokes"](s)||Hn["CJK Symbols and Punctuation"](s)||Hn["CJK Unified Ideographs Extension A"](s)||Hn["CJK Unified Ideographs"](s)||Hn["Enclosed CJK Letters and Months"](s)||Hn["Halfwidth and Fullwidth Forms"](s)||Hn.Hiragana(s)||Hn["Ideographic Description Characters"](s)||Hn["Kangxi Radicals"](s)||Hn["Katakana Phonetic Extensions"](s)||Hn.Katakana(s)||Hn["Vertical Forms"](s)||Hn["Yi Radicals"](s)||Hn["Yi Syllables"](s)));(_l[d]||v||p.imageName)&&l.push(kl(h+1,f,u,l,Tl(d,e.getCharCode(h+1),v&&c),!1))}}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(kl(e.length(),f,u,l,0,!0))}function Ml(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function El(e,t,r,n,a){if(n||a)for(var i=e[r],o=(e[r].x+i.metrics.advance*i.scale)*n,s=t;s<=r;s++)e[s].x-=o,e[s].y+=a}function Sl(e,t,r,n,a,i){var o,s=e.image;if(s.content){var l=s.content,u=s.pixelRatio||1;o=[l[0]/u,l[1]/u,s.displaySize[0]-l[2]/u,s.displaySize[1]-l[3]/u]}var c,f,h,p,d=t.left*i,v=t.right*i;"width"===r||"both"===r?(p=a[0]+d-n[3],f=a[0]+v+n[1]):f=(p=a[0]+(d+v-s.displaySize[0])/2)+s.displaySize[0];var m=t.top*i,g=t.bottom*i;return"height"===r||"both"===r?(c=a[1]+m-n[0],h=a[1]+g+n[2]):h=(c=a[1]+(m+g-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:f,bottom:h,left:p,collisionPadding:o}}_l[10]=!0,_l[32]=!0,_l[38]=!0,_l[40]=!0,_l[41]=!0,_l[43]=!0,_l[45]=!0,_l[47]=!0,_l[173]=!0,_l[183]=!0,_l[8203]=!0,_l[8208]=!0,_l[8211]=!0,_l[8231]=!0;var Cl=function(e){function t(t,r,n,a){e.call(this,t,r),this.angle=n,void 0!==a&&(this.segment=a)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(a);function Ll(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new aa(e+1))};if("source"===r.kind)return{kind:"source"};for(var n=r.zoomStops,a=r.interpolationType,i=0;i<n.length&&n[i]<=e;)i++;for(var o=i=Math.max(0,i-1);o<n.length&&n[o]<e+1;)o++;o=Math.min(n.length-1,o);var s=n[i],l=n[o];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:a}:{kind:"camera",minZoom:s,maxZoom:l,minSize:r.evaluate(new aa(s)),maxSize:r.evaluate(new aa(l)),interpolationType:a}}function Il(e,t,r){var n=t.uSize,a=r.lowerSize;return"source"===e.kind?a/128:"composite"===e.kind?Ut(a/128,r.upperSize/128,t.uSizeT):n}function Ol(e,t){var r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){var a=e.interpolationType,i=a?l(rr.interpolationFactor(a,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?n=Ut(e.minSize,e.maxSize,i):r=i}return{uSizeT:r,uSize:n}}Rn("Anchor",Cl);var Pl=Object.freeze({__proto__:null,getSizeData:Ll,evaluateSizeForFeature:Il,evaluateSizeForZoom:Ol,SIZE_PACK_FACTOR:128});function Dl(e,t,r,n,a){if(void 0===t.segment)return!0;for(var i=t,o=t.segment+1,s=0;s>-r/2;){if(--o<0)return!1;s-=e[o].dist(i),i=e[o]}s+=e[o].dist(e[o+1]),o++;for(var l=[],u=0;s<r/2;){var c=e[o],f=e[o+1];if(!f)return!1;var h=e[o-1].angleTo(c)-c.angleTo(f);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:h}),u+=h;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>a)return!1;o++,s+=c.dist(f)}return!0}function Rl(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function zl(e,t,r){return e?.6*t*r:0}function Nl(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Fl(e,t,r,n,a,i){for(var o=zl(r,a,i),s=Nl(r,n)*i,l=0,u=Rl(e)/2,c=0;c<e.length-1;c++){var f=e[c],h=e[c+1],p=f.dist(h);if(l+p>u){var d=(u-l)/p,v=Ut(f.x,h.x,d),m=Ut(f.y,h.y,d),g=new Cl(v,m,h.angleTo(f),c);return g._round(),!o||Dl(e,g,s,o,t)?g:void 0}l+=p}}function Bl(e,t,r,n,a,i,o,s,l){var u=zl(n,i,o),c=Nl(n,a),f=c*o,h=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-f<t/4&&(t=f+t/4),function e(t,r,n,a,i,o,s,l,u){for(var c=o/2,f=Rl(t),h=0,p=r-n,d=[],v=0;v<t.length-1;v++){for(var m=t[v],g=t[v+1],y=m.dist(g),x=g.angleTo(m);p+n<h+y;){var _=((p+=n)-h)/y,b=Ut(m.x,g.x,_),w=Ut(m.y,g.y,_);if(b>=0&&b<u&&w>=0&&w<u&&p-c>=0&&p+c<=f){var T=new Cl(b,w,x,v);T._round(),a&&!Dl(t,T,o,a,i)||d.push(T)}}h+=y}return l||d.length||s||(d=e(t,h/2,n,a,i,o,s,!0,u)),d}(e,h?t/2*s%t:(c/2+2*i)*o*s%t,t,u,r,f,h,!1,l)}function jl(e,t,r,n,i){for(var o=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var f=l[c],h=l[c+1];f.x<t&&h.x<t||(f.x<t?f=new a(t,f.y+(t-f.x)/(h.x-f.x)*(h.y-f.y))._round():h.x<t&&(h=new a(t,f.y+(t-f.x)/(h.x-f.x)*(h.y-f.y))._round()),f.y<r&&h.y<r||(f.y<r?f=new a(f.x+(r-f.y)/(h.y-f.y)*(h.x-f.x),r)._round():h.y<r&&(h=new a(f.x+(r-f.y)/(h.y-f.y)*(h.x-f.x),r)._round()),f.x>=n&&h.x>=n||(f.x>=n?f=new a(n,f.y+(n-f.x)/(h.x-f.x)*(h.y-f.y))._round():h.x>=n&&(h=new a(n,f.y+(n-f.x)/(h.x-f.x)*(h.y-f.y))._round()),f.y>=i&&h.y>=i||(f.y>=i?f=new a(f.x+(i-f.y)/(h.y-f.y)*(h.x-f.x),i)._round():h.y>=i&&(h=new a(f.x+(i-f.y)/(h.y-f.y)*(h.x-f.x),i)._round()),u&&f.equals(u[u.length-1])||o.push(u=[f]),u.push(h)))))}return o}function Ul(e,t,r,n){var i=[],o=e.image,s=o.pixelRatio,l=o.paddedRect.w-2,u=o.paddedRect.h-2,c=e.right-e.left,f=e.bottom-e.top,h=o.stretchX||[[0,l]],p=o.stretchY||[[0,u]],d=function(e,t){return e+t[1]-t[0]},v=h.reduce(d,0),m=p.reduce(d,0),g=l-v,y=u-m,x=0,_=v,b=0,w=m,T=0,k=g,A=0,M=y;if(o.content&&n){var E=o.content;x=Hl(h,0,E[0]),b=Hl(p,0,E[1]),_=Hl(h,E[0],E[2]),w=Hl(p,E[1],E[3]),T=E[0]-x,A=E[1]-b,k=E[2]-E[0]-_,M=E[3]-E[1]-w}var S=function(n,i,l,u){var h=Gl(n.stretch-x,_,c,e.left),p=ql(n.fixed-T,k,n.stretch,v),d=Gl(i.stretch-b,w,f,e.top),g=ql(i.fixed-A,M,i.stretch,m),y=Gl(l.stretch-x,_,c,e.left),E=ql(l.fixed-T,k,l.stretch,v),S=Gl(u.stretch-b,w,f,e.top),C=ql(u.fixed-A,M,u.stretch,m),L=new a(h,d),I=new a(y,d),O=new a(y,S),P=new a(h,S),D=new a(p/s,g/s),R=new a(E/s,C/s),z=t*Math.PI/180;if(z){var N=Math.sin(z),F=Math.cos(z),B=[F,-N,N,F];L._matMult(B),I._matMult(B),P._matMult(B),O._matMult(B)}var j=n.stretch+n.fixed,U=i.stretch+i.fixed;return{tl:L,tr:I,bl:P,br:O,tex:{x:o.paddedRect.x+1+j,y:o.paddedRect.y+1+U,w:l.stretch+l.fixed-j,h:u.stretch+u.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:R,minFontScaleX:k/s/c,minFontScaleY:M/s/f,isSDF:r}};if(n&&(o.stretchX||o.stretchY))for(var C=Vl(h,g,v),L=Vl(p,y,m),I=0;I<C.length-1;I++)for(var O=C[I],P=C[I+1],D=0;D<L.length-1;D++)i.push(S(O,L[D],P,L[D+1]));else i.push(S({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}));return i}function Hl(e,t,r){for(var n=0,a=0,i=e;a<i.length;a+=1){var o=i[a];n+=Math.max(t,Math.min(r,o[1]))-Math.max(t,Math.min(r,o[0]))}return n}function Vl(e,t,r){for(var n=[{fixed:-1,stretch:0}],a=0,i=e;a<i.length;a+=1){var o=i[a],s=o[0],l=o[1],u=n[n.length-1];n.push({fixed:s-u.stretch,stretch:u.stretch}),n.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}return n.push({fixed:t+1,stretch:r}),n}function Gl(e,t,r,n){return e/t*r+n}function ql(e,t,r,n){return e-t*r/n}var Yl=function(e,t,r,n,i,o,s,l,u,c){if(this.boxStartIndex=e.length,u){var f=o.top,h=o.bottom,p=o.collisionPadding;p&&(f-=p[1],h+=p[3]);var d=h-f;d>0&&(d=Math.max(10,d),this.circleDiameter=d)}else{var v=o.top*s-l,m=o.bottom*s+l,g=o.left*s-l,y=o.right*s+l,x=o.collisionPadding;if(x&&(g-=x[0]*s,v-=x[1]*s,y+=x[2]*s,m+=x[3]*s),c){var _=new a(g,v),b=new a(y,v),w=new a(g,m),T=new a(y,m),k=c*Math.PI/180;_._rotate(k),b._rotate(k),w._rotate(k),T._rotate(k),g=Math.min(_.x,b.x,w.x,T.x),y=Math.max(_.x,b.x,w.x,T.x),v=Math.min(_.y,b.y,w.y,T.y),m=Math.max(_.y,b.y,w.y,T.y)}e.emplaceBack(t.x,t.y,g,v,y,m,r,n,i)}this.boxEndIndex=e.length},Wl=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=Xl),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Xl(e,t){return e<t?-1:e>t?1:0}function Zl(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var n=1/0,i=1/0,o=-1/0,s=-1/0,l=e[0],u=0;u<l.length;u++){var c=l[u];(!u||c.x<n)&&(n=c.x),(!u||c.y<i)&&(i=c.y),(!u||c.x>o)&&(o=c.x),(!u||c.y>s)&&(s=c.y)}var f=Math.min(o-n,s-i),h=f/2,p=new Wl([],Kl);if(0===f)return new a(n,i);for(var d=n;d<o;d+=f)for(var v=i;v<s;v+=f)p.push(new Jl(d+h,v+h,h,e));for(var m=function(e){for(var t=0,r=0,n=0,a=e[0],i=0,o=a.length,s=o-1;i<o;s=i++){var l=a[i],u=a[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,t+=3*c}return new Jl(r/t,n/t,0,e)}(e),g=p.length;p.length;){var y=p.pop();(y.d>m.d||!m.d)&&(m=y,r&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,g)),y.max-m.d<=t||(p.push(new Jl(y.p.x-(h=y.h/2),y.p.y-h,h,e)),p.push(new Jl(y.p.x+h,y.p.y-h,h,e)),p.push(new Jl(y.p.x-h,y.p.y+h,h,e)),p.push(new Jl(y.p.x+h,y.p.y+h,h,e)),g+=4)}return r&&(console.log("num probes: "+g),console.log("best distance: "+m.d)),m.p}function Kl(e,t){return t.max-e.max}function Jl(e,t,r,n){this.p=new a(e,t),this.h=r,this.d=function(e,t){for(var r=!1,n=1/0,a=0;a<t.length;a++)for(var i=t[a],o=0,s=i.length,l=s-1;o<s;l=o++){var u=i[o],c=i[l];u.y>e.y!=c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,qi(e,u,c))}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}Wl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Wl.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Wl.prototype.peek=function(){return this.data[0]},Wl.prototype._up=function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var a=e-1>>1,i=t[a];if(r(n,i)>=0)break;t[e]=i,e=a}t[e]=n},Wl.prototype._down=function(e){for(var t=this.data,r=this.compare,n=this.length>>1,a=t[e];e<n;){var i=1+(e<<1),o=t[i],s=i+1;if(s<this.length&&r(t[s],o)<0&&(i=s,o=t[s]),r(o,a)>=0)break;t[e]=o,e=i}t[e]=a};var Ql=Number.POSITIVE_INFINITY;function $l(e,t){return t[1]!==Ql?function(e,t,r){var n=0,a=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":a=r-7;break;case"bottom-right":case"bottom-left":case"bottom":a=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,a]}(e,t[0],t[1]):function(e,t){var r=0,n=0;t<0&&(t=0);var a=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":n=a-7;break;case"bottom-right":case"bottom-left":n=7-a;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-a;break;case"top-left":case"bottom-left":r=a;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function eu(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tu(e,t,r,n,i,o,s,l,u,c,f,h,p,d,v){var m=function(e,t,r,n,i,o,s,l){for(var u=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,c=[],f=0,h=t.positionedLines;f<h.length;f+=1)for(var p=h[f],d=0,v=p.positionedGlyphs;d<v.length;d+=1){var m=v[d];if(m.rect){var g=m.rect||{},y=4,x=!0,_=1,b=0,w=(i||l)&&m.vertical,T=m.metrics.advance*m.scale/2;if(l&&t.verticalizable&&(b=p.lineOffset/2-(m.imageName?-(24-m.metrics.width*m.scale)/2:24*(m.scale-1))),m.imageName){var k=s[m.imageName];x=k.sdf,y=1/(_=k.pixelRatio)}var A=i?[m.x+T,m.y]:[0,0],M=i?[0,0]:[m.x+T+r[0],m.y+r[1]-b],E=[0,0];w&&(E=M,M=[0,0]);var S=(m.metrics.left-y)*m.scale-T+M[0],C=(-m.metrics.top-y)*m.scale+M[1],L=S+g.w*m.scale/_,I=C+g.h*m.scale/_,O=new a(S,C),P=new a(L,C),D=new a(S,I),R=new a(L,I);if(w){var z=new a(-T,T- -17),N=-Math.PI/2,F=12-T,B=new a(22-F,-(m.imageName?F:0)),j=new(Function.prototype.bind.apply(a,[null].concat(E)));O._rotateAround(N,z)._add(B)._add(j),P._rotateAround(N,z)._add(B)._add(j),D._rotateAround(N,z)._add(B)._add(j),R._rotateAround(N,z)._add(B)._add(j)}if(u){var U=Math.sin(u),H=Math.cos(u),V=[H,-U,U,H];O._matMult(V),P._matMult(V),D._matMult(V),R._matMult(V)}var G=new a(0,0),q=new a(0,0);c.push({tl:O,tr:P,bl:D,br:R,tex:g,writingMode:t.writingMode,glyphOffset:A,sectionIndex:m.sectionIndex,isSDF:x,pixelOffsetTL:G,pixelOffsetBR:q,minFontScaleX:0,minFontScaleY:0})}}return c}(0,r,l,i,o,s,n,e.allowVerticalPlacement),g=e.textSizeData,y=null;"source"===g.kind?(y=[128*i.layout.get("text-size").evaluate(s,{})])[0]>32640&&b(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===g.kind&&((y=[128*d.compositeTextSizes[0].evaluate(s,{},v),128*d.compositeTextSizes[1].evaluate(s,{},v)])[0]>32640||y[1]>32640)&&b(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,m,y,l,o,s,c,t,u.lineStartIndex,u.lineLength,p,v);for(var x=0,_=f;x<_.length;x+=1)h[_[x]]=e.text.placedSymbolArray.length-1;return 4*m.length}function ru(e){for(var t in e)return e[t];return null}function nu(e,t,r,n){var a=e.compareText;if(t in a){for(var i=a[t],o=i.length-1;o>=0;o--)if(n.dist(i[o])<r)return!0}else a[t]=[];return a[t].push(n),!1}var au=vs.VectorTileFeature.types,iu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ou(e,t,r,n,a,i,o,s,l,u,c,f,h){var p=s?Math.min(32640,Math.round(s[0])):0,d=s?Math.min(32640,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*a),i,o,(p<<1)+(l?1:0),d,16*u,16*c,256*f,256*h)}function su(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function lu(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Xn(r[t].text))return!0;return!1}var uu=function(e){this.layoutVertexArray=new La,this.indexArray=new Na,this.programConfigurations=e,this.segments=new ai,this.dynamicLayoutVertexArray=new Ia,this.opacityVertexArray=new Oa,this.placedSymbolArray=new Ka};uu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},uu.prototype.upload=function(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rs.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,zs.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,iu,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))},uu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Rn("SymbolBuffers",uu);var cu=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new ai,this.collisionVertexArray=new za};cu.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ns.members,!0)},cu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Rn("CollisionBuffers",cu);var fu=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=to([]),this.placementViewportMatrix=to([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ll(this.zoom,t["text-size"]),this.iconSizeData=Ll(this.zoom,t["icon-size"]);var r=this.layers[0].layout,n=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==a&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map(function(e){return vl[e]})),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id}),this.sourceID=e.sourceID};fu.prototype.createArrays=function(){this.text=new uu(new Ii(Rs.members,this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new uu(new Ii(Rs.members,this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new $a,this.lineVertexArray=new ei,this.symbolInstances=new Qa},fu.prototype.calculateGlyphDependencies=function(e,t,r,n,a){for(var i=0;i<e.length;i++)if(t[e.charCodeAt(i)]=!0,(r||n)&&a){var o=Us[e.charAt(i)];o&&(t[o.charCodeAt(0)]=!0)}},fu.prototype.populate=function(e,t,r){var n=this.layers[0],a=n.layout,i=a.get("text-font"),o=a.get("text-field"),s=a.get("icon-image"),l=("constant"!==o.value.kind||o.value.value instanceof et&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),u="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,c=a.get("symbol-sort-key");if(this.features=[],l||u){for(var f=t.iconDependencies,h=t.glyphDependencies,p=t.availableImages,d=new aa(this.zoom),v=0,m=e;v<m.length;v+=1){var g=m[v],y=g.feature,x=g.id,_=g.index,b=g.sourceLayerIndex,w=n._featureFilter.needGeometry,T={type:y.type,id:x,properties:y.properties,geometry:w?Ri(y):[]};if(n._featureFilter.filter(d,T,r)){w||(T.geometry=Ri(y));var k=void 0;if(l){var A=n.getValueAndResolveTokens("text-field",T,r,p),M=et.factory(A);lu(M)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ta()||this.hasRTLText&&na.isParsed())&&(k=js(M,n,T))}var E=void 0;if(u){var S=n.getValueAndResolveTokens("icon-image",T,r,p);E=S instanceof tt?S:tt.fromString(S)}if(k||E){var C=this.sortFeaturesByKey?c.evaluate(T,{},r):void 0,L={id:x,text:k,icon:E,index:_,sourceLayerIndex:b,geometry:Ri(y),properties:y.properties,type:au[y.type],sortKey:C};if(this.features.push(L),E&&(f[E.name]=!0),k){var I=i.evaluate(T,{},r).join(","),O="map"===a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(vl.vertical)>=0;for(var P=0,D=k.sections;P<D.length;P+=1){var R=D[P];if(R.image)f[R.image.name]=!0;else{var z=Vn(k.toString()),N=R.fontStack||I,F=h[N]=h[N]||{};this.calculateGlyphDependencies(R.text,F,O,this.allowVerticalPlacement,z)}}}}}}"line"===a.get("symbol-placement")&&(this.features=function(e){var t={},r={},n=[],a=0;function i(t){n.push(e[t]),a++}function o(e,t,a){var i=r[e];return delete r[e],r[t]=i,n[i].geometry[0].pop(),n[i].geometry[0]=n[i].geometry[0].concat(a[0]),i}function s(e,r,a){var i=t[r];return delete t[r],t[e]=i,n[i].geometry[0].shift(),n[i].geometry[0]=a[0].concat(n[i].geometry[0]),i}function l(e,t,r){var n=r?t[0][t[0].length-1]:t[0][0];return e+":"+n.x+":"+n.y}for(var u=0;u<e.length;u++){var c=e[u],f=c.geometry,h=c.text?c.text.toString():null;if(h){var p=l(h,f),d=l(h,f,!0);if(p in r&&d in t&&r[p]!==t[d]){var v=s(p,d,f),m=o(p,d,n[v].geometry);delete t[p],delete r[d],r[l(h,n[m].geometry,!0)]=m,n[v].geometry=null}else p in r?o(p,d,f):d in t?s(p,d,f):(i(u),t[p]=a-1,r[d]=a-1)}else i(u)}return n.filter(function(e){return e.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(e,t){return e.sortKey-t.sortKey})}},fu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},fu.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},fu.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},fu.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},fu.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},fu.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},fu.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var n=e.dist(t[e.segment+1]),a=e.dist(t[e.segment]),i={},o=e.segment+1;o<t.length;o++)i[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:n},o<t.length-1&&(n+=t[o+1].dist(t[o]));for(var s=e.segment||0;s>=0;s--)i[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:a},s>0&&(a+=t[s-1].dist(t[s]));for(var l=0;l<t.length;l++){var u=i[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},fu.prototype.addSymbols=function(e,t,r,n,a,i,o,s,l,u,c,f){for(var h=e.indexArray,p=e.layoutVertexArray,d=e.segments.prepareSegment(4*t.length,p,h,i.sortKey),v=this.glyphOffsetArray.length,m=d.vertexLength,g=this.allowVerticalPlacement&&o===vl.vertical?Math.PI/2:0,y=i.text&&i.text.sections,x=0;x<t.length;x++){var _=t[x],b=_.tl,w=_.tr,T=_.bl,k=_.br,A=_.tex,M=_.pixelOffsetTL,E=_.pixelOffsetBR,S=_.minFontScaleX,C=_.minFontScaleY,L=_.glyphOffset,I=_.isSDF,O=_.sectionIndex,P=d.vertexLength,D=L[1];ou(p,s.x,s.y,b.x,D+b.y,A.x,A.y,r,I,M.x,M.y,S,C),ou(p,s.x,s.y,w.x,D+w.y,A.x+A.w,A.y,r,I,E.x,M.y,S,C),ou(p,s.x,s.y,T.x,D+T.y,A.x,A.y+A.h,r,I,M.x,E.y,S,C),ou(p,s.x,s.y,k.x,D+k.y,A.x+A.w,A.y+A.h,r,I,E.x,E.y,S,C),su(e.dynamicLayoutVertexArray,s,g),h.emplaceBack(P,P+1,P+2),h.emplaceBack(P+1,P+2,P+3),d.vertexLength+=4,d.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(L[0]),x!==t.length-1&&O===t[x+1].sectionIndex||e.programConfigurations.populatePaintArrays(p.length,i,i.index,{},f,y&&y[O])}e.placedSymbolArray.emplaceBack(s.x,s.y,v,this.glyphOffsetArray.length-v,m,l,u,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],o,0,!1,0,c)},fu.prototype._addCollisionDebugVertex=function(e,t,r,n,a,i){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,a,Math.round(i.x),Math.round(i.y))},fu.prototype.addCollisionDebugVertices=function(e,t,r,n,i,o,s){var l=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),u=l.vertexLength,c=i.layoutVertexArray,f=i.collisionVertexArray,h=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(c,f,o,h,p,new a(e,t)),this._addCollisionDebugVertex(c,f,o,h,p,new a(r,t)),this._addCollisionDebugVertex(c,f,o,h,p,new a(r,n)),this._addCollisionDebugVertex(c,f,o,h,p,new a(e,n)),l.vertexLength+=4;var d=i.indexArray;d.emplaceBack(u,u+1),d.emplaceBack(u+1,u+2),d.emplaceBack(u+2,u+3),d.emplaceBack(u+3,u),l.primitiveLength+=4},fu.prototype.addDebugCollisionBoxes=function(e,t,r,n){for(var a=e;a<t;a++){var i=this.collisionBoxArray.get(a);this.addCollisionDebugVertices(i.x1,i.y1,i.x2,i.y2,n?this.textCollisionBox:this.iconCollisionBox,i.anchorPoint,r)}},fu.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cu(Da,Fs.members,Va),this.iconCollisionBox=new cu(Da,Fs.members,Va);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},fu.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,n,a,i,o,s,l){for(var u={},c=t;c<r;c++){var f=e.get(c);u.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},u.textFeatureIndex=f.featureIndex;break}for(var h=n;h<a;h++){var p=e.get(h);u.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},u.verticalTextFeatureIndex=p.featureIndex;break}for(var d=i;d<o;d++){var v=e.get(d);u.iconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},u.iconFeatureIndex=v.featureIndex;break}for(var m=s;m<l;m++){var g=e.get(m);u.verticalIconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},u.verticalIconFeatureIndex=g.featureIndex;break}return u},fu.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},fu.prototype.hasTextData=function(){return this.text.segments.get().length>0},fu.prototype.hasIconData=function(){return this.icon.segments.get().length>0},fu.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},fu.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},fu.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},fu.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs,a=r.vertexStartIndex;a<n;a+=4)e.indexArray.emplaceBack(a,a+1,a+2),e.indexArray.emplaceBack(a+1,a+2,a+3)},fu.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),n=[],a=[],i=[],o=0;o<this.symbolInstances.length;++o){i.push(o);var s=this.symbolInstances.get(o);n.push(0|Math.round(t*s.anchorX+r*s.anchorY)),a.push(s.featureIndex)}return i.sort(function(e,t){return n[e]-n[t]||a[t]-a[e]}),i},fu.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},fu.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,n=this.symbolInstanceIndexes;r<n.length;r+=1){var a=this.symbolInstances.get(n[r]);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach(function(e,r,n){e>=0&&n.indexOf(e)===r&&t.addIndicesForPlacedSymbol(t.text,e)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Rn("SymbolBucket",fu,{omit:["layers","collisionBoxArray","features","compareText"]}),fu.MAX_GLYPHS=65535,fu.addDynamicAttributes=su;var hu=new ya({"symbol-placement":new pa(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new pa(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pa(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new da(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pa(Me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pa(Me.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new pa(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new pa(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pa(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new da(Me.layout_symbol["icon-size"]),"icon-text-fit":new pa(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pa(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new da(Me.layout_symbol["icon-image"]),"icon-rotate":new da(Me.layout_symbol["icon-rotate"]),"icon-padding":new pa(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new pa(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new da(Me.layout_symbol["icon-offset"]),"icon-anchor":new da(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pa(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pa(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pa(Me.layout_symbol["text-rotation-alignment"]),"text-field":new da(Me.layout_symbol["text-field"]),"text-font":new da(Me.layout_symbol["text-font"]),"text-size":new da(Me.layout_symbol["text-size"]),"text-max-width":new da(Me.layout_symbol["text-max-width"]),"text-line-height":new pa(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new da(Me.layout_symbol["text-letter-spacing"]),"text-justify":new da(Me.layout_symbol["text-justify"]),"text-radial-offset":new da(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pa(Me.layout_symbol["text-variable-anchor"]),"text-anchor":new da(Me.layout_symbol["text-anchor"]),"text-max-angle":new pa(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new pa(Me.layout_symbol["text-writing-mode"]),"text-rotate":new da(Me.layout_symbol["text-rotate"]),"text-padding":new pa(Me.layout_symbol["text-padding"]),"text-keep-upright":new pa(Me.layout_symbol["text-keep-upright"]),"text-transform":new da(Me.layout_symbol["text-transform"]),"text-offset":new da(Me.layout_symbol["text-offset"]),"text-allow-overlap":new pa(Me.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new pa(Me.layout_symbol["text-ignore-placement"]),"text-optional":new pa(Me.layout_symbol["text-optional"])}),pu={paint:new ya({"icon-opacity":new da(Me.paint_symbol["icon-opacity"]),"icon-color":new da(Me.paint_symbol["icon-color"]),"icon-halo-color":new da(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new da(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new da(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new pa(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new pa(Me.paint_symbol["icon-translate-anchor"]),"text-opacity":new da(Me.paint_symbol["text-opacity"]),"text-color":new da(Me.paint_symbol["text-color"],{runtimeType:Fe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new da(Me.paint_symbol["text-halo-color"]),"text-halo-width":new da(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new da(Me.paint_symbol["text-halo-blur"]),"text-translate":new pa(Me.paint_symbol["text-translate"]),"text-translate-anchor":new pa(Me.paint_symbol["text-translate-anchor"])}),layout:hu},du=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:De,this.defaultValue=e};du.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},du.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},du.prototype.outputDefined=function(){return!1},du.prototype.serialize=function(){return null},Rn("FormatSectionOverride",du,{omit:["defaultValue"]});var vu=function(e){function t(t){e.call(this,t,pu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(t,r){if(e.prototype.recalculate.call(this,t,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var n=this.layout.get("text-writing-mode");if(n){for(var a=[],i=0,o=n;i<o.length;i+=1){var s=o[i];a.indexOf(s)<0&&a.push(s)}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(e,t,r,n){var a=this.layout.get(e).evaluate(t,{},r,n),i=this._unevaluatedLayout._values[e];return i.isDataDriven()||Hr(i.value)||!a?a:function(e,t){return t.replace(/{([^{}]+)}/g,function(t,r){return r in e?String(e[r]):""})}(t.properties,a)},t.prototype.createBucket=function(e){return new fu(e)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var e=0,r=pu.paint.overridableProperties;e<r.length;e+=1){var n=r[e];if(t.hasPaintOverride(this.layout,n)){var a,i=this.paint.get(n),o=new du(i),s=new Ur(o,i.property.specification);a="constant"===i.value.kind||"source"===i.value.kind?new Gr("source",s):new qr("composite",s,i.value.zoomStops,i.value._interpolationType),this.paint._values[n]=new fa(i.property,a,i.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(e,r,n){return!(!this.layout||r.isDataDriven()||n.isDataDriven())&&t.hasPaintOverride(this.layout,e)},t.hasPaintOverride=function(e,t){var r=e.get("text-field"),n=pu.paint.properties[t],a=!1,i=function(e){for(var t=0,r=e;t<r.length;t+=1)if(n.overrides&&n.overrides.hasOverride(r[t]))return void(a=!0)};if("constant"===r.value.kind&&r.value.value instanceof et)i(r.value.value.sections);else if("source"===r.value.kind){var o=function(e){a||(e instanceof ot&&at(e.value)===He?i(e.value.sections):e instanceof ct?i(e.sections):e.eachChild(o))},s=r.value;s._styleExpression&&o(s._styleExpression.expression)}return a},t}(xa),mu={paint:new ya({"background-color":new pa(Me.paint_background["background-color"]),"background-pattern":new ma(Me.paint_background["background-pattern"]),"background-opacity":new pa(Me.paint_background["background-opacity"])})},gu=function(e){function t(t){e.call(this,t,mu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xa),yu={paint:new ya({"raster-opacity":new pa(Me.paint_raster["raster-opacity"]),"raster-hue-rotate":new pa(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pa(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pa(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new pa(Me.paint_raster["raster-saturation"]),"raster-contrast":new pa(Me.paint_raster["raster-contrast"]),"raster-resampling":new pa(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new pa(Me.paint_raster["raster-fade-duration"])})},xu=function(e){function t(t){e.call(this,t,yu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xa),_u=function(e){function t(t){e.call(this,t,{}),this.implementation=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},t.prototype.onRemove=function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},t}(xa),bu={circle:oo,heatmap:go,hillshade:xo,fill:is,"fill-extrusion":ws,line:Ps,symbol:vu,background:gu,raster:xu},wu=self.HTMLImageElement,Tu=self.HTMLCanvasElement,ku=self.HTMLVideoElement,Au=self.ImageData,Mu=self.ImageBitmap,Eu=function(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)};Eu.prototype.update=function(e,t,r){var n=e.width,a=e.height,i=!(this.size&&this.size[0]===n&&this.size[1]===a||r),o=this.context,s=o.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),i)this.size=[n,a],e instanceof wu||e instanceof Tu||e instanceof ku||e instanceof Au||Mu&&e instanceof Mu?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,n,a,0,this.format,s.UNSIGNED_BYTE,e.data);else{var l=r||{x:0,y:0},u=l.x,c=l.y;e instanceof wu||e instanceof Tu||e instanceof ku||e instanceof Au||Mu&&e instanceof Mu?s.texSubImage2D(s.TEXTURE_2D,0,u,c,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,u,c,n,a,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},Eu.prototype.bind=function(e,t,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)},Eu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Eu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Su=function(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};Su.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Su.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Cu=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},v(["receive","process"],this),this.invoker=new Su(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=k()?e:self};function Lu(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}Cu.prototype.send=function(e,t,r,n,a){var i=this;void 0===a&&(a=!1);var o=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[o]=r);var s=E(this.globalScope)?void 0:[];return this.target.postMessage({id:o,type:e,hasCallback:!!r,targetMapId:n,mustQueue:a,sourceMapId:this.mapId,data:Bn(t,s)},s),{cancel:function(){r&&delete i.callbacks[o],i.target.postMessage({id:o,type:"<cancel>",targetMapId:n,sourceMapId:i.mapId})}}},Cu.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];var n=this.cancelCallbacks[r];delete this.cancelCallbacks[r],n&&n()}else k()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Cu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Cu.prototype.processTask=function(e,t){var r=this;if("<response>"===t.type){var n=this.callbacks[e];delete this.callbacks[e],n&&(t.error?n(jn(t.error)):n(null,jn(t.data)))}else{var a=!1,i=E(this.globalScope)?void 0:[],o=t.hasCallback?function(t,n){a=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:t?Bn(t):null,data:Bn(n,i)},i)}:function(e){a=!0},s=null,l=jn(t.data);if(this.parent[t.type])s=this.parent[t.type](t.sourceMapId,l,o);else if(this.parent.getWorkerSource){var u=t.type.split(".");s=this.parent.getWorkerSource(t.sourceMapId,u[0],l.source)[u[1]](l,o)}else o(new Error("Could not find function "+t.type));!a&&s&&s.cancel&&(this.cancelCallbacks[e]=s.cancel)}},Cu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Iu=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Iu.prototype.setNorthEast=function(e){return this._ne=e instanceof Ou?new Ou(e.lng,e.lat):Ou.convert(e),this},Iu.prototype.setSouthWest=function(e){return this._sw=e instanceof Ou?new Ou(e.lng,e.lat):Ou.convert(e),this},Iu.prototype.extend=function(e){var t,r,n=this._sw,a=this._ne;if(e instanceof Ou)t=e,r=e;else{if(!(e instanceof Iu))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Iu.convert(e)):this.extend(Ou.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return n||a?(n.lng=Math.min(t.lng,n.lng),n.lat=Math.min(t.lat,n.lat),a.lng=Math.max(r.lng,a.lng),a.lat=Math.max(r.lat,a.lat)):(this._sw=new Ou(t.lng,t.lat),this._ne=new Ou(r.lng,r.lat)),this},Iu.prototype.getCenter=function(){return new Ou((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Iu.prototype.getSouthWest=function(){return this._sw},Iu.prototype.getNorthEast=function(){return this._ne},Iu.prototype.getNorthWest=function(){return new Ou(this.getWest(),this.getNorth())},Iu.prototype.getSouthEast=function(){return new Ou(this.getEast(),this.getSouth())},Iu.prototype.getWest=function(){return this._sw.lng},Iu.prototype.getSouth=function(){return this._sw.lat},Iu.prototype.getEast=function(){return this._ne.lng},Iu.prototype.getNorth=function(){return this._ne.lat},Iu.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Iu.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Iu.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Iu.prototype.contains=function(e){var t=Ou.convert(e),r=t.lng,n=t.lat,a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&a},Iu.convert=function(e){return!e||e instanceof Iu?e:new Iu(e)};var Ou=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ou.prototype.wrap=function(){return new Ou(u(this.lng,-180,180),this.lat)},Ou.prototype.toArray=function(){return[this.lng,this.lat]},Ou.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ou.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,n=e.lat*t,a=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(a,1))},Ou.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Iu(new Ou(this.lng-r,this.lat-t),new Ou(this.lng+r,this.lat+t))},Ou.convert=function(e){if(e instanceof Ou)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Ou(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Ou(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Pu=2*Math.PI*6371008.8;function Du(e){return Pu*Math.cos(e*Math.PI/180)}function Ru(e){return(180+e)/360}function zu(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Nu(e,t){return e/Du(t)}function Fu(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Bu=function(e,t,r){void 0===r&&(r=0),this.x=+e,this.y=+t,this.z=+r};Bu.fromLngLat=function(e,t){void 0===t&&(t=0);var r=Ou.convert(e);return new Bu(Ru(r.lng),zu(r.lat),Nu(t,r.lat))},Bu.prototype.toLngLat=function(){return new Ou(360*this.x-180,Fu(this.y))},Bu.prototype.toAltitude=function(){return this.z*Du(Fu(this.y))},Bu.prototype.meterInMercatorCoordinateUnits=function(){return 1/Pu*(e=Fu(this.y),1/Math.cos(e*Math.PI/180));var e};var ju=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=Vu(0,e,e,t,r)};ju.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},ju.prototype.url=function(e,t){var r,n,a,i,o,s=(n=this.y,a=this.z,i=Lu(256*(r=this.x),256*(n=Math.pow(2,a)-n-1),a),o=Lu(256*(r+1),256*(n+1),a),i[0]+","+i[1]+","+o[0]+","+o[1]),l=function(e,t,r){for(var n,a="",i=e;i>0;i--)a+=(t&(n=1<<i-1)?1:0)+(r&n?2:0);return a}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},ju.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new a(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},ju.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Uu=function(e,t){this.wrap=e,this.canonical=t,this.key=Vu(e,t.z,t.z,t.x,t.y)},Hu=function(e,t,r,n,a){this.overscaledZ=e,this.wrap=t,this.canonical=new ju(r,+n,+a),this.key=Vu(t,e,r,n,a)};function Vu(e,t,r,n,a){(e*=2)<0&&(e=-1*e-1);var i=1<<r;return(i*i*e+i*a+n).toString(36)+r.toString(36)+t.toString(36)}Hu.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Hu.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Hu(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Hu(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Hu.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Vu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Vu(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Hu.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Hu.prototype.children=function(e){if(this.overscaledZ>=e)return[new Hu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new Hu(t,this.wrap,t,r,n),new Hu(t,this.wrap,t,r+1,n),new Hu(t,this.wrap,t,r,n+1),new Hu(t,this.wrap,t,r+1,n+1)]},Hu.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Hu.prototype.wrapped=function(){return new Hu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Hu.prototype.unwrapTo=function(e){return new Hu(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Hu.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Hu.prototype.toUnwrapped=function(){return new Uu(this.wrap,this.canonical)},Hu.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Hu.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Bu(e.x-this.wrap,e.y))},Rn("CanonicalTileID",ju),Rn("OverscaledTileID",Hu,{omit:["posMatrix"]});var Gu=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return b('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var n=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var a=0;a<n;a++)this.data[this._idx(-1,a)]=this.data[this._idx(0,a)],this.data[this._idx(n,a)]=this.data[this._idx(n-1,a)],this.data[this._idx(a,-1)]=this.data[this._idx(a,0)],this.data[this._idx(a,n)]=this.data[this._idx(a,n-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(n,-1)]=this.data[this._idx(n-1,0)],this.data[this._idx(-1,n)]=this.data[this._idx(0,n-1)],this.data[this._idx(n,n)]=this.data[this._idx(n-1,n-1)]};Gu.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[n],r[n+1],r[n+2])},Gu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Gu.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Gu.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Gu.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Gu.prototype.getPixels=function(){return new po({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Gu.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var n=t*this.dim,a=t*this.dim+this.dim,i=r*this.dim,o=r*this.dim+this.dim;switch(t){case-1:n=a-1;break;case 1:a=n+1}switch(r){case-1:i=o-1;break;case 1:o=i+1}for(var s=-t*this.dim,l=-r*this.dim,u=i;u<o;u++)for(var c=n;c<a;c++)this.data[this._idx(c,u)]=e.data[this._idx(c+s,u+l)]},Rn("DEMData",Gu);var qu=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};qu.prototype.encode=function(e){return this._stringToNumber[e]},qu.prototype.decode=function(e){return this._numberToString[e]};var Yu=function(e,t,r,n,a){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=a},Wu={geometry:{configurable:!0}};Wu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Wu.geometry.set=function(e){this._geometry=e},Yu.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(Yu.prototype,Wu);var Xu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Xu.prototype.updateState=function(e,t,r){var n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},c(this.stateChanges[e][n],r),null===this.deletedStates[e])for(var a in this.deletedStates[e]={},this.state[e])a!==n&&(this.deletedStates[e][a]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][n])for(var i in this.deletedStates[e][n]={},this.state[e][n])r[i]||(this.deletedStates[e][n][i]=null);else for(var o in r)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][o]&&delete this.deletedStates[e][n][o]},Xu.prototype.removeFeatureState=function(e,t,r){if(null!==this.deletedStates[e]){var n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}},Xu.prototype.getState=function(e,t){var r=String(t),n=c({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var a=this.deletedStates[e][t];if(null===a)return{};for(var i in a)delete n[i]}return n},Xu.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Xu.prototype.coalesceChanges=function(e,t){var r={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var a={};for(var i in this.stateChanges[n])this.state[n][i]||(this.state[n][i]={}),c(this.state[n][i],this.stateChanges[n][i]),a[i]=this.state[n][i];r[n]=a}for(var o in this.deletedStates){this.state[o]=this.state[o]||{};var s={};if(null===this.deletedStates[o])for(var l in this.state[o])s[l]={},this.state[o][l]={};else for(var u in this.deletedStates[o]){if(null===this.deletedStates[o][u])this.state[o][u]={};else for(var f=0,h=Object.keys(this.deletedStates[o][u]);f<h.length;f+=1)delete this.state[o][u][h[f]];s[u]=this.state[o][u]}r[o]=r[o]||{},c(r[o],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var p in e)e[p].setFeatureState(r,t)};var Zu=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ln(8192,16,0),this.grid3D=new Ln(8192,16,0),this.featureIndexArray=new ri,this.promoteId=t};function Ku(e,t,r,n,a){return g(e,function(e,i){var o=t instanceof ha?t.get(i):null;return o&&o.evaluate?o.evaluate(r,n,a):o})}function Ju(e){for(var t=1/0,r=1/0,n=-1/0,a=-1/0,i=0,o=e;i<o.length;i+=1){var s=o[i];t=Math.min(t,s.x),r=Math.min(r,s.y),n=Math.max(n,s.x),a=Math.max(a,s.y)}return{minX:t,minY:r,maxX:n,maxY:a}}function Qu(e,t){return t-e}Zu.prototype.insert=function(e,t,r,n,a,i){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,a);for(var s=i?this.grid3D:this.grid,l=0;l<t.length;l++){for(var u=t[l],c=[1/0,1/0,-1/0,-1/0],f=0;f<u.length;f++){var h=u[f];c[0]=Math.min(c[0],h.x),c[1]=Math.min(c[1],h.y),c[2]=Math.max(c[2],h.x),c[3]=Math.max(c[3],h.y)}c[0]<8192&&c[1]<8192&&c[2]>=0&&c[3]>=0&&s.insert(o,c[0],c[1],c[2],c[3])}},Zu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new vs.VectorTile(new Gs(this.rawTileData)).layers,this.sourceLayerCoder=new qu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Zu.prototype.query=function(e,t,r,n){var i=this;this.loadVTLayers();for(var o=e.params||{},s=8192/e.tileSize/e.scale,l=rn(o.filter),u=e.queryGeometry,c=e.queryPadding*s,f=Ju(u),h=this.grid.query(f.minX-c,f.minY-c,f.maxX+c,f.maxY+c),p=Ju(e.cameraQueryGeometry),d=this.grid3D.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c,function(t,r,n,i){return function(e,t,r,n,i){for(var o=0,s=e;o<s.length;o+=1){var l=s[o];if(t<=l.x&&r<=l.y&&n>=l.x&&i>=l.y)return!0}var u=[new a(t,r),new a(t,i),new a(n,i),new a(n,r)];if(e.length>2)for(var c=0,f=u;c<f.length;c+=1)if(Wi(e,f[c]))return!0;for(var h=0;h<e.length-1;h++)if(Xi(e[h],e[h+1],u))return!0;return!1}(e.cameraQueryGeometry,t-c,r-c,n+c,i+c)}),v=0,m=d;v<m.length;v+=1)h.push(m[v]);h.sort(Qu);for(var g,y={},x=function(a){var c=h[a];if(c!==g){g=c;var f=i.featureIndexArray.get(c),p=null;i.loadMatchingFeature(y,f.bucketIndex,f.sourceLayerIndex,f.featureIndex,l,o.layers,o.availableImages,t,r,n,function(t,r,n){return p||(p=Ri(t)),r.queryIntersectsFeature(u,t,n,p,i.z,e.transform,s,e.pixelPosMatrix)})}},_=0;_<h.length;_++)x(_);return y},Zu.prototype.loadMatchingFeature=function(e,t,r,n,a,i,o,s,l,u,c){var f=this.bucketLayerIDs[t];if(!i||function(e,t){for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(i,f)){var h=this.sourceLayerCoder.decode(r),p=this.vtLayers[h].feature(n);if(a.filter(new aa(this.tileID.overscaledZ),p))for(var d=this.getId(p,h),v=0;v<f.length;v++){var m=f[v];if(!(i&&i.indexOf(m)<0)){var g=s[m];if(g){var y={};void 0!==d&&u&&(y=u.getState(g.sourceLayer||"_geojsonTileLayer",d));var x=l[m];x.paint=Ku(x.paint,g.paint,p,y,o),x.layout=Ku(x.layout,g.layout,p,y,o);var _=!c||c(p,g,y);if(_){var b=new Yu(p,this.z,this.x,this.y,d);b.layer=x;var w=e[m];void 0===w&&(w=e[m]=[]),w.push({featureIndex:n,feature:b,intersectionZ:_})}}}}}},Zu.prototype.lookupSymbolFeatures=function(e,t,r,n,a,i,o,s){var l={};this.loadVTLayers();for(var u=rn(a),c=0,f=e;c<f.length;c+=1)this.loadMatchingFeature(l,r,n,f[c],u,i,o,s,t);return l},Zu.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var n=0,a=r[t];n<a.length;n+=1)if(e===a[n])return!0;return!1},Zu.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r},Rn("FeatureIndex",Zu,{omit:["rawTileData","sourceLayerCoder"]});var $u=function(e,t){this.tileID=e,this.uid=h(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};$u.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<z.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},$u.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},$u.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var n in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var r={};if(!t)return r;for(var n=function(){var e=i[a],n=e.layerIds.map(function(e){return t.getLayer(e)}).filter(Boolean);if(0!==n.length){e.layers=n,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map(function(e){return n.filter(function(t){return t.id===e})[0]}));for(var o=0,s=n;o<s.length;o+=1)r[s[o].id]=e}},a=0,i=e;a<i.length;a+=1)n();return r}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var a=this.buckets[n];if(a instanceof fu){if(this.hasSymbolBuckets=!0,!r)break;a.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var i in this.buckets){var o=this.buckets[i];if(o instanceof fu&&o.hasRTLText){this.hasRTLText=!0,na.isLoading()||na.isLoaded()||"deferred"!==ta()||ra();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(l))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new Xa},$u.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},$u.prototype.getBucket=function(e){return this.buckets[e.id]},$u.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Eu(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Eu(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)},$u.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},$u.prototype.queryRenderedFeatures=function(e,t,r,n,a,i,o,s,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:a,scale:i,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:o,queryPadding:this.queryPadding*l},e,t,r):{}},$u.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var n=r.loadVTLayers(),a=t?t.sourceLayer:"",i=n._geojsonTileLayer||n[a];if(i)for(var o=rn(t&&t.filter),s=this.tileID.canonical,l=s.z,u=s.x,c=s.y,f={z:l,x:u,y:c},h=0;h<i.length;h++){var p=i.feature(h);if(o.filter(new aa(this.tileID.overscaledZ),p)){var d=r.getId(p,a),v=new Yu(p,l,u,c,d);v.tile=f,e.push(v)}}}},$u.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},$u.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},$u.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=A(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var n=Date.now(),a=!1;if(this.expirationTime>n)a=!1;else if(t)if(this.expirationTime<t)a=!0;else{var i=this.expirationTime-t;i?this.expirationTime=n+Math.max(i,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},$u.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},$u.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var n in this.buckets)if(t.style.hasLayer(n)){var a=this.buckets[n],i=a.layers[0].sourceLayer||"_geojsonTileLayer",o=r[i],s=e[i];if(o&&s&&0!==Object.keys(s).length){a.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=t&&t.style&&t.style.getLayer(n);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(a)))}}}},$u.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},$u.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z.now()},$u.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},$u.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=z.now()+e},$u.prototype.setDependencies=function(e,t){for(var r={},n=0,a=t;n<a.length;n+=1)r[a[n]]=!0;this.dependencies[e]=r},$u.prototype.hasDependency=function(e,t){for(var r=0,n=e;r<n.length;r+=1){var a=this.dependencies[n[r]];if(a)for(var i=0,o=t;i<o.length;i+=1)if(a[o[i]])return!0}return!1};var ec=self.performance,tc=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},ec.mark(this._marks.start)};tc.prototype.finish=function(){ec.mark(this._marks.end);var e=ec.getEntriesByName(this._marks.measure);return 0===e.length&&(ec.measure(this._marks.measure,this._marks.start,this._marks.end),e=ec.getEntriesByName(this._marks.measure),ec.clearMarks(this._marks.start),ec.clearMarks(this._marks.end),ec.clearMeasures(this._marks.measure)),e},e.Actor=Cu,e.AlphaImage=ho,e.CanonicalTileID=ju,e.CollisionBoxArray=Xa,e.Color=Je,e.DEMData=Gu,e.DataConstantProperty=pa,e.DictionaryCoder=qu,e.EXTENT=8192,e.ErrorEvent=ke,e.EvaluationParameters=aa,e.Event=Te,e.Evented=Ae,e.FeatureIndex=Zu,e.FillBucket=rs,e.FillExtrusionBucket=xs,e.ImageAtlas=dl,e.ImagePosition=hl,e.LineBucket=Cs,e.LngLat=Ou,e.LngLatBounds=Iu,e.MercatorCoordinate=Bu,e.ONE_EM=24,e.OverscaledTileID=Hu,e.Point=a,e.Point$1=a,e.Properties=ya,e.Protobuf=Gs,e.RGBAImage=po,e.RequestManager=V,e.RequestPerformance=tc,e.ResourceType=he,e.SegmentVector=ai,e.SourceFeatureState=Xu,e.StructArrayLayout1ui2=Ga,e.StructArrayLayout2f1f2i16=Ra,e.StructArrayLayout2i4=Aa,e.StructArrayLayout3ui6=Na,e.StructArrayLayout4i8=Ma,e.SymbolBucket=fu,e.Texture=Eu,e.Tile=$u,e.Transitionable=sa,e.Uniform1f=gi,e.Uniform1i=mi,e.Uniform2f=yi,e.Uniform3f=xi,e.Uniform4f=_i,e.UniformColor=bi,e.UniformMatrix4f=Ti,e.UnwrappedTileID=Uu,e.ValidationError=Ee,e.WritingMode=vl,e.ZoomHistory=Un,e.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.addDynamicAttributes=su,e.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var n=e.length,a=new Array(e.length),i=null;e.forEach(function(e,o){t(e,function(e,t){e&&(i=e),a[o]=t,0==--n&&r(i,a)})})},e.bezier=o,e.bindAll=v,e.browser=z,e.cacheEntryPossiblyAdded=function(e){++ce>oe&&(e.getActor().send("enforceCacheSizeLimit",ie),ce=0)},e.clamp=l,e.clearTileCache=function(e){var t=self.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},e.clipLine=jl,e.clone=function(e){var t=new eo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=x,e.clone$2=function(e){var t=new eo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.collisionCircleLayout=Bs,e.config=N,e.create=function(){var e=new eo(16);return eo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=function(){var e=new eo(9);return eo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},e.create$2=function(){var e=new eo(4);return eo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},e.createCommonjsModule=t,e.createExpression=Vr,e.createLayout=Ta,e.createStyleLayer=function(e){return"custom"===e.type?new _u(e):new bu[e.type](e)},e.cross=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2];return e[0]=a*l-i*s,e[1]=i*o-n*l,e[2]=n*s-a*o,e},e.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var a in t)if(!e(t[a],r[a]))return!1;return!0}return t===r},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.ease=s,e.emitValidationErrors=Cn,e.endsWith=m,e.enforceCacheSizeLimit=function(e){se(),Q&&Q.then(function(t){t.keys().then(function(r){for(var n=0;n<r.length-e;n++)t.delete(r[n])})})},e.evaluateSizeForFeature=Il,e.evaluateSizeForZoom=Ol,e.evaluateVariableOffset=$l,e.evented=ea,e.extend=c,e.featureFilter=rn,e.filterObject=y,e.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.getAnchorAlignment=Ml,e.getAnchorJustification=eu,e.getArrayBuffer=ye,e.getImage=_e,e.getJSON=function(e,t){return ge(c(e,{type:"json"}),t)},e.getRTLTextPluginStatus=ta,e.getReferrer=de,e.getVideo=function(e,t){var r,n,a=self.document.createElement("video");a.muted=!0,a.onloadstart=function(){t(null,a)};for(var i=0;i<e.length;i++){var o=self.document.createElement("source");r=e[i],n=void 0,(n=self.document.createElement("a")).href=r,(n.protocol!==self.document.location.protocol||n.host!==self.document.location.host)&&(a.crossOrigin="Anonymous"),o.src=e[i],a.appendChild(o)}return{cancel:function(){}}},e.identity=to,e.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=r*s-n*o,x=r*l-a*o,_=r*u-i*o,b=n*l-a*s,w=n*u-i*s,T=a*u-i*l,k=c*v-f*d,A=c*m-h*d,M=c*g-p*d,E=f*m-h*v,S=f*g-p*v,C=h*g-p*m,L=y*C-x*S+_*E+b*M-w*A+T*k;return L?(e[0]=(s*C-l*S+u*E)*(L=1/L),e[1]=(a*S-n*C-i*E)*L,e[2]=(v*T-m*w+g*b)*L,e[3]=(h*w-f*T-p*b)*L,e[4]=(l*M-o*C-u*A)*L,e[5]=(r*C-a*M+i*A)*L,e[6]=(m*_-d*T-g*x)*L,e[7]=(c*T-h*_+p*x)*L,e[8]=(o*S-s*M+u*k)*L,e[9]=(n*M-r*S-i*k)*L,e[10]=(d*w-v*_+g*y)*L,e[11]=(f*_-c*w-p*y)*L,e[12]=(s*A-o*E-l*k)*L,e[13]=(r*E-n*A+a*k)*L,e[14]=(v*x-d*b-m*y)*L,e[15]=(c*b-f*x+h*y)*L,e):null},e.isChar=Hn,e.isMapboxURL=G,e.keysDifference=function(e,t){var r=[];for(var n in e)n in t||r.push(n);return r},e.makeRequest=ge,e.mapObject=g,e.mercatorXfromLng=Ru,e.mercatorYfromLat=zu,e.mercatorZfromAltitude=Nu,e.mul=ao,e.multiply=ro,e.mvt=vs,e.normalize=function(e,t){var r=t[0],n=t[1],a=t[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},e.number=Ut,e.offscreenCanvasSupported=fe,e.ortho=function(e,t,r,n,a,i,o){var s=1/(t-r),l=1/(n-a),u=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(a+n)*l,e[14]=(o+i)*u,e[15]=1,e},e.parseGlyphPBF=function(e){return new Gs(e).readFields(ll,[])},e.pbf=Gs,e.performSymbolLayout=function(e,t,r,n,a,i,o){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var s=e.layers[0].layout,l=e.layers[0]._unevaluatedLayout._values,u={};if("composite"===e.textSizeData.kind){var c=e.textSizeData,f=c.maxZoom;u.compositeTextSizes=[l["text-size"].possiblyEvaluate(new aa(c.minZoom),o),l["text-size"].possiblyEvaluate(new aa(f),o)]}if("composite"===e.iconSizeData.kind){var h=e.iconSizeData,p=h.maxZoom;u.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new aa(h.minZoom),o),l["icon-size"].possiblyEvaluate(new aa(p),o)]}u.layoutTextSize=l["text-size"].possiblyEvaluate(new aa(e.zoom+1),o),u.layoutIconSize=l["icon-size"].possiblyEvaluate(new aa(e.zoom+1),o),u.textMaxSize=l["text-size"].possiblyEvaluate(new aa(18));for(var d=24*s.get("text-line-height"),v="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),m=s.get("text-keep-upright"),g=s.get("text-size"),y=function(){var i=_[x],l=s.get("text-font").evaluate(i,{},o).join(","),c=g.evaluate(i,{},o),f=u.layoutTextSize.evaluate(i,{},o),h=u.layoutIconSize.evaluate(i,{},o),p={horizontal:{},vertical:void 0},y=i.text,w=[0,0];if(y){var T=y.toString(),k=24*s.get("text-letter-spacing").evaluate(i,{},o),A=function(e){for(var t=0,r=e;t<r.length;t+=1)if(n=r[t].charCodeAt(0),Hn.Arabic(n)||Hn["Arabic Supplement"](n)||Hn["Arabic Extended-A"](n)||Hn["Arabic Presentation Forms-A"](n)||Hn["Arabic Presentation Forms-B"](n))return!1;var n;return!0}(T)?k:0,M=s.get("text-anchor").evaluate(i,{},o),E=s.get("text-variable-anchor");if(!E){var S=s.get("text-radial-offset").evaluate(i,{},o);w=S?$l(M,[24*S,Ql]):s.get("text-offset").evaluate(i,{},o).map(function(e){return 24*e})}var C=v?"center":s.get("text-justify").evaluate(i,{},o),L=s.get("symbol-placement"),I="point"===L?24*s.get("text-max-width").evaluate(i,{},o):0,O=function(){e.allowVerticalPlacement&&Vn(T)&&(p.vertical=yl(y,t,r,a,l,I,d,M,"left",A,w,vl.vertical,!0,L,f,c))};if(!v&&E){for(var P="auto"===C?E.map(function(e){return eu(e)}):[C],D=!1,R=0;R<P.length;R++){var z=P[R];if(!p.horizontal[z])if(D)p.horizontal[z]=p.horizontal[0];else{var N=yl(y,t,r,a,l,I,d,"center",z,A,w,vl.horizontal,!1,L,f,c);N&&(p.horizontal[z]=N,D=1===N.positionedLines.length)}}O()}else{"auto"===C&&(C=eu(M));var F=yl(y,t,r,a,l,I,d,M,C,A,w,vl.horizontal,!1,L,f,c);F&&(p.horizontal[C]=F),O(),Vn(T)&&v&&m&&(p.vertical=yl(y,t,r,a,l,I,d,M,C,A,w,vl.vertical,!1,L,f,c))}}var B=void 0,j=!1;if(i.icon&&i.icon.name){var U=n[i.icon.name];U&&(B=function(e,t,r){var n=Ml(r),a=t[0]-e.displaySize[0]*n.horizontalAlign,i=t[1]-e.displaySize[1]*n.verticalAlign;return{image:e,top:i,bottom:i+e.displaySize[1],left:a,right:a+e.displaySize[0]}}(a[i.icon.name],s.get("icon-offset").evaluate(i,{},o),s.get("icon-anchor").evaluate(i,{},o)),j=U.sdf,void 0===e.sdfIcons?e.sdfIcons=U.sdf:e.sdfIcons!==U.sdf&&b("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(U.pixelRatio!==e.pixelRatio||0!==s.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var H=ru(p.horizontal)||p.vertical;e.iconsInText=!!H&&H.iconsInText,(H||B)&&function(e,t,r,n,a,i,o,s,l,u,c){var f=i.textMaxSize.evaluate(t,{});void 0===f&&(f=o);var h,p=e.layers[0].layout,d=p.get("icon-offset").evaluate(t,{},c),v=ru(r.horizontal),m=o/24,g=e.tilePixelRatio*m,y=e.tilePixelRatio*f/24,x=e.tilePixelRatio*s,_=e.tilePixelRatio*p.get("symbol-spacing"),w=p.get("text-padding")*e.tilePixelRatio,T=p.get("icon-padding")*e.tilePixelRatio,k=p.get("text-max-angle")/180*Math.PI,A="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),M="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),E=p.get("symbol-placement"),S=_/2,C=p.get("icon-text-fit");n&&"none"!==C&&(e.allowVerticalPlacement&&r.vertical&&(h=Sl(n,r.vertical,C,p.get("icon-text-fit-padding"),d,m)),v&&(n=Sl(n,v,C,p.get("icon-text-fit-padding"),d,m)));var L=function(s,f){f.x<0||f.x>=8192||f.y<0||f.y>=8192||function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v,m,g,y,x,_,w,T,k,A){var M,E,S,C,L,I=e.addToLineVertexArray(t,r),O=0,P=0,D=0,R=0,z=-1,N=-1,F={},B=ui(""),j=0,U=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(j=(M=s.layout.get("text-offset").evaluate(_,{},k).map(function(e){return 24*e}))[0],U=M[1]):(j=24*s.layout.get("text-radial-offset").evaluate(_,{},k),U=Ql),e.allowVerticalPlacement&&n.vertical){var H=s.layout.get("text-rotate").evaluate(_,{},k)+90;C=new Yl(l,t,u,c,f,n.vertical,h,p,d,H),o&&(L=new Yl(l,t,u,c,f,o,m,g,d,H))}if(a){var V=s.layout.get("icon-rotate").evaluate(_,{}),G="none"!==s.layout.get("icon-text-fit"),q=Ul(a,V,T,G),Y=o?Ul(o,V,T,G):void 0;S=new Yl(l,t,u,c,f,a,m,g,!1,V),O=4*q.length;var W=e.iconSizeData,X=null;"source"===W.kind?(X=[128*s.layout.get("icon-size").evaluate(_,{})])[0]>32640&&b(e.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===W.kind&&((X=[128*w.compositeIconSizes[0].evaluate(_,{},k),128*w.compositeIconSizes[1].evaluate(_,{},k)])[0]>32640||X[1]>32640)&&b(e.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),e.addSymbols(e.icon,q,X,x,y,_,!1,t,I.lineStartIndex,I.lineLength,-1,k),z=e.icon.placedSymbolArray.length-1,Y&&(P=4*Y.length,e.addSymbols(e.icon,Y,X,x,y,_,vl.vertical,t,I.lineStartIndex,I.lineLength,-1,k),N=e.icon.placedSymbolArray.length-1)}for(var Z in n.horizontal){var K=n.horizontal[Z];if(!E){B=ui(K.text);var J=s.layout.get("text-rotate").evaluate(_,{},k);E=new Yl(l,t,u,c,f,K,h,p,d,J)}var Q=1===K.positionedLines.length;if(D+=tu(e,t,K,i,s,d,_,v,I,n.vertical?vl.horizontal:vl.horizontalOnly,Q?Object.keys(n.horizontal):[Z],F,z,w,k),Q)break}n.vertical&&(R+=tu(e,t,n.vertical,i,s,d,_,v,I,vl.vertical,["vertical"],F,N,w,k));var $=E?E.boxStartIndex:e.collisionBoxArray.length,ee=E?E.boxEndIndex:e.collisionBoxArray.length,te=C?C.boxStartIndex:e.collisionBoxArray.length,re=C?C.boxEndIndex:e.collisionBoxArray.length,ne=S?S.boxStartIndex:e.collisionBoxArray.length,ae=S?S.boxEndIndex:e.collisionBoxArray.length,ie=L?L.boxStartIndex:e.collisionBoxArray.length,oe=L?L.boxEndIndex:e.collisionBoxArray.length,se=-1,le=function(e,t){return e&&e.circleDiameter?Math.max(e.circleDiameter,t):t};se=le(E,se),se=le(C,se),se=le(S,se);var ue=(se=le(L,se))>-1?1:0;ue&&(se*=A/24),e.glyphOffsetArray.length>=fu.MAX_GLYPHS&&b("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==_.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,_.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical||-1,z,N,B,$,ee,te,re,ne,ae,ie,oe,u,D,R,O,P,ue,0,h,j,U,se)}(e,f,s,r,n,a,h,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,g,w,A,l,x,T,M,d,t,i,u,c,o)};if("line"===E)for(var I=0,O=jl(t.geometry,0,0,8192,8192);I<O.length;I+=1)for(var P=O[I],D=0,R=Bl(P,_,k,r.vertical||v,n,24,y,e.overscaling,8192);D<R.length;D+=1){var z=R[D];v&&nu(e,v.text,S,z)||L(P,z)}else if("line-center"===E)for(var N=0,F=t.geometry;N<F.length;N+=1){var B=F[N];if(B.length>1){var j=Fl(B,k,r.vertical||v,n,24,y);j&&L(B,j)}}else if("Polygon"===t.type)for(var U=0,H=Qo(t.geometry,0);U<H.length;U+=1){var V=H[U],G=Zl(V,16);L(V[0],new Cl(G.x,G.y,0))}else if("LineString"===t.type)for(var q=0,Y=t.geometry;q<Y.length;q+=1){var W=Y[q];L(W,new Cl(W[0].x,W[0].y,0))}else if("Point"===t.type)for(var X=0,Z=t.geometry;X<Z.length;X+=1)for(var K=0,J=Z[X];K<J.length;K+=1){var Q=J[K];L([Q],new Cl(Q.x,Q.y,0))}}(e,i,p,B,n,u,f,h,w,j,o)},x=0,_=e.features;x<_.length;x+=1)y();i&&e.generateCollisionDebugBuffers()},e.perspective=function(e,t,r,n,a){var i,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(e[10]=(a+n)*(i=1/(n-a)),e[14]=2*a*n*i):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){for(var r={},n=0;n<t.length;n++){var a=t[n];a in e&&(r[a]=e[a])}return r},e.plugin=na,e.polygonIntersectsPolygon=Fi,e.postMapLoadEvent=ae,e.postTurnstileEvent=re,e.potpack=fl,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Rn,e.registerForPluginStateChange=function(e){return e({pluginStatus:Kn,pluginURL:Jn}),ea.on("pluginStateChange",e),e},e.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*s,e[1]=a*l+o*s,e[2]=n*-s+i*l,e[3]=a*-s+o*l,e},e.rotateX=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+u*n,e[5]=o*a+c*n,e[6]=s*a+f*n,e[7]=l*a+h*n,e[8]=u*a-i*n,e[9]=c*a-o*n,e[10]=f*a-s*n,e[11]=h*a-l*n,e},e.rotateZ=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+u*n,e[1]=o*a+c*n,e[2]=s*a+f*n,e[3]=l*a+h*n,e[4]=u*a-i*n,e[5]=c*a-o*n,e[6]=f*a-s*n,e[7]=h*a-l*n,e},e.scale=function(e,t,r){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.setCacheLimits=function(e,t){ie=e,oe=t},e.setRTLTextPlugin=function(e,t,r){if(void 0===r&&(r=!1),"deferred"===Kn||"loading"===Kn||"loaded"===Kn)throw new Error("setRTLTextPlugin cannot be called multiple times.");Jn=z.resolveURL(e),Kn="deferred",Zn=t,$n(),r||ra()},e.sphericalToCartesian=function(e){var t=e[0],r=e[1],n=e[2];return r+=90,r*=Math.PI/180,n*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(n),y:t*Math.sin(r)*Math.sin(n),z:t*Math.cos(n)}},e.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},e.styleSpec=Me,e.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.symbolSize=Pl,e.transformMat3=function(e,t,r){var n=t[0],a=t[1],i=t[2];return e[0]=n*r[0]+a*r[3]+i*r[6],e[1]=n*r[1]+a*r[4]+i*r[7],e[2]=n*r[2]+a*r[5]+i*r[8],e},e.transformMat4=io,e.translate=function(e,t,r){var n,a,i,o,s,l,u,c,f,h,p,d,v=r[0],m=r[1],g=r[2];return t===e?(e[12]=t[0]*v+t[4]*m+t[8]*g+t[12],e[13]=t[1]*v+t[5]*m+t[9]*g+t[13],e[14]=t[2]*v+t[6]*m+t[10]*g+t[14],e[15]=t[3]*v+t[7]*m+t[11]*g+t[15]):(a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],p=t[10],d=t[11],e[0]=n=t[0],e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=f,e[9]=h,e[10]=p,e[11]=d,e[12]=n*v+s*m+f*g+t[12],e[13]=a*v+l*m+h*g+t[13],e[14]=i*v+u*m+p*g+t[14],e[15]=o*v+c*m+d*g+t[15]),e},e.triggerPluginCompletionEvent=Qn,e.uniqueId=h,e.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers."+r+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},e.validateLight=Mn,e.validateStyle=An,e.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},e.vectorTile=vs,e.version="1.10.1",e.warnOnce=b,e.webpSupported=F,e.window=self,e.wrap=u});n(["./shared"],function(e){"use strict";function t(e){var r=typeof e;if("number"===r||"boolean"===r||"string"===r||null==e)return JSON.stringify(e);if(Array.isArray(e)){for(var n="[",a=0,i=e;a<i.length;a+=1)n+=t(i[a])+",";return n+"]"}for(var o=Object.keys(e).sort(),s="{",l=0;l<o.length;l++)s+=JSON.stringify(o[l])+":"+t(e[o[l]])+",";return s+"}"}function r(r){for(var n="",a=0,i=e.refProperties;a<i.length;a+=1)n+="/"+t(r[i[a]]);return n}var n=function(e){this.keyCache={},e&&this.replace(e)};n.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},n.prototype.update=function(t,n){for(var a=this,i=0,o=t;i<o.length;i+=1){var s=o[i];this._layerConfigs[s.id]=s;var l=this._layers[s.id]=e.createStyleLayer(s);l._featureFilter=e.featureFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var u=0,c=n;u<c.length;u+=1){var f=c[u];delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f]}this.familiesBySource={};for(var h=0,p=function(e,t){for(var n={},a=0;a<e.length;a++){var i=t&&t[e[a].id]||r(e[a]);t&&(t[e[a].id]=i);var o=n[i];o||(o=n[i]=[]),o.push(e[a])}var s=[];for(var l in n)s.push(n[l]);return s}(e.values(this._layerConfigs),this.keyCache);h<p.length;h+=1){var d=p[h].map(function(e){return a._layers[e.id]}),v=d[0];if("none"!==v.visibility){var m=v.source||"",g=this.familiesBySource[m];g||(g=this.familiesBySource[m]={});var y=v.sourceLayer||"_geojsonTileLayer",x=g[y];x||(x=g[y]=[]),x.push(d)}}};var a=function(t){var r={},n=[];for(var a in t){var i=t[a],o=r[a]={};for(var s in i){var l=i[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};n.push(u),o[s]={rect:u,metrics:l.metrics}}}}var c=e.potpack(n),f=new e.AlphaImage({width:c.w||1,height:c.h||1});for(var h in t){var p=t[h];for(var d in p){var v=p[+d];if(v&&0!==v.bitmap.width&&0!==v.bitmap.height){var m=r[h][d].rect;e.AlphaImage.copy(v.bitmap,f,{x:0,y:0},{x:m.x+1,y:m.y+1},v.bitmap)}}}this.image=f,this.positions=r};e.register("GlyphAtlas",a);var i=function(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId};function o(t,r,n){for(var a=new e.EvaluationParameters(r),i=0,o=t;i<o.length;i+=1)o[i].recalculate(a,n)}function s(t,r){var n=e.getArrayBuffer(t.request,function(t,n,a,i){t?r(t):n&&r(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(n)),rawData:n,cacheControl:a,expires:i})});return function(){n.cancel(),r()}}i.prototype.parse=function(t,r,n,i,s){var l=this;this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;var u=new e.DictionaryCoder(Object.keys(t.layers).sort()),c=new e.FeatureIndex(this.tileID,this.promoteId);c.bucketLayerIDs=[];var f,h,p,d,v={},m={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},g=r.familiesBySource[this.source];for(var y in g){var x=t.layers[y];if(x){1===x.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+y+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var _=u.encode(y),b=[],w=0;w<x.length;w++){var T=x.feature(w),k=c.getId(T,y);b.push({feature:T,id:k,index:w,sourceLayerIndex:_})}for(var A=0,M=g[y];A<M.length;A+=1){var E=M[A],S=E[0];S.minzoom&&this.zoom<Math.floor(S.minzoom)||S.maxzoom&&this.zoom>=S.maxzoom||"none"!==S.visibility&&(o(E,this.zoom,n),(v[S.id]=S.createBucket({index:c.bucketLayerIDs.length,layers:E,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_,sourceID:this.source})).populate(b,m,this.tileID.canonical),c.bucketLayerIDs.push(E.map(function(e){return e.id})))}}}var C=e.mapObject(m.glyphDependencies,function(e){return Object.keys(e).map(Number)});Object.keys(C).length?i.send("getGlyphs",{uid:this.uid,stacks:C},function(e,t){f||(f=e,h=t,O.call(l))}):h={};var L=Object.keys(m.iconDependencies);L.length?i.send("getImages",{icons:L,source:this.source,tileID:this.tileID,type:"icons"},function(e,t){f||(f=e,p=t,O.call(l))}):p={};var I=Object.keys(m.patternDependencies);function O(){if(f)return s(f);if(h&&p&&d){var t=new a(h),r=new e.ImageAtlas(p,d);for(var i in v){var l=v[i];l instanceof e.SymbolBucket?(o(l.layers,this.zoom,n),e.performSymbolLayout(l,h,t.positions,p,r.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof e.LineBucket||l instanceof e.FillBucket||l instanceof e.FillExtrusionBucket)&&(o(l.layers,this.zoom,n),l.addFeatures(m,this.tileID.canonical,r.patternPositions))}this.status="done",s(null,{buckets:e.values(v).filter(function(e){return!e.isEmpty()}),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:r,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?t.positions:null})}}I.length?i.send("getImages",{icons:I,source:this.source,tileID:this.tileID,type:"patterns"},function(e,t){f||(f=e,d=t,O.call(l))}):d={},O.call(this)};var l=function(e,t,r,n){this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=n||s,this.loading={},this.loaded={}};l.prototype.loadTile=function(t,r){var n=this,a=t.uid;this.loading||(this.loading={});var o=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request),s=this.loading[a]=new i(t);s.abort=this.loadVectorData(t,function(t,i){if(delete n.loading[a],t||!i)return s.status="done",n.loaded[a]=s,r(t);var l=i.rawData,u={};i.expires&&(u.expires=i.expires),i.cacheControl&&(u.cacheControl=i.cacheControl);var c={};if(o){var f=o.finish();f&&(c.resourceTiming=JSON.parse(JSON.stringify(f)))}s.vectorTile=i.vectorTile,s.parse(i.vectorTile,n.layerIndex,n.availableImages,n.actor,function(t,n){if(t||!n)return r(t);r(null,e.extend({rawTileData:l.slice(0)},n,u,c))}),n.loaded=n.loaded||{},n.loaded[a]=s})},l.prototype.reloadTile=function(e,t){var r=this,n=this.loaded,a=e.uid,i=this;if(n&&n[a]){var o=n[a];o.showCollisionBoxes=e.showCollisionBoxes;var s=function(e,n){var a=o.reloadCallback;a&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,r.availableImages,i.actor,a)),t(e,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},l.prototype.abortTile=function(e,t){var r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),t()},l.prototype.removeTile=function(e,t){var r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()};var u=e.window.ImageBitmap,c=function(){this.loaded={}};function f(e,t){if(0!==e.length){h(e[0],t);for(var r=1;r<e.length;r++)h(e[r],!t)}}function h(e,t){for(var r=0,n=0,a=e.length,i=a-1;n<a;i=n++)r+=(e[n][0]-e[i][0])*(e[i][1]+e[n][1]);r>=0!=!!t&&e.reverse()}c.prototype.loadTile=function(t,r){var n=t.uid,a=t.encoding,i=t.rawImageData,o=u&&i instanceof u?this.getImageData(i):i,s=new e.DEMData(n,o,a);this.loaded=this.loaded||{},this.loaded[n]=s,r(null,s)},c.prototype.getImageData=function(t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);var r=this.offscreenCanvasContext.getImageData(-1,-1,t.width+2,t.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:r.width,height:r.height},r.data)},c.prototype.removeTile=function(e){var t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]};var p=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,d=function(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))};d.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],r=0,n=this._feature.geometry;r<n.length;r+=1){var a=n[r];t.push([new e.Point$1(a[0],a[1])])}return t}for(var i=[],o=0,s=this._feature.geometry;o<s.length;o+=1){for(var l=[],u=0,c=s[o];u<c.length;u+=1){var f=c[u];l.push(new e.Point$1(f[0],f[1]))}i.push(l)}return i},d.prototype.toGeoJSON=function(e,t,r){return p.call(this,e,t,r)};var v=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t};v.prototype.feature=function(e){return new d(this._features[e])};var m=e.vectorTile.VectorTileFeature,g=y;function y(e,t){this.options=t||{},this.features=e,this.length=e.length}function x(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}y.prototype.feature=function(e){return new x(this.features[e],this.options.extent)},x.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){for(var n=t[r],a=[],i=0;i<n.length;i++)a.push(new e.Point$1(n[i][0],n[i][1]));this.geometry.push(a)}return this.geometry},x.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,a=-1/0,i=0;i<e.length;i++)for(var o=e[i],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),a=Math.max(a,l.y)}return[t,n,r,a]},x.prototype.toGeoJSON=m.prototype.toGeoJSON;var _=w,b=g;function w(t){var r=new e.pbf;return function(e,t){for(var r in e.layers)t.writeMessage(3,T,e.layers[r])}(t,r),r.finish()}function T(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,k,n);var a=n.keys;for(r=0;r<a.length;r++)t.writeStringField(3,a[r]);var i=n.values;for(r=0;r<i.length;r++)t.writeMessage(4,C,i[r])}function k(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,A,e),t.writeVarintField(3,r.type),t.writeMessage(4,S,r)}function A(e,t){var r=e.feature,n=e.keys,a=e.values,i=e.keycache,o=e.valuecache;for(var s in r.properties){var l=i[s];void 0===l&&(n.push(s),i[s]=l=n.length-1),t.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var f=c+":"+u,h=o[f];void 0===h&&(a.push(u),o[f]=h=a.length-1),t.writeVarint(h)}}function M(e,t){return(t<<3)+(7&e)}function E(e){return e<<1^e>>31}function S(e,t){for(var r=e.loadGeometry(),n=e.type,a=0,i=0,o=r.length,s=0;s<o;s++){var l=r[s],u=1;1===n&&(u=l.length),t.writeVarint(M(1,u));for(var c=3===n?l.length-1:l.length,f=0;f<c;f++){1===f&&1!==n&&t.writeVarint(M(2,c-1));var h=l[f].x-a,p=l[f].y-i;t.writeVarint(E(h)),t.writeVarint(E(p)),a+=h,i+=p}3===n&&t.writeVarint(M(7,1))}}function C(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function L(e,t,r,n){I(e,r,n),I(t,2*r,2*n),I(t,2*r+1,2*n+1)}function I(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function O(e,t,r,n){var a=e-r,i=t-n;return a*a+i*i}_.fromVectorTileJs=w,_.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var n in e)r[n]=new g(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return w({layers:r})},_.GeoJSONWrapper=b;var P=function(e){return e[0]},D=function(e){return e[1]},R=function(e,t,r,n,a){void 0===t&&(t=P),void 0===r&&(r=D),void 0===n&&(n=64),void 0===a&&(a=Float64Array),this.nodeSize=n,this.points=e;for(var i=e.length<65536?Uint16Array:Uint32Array,o=this.ids=new i(e.length),s=this.coords=new a(2*e.length),l=0;l<e.length;l++)o[l]=l,s[2*l]=t(e[l]),s[2*l+1]=r(e[l]);!function e(t,r,n,a,i,o){if(!(i-a<=n)){var s=a+i>>1;!function e(t,r,n,a,i,o){for(;i>a;){if(i-a>600){var s=i-a+1,l=n-a+1,u=Math.log(s),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,r,n,Math.max(a,Math.floor(n-l*c/s+f)),Math.min(i,Math.floor(n+(s-l)*c/s+f)),o)}var h=r[2*n+o],p=a,d=i;for(L(t,r,a,n),r[2*i+o]>h&&L(t,r,a,i);p<d;){for(L(t,r,p,d),p++,d--;r[2*p+o]<h;)p++;for(;r[2*d+o]>h;)d--}r[2*a+o]===h?L(t,r,a,d):L(t,r,++d,i),d<=n&&(a=d+1),n<=d&&(i=d-1)}}(t,r,s,a,i,o%2),e(t,r,n,a,s-1,o+1),e(t,r,n,s+1,i,o+1)}}(o,s,n,0,o.length-1,0)};R.prototype.range=function(e,t,r,n){return function(e,t,r,n,a,i,o){for(var s,l,u=[0,e.length-1,0],c=[];u.length;){var f=u.pop(),h=u.pop(),p=u.pop();if(h-p<=o)for(var d=p;d<=h;d++)l=t[2*d+1],(s=t[2*d])>=r&&s<=a&&l>=n&&l<=i&&c.push(e[d]);else{var v=Math.floor((p+h)/2);l=t[2*v+1],(s=t[2*v])>=r&&s<=a&&l>=n&&l<=i&&c.push(e[v]);var m=(f+1)%2;(0===f?r<=s:n<=l)&&(u.push(p),u.push(v-1),u.push(m)),(0===f?a>=s:i>=l)&&(u.push(v+1),u.push(h),u.push(m))}}return c}(this.ids,this.coords,e,t,r,n,this.nodeSize)},R.prototype.within=function(e,t,r){return function(e,t,r,n,a,i){for(var o=[0,e.length-1,0],s=[],l=a*a;o.length;){var u=o.pop(),c=o.pop(),f=o.pop();if(c-f<=i)for(var h=f;h<=c;h++)O(t[2*h],t[2*h+1],r,n)<=l&&s.push(e[h]);else{var p=Math.floor((f+c)/2),d=t[2*p],v=t[2*p+1];O(d,v,r,n)<=l&&s.push(e[p]);var m=(u+1)%2;(0===u?r-a<=d:n-a<=v)&&(o.push(f),o.push(p-1),o.push(m)),(0===u?r+a>=d:n+a>=v)&&(o.push(p+1),o.push(c),o.push(m))}}return s}(this.ids,this.coords,e,t,r,this.nodeSize)};var z={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},N=function(e){this.options=G(Object.create(z),e),this.trees=new Array(this.options.maxZoom+1)};function F(e,t,r,n,a){return{x:e,y:t,zoom:1/0,id:r,parentId:-1,numPoints:n,properties:a}}function B(e,t){var r=e.geometry.coordinates,n=r[1];return{x:H(r[0]),y:V(n),zoom:1/0,index:t,parentId:-1}}function j(e){return{type:"Feature",id:e.id,properties:U(e),geometry:{type:"Point",coordinates:[(n=e.x,360*(n-.5)),(t=e.y,r=(180-360*t)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var t,r,n}function U(e){var t=e.numPoints,r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return G(G({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function H(e){return e/360+.5}function V(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function G(e,t){for(var r in t)e[r]=t[r];return e}function q(e){return e.x}function Y(e){return e.y}function W(e,t,r,n,a,i){var o=a-r,s=i-n;if(0!==o||0!==s){var l=((e-r)*o+(t-n)*s)/(o*o+s*s);l>1?(r=a,n=i):l>0&&(r+=o*l,n+=s*l)}return(o=e-r)*o+(s=t-n)*s}function X(e,t,r,n){var a={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)Z(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)Z(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var a=0;a<t[n].length;a++)Z(e,t[n][a])}(a),a}function Z(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function K(e,t,r,n){if(t.geometry){var a=t.geometry.coordinates,i=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===i)J(a,s);else if("MultiPoint"===i)for(var u=0;u<a.length;u++)J(a[u],s);else if("LineString"===i)Q(a,s,o,!1);else if("MultiLineString"===i){if(r.lineMetrics){for(u=0;u<a.length;u++)Q(a[u],s=[],o,!1),e.push(X(l,"LineString",s,t.properties));return}$(a,s,o,!1)}else if("Polygon"===i)$(a,s,o,!0);else{if("MultiPolygon"!==i){if("GeometryCollection"===i){for(u=0;u<t.geometry.geometries.length;u++)K(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<a.length;u++){var c=[];$(a[u],c,o,!0),s.push(c)}}e.push(X(l,i,s,t.properties))}}function J(e,t){t.push(ee(e[0])),t.push(te(e[1])),t.push(0)}function Q(e,t,r,n){for(var a,i,o=0,s=0;s<e.length;s++){var l=ee(e[s][0]),u=te(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(o+=n?(a*u-l*i)/2:Math.sqrt(Math.pow(l-a,2)+Math.pow(u-i,2))),a=l,i=u}var c=t.length-3;t[2]=1,function e(t,r,n,a){for(var i,o=a,s=n-r>>1,l=n-r,u=t[r],c=t[r+1],f=t[n],h=t[n+1],p=r+3;p<n;p+=3){var d=W(t[p],t[p+1],u,c,f,h);if(d>o)i=p,o=d;else if(d===o){var v=Math.abs(p-s);v<l&&(i=p,l=v)}}o>a&&(i-r>3&&e(t,r,i,a),t[i+2]=o,n-i>3&&e(t,i,n,a))}(t,0,c,r),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function $(e,t,r,n){for(var a=0;a<e.length;a++){var i=[];Q(e[a],i,r,n),t.push(i)}}function ee(e){return e/360+.5}function te(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function re(e,t,r,n,a,i,o,s){if(n/=t,i>=(r/=t)&&o<n)return e;if(o<r||i>=n)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],f=c.geometry,h=c.type,p=0===a?c.minX:c.minY,d=0===a?c.maxX:c.maxY;if(p>=r&&d<n)l.push(c);else if(!(d<r||p>=n)){var v=[];if("Point"===h||"MultiPoint"===h)ne(f,v,r,n,a);else if("LineString"===h)ae(f,v,r,n,a,!1,s.lineMetrics);else if("MultiLineString"===h)oe(f,v,r,n,a,!1);else if("Polygon"===h)oe(f,v,r,n,a,!0);else if("MultiPolygon"===h)for(var m=0;m<f.length;m++){var g=[];oe(f[m],g,r,n,a,!0),g.length&&v.push(g)}if(v.length){if(s.lineMetrics&&"LineString"===h){for(m=0;m<v.length;m++)l.push(X(c.id,h,v[m],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===v.length?(h="LineString",v=v[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===v.length?"Point":"MultiPoint"),l.push(X(c.id,h,v,c.tags))}}}return l.length?l:null}function ne(e,t,r,n,a){for(var i=0;i<e.length;i+=3){var o=e[i+a];o>=r&&o<=n&&(t.push(e[i]),t.push(e[i+1]),t.push(e[i+2]))}}function ae(e,t,r,n,a,i,o){for(var s,l,u=ie(e),c=0===a?le:ue,f=e.start,h=0;h<e.length-3;h+=3){var p=e[h],d=e[h+1],v=e[h+2],m=e[h+3],g=e[h+4],y=0===a?p:d,x=0===a?m:g,_=!1;o&&(s=Math.sqrt(Math.pow(p-m,2)+Math.pow(d-g,2))),y<r?x>r&&(l=c(u,p,d,m,g,r),o&&(u.start=f+s*l)):y>n?x<n&&(l=c(u,p,d,m,g,n),o&&(u.start=f+s*l)):se(u,p,d,v),x<r&&y>=r&&(l=c(u,p,d,m,g,r),_=!0),x>n&&y<=n&&(l=c(u,p,d,m,g,n),_=!0),!i&&_&&(o&&(u.end=f+s*l),t.push(u),u=ie(e)),o&&(f+=s)}var b=e.length-3;p=e[b],d=e[b+1],v=e[b+2],(y=0===a?p:d)>=r&&y<=n&&se(u,p,d,v),b=u.length-3,i&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&se(u,u[0],u[1],u[2]),u.length&&t.push(u)}function ie(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function oe(e,t,r,n,a,i){for(var o=0;o<e.length;o++)ae(e[o],t,r,n,a,i,!1)}function se(e,t,r,n){e.push(t),e.push(r),e.push(n)}function le(e,t,r,n,a,i){var o=(i-t)/(n-t);return e.push(i),e.push(r+(a-r)*o),e.push(1),o}function ue(e,t,r,n,a,i){var o=(i-r)/(a-r);return e.push(t+(n-t)*o),e.push(i),e.push(1),o}function ce(e,t){for(var r=[],n=0;n<e.length;n++){var a,i=e[n],o=i.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)a=fe(i.geometry,t);else if("MultiLineString"===o||"Polygon"===o){a=[];for(var s=0;s<i.geometry.length;s++)a.push(fe(i.geometry[s],t))}else if("MultiPolygon"===o)for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(fe(i.geometry[s][u],t));a.push(l)}r.push(X(i.id,o,a,i.tags))}return r}function fe(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function he(e,t){if(e.transformed)return e;var r,n,a,i=1<<e.z,o=e.x,s=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(pe(u[n],u[n+1],t,i,o,s));else for(n=0;n<u.length;n++){var f=[];for(a=0;a<u[n].length;a+=2)f.push(pe(u[n][a],u[n][a+1],t,i,o,s));l.geometry.push(f)}}return e.transformed=!0,e}function pe(e,t,r,n,a,i){return[Math.round(r*(e*n-a)),Math.round(r*(t*n-i))]}function de(e,t,r,n,a){for(var i=t===a.maxZoom?0:a.tolerance/((1<<t)*a.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,ve(o,e[s],i,a);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,f=e[s].maxY;l<o.minX&&(o.minX=l),u<o.minY&&(o.minY=u),c>o.maxX&&(o.maxX=c),f>o.maxY&&(o.maxY=f)}return o}function ve(e,t,r,n){var a=t.geometry,i=t.type,o=[];if("Point"===i||"MultiPoint"===i)for(var s=0;s<a.length;s+=3)o.push(a[s]),o.push(a[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===i)me(o,a,e,r,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(s=0;s<a.length;s++)me(o,a[s],e,r,"Polygon"===i,0===s);else if("MultiPolygon"===i)for(var l=0;l<a.length;l++){var u=a[l];for(s=0;s<u.length;s++)me(o,u[s],e,r,!0,0===s)}if(o.length){var c=t.tags||null;if("LineString"===i&&n.lineMetrics){for(var f in c={},t.tags)c[f]=t.tags[f];c.mapbox_clip_start=a.start/a.size,c.mapbox_clip_end=a.end/a.size}var h={geometry:o,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:c};null!==t.id&&(h.id=t.id),e.features.push(h)}}function me(e,t,r,n,a,i){var o=n*n;if(n>0&&t.size<(a?o:n))r.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>o)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;a&&function(e,t){for(var r=0,n=0,a=e.length,i=a-2;n<a;i=n,n+=2)r+=(e[n]-e[i])*(e[n+1]+e[i+1]);if(r>0===t)for(n=0,a=e.length;n<a/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[a-2-n],e[n+1]=e[a-1-n],e[a-2-n]=o,e[a-1-n]=s}}(s,i),e.push(s)}}function ge(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)K(r,e.features[n],t,n);else K(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var r=t.buffer/t.extent,n=e,a=re(e,1,-1-r,r,0,-1,2,t),i=re(e,1,1-r,2+r,0,-1,2,t);return(a||i)&&(n=re(e,1,-r,1+r,0,-1,2,t)||[],a&&(n=ce(a,1).concat(n)),i&&(n=n.concat(ce(i,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ye(e,t,r){return 32*((1<<e)*r+t)+e}function xe(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);var a=new v(n.features),i=_(a);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),t(null,{vectorTile:a,rawData:i.buffer})}N.prototype.load=function(e){var t=this.options,r=t.log,n=t.minZoom,a=t.maxZoom,i=t.nodeSize;r&&console.time("total time");var o="prepare "+e.length+" points";r&&console.time(o),this.points=e;for(var s=[],l=0;l<e.length;l++)e[l].geometry&&s.push(B(e[l],l));this.trees[a+1]=new R(s,q,Y,i,Float32Array),r&&console.timeEnd(o);for(var u=a;u>=n;u--){var c=+Date.now();s=this._cluster(s,u),this.trees[u]=new R(s,q,Y,i,Float32Array),r&&console.log("z%d: %d clusters in %dms",u,s.length,+Date.now()-c)}return r&&console.timeEnd("total time"),this},N.prototype.getClusters=function(e,t){var r=((e[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,e[1])),a=180===e[2]?180:((e[2]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,a=180;else if(r>a){var o=this.getClusters([r,n,180,i],t),s=this.getClusters([-180,n,a,i],t);return o.concat(s)}for(var l=this.trees[this._limitZoom(t)],u=[],c=0,f=l.range(H(r),V(i),H(a),V(n));c<f.length;c+=1){var h=l.points[f[c]];u.push(h.numPoints?j(h):this.points[h.index])}return u},N.prototype.getChildren=function(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",a=this.trees[r];if(!a)throw new Error(n);var i=a.points[t];if(!i)throw new Error(n);for(var o=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=[],l=0,u=a.within(i.x,i.y,o);l<u.length;l+=1){var c=a.points[u[l]];c.parentId===e&&s.push(c.numPoints?j(c):this.points[c.index])}if(0===s.length)throw new Error(n);return s},N.prototype.getLeaves=function(e,t,r){var n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n},N.prototype.getTile=function(e,t,r){var n=this.trees[this._limitZoom(e)],a=Math.pow(2,e),i=this.options,o=i.radius/i.extent,s=(r-o)/a,l=(r+1+o)/a,u={features:[]};return this._addTileFeatures(n.range((t-o)/a,s,(t+1+o)/a,l),n.points,t,r,a,u),0===t&&this._addTileFeatures(n.range(1-o/a,s,1,l),n.points,a,r,a,u),t===a-1&&this._addTileFeatures(n.range(0,s,o/a,l),n.points,-1,r,a,u),u.features.length?u:null},N.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t},N.prototype._appendLeaves=function(e,t,r,n,a){for(var i=0,o=this.getChildren(t);i<o.length;i+=1){var s=o[i],l=s.properties;if(l&&l.cluster?a+l.point_count<=n?a+=l.point_count:a=this._appendLeaves(e,l.cluster_id,r,n,a):a<n?a++:e.push(s),e.length===r)break}return a},N.prototype._addTileFeatures=function(e,t,r,n,a,i){for(var o=0,s=e;o<s.length;o+=1){var l=t[s[o]],u=l.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(l.x*a-r)),Math.round(this.options.extent*(l.y*a-n))]],tags:u?U(l):this.points[l.index].properties},f=void 0;u?f=l.id:this.options.generateId?f=l.index:this.points[l.index].id&&(f=this.points[l.index].id),void 0!==f&&(c.id=f),i.features.push(c)}},N.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(e,this.options.maxZoom+1))},N.prototype._cluster=function(e,t){for(var r=[],n=this.options,a=n.reduce,i=n.radius/(n.extent*Math.pow(2,t)),o=0;o<e.length;o++){var s=e[o];if(!(s.zoom<=t)){s.zoom=t;for(var l=this.trees[t+1],u=l.within(s.x,s.y,i),c=s.numPoints||1,f=s.x*c,h=s.y*c,p=a&&c>1?this._map(s,!0):null,d=(o<<5)+(t+1)+this.points.length,v=0,m=u;v<m.length;v+=1){var g=l.points[m[v]];if(!(g.zoom<=t)){g.zoom=t;var y=g.numPoints||1;f+=g.x*y,h+=g.y*y,c+=y,g.parentId=d,a&&(p||(p=this._map(s,!0)),a(p,this._map(g)))}}1===c?r.push(s):(s.parentId=d,r.push(F(f/c,h/c,d,c,p)))}}return r},N.prototype._getOriginId=function(e){return e-this.points.length>>5},N.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},N.prototype._map=function(e,t){if(e.numPoints)return t?G({},e.properties):e.properties;var r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?G({},n):n},ge.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ge.prototype.splitTile=function(e,t,r,n,a,i,o){for(var s=[e,t,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,f=ye(t,r,n),h=this.tiles[f];if(!h&&(u>1&&console.time("creation"),h=this.tiles[f]=de(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=e,a){if(t===l.maxZoom||t===a)continue;var d=1<<a-t;if(r!==Math.floor(i/d)||n!==Math.floor(o/d))continue}else if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==e.length){u>1&&console.time("clipping");var v,m,g,y,x,_,b=.5*l.buffer/l.extent,w=.5-b,T=.5+b,k=1+b;v=m=g=y=null,x=re(e,c,r-b,r+T,0,h.minX,h.maxX,l),_=re(e,c,r+w,r+k,0,h.minX,h.maxX,l),e=null,x&&(v=re(x,c,n-b,n+T,1,h.minY,h.maxY,l),m=re(x,c,n+w,n+k,1,h.minY,h.maxY,l),x=null),_&&(g=re(_,c,n-b,n+T,1,h.minY,h.maxY,l),y=re(_,c,n+w,n+k,1,h.minY,h.maxY,l),_=null),u>1&&console.timeEnd("clipping"),s.push(v||[],t+1,2*r,2*n),s.push(m||[],t+1,2*r,2*n+1),s.push(g||[],t+1,2*r+1,2*n),s.push(y||[],t+1,2*r+1,2*n+1)}}},ge.prototype.getTile=function(e,t,r){var n=this.options,a=n.extent,i=n.debug;if(e<0||e>24)return null;var o=1<<e,s=ye(e,t=(t%o+o)%o,r);if(this.tiles[s])return he(this.tiles[s],a);i>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,c=t,f=r;!l&&u>0;)u--,c=Math.floor(c/2),f=Math.floor(f/2),l=this.tiles[ye(u,c,f)];return l&&l.source?(i>1&&console.log("found parent tile z%d-%d-%d",u,c,f),i>1&&console.time("drilling down"),this.splitTile(l.source,u,c,f,e,t,r),i>1&&console.timeEnd("drilling down"),this.tiles[s]?he(this.tiles[s],a):null):null};var _e=function(t){function r(e,r,n,a){t.call(this,e,r,n,xe),a&&(this.loadGeoJSON=a)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.loadData=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=t,this._pendingLoadDataParams=e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var r=this._pendingCallback,n=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var a=!!(n&&n.request&&n.request.collectResourceTiming)&&new e.RequestPerformance(n.request);this.loadGeoJSON(n,function(i,o){if(i||!o)return r(i);if("object"!=typeof o)return r(new Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."));!function e(t,r){var n,a=t&&t.type;if("FeatureCollection"===a)for(n=0;n<t.features.length;n++)e(t.features[n],r);else if("GeometryCollection"===a)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],r);else if("Feature"===a)e(t.geometry,r);else if("Polygon"===a)f(t.coordinates,r);else if("MultiPolygon"===a)for(n=0;n<t.coordinates.length;n++)f(t.coordinates[n],r);return t}(o,!0);try{t._geoJSONIndex=n.cluster?new N(function(t){var r=t.superclusterOptions,n=t.clusterProperties;if(!n||!r)return r;for(var a={},i={},o={accumulated:null,zoom:0},s={properties:null},l=Object.keys(n),u=0,c=l;u<c.length;u+=1){var f=c[u],h=n[f],p=h[0],d=e.createExpression(h[1]),v=e.createExpression("string"==typeof p?[p,["accumulated"],["get",f]]:p);a[f]=d.value,i[f]=v.value}return r.map=function(e){s.properties=e;for(var t={},r=0,n=l;r<n.length;r+=1){var i=n[r];t[i]=a[i].evaluate(o,s)}return t},r.reduce=function(e,t){s.properties=t;for(var r=0,n=l;r<n.length;r+=1){var a=n[r];o.accumulated=e[a],e[a]=i[a].evaluate(o,s)}},r}(n)).load(o.features):function(e,t){return new ge(e,t)}(o,n.geojsonVtOptions)}catch(i){return r(i)}t.loaded={};var s={};if(a){var l=a.finish();l&&(s.resourceTiming={},s.resourceTiming[n.source]=JSON.parse(JSON.stringify(l)))}r(null,s)})}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(e,r){var n=this.loaded;return n&&n[e.uid]?t.prototype.reloadTile.call(this,e,r):this.loadTile(e,r)},r.prototype.loadGeoJSON=function(t,r){if(t.request)e.getJSON(t.request,r);else{if("string"!=typeof t.data)return r(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()},r.prototype.getClusterExpansionZoom=function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}},r.prototype.getClusterChildren=function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}},r.prototype.getClusterLeaves=function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}},r}(l),be=function(t){var r=this;this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:_e},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(r.workerSourceTypes[e])throw new Error('Worker source with name "'+e+'" already registered.');r.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}};return be.prototype.setReferrer=function(e,t){this.referrer=t},be.prototype.setImages=function(e,t,r){for(var n in this.availableImages[e]=t,this.workerSources[e]){var a=this.workerSources[e][n];for(var i in a)a[i].availableImages=t}r()},be.prototype.setLayers=function(e,t,r){this.getLayerIndex(e).replace(t),r()},be.prototype.updateLayers=function(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()},be.prototype.loadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).loadTile(t,r)},be.prototype.loadDEMTile=function(e,t,r){this.getDEMWorkerSource(e,t.source).loadTile(t,r)},be.prototype.reloadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)},be.prototype.abortTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)},be.prototype.removeTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)},be.prototype.removeDEMTile=function(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)},be.prototype.removeSource=function(e,t,r){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}},be.prototype.loadWorkerSource=function(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}},be.prototype.syncRTLPluginState=function(t,r,n){try{e.plugin.setState(r);var a=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=a){this.self.importScripts(a);var i=e.plugin.isParsed();n(i?void 0:new Error("RTL Text Plugin failed to import scripts from "+a),i)}}catch(e){n(e.toString())}},be.prototype.getAvailableImages=function(e){var t=this.availableImages[e];return t||(t=[]),t},be.prototype.getLayerIndex=function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t},be.prototype.getWorkerSource=function(e,t,r){var n=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][r]||(this.workerSources[e][t][r]=new this.workerSourceTypes[t]({send:function(t,r,a){n.actor.send(t,r,a,e)}},this.getLayerIndex(e),this.getAvailableImages(e))),this.workerSources[e][t][r]},be.prototype.getDEMWorkerSource=function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new c),this.demWorkerSources[e][t]},be.prototype.enforceCacheSizeLimit=function(t,r){e.enforceCacheSizeLimit(r)},"undefined"!=typeof WorkerGlobalScope&&void 0!==e.window&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new be(e.window)),be});n(["./shared"],function(e){"use strict";var t=e.createCommonjsModule(function(e){function t(e){return!r(e)}function r(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}()?(void 0===n[r=e&&e.failIfMajorPerformanceCaveat]&&(n[r]=function(e){var r=function(e){var r=document.createElement("canvas"),n=Object.create(t.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,r.probablySupportsContext?r.probablySupportsContext("webgl",n)||r.probablySupportsContext("experimental-webgl",n):r.supportsContext?r.supportsContext("webgl",n)||r.supportsContext("experimental-webgl",n):r.getContext("webgl",n)||r.getContext("experimental-webgl",n)}(e);if(!r)return!1;var n=r.createShader(r.VERTEX_SHADER);return!(!n||r.isContextLost())&&(r.shaderSource(n,"void main() {}"),r.compileShader(n),!0===r.getShaderParameter(n,r.COMPILE_STATUS))}(r)),n[r]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}e.exports?e.exports=t:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=t,window.mapboxgl.notSupportedReason=r);var n={};t.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),r={create:function(t,r,n){var a=e.window.document.createElement(t);return void 0!==r&&(a.className=r),n&&n.appendChild(a),a},createNS:function(t,r){return e.window.document.createElementNS(t,r)}},n=e.window.document.documentElement.style;function a(e){if(!n)return e[0];for(var t=0;t<e.length;t++)if(e[t]in n)return e[t];return e[0]}var i,o=a(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){n&&o&&(i=n[o],n[o]="none")},r.enableDrag=function(){n&&o&&(n[o]=i)};var s=a(["transform","WebkitTransform"]);r.setTransform=function(e,t){e.style[s]=t};var l=!1;try{var u=Object.defineProperty({},"passive",{get:function(){l=!0}});e.window.addEventListener("test",u,u),e.window.removeEventListener("test",u,u)}catch(e){l=!1}r.addEventListener=function(e,t,r,n){void 0===n&&(n={}),e.addEventListener(t,r,"passive"in n&&l?n:n.capture)},r.removeEventListener=function(e,t,r,n){void 0===n&&(n={}),e.removeEventListener(t,r,"passive"in n&&l?n:n.capture)};var c=function(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",c,!0)};function f(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}r.suppressClick=function(){e.window.addEventListener("click",c,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",c,!0)},0)},r.mousePos=function(t,r){var n=t.getBoundingClientRect();return new e.Point(r.clientX-n.left-t.clientLeft,r.clientY-n.top-t.clientTop)},r.touchPos=function(t,r){for(var n=t.getBoundingClientRect(),a=[],i=0;i<r.length;i++)a.push(new e.Point(r[i].clientX-n.left-t.clientLeft,r[i].clientY-n.top-t.clientTop));return a},r.mouseButton=function(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button},r.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var h=function(t){function r(){t.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.isLoaded=function(){return this.loaded},r.prototype.setLoaded=function(e){if(this.loaded!==e&&(this.loaded=e,e)){for(var t=0,r=this.requestors;t<r.length;t+=1){var n=r[t];this._notify(n.ids,n.callback)}this.requestors=[]}},r.prototype.getImage=function(e){return this.images[e]},r.prototype.addImage=function(e,t){this._validate(e,t)&&(this.images[e]=t)},r.prototype._validate=function(t,r){var n=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchX" value'))),n=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchY" value'))),n=!1),this._validateContent(r.content,r)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "content" value'))),n=!1),n},r.prototype._validateStretch=function(e,t){if(!e)return!0;for(var r=0,n=0,a=e;n<a.length;n+=1){var i=a[n];if(i[0]<r||i[1]<i[0]||t<i[1])return!1;r=i[1]}return!0},r.prototype._validateContent=function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))},r.prototype.updateImage=function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0},r.prototype.removeImage=function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()},r.prototype.listImages=function(){return Object.keys(this.images)},r.prototype.getImages=function(e,t){var r=!0;if(!this.isLoaded())for(var n=0,a=e;n<a.length;n+=1)this.images[a[n]]||(r=!1);this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})},r.prototype._notify=function(t,r){for(var n={},a=0,i=t;a<i.length;a+=1){var o=i[a];this.images[o]||this.fire(new e.Event("styleimagemissing",{id:o}));var s=this.images[o];s?n[o]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'+o+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}r(null,n)},r.prototype.getPixelSize=function(){var e=this.atlasImage;return{width:e.width,height:e.height}},r.prototype.getPattern=function(t){var r=this.patterns[t],n=this.getImage(t);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{var a={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new e.ImagePosition(a,n);this.patterns[t]={bin:a,position:i}}return this._updatePatternAtlas(),this.patterns[t].position},r.prototype.bind=function(t){var r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)},r.prototype._updatePatternAtlas=function(){var t=[];for(var r in this.patterns)t.push(this.patterns[r].bin);var n=e.potpack(t),a=n.w,i=n.h,o=this.atlasImage;for(var s in o.resize({width:a||1,height:i||1}),this.patterns){var l=this.patterns[s].bin,u=l.x+1,c=l.y+1,f=this.images[s].data,h=f.width,p=f.height;e.RGBAImage.copy(f,o,{x:0,y:0},{x:u,y:c},{width:h,height:p}),e.RGBAImage.copy(f,o,{x:0,y:p-1},{x:u,y:c-1},{width:h,height:1}),e.RGBAImage.copy(f,o,{x:0,y:0},{x:u,y:c+p},{width:h,height:1}),e.RGBAImage.copy(f,o,{x:h-1,y:0},{x:u-1,y:c},{width:1,height:p}),e.RGBAImage.copy(f,o,{x:0,y:0},{x:u+h,y:c},{width:1,height:p})}this.dirty=!0},r.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},r.prototype.dispatchRenderCallbacks=function(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(!this.callbackDispatchedThisFrame[n]){this.callbackDispatchedThisFrame[n]=!0;var a=this.images[n];f(a)&&this.updateImage(n,a)}}},r}(e.Evented),p=m,d=m,v=1e20;function m(e,t,r,n,a,i){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=n||.25,this.fontFamily=a||"sans-serif",this.fontWeight=i||"normal",this.radius=r||8;var o=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.d=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Int16Array(o),this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function g(e,t,r,n,a,i,o){for(var s=0;s<t;s++){for(var l=0;l<r;l++)n[l]=e[l*t+s];for(y(n,a,i,o,r),l=0;l<r;l++)e[l*t+s]=a[l]}for(l=0;l<r;l++){for(s=0;s<t;s++)n[s]=e[l*t+s];for(y(n,a,i,o,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(a[s])}}function y(e,t,r,n,a){r[0]=0,n[0]=-v,n[1]=+v;for(var i=1,o=0;i<a;i++){for(var s=(e[i]+i*i-(e[r[o]]+r[o]*r[o]))/(2*i-2*r[o]);s<=n[o];)o--,s=(e[i]+i*i-(e[r[o]]+r[o]*r[o]))/(2*i-2*r[o]);r[++o]=i,n[o]=s,n[o+1]=+v}for(i=0,o=0;i<a;i++){for(;n[o+1]<i;)o++;t[i]=(i-r[o])*(i-r[o])+e[r[o]]}}m.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var a=t.data[4*n+3]/255;this.gridOuter[n]=1===a?0:0===a?v:Math.pow(Math.max(0,.5-a),2),this.gridInner[n]=1===a?v:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++)r[n]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[n]-this.gridInner[n])/this.radius+this.cutoff))));return r},p.default=d;var x=function(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}};x.prototype.setURL=function(e){this.url=e},x.prototype.getGlyphs=function(t,r){var n=this,a=[];for(var i in t)for(var o=0,s=t[i];o<s.length;o+=1)a.push({stack:i,id:s[o]});e.asyncAll(a,function(e,t){var r=e.stack,a=e.id,i=n.entries[r];i||(i=n.entries[r]={glyphs:{},requests:{},ranges:{}});var o=i.glyphs[a];if(void 0===o){if(o=n._tinySDF(i,r,a))return i.glyphs[a]=o,void t(null,{stack:r,id:a,glyph:o});var s=Math.floor(a/256);if(256*s>65535)t(new Error("glyphs > 65535 not supported"));else if(i.ranges[s])t(null,{stack:r,id:a,glyph:o});else{var l=i.requests[s];l||(l=i.requests[s]=[],x.loadGlyphRange(r,s,n.url,n.requestManager,function(e,t){if(t){for(var r in t)n._doesCharSupportLocalGlyph(+r)||(i.glyphs[+r]=t[+r]);i.ranges[s]=!0}for(var a=0,o=l;a<o.length;a+=1)(0,o[a])(e,t);delete i.requests[s]})),l.push(function(e,n){e?t(e):n&&t(null,{stack:r,id:a,glyph:n[a]||null})})}}else t(null,{stack:r,id:a,glyph:o})},function(e,t){if(e)r(e);else if(t){for(var n={},a=0,i=t;a<i.length;a+=1){var o=i[a],s=o.stack,l=o.id,u=o.glyph;(n[s]||(n[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}r(null,n)}})},x.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](t)||e.isChar["Hangul Syllables"](t)||e.isChar.Hiragana(t)||e.isChar.Katakana(t))},x.prototype._tinySDF=function(t,r,n){var a=this.localIdeographFontFamily;if(a&&this._doesCharSupportLocalGlyph(n)){var i=t.tinySDF;if(!i){var o="400";/bold/i.test(r)?o="900":/medium/i.test(r)?o="500":/light/i.test(r)&&(o="200"),i=t.tinySDF=new x.TinySDF(24,3,8,.25,a,o)}return{id:n,bitmap:new e.AlphaImage({width:30,height:30},i.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},x.loadGlyphRange=function(t,r,n,a,i){var o=256*r,s=o+255,l=a.transformRequest(a.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",o+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(l,function(t,r){if(t)i(t);else if(r){for(var n={},a=0,o=e.parseGlyphPBF(r);a<o.length;a+=1){var s=o[a];n[s.id]=s}i(null,n)}})},x.TinySDF=p;var _=function(){this.specification=e.styleSpec.light.position};_.prototype.possiblyEvaluate=function(t,r){return e.sphericalToCartesian(t.expression.evaluate(r))},_.prototype.interpolate=function(t,r,n){return{x:e.number(t.x,r.x,n),y:e.number(t.y,r.y,n),z:e.number(t.z,r.z,n)}};var b=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new _,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),w=function(t){function r(r){t.call(this),this._transitionable=new e.Transitionable(b),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getLight=function(){return this._transitionable.serialize()},r.prototype.setLight=function(t,r){if(void 0===r&&(r={}),!this._validate(e.validateLight,t,r))for(var n in t){var a=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-"-transition".length),a):this._transitionable.setValue(n,a)}},r.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},r.prototype.hasTransition=function(){return this._transitioning.hasTransition()},r.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},r.prototype._validate=function(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},r}(e.Evented),T=function(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};T.prototype.getDash=function(e,t){var r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]},T.prototype.getDashRanges=function(e,t,r){var n=[],a=e.length%2==1?-e[e.length-1]*r:0,i=e[0]*r,o=!0;n.push({left:a,right:i,isDash:o,zeroLength:0===e[0]});for(var s=e[0],l=1;l<e.length;l++){var u=e[l];n.push({left:a=s*r,right:i=(s+=u)*r,isDash:o=!o,zeroLength:0===u})}return n},T.prototype.addRoundDash=function(e,t,r){for(var n=t/2,a=-r;a<=r;a++)for(var i=this.width*(this.nextRow+r+a),o=0,s=e[o],l=0;l<this.width;l++){l/s.right>1&&(s=e[++o]);var u=Math.abs(l-s.left),c=Math.abs(l-s.right),f=Math.min(u,c),h=void 0,p=a/r*(n+1);if(s.isDash){var d=n-Math.abs(p);h=Math.sqrt(f*f+d*d)}else h=n-Math.sqrt(f*f+p*p);this.data[i+l]=Math.max(0,Math.min(255,h+128))}},T.prototype.addRegularDash=function(e){for(var t=e.length-1;t>=0;--t){var r=e[t],n=e[t+1];r.zeroLength?e.splice(t,1):n&&n.isDash===r.isDash&&(n.left=r.left,e.splice(t,1))}var a=e[0],i=e[e.length-1];a.isDash===i.isDash&&(a.left=i.left-this.width,i.right=a.right+this.width);for(var o=this.width*this.nextRow,s=0,l=e[s],u=0;u<this.width;u++){u/l.right>1&&(l=e[++s]);var c=Math.abs(u-l.left),f=Math.abs(u-l.right),h=Math.min(c,f);this.data[o+u]=Math.max(0,Math.min(255,(l.isDash?h:-h)+128))}},T.prototype.addDash=function(t,r){var n=r?7:0,a=2*n+1;if(this.nextRow+a>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var i=0,o=0;o<t.length;o++)i+=t[o];if(0!==i){var s=this.width/i,l=this.getDashRanges(t,this.width,s);r?this.addRoundDash(l,s,n):this.addRegularDash(l)}var u={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:i};return this.nextRow+=a,this.dirty=!0,u},T.prototype.bind=function(e){var t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))};var k=function t(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var a=this.workerPool.acquire(this.id),i=0;i<a.length;i++){var o=new t.Actor(a[i],n,this.id);o.name="Worker "+i,this.actors.push(o)}};function A(t,r,n){var a=function(a,i){if(a)return n(a);if(i){var o=e.pick(e.extend(i,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);i.vector_layers&&(o.vectorLayers=i.vector_layers,o.vectorLayerIds=o.vectorLayers.map(function(e){return e.id})),o.tiles=r.canonicalizeTileset(o,t.url),n(null,o)}};return t.url?e.getJSON(r.transformRequest(r.normalizeSourceURL(t.url),e.ResourceType.Source),a):e.browser.frame(function(){return a(null,t)})}k.prototype.broadcast=function(t,r,n){e.asyncAll(this.actors,function(e,n){e.send(t,r,n)},n=n||function(){})},k.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},k.prototype.remove=function(){this.actors.forEach(function(e){e.remove()}),this.actors=[],this.workerPool.release(this.id)},k.Actor=e.Actor;var M=function(t,r,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=n||24};M.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]},M.prototype.contains=function(t){var r=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*r),a=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*r),i=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*r),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*r);return t.x>=n&&t.x<i&&t.y>=a&&t.y<o};var E=function(t){function r(r,n,a,i){if(t.call(this),this.id=r,this.dispatcher=a,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(n,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=A(this._options,this.map._requestManager,function(r,n){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new M(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles,t.map._requestManager._customAccessToken),e.postMapLoadEvent(n.tiles,t.map._getMapId(),t.map._requestManager._skuToken,t.map._requestManager._customAccessToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.loaded=function(){return this._loaded},r.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return e.extend({},this._options)},r.prototype.loadTile=function(t,r){var n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),a={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function i(n,a){return delete t.request,t.aborted?r(null):n&&404!==n.status?r(n):(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),this.map._refreshExpiredTiles&&a&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}a.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",a,i.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",a,i.bind(this)))},r.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)},r.prototype.unloadTile=function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)},r.prototype.hasTransition=function(){return!1},r}(e.Evented),S=function(t){function r(r,n,a,i){t.call(this),this.id=r,this.dispatcher=a,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},n),e.extend(this,e.pick(n,["url","scheme","tileSize"]))}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=A(this._options,this.map._requestManager,function(r,n){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new M(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles),e.postMapLoadEvent(n.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.loaded=function(){return this._loaded},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return e.extend({},this._options)},r.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},r.prototype.loadTile=function(t,r){var n=this,a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(a,e.ResourceType.Tile),function(a,i){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(a)t.state="errored",r(a);else if(i){n.map._refreshExpiredTiles&&t.setExpiryData(i),delete i.cacheControl,delete i.expires;var o=n.map.painter.context,s=o.gl;t.texture=n.map.painter.getTileTexture(i.width),t.texture?t.texture.update(i,{useMipmap:!0}):(t.texture=new e.Texture(o,i,s.RGBA,{useMipmap:!0}),t.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),o.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)),t.state="loaded",e.cacheEntryPossiblyAdded(n.dispatcher),r(null)}})},r.prototype.abortTile=function(e,t){e.request&&(e.request.cancel(),delete e.request),t()},r.prototype.unloadTile=function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()},r.prototype.hasTransition=function(){return!1},r}(e.Evented),C=function(t){function r(r,n,a,i){t.call(this,r,n,a,i),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},r.prototype.loadTile=function(t,r){var n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function a(e,n){e&&(t.state="errored",r(e)),n&&(t.dem=n,t.needsHillshadePrepare=!0,t.state="loaded",r(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,i){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(i){this.map._refreshExpiredTiles&&t.setExpiryData(i),delete i.cacheControl,delete i.expires;var o=e.window.ImageBitmap&&i instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?i:e.browser.getImageData(i,1),s={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:o,encoding:this.encoding};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",s,a.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)},r.prototype._getNeighboringTiles=function(t){var r=t.canonical,n=Math.pow(2,r.z),a=(r.x-1+n)%n,i=0===r.x?t.wrap-1:t.wrap,o=(r.x+1+n)%n,s=r.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,i,r.z,a,r.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,i,r.z,a,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new e.OverscaledTileID(t.overscaledZ,i,r.z,a,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),l},r.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})},r}(S),L=function(t){function r(r,n,a,i){t.call(this),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=a.getActor(),this.setEventedParent(i),this._data=n.data,this._options=e.extend({},n),this._collectResourceTiming=n.collectResourceTiming,this._resourceTiming=[],void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;var o=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(n.clusterRadius||50)*o,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties},n.workerOptions)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(r){if(r)t.fire(new e.ErrorEvent(r));else{var n={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&t._resourceTiming.length>0&&(n.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new e.Event("data",n))}})},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setData=function(t){var r=this;return this._data=t,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)r.fire(new e.ErrorEvent(t));else{var n={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0&&(n.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new e.Event("data",n))}}),this},r.prototype.getClusterExpansionZoom=function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this},r.prototype.getClusterChildren=function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this},r.prototype.getClusterLeaves=function(e,t,r,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:r},n),this},r.prototype._updateWorkerData=function(t){var r=this;this._loaded=!1;var n=e.extend({},this.workerOptions),a=this._data;"string"==typeof a?(n.request=this.map._requestManager.transformRequest(e.browser.resolveURL(a),e.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(a),this.actor.send(this.type+".loadData",n,function(e,a){r._removed||a&&a.abandoned||(r._loaded=!0,a&&a.resourceTiming&&a.resourceTiming[r.id]&&(r._resourceTiming=a.resourceTiming[r.id].slice(0)),r.actor.send(r.type+".coalesce",{source:n.source},null),t(e))})},r.prototype.loaded=function(){return this._loaded},r.prototype.loadTile=function(t,r){var n=this,a=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(a,{type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(e,i){return delete t.request,t.unloadVectorData(),t.aborted?r(null):e?r(e):(t.loadVectorData(i,n.map.painter,"reloadTile"===a),r(null))})},r.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0},r.prototype.unloadTile=function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})},r.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},r.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},r.prototype.hasTransition=function(){return!1},r}(e.Evented),I=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),O=function(t){function r(e,r,n,a){t.call(this),this.id=e,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(a),this.options=r}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(t,r){var n=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(a,i){n._loaded=!0,a?n.fire(new e.ErrorEvent(a)):i&&(n.image=i,t&&(n.coordinates=t),r&&r(),n._finishLoading())})},r.prototype.loaded=function(){return this._loaded},r.prototype.updateImage=function(e){var t=this;return this.image&&e.url?(this.options.url=e.url,this.load(e.coordinates,function(){t.texture=null}),this):this},r.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setCoordinates=function(t){var r=this;this.coordinates=t;var n=t.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(t){for(var r=1/0,n=1/0,a=-1/0,i=-1/0,o=0,s=t;o<s.length;o+=1){var l=s[o];r=Math.min(r,l.x),n=Math.min(n,l.y),a=Math.max(a,l.x),i=Math.max(i,l.y)}var u=Math.max(a-r,i-n),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),f=Math.pow(2,c);return new e.CanonicalTileID(c,Math.floor((r+a)/2*f),Math.floor((n+i)/2*f))}(n),this.minzoom=this.maxzoom=this.tileID.z;var a=n.map(function(e){return r.tileID.getTilePoint(e)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(a[0].x,a[0].y,0,0),this._boundsArray.emplaceBack(a[1].x,a[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(a[3].x,a[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(a[2].x,a[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},r.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var a=this.tiles[n];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},r.prototype.loadTile=function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))},r.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return!1},r}(e.Evented),P=function(t){function r(e,r,n,a){t.call(this,e,r,n,a),this.roundZoom=!0,this.type="video",this.options=r}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){var t=this;this._loaded=!1;var r=this.options;this.urls=[];for(var n=0,a=r.urls;n<a.length;n+=1)this.urls.push(this.map._requestManager.transformRequest(a[n],e.ResourceType.Source).url);e.getVideo(this.urls,function(r,n){t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(t.video=n,t.video.loop=!0,t.video.addEventListener("playing",function(){t.map.triggerRepaint()}),t.map&&t.video.play(),t._finishLoading())})},r.prototype.pause=function(){this.video&&this.video.pause()},r.prototype.play=function(){this.video&&this.video.play()},r.prototype.seek=function(t){if(this.video){var r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+r.start(0)+" and "+r.end(0)+"-second mark."))):this.video.currentTime=t}},r.prototype.getVideo=function(){return this.video},r.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},r.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var a=this.tiles[n];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this.video&&!this.video.paused},r}(O),D=function(t){function r(r,n,a,i){t.call(this,r,n,a,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(function(e){return!Array.isArray(e)||2!==e.length||e.some(function(e){return"number"!=typeof e})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},r.prototype.getCanvas=function(){return this.canvas},r.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},r.prototype.onRemove=function(){this.pause()},r.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,n=r.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(r,this.canvas,n.RGBA,{premultiply:!0}),this.tiles){var i=this.tiles[a];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this._playing},r.prototype._hasInvalidDimensions=function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e+=1){var r=t[e];if(isNaN(r)||r<=0)return!0}return!1},r}(O),R={vector:E,raster:S,"raster-dem":C,geojson:L,video:P,image:O,canvas:D};function z(t,r){var n=e.identity([]);return e.translate(n,n,[1,1,0]),e.scale(n,n,[.5*t.width,.5*t.height,1]),e.multiply(n,n,t.calculatePosMatrix(r.toUnwrapped()))}function N(e,t,r,n,a,i){var o=function(e,t,r){if(e)for(var n=0,a=e;n<a.length;n+=1){var i=t[a[n]];if(i&&i.source===r&&"fill-extrusion"===i.type)return!0}else for(var o in t){var s=t[o];if(s.source===r&&"fill-extrusion"===s.type)return!0}return!1}(a&&a.layers,t,e.id),s=i.maxPitchScaleFactor(),l=e.tilesIn(n,s,o);l.sort(F);for(var u=[],c=0,f=l;c<f.length;c+=1){var h=f[c];u.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,r,e._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,a,i,s,z(e.transform,h.tileID))})}var p=function(e){for(var t={},r={},n=0,a=e;n<a.length;n+=1){var i=a[n],o=i.queryResults,s=i.wrappedTileID,l=r[s]=r[s]||{};for(var u in o)for(var c=o[u],f=l[u]=l[u]||{},h=t[u]=t[u]||[],p=0,d=c;p<d.length;p+=1){var v=d[p];f[v.featureIndex]||(f[v.featureIndex]=!0,h.push(v))}}return t}(u);for(var d in p)p[d].forEach(function(t){var r=t.feature,n=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n});return p}function F(e,t){var r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}var B=function(e,t){this.max=e,this.onRemove=t,this.reset()};B.prototype.reset=function(){for(var e in this.data)for(var t=0,r=this.data[e];t<r.length;t+=1){var n=r[t];n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}return this.data={},this.order=[],this},B.prototype.add=function(e,t,r){var n=this,a=e.wrapped().key;void 0===this.data[a]&&(this.data[a]=[]);var i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout(function(){n.remove(e,i)},r)),this.data[a].push(i),this.order.push(a),this.order.length>this.max){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},B.prototype.has=function(e){return e.wrapped().key in this.data},B.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},B.prototype._getAndRemoveByKey=function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value},B.prototype.getByKey=function(e){var t=this.data[e];return t?t[0].value:null},B.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},B.prototype.remove=function(e,t){if(!this.has(e))return this;var r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),a=this.data[r][n];return this.data[r].splice(n,1),a.timeout&&clearTimeout(a.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(a.value),this.order.splice(this.order.indexOf(r),1),this},B.prototype.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this},B.prototype.filter=function(e){var t=[];for(var r in this.data)for(var n=0,a=this.data[r];n<a.length;n+=1){var i=a[n];e(i.value)||t.push(i)}for(var o=0,s=t;o<s.length;o+=1){var l=s[o];this.remove(l.value.tileID,l)}};var j=function(e,t,r){this.context=e;var n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};j.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},j.prototype.updateData=function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)},j.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var U={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},H=function(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;var a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};H.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},H.prototype.updateData=function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)},H.prototype.enableAttributes=function(e,t){for(var r=0;r<this.attributes.length;r++){var n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}},H.prototype.setVertexAttribPointers=function(e,t,r){for(var n=0;n<this.attributes.length;n++){var a=this.attributes[n],i=t.attributes[a.name];void 0!==i&&e.vertexAttribPointer(i,a.components,e[U[a.type]],!1,this.itemSize,a.offset+this.itemSize*(r||0))}},H.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var V=function(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};V.prototype.get=function(){return this.current},V.prototype.set=function(e){},V.prototype.getDefault=function(){return this.default},V.prototype.setDefault=function(){this.set(this.default)};var G=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getDefault=function(){return e.Color.transparent},r.prototype.set=function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},r}(V),q=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 1},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)},t}(V),Y=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)},t}(V),W=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return[!0,!0,!0,!0]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},t}(V),X=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)},t}(V),Z=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 255},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)},t}(V),K=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},t.prototype.set=function(e){var t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)},t}(V),J=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)},t}(V),Q=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}},t}(V),$=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return[0,1]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)},t}(V),ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}},t}(V),te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.LESS},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)},t}(V),re=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}},t}(V),ne=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.ONE,e.ZERO]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)},t}(V),ae=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getDefault=function(){return e.Color.transparent},r.prototype.set=function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},r}(V),ie=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.FUNC_ADD},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)},t}(V),oe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}},t}(V),se=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.BACK},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)},t}(V),le=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.CCW},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)},t}(V),ue=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)},t}(V),ce=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.TEXTURE0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)},t}(V),fe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},t}(V),he=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}},t}(V),pe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},t}(V),de=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}},t}(V),ve=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}},t}(V),me=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1},t}(V),ge=function(e){function t(t){e.call(this,t),this.vao=t.extVertexArrayObject}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)},t}(V),ye=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 4},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}},t}(V),xe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}},t}(V),_e=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}},t}(V),be=function(e){function t(t,r){e.call(this,t),this.context=t,this.parent=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t}(V),we=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.setDirty=function(){this.dirty=!0},t.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}},t}(be),Te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},t}(be),ke=function(e,t,r,n){this.context=e,this.width=t,this.height=r;var a=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new we(e,a),n&&(this.depthAttachment=new Te(e,a))};ke.prototype.destroy=function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}e.deleteFramebuffer(this.framebuffer)};var Ae=function(e,t,r){this.func=e,this.mask=t,this.range=r};Ae.ReadOnly=!1,Ae.ReadWrite=!0,Ae.disabled=new Ae(519,Ae.ReadOnly,[0,1]);var Me=function(e,t,r,n,a,i){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=a,this.pass=i};Me.disabled=new Me({func:519,mask:0},0,0,7680,7680,7680);var Ee=function(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r};Ee.disabled=new Ee(Ee.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Ee.unblended=new Ee(Ee.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ee.alphaBlended=new Ee([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Se=function(e,t,r){this.enable=e,this.mode=t,this.frontFace=r};Se.disabled=new Se(!1,1029,2305),Se.backCCW=new Se(!0,1029,2305);var Ce=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new G(this),this.clearDepth=new q(this),this.clearStencil=new Y(this),this.colorMask=new W(this),this.depthMask=new X(this),this.stencilMask=new Z(this),this.stencilFunc=new K(this),this.stencilOp=new J(this),this.stencilTest=new Q(this),this.depthRange=new $(this),this.depthTest=new ee(this),this.depthFunc=new te(this),this.blend=new re(this),this.blendFunc=new ne(this),this.blendColor=new ae(this),this.blendEquation=new ie(this),this.cullFace=new oe(this),this.cullFaceSide=new se(this),this.frontFace=new le(this),this.program=new ue(this),this.activeTexture=new ce(this),this.viewport=new fe(this),this.bindFramebuffer=new he(this),this.bindRenderbuffer=new pe(this),this.bindTexture=new de(this),this.bindVertexBuffer=new ve(this),this.bindElementBuffer=new me(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ge(this),this.pixelStoreUnpack=new ye(this),this.pixelStoreUnpackPremultiplyAlpha=new xe(this),this.pixelStoreUnpackFlipY=new _e(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query")};Ce.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ce.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ce.prototype.createIndexBuffer=function(e,t){return new j(this,e,t)},Ce.prototype.createVertexBuffer=function(e,t,r){return new H(this,e,t,r)},Ce.prototype.createRenderbuffer=function(e,t,r){var n=this.gl,a=n.createRenderbuffer();return this.bindRenderbuffer.set(a),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),a},Ce.prototype.createFramebuffer=function(e,t,r){return new ke(this,e,t,r)},Ce.prototype.clear=function(e){var t=e.color,r=e.depth,n=this.gl,a=0;t&&(a|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(a|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(a)},Ce.prototype.setCullFace=function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))},Ce.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},Ce.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},Ce.prototype.setColorMode=function(t){e.deepEqual(t.blendFunction,Ee.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},Ce.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Le=function(t){function r(r,n,a){var i=this;t.call(this),this.id=r,this.dispatcher=a,this.on("data",function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(i._sourceLoaded=!0),i._sourceLoaded&&!i._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(i.reload(),i.transform&&i.update(i.transform))}),this.on("error",function(){i._sourceErrored=!0}),this._source=function(t,r,n,a){var i=new R[r.type](t,r,n,a);if(i.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+i.id);return e.bindAll(["load","abort","unload","serialize","prepare"],i),i}(r,n,a,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},r.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},r.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},r.prototype.getSource=function(){return this._source},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},r.prototype._loadTile=function(e,t){return this._source.loadTile(e,t)},r.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,function(){})},r.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,function(){})},r.prototype.serialize=function(){return this._source.serialize()},r.prototype.prepare=function(e){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}},r.prototype.getIds=function(){return e.values(this._tiles).map(function(e){return e.tileID}).sort(Ie).map(function(e){return e.key})},r.prototype.getRenderableIds=function(t){var r=this,n=[];for(var a in this._tiles)this._isIdRenderable(a,t)&&n.push(this._tiles[a]);return t?n.sort(function(t,n){var a=t.tileID,i=n.tileID,o=new e.Point(a.canonical.x,a.canonical.y)._rotate(r.transform.angle),s=new e.Point(i.canonical.x,i.canonical.y)._rotate(r.transform.angle);return a.overscaledZ-i.overscaledZ||s.y-o.y||s.x-o.x}).map(function(e){return e.tileID.key}):n.map(function(e){return e.tileID}).sort(Ie).map(function(e){return e.key})},r.prototype.hasRenderableParent=function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)},r.prototype._isIdRenderable=function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())},r.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")},r.prototype._reloadTile=function(e,t){var r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))},r.prototype._tileLoaded=function(t,r,n,a){if(a)return t.state="errored",void(404!==a.status?this._source.fire(new e.ErrorEvent(a,{tile:t})):this.update(this.transform));t.timeAdded=e.browser.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:t,coord:t.tileID}))},r.prototype._backfillDEM=function(e){for(var t=this.getRenderableIds(),r=0;r<t.length;r++){var n=t[r];if(e.neighboringTiles&&e.neighboringTiles[n]){var a=this.getTileByID(n);i(e,a),i(a,e)}}function i(e,t){e.needsHillshadePrepare=!0;var r=t.tileID.canonical.x-e.tileID.canonical.x,n=t.tileID.canonical.y-e.tileID.canonical.y,a=Math.pow(2,e.tileID.canonical.z),i=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+a)?r+=a:1===Math.abs(r-a)&&(r-=a)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[i]&&(e.neighboringTiles[i].backfilled=!0)))}},r.prototype.getTile=function(e){return this.getTileByID(e.key)},r.prototype.getTileByID=function(e){return this._tiles[e]},r.prototype._retainLoadedChildren=function(e,t,r,n){for(var a in this._tiles){var i=this._tiles[a];if(!(n[a]||!i.hasData()||i.tileID.overscaledZ<=t||i.tileID.overscaledZ>r)){for(var o=i.tileID;i&&i.tileID.overscaledZ>t+1;){var s=i.tileID.scaledTo(i.tileID.overscaledZ-1);(i=this._tiles[s.key])&&i.hasData()&&(o=s)}for(var l=o;l.overscaledZ>t;)if(e[(l=l.scaledTo(l.overscaledZ-1)).key]){n[o.key]=o;break}}}},r.prototype.findLoadedParent=function(e,t){if(e.key in this._loadedParentTiles){var r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(var n=e.overscaledZ-1;n>=t;n--){var a=e.scaledTo(n),i=this._getLoadedTile(a);if(i)return i}},r.prototype._getLoadedTile=function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)},r.prototype.updateCacheSize=function(e){var t=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,n=Math.floor(t*r*5),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(a)},r.prototype.handleWrapJump=function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var r={};for(var n in this._tiles){var a=this._tiles[n];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),r[a.tileID.key]=a}for(var i in this._tiles=r,this._timers)clearTimeout(this._timers[i]),delete this._timers[i];for(var o in this._tiles)this._setTileReloadTimer(o,this._tiles[o])}},r.prototype.update=function(t){var n=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var a;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?a=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(a=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(a=a.filter(function(e){return n._source.hasTile(e)}))):a=[];var i=t.coveringZoomLevel(this._source),o=Math.max(i-r.maxOverzooming,this._source.minzoom),s=Math.max(i+r.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(a,i);if(Oe(this._source.type)){for(var u={},c={},f=0,h=Object.keys(l);f<h.length;f+=1){var p=h[f],d=l[p],v=this._tiles[p];if(v&&!(v.fadeEndTime&&v.fadeEndTime<=e.browser.now())){var m=this.findLoadedParent(d,o);m&&(this._addTile(m.tileID),u[m.tileID.key]=m.tileID),c[p]=d}}for(var g in this._retainLoadedChildren(c,i,s,l),u)l[g]||(this._coveredTiles[g]=!0,l[g]=u[g])}for(var y in l)this._tiles[y].clearFadeHold();for(var x=0,_=e.keysDifference(this._tiles,l);x<_.length;x+=1){var b=_[x],w=this._tiles[b];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(b)}this._updateLoadedParentTileCache()}},r.prototype.releaseSymbolFadeTiles=function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)},r.prototype._updateRetainedTiles=function(e,t){for(var n={},a={},i=Math.max(t-r.maxOverzooming,this._source.minzoom),o=Math.max(t+r.maxUnderzooming,this._source.minzoom),s={},l=0,u=e;l<u.length;l+=1){var c=u[l],f=this._addTile(c);n[c.key]=c,f.hasData()||t<this._source.maxzoom&&(s[c.key]=c)}this._retainLoadedChildren(s,t,o,n);for(var h=0,p=e;h<p.length;h+=1){var d=p[h],v=this._tiles[d.key];if(!v.hasData()){if(t+1>this._source.maxzoom){var m=d.children(this._source.maxzoom)[0],g=this.getTile(m);if(g&&g.hasData()){n[m.key]=m;continue}}else{var y=d.children(this._source.maxzoom);if(n[y[0].key]&&n[y[1].key]&&n[y[2].key]&&n[y[3].key])continue}for(var x=v.wasRequested(),_=d.overscaledZ-1;_>=i;--_){var b=d.scaledTo(_);if(a[b.key])break;if(a[b.key]=!0,!(v=this.getTile(b))&&x&&(v=this._addTile(b)),v&&(n[b.key]=b,x=v.wasRequested(),v.hasData()))break}}}return n},r.prototype._updateLoadedParentTileCache=function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],r=void 0,n=this._tiles[e].tileID;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);var a=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(a))break;n=a}for(var i=0,o=t;i<o.length;i+=1)this._loadedParentTiles[o[i]]=r}},r.prototype._addTile=function(t){var r=this._tiles[t.key];if(r)return r;(r=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));var n=Boolean(r);return n||(r=new e.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))),r?(r.uses++,this._tiles[t.key]=r,n||this._source.fire(new e.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},r.prototype._setTileReloadTimer=function(e,t){var r=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout(function(){r._reloadTile(e,"expired"),delete r._timers[e]},n))},r.prototype._removeTile=function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},r.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},r.prototype.tilesIn=function(t,r,n){var a=this,i=[],o=this.transform;if(!o)return i;for(var s=n?o.getCameraQueryGeometry(t):t,l=t.map(function(e){return o.pointCoordinate(e)}),u=s.map(function(e){return o.pointCoordinate(e)}),c=this.getIds(),f=1/0,h=1/0,p=-1/0,d=-1/0,v=0,m=u;v<m.length;v+=1){var g=m[v];f=Math.min(f,g.x),h=Math.min(h,g.y),p=Math.max(p,g.x),d=Math.max(d,g.y)}for(var y=function(t){var n=a._tiles[c[t]];if(!n.holdingForFade()){var s=n.tileID,v=Math.pow(2,o.zoom-n.tileID.overscaledZ),m=r*n.queryPadding*e.EXTENT/n.tileSize/v,g=[s.getTilePoint(new e.MercatorCoordinate(f,h)),s.getTilePoint(new e.MercatorCoordinate(p,d))];if(g[0].x-m<e.EXTENT&&g[0].y-m<e.EXTENT&&g[1].x+m>=0&&g[1].y+m>=0){var y=l.map(function(e){return s.getTilePoint(e)}),x=u.map(function(e){return s.getTilePoint(e)});i.push({tile:n,tileID:s,queryGeometry:y,cameraQueryGeometry:x,scale:v})}}},x=0;x<c.length;x++)y(x);return i},r.prototype.getVisibleCoordinates=function(e){for(var t=this,r=this.getRenderableIds(e).map(function(e){return t._tiles[e].tileID}),n=0,a=r;n<a.length;n+=1){var i=a[n];i.posMatrix=this.transform.calculatePosMatrix(i.toUnwrapped())}return r},r.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Oe(this._source.type))for(var t in this._tiles){var r=this._tiles[t];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=e.browser.now())return!0}return!1},r.prototype.setFeatureState=function(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)},r.prototype.removeFeatureState=function(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)},r.prototype.getFeatureState=function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)},r.prototype.setDependencies=function(e,t,r){var n=this._tiles[e];n&&n.setDependencies(t,r)},r.prototype.reloadTilesForDependencies=function(e,t){for(var r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter(function(r){return!r.hasDependency(e,t)})},r}(e.Evented);function Ie(e,t){var r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Oe(e){return"raster"===e||"image"===e||"video"===e}function Pe(){return new e.window.Worker(Ya.workerUrl)}Le.maxOverzooming=10,Le.maxUnderzooming=3;var De="mapboxgl_preloaded_worker_pool",Re=function(){this.active={}};Re.prototype.acquire=function(e){if(!this.workers)for(this.workers=[];this.workers.length<Re.workerCount;)this.workers.push(new Pe);return this.active[e]=!0,this.workers.slice()},Re.prototype.release=function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(function(e){e.terminate()}),this.workers=null)},Re.prototype.isPreloaded=function(){return!!this.active[De]},Re.prototype.numActive=function(){return Object.keys(this.active).length};var ze,Ne=Math.floor(e.browser.hardwareConcurrency/2);function Fe(){return ze||(ze=new Re),ze}function Be(t,r){var n={};for(var a in t)"ref"!==a&&(n[a]=t[a]);return e.refProperties.forEach(function(e){e in r&&(n[e]=r[e])}),n}function je(e){e=e.slice();for(var t=Object.create(null),r=0;r<e.length;r++)t[e[r].id]=e[r];for(var n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=Be(e[n],t[e[n].ref]));return e}Re.workerCount=Math.max(Math.min(Ne,6),1);var Ue={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function He(e,t,r){r.push({command:Ue.addSource,args:[e,t[e]]})}function Ve(e,t,r){t.push({command:Ue.removeSource,args:[e]}),r[e]=!0}function Ge(e,t,r,n){Ve(e,r,n),He(e,t,r)}function qe(t,r,n){var a;for(a in t[n])if(t[n].hasOwnProperty(a)&&"data"!==a&&!e.deepEqual(t[n][a],r[n][a]))return!1;for(a in r[n])if(r[n].hasOwnProperty(a)&&"data"!==a&&!e.deepEqual(t[n][a],r[n][a]))return!1;return!0}function Ye(t,r,n,a,i,o){var s;for(s in r=r||{},t=t||{})t.hasOwnProperty(s)&&(e.deepEqual(t[s],r[s])||n.push({command:o,args:[a,s,r[s],i]}));for(s in r)r.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e.deepEqual(t[s],r[s])||n.push({command:o,args:[a,s,r[s],i]}))}function We(e){return e.id}function Xe(e,t){return e[t.id]=t,e}var Ze=function(e,t){this.reset(e,t)};Ze.prototype.reset=function(e,t){this.points=e||[],this._distances=[0];for(var r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ze.prototype.lerp=function(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);for(var r=1,n=this._distances[r],a=t*this.paddedLength+this.padding;n<a&&r<this._distances.length;)n=this._distances[++r];var i=r-1,o=this._distances[i],s=n-o,l=s>0?(a-o)/s:0;return this.points[i].mult(1-l).add(this.points[r].mult(l))};var Ke=function(e,t,r){var n=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(var i=0;i<this.xCellCount*this.yCellCount;i++)n.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};function Je(t,r,n,a,i){var o=e.create();return r?(e.scale(o,o,[1/i,1/i,1]),n||e.rotateZ(o,o,a.angle)):e.multiply(o,a.labelPlaneMatrix,t),o}function Qe(t,r,n,a,i){if(r){var o=e.clone(t);return e.scale(o,o,[i,i,1]),n||e.rotateZ(o,o,-a.angle),o}return a.glCoordMatrix}function $e(t,r){var n=[t.x,t.y,0,1];ct(n,n,r);var a=n[3];return{point:new e.Point(n[0]/a,n[1]/a),signedDistanceFromCamera:a}}function et(e,t){return.5+e/t*.5}function tt(e,t){var r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function rt(t,r,n,a,i,o,s,l){var u=a?t.textSizeData:t.iconSizeData,c=e.evaluateSizeForZoom(u,n.transform.zoom),f=[256/n.width*2+1,256/n.height*2+1],h=a?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();for(var p=t.lineVertexArray,d=a?t.text.placedSymbolArray:t.icon.placedSymbolArray,v=n.transform.width/n.transform.height,m=!1,g=0;g<d.length;g++){var y=d.get(g);if(y.hidden||y.writingMode===e.WritingMode.vertical&&!m)ut(y.numGlyphs,h);else{m=!1;var x=[y.anchorX,y.anchorY,0,1];if(e.transformMat4(x,x,r),tt(x,f)){var _=et(n.transform.cameraToCenterDistance,x[3]),b=e.evaluateSizeForFeature(u,c,y),w=s?b/_:b*_,T=new e.Point(y.anchorX,y.anchorY),k=$e(T,i).point,A={},M=it(y,w,!1,l,r,i,o,t.glyphOffsetArray,p,h,k,T,A,v);m=M.useVertical,(M.notEnoughRoom||m||M.needsFlipping&&it(y,w,!0,l,r,i,o,t.glyphOffsetArray,p,h,k,T,A,v).notEnoughRoom)&&ut(y.numGlyphs,h)}else ut(y.numGlyphs,h)}}a?t.text.dynamicLayoutVertexBuffer.updateData(h):t.icon.dynamicLayoutVertexBuffer.updateData(h)}function nt(e,t,r,n,a,i,o,s,l,u,c){var f=s.glyphStartIndex+s.numGlyphs,h=s.lineStartIndex,p=s.lineStartIndex+s.lineLength,d=t.getoffsetX(s.glyphStartIndex),v=t.getoffsetX(f-1),m=st(e*d,r,n,a,i,o,s.segment,h,p,l,u,c);if(!m)return null;var g=st(e*v,r,n,a,i,o,s.segment,h,p,l,u,c);return g?{first:m,last:g}:null}function at(t,r,n,a){return t===e.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*a?{useVertical:!0}:(t===e.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function it(t,r,n,a,i,o,s,l,u,c,f,h,p,d){var v,m=r/24,g=t.lineOffsetX*m,y=t.lineOffsetY*m;if(t.numGlyphs>1){var x=t.glyphStartIndex+t.numGlyphs,_=t.lineStartIndex,b=t.lineStartIndex+t.lineLength,w=nt(m,l,g,y,n,f,h,t,u,o,p);if(!w)return{notEnoughRoom:!0};var T=$e(w.first.point,s).point,k=$e(w.last.point,s).point;if(a&&!n){var A=at(t.writingMode,T,k,d);if(A)return A}v=[w.first];for(var M=t.glyphStartIndex+1;M<x-1;M++)v.push(st(m*l.getoffsetX(M),g,y,n,f,h,t.segment,_,b,u,o,p));v.push(w.last)}else{if(a&&!n){var E=$e(h,i).point,S=t.lineStartIndex+t.segment+1,C=new e.Point(u.getx(S),u.gety(S)),L=$e(C,i),I=L.signedDistanceFromCamera>0?L.point:ot(h,C,E,1,i),O=at(t.writingMode,E,I,d);if(O)return O}var P=st(m*l.getoffsetX(t.glyphStartIndex),g,y,n,f,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,o,p);if(!P)return{notEnoughRoom:!0};v=[P]}for(var D=0,R=v;D<R.length;D+=1){var z=R[D];e.addDynamicAttributes(c,z.point,z.angle)}return{}}function ot(e,t,r,n,a){var i=$e(e.add(e.sub(t)._unit()),a).point,o=r.sub(i);return r.add(o._mult(n/o.mag()))}function st(t,r,n,a,i,o,s,l,u,c,f,h){var p=a?t-r:t+r,d=p>0?1:-1,v=0;a&&(d*=-1,v=Math.PI),d<0&&(v+=Math.PI);for(var m=d>0?l+s:l+s+1,g=i,y=i,x=0,_=0,b=Math.abs(p),w=[];x+_<=b;){if((m+=d)<l||m>=u)return null;if(y=g,w.push(g),void 0===(g=h[m])){var T=new e.Point(c.getx(m),c.gety(m)),k=$e(T,f);if(k.signedDistanceFromCamera>0)g=h[m]=k.point;else{var A=m-d;g=ot(0===x?o:new e.Point(c.getx(A),c.gety(A)),T,y,b-x+1,f)}}x+=_,_=y.dist(g)}var M=(b-x)/_,E=g.sub(y),S=E.mult(M)._add(y);S._add(E._unit()._perp()._mult(n*d));var C=v+Math.atan2(g.y-y.y,g.x-y.x);return w.push(S),{point:S,angle:C,path:w}}Ke.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ke.prototype.insert=function(e,t,r,n,a){this._forEachCell(t,r,n,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)},Ke.prototype.insertCircle=function(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)},Ke.prototype._insertBoxCell=function(e,t,r,n,a,i){this.boxCells[a].push(i)},Ke.prototype._insertCircleCell=function(e,t,r,n,a,i){this.circleCells[a].push(i)},Ke.prototype._query=function(e,t,r,n,a,i){if(r<0||e>this.width||n<0||t>this.height)return!a&&[];var o=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(a)return!0;for(var s=0;s<this.boxKeys.length;s++)o.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],f=this.circles[3*l+2];o.push({key:this.circleKeys[l],x1:u-f,y1:c-f,x2:u+f,y2:c+f})}return i?o.filter(i):o}return this._forEachCell(e,t,r,n,this._queryCell,o,{hitTest:a,seenUids:{box:{},circle:{}}},i),a?o.length>0:o},Ke.prototype._queryCircle=function(e,t,r,n,a){var i=e-r,o=e+r,s=t-r,l=t+r;if(o<0||i>this.width||l<0||s>this.height)return!n&&[];var u=[];return this._forEachCell(i,s,o,l,this._queryCellCircle,u,{hitTest:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},a),n?u.length>0:u},Ke.prototype.query=function(e,t,r,n,a){return this._query(e,t,r,n,!1,a)},Ke.prototype.hitTest=function(e,t,r,n,a){return this._query(e,t,r,n,!0,a)},Ke.prototype.hitTestCircle=function(e,t,r,n){return this._queryCircle(e,t,r,!0,n)},Ke.prototype._queryCell=function(e,t,r,n,a,i,o,s){var l=o.seenUids,u=this.boxCells[a];if(null!==u)for(var c=this.bboxes,f=0,h=u;f<h.length;f+=1){var p=h[f];if(!l.box[p]){l.box[p]=!0;var d=4*p;if(e<=c[d+2]&&t<=c[d+3]&&r>=c[d+0]&&n>=c[d+1]&&(!s||s(this.boxKeys[p]))){if(o.hitTest)return i.push(!0),!0;i.push({key:this.boxKeys[p],x1:c[d],y1:c[d+1],x2:c[d+2],y2:c[d+3]})}}}var v=this.circleCells[a];if(null!==v)for(var m=this.circles,g=0,y=v;g<y.length;g+=1){var x=y[g];if(!l.circle[x]){l.circle[x]=!0;var _=3*x;if(this._circleAndRectCollide(m[_],m[_+1],m[_+2],e,t,r,n)&&(!s||s(this.circleKeys[x]))){if(o.hitTest)return i.push(!0),!0;var b=m[_],w=m[_+1],T=m[_+2];i.push({key:this.circleKeys[x],x1:b-T,y1:w-T,x2:b+T,y2:w+T})}}}},Ke.prototype._queryCellCircle=function(e,t,r,n,a,i,o,s){var l=o.circle,u=o.seenUids,c=this.boxCells[a];if(null!==c)for(var f=this.bboxes,h=0,p=c;h<p.length;h+=1){var d=p[h];if(!u.box[d]){u.box[d]=!0;var v=4*d;if(this._circleAndRectCollide(l.x,l.y,l.radius,f[v+0],f[v+1],f[v+2],f[v+3])&&(!s||s(this.boxKeys[d])))return i.push(!0),!0}}var m=this.circleCells[a];if(null!==m)for(var g=this.circles,y=0,x=m;y<x.length;y+=1){var _=x[y];if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circlesCollide(g[b],g[b+1],g[b+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[_])))return i.push(!0),!0}}},Ke.prototype._forEachCell=function(e,t,r,n,a,i,o,s){for(var l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(r),f=this._convertToYCellCoord(n),h=l;h<=c;h++)for(var p=u;p<=f;p++)if(a.call(this,e,t,r,n,this.xCellCount*p+h,i,o,s))return},Ke.prototype._convertToXCellCoord=function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))},Ke.prototype._convertToYCellCoord=function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))},Ke.prototype._circlesCollide=function(e,t,r,n,a,i){var o=n-e,s=a-t,l=r+i;return l*l>o*o+s*s},Ke.prototype._circleAndRectCollide=function(e,t,r,n,a,i,o){var s=(i-n)/2,l=Math.abs(e-(n+s));if(l>s+r)return!1;var u=(o-a)/2,c=Math.abs(t-(a+u));if(c>u+r)return!1;if(l<=s||c<=u)return!0;var f=l-s,h=c-u;return f*f+h*h<=r*r};var lt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ut(e,t){for(var r=0;r<e;r++){var n=t.length;t.resize(n+4),t.float32.set(lt,3*n)}}function ct(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[4]*a+r[12],e[1]=r[1]*n+r[5]*a+r[13],e[3]=r[3]*n+r[7]*a+r[15],e}var ft=function(e,t,r){void 0===t&&(t=new Ke(e.width+200,e.height+200,25)),void 0===r&&(r=new Ke(e.width+200,e.height+200,25)),this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200};function ht(t,r,n){return r*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}ft.prototype.placeCollisionBox=function(e,t,r,n,a){var i=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY),o=r*i.perspectiveRatio,s=e.x1*o+i.point.x,l=e.y1*o+i.point.y,u=e.x2*o+i.point.x,c=e.y2*o+i.point.y;return!this.isInsideGrid(s,l,u,c)||!t&&this.grid.hitTest(s,l,u,c,a)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},ft.prototype.placeCollisionCircles=function(t,r,n,a,i,o,s,l,u,c,f,h,p){var d=[],v=new e.Point(r.anchorX,r.anchorY),m=$e(v,o),g=et(this.transform.cameraToCenterDistance,m.signedDistanceFromCamera),y=(c?i/g:i*g)/e.ONE_EM,x=$e(v,s).point,_=nt(y,a,r.lineOffsetX*y,r.lineOffsetY*y,!1,x,v,r,n,s,{}),b=!1,w=!1,T=!0;if(_){for(var k=.5*h*g+p,A=new e.Point(-100,-100),M=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),E=new Ze,S=_.first,C=_.last,L=[],I=S.path.length-1;I>=1;I--)L.push(S.path[I]);for(var O=1;O<C.path.length;O++)L.push(C.path[O]);var P=2.5*k;if(l){var D=L.map(function(e){return $e(e,l)});L=D.some(function(e){return e.signedDistanceFromCamera<=0})?[]:D.map(function(e){return e.point})}var R=[];if(L.length>0){for(var z=L[0].clone(),N=L[0].clone(),F=1;F<L.length;F++)z.x=Math.min(z.x,L[F].x),z.y=Math.min(z.y,L[F].y),N.x=Math.max(N.x,L[F].x),N.y=Math.max(N.y,L[F].y);R=z.x>=A.x&&N.x<=M.x&&z.y>=A.y&&N.y<=M.y?[L]:N.x<A.x||z.x>M.x||N.y<A.y||z.y>M.y?[]:e.clipLine([L],A.x,A.y,M.x,M.y)}for(var B=0,j=R;B<j.length;B+=1){var U;E.reset(j[B],.25*k),U=E.length<=.5*k?1:Math.ceil(E.paddedLength/P)+1;for(var H=0;H<U;H++){var V=H/Math.max(U-1,1),G=E.lerp(V),q=G.x+100,Y=G.y+100;d.push(q,Y,k,0);var W=q-k,X=Y-k,Z=q+k,K=Y+k;if(T=T&&this.isOffscreen(W,X,Z,K),w=w||this.isInsideGrid(W,X,Z,K),!t&&this.grid.hitTestCircle(q,Y,k,f)&&(b=!0,!u))return{circles:[],offscreen:!1,collisionDetected:b}}}}return{circles:!u&&b||!w?[]:d,offscreen:T,collisionDetected:b}},ft.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],n=1/0,a=1/0,i=-1/0,o=-1/0,s=0,l=t;s<l.length;s+=1){var u=l[s],c=new e.Point(u.x+100,u.y+100);n=Math.min(n,c.x),a=Math.min(a,c.y),i=Math.max(i,c.x),o=Math.max(o,c.y),r.push(c)}for(var f={},h={},p=0,d=this.grid.query(n,a,i,o).concat(this.ignoredGrid.query(n,a,i,o));p<d.length;p+=1){var v=d[p],m=v.key;if(void 0===f[m.bucketInstanceId]&&(f[m.bucketInstanceId]={}),!f[m.bucketInstanceId][m.featureIndex]){var g=[new e.Point(v.x1,v.y1),new e.Point(v.x2,v.y1),new e.Point(v.x2,v.y2),new e.Point(v.x1,v.y2)];e.polygonIntersectsPolygon(r,g)&&(f[m.bucketInstanceId][m.featureIndex]=!0,void 0===h[m.bucketInstanceId]&&(h[m.bucketInstanceId]=[]),h[m.bucketInstanceId].push(m.featureIndex))}}return h},ft.prototype.insertCollisionBox=function(e,t,r,n,a){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:a},e[0],e[1],e[2],e[3])},ft.prototype.insertCollisionCircles=function(e,t,r,n,a){for(var i=t?this.ignoredGrid:this.grid,o={bucketInstanceId:r,featureIndex:n,collisionGroupID:a},s=0;s<e.length;s+=4)i.insertCircle(o,e[s],e[s+1],e[s+2])},ft.prototype.projectAndGetPerspectiveRatio=function(t,r,n){var a=[r,n,0,1];return ct(a,a,t),{point:new e.Point((a[0]/a[3]+1)/2*this.transform.width+100,(-a[1]/a[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/a[3]*.5}},ft.prototype.isOffscreen=function(e,t,r,n){return r<100||e>=this.screenRightBoundary||n<100||t>this.screenBottomBoundary},ft.prototype.isInsideGrid=function(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary},ft.prototype.getViewportMatrix=function(){var t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t};var pt=function(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r};pt.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var dt=function(e,t,r,n,a){this.text=new pt(e?e.text:null,t,r,a),this.icon=new pt(e?e.icon:null,t,n,a)};dt.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var vt=function(e,t,r){this.text=e,this.icon=t,this.skipFade=r},mt=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},gt=function(e,t,r,n,a){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=a},yt=function(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}};function xt(t,r,n,a,i){var o=e.getAnchorAlignment(t),s=-(o.horizontalAlign-.5)*r,l=-(o.verticalAlign-.5)*n,u=e.evaluateVariableOffset(t,a);return new e.Point(s+u[0]*i,l+u[1]*i)}function _t(t,r,n,a,i,o){var s=t.x1,l=t.x2,u=t.y1,c=t.y2,f=t.anchorPointX,h=t.anchorPointY,p=new e.Point(r,n);return a&&p._rotate(i?o:-o),{x1:s+p.x,y1:u+p.y,x2:l+p.x,y2:c+p.y,anchorPointX:f,anchorPointY:h}}yt.prototype.get=function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]};var bt=function(e,t,r,n){this.transform=e.clone(),this.collisionIndex=new ft(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new yt(r),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}};function wt(e,t,r,n,a){e.emplaceBack(t?1:0,r?1:0,n||0,a||0),e.emplaceBack(t?1:0,r?1:0,n||0,a||0),e.emplaceBack(t?1:0,r?1:0,n||0,a||0),e.emplaceBack(t?1:0,r?1:0,n||0,a||0)}bt.prototype.getBucketParts=function(t,r,n,a){var i=n.getBucket(r),o=n.latestFeatureIndex;if(i&&o&&r.id===i.layerIds[0]){var s=n.collisionBoxArray,l=i.layers[0].layout,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/e.EXTENT,f=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),h="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),d=ht(n,1,this.transform.zoom),v=Je(f,h,p,this.transform,d),m=null;if(h){var g=Qe(f,h,p,this.transform,d);m=e.multiply([],this.transform.labelPlaneMatrix,g)}this.retainedQueryData[i.bucketInstanceId]=new gt(i.bucketInstanceId,o,i.sourceLayerIndex,i.index,n.tileID);var y={bucket:i,layout:l,posMatrix:f,textLabelPlaneMatrix:v,labelToScreenMatrix:m,scale:u,textPixelRatio:c,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(i.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(i.sourceID)};if(a)for(var x=0,_=i.sortKeyRanges;x<_.length;x+=1){var b=_[x];t.push({sortKey:b.sortKey,symbolInstanceStart:b.symbolInstanceStart,symbolInstanceEnd:b.symbolInstanceEnd,parameters:y})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:i.symbolInstances.length,parameters:y})}},bt.prototype.attemptAnchorPlacement=function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d){var v,m=[f.textOffset0,f.textOffset1],g=xt(e,r,n,m,a),y=this.collisionIndex.placeCollisionBox(_t(t,g.x,g.y,i,o,this.transform.angle),c,s,l,u.predicate);if(!d||0!==this.collisionIndex.placeCollisionBox(_t(d,g.x,g.y,i,o,this.transform.angle),c,s,l,u.predicate).box.length)return y.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID].text&&(v=this.prevPlacement.variableOffsets[f.crossTileID].anchor),this.variableOffsets[f.crossTileID]={textOffset:m,width:r,height:n,anchor:e,textBoxScale:a,prevAnchor:v},this.markUsedJustification(h,e,f,p),h.allowVerticalPlacement&&(this.markUsedOrientation(h,p,f),this.placedOrientations[f.crossTileID]=p),{shift:g,placedGlyphBoxes:y}):void 0},bt.prototype.placeLayerBucketPart=function(t,r,n){var a=this,i=t.parameters,o=i.bucket,s=i.layout,l=i.posMatrix,u=i.textLabelPlaneMatrix,c=i.labelToScreenMatrix,f=i.textPixelRatio,h=i.holdingForFade,p=i.collisionBoxArray,d=i.partiallyEvaluatedTextSize,v=i.collisionGroup,m=s.get("text-optional"),g=s.get("icon-optional"),y=s.get("text-allow-overlap"),x=s.get("icon-allow-overlap"),_="map"===s.get("text-rotation-alignment"),b="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),T="viewport-y"===s.get("symbol-z-order"),k=y&&(x||!o.hasIconData()||g),A=x&&(y||!o.hasTextData()||m);!o.collisionArrays&&p&&o.deserializeCollisionBoxes(p);var M=function(t,i){if(!r[t.crossTileID])if(h)a.placements[t.crossTileID]=new vt(!1,!1,!1);else{var p,T=!1,M=!1,E=!0,S=null,C={box:null,offscreen:null},L={box:null,offscreen:null},I=null,O=null,P=0,D=0,R=0;i.textFeatureIndex?P=i.textFeatureIndex:t.useRuntimeCollisionCircles&&(P=t.featureIndex),i.verticalTextFeatureIndex&&(D=i.verticalTextFeatureIndex);var z=i.textBox;if(z){var N=function(r){var n=e.WritingMode.horizontal;if(o.allowVerticalPlacement&&!r&&a.prevPlacement){var i=a.prevPlacement.placedOrientations[t.crossTileID];i&&(a.placedOrientations[t.crossTileID]=i,a.markUsedOrientation(o,n=i,t))}return n},F=function(r,n){if(o.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&i.verticalTextBox)for(var a=0,s=o.writingModes;a<s.length&&(s[a]===e.WritingMode.vertical?(C=n(),L=C):C=r(),!(C&&C.box&&C.box.length));a+=1);else C=r()};if(s.get("text-variable-anchor")){var B=s.get("text-variable-anchor");if(a.prevPlacement&&a.prevPlacement.variableOffsets[t.crossTileID]){var j=a.prevPlacement.variableOffsets[t.crossTileID];B.indexOf(j.anchor)>0&&(B=B.filter(function(e){return e!==j.anchor})).unshift(j.anchor)}var U=function(e,r,n){for(var i=e.x2-e.x1,s=e.y2-e.y1,u=t.textBoxScale,c=w&&!x?r:null,h={box:[],offscreen:!1},p=y?2*B.length:B.length,d=0;d<p;++d){var m=a.attemptAnchorPlacement(B[d%B.length],e,i,s,u,_,b,f,l,v,d>=B.length,t,o,n,c);if(m&&(h=m.placedGlyphBoxes)&&h.box&&h.box.length){T=!0,S=m.shift;break}}return h};F(function(){return U(z,i.iconBox,e.WritingMode.horizontal)},function(){var r=i.verticalTextBox;return o.allowVerticalPlacement&&!(C&&C.box&&C.box.length)&&t.numVerticalGlyphVertices>0&&r?U(r,i.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),C&&(T=C.box,E=C.offscreen);var H=N(C&&C.box);if(!T&&a.prevPlacement){var V=a.prevPlacement.variableOffsets[t.crossTileID];V&&(a.variableOffsets[t.crossTileID]=V,a.markUsedJustification(o,V.anchor,t,H))}}else{var G=function(e,r){var n=a.collisionIndex.placeCollisionBox(e,y,f,l,v.predicate);return n&&n.box&&n.box.length&&(a.markUsedOrientation(o,r,t),a.placedOrientations[t.crossTileID]=r),n};F(function(){return G(z,e.WritingMode.horizontal)},function(){var r=i.verticalTextBox;return o.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&r?G(r,e.WritingMode.vertical):{box:null,offscreen:null}}),N(C&&C.box&&C.box.length)}}if(T=(p=C)&&p.box&&p.box.length>0,E=p&&p.offscreen,t.useRuntimeCollisionCircles){var q=o.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),Y=e.evaluateSizeForFeature(o.textSizeData,d,q),W=s.get("text-padding");I=a.collisionIndex.placeCollisionCircles(y,q,o.lineVertexArray,o.glyphOffsetArray,Y,l,u,c,n,b,v.predicate,t.collisionCircleDiameter,W),T=y||I.circles.length>0&&!I.collisionDetected,E=E&&I.offscreen}if(i.iconFeatureIndex&&(R=i.iconFeatureIndex),i.iconBox){var X=function(e){var t=w&&S?_t(e,S.x,S.y,_,b,a.transform.angle):e;return a.collisionIndex.placeCollisionBox(t,x,f,l,v.predicate)};M=L&&L.box&&L.box.length&&i.verticalIconBox?(O=X(i.verticalIconBox)).box.length>0:(O=X(i.iconBox)).box.length>0,E=E&&O.offscreen}var Z=m||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,K=g||0===t.numIconVertices;if(Z||K?K?Z||(M=M&&T):T=M&&T:M=T=M&&T,T&&p&&p.box&&a.collisionIndex.insertCollisionBox(p.box,s.get("text-ignore-placement"),o.bucketInstanceId,L&&L.box&&D?D:P,v.ID),M&&O&&a.collisionIndex.insertCollisionBox(O.box,s.get("icon-ignore-placement"),o.bucketInstanceId,R,v.ID),I&&(T&&a.collisionIndex.insertCollisionCircles(I.circles,s.get("text-ignore-placement"),o.bucketInstanceId,P,v.ID),n)){var J=o.bucketInstanceId,Q=a.collisionCircleArrays[J];void 0===Q&&(Q=a.collisionCircleArrays[J]=new mt);for(var $=0;$<I.circles.length;$+=4)Q.circles.push(I.circles[$+0]),Q.circles.push(I.circles[$+1]),Q.circles.push(I.circles[$+2]),Q.circles.push(I.collisionDetected?1:0)}a.placements[t.crossTileID]=new vt(T||k,M||A,E||o.justReloaded),r[t.crossTileID]=!0}};if(T)for(var E=o.getSortedSymbolIndexes(this.transform.angle),S=E.length-1;S>=0;--S){var C=E[S];M(o.symbolInstances.get(C),o.collisionArrays[C])}else for(var L=t.symbolInstanceStart;L<t.symbolInstanceEnd;L++)M(o.symbolInstances.get(L),o.collisionArrays[L]);if(n&&o.bucketInstanceId in this.collisionCircleArrays){var I=this.collisionCircleArrays[o.bucketInstanceId];e.invert(I.invProjMatrix,l),I.viewportMatrix=this.collisionIndex.getViewportMatrix()}o.justReloaded=!1},bt.prototype.markUsedJustification=function(t,r,n,a){var i;i=a===e.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(r)];for(var o=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];o<s.length;o+=1){var l=s[o];l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=i>=0&&l!==i?0:n.crossTileID)}},bt.prototype.markUsedOrientation=function(t,r,n){for(var a=r===e.WritingMode.horizontal||r===e.WritingMode.horizontalOnly?r:0,i=r===e.WritingMode.vertical?r:0,o=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];o<s.length;o+=1)t.text.placedSymbolArray.get(s[o]).placedOrientation=a;n.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=i)},bt.prototype.commit=function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var n=t?t.symbolFadeChange(e):1,a=t?t.opacities:{},i=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=a[s];u?(this.opacities[s]=new dt(u,n,l.text,l.icon),r=r||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new dt(null,n,l.text,l.icon,l.skipFade),r=r||l.text||l.icon)}for(var c in a){var f=a[c];if(!this.opacities[c]){var h=new dt(f,n,!1,!1);h.isHidden()||(this.opacities[c]=h,r=r||f.text.placed||f.icon.placed)}}for(var p in i)this.variableOffsets[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.variableOffsets[p]=i[p]);for(var d in o)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=o[d]);r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},bt.prototype.updateLayerOpacities=function(e,t){for(var r={},n=0,a=t;n<a.length;n+=1){var i=a[n],o=i.getBucket(e);o&&i.latestFeatureIndex&&e.id===o.layerIds[0]&&this.updateBucketOpacities(o,r,i.collisionBoxArray)}},bt.prototype.updateBucketOpacities=function(t,r,n){var a=this;t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();var i=t.layers[0].layout,o=new dt(null,0,!1,!1,!0),s=i.get("text-allow-overlap"),l=i.get("icon-allow-overlap"),u=i.get("text-variable-anchor"),c="map"===i.get("text-rotation-alignment"),f="map"===i.get("text-pitch-alignment"),h="none"!==i.get("icon-text-fit"),p=new dt(null,0,s&&(l||!t.hasIconData()||i.get("icon-optional")),l&&(s||!t.hasTextData()||i.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);for(var d=function(e,t,r){for(var n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r)},v=function(n){var i=t.symbolInstances.get(n),s=i.numHorizontalGlyphVertices,l=i.numVerticalGlyphVertices,v=i.crossTileID,m=a.opacities[v];r[v]?m=o:m||(a.opacities[v]=m=p),r[v]=!0;var g=i.numIconVertices>0,y=a.placedOrientations[i.crossTileID],x=y===e.WritingMode.vertical,_=y===e.WritingMode.horizontal||y===e.WritingMode.horizontalOnly;if(s>0||l>0){var b=Lt(m.text);d(t.text,s,x?It:b),d(t.text,l,_?It:b);var w=m.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach(function(e){e>=0&&(t.text.placedSymbolArray.get(e).hidden=w||x?1:0)}),i.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=w||_?1:0);var T=a.variableOffsets[i.crossTileID];T&&a.markUsedJustification(t,T.anchor,i,y);var k=a.placedOrientations[i.crossTileID];k&&(a.markUsedJustification(t,"left",i,k),a.markUsedOrientation(t,k,i))}if(g){var A=Lt(m.icon),M=!(h&&i.verticalPlacedIconSymbolIndex&&x);i.placedIconSymbolIndex>=0&&(d(t.icon,i.numIconVertices,M?A:It),t.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=m.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(d(t.icon,i.numVerticalIconVertices,M?It:A),t.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){var E=t.collisionArrays[n];if(E){var S=new e.Point(0,0);if(E.textBox||E.verticalTextBox){var C=!0;if(u){var L=a.variableOffsets[v];L?(S=xt(L.anchor,L.width,L.height,L.textOffset,L.textBoxScale),c&&S._rotate(f?a.transform.angle:-a.transform.angle)):C=!1}E.textBox&&wt(t.textCollisionBox.collisionVertexArray,m.text.placed,!C||x,S.x,S.y),E.verticalTextBox&&wt(t.textCollisionBox.collisionVertexArray,m.text.placed,!C||_,S.x,S.y)}var I=Boolean(!_&&E.verticalIconBox);E.iconBox&&wt(t.iconCollisionBox.collisionVertexArray,m.icon.placed,I,h?S.x:0,h?S.y:0),E.verticalIconBox&&wt(t.iconCollisionBox.collisionVertexArray,m.icon.placed,!I,h?S.x:0,h?S.y:0)}}},m=0;m<t.symbolInstances.length;m++)v(m);if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){var g=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=g.invProjMatrix,t.placementViewportMatrix=g.viewportMatrix,t.collisionCircleArray=g.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}},bt.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},bt.prototype.zoomAdjustment=function(e){return Math.max(0,(this.transform.zoom-e)/1.5)},bt.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},bt.prototype.stillRecent=function(e,t){var r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e},bt.prototype.setStale=function(){this.stale=!0};var Tt=Math.pow(2,25),kt=Math.pow(2,24),At=Math.pow(2,17),Mt=Math.pow(2,16),Et=Math.pow(2,9),St=Math.pow(2,8),Ct=Math.pow(2,1);function Lt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Tt+t*kt+r*At+t*Mt+r*Et+t*St+r*Ct+t}var It=0,Ot=function(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ot.prototype.continuePlacement=function(e,t,r,n,a){for(var i=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(i,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,a())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,i.sort(function(e,t){return e.sortKey-t.sortKey}));this._currentPartIndex<i.length;)if(t.placeLayerBucketPart(i[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,a())return!0;return!1};var Pt=function(e,t,r,n,a,i,o){this.placement=new bt(e,a,i,o),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1};Pt.prototype.isDone=function(){return this._done},Pt.prototype.continuePlacement=function(t,r,n){for(var a=this,i=e.browser.now(),o=function(){var t=e.browser.now()-i;return!a._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=r[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Ot(s)),this._inProgressLayer.continuePlacement(n[s.source],this.placement,this._showCollisionBoxes,s,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Pt.prototype.commit=function(e){return this.placement.commit(e),this.placement};var Dt=512/e.EXTENT/2,Rt=function(e,t,r){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var n=0;n<t.length;n++){var a=t.get(n),i=a.key;this.indexedSymbolInstances[i]||(this.indexedSymbolInstances[i]=[]),this.indexedSymbolInstances[i].push({crossTileID:a.crossTileID,coord:this.getScaledCoordinates(a,e)})}};Rt.prototype.getScaledCoordinates=function(t,r){var n=Dt/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*e.EXTENT+t.anchorX)*n),y:Math.floor((r.canonical.y*e.EXTENT+t.anchorY)*n)}},Rt.prototype.findMatches=function(e,t,r){for(var n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),a=0;a<e.length;a++){var i=e.get(a);if(!i.crossTileID){var o=this.indexedSymbolInstances[i.key];if(o)for(var s=this.getScaledCoordinates(i,t),l=0,u=o;l<u.length;l+=1){var c=u[l];if(Math.abs(c.coord.x-s.x)<=n&&Math.abs(c.coord.y-s.y)<=n&&!r[c.crossTileID]){r[c.crossTileID]=!0,i.crossTileID=c.crossTileID;break}}}}};var zt=function(){this.maxCrossTileID=0};zt.prototype.generate=function(){return++this.maxCrossTileID};var Nt=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Nt.prototype.handleWrapJump=function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var r in this.indexes){var n=this.indexes[r],a={};for(var i in n){var o=n[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),a[o.tileID.key]=o}this.indexes[r]=a}this.lng=e},Nt.prototype.addBucket=function(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var n=0;n<t.symbolInstances.length;n++)t.symbolInstances.get(n).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var a=this.usedCrossTileIDs[e.overscaledZ];for(var i in this.indexes){var o=this.indexes[i];if(Number(i)>e.overscaledZ)for(var s in o){var l=o[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,a)}else{var u=o[e.scaledTo(Number(i)).key];u&&u.findMatches(t.symbolInstances,e,a)}}for(var c=0;c<t.symbolInstances.length;c++){var f=t.symbolInstances.get(c);f.crossTileID||(f.crossTileID=r.generate(),a[f.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Rt(e,t.symbolInstances,t.bucketInstanceId),!0},Nt.prototype.removeBucketCrossTileIDs=function(e,t){for(var r in t.indexedSymbolInstances)for(var n=0,a=t.indexedSymbolInstances[r];n<a.length;n+=1)delete this.usedCrossTileIDs[e][a[n].crossTileID]},Nt.prototype.removeStaleBuckets=function(e){var t=!1;for(var r in this.indexes){var n=this.indexes[r];for(var a in n)e[n[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[a]),delete n[a],t=!0)}return t};var Ft=function(){this.layerIndexes={},this.crossTileIDs=new zt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ft.prototype.addLayer=function(e,t,r){var n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Nt);var a=!1,i={};n.handleWrapJump(r);for(var o=0,s=t;o<s.length;o+=1){var l=s[o],u=l.getBucket(e);u&&e.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(a=!0),i[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(i)&&(a=!0),a},Ft.prototype.pruneUnusedLayers=function(e){var t={};for(var r in e.forEach(function(e){t[e]=!0}),this.layerIndexes)t[r]||delete this.layerIndexes[r]};var Bt=function(t,r){return e.emitValidationErrors(t,r&&r.filter(function(e){return"source.canvas"!==e.identifier}))},jt=e.pick(Ue,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ut=e.pick(Ue,["setCenter","setZoom","setBearing","setPitch"]),Ht=function(){var t={},r=e.styleSpec.$version;for(var n in e.styleSpec.$root){var a,i=e.styleSpec.$root[n];if(i.required)null!=(a="version"===n?r:"array"===i.type?[]:{})&&(t[n]=a)}return t}(),Vt=function(t){function r(n,a){var i=this;void 0===a&&(a={}),t.call(this),this.map=n,this.dispatcher=new k(Fe(),this),this.imageManager=new h,this.imageManager.setEventedParent(this),this.glyphManager=new x(n._requestManager,a.localIdeographFontFamily),this.lineAtlas=new T(256,512),this.crossTileSymbolIndex=new Ft,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var o=this;this._rtlTextPluginCallback=r.registerForPluginStateChange(function(t){o.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},function(t,r){if(e.triggerPluginCompletionEvent(t),r&&r.every(function(e){return e}))for(var n in o.sourceCaches)o.sourceCaches[n].reload()})}),this.on("data",function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=i.sourceCaches[e.sourceId];if(t){var r=t.getSource();if(r&&r.vectorLayerIds)for(var n in i._layers){var a=i._layers[n];a.source===r.id&&i._validateLayer(a)}}}})}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.loadURL=function(t,r){var n=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var a="boolean"==typeof r.validate?r.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken);var i=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(i,function(t,r){n._request=null,t?n.fire(new e.ErrorEvent(t)):r&&n._load(r,a)})},r.prototype.loadJSON=function(t,r){var n=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){n._request=null,n._load(t,!1!==r.validate)})},r.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Ht,!1)},r.prototype._load=function(t,r){if(!r||!Bt(this,e.validateStyle(t))){for(var n in this._loaded=!0,this.stylesheet=t,t.sources)this.addSource(n,t.sources[n],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var a=je(this.stylesheet.layers);this._order=a.map(function(e){return e.id}),this._layers={},this._serializedLayers={};for(var i=0,o=a;i<o.length;i+=1){var s=o[i];(s=e.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},r.prototype._loadSprite=function(t){var r=this;this._spriteRequest=function(t,r,n){var a,i,o,s=e.browser.devicePixelRatio>1?"@2x":"",l=e.getJSON(r.transformRequest(r.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),function(e,t){l=null,o||(o=e,a=t,c())}),u=e.getImage(r.transformRequest(r.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),function(e,t){u=null,o||(o=e,i=t,c())});function c(){if(o)n(o);else if(a&&i){var t=e.browser.getImageData(i),r={};for(var s in a){var l=a[s],u=l.width,c=l.height,f=l.x,h=l.y,p=l.sdf,d=l.pixelRatio,v=l.stretchX,m=l.stretchY,g=l.content,y=new e.RGBAImage({width:u,height:c});e.RGBAImage.copy(t,y,{x:f,y:h},{x:0,y:0},{width:u,height:c}),r[s]={data:y,pixelRatio:d,sdf:p,stretchX:v,stretchY:m,content:g}}n(null,r)}}return{cancel:function(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(t,this.map._requestManager,function(t,n){if(r._spriteRequest=null,t)r.fire(new e.ErrorEvent(t));else if(n)for(var a in n)r.imageManager.addImage(a,n[a]);r.imageManager.setLoaded(!0),r._availableImages=r.imageManager.listImages(),r.dispatcher.broadcast("setImages",r._availableImages),r.fire(new e.Event("data",{dataType:"style"}))})},r.prototype._validateLayer=function(t){var r=this.sourceCaches[t.source];if(r){var n=t.sourceLayer;if(n){var a=r.getSource();("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+n+'" does not exist on source "'+a.id+'" as specified by style layer "'+t.id+'"')))}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(e){for(var t=[],r=0,n=e;r<n.length;r+=1){var a=this._layers[n[r]];"custom"!==a.type&&t.push(a.serialize())}return t},r.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(t){if(this._loaded){var r=this._changed;if(this._changed){var n=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);for(var i in(n.length||a.length)&&this._updateWorkerLayers(n,a),this._updatedSources){var o=this._updatedSources[i];"reload"===o?this._reloadSource(i):"clear"===o&&this._clearSource(i)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var l in this.sourceCaches)this.sourceCaches[l].used=!1;for(var u=0,c=this._order;u<c.length;u+=1){var f=this._layers[c[u]];f.recalculate(t,this._availableImages),!f.isHidden(t.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}this.light.recalculate(t),this.z=t.zoom,r&&this.fire(new e.Event("data",{dataType:"style"}))}},r.prototype._updateTilesForChangedImages=function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}},r.prototype._updateWorkerLayers=function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},r.prototype.setState=function(t){var r=this;if(this._checkLoaded(),Bt(this,e.validateStyle(t)))return!1;(t=e.clone$1(t)).layers=je(t.layers);var n=function(t,r){if(!t)return[{command:Ue.setStyle,args:[r]}];var n=[];try{if(!e.deepEqual(t.version,r.version))return[{command:Ue.setStyle,args:[r]}];e.deepEqual(t.center,r.center)||n.push({command:Ue.setCenter,args:[r.center]}),e.deepEqual(t.zoom,r.zoom)||n.push({command:Ue.setZoom,args:[r.zoom]}),e.deepEqual(t.bearing,r.bearing)||n.push({command:Ue.setBearing,args:[r.bearing]}),e.deepEqual(t.pitch,r.pitch)||n.push({command:Ue.setPitch,args:[r.pitch]}),e.deepEqual(t.sprite,r.sprite)||n.push({command:Ue.setSprite,args:[r.sprite]}),e.deepEqual(t.glyphs,r.glyphs)||n.push({command:Ue.setGlyphs,args:[r.glyphs]}),e.deepEqual(t.transition,r.transition)||n.push({command:Ue.setTransition,args:[r.transition]}),e.deepEqual(t.light,r.light)||n.push({command:Ue.setLight,args:[r.light]});var a={},i=[];!function(t,r,n,a){var i;for(i in r=r||{},t=t||{})t.hasOwnProperty(i)&&(r.hasOwnProperty(i)||Ve(i,n,a));for(i in r)r.hasOwnProperty(i)&&(t.hasOwnProperty(i)?e.deepEqual(t[i],r[i])||("geojson"===t[i].type&&"geojson"===r[i].type&&qe(t,r,i)?n.push({command:Ue.setGeoJSONSourceData,args:[i,r[i].data]}):Ge(i,r,n,a)):He(i,r,n))}(t.sources,r.sources,i,a);var o=[];t.layers&&t.layers.forEach(function(e){a[e.source]?n.push({command:Ue.removeLayer,args:[e.id]}):o.push(e)}),n=n.concat(i),function(t,r,n){r=r||[];var a,i,o,s,l,u,c,f=(t=t||[]).map(We),h=r.map(We),p=t.reduce(Xe,{}),d=r.reduce(Xe,{}),v=f.slice(),m=Object.create(null);for(a=0,i=0;a<f.length;a++)d.hasOwnProperty(o=f[a])?i++:(n.push({command:Ue.removeLayer,args:[o]}),v.splice(v.indexOf(o,i),1));for(a=0,i=0;a<h.length;a++)v[v.length-1-a]!==(o=h[h.length-1-a])&&(p.hasOwnProperty(o)?(n.push({command:Ue.removeLayer,args:[o]}),v.splice(v.lastIndexOf(o,v.length-i),1)):i++,n.push({command:Ue.addLayer,args:[d[o],u=v[v.length-a]]}),v.splice(v.length-a,0,o),m[o]=!0);for(a=0;a<h.length;a++)if(s=p[o=h[a]],l=d[o],!m[o]&&!e.deepEqual(s,l))if(e.deepEqual(s.source,l.source)&&e.deepEqual(s["source-layer"],l["source-layer"])&&e.deepEqual(s.type,l.type)){for(c in Ye(s.layout,l.layout,n,o,null,Ue.setLayoutProperty),Ye(s.paint,l.paint,n,o,null,Ue.setPaintProperty),e.deepEqual(s.filter,l.filter)||n.push({command:Ue.setFilter,args:[o,l.filter]}),e.deepEqual(s.minzoom,l.minzoom)&&e.deepEqual(s.maxzoom,l.maxzoom)||n.push({command:Ue.setLayerZoomRange,args:[o,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ye(s[c],l[c],n,o,c.slice(6),Ue.setPaintProperty):e.deepEqual(s[c],l[c])||n.push({command:Ue.setLayerProperty,args:[o,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ye(s[c],l[c],n,o,c.slice(6),Ue.setPaintProperty):e.deepEqual(s[c],l[c])||n.push({command:Ue.setLayerProperty,args:[o,c,l[c]]}))}else n.push({command:Ue.removeLayer,args:[o]}),u=v[v.lastIndexOf(o)+1],n.push({command:Ue.addLayer,args:[l,u]})}(o,r.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:Ue.setStyle,args:[r]}]}return n}(this.serialize(),t).filter(function(e){return!(e.command in Ut)});if(0===n.length)return!1;var a=n.filter(function(e){return!(e.command in jt)});if(a.length>0)throw new Error("Unimplemented: "+a.map(function(e){return e.command}).join(", ")+".");return n.forEach(function(e){"setTransition"!==e.command&&r[e.command].apply(r,e.args)}),this.stylesheet=t,!0},r.prototype.addImage=function(t,r){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,r),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},r.prototype.updateImage=function(e,t){this.imageManager.updateImage(e,t)},r.prototype.getImage=function(e){return this.imageManager.getImage(e)},r.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},r.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},r.prototype.addSource=function(t,r,n){var a=this;if(void 0===n&&(n={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(e.validateStyle.source,"sources."+t,r,null,n))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var i=this.sourceCaches[t]=new Le(t,r,this.dispatcher);i.style=this,i.setEventedParent(this,function(){return{isSourceLoaded:a.loaded(),source:i.serialize(),sourceId:t}}),i.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+r+'" is using it.')));var n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.clearTiles(),n.onRemove&&n.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(e,t){this._checkLoaded(),this.sourceCaches[e].getSource().setData(t),this._changed=!0},r.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},r.prototype.addLayer=function(t,r,n){void 0===n&&(n={}),this._checkLoaded();var a=t.id;if(this.getLayer(a))this.fire(new e.ErrorEvent(new Error('Layer with id "'+a+'" already exists on this map')));else{var i;if("custom"===t.type){if(Bt(this,e.validateCustomStyleLayer(t)))return;i=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(a,t.source),t=e.clone$1(t),t=e.extend(t,{source:a})),this._validate(e.validateStyle.layer,"layers."+a,t,{arrayIndex:-1},n))return;i=e.createStyleLayer(t),this._validateLayer(i),i.setEventedParent(this,{layer:{id:a}}),this._serializedLayers[i.id]=i.serialize()}var o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(o,0,a),this._layerOrderChanged=!0,this._layers[a]=i,this._removedLayers[a]&&i.source&&"custom"!==i.type){var s=this._removedLayers[a];delete this._removedLayers[a],s.type!==i.type?this._updatedSources[i.source]="clear":(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause())}this._updateLayer(i),i.onAdd&&i.onAdd(this.map)}}},r.prototype.moveLayer=function(t,r){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==r){var n=this._order.indexOf(t);this._order.splice(n,1);var a=r?this._order.indexOf(r):this._order.length;r&&-1===a?this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(a,0,t),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},r.prototype.removeLayer=function(t){this._checkLoaded();var r=this._layers[t];if(r){r.setEventedParent(null);var n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},r.prototype.getLayer=function(e){return this._layers[e]},r.prototype.hasLayer=function(e){return e in this._layers},r.prototype.setLayerZoomRange=function(t,r,n){this._checkLoaded();var a=this.getLayer(t);a?a.minzoom===r&&a.maxzoom===n||(null!=r&&(a.minzoom=r),null!=n&&(a.maxzoom=n),this._updateLayer(a)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},r.prototype.setFilter=function(t,r,n){void 0===n&&(n={}),this._checkLoaded();var a=this.getLayer(t);if(a){if(!e.deepEqual(a.filter,r))return null==r?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(e.validateStyle.filter,"layers."+a.id+".filter",r,null,n)||(a.filter=e.clone$1(r),this._updateLayer(a)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},r.prototype.getFilter=function(t){return e.clone$1(this.getLayer(t).filter)},r.prototype.setLayoutProperty=function(t,r,n,a){void 0===a&&(a={}),this._checkLoaded();var i=this.getLayer(t);i?e.deepEqual(i.getLayoutProperty(r),n)||(i.setLayoutProperty(r,n,a),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getLayoutProperty=function(t,r){var n=this.getLayer(t);if(n)return n.getLayoutProperty(r);this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},r.prototype.setPaintProperty=function(t,r,n,a){void 0===a&&(a={}),this._checkLoaded();var i=this.getLayer(t);i?e.deepEqual(i.getPaintProperty(r),n)||(i.setPaintProperty(r,n,a)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getPaintProperty=function(e,t){return this.getLayer(e).getPaintProperty(t)},r.prototype.setFeatureState=function(t,r){this._checkLoaded();var n=t.source,a=t.sourceLayer,i=this.sourceCaches[n];if(void 0!==i){var o=i.getSource().type;"geojson"===o&&a?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||a?(void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),i.setFeatureState(a,t.id,r)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},r.prototype.removeFeatureState=function(t,r){this._checkLoaded();var n=t.source,a=this.sourceCaches[n];if(void 0!==a){var i=a.getSource().type,o="vector"===i?t.sourceLayer:void 0;"vector"!==i||o?r&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):a.removeFeatureState(o,t.id,r):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},r.prototype.getFeatureState=function(t){this._checkLoaded();var r=t.source,n=t.sourceLayer,a=this.sourceCaches[r];if(void 0!==a){if("vector"!==a.getSource().type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),a.getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},r.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._serializeLayers(this._order)},function(e){return void 0!==e})},r.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},r.prototype._flattenAndSortRenderedFeatures=function(e){for(var t=this,r=function(e){return"fill-extrusion"===t._layers[e].type},n={},a=[],i=this._order.length-1;i>=0;i--){var o=this._order[i];if(r(o)){n[o]=i;for(var s=0,l=e;s<l.length;s+=1){var u=l[s][o];if(u)for(var c=0,f=u;c<f.length;c+=1)a.push(f[c])}}}a.sort(function(e,t){return t.intersectionZ-e.intersectionZ});for(var h=[],p=this._order.length-1;p>=0;p--){var d=this._order[p];if(r(d))for(var v=a.length-1;v>=0;v--){var m=a[v].feature;if(n[m.layer.id]<p)break;h.push(m),a.pop()}else for(var g=0,y=e;g<y.length;g+=1){var x=y[g][d];if(x)for(var _=0,b=x;_<b.length;_+=1)h.push(b[_].feature)}}return h},r.prototype.queryRenderedFeatures=function(t,r,n){r&&r.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);var a={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var i=0,o=r.layers;i<o.length;i+=1){var s=o[i],l=this._layers[s];if(!l)return this.fire(new e.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];a[l.source]=!0}}var u=[];for(var c in r.availableImages=this._availableImages,this.sourceCaches)r.layers&&!a[c]||u.push(N(this.sourceCaches[c],this._layers,this._serializedLayers,t,r,n));return this.placement&&u.push(function(e,t,r,n,a,i,o){for(var s={},l=i.queryRenderedSymbols(n),u=[],c=0,f=Object.keys(l).map(Number);c<f.length;c+=1)u.push(o[f[c]]);u.sort(F);for(var h=function(){var r=d[p],n=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,a.filter,a.layers,a.availableImages,e);for(var i in n){var o=s[i]=s[i]||[],u=n[i];u.sort(function(e,t){var n=r.featureSortOrder;if(n){var a=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-a}return t.featureIndex-e.featureIndex});for(var c=0,f=u;c<f.length;c+=1)o.push(f[c])}},p=0,d=u;p<d.length;p+=1)h();var v=function(t){s[t].forEach(function(n){var a=n.feature,i=r[e[t].source].getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=i})};for(var m in s)v(m);return s}(this._layers,this._serializedLayers,this.sourceCaches,t,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)},r.prototype.querySourceFeatures=function(t,r){r&&r.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r);var n=this.sourceCaches[t];return n?function(e,t){for(var r=e.getRenderableIds().map(function(t){return e.getTileByID(t)}),n=[],a={},i=0;i<r.length;i++){var o=r[i],s=o.tileID.canonical.key;a[s]||(a[s]=!0,o.querySourceFeatures(n,t))}return n}(n,r):[]},r.prototype.addSourceType=function(e,t,n){return r.getSourceType(e)?n(new Error('A source type called "'+e+'" already exists.')):(r.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},n):n(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(t,r){void 0===r&&(r={}),this._checkLoaded();var n=this.light.getLight(),a=!1;for(var i in t)if(!e.deepEqual(t[i],n[i])){a=!0;break}if(a){var o={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(o)}},r.prototype._validate=function(t,r,n,a,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&Bt(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:n,styleSpec:e.styleSpec},a)))},r.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var r in this.sourceCaches)this.sourceCaches[r].clearTiles(),this.sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},r.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},r.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},r.prototype._updateSources=function(e){for(var t in this.sourceCaches)this.sourceCaches[t].update(e)},r.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},r.prototype._updatePlacement=function(t,r,n,a,i){void 0===i&&(i=!1);for(var o=!1,s=!1,l={},u=0,c=this._order;u<c.length;u+=1){var f=this._layers[c[u]];if("symbol"===f.type){if(!l[f.source]){var h=this.sourceCaches[f.source];l[f.source]=h.getRenderableIds(!0).map(function(e){return h.getTileByID(e)}).sort(function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)})}var p=this.crossTileSymbolIndex.addLayer(f,l[f.source],t.center.lng);o=o||p}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),t.zoom))&&(this.pauseablePlacement=new Pt(t,this._order,i,r,n,a,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(var d=0,v=this._order;d<v.length;d+=1){var m=this._layers[v[d]];"symbol"===m.type&&this.placement.updateLayerOpacities(m,l[m.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},r.prototype._releaseSymbolFadeTiles=function(){for(var e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()},r.prototype.getImages=function(e,t,r){this.imageManager.getImages(t.icons,r),this._updateTilesForChangedImages();var n=this.sourceCaches[t.source];n&&n.setDependencies(t.tileID.key,t.type,t.icons)},r.prototype.getGlyphs=function(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)},r.prototype.getResource=function(t,r,n){return e.makeRequest(r,n)},r}(e.Evented);Vt.getSourceType=function(e){return R[e]},Vt.setSourceType=function(e,t){R[e]=t},Vt.registerForPluginStateChange=e.registerForPluginStateChange;var Gt=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),qt=gr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Yt=gr("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Wt=gr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Xt=gr("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Zt=gr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Kt=gr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Jt=gr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qt=gr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),$t=gr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),er=gr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),tr=gr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),rr=gr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),nr=gr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ar=gr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),ir=gr("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),or=gr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),sr=gr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),lr=gr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ur=gr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),cr=gr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),fr=gr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),hr=gr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pr=gr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),dr=gr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),vr=gr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),mr=gr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function gr(e,t){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n={};return{fragmentSource:e=e.replace(r,function(e,t,r,a,i){return n[i]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+i+"\nvarying "+r+" "+a+" "+i+";\n#else\nuniform "+r+" "+a+" u_"+i+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+i+"\n    "+r+" "+a+" "+i+" = u_"+i+";\n#endif\n"}),vertexSource:t=t.replace(r,function(e,t,r,a,i){var o="float"===a?"vec2":"vec4",s=i.match(/color/)?"color":o;return n[i]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float u_"+i+"_t;\nattribute "+r+" "+o+" a_"+i+";\nvarying "+r+" "+a+" "+i+";\n#else\nuniform "+r+" "+a+" u_"+i+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = a_"+i+";\n#else\n    "+r+" "+a+" "+i+" = u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = unpack_mix_"+s+"(a_"+i+", u_"+i+"_t);\n#else\n    "+r+" "+a+" "+i+" = u_"+i+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float u_"+i+"_t;\nattribute "+r+" "+o+" a_"+i+";\n#else\nuniform "+r+" "+a+" u_"+i+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+r+" "+a+" "+i+" = a_"+i+";\n#else\n    "+r+" "+a+" "+i+" = u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+r+" "+a+" "+i+" = unpack_mix_"+s+"(a_"+i+", u_"+i+"_t);\n#else\n    "+r+" "+a+" "+i+" = u_"+i+";\n#endif\n"})}}var yr=Object.freeze({__proto__:null,prelude:qt,background:Yt,backgroundPattern:Wt,circle:Xt,clippingMask:Zt,heatmap:Kt,heatmapTexture:Jt,collisionBox:Qt,collisionCircle:$t,debug:er,fill:tr,fillOutline:rr,fillOutlinePattern:nr,fillPattern:ar,fillExtrusion:ir,fillExtrusionPattern:or,hillshadePrepare:sr,hillshade:lr,line:ur,lineGradient:cr,linePattern:fr,lineSDF:hr,raster:pr,symbolIcon:dr,symbolSDF:vr,symbolTextAndIcon:mr}),xr=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};xr.prototype.bind=function(e,t,r,n,a,i,o,s){this.context=e;for(var l=this.boundPaintVertexBuffers.length!==n.length,u=0;!l&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(l=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===r&&!l&&this.boundIndexBuffer===a&&this.boundVertexOffset===i&&this.boundDynamicVertexBuffer===o&&this.boundDynamicVertexBuffer2===s?(e.bindVertexArrayOES.set(this.vao),o&&o.bind(),a&&a.dynamicDraw&&a.bind(),s&&s.bind()):this.freshBind(t,r,n,a,i,o,s)},xr.prototype.freshBind=function(e,t,r,n,a,i,o){var s,l=e.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=i,this.boundDynamicVertexBuffer2=o;else{s=u.currentNumAttributes||0;for(var f=l;f<s;f++)c.disableVertexAttribArray(f)}t.enableAttributes(c,e);for(var h=0,p=r;h<p.length;h+=1)p[h].enableAttributes(c,e);i&&i.enableAttributes(c,e),o&&o.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,a);for(var d=0,v=r;d<v.length;d+=1){var m=v[d];m.bind(),m.setVertexAttribPointers(c,e,a)}i&&(i.bind(),i.setVertexAttribPointers(c,e,a)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(c,e,a)),u.currentNumAttributes=l},xr.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var _r=function(e,t,r,n,a){var i=e.gl;this.program=i.createProgram();var o=r?r.defines():[];a&&o.push("#define OVERDRAW_INSPECTOR;");var s=o.concat(qt.fragmentSource,t.fragmentSource).join("\n"),l=o.concat(qt.vertexSource,t.vertexSource).join("\n"),u=i.createShader(i.FRAGMENT_SHADER);if(i.isContextLost())this.failedToCreate=!0;else{i.shaderSource(u,s),i.compileShader(u),i.attachShader(this.program,u);var c=i.createShader(i.VERTEX_SHADER);if(i.isContextLost())this.failedToCreate=!0;else{i.shaderSource(c,l),i.compileShader(c),i.attachShader(this.program,c);for(var f=r?r.layoutAttributes:[],h=0;h<f.length;h++)i.bindAttribLocation(this.program,h,f[h].name);i.linkProgram(this.program),i.deleteShader(c),i.deleteShader(u),this.numAttributes=i.getProgramParameter(this.program,i.ACTIVE_ATTRIBUTES),this.attributes={};for(var p={},d=0;d<this.numAttributes;d++){var v=i.getActiveAttrib(this.program,d);v&&(this.attributes[v.name]=i.getAttribLocation(this.program,v.name))}for(var m=i.getProgramParameter(this.program,i.ACTIVE_UNIFORMS),g=0;g<m;g++){var y=i.getActiveUniform(this.program,g);y&&(p[y.name]=i.getUniformLocation(this.program,y.name))}this.fixedUniforms=n(e,p),this.binderUniforms=r?r.getUniforms(e,p):[]}}};function br(e,t,r){var n=1/ht(r,1,t.transform.tileZoom),a=Math.pow(2,r.tileID.overscaledZ),i=r.tileSize*Math.pow(2,t.transform.tileZoom)/a,o=i*(r.tileID.canonical.x+r.tileID.wrap*a),s=i*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}_r.prototype.draw=function(e,t,r,n,a,i,o,s,l,u,c,f,h,p,d,v){var m,g=e.gl;if(!this.failedToCreate){for(var y in e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(a),e.setCullFace(i),this.fixedUniforms)this.fixedUniforms[y].set(o[y]);p&&p.setUniforms(e,this.binderUniforms,f,{zoom:h});for(var x=(m={},m[g.LINES]=2,m[g.TRIANGLES]=3,m[g.LINE_STRIP]=1,m)[t],_=0,b=c.get();_<b.length;_+=1){var w=b[_],T=w.vaos||(w.vaos={});(T[s]||(T[s]=new xr)).bind(e,this,l,p?p.getPaintVertexBuffers():[],u,w.vertexOffset,d,v),g.drawElements(t,w.primitiveLength*x,g.UNSIGNED_SHORT,w.primitiveOffset*x*2)}}};var wr=function(t,r,n,a){var i=r.style.light,o=i.properties.get("position"),s=[o.x,o.y,o.z],l=e.create$1();"viewport"===i.properties.get("anchor")&&e.fromRotation(l,-r.transform.angle),e.transformMat3(s,s,l);var u=i.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+n,u_opacity:a}},Tr=function(t,r,n,a,i,o,s){return e.extend(wr(t,r,n,a),br(o,r,s),{u_height_factor:-Math.pow(2,i.overscaledZ)/s.tileSize/8})},kr=function(e){return{u_matrix:e}},Ar=function(t,r,n,a){return e.extend(kr(t),br(n,r,a))},Mr=function(e,t){return{u_matrix:e,u_world:t}},Er=function(t,r,n,a,i){return e.extend(Ar(t,r,n,a),{u_world:i})},Sr=function(t,r,n,a){var i,o,s=t.transform;if("map"===a.paint.get("circle-pitch-alignment")){var l=ht(n,1,s.zoom);i=!0,o=[l,l]}else i=!1,o=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===a.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(r.posMatrix,n,a.paint.get("circle-translate"),a.paint.get("circle-translate-anchor")),u_pitch_with_map:+i,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:o}},Cr=function(e,t,r){var n=ht(r,1,t.zoom),a=Math.pow(2,t.zoom-r.tileID.overscaledZ),i=r.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[t.pixelsToGLUnits[0]/(n*a),t.pixelsToGLUnits[1]/(n*a)],u_overscale_factor:i}},Lr=function(e,t,r){return{u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}},Ir=function(e,t,r){return void 0===r&&(r=1),{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}},Or=function(e){return{u_matrix:e}},Pr=function(e,t,r,n){return{u_matrix:e,u_extrude_scale:ht(t,1,r),u_intensity:n}},Dr=function(t,r,n){var a=t.transform;return{u_matrix:Br(t,r,n),u_ratio:1/ht(r,1,a.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Rr=function(t,r,n){return e.extend(Dr(t,r,n),{u_image:0})},zr=function(t,r,n,a){var i=t.transform,o=Fr(r,i);return{u_matrix:Br(t,r,n),u_texsize:r.imageAtlasTexture.size,u_ratio:1/ht(r,1,i.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[o,a.fromScale,a.toScale],u_fade:a.t,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Nr=function(t,r,n,a,i){var o=t.lineAtlas,s=Fr(r,t.transform),l="round"===n.layout.get("line-cap"),u=o.getDash(a.from,l),c=o.getDash(a.to,l),f=u.width*i.fromScale,h=c.width*i.toScale;return e.extend(Dr(t,r,n),{u_patternscale_a:[s/f,-u.height/2],u_patternscale_b:[s/h,-c.height/2],u_sdfgamma:o.width/(256*Math.min(f,h)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:c.y,u_mix:i.t})};function Fr(e,t){return 1/ht(e,1,t.tileZoom)}function Br(e,t,r){return e.translatePosMatrix(t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}var jr=function(e,t,r,n,a){return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*a.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:a.paint.get("raster-brightness-min"),u_brightness_high:a.paint.get("raster-brightness-max"),u_saturation_factor:(o=a.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(i=a.paint.get("raster-contrast"),i>0?1/(1-i):1+i),u_spin_weights:Ur(a.paint.get("raster-hue-rotate"))};var i,o};function Ur(e){e*=Math.PI/180;var t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}var Hr,Vr=function(e,t,r,n,a,i,o,s,l,u){var c=a.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:i,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+n,u_texsize:u,u_texture:0}},Gr=function(t,r,n,a,i,o,s,l,u,c,f){var h=i.transform;return e.extend(Vr(t,r,n,a,i,o,s,l,u,c),{u_gamma_scale:a?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+f})},qr=function(t,r,n,a,i,o,s,l,u,c){return e.extend(Gr(t,r,n,a,i,o,s,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1})},Yr=function(e,t,r){return{u_matrix:e,u_opacity:t,u_color:r}},Wr=function(t,r,n,a,i,o){return e.extend(function(e,t,r,n){var a=r.imageManager.getPattern(e.from.toString()),i=r.imageManager.getPattern(e.to.toString()),o=r.imageManager.getPixelSize(),s=o.width,l=o.height,u=Math.pow(2,n.tileID.overscaledZ),c=n.tileSize*Math.pow(2,r.transform.tileZoom)/u,f=c*(n.tileID.canonical.x+n.tileID.wrap*u),h=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:i.tl,u_pattern_br_b:i.br,u_texsize:[s,l],u_mix:t.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:i.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/ht(n,1,r.transform.tileZoom),u_pixel_coord_upper:[f>>16,h>>16],u_pixel_coord_lower:[65535&f,65535&h]}}(a,o,n,i),{u_matrix:t,u_opacity:r})},Xr={fillExtrusion:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fillExtrusionPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,r.u_height_factor),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fill:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},fillPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},fillOutline:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world)}},fillOutlinePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},circle:function(t,r){return{u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(t,r.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},collisionBox:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(t,r.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_overscale_factor:new e.Uniform1f(t,r.u_overscale_factor)}},collisionCircle:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,r.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,r.u_viewport_size)}},debug:function(t,r){return{u_color:new e.UniformColor(t,r.u_color),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_overlay:new e.Uniform1i(t,r.u_overlay),u_overlay_scale:new e.Uniform1f(t,r.u_overlay_scale)}},clippingMask:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmap:function(t,r){return{u_extrude_scale:new e.Uniform1f(t,r.u_extrude_scale),u_intensity:new e.Uniform1f(t,r.u_intensity),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmapTexture:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_opacity:new e.Uniform1f(t,r.u_opacity)}},hillshade:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_latrange:new e.Uniform2f(t,r.u_latrange),u_light:new e.Uniform2f(t,r.u_light),u_shadow:new e.UniformColor(t,r.u_shadow),u_highlight:new e.UniformColor(t,r.u_highlight),u_accent:new e.UniformColor(t,r.u_accent)}},hillshadePrepare:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_dimension:new e.Uniform2f(t,r.u_dimension),u_zoom:new e.Uniform1f(t,r.u_zoom),u_maxzoom:new e.Uniform1f(t,r.u_maxzoom),u_unpack:new e.Uniform4f(t,r.u_unpack)}},line:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels)}},lineGradient:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image)}},linePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_image:new e.Uniform1i(t,r.u_image),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},lineSDF:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(t,r.u_patternscale_a),u_patternscale_b:new e.Uniform2f(t,r.u_patternscale_b),u_sdfgamma:new e.Uniform1f(t,r.u_sdfgamma),u_image:new e.Uniform1i(t,r.u_image),u_tex_y_a:new e.Uniform1f(t,r.u_tex_y_a),u_tex_y_b:new e.Uniform1f(t,r.u_tex_y_b),u_mix:new e.Uniform1f(t,r.u_mix)}},raster:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_tl_parent:new e.Uniform2f(t,r.u_tl_parent),u_scale_parent:new e.Uniform1f(t,r.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,r.u_buffer_scale),u_fade_t:new e.Uniform1f(t,r.u_fade_t),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image0:new e.Uniform1i(t,r.u_image0),u_image1:new e.Uniform1i(t,r.u_image1),u_brightness_low:new e.Uniform1f(t,r.u_brightness_low),u_brightness_high:new e.Uniform1f(t,r.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,r.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,r.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,r.u_spin_weights)}},symbolIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture)}},symbolSDF:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},symbolTextAndIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texsize_icon:new e.Uniform2f(t,r.u_texsize_icon),u_texture:new e.Uniform1i(t,r.u_texture),u_texture_icon:new e.Uniform1i(t,r.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},background:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_color:new e.UniformColor(t,r.u_color)}},backgroundPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image:new e.Uniform1i(t,r.u_image),u_pattern_tl_a:new e.Uniform2f(t,r.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,r.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,r.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,r.u_pattern_br_b),u_texsize:new e.Uniform2f(t,r.u_texsize),u_mix:new e.Uniform1f(t,r.u_mix),u_pattern_size_a:new e.Uniform2f(t,r.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,r.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,r.u_scale_a),u_scale_b:new e.Uniform1f(t,r.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,r.u_tile_units_to_pixels)}}};function Zr(t,r,n,a,i,o,s){for(var l=t.context,u=l.gl,c=t.useProgram("collisionBox"),f=[],h=0,p=0,d=0;d<a.length;d++){var v=a[d],m=r.getTile(v),g=m.getBucket(n);if(g){var y=v.posMatrix;0===i[0]&&0===i[1]||(y=t.translatePosMatrix(v.posMatrix,m,i,o));var x=s?g.textCollisionBox:g.iconCollisionBox,_=g.collisionCircleArray;if(_.length>0){var b=e.create(),w=y;e.mul(b,g.placementInvProjMatrix,t.transform.glCoordMatrix),e.mul(b,b,g.placementViewportMatrix),f.push({circleArray:_,circleOffset:p,transform:w,invTransform:b}),p=h+=_.length/4}x&&c.draw(l,u.LINES,Ae.disabled,Me.disabled,t.colorModeForRenderPass(),Se.disabled,Cr(y,t.transform,m),n.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,null,t.transform.zoom,null,null,x.collisionVertexBuffer)}}if(s&&f.length){var T=t.useProgram("collisionCircle"),k=new e.StructArrayLayout2f1f2i16;k.resize(4*h),k._trim();for(var A=0,M=0,E=f;M<E.length;M+=1)for(var S=E[M],C=0;C<S.circleArray.length/4;C++){var L=4*C,I=S.circleArray[L+0],O=S.circleArray[L+1],P=S.circleArray[L+2],D=S.circleArray[L+3];k.emplace(A++,I,O,P,D,0),k.emplace(A++,I,O,P,D,1),k.emplace(A++,I,O,P,D,2),k.emplace(A++,I,O,P,D,3)}(!Hr||Hr.length<2*h)&&(Hr=function(t){var r=2*t,n=new e.StructArrayLayout3ui6;n.resize(r),n._trim();for(var a=0;a<r;a++){var i=6*a;n.uint16[i+0]=4*a+0,n.uint16[i+1]=4*a+1,n.uint16[i+2]=4*a+2,n.uint16[i+3]=4*a+2,n.uint16[i+4]=4*a+3,n.uint16[i+5]=4*a+0}return n}(h));for(var R=l.createIndexBuffer(Hr,!0),z=l.createVertexBuffer(k,e.collisionCircleLayout.members,!0),N=0,F=f;N<F.length;N+=1){var B=F[N],j=Lr(B.transform,B.invTransform,t.transform);T.draw(l,u.TRIANGLES,Ae.disabled,Me.disabled,t.colorModeForRenderPass(),Se.disabled,j,n.id,z,R,e.SegmentVector.simpleSegment(0,2*B.circleOffset,B.circleArray.length,B.circleArray.length/2),null,t.transform.zoom,null,null,null)}z.destroy(),R.destroy()}}var Kr=e.identity(new Float32Array(16));function Jr(t,r,n,a,i,o){var s=e.getAnchorAlignment(t),l=-(s.horizontalAlign-.5)*r,u=-(s.verticalAlign-.5)*n,c=e.evaluateVariableOffset(t,a);return new e.Point((l/i+c[0])*o,(u/i+c[1])*o)}function Qr(t,r,n,a,i,o,s,l,u,c,f){var h=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,d=t.icon.dynamicLayoutVertexArray,v={};p.clear();for(var m=0;m<h.length;m++){var g=h.get(m),y=g.hidden||!g.crossTileID||t.allowVerticalPlacement&&!g.placedOrientation?null:a[g.crossTileID];if(y){var x=new e.Point(g.anchorX,g.anchorY),_=$e(x,n?l:s),b=et(o.cameraToCenterDistance,_.signedDistanceFromCamera),w=i.evaluateSizeForFeature(t.textSizeData,c,g)*b/e.ONE_EM;n&&(w*=t.tilePixelRatio/u);for(var T=Jr(y.anchor,y.width,y.height,y.textOffset,y.textBoxScale,w),k=n?$e(x.add(T),s).point:_.point.add(r?T.rotate(-o.angle):T),A=t.allowVerticalPlacement&&g.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,M=0;M<g.numGlyphs;M++)e.addDynamicAttributes(p,k,A);f&&g.associatedIconIndex>=0&&(v[g.associatedIconIndex]={shiftedAnchor:k,angle:A})}else ut(g.numGlyphs,p)}if(f){d.clear();for(var E=t.icon.placedSymbolArray,S=0;S<E.length;S++){var C=E.get(S);if(C.hidden)ut(C.numGlyphs,d);else{var L=v[S];if(L)for(var I=0;I<C.numGlyphs;I++)e.addDynamicAttributes(d,L.shiftedAnchor,L.angle);else ut(C.numGlyphs,d)}}t.icon.dynamicLayoutVertexBuffer.updateData(d)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function $r(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function en(t,r,n,a,i,o,s,l,u,c,f,h){for(var p=t.context,d=p.gl,v=t.transform,m="map"===l,g="map"===u,y=m&&"point"!==n.layout.get("symbol-placement"),x=m&&!g&&!y,_=void 0!==n.layout.get("symbol-sort-key").constantOr(1),b=t.depthModeForSublayer(0,Ae.ReadOnly),w=n.layout.get("text-variable-anchor"),T=[],k=0,A=a;k<A.length;k+=1){var M=A[k],E=r.getTile(M),S=E.getBucket(n);if(S){var C=i?S.text:S.icon;if(C&&C.segments.get().length){var L=C.programConfigurations.get(n.id),I=i||S.sdfIcons,O=i?S.textSizeData:S.iconSizeData,P=g||0!==v.pitch,D=t.useProgram($r(I,i,S),L),R=e.evaluateSizeForZoom(O,v.zoom),z=void 0,N=[0,0],F=void 0,B=void 0,j=null,U=void 0;if(i)F=E.glyphAtlasTexture,B=d.LINEAR,z=E.glyphAtlasTexture.size,S.iconsInText&&(N=E.imageAtlasTexture.size,j=E.imageAtlasTexture,U=P||t.options.rotating||t.options.zooming||"composite"===O.kind||"camera"===O.kind?d.LINEAR:d.NEAREST);else{var H=1!==n.layout.get("icon-size").constantOr(0)||S.iconsNeedLinear;F=E.imageAtlasTexture,B=I||t.options.rotating||t.options.zooming||H||P?d.LINEAR:d.NEAREST,z=E.imageAtlasTexture.size}var V=ht(E,1,t.transform.zoom),G=Je(M.posMatrix,g,m,t.transform,V),q=Qe(M.posMatrix,g,m,t.transform,V),Y=w&&S.hasTextData(),W="none"!==n.layout.get("icon-text-fit")&&Y&&S.hasIconData();y&&rt(S,M.posMatrix,t,i,G,q,g,c);var X=t.translatePosMatrix(M.posMatrix,E,o,s),Z=y||i&&w||W?Kr:G,K=t.translatePosMatrix(q,E,o,s,!0),J=I&&0!==n.paint.get(i?"text-halo-width":"icon-halo-width").constantOr(1),Q={program:D,buffers:C,uniformValues:I?S.iconsInText?qr(O.kind,R,x,g,t,X,Z,K,z,N):Gr(O.kind,R,x,g,t,X,Z,K,i,z,!0):Vr(O.kind,R,x,g,t,X,Z,K,i,z),atlasTexture:F,atlasTextureIcon:j,atlasInterpolation:B,atlasInterpolationIcon:U,isSDF:I,hasHalo:J};if(_)for(var $=0,ee=C.segments.get();$<ee.length;$+=1){var te=ee[$];T.push({segments:new e.SegmentVector([te]),sortKey:te.sortKey,state:Q})}else T.push({segments:C.segments,sortKey:0,state:Q})}}}_&&T.sort(function(e,t){return e.sortKey-t.sortKey});for(var re=0,ne=T;re<ne.length;re+=1){var ae=ne[re],ie=ae.state;if(p.activeTexture.set(d.TEXTURE0),ie.atlasTexture.bind(ie.atlasInterpolation,d.CLAMP_TO_EDGE),ie.atlasTextureIcon&&(p.activeTexture.set(d.TEXTURE1),ie.atlasTextureIcon&&ie.atlasTextureIcon.bind(ie.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),ie.isSDF){var oe=ie.uniformValues;ie.hasHalo&&(oe.u_is_halo=1,tn(ie.buffers,ae.segments,n,t,ie.program,b,f,h,oe)),oe.u_is_halo=0}tn(ie.buffers,ae.segments,n,t,ie.program,b,f,h,ie.uniformValues)}}function tn(e,t,r,n,a,i,o,s,l){var u=n.context;a.draw(u,u.gl.TRIANGLES,i,o,s,Se.disabled,l,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function rn(e,t,r,n,a,i,o){var s,l,u,c,f,h=e.context.gl,p=r.paint.get("fill-pattern"),d=p&&p.constantOr(1),v=r.getCrossfadeParameters();o?(l=d&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=h.LINES):(l=d?"fillPattern":"fill",s=h.TRIANGLES);for(var m=0,g=n;m<g.length;m+=1){var y=g[m],x=t.getTile(y);if(!d||x.patternsLoaded()){var _=x.getBucket(r);if(_){var b=_.programConfigurations.get(r.id),w=e.useProgram(l,b);d&&(e.context.activeTexture.set(h.TEXTURE0),x.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),b.updatePaintBuffers(v));var T=p.constantOr(null);if(T&&x.imageAtlas){var k=x.imageAtlas,A=k.patternPositions[T.to.toString()],M=k.patternPositions[T.from.toString()];A&&M&&b.setConstantPatternPositions(A,M)}var E=e.translatePosMatrix(y.posMatrix,x,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(o){c=_.indexBuffer2,f=_.segments2;var S=[h.drawingBufferWidth,h.drawingBufferHeight];u="fillOutlinePattern"===l&&d?Er(E,e,v,x,S):Mr(E,S)}else c=_.indexBuffer,f=_.segments,u=d?Ar(E,e,v,x):kr(E);w.draw(e.context,s,a,e.stencilModeForClipping(y),i,Se.disabled,u,r.id,_.layoutVertexBuffer,c,f,r.paint,e.transform.zoom,b)}}}}function nn(e,t,r,n,a,i,o){for(var s=e.context,l=s.gl,u=r.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),f=r.getCrossfadeParameters(),h=r.paint.get("fill-extrusion-opacity"),p=0,d=n;p<d.length;p+=1){var v=d[p],m=t.getTile(v),g=m.getBucket(r);if(g){var y=g.programConfigurations.get(r.id),x=e.useProgram(c?"fillExtrusionPattern":"fillExtrusion",y);c&&(e.context.activeTexture.set(l.TEXTURE0),m.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(f));var _=u.constantOr(null);if(_&&m.imageAtlas){var b=m.imageAtlas,w=b.patternPositions[_.to.toString()],T=b.patternPositions[_.from.toString()];w&&T&&y.setConstantPatternPositions(w,T)}var k=e.translatePosMatrix(v.posMatrix,m,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),A=r.paint.get("fill-extrusion-vertical-gradient"),M=c?Tr(k,e,A,h,v,f,m):wr(k,e,A,h);x.draw(s,s.gl.TRIANGLES,a,i,o,Se.backCCW,M,r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,r.paint,e.transform.zoom,y)}}}function an(t,r,n,a,i,o){var s=t.context,l=s.gl,u=r.fbo;if(u){var c=t.useProgram("hillshade");s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get());var f=function(t,r,n){var a=n.paint.get("hillshade-shadow-color"),i=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color"),s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);var l,u,c,f=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(r.tileID.toUnwrapped(),f),u_image:0,u_latrange:(l=r.tileID,u=Math.pow(2,l.canonical.z),c=l.canonical.y,[new e.MercatorCoordinate(0,c/u).toLngLat().lat,new e.MercatorCoordinate(0,(c+1)/u).toLngLat().lat]),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:a,u_highlight:i,u_accent:o}}(t,r,n);c.draw(s,l.TRIANGLES,a,i,o,Se.disabled,f,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function on(t,r,n,a,i,o,s){var l=t.context,u=l.gl,c=r.dem;if(c&&c.data){var f=c.dim,h=c.stride,p=c.getPixels();if(l.activeTexture.set(u.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(h),r.demTexture){var d=r.demTexture;d.update(p,{premultiply:!1}),d.bind(u.NEAREST,u.CLAMP_TO_EDGE)}else r.demTexture=new e.Texture(l,p,u.RGBA,{premultiply:!1}),r.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);l.activeTexture.set(u.TEXTURE0);var v=r.fbo;if(!v){var m=new e.Texture(l,{width:f,height:f,data:null},u.RGBA);m.bind(u.LINEAR,u.CLAMP_TO_EDGE),(v=r.fbo=l.createFramebuffer(f,f,!0)).colorAttachment.set(m.texture)}l.bindFramebuffer.set(v.framebuffer),l.viewport.set([0,0,f,f]),t.useProgram("hillshadePrepare").draw(l,u.TRIANGLES,i,o,s,Se.disabled,function(t,r,n){var a=r.stride,i=e.create();return e.ortho(i,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(i,i,[0,-e.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[a,a],u_zoom:t.overscaledZ,u_maxzoom:n,u_unpack:r.getUnpackVector()}}(r.tileID,c,a),n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function sn(t,r,n,a,i){var o=a.paint.get("raster-fade-duration");if(o>0){var s=e.browser.now(),l=(s-t.timeAdded)/o,u=r?(s-r.timeAdded)/o:-1,c=n.getSource(),f=i.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-f)>Math.abs(t.tileID.overscaledZ-f),p=h&&t.refreshedUponExpiration?1:e.clamp(h?l:1-u,0,1);return t.refreshedUponExpiration&&l>=1&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}var ln=new e.Color(1,0,0,1),un=new e.Color(0,1,0,1),cn=new e.Color(0,0,1,1),fn=new e.Color(1,0,1,1),hn=new e.Color(0,1,1,1);function pn(e,t,r,n){vn(e,0,t+r/2,e.transform.width,r,n)}function dn(e,t,r,n){vn(e,t-r/2,0,r,e.transform.height,n)}function vn(t,r,n,a,i,o){var s=t.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(r*e.browser.devicePixelRatio,n*e.browser.devicePixelRatio,a*e.browser.devicePixelRatio,i*e.browser.devicePixelRatio),s.clear({color:o}),l.disable(l.SCISSOR_TEST)}function mn(t,r,n){var a=t.context,i=a.gl,o=n.posMatrix,s=t.useProgram("debug"),l=Ae.disabled,u=Me.disabled,c=t.colorModeForRenderPass();a.activeTexture.set(i.TEXTURE0),t.emptyTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),s.draw(a,i.LINE_STRIP,l,u,c,Se.disabled,Ir(o,e.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var f=r.getTileByID(n.key).latestRawTileData,h=Math.floor((f&&f.byteLength||0)/1024),p=r.getTile(n).tileSize,d=512/Math.min(p,512)*(n.overscaledZ/t.transform.zoom)*.5,v=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(v+=" => "+n.overscaledZ),function(e,t){e.initDebugOverlayCanvas();var r=e.debugOverlayCanvas,n=e.context.gl,a=e.debugOverlayCanvas.getContext("2d");a.clearRect(0,0,r.width,r.height),a.shadowColor="white",a.shadowBlur=2,a.lineWidth=1.5,a.strokeStyle="white",a.textBaseline="top",a.font="bold 36px Open Sans, sans-serif",a.fillText(t,5,5),a.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,v+" "+h+"kb"),s.draw(a,i.TRIANGLES,l,u,Ee.alphaBlended,Se.disabled,Ir(o,e.Color.transparent,d),"$debug",t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}var gn={symbol:function(t,r,n,a,i){if("translucent"===t.renderPass){var o=Me.disabled,s=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,r,n,a,i,o,s){for(var l=r.transform,u="map"===i,c="map"===o,f=0,h=t;f<h.length;f+=1){var p=h[f],d=a.getTile(p),v=d.getBucket(n);if(v&&v.text&&v.text.segments.get().length){var m=e.evaluateSizeForZoom(v.textSizeData,l.zoom),g=ht(d,1,r.transform.zoom),y=Je(p.posMatrix,c,u,r.transform,g),x="none"!==n.layout.get("icon-text-fit")&&v.hasIconData();if(m){var _=Math.pow(2,l.zoom-d.tileID.overscaledZ);Qr(v,u,c,s,e.symbolSize,l,y,p.posMatrix,_,m,x)}}}}(a,t,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),i),0!==n.paint.get("icon-opacity").constantOr(1)&&en(t,r,n,a,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),o,s),0!==n.paint.get("text-opacity").constantOr(1)&&en(t,r,n,a,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),o,s),r.map.showCollisionBoxes&&(Zr(t,r,n,a,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Zr(t,r,n,a,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(t,r,n,a){if("translucent"===t.renderPass){var i=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),l=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0!==i.constantOr(1)||0!==o.constantOr(1)&&0!==s.constantOr(1)){for(var u=t.context,c=u.gl,f=t.depthModeForSublayer(0,Ae.ReadOnly),h=Me.disabled,p=t.colorModeForRenderPass(),d=[],v=0;v<a.length;v++){var m=a[v],g=r.getTile(m),y=g.getBucket(n);if(y){var x=y.programConfigurations.get(n.id),_={programConfiguration:x,program:t.useProgram("circle",x),layoutVertexBuffer:y.layoutVertexBuffer,indexBuffer:y.indexBuffer,uniformValues:Sr(t,m,g,n)};if(l)for(var b=0,w=y.segments.get();b<w.length;b+=1){var T=w[b];d.push({segments:new e.SegmentVector([T]),sortKey:T.sortKey,state:_})}else d.push({segments:y.segments,sortKey:0,state:_})}}l&&d.sort(function(e,t){return e.sortKey-t.sortKey});for(var k=0,A=d;k<A.length;k+=1){var M=A[k],E=M.state;E.program.draw(u,c.TRIANGLES,f,h,p,Se.disabled,E.uniformValues,n.id,E.layoutVertexBuffer,E.indexBuffer,M.segments,n.paint,t.transform.zoom,E.programConfiguration)}}}},heatmap:function(t,r,n,a){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var i=t.context,o=i.gl,s=Me.disabled,l=new Ee([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,r){var n=e.gl;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var a=r.heatmapFbo;if(a)n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer);else{var i=n.createTexture();n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),a=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1),function(e,t,r,n){var a=e.gl;a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t.width/4,t.height/4,0,a.RGBA,e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),n.colorAttachment.set(r)}(e,t,i,a)}}(i,t,n),i.clear({color:e.Color.transparent});for(var u=0;u<a.length;u++){var c=a[u];if(!r.hasRenderableParent(c)){var f=r.getTile(c),h=f.getBucket(n);if(h){var p=h.programConfigurations.get(n.id);t.useProgram("heatmap",p).draw(i,o.TRIANGLES,Ae.disabled,s,l,Se.disabled,Pr(c.posMatrix,f,t.transform.zoom,n.paint.get("heatmap-intensity")),n.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,n.paint,t.transform.zoom,p)}}}i.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){var n=t.context,a=n.gl,i=r.heatmapFbo;if(i){n.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i.colorAttachment.get()),n.activeTexture.set(a.TEXTURE1);var o=r.colorRampTexture;o||(o=r.colorRampTexture=new e.Texture(n,r.colorRamp,a.RGBA)),o.bind(a.LINEAR,a.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,a.TRIANGLES,Ae.disabled,Me.disabled,t.colorModeForRenderPass(),Se.disabled,function(t,r,n,a){var i=e.create();e.ortho(i,0,t.width,t.height,0,0,1);var o=t.context.gl;return{u_matrix:i,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:r.paint.get("heatmap-opacity")}}(t,r),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}}(t,n))},line:function(t,r,n,a){if("translucent"===t.renderPass){var i=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0!==i.constantOr(1)&&0!==o.constantOr(1)){var s=t.depthModeForSublayer(0,Ae.ReadOnly),l=t.colorModeForRenderPass(),u=n.paint.get("line-dasharray"),c=n.paint.get("line-pattern"),f=c.constantOr(1),h=n.paint.get("line-gradient"),p=n.getCrossfadeParameters(),d=f?"linePattern":u?"lineSDF":h?"lineGradient":"line",v=t.context,m=v.gl,g=!0;if(h){v.activeTexture.set(m.TEXTURE0);var y=n.gradientTexture;if(!n.gradient)return;y||(y=n.gradientTexture=new e.Texture(v,n.gradient,m.RGBA)),y.bind(m.LINEAR,m.CLAMP_TO_EDGE)}for(var x=0,_=a;x<_.length;x+=1){var b=_[x],w=r.getTile(b);if(!f||w.patternsLoaded()){var T=w.getBucket(n);if(T){var k=T.programConfigurations.get(n.id),A=t.context.program.get(),M=t.useProgram(d,k),E=g||M.program!==A,S=c.constantOr(null);if(S&&w.imageAtlas){var C=w.imageAtlas,L=C.patternPositions[S.to.toString()],I=C.patternPositions[S.from.toString()];L&&I&&k.setConstantPatternPositions(L,I)}var O=f?zr(t,w,n,p):u?Nr(t,w,n,u,p):h?Rr(t,w,n):Dr(t,w,n);f?(v.activeTexture.set(m.TEXTURE0),w.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),k.updatePaintBuffers(p)):u&&(E||t.lineAtlas.dirty)&&(v.activeTexture.set(m.TEXTURE0),t.lineAtlas.bind(v)),M.draw(v,m.TRIANGLES,s,t.stencilModeForClipping(b),l,Se.disabled,O,n.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,n.paint,t.transform.zoom,k),g=!1}}}}}},fill:function(t,r,n,a){var i=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0!==o.constantOr(1)){var s=t.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),u=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===i.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===u){var c=t.depthModeForSublayer(1,"opaque"===t.renderPass?Ae.ReadWrite:Ae.ReadOnly);rn(t,r,n,a,c,s,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){var f=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ae.ReadOnly);rn(t,r,n,a,f,s,!0)}}},"fill-extrusion":function(e,t,r,n){var a=r.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===e.renderPass){var i=new Ae(e.context.gl.LEQUAL,Ae.ReadWrite,e.depthRangeFor3D);if(1!==a||r.paint.get("fill-extrusion-pattern").constantOr(1))nn(e,t,r,n,i,Me.disabled,Ee.disabled),nn(e,t,r,n,i,e.stencilModeFor3D(),e.colorModeForRenderPass());else{var o=e.colorModeForRenderPass();nn(e,t,r,n,i,Me.disabled,o)}}},hillshade:function(e,t,r,n){if("offscreen"===e.renderPass||"translucent"===e.renderPass){for(var a=e.context,i=t.getSource().maxzoom,o=e.depthModeForSublayer(0,Ae.ReadOnly),s=e.colorModeForRenderPass(),l="translucent"===e.renderPass?e.stencilConfigForOverlap(n):[{},n],u=l[0],c=0,f=l[1];c<f.length;c+=1){var h=f[c],p=t.getTile(h);p.needsHillshadePrepare&&"offscreen"===e.renderPass?on(e,p,r,i,o,Me.disabled,s):"translucent"===e.renderPass&&an(e,p,r,o,u[h.overscaledZ],s)}a.viewport.set([0,0,e.width,e.height])}},raster:function(e,t,r,n){if("translucent"===e.renderPass&&0!==r.paint.get("raster-opacity")&&n.length)for(var a=e.context,i=a.gl,o=t.getSource(),s=e.useProgram("raster"),l=e.colorModeForRenderPass(),u=o instanceof O?[{},n]:e.stencilConfigForOverlap(n),c=u[0],f=u[1],h=f[f.length-1].overscaledZ,p=!e.options.moving,d=0,v=f;d<v.length;d+=1){var m=v[d],g=e.depthModeForSublayer(m.overscaledZ-h,1===r.paint.get("raster-opacity")?Ae.ReadWrite:Ae.ReadOnly,i.LESS),y=t.getTile(m),x=e.transform.calculatePosMatrix(m.toUnwrapped(),p);y.registerFadeDuration(r.paint.get("raster-fade-duration"));var _=t.findLoadedParent(m,0),b=sn(y,_,t,r,e.transform),w=void 0,T=void 0,k="nearest"===r.paint.get("raster-resampling")?i.NEAREST:i.LINEAR;a.activeTexture.set(i.TEXTURE0),y.texture.bind(k,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(i.TEXTURE1),_?(_.texture.bind(k,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,_.tileID.overscaledZ-y.tileID.overscaledZ),T=[y.tileID.canonical.x*w%1,y.tileID.canonical.y*w%1]):y.texture.bind(k,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST);var A=jr(x,T||[0,0],w||1,b,r);o instanceof O?s.draw(a,i.TRIANGLES,g,Me.disabled,l,Se.disabled,A,r.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments):s.draw(a,i.TRIANGLES,g,c[m.overscaledZ],l,Se.disabled,A,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,t,r){var n=r.paint.get("background-color"),a=r.paint.get("background-opacity");if(0!==a){var i=e.context,o=i.gl,s=e.transform,l=s.tileSize,u=r.paint.get("background-pattern");if(!e.isPatternMissing(u)){var c=!u&&1===n.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass===c){var f=Me.disabled,h=e.depthModeForSublayer(0,"opaque"===c?Ae.ReadWrite:Ae.ReadOnly),p=e.colorModeForRenderPass(),d=e.useProgram(u?"backgroundPattern":"background"),v=s.coveringTiles({tileSize:l});u&&(i.activeTexture.set(o.TEXTURE0),e.imageManager.bind(e.context));for(var m=r.getCrossfadeParameters(),g=0,y=v;g<y.length;g+=1){var x=y[g],_=e.transform.calculatePosMatrix(x.toUnwrapped()),b=u?Wr(_,a,e,u,{tileID:x,tileSize:l},m):Yr(_,a,n);d.draw(i,o.TRIANGLES,h,f,p,Se.disabled,b,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}}}},debug:function(e,t,r){for(var n=0;n<r.length;n++)mn(e,t,r[n])},custom:function(e,t,r){var n=e.context,a=r.implementation;if("offscreen"===e.renderPass){var i=a.prerender;i&&(e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),i.call(a,n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),n.setStencilMode(Me.disabled);var o="3d"===a.renderingMode?new Ae(e.context.gl.LEQUAL,Ae.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Ae.ReadOnly);n.setDepthMode(o),a.render(n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState(),n.bindFramebuffer.set(null)}}},yn=function(e,t){this.context=new Ce(e),this.transform=t,this._tileTextures={},this.setup(),this.numSublayers=Le.maxUnderzooming+Le.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ft,this.gpuTimers={}};yn.prototype.resize=function(t,r){if(this.width=t*e.browser.devicePixelRatio,this.height=r*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,a=this.style._order;n<a.length;n+=1)this.style._layers[a[n]].resize()},yn.prototype.setup=function(){var t=this.context,r=new e.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(r,Gt.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,Gt.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var a=new e.StructArrayLayout4i8;a.emplaceBack(0,0,0,0),a.emplaceBack(e.EXTENT,0,e.EXTENT,0),a.emplaceBack(0,e.EXTENT,0,e.EXTENT),a.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(a,I.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(1,0),i.emplaceBack(0,1),i.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(i,Gt.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout1ui2;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);var s=new e.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new Me({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},yn.prototype.clearStencil=function(){var t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=e.create();e.ortho(n,0,this.width,this.height,0,0,1),e.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,r.TRIANGLES,Ae.disabled,this.stencilClearMode,Ee.disabled,Se.disabled,Or(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},yn.prototype._renderTileClippingMasks=function(e,t){if(this.currentStencilSource!==e.source&&e.isTileClipped()&&t&&t.length){this.currentStencilSource=e.source;var r=this.context,n=r.gl;this.nextStencilID+t.length>256&&this.clearStencil(),r.setColorMode(Ee.disabled),r.setDepthMode(Ae.disabled);var a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var i=0,o=t;i<o.length;i+=1){var s=o[i],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;a.draw(r,n.TRIANGLES,Ae.disabled,new Me({func:n.ALWAYS,mask:0},l,255,n.KEEP,n.KEEP,n.REPLACE),Ee.disabled,Se.disabled,Or(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},yn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var e=this.nextStencilID++,t=this.context.gl;return new Me({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)},yn.prototype.stencilModeForClipping=function(e){var t=this.context.gl;return new Me({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)},yn.prototype.stencilConfigForOverlap=function(e){var t,r=this.context.gl,n=e.sort(function(e,t){return t.overscaledZ-e.overscaledZ}),a=n[n.length-1].overscaledZ,i=n[0].overscaledZ-a+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();for(var o={},s=0;s<i;s++)o[s+a]=new Me({func:r.GEQUAL,mask:255},s+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=i,[o,n]}return[(t={},t[a]=Me.disabled,t),n]},yn.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new Ee([t.CONSTANT_COLOR,t.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ee.unblended:Ee.alphaBlended},yn.prototype.depthModeForSublayer=function(e,t,r){if(!this.opaquePassEnabledForLayer())return Ae.disabled;var n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ae(r||this.context.gl.LEQUAL,t,[n,n])},yn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},yn.prototype.render=function(t,r){var n=this;this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var a=this.style._order,i=this.style.sourceCaches;for(var o in i){var s=i[o];s.used&&s.prepare(this.context)}var l,u,c={},f={},h={};for(var p in i){var d=i[p];c[p]=d.getVisibleCoordinates(),f[p]=c[p].slice().reverse(),h[p]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var v=0;v<a.length;v++)if(this.style._layers[a[v]].is3D()){this.opaquePassCutoff=v;break}this.renderPass="offscreen";for(var m=0,g=a;m<g.length;m+=1){var y=this.style._layers[g[m]];if(y.hasOffscreenPass()&&!y.isHidden(this.transform.zoom)){var x=f[y.source];("custom"===y.type||x.length)&&this.renderLayer(this,i[y.source],y,x)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){var _=this.style._layers[a[this.currentLayer]],b=i[_.source],w=c[_.source];this._renderTileClippingMasks(_,w),this.renderLayer(this,b,_,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){var T=this.style._layers[a[this.currentLayer]],k=i[T.source],A=("symbol"===T.type?h:f)[T.source];this._renderTileClippingMasks(T,c[T.source]),this.renderLayer(this,k,T,A)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(e){e.source&&!e.isHidden(n.transform.zoom)&&(e.source!==(u&&u.id)&&(u=n.style.sourceCaches[e.source]),(!l||l.getSource().maxzoom<u.getSource().maxzoom)&&(l=u))}),l&&gn.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(e){var t=e.transform.padding;pn(e,e.transform.height-(t.top||0),3,ln),pn(e,t.bottom||0,3,un),dn(e,t.left||0,3,cn),dn(e,e.transform.width-(t.right||0),3,fn);var r=e.transform.centerPoint;!function(e,t,r,n){vn(e,t-1,r-10,2,20,n),vn(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,hn)}(this),this.context.setDefault()},yn.prototype.renderLayer=function(e,t,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||"custom"===r.type||n.length)&&(this.id=r.id,this.gpuTimingStart(r),gn[r.type](e,t,r,n,this.style.placement.variableOffsets),this.gpuTimingEnd())},yn.prototype.gpuTimingStart=function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),r.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r.query)}},yn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}},yn.prototype.collectGpuTimers=function(){var e=this.gpuTimers;return this.gpuTimers={},e},yn.prototype.queryGpuTimers=function(e){var t={};for(var r in e){var n=e[r],a=this.context.extTimerQuery,i=a.getQueryObjectEXT(n.query,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(n.query),t[r]=i}return t},yn.prototype.translatePosMatrix=function(t,r,n,a,i){if(!n[0]&&!n[1])return t;var o=i?"map"===a?this.transform.angle:0:"viewport"===a?-this.transform.angle:0;if(o){var s=Math.sin(o),l=Math.cos(o);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var u=[i?n[0]:ht(r,n[0],this.transform.zoom),i?n[1]:ht(r,n[1],this.transform.zoom),0],c=new Float32Array(16);return e.translate(c,t,u),c},yn.prototype.saveTileTexture=function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]},yn.prototype.getTileTexture=function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null},yn.prototype.isPatternMissing=function(e){if(!e)return!1;if(!e.from||!e.to)return!0;var t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r},yn.prototype.useProgram=function(e,t){this.cache=this.cache||{};var r=""+e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new _r(this.context,yr[e],t,Xr[e],this._showOverdrawInspector)),this.cache[r]},yn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},yn.prototype.setBaseState=function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)},yn.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},yn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var xn=function(e,t){this.points=e,this.planes=t};xn.fromInvProjectionMatrix=function(t,r,n){var a=Math.pow(2,n),i=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(r){return e.transformMat4([],r,t)}).map(function(t){return e.scale$1([],t,1/t[3]/r*a)}),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(t){var r=e.sub([],i[t[0]],i[t[1]]),n=e.sub([],i[t[2]],i[t[1]]),a=e.normalize([],e.cross([],r,n)),o=-e.dot(a,i[t[1]]);return a.concat(o)});return new xn(i,o)};var _n=function(t,r){this.min=t,this.max=r,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};_n.prototype.quadrant=function(t){for(var r=[t%2==0,t<2],n=e.clone$2(this.min),a=e.clone$2(this.max),i=0;i<r.length;i++)n[i]=r[i]?this.min[i]:this.center[i],a[i]=r[i]?this.center[i]:this.max[i];return a[2]=this.max[2],new _n(n,a)},_n.prototype.distanceX=function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]},_n.prototype.distanceY=function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]},_n.prototype.intersects=function(t){for(var r=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,a=0;a<t.planes.length;a++){for(var i=t.planes[a],o=0,s=0;s<r.length;s++)o+=e.dot$1(i,r[s])>=0;if(0===o)return 0;o!==r.length&&(n=!1)}if(n)return 2;for(var l=0;l<3;l++){for(var u=Number.MAX_VALUE,c=-Number.MAX_VALUE,f=0;f<t.points.length;f++){var h=t.points[f][l]-this.min[l];u=Math.min(u,h),c=Math.max(c,h)}if(c<0||u>this.max[l]-this.min[l])return 0}return 1};var bn=function(e,t,r,n){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n};bn.prototype.interpolate=function(t,r,n){return null!=r.top&&null!=t.top&&(this.top=e.number(t.top,r.top,n)),null!=r.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,r.bottom,n)),null!=r.left&&null!=t.left&&(this.left=e.number(t.left,r.left,n)),null!=r.right&&null!=t.right&&(this.right=e.number(t.right,r.right,n)),this},bn.prototype.getCenter=function(t,r){var n=e.clamp((this.left+t-this.right)/2,0,t),a=e.clamp((this.top+r-this.bottom)/2,0,r);return new e.Point(n,a)},bn.prototype.equals=function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right},bn.prototype.clone=function(){return new bn(this.top,this.bottom,this.left,this.right)},bn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var wn=function(t,r,n,a,i){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===i||i,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=null==n?0:n,this._maxPitch=null==a?60:a,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new bn,this._posMatrixCache={},this._alignedPosMatrixCache={}},Tn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};wn.prototype.clone=function(){var e=new wn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._calcMatrices(),e},Tn.minZoom.get=function(){return this._minZoom},Tn.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))},Tn.maxZoom.get=function(){return this._maxZoom},Tn.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))},Tn.minPitch.get=function(){return this._minPitch},Tn.minPitch.set=function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))},Tn.maxPitch.get=function(){return this._maxPitch},Tn.maxPitch.set=function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))},Tn.renderWorldCopies.get=function(){return this._renderWorldCopies},Tn.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},Tn.worldSize.get=function(){return this.tileSize*this.scale},Tn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Tn.size.get=function(){return new e.Point(this.width,this.height)},Tn.bearing.get=function(){return-this.angle/Math.PI*180},Tn.bearing.set=function(t){var r=-e.wrap(t,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Tn.pitch.get=function(){return this._pitch/Math.PI*180},Tn.pitch.set=function(t){var r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Tn.fov.get=function(){return this._fov/Math.PI*180},Tn.fov.set=function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())},Tn.zoom.get=function(){return this._zoom},Tn.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},Tn.center.get=function(){return this._center},Tn.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},Tn.padding.get=function(){return this._edgeInsets.toJSON()},Tn.padding.set=function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())},Tn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},wn.prototype.isPaddingEqual=function(e){return this._edgeInsets.equals(e)},wn.prototype.interpolatePadding=function(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()},wn.prototype.coveringZoomLevel=function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)},wn.prototype.getVisibleUnwrappedCoordinates=function(t){var r=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new e.Point(0,0)),a=this.pointCoordinate(new e.Point(this.width,0)),i=this.pointCoordinate(new e.Point(this.width,this.height)),o=this.pointCoordinate(new e.Point(0,this.height)),s=Math.floor(Math.min(n.x,a.x,i.x,o.x)),l=Math.floor(Math.max(n.x,a.x,i.x,o.x)),u=s-1;u<=l+1;u++)0!==u&&r.push(new e.UnwrappedTileID(u,t));return r},wn.prototype.coveringTiles=function(t){var r=this.coveringZoomLevel(t),n=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);var a=e.MercatorCoordinate.fromLngLat(this.center),i=Math.pow(2,r),o=[i*a.x,i*a.y,0],s=xn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r),l=t.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(l=r);var u=function(e){return{aabb:new _n([e*i,0,0],[(e+1)*i,i,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}},c=[],f=[],h=r,p=t.reparseOverscaled?n:r;if(this._renderWorldCopies)for(var d=1;d<=3;d++)c.push(u(-d)),c.push(u(d));for(c.push(u(0));c.length>0;){var v=c.pop(),m=v.x,g=v.y,y=v.fullyVisible;if(!y){var x=v.aabb.intersects(s);if(0===x)continue;y=2===x}var _=v.aabb.distanceX(o),b=v.aabb.distanceY(o),w=Math.max(Math.abs(_),Math.abs(b));if(v.zoom===h||w>3+(1<<h-v.zoom)-2&&v.zoom>=l)f.push({tileID:new e.OverscaledTileID(v.zoom===h?p:v.zoom,v.wrap,v.zoom,m,g),distanceSq:e.sqrLen([o[0]-.5-m,o[1]-.5-g])});else for(var T=0;T<4;T++){var k=(m<<1)+T%2,A=(g<<1)+(T>>1);c.push({aabb:v.aabb.quadrant(T),zoom:v.zoom+1,x:k,y:A,wrap:v.wrap,fullyVisible:y})}}return f.sort(function(e,t){return e.distanceSq-t.distanceSq}).map(function(e){return e.tileID})},wn.prototype.resize=function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()},Tn.unmodified.get=function(){return this._unmodified},wn.prototype.zoomScale=function(e){return Math.pow(2,e)},wn.prototype.scaleZoom=function(e){return Math.log(e)/Math.LN2},wn.prototype.project=function(t){var r=e.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(t.lng)*this.worldSize,e.mercatorYfromLat(r)*this.worldSize)},wn.prototype.unproject=function(t){return new e.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},Tn.point.get=function(){return this.project(this.center)},wn.prototype.setLocationAtPoint=function(t,r){var n=this.pointCoordinate(r),a=this.pointCoordinate(this.centerPoint),i=this.locationCoordinate(t),o=new e.MercatorCoordinate(i.x-(n.x-a.x),i.y-(n.y-a.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())},wn.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},wn.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},wn.prototype.locationCoordinate=function(t){return e.MercatorCoordinate.fromLngLat(t)},wn.prototype.coordinateLocation=function(e){return e.toLngLat()},wn.prototype.pointCoordinate=function(t){var r=[t.x,t.y,0,1],n=[t.x,t.y,1,1];e.transformMat4(r,r,this.pixelMatrixInverse),e.transformMat4(n,n,this.pixelMatrixInverse);var a=r[3],i=n[3],o=r[1]/a,s=n[1]/i,l=r[2]/a,u=n[2]/i,c=l===u?0:(0-l)/(u-l);return new e.MercatorCoordinate(e.number(r[0]/a,n[0]/i,c)/this.worldSize,e.number(o,s,c)/this.worldSize)},wn.prototype.coordinatePoint=function(t){var r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix),new e.Point(r[0]/r[3],r[1]/r[3])},wn.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},wn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},wn.prototype.setMaxBounds=function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},wn.prototype.calculatePosMatrix=function(t,r){void 0===r&&(r=!1);var n=t.key,a=r?this._alignedPosMatrixCache:this._posMatrixCache;if(a[n])return a[n];var i=t.canonical,o=this.worldSize/this.zoomScale(i.z),s=i.x+Math.pow(2,i.z)*t.wrap,l=e.identity(new Float64Array(16));return e.translate(l,l,[s*o,i.y*o,0]),e.scale(l,l,[o/e.EXTENT,o/e.EXTENT,1]),e.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),a[n]=new Float32Array(l),a[n]},wn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},wn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,r,n,a,i=-90,o=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var f=this.latRange;i=e.mercatorYfromLat(f[1])*this.worldSize,t=(o=e.mercatorYfromLat(f[0])*this.worldSize)-i<u.y?u.y/(o-i):0}if(this.lngRange){var h=this.lngRange;s=e.mercatorXfromLng(h[0])*this.worldSize,r=(l=e.mercatorXfromLng(h[1])*this.worldSize)-s<u.x?u.x/(l-s):0}var p=this.point,d=Math.max(r||0,t||0);if(d)return this.center=this.unproject(new e.Point(r?(l+s)/2:p.x,t?(o+i)/2:p.y)),this.zoom+=this.scaleZoom(d),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var v=p.y,m=u.y/2;v-m<i&&(a=i+m),v+m>o&&(a=o-m)}if(this.lngRange){var g=p.x,y=u.x/2;g-y<s&&(n=s+y),g+y>l&&(n=l-y)}void 0===n&&void 0===a||(this.center=this.unproject(new e.Point(void 0!==n?n:p.x,void 0!==a?a:p.y))),this._unmodified=c,this._constraining=!1}},wn.prototype._calcMatrices=function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var r=Math.PI/2+this._pitch,n=this._fov*(.5+t.y/this.height),a=Math.sin(n)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-r-n,.01,Math.PI-.01)),i=this.point,o=i.x,s=i.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*a+this.cameraToCenterDistance),u=this.height/50,c=new Float64Array(16);e.perspective(c,this._fov,this.width/this.height,u,l),c[8]=2*-t.x/this.width,c[9]=2*t.y/this.height,e.scale(c,c,[1,-1,1]),e.translate(c,c,[0,0,-this.cameraToCenterDistance]),e.rotateX(c,c,this._pitch),e.rotateZ(c,c,this.angle),e.translate(c,c,[-o,-s,0]),this.mercatorMatrix=e.scale([],c,[this.worldSize,this.worldSize,this.worldSize]),e.scale(c,c,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=c,this.invProjMatrix=e.invert([],this.projMatrix);var f=this.width%2/2,h=this.height%2/2,p=Math.cos(this.angle),d=Math.sin(this.angle),v=o-Math.round(o)+p*f+d*h,m=s-Math.round(s)+p*h+d*f,g=new Float64Array(c);if(e.translate(g,g,[v>.5?v-1:v,m>.5?m-1:m,0]),this.alignedProjMatrix=g,c=e.create(),e.scale(c,c,[this.width/2,-this.height/2,1]),e.translate(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=e.create(),e.scale(c,c,[1,-1,1]),e.translate(c,c,[-1,-1,0]),e.scale(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(c=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}},wn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new e.Point(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},wn.prototype.getCameraPoint=function(){var t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))},wn.prototype.getCameraQueryGeometry=function(t){var r=this.getCameraPoint();if(1===t.length)return[t[0],r];for(var n=r.x,a=r.y,i=r.x,o=r.y,s=0,l=t;s<l.length;s+=1){var u=l[s];n=Math.min(n,u.x),a=Math.min(a,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}return[new e.Point(n,a),new e.Point(i,a),new e.Point(i,o),new e.Point(n,o),new e.Point(n,a)]},Object.defineProperties(wn.prototype,Tn);var kn=function(t){var r,n,a,i;this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(r=this._updateHashUnthrottled.bind(this),n=!1,a=null,i=function(){a=null,n&&(r(),a=setTimeout(i,300),n=!1)},function(){return n=!0,a||i(),a})};kn.prototype.addTo=function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},kn.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},kn.prototype.getHashString=function(t){var r=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,a=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,a),o=Math.round(r.lng*i)/i,s=Math.round(r.lat*i)/i,l=this._map.getBearing(),u=this._map.getPitch(),c="";if(c+=t?"/"+o+"/"+s+"/"+n:n+"/"+s+"/"+o,(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+="/"+Math.round(u)),this._hashName){var f=this._hashName,h=!1,p=e.window.location.hash.slice(1).split("&").map(function(e){var t=e.split("=")[0];return t===f?(h=!0,t+"="+c):e}).filter(function(e){return e});return h||p.push(f+"="+c),"#"+p.join("&")}return"#"+c},kn.prototype._getCurrentHash=function(){var t,r=this,n=e.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(e){return e.split("=")}).forEach(function(e){e[0]===r._hashName&&(t=e)}),(t&&t[1]||"").split("/")):n.split("/")},kn.prototype._onHashChange=function(){var e=this._getCurrentHash();if(e.length>=3&&!e.some(function(e){return isNaN(e)})){var t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},kn.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",t)}catch(e){}};var An={linearity:.3,easing:e.bezier(0,0,.3,1)},Mn=e.extend({deceleration:2500,maxSpeed:1400},An),En=e.extend({deceleration:20,maxSpeed:1400},An),Sn=e.extend({deceleration:1e3,maxSpeed:360},An),Cn=e.extend({deceleration:1e3,maxSpeed:90},An),Ln=function(e){this._map=e,this.clear()};function In(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function On(t,r,n){var a=n.maxSpeed,i=n.linearity,o=n.deceleration,s=e.clamp(t*i/(r/1e3),-a,a),l=Math.abs(s)/(o*i);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}Ln.prototype.clear=function(){this._inertiaBuffer=[]},Ln.prototype.record=function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:t})},Ln.prototype._drainInertiaBuffer=function(){for(var t=this._inertiaBuffer,r=e.browser.now();t.length>0&&r-t[0].time>160;)t.shift()},Ln.prototype._onMoveEnd=function(t){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var r={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},n=0,a=this._inertiaBuffer;n<a.length;n+=1){var i=a[n].settings;r.zoom+=i.zoomDelta||0,r.bearing+=i.bearingDelta||0,r.pitch+=i.pitchDelta||0,i.panDelta&&r.pan._add(i.panDelta),i.around&&(r.around=i.around),i.pinchAround&&(r.pinchAround=i.pinchAround)}var o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(r.pan.mag()){var l=On(r.pan.mag(),o,e.extend({},Mn,t||{}));s.offset=r.pan.mult(l.amount/r.pan.mag()),s.center=this._map.transform.center,In(s,l)}if(r.zoom){var u=On(r.zoom,o,En);s.zoom=this._map.transform.zoom+u.amount,In(s,u)}if(r.bearing){var c=On(r.bearing,o,Sn);s.bearing=this._map.transform.bearing+e.clamp(c.amount,-179,179),In(s,c)}if(r.pitch){var f=On(r.pitch,o,Cn);s.pitch=this._map.transform.pitch+f.amount,In(s,f)}if(s.zoom||s.bearing){var h=void 0===r.pinchAround?r.around:r.pinchAround;s.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),e.extend(s,{noMoveStart:!0})}};var Pn=function(t){function n(n,a,i,o){void 0===o&&(o={});var s=r.mousePos(a.getCanvasContainer(),i),l=a.unproject(s);t.call(this,n,e.extend({point:s,lngLat:l,originalEvent:i},o)),this._defaultPrevented=!1,this.target=a}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var a={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,a),n}(e.Event),Dn=function(t){function n(n,a,i){var o="touchend"===n?i.changedTouches:i.touches,s=r.touchPos(a.getCanvasContainer(),o),l=s.map(function(e){return a.unproject(e)}),u=s.reduce(function(e,t,r,n){return e.add(t.div(n.length))},new e.Point(0,0)),c=a.unproject(u);t.call(this,n,{points:s,point:u,lngLats:l,lngLat:c,originalEvent:i}),this._defaultPrevented=!1}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var a={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,a),n}(e.Event),Rn=function(e){function t(t,r,n){e.call(this,t,{originalEvent:n}),this._defaultPrevented=!1}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,r),t}(e.Event),zn=function(e,t){this._map=e,this._clickTolerance=t.clickTolerance};zn.prototype.reset=function(){delete this._mousedownPos},zn.prototype.wheel=function(e){return this._firePreventable(new Rn(e.type,this._map,e))},zn.prototype.mousedown=function(e,t){return this._mousedownPos=t,this._firePreventable(new Pn(e.type,this._map,e))},zn.prototype.mouseup=function(e){this._map.fire(new Pn(e.type,this._map,e))},zn.prototype.click=function(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Pn(e.type,this._map,e))},zn.prototype.dblclick=function(e){return this._firePreventable(new Pn(e.type,this._map,e))},zn.prototype.mouseover=function(e){this._map.fire(new Pn(e.type,this._map,e))},zn.prototype.mouseout=function(e){this._map.fire(new Pn(e.type,this._map,e))},zn.prototype.touchstart=function(e){return this._firePreventable(new Dn(e.type,this._map,e))},zn.prototype.touchmove=function(e){this._map.fire(new Dn(e.type,this._map,e))},zn.prototype.touchend=function(e){this._map.fire(new Dn(e.type,this._map,e))},zn.prototype.touchcancel=function(e){this._map.fire(new Dn(e.type,this._map,e))},zn.prototype._firePreventable=function(e){if(this._map.fire(e),e.defaultPrevented)return{}},zn.prototype.isEnabled=function(){return!0},zn.prototype.isActive=function(){return!1},zn.prototype.enable=function(){},zn.prototype.disable=function(){};var Nn=function(e){this._map=e};Nn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Nn.prototype.mousemove=function(e){this._map.fire(new Pn(e.type,this._map,e))},Nn.prototype.mousedown=function(){this._delayContextMenu=!0},Nn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Nn.prototype.contextmenu=function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new Pn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()},Nn.prototype.isEnabled=function(){return!0},Nn.prototype.isActive=function(){return!1},Nn.prototype.enable=function(){},Nn.prototype.disable=function(){};var Fn=function(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1};function Bn(e,t){for(var r={},n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}Fn.prototype.isEnabled=function(){return!!this._enabled},Fn.prototype.isActive=function(){return!!this._active},Fn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Fn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Fn.prototype.mousedown=function(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(r.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)},Fn.prototype.mousemoveWindow=function(e,t){if(this._active){var n=t;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var a=this._startPos;this._lastPos=n,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var i=Math.min(a.x,n.x),o=Math.max(a.x,n.x),s=Math.min(a.y,n.y),l=Math.max(a.y,n.y);r.setTransform(this._box,"translate("+i+"px,"+s+"px)"),this._box.style.width=o-i+"px",this._box.style.height=l-s+"px"}}},Fn.prototype.mouseupWindow=function(t,n){var a=this;if(this._active&&0===t.button){var i=this._startPos,o=n;if(this.reset(),r.suppressClick(),i.x!==o.x||i.y!==o.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(i,o,a._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",t)}},Fn.prototype.keydown=function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))},Fn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},Fn.prototype._fireEvent=function(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))};var jn=function(e){this.reset(),this.numTouches=e.numTouches};jn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jn.prototype.touchstart=function(t,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){for(var r=new e.Point(0,0),n=0,a=t;n<a.length;n+=1)r._add(a[n]);return r.div(t.length)}(r),this.touches=Bn(n,r)))},jn.prototype.touchmove=function(e,t,r){if(!this.aborted&&this.centroid){var n=Bn(r,t);for(var a in this.touches){var i=n[a];(!i||i.dist(this.touches[a])>30)&&(this.aborted=!0)}}},jn.prototype.touchend=function(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){var n=!this.aborted&&this.centroid;if(this.reset(),n)return n}};var Un=function(e){this.singleTap=new jn(e),this.numTaps=e.numTaps,this.reset()};Un.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Un.prototype.touchstart=function(e,t,r){this.singleTap.touchstart(e,t,r)},Un.prototype.touchmove=function(e,t,r){this.singleTap.touchmove(e,t,r)},Un.prototype.touchend=function(e,t,r){var n=this.singleTap.touchend(e,t,r);if(n){var a=e.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(a&&i||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}};var Hn=function(){this._zoomIn=new Un({numTouches:1,numTaps:2}),this._zoomOut=new Un({numTouches:2,numTaps:1}),this.reset()};Hn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Hn.prototype.touchstart=function(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)},Hn.prototype.touchmove=function(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)},Hn.prototype.touchend=function(e,t,r){var n=this,a=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r);return a?(this._active=!0,e.preventDefault(),setTimeout(function(){return n.reset()},0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(a)},{originalEvent:e})}}):i?(this._active=!0,e.preventDefault(),setTimeout(function(){return n.reset()},0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(i)},{originalEvent:e})}}):void 0},Hn.prototype.touchcancel=function(){this.reset()},Hn.prototype.enable=function(){this._enabled=!0},Hn.prototype.disable=function(){this._enabled=!1,this.reset()},Hn.prototype.isEnabled=function(){return this._enabled},Hn.prototype.isActive=function(){return this._active};var Vn=function(e){this.reset(),this._clickTolerance=e.clickTolerance||1};Vn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Vn.prototype._correctButton=function(e,t){return!1},Vn.prototype._move=function(e,t){return{}},Vn.prototype.mousedown=function(e,t){if(!this._lastPoint){var n=r.mouseButton(e);this._correctButton(e,n)&&(this._lastPoint=t,this._eventButton=n)}},Vn.prototype.mousemoveWindow=function(e,t){var r=this._lastPoint;if(r&&(e.preventDefault(),this._moved||!(t.dist(r)<this._clickTolerance)))return this._moved=!0,this._lastPoint=t,this._move(r,t)},Vn.prototype.mouseupWindow=function(e){r.mouseButton(e)===this._eventButton&&(this._moved&&r.suppressClick(),this.reset())},Vn.prototype.enable=function(){this._enabled=!0},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var Gn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.mousedown=function(t,r){e.prototype.mousedown.call(this,t,r),this._lastPoint&&(this._active=!0)},t.prototype._correctButton=function(e,t){return 0===t&&!e.ctrlKey},t.prototype._move=function(e,t){return{around:t,panDelta:t.sub(e)}},t}(Vn),qn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._correctButton=function(e,t){return 0===t&&e.ctrlKey||2===t},t.prototype._move=function(e,t){var r=.8*(t.x-e.x);if(r)return this._active=!0,{bearingDelta:r}},t.prototype.contextmenu=function(e){e.preventDefault()},t}(Vn),Yn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._correctButton=function(e,t){return 0===t&&e.ctrlKey||2===t},t.prototype._move=function(e,t){var r=-.5*(t.y-e.y);if(r)return this._active=!0,{pitchDelta:r}},t.prototype.contextmenu=function(e){e.preventDefault()},t}(Vn),Wn=function(e){this._minTouches=1,this._clickTolerance=e.clickTolerance||1,this.reset()};Wn.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Wn.prototype.touchstart=function(e,t,r){return this._calculateTransform(e,t,r)},Wn.prototype.touchmove=function(e,t,r){if(this._active)return e.preventDefault(),this._calculateTransform(e,t,r)},Wn.prototype.touchend=function(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this._minTouches&&this.reset()},Wn.prototype.touchcancel=function(){this.reset()},Wn.prototype._calculateTransform=function(t,r,n){n.length>0&&(this._active=!0);var a=Bn(n,r),i=new e.Point(0,0),o=new e.Point(0,0),s=0;for(var l in a){var u=a[l],c=this._touches[l];c&&(i._add(u),o._add(u.sub(c)),s++,a[l]=u)}if(this._touches=a,!(s<this._minTouches)&&o.mag()){var f=o.div(s);if(this._sum._add(f),!(this._sum.mag()<this._clickTolerance))return{around:i.div(s),panDelta:f}}},Wn.prototype.enable=function(){this._enabled=!0},Wn.prototype.disable=function(){this._enabled=!1,this.reset()},Wn.prototype.isEnabled=function(){return this._enabled},Wn.prototype.isActive=function(){return this._active};var Xn=function(){this.reset()};function Zn(e,t,r){for(var n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function Kn(e,t){return Math.log(e/t)/Math.LN2}Xn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Xn.prototype._start=function(e){},Xn.prototype._move=function(e,t,r){return{}},Xn.prototype.touchstart=function(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))},Xn.prototype.touchmove=function(e,t,r){if(this._firstTwoTouches){e.preventDefault();var n=this._firstTwoTouches,a=n[1],i=Zn(r,t,n[0]),o=Zn(r,t,a);if(i&&o){var s=this._aroundCenter?null:i.add(o).div(2);return this._move([i,o],s,e)}}},Xn.prototype.touchend=function(e,t,n){if(this._firstTwoTouches){var a=this._firstTwoTouches,i=a[1],o=Zn(n,t,a[0]),s=Zn(n,t,i);o&&s||(this._active&&r.suppressClick(),this.reset())}},Xn.prototype.touchcancel=function(){this.reset()},Xn.prototype.enable=function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around},Xn.prototype.disable=function(){this._enabled=!1,this.reset()},Xn.prototype.isEnabled=function(){return this._enabled},Xn.prototype.isActive=function(){return this._active};var Jn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.reset=function(){e.prototype.reset.call(this),delete this._distance,delete this._startDistance},t.prototype._start=function(e){this._startDistance=this._distance=e[0].dist(e[1])},t.prototype._move=function(e,t){var r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Kn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Kn(this._distance,r),pinchAround:t}},t}(Xn);function Qn(e,t){return 180*e.angleWith(t)/Math.PI}var $n=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.reset=function(){e.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},t.prototype._start=function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])},t.prototype._move=function(e,t){var r=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qn(this._vector,r),pinchAround:t}},t.prototype._isBelowThreshold=function(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360,r=Qn(e,this._startVector);return Math.abs(r)<t},t}(Xn);function ea(e){return Math.abs(e.y)>Math.abs(e.x)}var ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.reset=function(){e.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},t.prototype._start=function(e){this._lastPoints=e,ea(e[0].sub(e[1]))&&(this._valid=!1)},t.prototype._move=function(e,t,r){var n=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(n,a,r.timeStamp),this._valid)return this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+a.y)/2*-.5}},t.prototype.gestureBeginsVertically=function(e,t,r){if(void 0!==this._valid)return this._valid;var n=e.mag()>=2,a=t.mag()>=2;if(n||a){if(!n||!a)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;var i=e.y>0==t.y>0;return ea(e)&&ea(t)&&i}},t}(Xn),ra={panStep:100,bearingStep:15,pitchStep:10},na=function(){var e=ra;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep};function aa(e){return e*(2-e)}na.prototype.reset=function(){this._active=!1},na.prototype.keydown=function(e){var t=this;if(!(e.altKey||e.ctrlKey||e.metaKey)){var r=0,n=0,a=0,i=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?a=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?a=-1:(e.preventDefault(),o=1);break;default:return}return{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:aa,zoom:r?Math.round(l)+r*(e.shiftKey?2:1):l,bearing:s.getBearing()+n*t._bearingStep,pitch:s.getPitch()+a*t._pitchStep,offset:[-i*t._panStep,-o*t._panStep],center:s.getCenter()},{originalEvent:e})}}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var ia=function(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ia.prototype.setZoomRate=function(e){this._defaultZoomRate=e},ia.prototype.setWheelZoomRate=function(e){this._wheelZoomRate=e},ia.prototype.isEnabled=function(){return!!this._enabled},ia.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ia.prototype.isZooming=function(){return!!this._zooming},ia.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},ia.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ia.prototype.wheel=function(t){if(this.isEnabled()){var r=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,n=e.browser.now(),a=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":a>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(a*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}},ia.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},ia.prototype._start=function(t){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var n=r.mousePos(this._el,t);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ia.prototype.renderFrame=function(){return this._onScrollFrame()},ia.prototype._onScrollFrame=function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var r=this._map.transform;if(0!==this._delta){var n="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,a=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==a&&(a=1/a);var i="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(i*a))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var o,s="number"==typeof this._targetZoom?this._targetZoom:r.zoom,l=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&l&&u){var f=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),h=u(f);o=e.number(l,s,h),f<1?this._frameId||(this._frameId=!0):c=!0}else o=s,c=!0;return this._active=!0,c&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!c,zoomDelta:o-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ia.prototype._smoothOutEasing=function(t){var r=e.ease;if(this._prevEase){var n=this._prevEase,a=(e.browser.now()-n.start)/n.duration,i=n.easing(a+.01)-n.easing(a),o=.27/Math.sqrt(i*i+1e-4)*.01,s=Math.sqrt(.0729-o*o);r=e.bezier(o,s,.25,1)}return this._prevEase={start:e.browser.now(),duration:t,easing:r},r},ia.prototype.reset=function(){this._active=!1};var oa=function(e,t){this._clickZoom=e,this._tapZoom=t};oa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},oa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},oa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},oa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var sa=function(){this.reset()};sa.prototype.reset=function(){this._active=!1},sa.prototype.dblclick=function(e,t){return e.preventDefault(),{cameraAnimation:function(r){r.easeTo({duration:300,zoom:r.getZoom()+(e.shiftKey?-1:1),around:r.unproject(t)},{originalEvent:e})}}},sa.prototype.enable=function(){this._enabled=!0},sa.prototype.disable=function(){this._enabled=!1,this.reset()},sa.prototype.isEnabled=function(){return this._enabled},sa.prototype.isActive=function(){return this._active};var la=function(){this._tap=new Un({numTouches:1,numTaps:1}),this.reset()};la.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},la.prototype.touchstart=function(e,t,r){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=t[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(e,t,r))},la.prototype.touchmove=function(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;var n=t[0],a=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}else this._tap.touchmove(e,t,r)},la.prototype.touchend=function(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(e,t,r)&&(this._tapTime=e.timeStamp)},la.prototype.touchcancel=function(){this.reset()},la.prototype.enable=function(){this._enabled=!0},la.prototype.disable=function(){this._enabled=!1,this.reset()},la.prototype.isEnabled=function(){return this._enabled},la.prototype.isActive=function(){return this._active};var ua=function(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r};ua.prototype.enable=function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ua.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ua.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ua.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ca=function(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r};ca.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ca.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ca.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ca.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var fa=function(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0};fa.prototype.enable=function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},fa.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},fa.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},fa.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},fa.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},fa.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ha=function(e){return e.zoom||e.drag||e.pitch||e.rotate},pa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(e.Event);function da(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var va=function(t,n){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ln(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),e.bindAll(["handleEvent","handleWindowEvent"],this);var a=this._el;this._listeners=[[a,"touchstart",{passive:!1}],[a,"touchmove",{passive:!1}],[a,"touchend",void 0],[a,"touchcancel",void 0],[a,"mousedown",void 0],[a,"mousemove",void 0],[a,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[a,"mouseover",void 0],[a,"mouseout",void 0],[a,"dblclick",void 0],[a,"click",void 0],[a,"keydown",{capture:!1}],[a,"keyup",void 0],[a,"wheel",{passive:!1}],[a,"contextmenu",void 0],[e.window,"blur",void 0]];for(var i=0,o=this._listeners;i<o.length;i+=1){var s=o[i],l=s[0];r.addEventListener(l,s[1],l===e.window.document?this.handleWindowEvent:this.handleEvent,s[2])}};va.prototype.destroy=function(){for(var t=0,n=this._listeners;t<n.length;t+=1){var a=n[t],i=a[0];r.removeEventListener(i,a[1],i===e.window.document?this.handleWindowEvent:this.handleEvent,a[2])}},va.prototype._addDefaultHandlers=function(e){var t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new zn(t,e));var n=t.boxZoom=new Fn(t,e);this._add("boxZoom",n);var a=new Hn,i=new sa;t.doubleClickZoom=new oa(i,a),this._add("tapZoom",a),this._add("clickZoom",i);var o=new la;this._add("tapDragZoom",o);var s=t.touchPitch=new ta;this._add("touchPitch",s);var l=new qn(e),u=new Yn(e);t.dragRotate=new ca(e,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new Gn(e),f=new Wn(e);t.dragPan=new ua(r,c,f),this._add("mousePan",c),this._add("touchPan",f,["touchZoom","touchRotate"]);var h=new $n,p=new Jn;t.touchZoomRotate=new fa(r,p,h,o),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);var d=t.scrollZoom=new ia(t,this);this._add("scrollZoom",d,["mousePan"]);var v=t.keyboard=new na;this._add("keyboard",v),this._add("blockableMapEvent",new Nn(t));for(var m=0,g=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];m<g.length;m+=1){var y=g[m];e.interactive&&e[y]&&t[y].enable(e[y])}},va.prototype._add=function(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t},va.prototype.stop=function(){if(!this._updatingCamera){for(var e=0,t=this._handlers;e<t.length;e+=1)t[e].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},va.prototype.isActive=function(){for(var e=0,t=this._handlers;e<t.length;e+=1)if(t[e].handler.isActive())return!0;return!1},va.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},va.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},va.prototype.isMoving=function(){return Boolean(ha(this._eventsInProgress))||this.isZooming()},va.prototype._blockedByActive=function(e,t,r){for(var n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1},va.prototype.handleWindowEvent=function(e){this.handleEvent(e,e.type+"Window")},va.prototype._getMapTouches=function(e){for(var t=[],r=0,n=e;r<n.length;r+=1){var a=n[r];this._el.contains(a.target)&&t.push(a)}return t},va.prototype.handleEvent=function(e,t){if("blur"!==e.type){this._updatingCamera=!0;for(var n="renderFrame"===e.type?void 0:e,a={needsRenderFrame:!1},i={},o={},s=e.touches?this._getMapTouches(e.touches):void 0,l=s?r.touchPos(this._el,s):r.mousePos(this._el,e),u=0,c=this._handlers;u<c.length;u+=1){var f=c[u],h=f.handlerName,p=f.handler,d=f.allowed;if(p.isEnabled()){var v=void 0;this._blockedByActive(o,d,h)?p.reset():p[t||e.type]&&(v=p[t||e.type](e,l,s),this.mergeHandlerResult(a,i,v,h,n),v&&v.needsRenderFrame&&this._triggerRenderFrame()),(v||p.isActive())&&(o[h]=p)}}var m={};for(var g in this._previousActiveHandlers)o[g]||(m[g]=n);this._previousActiveHandlers=o,(Object.keys(m).length||da(a))&&(this._changes.push([a,i,m]),this._triggerRenderFrame()),(Object.keys(o).length||da(a))&&this._map._stop(!0),this._updatingCamera=!1;var y=a.cameraAnimation;y&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],y(this._map))}else this.stop()},va.prototype.mergeHandlerResult=function(t,r,n,a,i){if(n){e.extend(t,n);var o={handlerName:a,originalEvent:n.originalEvent||i};void 0!==n.zoomDelta&&(r.zoom=o),void 0!==n.panDelta&&(r.drag=o),void 0!==n.pitchDelta&&(r.pitch=o),void 0!==n.bearingDelta&&(r.rotate=o)}},va.prototype._applyChanges=function(){for(var t={},r={},n={},a=0,i=this._changes;a<i.length;a+=1){var o=i[a],s=o[0],l=o[1],u=o[2];s.panDelta&&(t.panDelta=(t.panDelta||new e.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(t.around=s.around),void 0!==s.pinchAround&&(t.pinchAround=s.pinchAround),s.noInertia&&(t.noInertia=s.noInertia),e.extend(r,l),e.extend(n,u)}this._updateMapTransform(t,r,n),this._changes=[]},va.prototype._updateMapTransform=function(e,t,r){var n=this._map,a=n.transform;if(!da(e))return this._fireEvents(t,r);var i=e.panDelta,o=e.zoomDelta,s=e.bearingDelta,l=e.pitchDelta,u=e.around,c=e.pinchAround;void 0!==c&&(u=c),n._stop(!0),u=u||n.transform.centerPoint;var f=a.pointLocation(i?u.sub(i):u);s&&(a.bearing+=s),l&&(a.pitch+=l),o&&(a.zoom+=o),a.setLocationAtPoint(f,u),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r)},va.prototype._fireEvents=function(t,r){var n=this,a=ha(this._eventsInProgress),i=ha(t),o={};for(var s in t)this._eventsInProgress[s]||(o[s+"start"]=t[s].originalEvent),this._eventsInProgress[s]=t[s];for(var l in!a&&i&&this._fireEvent("movestart",i.originalEvent),o)this._fireEvent(l,o[l]);for(var u in t.rotate&&(this._bearingChanged=!0),i&&this._fireEvent("move",i.originalEvent),t)this._fireEvent(u,t[u].originalEvent);var c,f={};for(var h in this._eventsInProgress){var p=this._eventsInProgress[h],d=p.handlerName,v=p.originalEvent;this._handlersById[d].isActive()||(delete this._eventsInProgress[h],f[h+"end"]=c=r[d]||v)}for(var m in f)this._fireEvent(m,f[m]);var g=ha(this._eventsInProgress);if((a||i)&&!g){this._updatingCamera=!0;var y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),x=function(e){return 0!==e&&-n._bearingSnap<e&&e<n._bearingSnap};y?(x(y.bearing||this._map.getBearing())&&(y.bearing=0),this._map.easeTo(y,{originalEvent:c})):(this._map.fire(new e.Event("moveend",{originalEvent:c})),x(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},va.prototype._fireEvent=function(t,r){this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))},va.prototype._triggerRenderFrame=function(){var e=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(t){delete e._frameId,e.handleEvent(new pa("renderFrame",{timeStamp:t})),e._applyChanges()}))};var ma=function(t){function r(r,n){t.call(this),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},r.prototype.setCenter=function(e,t){return this.jumpTo({center:e},t)},r.prototype.panBy=function(t,r,n){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),n)},r.prototype.panTo=function(t,r,n){return this.easeTo(e.extend({center:t},r),n)},r.prototype.getZoom=function(){return this.transform.zoom},r.prototype.setZoom=function(e,t){return this.jumpTo({zoom:e},t),this},r.prototype.zoomTo=function(t,r,n){return this.easeTo(e.extend({zoom:t},r),n)},r.prototype.zoomIn=function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this},r.prototype.zoomOut=function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this},r.prototype.getBearing=function(){return this.transform.bearing},r.prototype.setBearing=function(e,t){return this.jumpTo({bearing:e},t),this},r.prototype.getPadding=function(){return this.transform.padding},r.prototype.setPadding=function(e,t){return this.jumpTo({padding:e},t),this},r.prototype.rotateTo=function(t,r,n){return this.easeTo(e.extend({bearing:t},r),n)},r.prototype.resetNorth=function(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this},r.prototype.resetNorthPitch=function(t,r){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),r),this},r.prototype.snapToNorth=function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this},r.prototype.getPitch=function(){return this.transform.pitch},r.prototype.setPitch=function(e,t){return this.jumpTo({pitch:e},t),this},r.prototype.cameraForBounds=function(t,r){return t=e.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,r)},r.prototype._cameraForBoxAndBearing=function(t,r,n,a){var i={top:0,bottom:0,right:0,left:0};if("number"==typeof(a=e.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding){var o=a.padding;a.padding={top:o,bottom:o,right:o,left:o}}a.padding=e.extend(i,a.padding);var s=this.transform,l=s.padding,u=s.project(e.LngLat.convert(t)),c=s.project(e.LngLat.convert(r)),f=u.rotate(-n*Math.PI/180),h=c.rotate(-n*Math.PI/180),p=new e.Point(Math.max(f.x,h.x),Math.max(f.y,h.y)),d=new e.Point(Math.min(f.x,h.x),Math.min(f.y,h.y)),v=p.sub(d),m=(s.width-(l.left+l.right+a.padding.left+a.padding.right))/v.x,g=(s.height-(l.top+l.bottom+a.padding.top+a.padding.bottom))/v.y;if(!(g<0||m<0)){var y=Math.min(s.scaleZoom(s.scale*Math.min(m,g)),a.maxZoom),x=e.Point.convert(a.offset),_=new e.Point(x.x+(a.padding.left-a.padding.right)/2,x.y+(a.padding.top-a.padding.bottom)/2).mult(s.scale/s.zoomScale(y));return{center:s.unproject(u.add(c).div(2).sub(_)),zoom:y,bearing:n}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},r.prototype.fitBounds=function(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)},r.prototype.fitScreenCoordinates=function(t,r,n,a,i){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(t)),this.transform.pointLocation(e.Point.convert(r)),n,a),a,i)},r.prototype._fitInternal=function(t,r,n){return t?(delete(r=e.extend(t,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this},r.prototype.jumpTo=function(t,r){this.stop();var n=this.transform,a=!1,i=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(a=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(i=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),a&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),i&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),o&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r))},r.prototype.easeTo=function(t,r){var n=this;this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.browser.prefersReducedMotion)&&(t.duration=0);var a=this.transform,i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="zoom"in t?+t.zoom:i,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,f="pitch"in t?+t.pitch:s,h="padding"in t?t.padding:a.padding,p=e.Point.convert(t.offset),d=a.centerPoint.add(p),v=a.pointLocation(d),m=e.LngLat.convert(t.center||v);this._normalizeCenter(m);var g,y,x=a.project(v),_=a.project(m).sub(x),b=a.zoomScale(u-i);t.around&&(g=e.LngLat.convert(t.around),y=a.locationPoint(g));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||u!==i,this._rotating=this._rotating||o!==c,this._pitching=this._pitching||f!==s,this._padding=!a.isPaddingEqual(h),this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,w),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(n._zooming&&(a.zoom=e.number(i,u,t)),n._rotating&&(a.bearing=e.number(o,c,t)),n._pitching&&(a.pitch=e.number(s,f,t)),n._padding&&(a.interpolatePadding(l,h,t),d=a.centerPoint.add(p)),g)a.setLocationAtPoint(g,y);else{var v=a.zoomScale(a.zoom-i),m=u>i?Math.min(2,b):Math.max(.5,b),w=Math.pow(m,1-t),T=a.unproject(x.add(_.mult(t*w)).mult(v));a.setLocationAtPoint(a.renderWorldCopies?T.wrap():T,d)}n._fireMoveEvents(r)},function(e){n._afterEase(r,e)},t),this},r.prototype._prepareEase=function(t,r,n){void 0===n&&(n={}),this._moving=!0,r||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))},r.prototype._fireMoveEvents=function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))},r.prototype._afterEase=function(t,r){if(!this._easeId||!r||this._easeId!==r){delete this._easeId;var n=this._zooming,a=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),a&&this.fire(new e.Event("rotateend",t)),i&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}},r.prototype.flyTo=function(t,r){var n=this;if(!t.essential&&e.browser.prefersReducedMotion){var a=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(a,r)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var i=this.transform,o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in t?e.clamp(+t.zoom,i.minZoom,i.maxZoom):o,f="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:l,p="padding"in t?t.padding:i.padding,d=i.zoomScale(c-o),v=e.Point.convert(t.offset),m=i.centerPoint.add(v),g=i.pointLocation(m),y=e.LngLat.convert(t.center||g);this._normalizeCenter(y);var x=i.project(g),_=i.project(y).sub(x),b=t.curve,w=Math.max(i.width,i.height),T=w/d,k=_.mag();if("minZoom"in t){var A=e.clamp(Math.min(t.minZoom,o,c),i.minZoom,i.maxZoom),M=w/i.zoomScale(A-o);b=Math.sqrt(M/k*2)}var E=b*b;function S(e){var t=(T*T-w*w+(e?-1:1)*E*E*k*k)/(2*(e?T:w)*E*k);return Math.log(Math.sqrt(t*t+1)-t)}function C(e){return(Math.exp(e)-Math.exp(-e))/2}function L(e){return(Math.exp(e)+Math.exp(-e))/2}var I=S(0),O=function(e){return L(I)/L(I+b*e)},P=function(e){return w*((L(I)*(C(t=I+b*e)/L(t))-C(I))/E)/k;var t},D=(S(1)-I)/b;if(Math.abs(k)<1e-6||!isFinite(D)){if(Math.abs(w-T)<1e-6)return this.easeTo(t,r);var R=T<w?-1:1;D=Math.abs(Math.log(T/w))/b,P=function(){return 0},O=function(e){return Math.exp(R*b*e)}}return t.duration="duration"in t?+t.duration:1e3*D/("screenSpeed"in t?+t.screenSpeed/b:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=s!==f,this._pitching=h!==l,this._padding=!i.isPaddingEqual(p),this._prepareEase(r,!1),this._ease(function(t){var a=t*D,d=1/O(a);i.zoom=1===t?c:o+i.scaleZoom(d),n._rotating&&(i.bearing=e.number(s,f,t)),n._pitching&&(i.pitch=e.number(l,h,t)),n._padding&&(i.interpolatePadding(u,p,t),m=i.centerPoint.add(v));var g=1===t?y:i.unproject(x.add(_.mult(P(a))).mult(d));i.setLocationAtPoint(i.renderWorldCopies?g.wrap():g,m),n._fireMoveEvents(r)},function(){return n._afterEase(r)},t),this},r.prototype.isEasing=function(){return!!this._easeFrameId},r.prototype.stop=function(){return this._stop()},r.prototype._stop=function(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,t)}if(!e){var n=this.handlers;n&&n.stop()}return this},r.prototype._ease=function(t,r,n){!1===n.animate||0===n.duration?(t(1),r()):(this._easeStart=e.browser.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},r.prototype._renderFrameCallback=function(){var t=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},r.prototype._normalizeBearing=function(t,r){t=e.wrap(t,-180,180);var n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t},r.prototype._normalizeCenter=function(e){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}},r}(e.Evented),ga=function(t){void 0===t&&(t={}),this.options=t,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};ga.prototype.getDefaultPosition=function(){return"bottom-right"},ga.prototype.onAdd=function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=r.create("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ga.prototype.onRemove=function(){r.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ga.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var n=r.reduce(function(e,t,n){return t.value&&(e+=t.key+"="+t.value+(n<r.length-1?"&":"")),e},"?");t.href=e.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},ga.prototype._updateData=function(e){!e||"metadata"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())},ga.prototype._updateAttributions=function(){if(this._map.style){var e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(function(e){return"string"!=typeof e?"":e})):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var r=this._map.style.sourceCaches;for(var n in r){var a=r[n];if(a.used){var i=a.getSource();i.attribution&&e.indexOf(i.attribution)<0&&e.push(i.attribution)}}e.sort(function(e,t){return e.length-t.length});var o=(e=e.filter(function(t,r){for(var n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0})).join(" | ");o!==this._attribHTML&&(this._attribHTML=o,e.length?(this._innerContainer.innerHTML=o,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ga.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ya=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};ya.prototype.onAdd=function(e){this._map=e,this._container=r.create("div","mapboxgl-ctrl");var t=r.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ya.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ya.prototype.getDefaultPosition=function(){return"bottom-left"},ya.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ya.prototype._logoRequired=function(){if(this._map.style){var e=this._map.style.sourceCaches;for(var t in e)if(e[t].getSource().mapbox_logo)return!0;return!1}},ya.prototype._updateCompact=function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}};var xa=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xa.prototype.add=function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t},xa.prototype.remove=function(e){for(var t=this._currentlyRunning,r=0,n=t?this._queue.concat(t):this._queue;r<n.length;r+=1){var a=n[r];if(a.id===e)return void(a.cancelled=!0)}},xa.prototype.run=function(e){void 0===e&&(e=0);var t=this._currentlyRunning=this._queue;this._queue=[];for(var r=0,n=t;r<n.length;r+=1){var a=n[r];if(!a.cancelled&&(a.callback(e),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xa.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var _a={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ba=e.window.HTMLImageElement,wa=e.window.HTMLElement,Ta=e.window.ImageBitmap,ka={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Aa=function(n){function a(t){var r=this;if(null!=(t=e.extend({},ka,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var a=new wn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);if(n.call(this,a,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new xa,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},_a,t.locale),this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken),"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.")}else{if(!(t.container instanceof wa))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return r._update(!1)}),this.on("moveend",function(){return r._update(!1)}),this.on("zoom",function(){return r._update(!0)}),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new va(this,t),this._hash=t.hash&&new kn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new ga({customAttribution:t.customAttribution})),this.addControl(new ya,t.logoPosition),this.on("style.load",function(){r.transform.unmodified&&r.jumpTo(r.style.stylesheet)}),this.on("data",function(t){r._update("style"===t.dataType),r.fire(new e.Event(t.dataType+"data",t))}),this.on("dataloading",function(t){r.fire(new e.Event(t.dataType+"dataloading",t))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var i={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(t,r){if(void 0===r&&t.getDefaultPosition&&(r=t.getDefaultPosition()),void 0===r&&(r="top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var n=t.onAdd(this);this._controls.push(t);var a=this._controlPositions[r];return-1!==r.indexOf("bottom")?a.insertBefore(n,a.firstChild):a.appendChild(n),this},a.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(t);return r>-1&&this._controls.splice(r,1),t.onRemove(this),this},a.prototype.resize=function(t){var r=this._containerDimensions(),n=r[0],a=r[1];this._resizeCanvas(n,a),this.transform.resize(n,a),this.painter.resize(n,a);var i=!this._moving;return i&&(this.stop(),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t))),this.fire(new e.Event("resize",t)),i&&this.fire(new e.Event("moveend",t)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()},a.prototype.setMinZoom=function(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(e){if((e=null==e?60:e)>60)throw new Error("maxPitch must be less than or equal to 60");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update()},a.prototype.project=function(t){return this.transform.locationPoint(e.LngLat.convert(t))},a.prototype.unproject=function(t){return this.transform.pointLocation(e.Point.convert(t))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(e,t,r){var n,a=this;if("mouseenter"===e||"mouseover"===e){var i=!1;return{layer:t,listener:r,delegates:{mousemove:function(n){var o=a.getLayer(t)?a.queryRenderedFeatures(n.point,{layers:[t]}):[];o.length?i||(i=!0,r.call(a,new Pn(e,a,n.originalEvent,{features:o}))):i=!1},mouseout:function(){i=!1}}}}if("mouseleave"===e||"mouseout"===e){var o=!1;return{layer:t,listener:r,delegates:{mousemove:function(n){(a.getLayer(t)?a.queryRenderedFeatures(n.point,{layers:[t]}):[]).length?o=!0:o&&(o=!1,r.call(a,new Pn(e,a,n.originalEvent)))},mouseout:function(t){o&&(o=!1,r.call(a,new Pn(e,a,t.originalEvent)))}}}}return{layer:t,listener:r,delegates:(n={},n[e]=function(e){var n=a.getLayer(t)?a.queryRenderedFeatures(e.point,{layers:[t]}):[];n.length&&(e.features=n,r.call(a,e),delete e.features)},n)}},a.prototype.on=function(e,t,r){if(void 0===r)return n.prototype.on.call(this,e,t);var a=this._createDelegatedListener(e,t,r);for(var i in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(a),a.delegates)this.on(i,a.delegates[i]);return this},a.prototype.once=function(e,t,r){if(void 0===r)return n.prototype.once.call(this,e,t);var a=this._createDelegatedListener(e,t,r);for(var i in a.delegates)this.once(i,a.delegates[i]);return this},a.prototype.off=function(e,t,r){var a=this;return void 0===r?n.prototype.off.call(this,e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&function(n){for(var i=n[e],o=0;o<i.length;o++){var s=i[o];if(s.layer===t&&s.listener===r){for(var l in s.delegates)a.off(l,s.delegates[l]);return i.splice(o,1),a}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(t,r){if(!this.style)return[];var n;if(void 0!==r||void 0===t||t instanceof e.Point||Array.isArray(t)||(r=t,t=void 0),r=r||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof t[0])n=[e.Point.convert(t)];else{var a=e.Point.convert(t[0]),i=e.Point.convert(t[1]);n=[a,new e.Point(i.x,a.y),i,new e.Point(a.x,i.y),a]}return this.style.queryRenderedFeatures(n,r,this.transform)},a.prototype.querySourceFeatures=function(e,t){return this.style.querySourceFeatures(e,t)},a.prototype.setStyle=function(t,r){return!1!==(r=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(t,r))},a.prototype._getUIString=function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '"+e+"'");return t},a.prototype._updateStyle=function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Vt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Vt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(t,r){var n=this;if("string"==typeof t){var a=this._requestManager.normalizeStyleURL(t),i=this._requestManager.transformRequest(a,e.ResourceType.Style);e.getJSON(i,function(t,a){t?n.fire(new e.ErrorEvent(t)):a&&n._updateDiff(a,r)})}else"object"==typeof t&&this._updateDiff(t,r)},a.prototype._updateDiff=function(t,r){try{this.style.setState(t)&&this._update(!0)}catch(n){e.warnOnce("Unable to perform style diff: "+(n.message||n.error||n)+".  Rebuilding the style from scratch."),this._updateStyle(t,r)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)},a.prototype.isSourceLoaded=function(t){var r=this.style&&this.style.sourceCaches[t];if(void 0!==r)return r.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},a.prototype.areTilesLoaded=function(){var e=this.style&&this.style.sourceCaches;for(var t in e){var r=e[t]._tiles;for(var n in r){var a=r[n];if("loaded"!==a.state&&"errored"!==a.state)return!1}}return!0},a.prototype.addSourceType=function(e,t,r){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)},a.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0)},a.prototype.getSource=function(e){return this.style.getSource(e)},a.prototype.addImage=function(t,r,n){void 0===n&&(n={});var a=n.pixelRatio;void 0===a&&(a=1);var i=n.sdf;void 0===i&&(i=!1);var o=n.stretchX,s=n.stretchY,l=n.content;if(this._lazyInitEmptyStyle(),r instanceof ba||Ta&&r instanceof Ta){var u=e.browser.getImageData(r);this.style.addImage(t,{data:new e.RGBAImage({width:u.width,height:u.height},u.data),pixelRatio:a,stretchX:o,stretchY:s,content:l,sdf:i,version:0})}else{if(void 0===r.width||void 0===r.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=r;this.style.addImage(t,{data:new e.RGBAImage({width:r.width,height:r.height},new Uint8Array(r.data)),pixelRatio:a,stretchX:o,stretchY:s,content:l,sdf:i,version:0,userImage:c}),c.onAdd&&c.onAdd(this,t)}},a.prototype.updateImage=function(t,r){var n=this.style.getImage(t);if(!n)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var a=r instanceof ba||Ta&&r instanceof Ta?e.browser.getImageData(r):r,i=a.width,o=a.height,s=a.data;return void 0===i||void 0===o?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):i!==n.data.width||o!==n.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(n.data.replace(s,!(r instanceof ba||Ta&&r instanceof Ta)),void this.style.updateImage(t,n))},a.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(e){this.style.removeImage(e)},a.prototype.loadImage=function(t,r){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),r)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)},a.prototype.moveLayer=function(e,t){return this.style.moveLayer(e,t),this._update(!0)},a.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0)},a.prototype.getLayer=function(e){return this.style.getLayer(e)},a.prototype.setLayerZoomRange=function(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)},a.prototype.setFilter=function(e,t,r){return void 0===r&&(r={}),this.style.setFilter(e,t,r),this._update(!0)},a.prototype.getFilter=function(e){return this.style.getFilter(e)},a.prototype.setPaintProperty=function(e,t,r,n){return void 0===n&&(n={}),this.style.setPaintProperty(e,t,r,n),this._update(!0)},a.prototype.getPaintProperty=function(e,t){return this.style.getPaintProperty(e,t)},a.prototype.setLayoutProperty=function(e,t,r,n){return void 0===n&&(n={}),this.style.setLayoutProperty(e,t,r,n),this._update(!0)},a.prototype.getLayoutProperty=function(e,t){return this.style.getLayoutProperty(e,t)},a.prototype.setLight=function(e,t){return void 0===t&&(t={}),this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(e,t){return this.style.setFeatureState(e,t),this._update()},a.prototype.removeFeatureState=function(e,t){return this.style.removeFeatureState(e,t),this._update()},a.prototype.getFeatureState=function(e){return this.style.getFeatureState(e)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]},a.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=r.create("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var a=this._controlContainer=r.create("div","mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(e){i[e]=r.create("div","mapboxgl-ctrl-"+e,a)})},a.prototype._resizeCanvas=function(t,r){var n=e.browser.devicePixelRatio||1;this._canvas.width=n*t,this._canvas.height=n*r,this._canvas.style.width=t+"px",this._canvas.style.height=r+"px"},a.prototype._setupPainter=function(){var r=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?(this.painter=new yn(n,this.transform),e.webpSupported.testSupport(n)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))},a.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},a.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},a.prototype._render=function(t){var r,n=this,a=0,i=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,r),a=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),!this._removed){var o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=e.browser.now();this.style.zoomHistory.update(s,l);var u=new e.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(o=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var f=e.browser.now()-a;i.endQueryEXT(i.TIME_ELAPSED_EXT,r),setTimeout(function(){var t=i.getQueryObjectEXT(r,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r),n.fire(new e.Event("gpu-timing-frame",{cpuTime:f,gpuTime:t}))},50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout(function(){var t=n.painter.queryGpuTimers(h);n.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,r=this._controls;t<r.length;t+=1)r[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),Ma(this._canvasContainer),Ma(this._controlContainer),Ma(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},a.prototype.triggerRepaint=function(){var t=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(e){t._frame=null,t._render(e)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(e){this._trackResize&&this.resize({originalEvent:e})._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},i.showPadding.get=function(){return!!this._showPadding},i.showPadding.set=function(e){this._showPadding!==e&&(this._showPadding=e,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(e){this._vertices=e,this._update()},a.prototype._setCacheLimits=function(t,r){e.setCacheLimits(t,r)},i.version.get=function(){return e.version},Object.defineProperties(a.prototype,i),a}(ma);function Ma(e){e.parentNode&&e.parentNode.removeChild(e)}var Ea={showCompass:!0,showZoom:!0,visualizePitch:!1},Sa=function(t){var n=this;this.options=e.extend({},Ea,t),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(e){return n._map.zoomIn({},{originalEvent:e})}),r.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(e){return n._map.zoomOut({},{originalEvent:e})}),r.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(e){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:e}):n._map.resetNorth({},{originalEvent:e})}),this._compassIcon=r.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Sa.prototype._updateZoomButtons=function(){var e=this._map.getZoom();this._zoomInButton.disabled=e===this._map.getMaxZoom(),this._zoomOutButton.disabled=e===this._map.getMinZoom()},Sa.prototype._rotateCompassArrow=function(){var e=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=e},Sa.prototype.onAdd=function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ca(this._map,this._compass,this.options.visualizePitch)),this._container},Sa.prototype.onRemove=function(){r.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Sa.prototype._createButton=function(e,t){var n=r.create("button",e,this._container);return n.type="button",n.addEventListener("click",t),n},Sa.prototype._setButtonTitle=function(e,t){var r=this._map._getUIString("NavigationControl."+t);e.title=r,e.setAttribute("aria-label",r)};var Ca=function(t,n,a){void 0===a&&(a=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new qn({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,a&&(this.mousePitch=new Yn({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener(n,"mousedown",this.mousedown),r.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),r.addEventListener(n,"touchmove",this.touchmove),r.addEventListener(n,"touchend",this.touchend),r.addEventListener(n,"touchcancel",this.reset)};function La(t,r,n){if(t=new e.LngLat(t.lng,t.lat),r){var a=new e.LngLat(t.lng-360,t.lat),i=new e.LngLat(t.lng+360,t.lat),o=n.locationPoint(t).distSqr(r);n.locationPoint(a).distSqr(r)<o?t=a:n.locationPoint(i).distSqr(r)<o&&(t=i)}for(;Math.abs(t.lng-n.center.lng)>180;){var s=n.locationPoint(t);if(s.x>=0&&s.y>=0&&s.x<=n.width&&s.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}Ca.prototype.down=function(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),r.disableDrag()},Ca.prototype.move=function(e,t){var r=this.map,n=this.mouseRotate.mousemoveWindow(e,t);if(n&&n.bearingDelta&&r.setBearing(r.getBearing()+n.bearingDelta),this.mousePitch){var a=this.mousePitch.mousemoveWindow(e,t);a&&a.pitchDelta&&r.setPitch(r.getPitch()+a.pitchDelta)}},Ca.prototype.off=function(){var e=this.element;r.removeEventListener(e,"mousedown",this.mousedown),r.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),r.removeEventListener(e,"touchmove",this.touchmove),r.removeEventListener(e,"touchend",this.touchend),r.removeEventListener(e,"touchcancel",this.reset),this.offTemp()},Ca.prototype.offTemp=function(){r.enableDrag(),r.removeEventListener(e.window,"mousemove",this.mousemove),r.removeEventListener(e.window,"mouseup",this.mouseup)},Ca.prototype.mousedown=function(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),r.mousePos(this.element,t)),r.addEventListener(e.window,"mousemove",this.mousemove),r.addEventListener(e.window,"mouseup",this.mouseup)},Ca.prototype.mousemove=function(e){this.move(e,r.mousePos(this.element,e))},Ca.prototype.mouseup=function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()},Ca.prototype.touchstart=function(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=r.touchPos(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos))},Ca.prototype.touchmove=function(e){1!==e.targetTouches.length?this.reset():(this._lastPos=r.touchPos(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos))},Ca.prototype.touchend=function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ca.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ia={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Oa(e,t,r){var n=e.classList;for(var a in Ia)n.remove("mapboxgl-"+r+"-anchor-"+a);n.add("mapboxgl-"+r+"-anchor-"+t)}var Pa,Da=function(t){function n(n,a){var i=this;if(t.call(this),(n instanceof e.window.HTMLElement||a)&&(n=e.extend({element:n},a)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._draggable=n&&n.draggable||!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&"auto"!==n.pitchAlignment?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=e.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div"),this._element.setAttribute("aria-label","Map marker");var o=r.createNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","41px"),o.setAttributeNS(null,"width","27px"),o.setAttributeNS(null,"viewBox","0 0 27 41");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");var l=r.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill-rule","nonzero");var u=r.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"transform","translate(3.0, 29.0)"),u.setAttributeNS(null,"fill","#000000");for(var c=0,f=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];c<f.length;c+=1){var h=f[c],p=r.createNS("http://www.w3.org/2000/svg","ellipse");p.setAttributeNS(null,"opacity","0.04"),p.setAttributeNS(null,"cx","10.5"),p.setAttributeNS(null,"cy","5.80029008"),p.setAttributeNS(null,"rx",h.rx),p.setAttributeNS(null,"ry",h.ry),u.appendChild(p)}var d=r.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var v=r.createNS("http://www.w3.org/2000/svg","path");v.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(v);var m=r.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"fill","#000000");var g=r.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),m.appendChild(g);var y=r.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),y.setAttributeNS(null,"fill","#FFFFFF");var x=r.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=r.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000"),_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962");var b=r.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#FFFFFF"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962"),x.appendChild(_),x.appendChild(b),l.appendChild(u),l.appendChild(d),l.appendChild(m),l.appendChild(y),l.appendChild(x),o.appendChild(l),this._element.appendChild(o),this._offset=e.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(e){e.preventDefault()}),this._element.addEventListener("mousedown",function(e){e.preventDefault()}),this._element.addEventListener("focus",function(){var e=i._map.getContainer();e.scrollTop=0,e.scrollLeft=0}),Oa(this._element,this._anchor,"marker"),this._popup=null}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},n.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},n.prototype.getElement=function(){return this._element},n.prototype.setPopup=function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},n.prototype._onKeyPress=function(e){var t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},n.prototype._onMapClick=function(e){var t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},n.prototype.getPopup=function(){return this._popup},n.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},n.prototype._update=function(e){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=La(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var t="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?t="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(t="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n="rotateX("+this._map.getPitch()+"deg)"),e&&"moveend"!==e.type||(this._pos=this._pos.round()),r.setTransform(this._element,Ia[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+n+" "+t)}},n.prototype.getOffset=function(){return this._offset},n.prototype.setOffset=function(t){return this._offset=e.Point.convert(t),this._update(),this},n.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},n.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},n.prototype._addDragHandler=function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},n.prototype.setDraggable=function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},n.prototype.isDraggable=function(){return this._draggable},n.prototype.setRotation=function(e){return this._rotation=e||0,this._update(),this},n.prototype.getRotation=function(){return this._rotation},n.prototype.setRotationAlignment=function(e){return this._rotationAlignment=e||"auto",this._update(),this},n.prototype.getRotationAlignment=function(){return this._rotationAlignment},n.prototype.setPitchAlignment=function(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this},n.prototype.getPitchAlignment=function(){return this._pitchAlignment},n}(e.Evented),Ra={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},za=0,Na=!1,Fa=function(t){function n(r){t.call(this),this.options=e.extend({},Ra,r),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.onAdd=function(t){var n;return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==Pa?n(Pa):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then(function(e){n(Pa="denied"!==e.state)}):n(Pa=!!e.window.navigator.geolocation),this._container},n.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),r.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,za=0,Na=!1},n.prototype._isOutOfMapMaxBounds=function(e){var t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())},n.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},n.prototype._onSuccess=function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}},n.prototype._updateCamera=function(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,a=this._map.getBearing(),i=e.extend({bearing:a},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(n),i,{geolocateSource:!0})},n.prototype._updateMarker=function(t){if(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},n.prototype._updateCircleRadius=function(){var e=this._map._container.clientHeight/2,t=this._map.unproject([0,e]),r=this._map.unproject([1,e]),n=t.distanceTo(r),a=Math.ceil(2*this._accuracy/n);this._circleElement.style.width=a+"px",this._circleElement.style.height=a+"px"},n.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},n.prototype._onError=function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Na)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}},n.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},n.prototype._setupUI=function(t){var n=this;if(this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this._geolocateButton=r.create("button","mapboxgl-ctrl-geolocate",this._container),r.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{var i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Da(this._dotElement),this._circleElement=r.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Da({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==n._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new e.Event("trackuserlocationend")))})},n.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":za--,Na=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++za>1?(t={maximumAge:6e5,timeout:0},Na=!0):(t=this.options.positionOptions,Na=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},n.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},n}(e.Evented),Ba={maxWidth:100,unit:"metric"},ja=function(t){this.options=e.extend({},Ba,t),e.bindAll(["_onMove","setUnit"],this)};function Ua(e,t,r){var n=r&&r.maxWidth||100,a=e._container.clientHeight/2,i=e.unproject([0,a]),o=e.unproject([n,a]),s=i.distanceTo(o);if(r&&"imperial"===r.unit){var l=3.2808*s;l>5280?Ha(t,n,l/5280,e._getUIString("ScaleControl.Miles")):Ha(t,n,l,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?Ha(t,n,s/1852,e._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Ha(t,n,s/1e3,e._getUIString("ScaleControl.Kilometers")):Ha(t,n,s,e._getUIString("ScaleControl.Meters"))}function Ha(e,t,r,n){var a,i,o,s=(a=r,(i=Math.pow(10,(""+Math.floor(a)).length-1))*(o=(o=a/i)>=10?10:o>=5?5:o>=3?3:o>=2?2:o>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(o)));e.style.width=t*(s/r)+"px",e.innerHTML=s+"&nbsp;"+n}ja.prototype.getDefaultPosition=function(){return"bottom-left"},ja.prototype._onMove=function(){Ua(this._map,this._container,this.options)},ja.prototype.onAdd=function(e){return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ja.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ja.prototype.setUnit=function(e){this.options.unit=e,Ua(this._map,this._container,this.options)};var Va=function(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Va.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Va.prototype.onRemove=function(){r.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Va.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Va.prototype._setupUI=function(){var t=this._fullscreenButton=r.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Va.prototype._updateTitle=function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e},Va.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Va.prototype._isFullscreen=function(){return this._fullscreen},Va.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Va.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ga={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},qa=function(t){function n(r){t.call(this),this.options=e.extend(Object.create(Ga),r),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.addTo=function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},n.prototype.isOpen=function(){return!!this._map},n.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},n.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},n.prototype.getElement=function(){return this._container},n.prototype.setText=function(t){return this.setDOMContent(e.window.document.createTextNode(t))},n.prototype.setHTML=function(t){var r,n=e.window.document.createDocumentFragment(),a=e.window.document.createElement("body");for(a.innerHTML=t;r=a.firstChild;)n.appendChild(r);return this.setDOMContent(n)},n.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},n.prototype.setMaxWidth=function(e){return this.options.maxWidth=e,this._update(),this},n.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},n.prototype.addClassName=function(e){this._container&&this._container.classList.add(e)},n.prototype.removeClassName=function(e){this._container&&this._container.classList.remove(e)},n.prototype.toggleClassName=function(e){if(this._container)return this._container.classList.toggle(e)},n.prototype._createContent=function(){this._content&&r.remove(this._content),this._content=r.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},n.prototype._onMouseUp=function(e){this._update(e.point)},n.prototype._onMouseMove=function(e){this._update(e.point)},n.prototype._onDrag=function(e){this._update(e.point)},n.prototype._update=function(t){var n=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(e){return n._container.classList.add(e)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=La(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var a=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),i=this.options.anchor,o=function t(r){if(r){if("number"==typeof r){var n=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new e.Point(0,0),top:new e.Point(0,r),"top-left":new e.Point(n,n),"top-right":new e.Point(-n,n),bottom:new e.Point(0,-r),"bottom-left":new e.Point(n,-n),"bottom-right":new e.Point(-n,-n),left:new e.Point(r,0),right:new e.Point(-r,0)}}if(r instanceof e.Point||Array.isArray(r)){var a=e.Point.convert(r);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:e.Point.convert(r.center||[0,0]),top:e.Point.convert(r.top||[0,0]),"top-left":e.Point.convert(r["top-left"]||[0,0]),"top-right":e.Point.convert(r["top-right"]||[0,0]),bottom:e.Point.convert(r.bottom||[0,0]),"bottom-left":e.Point.convert(r["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(r["bottom-right"]||[0,0]),left:e.Point.convert(r.left||[0,0]),right:e.Point.convert(r.right||[0,0])}}return t(new e.Point(0,0))}(this.options.offset);if(!i){var s,l=this._container.offsetWidth,u=this._container.offsetHeight;s=a.y+o.bottom.y<u?["top"]:a.y>this._map.transform.height-u?["bottom"]:[],a.x<l/2?s.push("left"):a.x>this._map.transform.width-l/2&&s.push("right"),i=0===s.length?"bottom":s.join("-")}var c=a.add(o[i]).round();r.setTransform(this._container,Ia[i]+" translate("+c.x+"px,"+c.y+"px)"),Oa(this._container,i,"popup")}},n.prototype._onClose=function(){this.remove()},n}(e.Evented),Ya={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Aa,NavigationControl:Sa,GeolocateControl:Fa,AttributionControl:ga,ScaleControl:ja,FullscreenControl:Va,Popup:qa,Marker:Da,Style:Vt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){Fe().acquire(De)},clearPrewarmedResources:function(){var e=ze;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(De),ze=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Re.workerCount},set workerCount(e){Re.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:""};return Ya});return r})},{}],474:[function(e,t,r){"use strict";t.exports=o;var n=e("convex-hull");function a(e,t,r){var n=new Array(e);for(var a=0;a<e;++a){n[a]=0;if(a===t){n[a]+=.5}if(a===r){n[a]+=.5}}return n}function i(e,t){if(t===0||t===(1<<e+1)-1){return[]}var r=[];var i=[];for(var o=0;o<=e;++o){if(t&1<<o){r.push(a(e,o-1,o-1));i.push(null);for(var s=0;s<=e;++s){if(~t&1<<s){r.push(a(e,o-1,s-1));i.push([o,s])}}}}var l=n(r);var u=[];e:for(var o=0;o<l.length;++o){var c=l[o];var f=[];for(var s=0;s<c.length;++s){if(!i[c[s]]){continue e}f.push(i[c[s]].slice())}u.push(f)}return u}function o(e){var t=1<<e+1;var r=new Array(t);for(var n=0;n<t;++n){r[n]=i(e,n)}return r}},{"convex-hull":135}],475:[function(e,t,r){var n=e("./normalize");var a=e("gl-mat4/create");var i=e("gl-mat4/clone");var o=e("gl-mat4/determinant");var s=e("gl-mat4/invert");var l=e("gl-mat4/transpose");var u={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")};var c=a();var f=a();var h=[0,0,0,0];var p=[[0,0,0],[0,0,0],[0,0,0]];var d=[0,0,0];t.exports=function e(t,r,a,y,x,_){if(!r)r=[0,0,0];if(!a)a=[0,0,0];if(!y)y=[0,0,0];if(!x)x=[0,0,0,1];if(!_)_=[0,0,0,1];if(!n(c,t))return false;i(f,c);f[3]=0;f[7]=0;f[11]=0;f[15]=1;if(Math.abs(o(f)<1e-8))return false;var b=c[3],w=c[7],T=c[11],k=c[12],A=c[13],M=c[14],E=c[15];if(b!==0||w!==0||T!==0){h[0]=b;h[1]=w;h[2]=T;h[3]=E;var S=s(f,f);if(!S)return false;l(f,f);v(x,h,f)}else{x[0]=x[1]=x[2]=0;x[3]=1}r[0]=k;r[1]=A;r[2]=M;m(p,c);a[0]=u.length(p[0]);u.normalize(p[0],p[0]);y[0]=u.dot(p[0],p[1]);g(p[1],p[1],p[0],1,-y[0]);a[1]=u.length(p[1]);u.normalize(p[1],p[1]);y[0]/=a[1];y[1]=u.dot(p[0],p[2]);g(p[2],p[2],p[0],1,-y[1]);y[2]=u.dot(p[1],p[2]);g(p[2],p[2],p[1],1,-y[2]);a[2]=u.length(p[2]);u.normalize(p[2],p[2]);y[1]/=a[2];y[2]/=a[2];u.cross(d,p[1],p[2]);if(u.dot(p[0],d)<0){for(var C=0;C<3;C++){a[C]*=-1;p[C][0]*=-1;p[C][1]*=-1;p[C][2]*=-1}}_[0]=.5*Math.sqrt(Math.max(1+p[0][0]-p[1][1]-p[2][2],0));_[1]=.5*Math.sqrt(Math.max(1-p[0][0]+p[1][1]-p[2][2],0));_[2]=.5*Math.sqrt(Math.max(1-p[0][0]-p[1][1]+p[2][2],0));_[3]=.5*Math.sqrt(Math.max(1+p[0][0]+p[1][1]+p[2][2],0));if(p[2][1]>p[1][2])_[0]=-_[0];if(p[0][2]>p[2][0])_[1]=-_[1];if(p[1][0]>p[0][1])_[2]=-_[2];return true};function v(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o;e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o;e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o;e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o;return e}function m(e,t){e[0][0]=t[0];e[0][1]=t[1];e[0][2]=t[2];e[1][0]=t[4];e[1][1]=t[5];e[1][2]=t[6];e[2][0]=t[8];e[2][1]=t[9];e[2][2]=t[10]}function g(e,t,r,n,a){e[0]=t[0]*n+r[0]*a;e[1]=t[1]*n+r[1]*a;e[2]=t[2]*n+r[2]*a}},{"./normalize":476,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":365,"gl-vec3/dot":370,"gl-vec3/length":380,"gl-vec3/normalize":387}],476:[function(e,t,r){t.exports=function e(t,r){var n=r[15];if(n===0)return false;var a=1/n;for(var i=0;i<16;i++)t[i]=r[i]*a;return true}},{}],477:[function(e,t,r){var n=e("gl-vec3/lerp");var a=e("mat4-recompose");var i=e("mat4-decompose");var o=e("gl-mat4/determinant");var s=e("quat-slerp");var l=h();var u=h();var c=h();t.exports=f;function f(e,t,r,f){if(o(t)===0||o(r)===0)return false;var h=i(t,l.translate,l.scale,l.skew,l.perspective,l.quaternion);var p=i(r,u.translate,u.scale,u.skew,u.perspective,u.quaternion);if(!h||!p)return false;n(c.translate,l.translate,u.translate,f);n(c.skew,l.skew,u.skew,f);n(c.scale,l.scale,u.scale,f);n(c.perspective,l.perspective,u.perspective,f);s(c.quaternion,l.quaternion,u.quaternion,f);a(e,c.translate,c.scale,c.skew,c.perspective,c.quaternion);return true}function h(){return{translate:p(),scale:p(1),skew:p(),perspective:d(),quaternion:d()}}function p(e){return[e||0,e||0,e||0]}function d(){return[0,0,0,1]}},{"gl-mat4/determinant":281,"gl-vec3/lerp":381,"mat4-decompose":475,"mat4-recompose":478,"quat-slerp":527}],478:[function(e,t,r){var n={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")};var a=n.create();var i=n.create();t.exports=function e(t,r,a,o,s,l){n.identity(t);n.fromRotationTranslation(t,l,r);t[3]=s[0];t[7]=s[1];t[11]=s[2];t[15]=s[3];n.identity(i);if(o[2]!==0){i[9]=o[2];n.multiply(t,t,i)}if(o[1]!==0){i[9]=0;i[8]=o[1];n.multiply(t,t,i)}if(o[0]!==0){i[8]=0;i[4]=o[0];n.multiply(t,t,i)}n.scale(t,t,a);return t}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],479:[function(e,t,r){"use strict";t.exports=Math.log2||function(e){return Math.log(e)*Math.LOG2E}},{}],480:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var a=e("mat4-interpolate");var i=e("gl-mat4/invert");var o=e("gl-mat4/rotateX");var s=e("gl-mat4/rotateY");var l=e("gl-mat4/rotateZ");var u=e("gl-mat4/lookAt");var c=e("gl-mat4/translate");var f=e("gl-mat4/scale");var h=e("gl-vec3/normalize");var p=[0,0,0];t.exports=g;function d(e){this._components=e.slice();this._time=[0];this.prevMatrix=e.slice();this.nextMatrix=e.slice();this.computedMatrix=e.slice();this.computedInverse=e.slice();this.computedEye=[0,0,0];this.computedUp=[0,0,0];this.computedCenter=[0,0,0];this.computedRadius=[0];this._limits=[-Infinity,Infinity]}var v=d.prototype;v.recalcMatrix=function(e){var t=this._time;var r=n.le(t,e);var o=this.computedMatrix;if(r<0){return}var s=this._components;if(r===t.length-1){var l=16*r;for(var u=0;u<16;++u){o[u]=s[l++]}}else{var c=t[r+1]-t[r];var l=16*r;var f=this.prevMatrix;var p=true;for(var u=0;u<16;++u){f[u]=s[l++]}var d=this.nextMatrix;for(var u=0;u<16;++u){d[u]=s[l++];p=p&&f[u]===d[u]}if(c<1e-6||p){for(var u=0;u<16;++u){o[u]=f[u]}}else{a(o,f,d,(e-t[r])/c)}}var v=this.computedUp;v[0]=o[1];v[1]=o[5];v[2]=o[9];h(v,v);var m=this.computedInverse;i(m,o);var g=this.computedEye;var y=m[15];g[0]=m[12]/y;g[1]=m[13]/y;g[2]=m[14]/y;var x=this.computedCenter;var _=Math.exp(this.computedRadius[0]);for(var u=0;u<3;++u){x[u]=g[u]-o[2+4*u]*_}};v.idle=function(e){if(e<this.lastT()){return}var t=this._components;var r=t.length-16;for(var n=0;n<16;++n){t.push(t[r++])}this._time.push(e)};v.flush=function(e){var t=n.gt(this._time,e)-2;if(t<0){return}this._time.splice(0,t);this._components.splice(0,16*t)};v.lastT=function(){return this._time[this._time.length-1]};v.lookAt=function(e,t,r,n){this.recalcMatrix(e);t=t||this.computedEye;r=r||p;n=n||this.computedUp;this.setMatrix(e,u(this.computedMatrix,t,r,n));var a=0;for(var i=0;i<3;++i){a+=Math.pow(r[i]-t[i],2)}a=Math.log(Math.sqrt(a));this.computedRadius[0]=a};v.rotate=function(e,t,r,n){this.recalcMatrix(e);var a=this.computedInverse;if(t)s(a,a,t);if(r)o(a,a,r);if(n)l(a,a,n);this.setMatrix(e,i(this.computedMatrix,a))};var m=[0,0,0];v.pan=function(e,t,r,n){m[0]=-(t||0);m[1]=-(r||0);m[2]=-(n||0);this.recalcMatrix(e);var a=this.computedInverse;c(a,a,m);this.setMatrix(e,i(a,a))};v.translate=function(e,t,r,n){m[0]=t||0;m[1]=r||0;m[2]=n||0;this.recalcMatrix(e);var a=this.computedMatrix;c(a,a,m);this.setMatrix(e,a)};v.setMatrix=function(e,t){if(e<this.lastT()){return}this._time.push(e);for(var r=0;r<16;++r){this._components.push(t[r])}};v.setDistance=function(e,t){this.computedRadius[0]=t};v.setDistanceLimits=function(e,t){var r=this._limits;r[0]=e;r[1]=t};v.getDistanceLimits=function(e){var t=this._limits;if(e){e[0]=t[0];e[1]=t[1];return e}return t};function g(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new d(t)}},{"binary-search-bounds":481,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":387,"mat4-interpolate":477}],481:[function(e,t,r){arguments[4][243][0].apply(r,arguments)},{dup:243}],482:[function(e,t,r){"use strict";t.exports=a;var n=e("robust-orientation")[3];function a(e){var t=e.length;if(t<3){var r=new Array(t);for(var a=0;a<t;++a){r[a]=a}if(t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]){return[0]}return r}var i=new Array(t);for(var a=0;a<t;++a){i[a]=a}i.sort(function(t,r){var n=e[t][0]-e[r][0];if(n){return n}return e[t][1]-e[r][1]});var o=[i[0],i[1]];var s=[i[0],i[1]];for(var a=2;a<t;++a){var l=i[a];var u=e[l];var c=o.length;while(c>1&&n(e[o[c-2]],e[o[c-1]],u)<=0){c-=1;o.pop()}o.push(l);c=s.length;while(c>1&&n(e[s[c-2]],e[s[c-1]],u)>=0){c-=1;s.pop()}s.push(l)}var r=new Array(s.length+o.length-2);var f=0;for(var a=0,h=o.length;a<h;++a){r[f++]=o[a]}for(var p=s.length-2;p>0;--p){r[f++]=s[p]}return r}},{"robust-orientation":548}],483:[function(e,t,r){"use strict";t.exports=a;var n=e("mouse-event");function a(e,t){if(!t){t=e;e=window}var r=0;var a=0;var i=0;var o={shift:false,alt:false,control:false,meta:false};var s=false;function l(e){var t=false;if("altKey"in e){t=t||e.altKey!==o.alt;o.alt=!!e.altKey}if("shiftKey"in e){t=t||e.shiftKey!==o.shift;o.shift=!!e.shiftKey}if("ctrlKey"in e){t=t||e.ctrlKey!==o.control;o.control=!!e.ctrlKey}if("metaKey"in e){t=t||e.metaKey!==o.meta;o.meta=!!e.metaKey}return t}function u(e,s){var u=n.x(s);var c=n.y(s);if("buttons"in s){e=s.buttons|0}if(e!==r||u!==a||c!==i||l(s)){r=e|0;a=u||0;i=c||0;t&&t(r,a,i,o)}}function c(e){u(0,e)}function f(){if(r||a||i||o.shift||o.alt||o.meta||o.control){a=i=0;r=0;o.shift=o.alt=o.control=o.meta=false;t&&t(0,0,0,o)}}function h(e){if(l(e)){t&&t(r,a,i,o)}}function p(e){if(n.buttons(e)===0){u(0,e)}else{u(r,e)}}function d(e){u(r|n.buttons(e),e)}function v(e){u(r&~n.buttons(e),e)}function m(){if(s){return}s=true;e.addEventListener("mousemove",p);e.addEventListener("mousedown",d);e.addEventListener("mouseup",v);e.addEventListener("mouseleave",c);e.addEventListener("mouseenter",c);e.addEventListener("mouseout",c);e.addEventListener("mouseover",c);e.addEventListener("blur",f);e.addEventListener("keyup",h);e.addEventListener("keydown",h);e.addEventListener("keypress",h);if(e!==window){window.addEventListener("blur",f);window.addEventListener("keyup",h);window.addEventListener("keydown",h);window.addEventListener("keypress",h)}}function g(){if(!s){return}s=false;e.removeEventListener("mousemove",p);e.removeEventListener("mousedown",d);e.removeEventListener("mouseup",v);e.removeEventListener("mouseleave",c);e.removeEventListener("mouseenter",c);e.removeEventListener("mouseout",c);e.removeEventListener("mouseover",c);e.removeEventListener("blur",f);e.removeEventListener("keyup",h);e.removeEventListener("keydown",h);e.removeEventListener("keypress",h);if(e!==window){window.removeEventListener("blur",f);window.removeEventListener("keyup",h);window.removeEventListener("keydown",h);window.removeEventListener("keypress",h)}}m();var y={element:e};Object.defineProperties(y,{enabled:{get:function(){return s},set:function(e){if(e){m()}else{g()}},enumerable:true},buttons:{get:function(){return r},enumerable:true},x:{get:function(){return a},enumerable:true},y:{get:function(){return i},enumerable:true},mods:{get:function(){return o},enumerable:true}});return y}},{"mouse-event":485}],484:[function(e,t,r){var n={left:0,top:0};t.exports=a;function a(e,t,r){t=t||e.currentTarget||e.srcElement;if(!Array.isArray(r)){r=[0,0]}var n=e.clientX||0;var a=e.clientY||0;var o=i(t);r[0]=n-o.left;r[1]=a-o.top;return r}function i(e){if(e===window||e===document||e===document.body){return n}else{return e.getBoundingClientRect()}}},{}],485:[function(e,t,r){"use strict";function n(e){if(typeof e==="object"){if("buttons"in e){return e.buttons}else if("which"in e){var t=e.which;if(t===2){return 4}else if(t===3){return 2}else if(t>0){return 1<<t-1}}else if("button"in e){var t=e.button;if(t===1){return 4}else if(t===2){return 2}else if(t>=0){return 1<<t}}}return 0}r.buttons=n;function a(e){return e.target||e.srcElement||window}r.element=a;function i(e){if(typeof e==="object"){if("offsetX"in e){return e.offsetX}var t=a(e);var r=t.getBoundingClientRect();return e.clientX-r.left}return 0}r.x=i;function o(e){if(typeof e==="object"){if("offsetY"in e){return e.offsetY}var t=a(e);var r=t.getBoundingClientRect();return e.clientY-r.top}return 0}r.y=o},{}],486:[function(e,t,r){"use strict";var n=e("to-px");t.exports=a;function a(e,t,r){if(typeof e==="function"){r=!!t;t=e;e=window}var a=n("ex",e);var i=function(e){if(r){e.preventDefault()}var n=e.deltaX||0;var i=e.deltaY||0;var o=e.deltaZ||0;var s=e.deltaMode;var l=1;switch(s){case 1:l=a;break;case 2:l=window.innerHeight;break}n*=l;i*=l;o*=l;if(n||i||o){return t(n,i,o,e)}};e.addEventListener("wheel",i);return i}},{"to-px":578}],487:[function(e,t,r){"use strict";var n=e("typedarray-pool");t.exports=E;function a(e){return"a"+e}function i(e){return"d"+e}function o(e,t){return"c"+e+"_"+t}function s(e){return"s"+e}function l(e,t){return"t"+e+"_"+t}function u(e){return"o"+e}function c(e){return"x"+e}function f(e){return"p"+e}function h(e,t){return"d"+e+"_"+t}function p(e){return"i"+e}function d(e,t){return"u"+e+"_"+t}function v(e){return"b"+e}function m(e){return"y"+e}function g(e){return"e"+e}function y(e){return"v"+e}var x="V";var _="P";var b="N";var w="Q";var T="X";var k="T";function A(e,t,r){var n=0;for(var a=0;a<e;++a){if(t&1<<a){n|=1<<r[a]}}return n}function M(e,t,r,M,E,S){var C=S.length;var L=E.length;if(L<2){throw new Error("ndarray-extract-contour: Dimension must be at least 2")}var I="extractContour"+E.join("_");var O=[];var P=[];var D=[];for(var R=0;R<C;++R){D.push(a(R))}for(var R=0;R<M;++R){D.push(c(R))}for(var R=0;R<L;++R){P.push(s(R)+"="+a(0)+".shape["+R+"]|0")}for(var R=0;R<C;++R){P.push(i(R)+"="+a(R)+".data",u(R)+"="+a(R)+".offset|0");for(var z=0;z<L;++z){P.push(l(R,z)+"="+a(R)+".stride["+z+"]|0")}}for(var R=0;R<C;++R){P.push(f(R)+"="+u(R));P.push(o(R,0));for(var z=1;z<1<<L;++z){var N=[];for(var F=0;F<L;++F){if(z&1<<F){N.push("-"+l(R,F))}}P.push(h(R,z)+"=("+N.join("")+")|0");P.push(o(R,z)+"=0")}}for(var R=0;R<C;++R){for(var z=0;z<L;++z){var B=[l(R,E[z])];if(z>0){B.push(l(R,E[z-1])+"*"+s(E[z-1]))}P.push(d(R,E[z])+"=("+B.join("-")+")|0")}}for(var R=0;R<L;++R){P.push(p(R)+"=0")}P.push(b+"=0");var j=["2"];for(var R=L-2;R>=0;--R){j.push(s(E[R]))}P.push(w+"=("+j.join("*")+")|0",_+"=mallocUint32("+w+")",x+"=mallocUint32("+w+")",T+"=0");P.push(v(0)+"=0");for(var z=1;z<1<<L;++z){var U=[];var H=[];for(var F=0;F<L;++F){if(z&1<<F){if(H.length===0){U.push("1")}else{U.unshift(H.join("*"))}}H.push(s(E[F]))}var V="";if(U[0].indexOf(s(E[L-2]))<0){V="-"}var G=A(L,z,E);P.push(g(G)+"=(-"+U.join("-")+")|0",m(G)+"=("+V+U.join("-")+")|0",v(G)+"=0")}P.push(y(0)+"=0",k+"=0");function q(e,t){O.push("for(",p(E[e]),"=",t,";",p(E[e]),"<",s(E[e]),";","++",p(E[e]),"){")}function Y(e){for(var t=0;t<C;++t){O.push(f(t),"+=",d(t,E[e]),";")}O.push("}")}function W(e){for(var t=e-1;t>=0;--t){q(t,0)}var r=[];for(var t=0;t<C;++t){if(S[t]){r.push(i(t)+".get("+f(t)+")")}else{r.push(i(t)+"["+f(t)+"]")}}for(var t=0;t<M;++t){r.push(c(t))}O.push(_,"[",T,"++]=phase(",r.join(),");");for(var t=0;t<e;++t){Y(t)}for(var n=0;n<C;++n){O.push(f(n),"+=",d(n,E[e]),";")}}function X(e){for(var t=0;t<C;++t){if(S[t]){O.push(o(t,0),"=",i(t),".get(",f(t),");")}else{O.push(o(t,0),"=",i(t),"[",f(t),"];")}}var r=[];for(var t=0;t<C;++t){r.push(o(t,0))}for(var t=0;t<M;++t){r.push(c(t))}O.push(v(0),"=",_,"[",T,"]=phase(",r.join(),");");for(var n=1;n<1<<L;++n){O.push(v(n),"=",_,"[",T,"+",g(n),"];")}var a=[];for(var n=1;n<1<<L;++n){a.push("("+v(0)+"!=="+v(n)+")")}O.push("if(",a.join("||"),"){");var s=[];for(var t=0;t<L;++t){s.push(p(t))}for(var t=0;t<C;++t){s.push(o(t,0));for(var n=1;n<1<<L;++n){if(S[t]){O.push(o(t,n),"=",i(t),".get(",f(t),"+",h(t,n),");")}else{O.push(o(t,n),"=",i(t),"[",f(t),"+",h(t,n),"];")}s.push(o(t,n))}}for(var t=0;t<1<<L;++t){s.push(v(t))}for(var t=0;t<M;++t){s.push(c(t))}O.push("vertex(",s.join(),");",y(0),"=",x,"[",T,"]=",b,"++;");var l=(1<<L)-1;var u=v(l);for(var n=0;n<L;++n){if((e&~(1<<n))===0){var d=l^1<<n;var m=v(d);var w=[];for(var k=d;k>0;k=k-1&d){w.push(x+"["+T+"+"+g(k)+"]")}w.push(y(0));for(var k=0;k<C;++k){if(n&1){w.push(o(k,l),o(k,d))}else{w.push(o(k,d),o(k,l))}}if(n&1){w.push(u,m)}else{w.push(m,u)}for(var k=0;k<M;++k){w.push(c(k))}O.push("if(",u,"!==",m,"){","face(",w.join(),")}")}}O.push("}",T,"+=1;")}function Z(){for(var e=1;e<1<<L;++e){O.push(k,"=",g(e),";",g(e),"=",m(e),";",m(e),"=",k,";")}}function K(e,t){if(e<0){X(t);return}W(e);O.push("if(",s(E[e]),">0){",p(E[e]),"=1;");K(e-1,t|1<<E[e]);for(var r=0;r<C;++r){O.push(f(r),"+=",d(r,E[e]),";")}if(e===L-1){O.push(T,"=0;");Z()}q(e,2);K(e-1,t);if(e===L-1){O.push("if(",p(E[L-1]),"&1){",T,"=0;}");Z()}Y(e);O.push("}")}K(L-1,0);O.push("freeUint32(",x,");freeUint32(",_,");");var J=["'use strict';","function ",I,"(",D.join(),"){","var ",P.join(),";",O.join(""),"}","return ",I].join("");var Q=new Function("vertex","face","phase","mallocUint32","freeUint32",J);return Q(e,t,r,n.mallocUint32,n.freeUint32)}function E(e){function t(e){throw new Error("ndarray-extract-contour: "+e)}if(typeof e!=="object"){t("Must specify arguments")}var r=e.order;if(!Array.isArray(r)){t("Must specify order")}var n=e.arrayArguments||1;if(n<1){t("Must have at least one array argument")}var a=e.scalarArguments||0;if(a<0){t("Scalar arg count must be > 0")}if(typeof e.vertex!=="function"){t("Must specify vertex creation function")}if(typeof e.cell!=="function"){t("Must specify cell creation function")}if(typeof e.phase!=="function"){t("Must specify phase function")}var i=e.getters||[];var o=new Array(n);for(var s=0;s<n;++s){if(i.indexOf(s)>=0){o[s]=true}else{o[s]=false}}return M(e.vertex,e.cell,e.phase,a,r,o)}},{"typedarray-pool":595}],488:[function(e,t,r){"use strict";t.exports=h;var n=e("dup");var a=e("cwise-compiler");var i={};var o={};var s={body:"",args:[],thisVars:[],localVars:[]};var l=a({args:["array","array","array"],pre:s,post:s,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1},{name:"left",lvalue:false,rvalue:true,count:1},{name:"right",lvalue:false,rvalue:true,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"});var u=a({args:["array"],pre:s,post:s,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function c(e){if(e in i){return i[e]}var t=[];for(var r=0;r<e;++r){t.push("out",r,"s=0.5*(inp",r,"l-inp",r,"r);")}var o=["array"];var l=["junk"];for(var r=0;r<e;++r){o.push("array");l.push("out"+r+"s");var u=n(e);u[r]=-1;o.push({array:0,offset:u.slice()});u[r]=1;o.push({array:0,offset:u.slice()});l.push("inp"+r+"l","inp"+r+"r")}return i[e]=a({args:o,pre:s,post:s,body:{body:t.join(""),args:l.map(function(e){return{name:e,lvalue:e.indexOf("out")===0,rvalue:e.indexOf("inp")===0,count:e!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+e})}function f(e){var t=e.join();var r=o[t];if(r){return r}var n=e.length;var a=["function gradient(dst,src){var s=src.shape.slice();"];function s(t){var r=n-t.length;var i=[];var o=[];var s=[];for(var l=0;l<n;++l){if(t.indexOf(l+1)>=0){s.push("0")}else if(t.indexOf(-(l+1))>=0){s.push("s["+l+"]-1")}else{s.push("-1");i.push("1");o.push("s["+l+"]-2")}}var u=".lo("+i.join()+").hi("+o.join()+")";if(i.length===0){u=""}if(r>0){a.push("if(1");for(var l=0;l<n;++l){if(t.indexOf(l+1)>=0||t.indexOf(-(l+1))>=0){continue}a.push("&&s[",l,"]>2")}a.push("){grad",r,"(src.pick(",s.join(),")",u);for(var l=0;l<n;++l){if(t.indexOf(l+1)>=0||t.indexOf(-(l+1))>=0){continue}a.push(",dst.pick(",s.join(),",",l,")",u)}a.push(");")}for(var l=0;l<t.length;++l){var c=Math.abs(t[l])-1;var f="dst.pick("+s.join()+","+c+")"+u;switch(e[c]){case"clamp":var h=s.slice();var p=s.slice();if(t[l]<0){h[c]="s["+c+"]-2"}else{p[c]="1"}if(r===0){a.push("if(s[",c,"]>1){dst.set(",s.join(),",",c,",0.5*(src.get(",h.join(),")-src.get(",p.join(),")))}else{dst.set(",s.join(),",",c,",0)};")}else{a.push("if(s[",c,"]>1){diff(",f,",src.pick(",h.join(),")",u,",src.pick(",p.join(),")",u,");}else{zero(",f,");};")}break;case"mirror":if(r===0){a.push("dst.set(",s.join(),",",c,",0);")}else{a.push("zero(",f,");")}break;case"wrap":var d=s.slice();var v=s.slice();if(t[l]<0){d[c]="s["+c+"]-2";v[c]="0"}else{d[c]="s["+c+"]-1";v[c]="1"}if(r===0){a.push("if(s[",c,"]>2){dst.set(",s.join(),",",c,",0.5*(src.get(",d.join(),")-src.get(",v.join(),")))}else{dst.set(",s.join(),",",c,",0)};")}else{a.push("if(s[",c,"]>2){diff(",f,",src.pick(",d.join(),")",u,",src.pick(",v.join(),")",u,");}else{zero(",f,");};")}break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}if(r>0){a.push("};")}}for(var f=0;f<1<<n;++f){var h=[];for(var p=0;p<n;++p){if(f&1<<p){h.push(p+1)}}for(var d=0;d<1<<h.length;++d){var v=h.slice();for(var p=0;p<h.length;++p){if(d&1<<p){v[p]=-v[p]}}s(v)}}a.push("return dst;};return gradient");var m=["diff","zero"];var g=[l,u];for(var f=1;f<=n;++f){m.push("grad"+f);g.push(c(f))}m.push(a.join(""));var y=Function.apply(void 0,m);var r=y.apply(void 0,g);i[t]=r;return r}function h(e,t,r){if(Array.isArray(r)){if(r.length!==t.dimension){throw new Error("ndarray-gradient: invalid boundary conditions")}}else if(typeof r==="string"){r=n(t.dimension,r)}else{r=n(t.dimension,"clamp")}if(e.dimension!==t.dimension+1){throw new Error("ndarray-gradient: output dimension must be +1 input dimension")}if(e.shape[t.dimension]!==t.dimension){throw new Error("ndarray-gradient: output shape must match input shape")}for(var a=0;a<t.dimension;++a){if(e.shape[a]!==t.shape[a]){throw new Error("ndarray-gradient: shape mismatch")}}if(t.size===0){return e}if(t.dimension<=0){e.set(0);return e}var i=f(r);return i(e,t)}},{"cwise-compiler":151,dup:176}],489:[function(e,t,r){"use strict";function n(e,t){var r=Math.floor(t),n=t-r,a=0<=r&&r<e.shape[0],i=0<=r+1&&r+1<e.shape[0],o=a?+e.get(r):0,s=i?+e.get(r+1):0;return(1-n)*o+n*s}function a(e,t,r){var n=Math.floor(t),a=t-n,i=0<=n&&n<e.shape[0],o=0<=n+1&&n+1<e.shape[0],s=Math.floor(r),l=r-s,u=0<=s&&s<e.shape[1],c=0<=s+1&&s+1<e.shape[1],f=i&&u?e.get(n,s):0,h=i&&c?e.get(n,s+1):0,p=o&&u?e.get(n+1,s):0,d=o&&c?e.get(n+1,s+1):0;return(1-l)*((1-a)*f+a*p)+l*((1-a)*h+a*d)}function i(e,t,r,n){var a=Math.floor(t),i=t-a,o=0<=a&&a<e.shape[0],s=0<=a+1&&a+1<e.shape[0],l=Math.floor(r),u=r-l,c=0<=l&&l<e.shape[1],f=0<=l+1&&l+1<e.shape[1],h=Math.floor(n),p=n-h,d=0<=h&&h<e.shape[2],v=0<=h+1&&h+1<e.shape[2],m=o&&c&&d?e.get(a,l,h):0,g=o&&f&&d?e.get(a,l+1,h):0,y=s&&c&&d?e.get(a+1,l,h):0,x=s&&f&&d?e.get(a+1,l+1,h):0,_=o&&c&&v?e.get(a,l,h+1):0,b=o&&f&&v?e.get(a,l+1,h+1):0,w=s&&c&&v?e.get(a+1,l,h+1):0,T=s&&f&&v?e.get(a+1,l+1,h+1):0;return(1-p)*((1-u)*((1-i)*m+i*y)+u*((1-i)*g+i*x))+p*((1-u)*((1-i)*_+i*w)+u*((1-i)*b+i*T))}function o(e){var t=e.shape.length|0,r=new Array(t),n=new Array(t),a=new Array(t),i=new Array(t),o,s;for(o=0;o<t;++o){s=+arguments[o+1];r[o]=Math.floor(s);n[o]=s-r[o];a[o]=0<=r[o]&&r[o]<e.shape[o];i[o]=0<=r[o]+1&&r[o]+1<e.shape[o]}var l=0,u,c,f;e:for(o=0;o<1<<t;++o){c=1;f=e.offset;for(u=0;u<t;++u){if(o&1<<u){if(!i[u]){continue e}c*=n[u];f+=e.stride[u]*(r[u]+1)}else{if(!a[u]){continue e}c*=1-n[u];f+=e.stride[u]*r[u]}}l+=c*e.data[f]}return l}function s(e,t,r,s){switch(e.shape.length){case 0:return 0;case 1:return n(e,t);case 2:return a(e,t,r);case 3:return i(e,t,r,s);default:return o.apply(undefined,arguments)}}t.exports=s;t.exports.d1=n;t.exports.d2=a;t.exports.d3=i},{}],490:[function(e,t,r){"use strict";var n=e("cwise-compiler");var a={body:"",args:[],thisVars:[],localVars:[]};function i(e){if(!e){return a}for(var t=0;t<e.args.length;++t){var r=e.args[t];if(t===0){e.args[t]={name:r,lvalue:true,rvalue:!!e.rvalue,count:e.count||1}}else{e.args[t]={name:r,lvalue:false,rvalue:true,count:1}}}if(!e.thisVars){e.thisVars=[]}if(!e.localVars){e.localVars=[]}return e}function o(e){return n({args:e.args,pre:i(e.pre),body:i(e.body),post:i(e.proc),funcName:e.funcName})}function s(e){var t=[];for(var r=0;r<e.args.length;++r){t.push("a"+r)}var n=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return n(o(e))}var l={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in l){var t=l[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:true,funcName:e+"eq"});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:true,funcName:e+"seq"})}})();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in u){var t=u[e];r[e]=s({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e});r[e+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:true,count:2,funcName:e+"eq"})}})();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in c){var t=c[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:true,count:2,funcName:e+"eq"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:true,count:2,funcName:e+"seq"})}})();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0;e<f.length;++e){var t=f[e];r[t]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t});r[t+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"})}})();var h=["max","min","atan2","pow"];(function(){for(var e=0;e<h.length;++e){var t=h[e];r[t]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t});r[t+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"});r[t+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"});r[t+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"seq"})}})();var p=["atan2","pow"];(function(){for(var e=0;e<p.length;++e){var t=p[e];r[t+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"});r[t+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"});r[t+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opeq"});r[t+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opseq"})}})();r.any=n({args:["array"],pre:a,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});r.all=n({args:["array"],pre:a,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});r.sum=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});r.prod=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});r.norm2squared=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});r.norm2=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});r.norminf=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});r.norm1=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});r.sup=n({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.inf=n({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.argmin=n({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.argmax=n({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});r.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});r.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});r.equals=n({args:["array","array"],pre:a,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":151}],491:[function(e,t,r){"use strict";var n=e("ndarray");var a=e("./doConvert.js");t.exports=function e(t,r){var i=[],o=t,s=1;while(Array.isArray(o)){i.push(o.length);s*=o.length;o=o[0]}if(i.length===0){return n()}if(!r){r=n(new Float64Array(s),i)}a(r,t);return r}},{"./doConvert.js":492,ndarray:495}],492:[function(e,t,r){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:true,rvalue:false,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":151}],493:[function(e,t,r){"use strict";var n=e("typedarray-pool");var a=32;function i(e){switch(e){case"uint8":return[n.mallocUint8,n.freeUint8];case"uint16":return[n.mallocUint16,n.freeUint16];case"uint32":return[n.mallocUint32,n.freeUint32];case"int8":return[n.mallocInt8,n.freeInt8];case"int16":return[n.mallocInt16,n.freeInt16];case"int32":return[n.mallocInt32,n.freeInt32];case"float32":return[n.mallocFloat,n.freeFloat];case"float64":return[n.mallocDouble,n.freeDouble];default:return null}}function o(e){var t=[];for(var r=0;r<e;++r){t.push("s"+r)}for(var r=0;r<e;++r){t.push("n"+r)}for(var r=1;r<e;++r){t.push("d"+r)}for(var r=1;r<e;++r){t.push("e"+r)}for(var r=1;r<e;++r){t.push("f"+r)}return t}function s(e,t){var r=["'use strict'"];var n=["ndarrayInsertionSort",e.join("d"),t].join("");var a=["left","right","data","offset"].concat(o(e.length));var s=i(t);var l=["i,j,cptr,ptr=left*s0+offset"];if(e.length>1){var u=[];for(var c=1;c<e.length;++c){l.push("i"+c);u.push("n"+c)}if(s){l.push("scratch=malloc("+u.join("*")+")")}else{l.push("scratch=new Array("+u.join("*")+")")}l.push("dptr","sptr","a","b")}else{l.push("scratch")}function f(e){if(t==="generic"){return["data.get(",e,")"].join("")}return["data[",e,"]"].join("")}function h(e,r){if(t==="generic"){return["data.set(",e,",",r,")"].join("")}return["data[",e,"]=",r].join("")}r.push(["function ",n,"(",a.join(","),"){var ",l.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr");if(e.length>1){r.push("dptr=0;sptr=ptr");for(var c=e.length-1;c>=0;--c){var p=e[c];if(p===0){continue}r.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""))}r.push("scratch[dptr++]=",f("sptr"));for(var c=0;c<e.length;++c){var p=e[c];if(p===0){continue}r.push("sptr+=d"+p,"}")}r.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0");for(var c=1;c<e.length;++c){if(c===1){r.push("__l:")}r.push(["for(i",c,"=0;i",c,"<n",c,";++i",c,"){"].join(""))}r.push(["a=",f("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(var c=e.length-1;c>=1;--c){r.push("sptr+=e"+c,"dptr+=f"+c,"}")}r.push("dptr=cptr;sptr=cptr-s0");for(var c=e.length-1;c>=0;--c){var p=e[c];if(p===0){continue}r.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""))}r.push(h("dptr",f("sptr")));for(var c=0;c<e.length;++c){var p=e[c];if(p===0){continue}r.push(["dptr+=d",p,";sptr+=d",p].join(""),"}")}r.push("cptr-=s0\n}");r.push("dptr=cptr;sptr=0");for(var c=e.length-1;c>=0;--c){var p=e[c];if(p===0){continue}r.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""))}r.push(h("dptr","scratch[sptr++]"));for(var c=0;c<e.length;++c){var p=e[c];if(p===0){continue}r.push("dptr+=d"+p,"}")}}else{r.push("scratch="+f("ptr"),"while((j--\x3eleft)&&("+f("cptr-s0")+">scratch)){",h("cptr",f("cptr-s0")),"cptr-=s0","}",h("cptr","scratch"))}r.push("}");if(e.length>1&&s){r.push("free(scratch)")}r.push("} return "+n);if(s){var d=new Function("malloc","free",r.join("\n"));return d(s[0],s[1])}else{var d=new Function(r.join("\n"));return d()}}function l(e,t,r){var n=["'use strict'"];var s=["ndarrayQuickSort",e.join("d"),t].join("");var l=["left","right","data","offset"].concat(o(e.length));var u=i(t);var c=0;n.push(["function ",s,"(",l.join(","),"){"].join(""));var f=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(e.length>1){var h=[];for(var p=1;p<e.length;++p){h.push("n"+p);f.push("i"+p)}for(var p=0;p<8;++p){f.push("b_ptr"+p)}f.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+h.join("*"));if(u){f.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)")}else{f.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}}else{f.push("pivot1","pivot2")}n.push("var "+f.join(","));function d(e){return["(offset+",e,"*s0)"].join("")}function v(e){if(t==="generic"){return["data.get(",e,")"].join("")}return["data[",e,"]"].join("")}function m(e,r){if(t==="generic"){return["data.set(",e,",",r,")"].join("")}return["data[",e,"]=",r].join("")}function g(t,r,a){if(t.length===1){n.push("ptr0="+d(t[0]))}else{for(var i=0;i<t.length;++i){n.push(["b_ptr",i,"=s0*",t[i]].join(""))}}if(r){n.push("pivot_ptr=0")}n.push("ptr_shift=offset");for(var i=e.length-1;i>=0;--i){var o=e[i];if(o===0){continue}n.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(t.length>1){for(var i=0;i<t.length;++i){n.push(["ptr",i,"=b_ptr",i,"+ptr_shift"].join(""))}}n.push(a);if(r){n.push("++pivot_ptr")}for(var i=0;i<e.length;++i){var o=e[i];if(o===0){continue}if(t.length>1){n.push("ptr_shift+=d"+o)}else{n.push("ptr0+=d"+o)}n.push("}")}}function y(t,r,a,i){if(r.length===1){n.push("ptr0="+d(r[0]))}else{for(var o=0;o<r.length;++o){n.push(["b_ptr",o,"=s0*",r[o]].join(""))}n.push("ptr_shift=offset")}if(a){n.push("pivot_ptr=0")}if(t){n.push(t+":")}for(var o=1;o<e.length;++o){n.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(r.length>1){for(var o=0;o<r.length;++o){n.push(["ptr",o,"=b_ptr",o,"+ptr_shift"].join(""))}}n.push(i);for(var o=e.length-1;o>=1;--o){if(a){n.push("pivot_ptr+=f"+o)}if(r.length>1){n.push("ptr_shift+=e"+o)}else{n.push("ptr0+=e"+o)}n.push("}")}}function x(){if(e.length>1&&u){n.push("free(pivot1)","free(pivot2)")}}function _(t,r){var a="el"+t;var i="el"+r;if(e.length>1){var o="__l"+ ++c;y(o,[a,i],false,["comp=",v("ptr0"),"-",v("ptr1"),"\n","if(comp>0){tmp0=",a,";",a,"=",i,";",i,"=tmp0;break ",o,"}\n","if(comp<0){break ",o,"}"].join(""))}else{n.push(["if(",v(d(a)),">",v(d(i)),"){tmp0=",a,";",a,"=",i,";",i,"=tmp0}"].join(""))}}_(1,2);_(4,5);_(1,3);_(2,3);_(1,4);_(3,4);_(2,5);_(2,3);_(4,5);if(e.length>1){g(["el1","el2","el3","el4","el5","index1","index3","index5"],true,["pivot1[pivot_ptr]=",v("ptr1"),"\n","pivot2[pivot_ptr]=",v("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",v("ptr0"),"\n","y=",v("ptr2"),"\n","z=",v("ptr4"),"\n",m("ptr5","x"),"\n",m("ptr6","y"),"\n",m("ptr7","z")].join(""))}else{n.push(["pivot1=",v(d("el2")),"\n","pivot2=",v(d("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",v(d("el1")),"\n","y=",v(d("el3")),"\n","z=",v(d("el5")),"\n",m(d("index1"),"x"),"\n",m(d("index3"),"y"),"\n",m(d("index5"),"z")].join(""))}function b(t,r){if(e.length>1){g([t,r],false,m("ptr0",v("ptr1")))}else{n.push(m(d(t),v(d(r))))}}b("index2","left");b("index4","right");function w(t,r,a){if(e.length>1){var i="__l"+ ++c;y(i,[r],true,[t,"=",v("ptr0"),"-pivot",a,"[pivot_ptr]\n","if(",t,"!==0){break ",i,"}"].join(""))}else{n.push([t,"=",v(d(r)),"-pivot",a].join(""))}}function T(t,r){if(e.length>1){g([t,r],false,["tmp=",v("ptr0"),"\n",m("ptr0",v("ptr1")),"\n",m("ptr1","tmp")].join(""))}else{n.push(["ptr0=",d(t),"\n","ptr1=",d(r),"\n","tmp=",v("ptr0"),"\n",m("ptr0",v("ptr1")),"\n",m("ptr1","tmp")].join(""))}}function k(t,r,a){if(e.length>1){g([t,r,a],false,["tmp=",v("ptr0"),"\n",m("ptr0",v("ptr1")),"\n",m("ptr1",v("ptr2")),"\n",m("ptr2","tmp")].join(""));n.push("++"+r,"--"+a)}else{n.push(["ptr0=",d(t),"\n","ptr1=",d(r),"\n","ptr2=",d(a),"\n","++",r,"\n","--",a,"\n","tmp=",v("ptr0"),"\n",m("ptr0",v("ptr1")),"\n",m("ptr1",v("ptr2")),"\n",m("ptr2","tmp")].join(""))}}function A(e,t){T(e,t);n.push("--"+t)}n.push("if(pivots_are_equal){");n.push("for(k=less;k<=great;++k){");w("comp","k",1);n.push("if(comp===0){continue}");n.push("if(comp<0){");n.push("if(k!==less){");T("k","less");n.push("}");n.push("++less");n.push("}else{");n.push("while(true){");w("comp","great",1);n.push("if(comp>0){");n.push("great--");n.push("}else if(comp<0){");k("k","less","great");n.push("break");n.push("}else{");A("k","great");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}else{");n.push("for(k=less;k<=great;++k){");w("comp_pivot1","k",1);n.push("if(comp_pivot1<0){");n.push("if(k!==less){");T("k","less");n.push("}");n.push("++less");n.push("}else{");w("comp_pivot2","k",2);n.push("if(comp_pivot2>0){");n.push("while(true){");w("comp","great",2);n.push("if(comp>0){");n.push("if(--great<k){break}");n.push("continue");n.push("}else{");w("comp","great",1);n.push("if(comp<0){");k("k","less","great");n.push("}else{");A("k","great");n.push("}");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");function M(t,r,a){if(e.length>1){g([t,r],true,[m("ptr0",v("ptr1")),"\n",m("ptr1",["pivot",a,"[pivot_ptr]"].join(""))].join(""))}else{n.push(m(d(t),v(d(r))),m(d(r),"pivot"+a))}}M("left","(less-1)",1);M("right","(great+1)",2);function E(t,r){n.push(["if((",r,"-",t,")<=",a,"){\n","insertionSort(",t,",",r,",data,offset,",o(e.length).join(","),")\n","}else{\n",s,"(",t,",",r,",data,offset,",o(e.length).join(","),")\n","}"].join(""))}E("left","(less-2)");E("(great+2)","right");n.push("if(pivots_are_equal){");x();n.push("return");n.push("}");function S(t,r,a){if(e.length>1){n.push(["__l",++c,":while(true){"].join(""));g([t],true,["if(",v("ptr0"),"!==pivot",r,"[pivot_ptr]){break __l",c,"}"].join(""));n.push(a,"}")}else{n.push(["while(",v(d(t)),"===pivot",r,"){",a,"}"].join(""))}}n.push("if(less<index1&&great>index5){");S("less",1,"++less");S("great",2,"--great");n.push("for(k=less;k<=great;++k){");w("comp_pivot1","k",1);n.push("if(comp_pivot1===0){");n.push("if(k!==less){");T("k","less");n.push("}");n.push("++less");n.push("}else{");w("comp_pivot2","k",2);n.push("if(comp_pivot2===0){");n.push("while(true){");w("comp","great",2);n.push("if(comp===0){");n.push("if(--great<k){break}");n.push("continue");n.push("}else{");w("comp","great",1);n.push("if(comp<0){");k("k","less","great");n.push("}else{");A("k","great");n.push("}");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");x();E("less","great");n.push("}return "+s);if(e.length>1&&u){var C=new Function("insertionSort","malloc","free",n.join("\n"));return C(r,u[0],u[1])}var C=new Function("insertionSort",n.join("\n"));return C(r)}function u(e,t){var r=["'use strict'"];var n=["ndarraySortWrapper",e.join("d"),t].join("");var i=["array"];r.push(["function ",n,"(",i.join(","),"){"].join(""));var u=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"];for(var c=0;c<e.length;++c){u.push(["s",c,"=stride[",c,"]|0,n",c,"=shape[",c,"]|0"].join(""))}var f=new Array(e.length);var h=[];for(var c=0;c<e.length;++c){var p=e[c];if(p===0){continue}if(h.length===0){f[p]="1"}else{f[p]=h.join("*")}h.push("n"+p)}var d=-1,v=-1;for(var c=0;c<e.length;++c){var m=e[c];if(m!==0){if(d>0){u.push(["d",m,"=s",m,"-d",d,"*n",d].join(""))}else{u.push(["d",m,"=s",m].join(""))}d=m}var p=e.length-1-c;if(p!==0){if(v>0){u.push(["e",p,"=s",p,"-e",v,"*n",v,",f",p,"=",f[p],"-f",v,"*n",v].join(""))}else{u.push(["e",p,"=s",p,",f",p,"=",f[p]].join(""))}v=p}}r.push("var "+u.join(","));var g=["0","n0-1","data","offset"].concat(o(e.length));r.push(["if(n0<=",a,"){","insertionSort(",g.join(","),")}else{","quickSort(",g.join(","),")}"].join(""));r.push("}return "+n);var y=new Function("insertionSort","quickSort",r.join("\n"));var x=s(e,t);var _=l(e,t,x);return y(x,_)}t.exports=u},{"typedarray-pool":595}],494:[function(e,t,r){"use strict";var n=e("./lib/compile_sort.js");var a={};function i(e){var t=e.order;var r=e.dtype;var i=[t,r];var o=i.join(":");var s=a[o];if(!s){a[o]=s=n(t,r)}s(e);return e}t.exports=i},{"./lib/compile_sort.js":493}],495:[function(e,t,r){var n=e("iota-array");var a=e("is-buffer");var i=typeof Float64Array!=="undefined";function o(e,t){return e[0]-t[0]}function s(){var e=this.stride;var t=new Array(e.length);var r;for(r=0;r<t.length;++r){t[r]=[Math.abs(e[r]),r]}t.sort(o);var n=new Array(t.length);for(r=0;r<n.length;++r){n[r]=t[r][1]}return n}function l(e,t){var r=["View",t,"d",e].join("");if(t<0){r="View_Nil"+e}var a=e==="generic";if(t===-1){var i="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";var o=new Function(i);return o()}else if(t===0){var i="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";var o=new Function("TrivialArray",i);return o(c[e][0])}var i=["'use strict'"];var l=n(t);var u=l.map(function(e){return"i"+e});var f="this.offset+"+l.map(function(e){return"this.stride["+e+"]*i"+e}).join("+");var h=l.map(function(e){return"b"+e}).join(",");var p=l.map(function(e){return"c"+e}).join(",");i.push("function "+r+"(a,"+h+","+p+",d){this.data=a","this.shape=["+h+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t);i.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+l.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})");if(t===1){i.push("proto.order=[0]")}else{i.push("Object.defineProperty(proto,'order',{get:");if(t<4){i.push("function "+r+"_order(){");if(t===2){i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})")}else if(t===3){i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{i.push("ORDER})")}}i.push("proto.set=function "+r+"_set("+u.join(",")+",v){");if(a){i.push("return this.data.set("+f+",v)}")}else{i.push("return this.data["+f+"]=v}")}i.push("proto.get=function "+r+"_get("+u.join(",")+"){");if(a){i.push("return this.data.get("+f+")}")}else{i.push("return this.data["+f+"]}")}i.push("proto.index=function "+r+"_index(",u.join(),"){return "+f+"}");i.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+l.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var d=l.map(function(e){return"a"+e+"=this.shape["+e+"]"});var v=l.map(function(e){return"c"+e+"=this.stride["+e+"]"});i.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+v.join(","));for(var m=0;m<t;++m){i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}")}i.push("return new "+r+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}");i.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+l.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+l.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;m<t;++m){i.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}")}i.push("return new "+r+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");var g=new Array(t);var y=new Array(t);for(var m=0;m<t;++m){g[m]="a[i"+m+"]";y[m]="b[i"+m+"]"}i.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+g.join(",")+","+y.join(",")+",this.offset)}");i.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var m=0;m<t;++m){i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}")}i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");i.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",i.join("\n"));return o(c[e],s)}function u(e){if(a(e)){return"buffer"}if(i){switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}}if(Array.isArray(e)){return"array"}return"generic"}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};(function(){for(var e in c){c[e].push(l(e,-1))}});function f(e,t,r,n){if(e===undefined){var a=c.array[0];return a([])}else if(typeof e==="number"){e=[e]}if(t===undefined){t=[e.length]}var i=t.length;if(r===undefined){r=new Array(i);for(var o=i-1,s=1;o>=0;--o){r[o]=s;s*=t[o]}}if(n===undefined){n=0;for(var o=0;o<i;++o){if(r[o]<0){n-=(t[o]-1)*r[o]}}}var f=u(e);var h=c[f];while(h.length<=i+1){h.push(l(f,h.length-1))}var a=h[i+1];return a(e,t,r,n)}t.exports=f},{"iota-array":463,"is-buffer":465}],496:[function(e,t,r){"use strict";var n=e("double-bits");var a=Math.pow(2,-1074);var i=-1>>>0;t.exports=o;function o(e,t){if(isNaN(e)||isNaN(t)){return NaN}if(e===t){return e}if(e===0){if(t<0){return-a}else{return a}}var r=n.hi(e);var o=n.lo(e);if(t>e===e>0){if(o===i){r+=1;o=0}else{o+=1}}else{if(o===0){o=i;r-=1}else{o-=1}}return n.pack(o,r)}},{"double-bits":173}],497:[function(e,t,r){var n=Math.PI;var a=c(120);t.exports=i;function i(e){var t;var r=[];var n=0;var a=0;var i=0;var u=0;var f=null;var h=null;var p=0;var d=0;for(var v=0,m=e.length;v<m;v++){var g=e[v];var y=g[0];switch(y){case"M":i=g[1];u=g[2];break;case"A":g=l(p,d,g[1],g[2],c(g[3]),g[4],g[5],g[6],g[7]);g.unshift("C");if(g.length>7){r.push(g.splice(0,7));g.unshift("C")}break;case"S":var x=p;var _=d;if(t=="C"||t=="S"){x+=x-n;_+=_-a}g=["C",x,_,g[1],g[2],g[3],g[4]];break;case"T":if(t=="Q"||t=="T"){f=p*2-f;h=d*2-h}else{f=p;h=d}g=s(p,d,f,h,g[1],g[2]);break;case"Q":f=g[1];h=g[2];g=s(p,d,g[1],g[2],g[3],g[4]);break;case"L":g=o(p,d,g[1],g[2]);break;case"H":g=o(p,d,g[1],d);break;case"V":g=o(p,d,p,g[1]);break;case"Z":g=o(p,d,i,u);break}t=y;p=g[g.length-2];d=g[g.length-1];if(g.length>4){n=g[g.length-4];a=g[g.length-3]}else{n=p;a=d}r.push(g)}return r}function o(e,t,r,n){return["C",e,t,r,n,r,n]}function s(e,t,r,n,a,i){return["C",e/3+2/3*r,t/3+2/3*n,a/3+2/3*r,i/3+2/3*n,a,i]}function l(e,t,r,i,o,s,c,f,h,p){if(!p){var d=u(e,t,-o);e=d.x;t=d.y;d=u(f,h,-o);f=d.x;h=d.y;var v=(e-f)/2;var m=(t-h)/2;var g=v*v/(r*r)+m*m/(i*i);if(g>1){g=Math.sqrt(g);r=g*r;i=g*i}var y=r*r;var x=i*i;var _=(s==c?-1:1)*Math.sqrt(Math.abs((y*x-y*m*m-x*v*v)/(y*m*m+x*v*v)));if(_==Infinity)_=1;var b=_*r*m/i+(e+f)/2;var w=_*-i*v/r+(t+h)/2;var T=Math.asin(((t-w)/i).toFixed(9));var k=Math.asin(((h-w)/i).toFixed(9));T=e<b?n-T:T;k=f<b?n-k:k;if(T<0)T=n*2+T;if(k<0)k=n*2+k;if(c&&T>k)T=T-n*2;if(!c&&k>T)k=k-n*2}else{T=p[0];k=p[1];b=p[2];w=p[3]}if(Math.abs(k-T)>a){var A=k;var M=f;var E=h;k=T+a*(c&&k>T?1:-1);f=b+r*Math.cos(k);h=w+i*Math.sin(k);var S=l(f,h,r,i,o,0,c,M,E,[k,A,b,w])}var C=Math.tan((k-T)/4);var L=4/3*r*C;var I=4/3*i*C;var O=[2*e-(e+L*Math.sin(T)),2*t-(t-I*Math.cos(T)),f+L*Math.sin(k),h-I*Math.cos(k),f,h];if(p)return O;if(S)O=O.concat(S);for(var P=0;P<O.length;){var D=u(O[P],O[P+1],o);O[P++]=D.x;O[P++]=D.y}return O}function u(e,t,r){return{x:e*Math.cos(r)-t*Math.sin(r),y:e*Math.sin(r)+t*Math.cos(r)}}function c(e){return e*(n/180)}},{}],498:[function(e,t,r){var n=1e-6;var a=1e-6;r.vertexNormals=function(e,t,r){var a=t.length;var i=new Array(a);var o=r===void 0?n:r;for(var s=0;s<a;++s){i[s]=[0,0,0]}for(var s=0;s<e.length;++s){var l=e[s];var u=0;var c=l[l.length-1];var f=l[0];for(var h=0;h<l.length;++h){u=c;c=f;f=l[(h+1)%l.length];var p=t[u];var d=t[c];var v=t[f];var m=new Array(3);var g=0;var y=new Array(3);var x=0;for(var _=0;_<3;++_){m[_]=p[_]-d[_];g+=m[_]*m[_];y[_]=v[_]-d[_];x+=y[_]*y[_]}if(g*x>o){var b=i[c];var w=1/Math.sqrt(g*x);for(var _=0;_<3;++_){var T=(_+1)%3;var k=(_+2)%3;b[_]+=w*(y[T]*m[k]-y[k]*m[T])}}}}for(var s=0;s<a;++s){var b=i[s];var A=0;for(var _=0;_<3;++_){A+=b[_]*b[_]}if(A>o){var w=1/Math.sqrt(A);for(var _=0;_<3;++_){b[_]*=w}}else{for(var _=0;_<3;++_){b[_]=0}}}return i};r.faceNormals=function(e,t,r){var n=e.length;var i=new Array(n);var o=r===void 0?a:r;for(var s=0;s<n;++s){var l=e[s];var u=new Array(3);for(var c=0;c<3;++c){u[c]=t[l[c]]}var f=new Array(3);var h=new Array(3);for(var c=0;c<3;++c){f[c]=u[1][c]-u[0][c];h[c]=u[2][c]-u[0][c]}var p=new Array(3);var d=0;for(var c=0;c<3;++c){var v=(c+1)%3;var m=(c+2)%3;p[c]=f[v]*h[m]-f[m]*h[v];d+=p[c]*p[c]}if(d>o){d=1/Math.sqrt(d)}else{d=0}for(var c=0;c<3;++c){p[c]*=d}i[s]=p}return i}},{}],499:[function(e,t,r){
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
"use strict";var n=Object.getOwnPropertySymbols;var a=Object.prototype.hasOwnProperty;var i=Object.prototype.propertyIsEnumerable;function o(e){if(e===null||e===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(e)}function s(){try{if(!Object.assign){return false}var e=new String("abc");e[5]="de";if(Object.getOwnPropertyNames(e)[0]==="5"){return false}var t={};for(var r=0;r<10;r++){t["_"+String.fromCharCode(r)]=r}var n=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if(n.join("")!=="0123456789"){return false}var a={};"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e});if(Object.keys(Object.assign({},a)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(e){return false}}t.exports=s()?Object.assign:function(e,t){var r;var s=o(e);var l;for(var u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r){if(a.call(r,c)){s[c]=r[c]}}if(n){l=n(r);for(var f=0;f<l.length;f++){if(i.call(r,l[f])){s[l[f]]=r[l[f]]}}}}return s}},{}],500:[function(e,t,r){"use strict";t.exports=n;function n(e,t,r,n,a,i,o,s,l,u){var c=t+i+u;if(f>0){var f=Math.sqrt(c+1);e[0]=.5*(o-l)/f;e[1]=.5*(s-n)/f;e[2]=.5*(r-i)/f;e[3]=.5*f}else{var h=Math.max(t,i,u);var f=Math.sqrt(2*h-c+1);if(t>=h){e[0]=.5*f;e[1]=.5*(a+r)/f;e[2]=.5*(s+n)/f;e[3]=.5*(o-l)/f}else if(i>=h){e[0]=.5*(r+a)/f;e[1]=.5*f;e[2]=.5*(l+o)/f;e[3]=.5*(s-n)/f}else{e[0]=.5*(n+s)/f;e[1]=.5*(o+l)/f;e[2]=.5*f;e[3]=.5*(r-a)/f}}return e}},{}],501:[function(e,t,r){"use strict";t.exports=p;var n=e("filtered-vector");var a=e("gl-mat4/lookAt");var i=e("gl-mat4/fromQuat");var o=e("gl-mat4/invert");var s=e("./lib/quatFromFrame");function l(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function u(e,t,r,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2)+Math.pow(n,2))}function c(e,t){var r=t[0];var n=t[1];var a=t[2];var i=t[3];var o=u(r,n,a,i);if(o>1e-6){e[0]=r/o;e[1]=n/o;e[2]=a/o;e[3]=i/o}else{e[0]=e[1]=e[2]=0;e[3]=1}}function f(e,t,r){this.radius=n([r]);this.center=n(t);this.rotation=n(e);this.computedRadius=this.radius.curve(0);this.computedCenter=this.center.curve(0);this.computedRotation=this.rotation.curve(0);this.computedUp=[.1,0,0];this.computedEye=[.1,0,0];this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.recalcMatrix(0)}var h=f.prototype;h.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())};h.recalcMatrix=function(e){this.radius.curve(e);this.center.curve(e);this.rotation.curve(e);var t=this.computedRotation;c(t,t);var r=this.computedMatrix;i(r,t);var n=this.computedCenter;var a=this.computedEye;var o=this.computedUp;var s=Math.exp(this.computedRadius[0]);a[0]=n[0]+s*r[2];a[1]=n[1]+s*r[6];a[2]=n[2]+s*r[10];o[0]=r[1];o[1]=r[5];o[2]=r[9];for(var l=0;l<3;++l){var u=0;for(var f=0;f<3;++f){u+=r[l+4*f]*a[f]}r[12+l]=-u}};h.getMatrix=function(e,t){this.recalcMatrix(e);var r=this.computedMatrix;if(t){for(var n=0;n<16;++n){t[n]=r[n]}return t}return r};h.idle=function(e){this.center.idle(e);this.radius.idle(e);this.rotation.idle(e)};h.flush=function(e){this.center.flush(e);this.radius.flush(e);this.rotation.flush(e)};h.pan=function(e,t,r,n){t=t||0;r=r||0;n=n||0;this.recalcMatrix(e);var a=this.computedMatrix;var i=a[1];var o=a[5];var s=a[9];var u=l(i,o,s);i/=u;o/=u;s/=u;var c=a[0];var f=a[4];var h=a[8];var p=c*i+f*o+h*s;c-=i*p;f-=o*p;h-=s*p;var d=l(c,f,h);c/=d;f/=d;h/=d;var v=a[2];var m=a[6];var g=a[10];var y=v*i+m*o+g*s;var x=v*c+m*f+g*h;v-=y*i+x*c;m-=y*o+x*f;g-=y*s+x*h;var _=l(v,m,g);v/=_;m/=_;g/=_;var b=c*t+i*r;var w=f*t+o*r;var T=h*t+s*r;this.center.move(e,b,w,T);var k=Math.exp(this.computedRadius[0]);k=Math.max(1e-4,k+n);this.radius.set(e,Math.log(k))};h.rotate=function(e,t,r,n){this.recalcMatrix(e);t=t||0;r=r||0;var a=this.computedMatrix;var i=a[0];var o=a[4];var s=a[8];var c=a[1];var f=a[5];var h=a[9];var p=a[2];var d=a[6];var v=a[10];var m=t*i+r*c;var g=t*o+r*f;var y=t*s+r*h;var x=-(d*y-v*g);var _=-(v*m-p*y);var b=-(p*g-d*m);var w=Math.sqrt(Math.max(0,1-Math.pow(x,2)-Math.pow(_,2)-Math.pow(b,2)));var T=u(x,_,b,w);if(T>1e-6){x/=T;_/=T;b/=T;w/=T}else{x=_=b=0;w=1}var k=this.computedRotation;var A=k[0];var M=k[1];var E=k[2];var S=k[3];var C=A*w+S*x+M*b-E*_;var L=M*w+S*_+E*x-A*b;var I=E*w+S*b+A*_-M*x;var O=S*w-A*x-M*_-E*b;if(n){x=p;_=d;b=v;var P=Math.sin(n)/l(x,_,b);x*=P;_*=P;b*=P;w=Math.cos(t);C=C*w+O*x+L*b-I*_;L=L*w+O*_+I*x-C*b;I=I*w+O*b+C*_-L*x;O=O*w-C*x-L*_-I*b}var D=u(C,L,I,O);if(D>1e-6){C/=D;L/=D;I/=D;O/=D}else{C=L=I=0;O=1}this.rotation.set(e,C,L,I,O)};h.lookAt=function(e,t,r,n){this.recalcMatrix(e);r=r||this.computedCenter;t=t||this.computedEye;n=n||this.computedUp;var i=this.computedMatrix;a(i,t,r,n);var o=this.computedRotation;s(o,i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]);c(o,o);this.rotation.set(e,o[0],o[1],o[2],o[3]);var l=0;for(var u=0;u<3;++u){l+=Math.pow(r[u]-t[u],2)}this.radius.set(e,.5*Math.log(Math.max(l,1e-6)));this.center.set(e,r[0],r[1],r[2])};h.translate=function(e,t,r,n){this.center.move(e,t||0,r||0,n||0)};h.setMatrix=function(e,t){var r=this.computedRotation;s(r,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]);c(r,r);this.rotation.set(e,r[0],r[1],r[2],r[3]);var n=this.computedMatrix;o(n,t);var a=n[15];if(Math.abs(a)>1e-6){var i=n[12]/a;var l=n[13]/a;var u=n[14]/a;this.recalcMatrix(e);var f=Math.exp(this.computedRadius[0]);this.center.set(e,i-n[2]*f,l-n[6]*f,u-n[10]*f);this.radius.idle(e)}else{this.center.idle(e);this.radius.idle(e)}};h.setDistance=function(e,t){if(t>0){this.radius.set(e,Math.log(t))}};h.setDistanceLimits=function(e,t){if(e>0){e=Math.log(e)}else{e=-Infinity}if(t>0){t=Math.log(t)}else{t=Infinity}t=Math.max(t,e);this.radius.bounds[0][0]=e;this.radius.bounds[1][0]=t};h.getDistanceLimits=function(e){var t=this.radius.bounds;if(e){e[0]=Math.exp(t[0][0]);e[1]=Math.exp(t[1][0]);return e}return[Math.exp(t[0][0]),Math.exp(t[1][0])]};h.toJSON=function(){this.recalcMatrix(this.lastT());return{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}};h.fromJSON=function(e){var t=this.lastT();var r=e.center;if(r){this.center.set(t,r[0],r[1],r[2])}var n=e.rotation;if(n){this.rotation.set(t,n[0],n[1],n[2],n[3])}var a=e.distance;if(a&&a>0){this.radius.set(t,Math.log(a))}this.setDistanceLimits(e.zoomMin,e.zoomMax)};function p(e){e=e||{};var t=e.center||[0,0,0];var r=e.rotation||[0,0,0,1];var n=e.radius||1;t=[].slice.call(t,0,3);r=[].slice.call(r,0,4);c(r,r);var a=new f(r,t,Math.log(n));a.setDistanceLimits(e.zoomMin,e.zoomMax);if("eye"in e||"up"in e){a.lookAt(0,e.eye,e.center,e.up)}return a}},{"./lib/quatFromFrame":500,"filtered-vector":242,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],502:[function(e,t,r){
/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */
"use strict";var n=e("repeat-string");t.exports=function e(t,r,a){a=typeof a!=="undefined"?a+"":" ";return n(a,r)+t}},{"repeat-string":541}],503:[function(e,t,r){"use strict";function n(e,t){if(typeof e!=="string")return[e];var r=[e];if(typeof t==="string"||Array.isArray(t)){t={brackets:t}}else if(!t)t={};var n=t.brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"];var a=t.escape||"___";var i=!!t.flat;n.forEach(function(e){var t=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join(""));var n=[];function i(t,i,o){var s=r.push(t.slice(e[0].length,-e[1].length))-1;n.push(s);return a+s+a}r.forEach(function(e,n){var a;var o=0;while(e!=a){a=e;e=e.replace(t,i);if(o++>1e4)throw Error("References have circular dependency. Please, check them.")}r[n]=e});n=n.reverse();r=r.map(function(t){n.forEach(function(r){t=t.replace(new RegExp("(\\"+a+r+"\\"+a+")","g"),e[0]+"$1"+e[1])});return t})});var o=new RegExp("\\"+a+"([0-9]+)"+"\\"+a);function s(e,t,r){var n=[],a;var i=0;while(a=o.exec(e)){if(i++>1e4)throw Error("Circular references in parenthesis");n.push(e.slice(0,a.index));n.push(s(t[a[1]],t));e=e.slice(a.index+a[0].length)}n.push(e);return n}return i?r:s(r[0],r)}function a(e,t){if(t&&t.flat){var r=t&&t.escape||"___";var n=e[0],a;if(!n)return"";var i=new RegExp("\\"+r+"([0-9]+)"+"\\"+r);var o=0;while(n!=a){if(o++>1e4)throw Error("Circular references in "+e);a=n;n=n.replace(i,s)}return n}return e.reduce(function e(t,r){if(Array.isArray(r)){r=r.reduce(e,"")}return t+r},"");function s(t,r){if(e[r]==null)throw Error("Reference "+r+"is undefined");return e[r]}}function i(e,t){if(Array.isArray(e)){return a(e,t)}else{return n(e,t)}}i.parse=n;i.stringify=a;t.exports=i},{}],504:[function(e,t,r){"use strict";var n=e("pick-by-alias");t.exports=a;function a(e){var t;if(arguments.length>1){e=arguments}if(typeof e==="string"){e=e.split(/\s/).map(parseFloat)}else if(typeof e==="number"){e=[e]}if(e.length&&typeof e[0]==="number"){if(e.length===1){t={width:e[0],height:e[0],x:0,y:0}}else if(e.length===2){t={width:e[0],height:e[1],x:0,y:0}}else{t={x:e[0],y:e[1],width:e[2]-e[0]||0,height:e[3]-e[1]||0}}}else if(e){e=n(e,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"});t={x:e.left||0,y:e.top||0};if(e.width==null){if(e.right)t.width=e.right-t.x;else t.width=0}else{t.width=e.width}if(e.height==null){if(e.bottom)t.height=e.bottom-t.y;else t.height=0}else{t.height=e.height}}return t}},{"pick-by-alias":511}],505:[function(e,t,r){t.exports=i;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};var a=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function i(e){var t=[];e.replace(a,function(e,r,a){var i=r.toLowerCase();a=s(a);if(i=="m"&&a.length>2){t.push([r].concat(a.splice(0,2)));i="l";r=r=="m"?"l":"L"}while(true){if(a.length==n[i]){a.unshift(r);return t.push(a)}if(a.length<n[i])throw new Error("malformed path data");t.push([r].concat(a.splice(0,n[i])))}});return t}var o=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function s(e){var t=e.match(o);return t?t.map(Number):[]}},{}],506:[function(e,t,r){t.exports=function e(t,r){if(!r)r=[0,""];t=String(t);var n=parseFloat(t,10);r[0]=n;r[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"";return r}},{}],507:[function(e,t,r){(function(e){(function(){"use strict";function r(e){if(typeof e!=="string"){throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}}function n(e,t){var r="";var n=0;var a=-1;var i=0;var o;for(var s=0;s<=e.length;++s){if(s<e.length)o=e.charCodeAt(s);else if(o===47)break;else o=47;if(o===47){if(a===s-1||i===1){}else if(a!==s-1&&i===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){if(l===-1){r="";n=0}else{r=r.slice(0,l);n=r.length-1-r.lastIndexOf("/")}a=s;i=0;continue}}else if(r.length===2||r.length===1){r="";n=0;a=s;i=0;continue}}if(t){if(r.length>0)r+="/..";else r="..";n=2}}else{if(r.length>0)r+="/"+e.slice(a+1,s);else r=e.slice(a+1,s);n=s-a-1}a=s;i=0}else if(o===46&&i!==-1){++i}else{i=-1}}return r}function a(e,t){var r=t.dir||t.root;var n=t.base||(t.name||"")+(t.ext||"");if(!r){return n}if(r===t.root){return r+n}return r+e+n}var i={resolve:function t(){var a="";var i=false;var o;for(var s=arguments.length-1;s>=-1&&!i;s--){var l;if(s>=0)l=arguments[s];else{if(o===undefined)o=e.cwd();l=o}r(l);if(l.length===0){continue}a=l+"/"+a;i=l.charCodeAt(0)===47}a=n(a,!i);if(i){if(a.length>0)return"/"+a;else return"/"}else if(a.length>0){return a}else{return"."}},normalize:function e(t){r(t);if(t.length===0)return".";var a=t.charCodeAt(0)===47;var i=t.charCodeAt(t.length-1)===47;t=n(t,!a);if(t.length===0&&!a)t=".";if(t.length>0&&i)t+="/";if(a)return"/"+t;return t},isAbsolute:function e(t){r(t);return t.length>0&&t.charCodeAt(0)===47},join:function e(){if(arguments.length===0)return".";var t;for(var n=0;n<arguments.length;++n){var a=arguments[n];r(a);if(a.length>0){if(t===undefined)t=a;else t+="/"+a}}if(t===undefined)return".";return i.normalize(t)},relative:function e(t,n){r(t);r(n);if(t===n)return"";t=i.resolve(t);n=i.resolve(n);if(t===n)return"";var a=1;for(;a<t.length;++a){if(t.charCodeAt(a)!==47)break}var o=t.length;var s=o-a;var l=1;for(;l<n.length;++l){if(n.charCodeAt(l)!==47)break}var u=n.length;var c=u-l;var f=s<c?s:c;var h=-1;var p=0;for(;p<=f;++p){if(p===f){if(c>f){if(n.charCodeAt(l+p)===47){return n.slice(l+p+1)}else if(p===0){return n.slice(l+p)}}else if(s>f){if(t.charCodeAt(a+p)===47){h=p}else if(p===0){h=0}}break}var d=t.charCodeAt(a+p);var v=n.charCodeAt(l+p);if(d!==v)break;else if(d===47)h=p}var m="";for(p=a+h+1;p<=o;++p){if(p===o||t.charCodeAt(p)===47){if(m.length===0)m+="..";else m+="/.."}}if(m.length>0)return m+n.slice(l+h);else{l+=h;if(n.charCodeAt(l)===47)++l;return n.slice(l)}},_makeLong:function e(t){return t},dirname:function e(t){r(t);if(t.length===0)return".";var n=t.charCodeAt(0);var a=n===47;var i=-1;var o=true;for(var s=t.length-1;s>=1;--s){n=t.charCodeAt(s);if(n===47){if(!o){i=s;break}}else{o=false}}if(i===-1)return a?"/":".";if(a&&i===1)return"//";return t.slice(0,i)},basename:function e(t,n){if(n!==undefined&&typeof n!=="string")throw new TypeError('"ext" argument must be a string');r(t);var a=0;var i=-1;var o=true;var s;if(n!==undefined&&n.length>0&&n.length<=t.length){if(n.length===t.length&&n===t)return"";var l=n.length-1;var u=-1;for(s=t.length-1;s>=0;--s){var c=t.charCodeAt(s);if(c===47){if(!o){a=s+1;break}}else{if(u===-1){o=false;u=s+1}if(l>=0){if(c===n.charCodeAt(l)){if(--l===-1){i=s}}else{l=-1;i=u}}}}if(a===i)i=u;else if(i===-1)i=t.length;return t.slice(a,i)}else{for(s=t.length-1;s>=0;--s){if(t.charCodeAt(s)===47){if(!o){a=s+1;break}}else if(i===-1){o=false;i=s+1}}if(i===-1)return"";return t.slice(a,i)}},extname:function e(t){r(t);var n=-1;var a=0;var i=-1;var o=true;var s=0;for(var l=t.length-1;l>=0;--l){var u=t.charCodeAt(l);if(u===47){if(!o){a=l+1;break}continue}if(i===-1){o=false;i=l+1}if(u===46){if(n===-1)n=l;else if(s!==1)s=1}else if(n!==-1){s=-1}}if(n===-1||i===-1||s===0||s===1&&n===i-1&&n===a+1){return""}return t.slice(n,i)},format:function e(t){if(t===null||typeof t!=="object"){throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t)}return a("/",t)},parse:function e(t){r(t);var n={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return n;var a=t.charCodeAt(0);var i=a===47;var o;if(i){n.root="/";o=1}else{o=0}var s=-1;var l=0;var u=-1;var c=true;var f=t.length-1;var h=0;for(;f>=o;--f){a=t.charCodeAt(f);if(a===47){if(!c){l=f+1;break}continue}if(u===-1){c=false;u=f+1}if(a===46){if(s===-1)s=f;else if(h!==1)h=1}else if(s!==-1){h=-1}}if(s===-1||u===-1||h===0||h===1&&s===u-1&&s===l+1){if(u!==-1){if(l===0&&i)n.base=n.name=t.slice(1,u);else n.base=n.name=t.slice(l,u)}}else{if(l===0&&i){n.name=t.slice(1,s);n.base=t.slice(1,u)}else{n.name=t.slice(l,s);n.base=t.slice(l,u)}n.ext=t.slice(s,u)}if(l>0)n.dir=t.slice(0,l-1);else if(i)n.dir="/";return n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i;t.exports=i}).call(this)}).call(this,e("_process"))},{_process:526}],508:[function(e,t,r){(function(e){(function(){(function(){var r,n,a,i,o,s;if(typeof performance!=="undefined"&&performance!==null&&performance.now){t.exports=function(){return performance.now()}}else if(typeof e!=="undefined"&&e!==null&&e.hrtime){t.exports=function(){return(r()-o)/1e6};n=e.hrtime;r=function(){var e;e=n();return e[0]*1e9+e[1]};i=r();s=e.uptime()*1e9;o=i-s}else if(Date.now){t.exports=function(){return Date.now()-a};a=Date.now()}else{t.exports=function(){return(new Date).getTime()-a};a=(new Date).getTime()}}).call(this)}).call(this)}).call(this,e("_process"))},{_process:526}],509:[function(e,t,r){"use strict";t.exports=i;var n=32;var a=e("typedarray-pool");function i(e){var t=e.length;if(t<n){var r=1;for(var i=0;i<t;++i){for(var o=0;o<i;++o){if(e[i]<e[o]){r=-r}else if(e[i]===e[o]){return 0}}}return r}else{var s=a.mallocUint8(t);for(var i=0;i<t;++i){s[i]=0}var r=1;for(var i=0;i<t;++i){if(!s[i]){var l=1;s[i]=1;for(var o=e[i];o!==i;o=e[o]){if(s[o]){a.freeUint8(s);return 0}l+=1;s[o]=1}if(!(l&1)){r=-r}}}a.freeUint8(s);return r}}},{"typedarray-pool":595}],510:[function(e,t,r){"use strict";var n=e("typedarray-pool");var a=e("invert-permutation");function i(e){var t=e.length;switch(t){case 0:case 1:return 0;case 2:return e[1];default:break}var r=n.mallocUint32(t);var i=n.mallocUint32(t);var o=0,s,l,u;a(e,i);for(u=0;u<t;++u){r[u]=e[u]}for(u=t-1;u>0;--u){l=i[u];s=r[u];r[u]=r[l];r[l]=s;i[u]=i[s];i[s]=l;o=(o+s)*u}n.freeUint32(i);n.freeUint32(r);return o}function o(e,t,r){switch(e){case 0:if(r){return r}return[];case 1:if(r){r[0]=0;return r}else{return[0]}case 2:if(r){if(t){r[0]=0;r[1]=1}else{r[0]=1;r[1]=0}return r}else{return t?[0,1]:[1,0]}default:break}r=r||new Array(e);var n,a,i,o=1;r[0]=0;for(i=1;i<e;++i){r[i]=i;o=o*i|0}for(i=e-1;i>0;--i){n=t/o|0;t=t-n*o|0;o=o/i|0;a=r[i]|0;r[i]=r[n]|0;r[n]=a|0}return r}r.rank=i;r.unrank=o},{"invert-permutation":462,"typedarray-pool":595}],511:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i={},o,s;if(typeof r==="string")r=a(r);if(Array.isArray(r)){var l={};for(s=0;s<r.length;s++){l[r[s]]=true}r=l}for(o in r){r[o]=a(r[o])}var u={};for(o in r){var c=r[o];if(Array.isArray(c)){for(s=0;s<c.length;s++){var f=c[s];if(n){u[f]=true}if(f in t){i[o]=t[f];if(n){for(var h=s;h<c.length;h++){u[c[h]]=true}}break}}}else if(o in t){if(r[o]){i[o]=t[o]}if(n){u[o]=true}}}if(n){for(o in t){if(u[o])continue;i[o]=t[o]}}return i};var n={};function a(e){if(n[e])return n[e];if(typeof e==="string"){e=n[e]=e.split(/\s*,\s*|\s+/)}return e}},{}],512:[function(e,t,r){"use strict";t.exports=a;var n=e("compare-angle");function a(e,t){var r=t.length|0;var a=e.length;var i=[new Array(r),new Array(r)];for(var o=0;o<r;++o){i[0][o]=[];i[1][o]=[]}for(var o=0;o<a;++o){var s=e[o];i[0][s[0]].push(s);i[1][s[1]].push(s)}var l=[];for(var o=0;o<r;++o){if(i[0][o].length+i[1][o].length===0){l.push([o])}}function u(e,t){var r=i[t][e[t]];r.splice(r.indexOf(e),1)}function c(e,r,a){var o,s,l;for(var c=0;c<2;++c){if(i[c][r].length>0){o=i[c][r][0];l=c;break}}s=o[l^1];for(var f=0;f<2;++f){var h=i[f][r];for(var p=0;p<h.length;++p){var d=h[p];var v=d[f^1];var m=n(t[e],t[r],t[s],t[v]);if(m>0){o=d;s=v;l=f}}}if(a){return s}if(o){u(o,l)}return s}function f(e,r){var a=i[r][e][0];var o=[e];u(a,r);var s=a[r^1];var l=r;while(true){while(s!==e){o.push(s);s=c(o[o.length-2],s,false)}if(i[0][e].length+i[1][e].length===0){break}var f=o[o.length-1];var h=e;var p=o[1];var d=c(f,h,true);if(n(t[f],t[h],t[p],t[d])<0){break}o.push(e);s=c(f,h)}return o}function h(e,t){return t[1]===t[t.length-1]}for(var o=0;o<r;++o){for(var p=0;p<2;++p){var d=[];while(i[p][o].length>0){var v=i[0][o].length;var m=f(o,p);if(h(d,m)){d.push.apply(d,m)}else{if(d.length>0){l.push(d)}d=m}}if(d.length>0){l.push(d)}}}return l}},{"compare-angle":132}],513:[function(e,t,r){"use strict";t.exports=a;var n=e("edges-to-adjacency-list");function a(e,t){var r=n(e,t.length);var a=new Array(t.length);var i=new Array(t.length);var o=[];for(var s=0;s<t.length;++s){var l=r[s].length;i[s]=l;a[s]=true;if(l<=1){o.push(s)}}while(o.length>0){var u=o.pop();a[u]=false;var c=r[u];for(var s=0;s<c.length;++s){var f=c[s];if(--i[f]===0){o.push(f)}}}var h=new Array(t.length);var p=[];for(var s=0;s<t.length;++s){if(a[s]){var u=p.length;h[s]=u;p.push(t[s])}else{h[s]=-1}}var d=[];for(var s=0;s<e.length;++s){var v=e[s];if(a[v[0]]&&a[v[1]]){d.push([h[v[0]],h[v[1]]])}}return[d,p]}},{"edges-to-adjacency-list":178}],514:[function(e,t,r){"use strict";t.exports=h;var n=e("edges-to-adjacency-list");var a=e("planar-dual");var i=e("point-in-big-polygon");var o=e("two-product");var s=e("robust-sum");var l=e("uniq");var u=e("./lib/trim-leaves");function c(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=t}return r}function f(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=[]}return t}function h(e,t){var r=u(e,t);e=r[0];t=r[1];var h=t.length;var p=e.length;var d=n(e,t.length);for(var v=0;v<h;++v){if(d[v].length%2===1){throw new Error("planar-graph-to-polyline: graph must be manifold")}}var m=a(e,t);function g(e){var r=e.length;var n=[0];for(var a=0;a<r;++a){var i=t[e[a]];var l=t[e[(a+1)%r]];var u=o(-i[0],i[1]);var c=o(-i[0],l[1]);var f=o(l[0],i[1]);var h=o(l[0],l[1]);n=s(n,s(s(u,c),s(f,h)))}return n[n.length-1]>0}m=m.filter(g);var y=m.length;var x=new Array(y);var _=new Array(y);for(var v=0;v<y;++v){x[v]=v;var b=new Array(y);var w=m[v].map(function(e){return t[e]});var T=i([w]);var k=0;e:for(var A=0;A<y;++A){b[A]=0;if(v===A){continue}var M=m[A];var E=M.length;for(var S=0;S<E;++S){var C=T(t[M[S]]);if(C!==0){if(C<0){b[A]=1;k+=1}continue e}}b[A]=1;k+=1}_[v]=[k,v,b]}_.sort(function(e,t){return t[0]-e[0]});for(var v=0;v<y;++v){var b=_[v];var L=b[1];var I=b[2];for(var A=0;A<y;++A){if(I[A]){x[A]=L}}}var O=f(y);for(var v=0;v<y;++v){O[v].push(x[v]);O[x[v]].push(v)}var P={};var D=c(h,false);for(var v=0;v<y;++v){var M=m[v];var E=M.length;for(var A=0;A<E;++A){var R=M[A];var z=M[(A+1)%E];var N=Math.min(R,z)+":"+Math.max(R,z);if(N in P){var F=P[N];O[F].push(v);O[v].push(F);D[R]=D[z]=true}else{P[N]=v}}}function B(e){var t=e.length;for(var r=0;r<t;++r){if(!D[e[r]]){return false}}return true}var j=[];var U=c(y,-1);for(var v=0;v<y;++v){if(x[v]===v&&!B(m[v])){j.push(v);U[v]=0}else{U[v]=-1}}var r=[];while(j.length>0){var H=j.pop();var V=O[H];l(V,function(e,t){return e-t});var G=V.length;var q=U[H];var Y;if(q===0){var M=m[H];Y=[M]}for(var v=0;v<G;++v){var W=V[v];if(U[W]>=0){continue}U[W]=q^1;j.push(W);if(q===0){var M=m[W];if(!B(M)){M.reverse();Y.push(M)}}}if(q===0){r.push(Y)}}return r}},{"./lib/trim-leaves":513,"edges-to-adjacency-list":178,"planar-dual":512,"point-in-big-polygon":516,"robust-sum":553,"two-product":582,uniq:597}],515:[function(e,t,r){arguments[4][243][0].apply(r,arguments)},{dup:243}],516:[function(e,t,r){t.exports=d;var n=e("robust-orientation")[3];var a=e("slab-decomposition");var i=e("interval-tree-1d");var o=e("binary-search-bounds");function s(){return true}function l(e){return function(t,r){var n=e[t];if(n){return!!n.queryPoint(r,s)}return false}}function u(e){var t={};for(var r=0;r<e.length;++r){var n=e[r];var a=n[0][0];var o=n[0][1];var s=n[1][1];var u=[Math.min(o,s),Math.max(o,s)];if(a in t){t[a].push(u)}else{t[a]=[u]}}var c={};var f=Object.keys(t);for(var r=0;r<f.length;++r){var h=t[f[r]];c[f[r]]=i(h)}return l(c)}function c(e,t){return function(r){var a=o.le(t,r[0]);if(a<0){return 1}var i=e[a];if(!i){if(a>0&&t[a]===r[0]){i=e[a-1]}else{return 1}}var s=1;while(i){var l=i.key;var u=n(r,l[0],l[1]);if(l[0][0]<l[1][0]){if(u<0){i=i.left}else if(u>0){s=-1;i=i.right}else{return 0}}else{if(u>0){i=i.left}else if(u<0){s=1;i=i.right}else{return 0}}}return s}}function f(e){return 1}function h(e){return function t(r){if(e(r[0],r[1])){return 0}return 1}}function p(e,t){return function r(n){if(e(n[0],n[1])){return 0}return t(n)}}function d(e){var t=e.length;var r=[];var n=[];var i=0;for(var o=0;o<t;++o){var s=e[o];var l=s.length;for(var d=l-1,v=0;v<l;d=v++){var m=s[d];var g=s[v];if(m[0]===g[0]){n.push([m,g])}else{r.push([m,g])}}}if(r.length===0){if(n.length===0){return f}else{return h(u(n))}}var y=a(r);var x=c(y.slabs,y.coordinates);if(n.length===0){return x}else{return p(u(n),x)}}},{"binary-search-bounds":515,"interval-tree-1d":460,"robust-orientation":548,"slab-decomposition":565}],517:[function(e,t,r){
/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */
var n=e("./lib/build-log");var a=e("./lib/epsilon");var i=e("./lib/intersecter");var o=e("./lib/segment-chainer");var s=e("./lib/segment-selector");var l=e("./lib/geojson");var u=false;var c=a();var f;f={buildLog:function(e){if(e===true)u=n();else if(e===false)u=false;return u===false?false:u.list},epsilon:function(e){return c.epsilon(e)},segments:function(e){var t=i(true,c,u);e.regions.forEach(t.addRegion);return{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var r=i(false,c,u);return{combined:r.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,u),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,u),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,u),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,u),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,u),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:o(e.segments,c,u),inverted:e.inverted}},polygonFromGeoJSON:function(e){return l.toPolygon(f,e)},polygonToGeoJSON:function(e){return l.fromPolygon(f,c,e)},union:function(e,t){return h(e,t,f.selectUnion)},intersect:function(e,t){return h(e,t,f.selectIntersect)},difference:function(e,t){return h(e,t,f.selectDifference)},differenceRev:function(e,t){return h(e,t,f.selectDifferenceRev)},xor:function(e,t){return h(e,t,f.selectXor)}};function h(e,t,r){var n=f.segments(e);var a=f.segments(t);var i=f.combine(n,a);var o=r(i);return f.polygon(o)}if(typeof window==="object")window.PolyBool=f;t.exports=f},{"./lib/build-log":518,"./lib/epsilon":519,"./lib/geojson":520,"./lib/intersecter":521,"./lib/segment-chainer":523,"./lib/segment-selector":524}],518:[function(e,t,r){function n(){var e;var t=0;var r=false;function n(t,r){e.list.push({type:t,data:r?JSON.parse(JSON.stringify(r)):void 0});return e}e={list:[],segmentId:function(){return t++},checkIntersection:function(e,t){return n("check",{seg1:e,seg2:t})},segmentChop:function(e,t){n("div_seg",{seg:e,pt:t});return n("chop",{seg:e,pt:t})},statusRemove:function(e){return n("pop_seg",{seg:e})},segmentUpdate:function(e){return n("seg_update",{seg:e})},segmentNew:function(e,t){return n("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return n("rem_seg",{seg:e})},tempStatus:function(e,t,r){return n("temp_status",{seg:e,above:t,below:r})},rewind:function(e){return n("rewind",{seg:e})},status:function(e,t,r){return n("status",{seg:e,above:t,below:r})},vert:function(t){if(t===r)return e;r=t;return n("vert",{x:t})},log:function(e){if(typeof e!=="string")e=JSON.stringify(e,false,"  ");return n("log",{txt:e})},reset:function(){return n("reset")},selected:function(e){return n("selected",{segs:e})},chainStart:function(e){return n("chain_start",{seg:e})},chainRemoveHead:function(e,t){return n("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return n("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return n("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return n("chain_match",{index:e})},chainClose:function(e){return n("chain_close",{index:e})},chainAddHead:function(e,t){return n("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return n("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return n("chain_con",{index1:e,index2:t})},chainReverse:function(e){return n("chain_rev",{index:e})},chainJoin:function(e,t){return n("chain_join",{index1:e,index2:t})},done:function(){return n("done")}};return e}t.exports=n},{}],519:[function(e,t,r){function n(e){if(typeof e!=="number")e=1e-10;var t={epsilon:function(t){if(typeof t==="number")e=t;return e},pointAboveOrOnLine:function(t,r,n){var a=r[0];var i=r[1];var o=n[0];var s=n[1];var l=t[0];var u=t[1];return(o-a)*(u-i)-(s-i)*(l-a)>=-e},pointBetween:function(t,r,n){var a=t[1]-r[1];var i=n[0]-r[0];var o=t[0]-r[0];var s=n[1]-r[1];var l=o*i+a*s;if(l<e)return false;var u=i*i+s*s;if(l-u>-e)return false;return true},pointsSameX:function(t,r){return Math.abs(t[0]-r[0])<e},pointsSameY:function(t,r){return Math.abs(t[1]-r[1])<e},pointsSame:function(e,r){return t.pointsSameX(e,r)&&t.pointsSameY(e,r)},pointsCompare:function(e,r){if(t.pointsSameX(e,r))return t.pointsSameY(e,r)?0:e[1]<r[1]?-1:1;return e[0]<r[0]?-1:1},pointsCollinear:function(t,r,n){var a=t[0]-r[0];var i=t[1]-r[1];var o=r[0]-n[0];var s=r[1]-n[1];return Math.abs(a*s-o*i)<e},linesIntersect:function(t,r,n,a){var i=r[0]-t[0];var o=r[1]-t[1];var s=a[0]-n[0];var l=a[1]-n[1];var u=i*l-o*s;if(Math.abs(u)<e)return false;var c=t[0]-n[0];var f=t[1]-n[1];var h=(s*f-l*c)/u;var p=(i*f-o*c)/u;var d={alongA:0,alongB:0,pt:[t[0]+h*i,t[1]+h*o]};if(h<=-e)d.alongA=-2;else if(h<e)d.alongA=-1;else if(h-1<=-e)d.alongA=0;else if(h-1<e)d.alongA=1;else d.alongA=2;if(p<=-e)d.alongB=-2;else if(p<e)d.alongB=-1;else if(p-1<=-e)d.alongB=0;else if(p-1<e)d.alongB=1;else d.alongB=2;return d},pointInsideRegion:function(t,r){var n=t[0];var a=t[1];var i=r[r.length-1][0];var o=r[r.length-1][1];var s=false;for(var l=0;l<r.length;l++){var u=r[l][0];var c=r[l][1];if(c-a>e!=o-a>e&&(i-u)*(a-c)/(o-c)+u-n>e)s=!s;i=u;o=c}return s}};return t}t.exports=n},{}],520:[function(e,t,r){var n={toPolygon:function(e,t){function r(t){if(t.length<=0)return e.segments({inverted:false,regions:[]});function r(t){var r=t.slice(0,t.length-1);return e.segments({inverted:false,regions:[r]})}var n=r(t[0]);for(var a=1;a<t.length;a++)n=e.selectDifference(e.combine(n,r(t[a])));return n}if(t.type==="Polygon"){return e.polygon(r(t.coordinates))}else if(t.type==="MultiPolygon"){var n=e.segments({inverted:false,regions:[]});for(var a=0;a<t.coordinates.length;a++)n=e.selectUnion(e.combine(n,r(t.coordinates[a])));return e.polygon(n)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,r){r=e.polygon(e.segments(r));function n(e,r){return t.pointInsideRegion([(e[0][0]+e[1][0])*.5,(e[0][1]+e[1][1])*.5],r)}function a(e){return{region:e,children:[]}}var i=a(null);function o(e,t){for(var r=0;r<e.children.length;r++){var i=e.children[r];if(n(t,i.region)){o(i,t);return}}var s=a(t);for(var r=0;r<e.children.length;r++){var i=e.children[r];if(n(i.region,t)){s.children.push(i);e.children.splice(r,1);r--}}e.children.push(s)}for(var s=0;s<r.regions.length;s++){var l=r.regions[s];if(l.length<3)continue;o(i,l)}function u(e,t){var r=0;var n=e[e.length-1][0];var a=e[e.length-1][1];var i=[];for(var o=0;o<e.length;o++){var s=e[o][0];var l=e[o][1];i.push([s,l]);r+=l*n-s*a;n=s;a=l}var u=r<0;if(u!==t)i.reverse();i.push([i[0][0],i[0][1]]);return i}var c=[];function f(e){var t=[u(e.region,false)];c.push(t);for(var r=0;r<e.children.length;r++)t.push(h(e.children[r]))}function h(e){for(var t=0;t<e.children.length;t++)f(e.children[t]);return u(e.region,true)}for(var s=0;s<i.children.length;s++)f(i.children[s]);if(c.length<=0)return{type:"Polygon",coordinates:[]};if(c.length==1)return{type:"Polygon",coordinates:c[0]};return{type:"MultiPolygon",coordinates:c}}};t.exports=n},{}],521:[function(e,t,r){var n=e("./linked-list");function a(e,t,r){function a(e,t){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function i(e,t,n){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var o=n.create();function s(e,r,n,a,i,o){var s=t.pointsCompare(r,i);if(s!==0)return s;if(t.pointsSame(n,o))return 0;if(e!==a)return e?1:-1;return t.pointAboveOrOnLine(n,a?i:o,a?o:i)?1:-1}function l(e,t){o.insertBefore(e,function(r){var n=s(e.isStart,e.pt,t,r.isStart,r.pt,r.other.pt);return n<0})}function u(e,t){var r=n.node({isStart:true,pt:e.start,seg:e,primary:t,other:null,status:null});l(r,e.end);return r}function c(e,t,r){var a=n.node({isStart:false,pt:t.end,seg:t,primary:r,other:e,status:null});e.other=a;l(a,e.pt)}function f(e,t){var r=u(e,t);c(r,e,t);return r}function h(e,t){if(r)r.segmentChop(e.seg,t);e.other.remove();e.seg.end=t;e.other.pt=t;l(e.other,e.pt)}function p(e,t){var r=i(t,e.seg.end,e.seg);h(e,t);return f(r,e.primary)}function d(a,i){var s=n.create();function l(e,r){var n=e.seg.start;var a=e.seg.end;var i=r.seg.start;var o=r.seg.end;if(t.pointsCollinear(n,i,o)){if(t.pointsCollinear(a,i,o))return 1;return t.pointAboveOrOnLine(a,i,o)?1:-1}return t.pointAboveOrOnLine(n,i,o)?1:-1}function u(e){return s.findTransition(function(t){var r=l(e,t.ev);return r>0})}function c(e,n){var a=e.seg;var i=n.seg;var o=a.start;var s=a.end;var l=i.start;var u=i.end;if(r)r.checkIntersection(a,i);var c=t.linesIntersect(o,s,l,u);if(c===false){if(!t.pointsCollinear(o,s,l))return false;if(t.pointsSame(o,u)||t.pointsSame(s,l))return false;var f=t.pointsSame(o,l);var h=t.pointsSame(s,u);if(f&&h)return n;var d=!f&&t.pointBetween(o,l,u);var v=!h&&t.pointBetween(s,l,u);if(f){if(v){p(n,s)}else{p(e,u)}return n}else if(d){if(!h){if(v){p(n,s)}else{p(e,u)}}p(n,o)}}else{if(c.alongA===0){if(c.alongB===-1)p(e,l);else if(c.alongB===0)p(e,c.pt);else if(c.alongB===1)p(e,u)}if(c.alongB===0){if(c.alongA===-1)p(n,o);else if(c.alongA===0)p(n,c.pt);else if(c.alongA===1)p(n,s)}}return false}var f=[];while(!o.isEmpty()){var h=o.getHead();if(r)r.vert(h.pt[0]);if(h.isStart){if(r)r.segmentNew(h.seg,h.primary);var d=u(h);var v=d.before?d.before.ev:null;var m=d.after?d.after.ev:null;if(r){r.tempStatus(h.seg,v?v.seg:false,m?m.seg:false)}function g(){if(v){var e=c(h,v);if(e)return e}if(m)return c(h,m);return false}var y=g();if(y){if(e){var x;if(h.seg.myFill.below===null)x=true;else x=h.seg.myFill.above!==h.seg.myFill.below;if(x)y.seg.myFill.above=!y.seg.myFill.above}else{y.seg.otherFill=h.seg.myFill}if(r)r.segmentUpdate(y.seg);h.other.remove();h.remove()}if(o.getHead()!==h){if(r)r.rewind(h.seg);continue}if(e){var x;if(h.seg.myFill.below===null)x=true;else x=h.seg.myFill.above!==h.seg.myFill.below;if(!m){h.seg.myFill.below=a}else{h.seg.myFill.below=m.seg.myFill.above}if(x)h.seg.myFill.above=!h.seg.myFill.below;else h.seg.myFill.above=h.seg.myFill.below}else{if(h.seg.otherFill===null){var _;if(!m){_=h.primary?i:a}else{if(h.primary===m.primary)_=m.seg.otherFill.above;else _=m.seg.myFill.above}h.seg.otherFill={above:_,below:_}}}if(r){r.status(h.seg,v?v.seg:false,m?m.seg:false)}h.other.status=d.insert(n.node({ev:h}))}else{var b=h.status;if(b===null){throw new Error("PolyBool: Zero-length segment detected; your epsilon is "+"probably too small or too large")}if(s.exists(b.prev)&&s.exists(b.next))c(b.prev.ev,b.next.ev);if(r)r.statusRemove(b.ev.seg);b.remove();if(!h.primary){var w=h.seg.myFill;h.seg.myFill=h.seg.otherFill;h.seg.otherFill=w}f.push(h.seg)}o.getHead().remove()}if(r)r.done();return f}if(!e){return{calculate:function(e,t,r,n){e.forEach(function(e){f(i(e.start,e.end,e),true)});r.forEach(function(e){f(i(e.start,e.end,e),false)});return d(t,n)}}}return{addRegion:function(e){var r;var n=e[e.length-1];for(var i=0;i<e.length;i++){r=n;n=e[i];var o=t.pointsCompare(r,n);if(o===0)continue;f(a(o<0?r:n,o<0?n:r),true)}},calculate:function(e){return d(e,false)}}}t.exports=a},{"./linked-list":522}],522:[function(e,t,r){var n={create:function(){var e={root:{root:true,next:null},exists:function(t){if(t===null||t===e.root)return false;return true},isEmpty:function(){return e.root.next===null},getHead:function(){return e.root.next},insertBefore:function(t,r){var n=e.root;var a=e.root.next;while(a!==null){if(r(a)){t.prev=a.prev;t.next=a;a.prev.next=t;a.prev=t;return}n=a;a=a.next}n.next=t;t.prev=n;t.next=null},findTransition:function(t){var r=e.root;var n=e.root.next;while(n!==null){if(t(n))break;r=n;n=n.next}return{before:r===e.root?null:r,after:n,insert:function(e){e.prev=r;e.next=n;r.next=e;if(n!==null)n.prev=e;return e}}}};return e},node:function(e){e.prev=null;e.next=null;e.remove=function(){e.prev.next=e.next;if(e.next)e.next.prev=e.prev;e.prev=null;e.next=null};return e}};t.exports=n},{}],523:[function(e,t,r){function n(e,t,r){var n=[];var a=[];e.forEach(function(e){var i=e.start;var o=e.end;if(t.pointsSame(i,o)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is "+"probably too small or too large");return}if(r)r.chainStart(e);var s={index:0,matches_head:false,matches_pt1:false};var l={index:0,matches_head:false,matches_pt1:false};var u=s;function c(e,t,r){u.index=e;u.matches_head=t;u.matches_pt1=r;if(u===s){u=l;return false}u=null;return true}for(var f=0;f<n.length;f++){var h=n[f];var p=h[0];var d=h[1];var v=h[h.length-1];var m=h[h.length-2];if(t.pointsSame(p,i)){if(c(f,true,true))break}else if(t.pointsSame(p,o)){if(c(f,true,false))break}else if(t.pointsSame(v,i)){if(c(f,false,true))break}else if(t.pointsSame(v,o)){if(c(f,false,false))break}}if(u===s){n.push([i,o]);if(r)r.chainNew(i,o);return}if(u===l){if(r)r.chainMatch(s.index);var g=s.index;var y=s.matches_pt1?o:i;var x=s.matches_head;var h=n[g];var _=x?h[0]:h[h.length-1];var b=x?h[1]:h[h.length-2];var w=x?h[h.length-1]:h[0];var T=x?h[h.length-2]:h[1];if(t.pointsCollinear(b,_,y)){if(x){if(r)r.chainRemoveHead(s.index,y);h.shift()}else{if(r)r.chainRemoveTail(s.index,y);h.pop()}_=b}if(t.pointsSame(w,y)){n.splice(g,1);if(t.pointsCollinear(T,w,_)){if(x){if(r)r.chainRemoveTail(s.index,_);h.pop()}else{if(r)r.chainRemoveHead(s.index,_);h.shift()}}if(r)r.chainClose(s.index);a.push(h);return}if(x){if(r)r.chainAddHead(s.index,y);h.unshift(y)}else{if(r)r.chainAddTail(s.index,y);h.push(y)}return}function k(e){if(r)r.chainReverse(e);n[e].reverse()}function A(e,a){var i=n[e];var o=n[a];var s=i[i.length-1];var l=i[i.length-2];var u=o[0];var c=o[1];if(t.pointsCollinear(l,s,u)){if(r)r.chainRemoveTail(e,s);i.pop();s=l}if(t.pointsCollinear(s,u,c)){if(r)r.chainRemoveHead(a,u);o.shift()}if(r)r.chainJoin(e,a);n[e]=i.concat(o);n.splice(a,1)}var M=s.index;var E=l.index;if(r)r.chainConnect(M,E);var S=n[M].length<n[E].length;if(s.matches_head){if(l.matches_head){if(S){k(M);A(M,E)}else{k(E);A(E,M)}}else{A(E,M)}}else{if(l.matches_head){A(M,E)}else{if(S){k(M);A(E,M)}else{k(E);A(M,E)}}}});return a}t.exports=n},{}],524:[function(e,t,r){function n(e,t,r){var n=[];e.forEach(function(e){var a=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);if(t[a]!==0){n.push({id:r?r.segmentId():-1,start:e.start,end:e.end,myFill:{above:t[a]===1,below:t[a]===2},otherFill:null})}});if(r)r.selected(n);return n}var a={union:function(e,t){return n(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return n(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return n(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return n(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return n(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}};t.exports=a},{}],525:[function(e,t,r){"use strict";var n=new Float64Array(4);var a=new Float64Array(4);var i=new Float64Array(4);function o(e,t,r,o,s){if(n.length<o.length){n=new Float64Array(o.length);a=new Float64Array(o.length);i=new Float64Array(o.length)}for(var l=0;l<o.length;++l){n[l]=e[l]-o[l];a[l]=t[l]-e[l];i[l]=r[l]-e[l]}var u=0,c=0,f=0,h=0,p=0,d=0;for(var l=0;l<o.length;++l){var v=a[l],m=i[l],g=n[l];u+=v*v;c+=v*m;f+=m*m;h+=g*v;p+=g*m;d+=g*g}var y=Math.abs(u*f-c*c);var x=c*p-f*h;var _=c*h-u*p;var b;if(x+_<=y){if(x<0){if(_<0){if(h<0){_=0;if(-h>=u){x=1;b=u+2*h+d}else{x=-h/u;b=h*x+d}}else{x=0;if(p>=0){_=0;b=d}else if(-p>=f){_=1;b=f+2*p+d}else{_=-p/f;b=p*_+d}}}else{x=0;if(p>=0){_=0;b=d}else if(-p>=f){_=1;b=f+2*p+d}else{_=-p/f;b=p*_+d}}}else if(_<0){_=0;if(h>=0){x=0;b=d}else if(-h>=u){x=1;b=u+2*h+d}else{x=-h/u;b=h*x+d}}else{var w=1/y;x*=w;_*=w;b=x*(u*x+c*_+2*h)+_*(c*x+f*_+2*p)+d}}else{var T,k,A,M;if(x<0){T=c+h;k=f+p;if(k>T){A=k-T;M=u-2*c+f;if(A>=M){x=1;_=0;b=u+2*h+d}else{x=A/M;_=1-x;b=x*(u*x+c*_+2*h)+_*(c*x+f*_+2*p)+d}}else{x=0;if(k<=0){_=1;b=f+2*p+d}else if(p>=0){_=0;b=d}else{_=-p/f;b=p*_+d}}}else if(_<0){T=c+p;k=u+h;if(k>T){A=k-T;M=u-2*c+f;if(A>=M){_=1;x=0;b=f+2*p+d}else{_=A/M;x=1-_;b=x*(u*x+c*_+2*h)+_*(c*x+f*_+2*p)+d}}else{_=0;if(k<=0){x=1;b=u+2*h+d}else if(h>=0){x=0;b=d}else{x=-h/u;b=h*x+d}}}else{A=f+p-c-h;if(A<=0){x=0;_=1;b=f+2*p+d}else{M=u-2*c+f;if(A>=M){x=1;_=0;b=u+2*h+d}else{x=A/M;_=1-x;b=x*(u*x+c*_+2*h)+_*(c*x+f*_+2*p)+d}}}}var E=1-x-_;for(var l=0;l<o.length;++l){s[l]=E*e[l]+x*t[l]+_*r[l]}if(b<0){return 0}return b}t.exports=o},{}],526:[function(e,t,r){var n=t.exports={};var a;var i;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){a=setTimeout}else{a=o}}catch(e){a=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=s}}catch(e){i=s}})();function l(e){if(a===setTimeout){return setTimeout(e,0)}if((a===o||!a)&&setTimeout){a=setTimeout;return setTimeout(e,0)}try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}function u(e){if(i===clearTimeout){return clearTimeout(e)}if((i===s||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var c=[];var f=false;var h;var p=-1;function d(){if(!f||!h){return}f=false;if(h.length){c=h.concat(c)}else{p=-1}if(c.length){v()}}function v(){if(f){return}var e=l(d);f=true;var t=c.length;while(t){h=c;c=[];while(++p<t){if(h){h[p].run()}}p=-1;t=c.length}h=null;f=false;u(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}c.push(new m(e,t));if(c.length===1&&!f){l(v)}};function m(e,t){this.fun=e;this.array=t}m.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function g(){}n.on=g;n.addListener=g;n.once=g;n.off=g;n.removeListener=g;n.removeAllListeners=g;n.emit=g;n.prependListener=g;n.prependOnceListener=g;n.listeners=function(e){return[]};n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],527:[function(e,t,r){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":325}],528:[function(e,r,n){(function(t){(function(){var n=e("performance-now"),a=typeof window==="undefined"?t:window,i=["moz","webkit"],o="AnimationFrame",s=a["request"+o],l=a["cancel"+o]||a["cancelRequest"+o];for(var u=0;!s&&u<i.length;u++){s=a[i[u]+"Request"+o];l=a[i[u]+"Cancel"+o]||a[i[u]+"CancelRequest"+o]}if(!s||!l){var c=0,f=0,h=[],p=1e3/60;s=function(e){if(h.length===0){var t=n(),r=Math.max(0,p-(t-c));c=r+t;setTimeout(function(){var e=h.slice(0);h.length=0;for(var t=0;t<e.length;t++){if(!e[t].cancelled){try{e[t].callback(c)}catch(e){setTimeout(function(){throw e},0)}}}},Math.round(r))}h.push({handle:++f,callback:e,cancelled:false});return f};l=function(e){for(var t=0;t<h.length;t++){if(h[t].handle===e){h[t].cancelled=true}}}}r.exports=function(e){return s.call(a,e)};r.exports.cancel=function(){l.apply(a,arguments)};r.exports.polyfill=function(e){if(!e){e=a}e.requestAnimationFrame=s;e.cancelAnimationFrame=l}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"performance-now":508}],529:[function(e,t,r){"use strict";var n=e("big-rat/add");t.exports=a;function a(e,t){var r=e.length;var a=new Array(r);for(var i=0;i<r;++i){a[i]=n(e[i],t[i])}return a}},{"big-rat/add":80}],530:[function(e,t,r){"use strict";t.exports=a;var n=e("big-rat");function a(e){var t=new Array(e.length);for(var r=0;r<e.length;++r){t[r]=n(e[r])}return t}},{"big-rat":83}],531:[function(e,t,r){"use strict";var n=e("big-rat");var a=e("big-rat/mul");t.exports=i;function i(e,t){var r=n(t);var i=e.length;var o=new Array(i);for(var s=0;s<i;++s){o[s]=a(e[s],r)}return o}},{"big-rat":83,"big-rat/mul":92}],532:[function(e,t,r){"use strict";var n=e("big-rat/sub");t.exports=a;function a(e,t){var r=e.length;var a=new Array(r);for(var i=0;i<r;++i){a[i]=n(e[i],t[i])}return a}},{"big-rat/sub":94}],533:[function(e,t,r){"use strict";var n=e("compare-cell");var a=e("compare-oriented-cell");var i=e("cell-orientation");t.exports=o;function o(e){e.sort(a);var t=e.length;var r=0;for(var o=0;o<t;++o){var s=e[o];var l=i(s);if(l===0){continue}if(r>0){var u=e[r-1];if(n(s,u)===0&&i(u)!==l){r-=1;continue}}e[r++]=s}e.length=r;return e}},{"cell-orientation":117,"compare-cell":133,"compare-oriented-cell":134}],534:[function(e,t,r){"use strict";var n=e("array-bounds");var a=e("color-normalize");var i=e("update-diff");var o=e("pick-by-alias");var s=e("object-assign");var l=e("flatten-vertex-data");var u=e("to-float32");var c=u.float32;var f=u.fract32;t.exports=p;var h=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function p(e,t){if(typeof e==="function"){if(!t){t={}}t.regl=e}else{t=e}if(t.length){t.positions=t}e=t.regl;if(!e.hasExtension("ANGLE_instanced_arrays")){throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled")}var r=e._gl,u,p,d,v,m,g,y={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},x=[];v=e.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)});p=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});d=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});m=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});g=e.buffer({usage:"static",type:"float",data:h});T(t);u=e({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:e.prop("range"),lineWidth:e.prop("lineWidth"),capSize:e.prop("capSize"),opacity:e.prop("opacity"),scale:e.prop("scale"),translate:e.prop("translate"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{color:{buffer:v,offset:function(e,t){return t.offset*4},divisor:1},position:{buffer:p,offset:function(e,t){return t.offset*8},divisor:1},positionFract:{buffer:d,offset:function(e,t){return t.offset*8},divisor:1},error:{buffer:m,offset:function(e,t){return t.offset*16},divisor:1},direction:{buffer:g,stride:24,offset:0},lineOffset:{buffer:g,stride:24,offset:8},capOffset:{buffer:g,stride:24,offset:16}},primitive:"triangles",blend:{enable:true,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:false},scissor:{enable:true,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:false,instances:e.prop("count"),count:h.length});s(_,{update:T,draw:b,destroy:k,regl:e,gl:r,canvas:r.canvas,groups:x});return _;function _(e){if(e){T(e)}else if(e===null){k()}b()}function b(t){if(typeof t==="number"){return w(t)}if(t&&!Array.isArray(t)){t=[t]}e._refresh();x.forEach(function(e,r){if(!e){return}if(t){if(!t[r]){e.draw=false}else{e.draw=true}}if(!e.draw){e.draw=true;return}w(r)})}function w(e){if(typeof e==="number"){e=x[e]}if(e==null){return}if(!(e&&e.count&&e.color&&e.opacity&&e.positions&&e.positions.length>1)){return}e.scaleRatio=[e.scale[0]*e.viewport.width,e.scale[1]*e.viewport.height];u(e);if(e.after){e.after(e)}}function T(e){if(!e){return}if(e.length!=null){if(typeof e[0]==="number"){e=[{positions:e}]}}else if(!Array.isArray(e)){e=[e]}var t=0,u=0;_.groups=x=e.map(function(e,c){var h=x[c];if(!e){return h}else if(typeof e==="function"){e={after:e}}else if(typeof e[0]==="number"){e={positions:e}}e=o(e,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"});if(!h){x[c]=h={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:true};e=s({},y,e)}i(h,e,[{lineWidth:function(e){return+e*.5},capSize:function(e){return+e*.5},opacity:parseFloat,errors:function(e){e=l(e);u+=e.length;return e},positions:function(e,r){e=l(e,"float64");r.count=Math.floor(e.length/2);r.bounds=n(e,2);r.offset=t;t+=r.count;return e}},{color:function(e,t){var r=t.count;if(!e){e="transparent"}if(!Array.isArray(e)||typeof e[0]==="number"){var n=e;e=Array(r);for(var i=0;i<r;i++){e[i]=n}}if(e.length<r){throw Error("Not enough colors")}var o=new Uint8Array(r*4);for(var s=0;s<r;s++){var l=a(e[s],"uint8");o.set(l,s*4)}return o},range:function(e,t,r){var n=t.bounds;if(!e){e=n}t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])];t.translate=[-e[0],-e[1]];t.scaleFract=f(t.scale);t.translateFract=f(t.translate);return e},viewport:function(e){var t;if(Array.isArray(e)){t={x:e[0],y:e[1],width:e[2]-e[0],height:e[3]-e[1]}}else if(e){t={x:e.x||e.left||0,y:e.y||e.top||0};if(e.right){t.width=e.right-t.x}else{t.width=e.w||e.width||0}if(e.bottom){t.height=e.bottom-t.y}else{t.height=e.h||e.height||0}}else{t={x:0,y:0,width:r.drawingBufferWidth,height:r.drawingBufferHeight}}return t}}]);return h});if(t||u){var h=x.reduce(function(e,t,r){return e+(t?t.count:0)},0);var g=new Float64Array(h*2);var b=new Uint8Array(h*4);var w=new Float32Array(h*4);x.forEach(function(e,t){if(!e){return}var r=e.positions;var n=e.count;var a=e.offset;var i=e.color;var o=e.errors;if(!n){return}b.set(i,a*4);w.set(o,a*4);g.set(r,a*2)});p(c(g));d(f(g));v(b);m(w)}}function k(){p.destroy();d.destroy();v.destroy();m.destroy();g.destroy()}}},{"array-bounds":70,"color-normalize":125,"flatten-vertex-data":244,"object-assign":499,"pick-by-alias":511,"to-float32":577,"update-diff":599}],535:[function(e,t,r){"use strict";var n=e("color-normalize");var a=e("array-bounds");var i=e("object-assign");var o=e("glslify");var s=e("pick-by-alias");var l=e("flatten-vertex-data");var u=e("earcut");var c=e("array-normalize");var f=e("to-float32");var h=f.float32;var p=f.fract32;var d=e("es6-weak-map");var v=e("parse-rect");t.exports=m;function m(e,t){if(!(this instanceof m)){return new m(e,t)}if(typeof e==="function"){if(!t){t={}}t.regl=e}else{t=e}if(t.length){t.positions=t}e=t.regl;if(!e.hasExtension("ANGLE_instanced_arrays")){throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled")}this.gl=e._gl;this.regl=e;this.passes=[];this.shaders=m.shaders.has(e)?m.shaders.get(e):m.shaders.set(e,m.createShaders(e)).get(e);this.update(t)}m.dashMult=2;m.maxPatternLength=256;m.precisionThreshold=3e6;m.maxPoints=1e4;m.maxLines=2048;m.shaders=new d;m.createShaders=function(e){var t=e.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]});var r={primitive:"triangle strip",instances:e.prop("count"),count:4,offset:0,uniforms:{miterMode:function(e,t){return t.join==="round"?2:1},miterLimit:e.prop("miterLimit"),scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),thickness:e.prop("thickness"),dashPattern:e.prop("dashTexture"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),dashSize:e.prop("dashLength"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]},depth:e.prop("depth")},blend:{enable:true,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(e,t){return!t.overlay}},stencil:{enable:false},scissor:{enable:true,box:e.prop("viewport")},viewport:e.prop("viewport")};var n=e(i({vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},r));var a;try{a=e(i({cull:{enable:true,face:"back"},vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aColor:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:e.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},r))}catch(e){a=n}var s=e({primitive:"triangle",elements:function(e,t){return t.triangles},offset:0,vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:e.prop("scale"),color:e.prop("fill"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{position:{buffer:e.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8}},blend:r.blend,depth:{enable:false},scissor:r.scissor,stencil:r.stencil,viewport:r.viewport});return{fill:s,rect:n,miter:a}};m.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:false,viewport:null,range:null,close:false,fill:null};m.prototype.render=function(){var e;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];if(t.length){(e=this).update.apply(e,t)}this.draw()};m.prototype.draw=function(){var e=this;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];(t.length?t:this.passes).forEach(function(t,r){var n;if(t&&Array.isArray(t)){return(n=e).draw.apply(n,t)}if(typeof t==="number"){t=e.passes[t]}if(!(t&&t.count>1&&t.opacity)){return}e.regl._refresh();if(t.fill&&t.triangles&&t.triangles.length>2){e.shaders.fill(t)}if(!t.thickness){return}if(t.scale[0]*t.viewport.width>m.precisionThreshold||t.scale[1]*t.viewport.height>m.precisionThreshold){e.shaders.rect(t)}else if(t.join==="rect"||!t.join&&(t.thickness<=2||t.count>=m.maxPoints)){e.shaders.rect(t)}else{e.shaders.miter(t)}});return this};m.prototype.update=function(e){var t=this;if(!e){return}if(e.length!=null){if(typeof e[0]==="number"){e=[{positions:e}]}}else if(!Array.isArray(e)){e=[e]}var r=this;var o=r.regl;var f=r.gl;e.forEach(function(e,r){var d=t.passes[r];if(e===undefined){return}if(e===null){t.passes[r]=null;return}if(typeof e[0]==="number"){e={positions:e}}e=s(e,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"});if(!d){t.passes[r]=d={id:r,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:o.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:o.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array})};e=i({},m.defaults,e)}if(e.thickness!=null){d.thickness=parseFloat(e.thickness)}if(e.opacity!=null){d.opacity=parseFloat(e.opacity)}if(e.miterLimit!=null){d.miterLimit=parseFloat(e.miterLimit)}if(e.overlay!=null){d.overlay=!!e.overlay;if(r<m.maxLines){d.depth=2*(m.maxLines-1-r%m.maxLines)/m.maxLines-1}}if(e.join!=null){d.join=e.join}if(e.hole!=null){d.hole=e.hole}if(e.fill!=null){d.fill=!e.fill?null:n(e.fill,"uint8")}if(e.viewport!=null){d.viewport=v(e.viewport)}if(!d.viewport){d.viewport=v([f.drawingBufferWidth,f.drawingBufferHeight])}if(e.close!=null){d.close=e.close}if(e.positions===null){e.positions=[]}if(e.positions){var g,y;if(e.positions.x&&e.positions.y){var x=e.positions.x;var _=e.positions.y;y=d.count=Math.max(x.length,_.length);g=new Float64Array(y*2);for(var b=0;b<y;b++){g[b*2]=x[b];g[b*2+1]=_[b]}}else{g=l(e.positions,"float64");y=d.count=Math.floor(g.length/2)}var w=d.bounds=a(g,2);if(d.fill){var T=[];var k={};var A=0;for(var M=0,E=0,S=d.count;M<S;M++){var C=g[M*2];var L=g[M*2+1];if(isNaN(C)||isNaN(L)||C==null||L==null){C=g[A*2];L=g[A*2+1];k[M]=A}else{A=M}T[E++]=C;T[E++]=L}var I=u(T,d.hole||[]);for(var O=0,P=I.length;O<P;O++){if(k[I[O]]!=null){I[O]=k[I[O]]}}d.triangles=I}var D=new Float64Array(g);c(D,2,w);var R=new Float64Array(y*2+6);if(d.close){if(g[0]===g[y*2-2]&&g[1]===g[y*2-1]){R[0]=D[y*2-4];R[1]=D[y*2-3]}else{R[0]=D[y*2-2];R[1]=D[y*2-1]}}else{R[0]=D[0];R[1]=D[1]}R.set(D,2);if(d.close){if(g[0]===g[y*2-2]&&g[1]===g[y*2-1]){R[y*2+2]=D[2];R[y*2+3]=D[3];d.count-=1}else{R[y*2+2]=D[0];R[y*2+3]=D[1];R[y*2+4]=D[2];R[y*2+5]=D[3]}}else{R[y*2+2]=D[y*2-2];R[y*2+3]=D[y*2-1];R[y*2+4]=D[y*2-2];R[y*2+5]=D[y*2-1]}d.positionBuffer(h(R));d.positionFractBuffer(p(R))}if(e.range){d.range=e.range}else if(!d.range){d.range=d.bounds}if((e.range||e.positions)&&d.count){var z=d.bounds;var N=z[2]-z[0],F=z[3]-z[1];var B=d.range[2]-d.range[0],j=d.range[3]-d.range[1];d.scale=[N/B,F/j];d.translate=[-d.range[0]/B+z[0]/B||0,-d.range[1]/j+z[1]/j||0];d.scaleFract=p(d.scale);d.translateFract=p(d.translate)}if(e.dashes){var U=0,H;if(!e.dashes||e.dashes.length<2){U=1;H=new Uint8Array([255,255,255,255,255,255,255,255])}else{U=0;for(var V=0;V<e.dashes.length;++V){U+=e.dashes[V]}H=new Uint8Array(U*m.dashMult);var G=0;var q=255;for(var Y=0;Y<2;Y++){for(var W=0;W<e.dashes.length;++W){for(var X=0,Z=e.dashes[W]*m.dashMult*.5;X<Z;++X){H[G++]=q}q^=255}}}d.dashLength=U;d.dashTexture({channels:1,data:H,width:H.length,height:1,mag:"linear",min:"linear"},0,0)}if(e.color){var K=d.count;var J=e.color;if(!J){J="transparent"}var Q=new Uint8Array(K*4+4);if(!Array.isArray(J)||typeof J[0]==="number"){var $=n(J,"uint8");for(var ee=0;ee<K+1;ee++){Q.set($,ee*4)}}else{for(var te=0;te<K;te++){var re=n(J[te],"uint8");Q.set(re,te*4)}Q.set(n(J[0],"uint8"),K*4)}d.colorBuffer({usage:"dynamic",type:"uint8",data:Q})}});if(e.length<this.passes.length){for(var d=e.length;d<this.passes.length;d++){var g=this.passes[d];if(!g){continue}g.colorBuffer.destroy();g.positionBuffer.destroy();g.dashTexture.destroy()}this.passes.length=e.length}var y=[];for(var x=0;x<this.passes.length;x++){if(this.passes[x]!==null){y.push(this.passes[x])}}this.passes=y;return this};m.prototype.destroy=function(){this.passes.forEach(function(e){e.colorBuffer.destroy();e.positionBuffer.destroy();e.dashTexture.destroy()});this.passes.length=0;return this}},{"array-bounds":70,"array-normalize":71,"color-normalize":125,earcut:177,"es6-weak-map":233,"flatten-vertex-data":244,glslify:536,"object-assign":499,"parse-rect":504,"pick-by-alias":511,"to-float32":577}],536:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],537:[function(e,t,r){"use strict";function n(e,t){return o(e)||l(e,t)||u(e,t)||h()}function a(e){return i(e)||s(e)||u(e)||f()}function i(e){if(Array.isArray(e))return c(e)}function o(e){if(Array.isArray(e))return e}function s(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function l(e,t){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(e)))return;var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return r}function u(e,t){if(!e)return;if(typeof e==="string")return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}function c(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p=e("color-normalize");var d=e("array-bounds");var v=e("color-id");var m=e("@plotly/point-cluster");var g=e("object-assign");var y=e("glslify");var x=e("pick-by-alias");var _=e("update-diff");var b=e("flatten-vertex-data");var w=e("is-iexplorer");var T=e("to-float32");var k=e("parse-rect");var A=M;function M(e,t){var r=this;if(!(this instanceof M))return new M(e,t);if(typeof e==="function"){if(!t)t={};t.regl=e}else{t=e;e=null}if(t&&t.length)t.positions=t;e=t.regl;var n=e._gl,a,i=[],o={},s=[],l=[null],u=[null];var c=255,f=100;this.tooManyColors=w;a=e.texture({data:new Uint8Array(c*4),width:c,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"});g(this,{regl:e,gl:n,groups:s,markerCache:u,markerTextures:l,palette:i,paletteIds:o,paletteTexture:a,maxColors:c,maxSize:f,canvas:n.canvas});this.update(t);var h={uniforms:{constPointSize:!!t.constPointSize,pixelRatio:e.context("pixelRatio"),palette:a,paletteSize:function e(t,n){return[r.tooManyColors?0:c,a.height]},scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translate:e.prop("translate"),translateFract:e.prop("translateFract"),opacity:e.prop("opacity"),marker:e.prop("markerTexture")},attributes:{x:function e(t,r){return r.xAttr||{buffer:r.positionBuffer,stride:8,offset:0}},y:function e(t,r){return r.yAttr||{buffer:r.positionBuffer,stride:8,offset:4}},xFract:function e(t,r){return r.xAttr?{constant:[0,0]}:{buffer:r.positionFractBuffer,stride:8,offset:0}},yFract:function e(t,r){return r.yAttr?{constant:[0,0]}:{buffer:r.positionFractBuffer,stride:8,offset:4}},size:function e(t,n){return n.size.length?{buffer:n.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(n.size*255/r.maxSize)]}},borderSize:function e(t,n){return n.borderSize.length?{buffer:n.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(n.borderSize*255/r.maxSize)]}},colorId:function e(t,n){return n.color.length?{buffer:n.colorBuffer,stride:r.tooManyColors?8:4,offset:0}:{constant:r.tooManyColors?i.slice(n.color*4,n.color*4+4):[n.color]}},borderColorId:function e(t,n){return n.borderColor.length?{buffer:n.colorBuffer,stride:r.tooManyColors?8:4,offset:r.tooManyColors?4:2}:{constant:r.tooManyColors?i.slice(n.borderColor*4,n.borderColor*4+4):[n.borderColor]}},isActive:function e(t,r){return r.activation===true?{constant:[1]}:r.activation?r.activation:{constant:[0]}}},blend:{enable:true,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:true,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:{enable:false},depth:{enable:false},elements:e.prop("elements"),count:e.prop("count"),offset:e.prop("offset"),primitive:"points"};var p=g({},h);p.frag=y(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]);p.vert=y(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform bool constPointSize;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]);this.drawMarker=e(p);var d=g({},h);d.frag=y(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]);d.vert=y(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform bool constPointSize;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]);if(w){d.frag=d.frag.replace("smoothstep","smoothStep");p.frag=p.frag.replace("smoothstep","smoothStep")}this.drawCircle=e(d)}M.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:undefined,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4};M.prototype.render=function(){if(arguments.length){this.update.apply(this,arguments)}this.draw();return this};M.prototype.draw=function(){var e=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}var a=this.groups;if(r.length===1&&Array.isArray(r[0])&&(r[0][0]===null||Array.isArray(r[0][0]))){r=r[0]}this.regl._refresh();if(r.length){for(var i=0;i<r.length;i++){this.drawItem(i,r[i])}}else{a.forEach(function(t,r){e.drawItem(r)})}return this};M.prototype.drawItem=function(e,t){var r=this.groups;var n=r[e];if(typeof t==="number"){e=t;n=r[t];t=null}if(!(n&&n.count&&n.opacity))return;if(n.activation[0]){this.drawCircle(this.getMarkerDrawOptions(0,n,t))}var i=[];for(var o=1;o<n.activation.length;o++){if(!n.activation[o]||n.activation[o]!==true&&!n.activation[o].data.length)continue;i.push.apply(i,a(this.getMarkerDrawOptions(o,n,t)))}if(i.length){this.drawMarker(i)}};M.prototype.getMarkerDrawOptions=function(e,t,r){var a=t.range,i=t.tree,o=t.viewport,s=t.activation,l=t.selectionBuffer,u=t.count;var c=this.regl;if(!i){if(r){return[g({},t,{markerTexture:this.markerTextures[e],activation:s[e],count:r.length,elements:r,offset:0})]}return[g({},t,{markerTexture:this.markerTextures[e],activation:s[e],offset:0})]}var f=[];var h=i.range(a,{lod:true,px:[(a[2]-a[0])/o.width,(a[3]-a[1])/o.height]});if(r){var p=s[e];var d=p.data;var v=new Uint8Array(u);for(var m=0;m<r.length;m++){var y=r[m];v[y]=d?d[y]:1}l.subdata(v)}for(var x=h.length;x--;){var _=n(h[x],2),b=_[0],w=_[1];f.push(g({},t,{markerTexture:this.markerTextures[e],activation:r?l:s[e],offset:b,count:w-b}))}return f};M.prototype.update=function(){var e=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}if(!r.length)return;if(r.length===1&&Array.isArray(r[0]))r=r[0];var a=this.groups,i=this.gl,o=this.regl,s=this.maxSize,l=this.maxColors,u=this.palette;this.groups=a=r.map(function(t,r){var n=a[r];if(t===undefined)return n;if(t===null)t={positions:null};else if(typeof t==="function")t={ondraw:t};else if(typeof t[0]==="number")t={positions:t};t=x(t,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"});if(t.positions===null)t.positions=[];if(t.tooManyColors!=null)e.tooManyColors=t.tooManyColors;if(!n){a[r]=n={id:r,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:o.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})};t=g({},M.defaults,t)}if(t.positions&&!("marker"in t)){t.marker=n.marker;delete n.marker}if(t.marker&&!("positions"in t)){t.positions=n.positions;delete n.positions}var c=0,f=0;_(n,t,[{snap:true,size:function e(t,r){if(t==null)t=M.defaults.size;c+=t&&t.length?1:0;return t},borderSize:function e(t,r){if(t==null)t=M.defaults.borderSize;c+=t&&t.length?1:0;return t},opacity:parseFloat,color:function t(r,n){if(r==null)r=M.defaults.color;r=e.updateColor(r);f++;return r},borderColor:function t(r,n){if(r==null)r=M.defaults.borderColor;r=e.updateColor(r);f++;return r},bounds:function e(t,r,n){if(!("range"in n))n.range=null;return t},positions:function e(t,r,n){var a=r.snap;var i=r.positionBuffer,s=r.positionFractBuffer,l=r.selectionBuffer;if(t.x||t.y){if(t.x.length){r.xAttr={buffer:o.buffer(t.x),offset:0,stride:4,count:t.x.length}}else{r.xAttr={buffer:t.x.buffer,offset:t.x.offset*4||0,stride:(t.x.stride||1)*4,count:t.x.count}}if(t.y.length){r.yAttr={buffer:o.buffer(t.y),offset:0,stride:4,count:t.y.length}}else{r.yAttr={buffer:t.y.buffer,offset:t.y.offset*4||0,stride:(t.y.stride||1)*4,count:t.y.count}}r.count=Math.max(r.xAttr.count,r.yAttr.count);return t}t=b(t,"float64");var u=r.count=Math.floor(t.length/2);var c=r.bounds=u?d(t,2):null;if(!n.range&&!r.range){delete r.range;n.range=c}if(!n.marker&&!r.marker){delete r.marker;n.marker=null}if(a&&(a===true||u>a)){r.tree=m(t,{bounds:c})}else if(a&&a.length){r.tree=a}if(r.tree){var f={primitive:"points",usage:"static",data:r.tree,type:"uint32"};if(r.elements)r.elements(f);else r.elements=o.elements(f)}i({data:T.float(t),usage:"dynamic"});s({data:T.fract(t),usage:"dynamic"});l({data:new Uint8Array(u),type:"uint8",usage:"stream"});return t}},{marker:function t(r,n,a){var i=n.activation;i.forEach(function(e){return e&&e.destroy&&e.destroy()});i.length=0;if(!r||typeof r[0]==="number"){var s=e.addMarker(r);i[s]=true}else{var l=[];for(var u=0,c=Math.min(r.length,n.count);u<c;u++){var f=e.addMarker(r[u]);if(!l[f])l[f]=new Uint8Array(n.count);l[f][u]=1}for(var h=0;h<l.length;h++){if(!l[h])continue;var p={data:l[h],type:"uint8",usage:"static"};if(!i[h]){i[h]=o.buffer(p)}else{i[h](p)}i[h].data=l[h]}}return r},range:function e(t,r,n){var a=r.bounds;if(!a)return;if(!t)t=a;r.scale=[1/(t[2]-t[0]),1/(t[3]-t[1])];r.translate=[-t[0],-t[1]];r.scaleFract=T.fract(r.scale);r.translateFract=T.fract(r.translate);return t},viewport:function e(t){var r=k(t||[i.drawingBufferWidth,i.drawingBufferHeight]);return r}}]);if(c){var h=n,p=h.count,v=h.size,y=h.borderSize,w=h.sizeBuffer;var A=new Uint8Array(p*2);if(v.length||y.length){for(var E=0;E<p;E++){A[E*2]=Math.round((v[E]==null?v:v[E])*255/s);A[E*2+1]=Math.round((y[E]==null?y:y[E])*255/s)}}w({data:A,usage:"dynamic"})}if(f){var S=n,C=S.count,L=S.color,I=S.borderColor,O=S.colorBuffer;var P;if(e.tooManyColors){if(L.length||I.length){P=new Uint8Array(C*8);for(var D=0;D<C;D++){var R=L[D];P[D*8]=u[R*4];P[D*8+1]=u[R*4+1];P[D*8+2]=u[R*4+2];P[D*8+3]=u[R*4+3];var z=I[D];P[D*8+4]=u[z*4];P[D*8+5]=u[z*4+1];P[D*8+6]=u[z*4+2];P[D*8+7]=u[z*4+3]}}}else{if(L.length||I.length){P=new Uint8Array(C*4+2);for(var N=0;N<C;N++){if(L[N]!=null){P[N*4]=L[N]%l;P[N*4+1]=Math.floor(L[N]/l)}if(I[N]!=null){P[N*4+2]=I[N]%l;P[N*4+3]=Math.floor(I[N]/l)}}}}O({data:P||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return n})};M.prototype.addMarker=function(e){var t=this.markerTextures,r=this.regl,n=this.markerCache;var a=e==null?0:n.indexOf(e);if(a>=0)return a;var i;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray){i=e}else{i=new Uint8Array(e.length);for(var o=0,s=e.length;o<s;o++){i[o]=e[o]*255}}var l=Math.floor(Math.sqrt(i.length));a=t.length;n.push(e);t.push(r.texture({channels:1,data:i,radius:l,mag:"linear",min:"linear"}));return a};M.prototype.updateColor=function(e){var t=this.paletteIds,r=this.palette,n=this.maxColors;if(!Array.isArray(e)){e=[e]}var a=[];if(typeof e[0]==="number"){var i=[];if(Array.isArray(e)){for(var o=0;o<e.length;o+=4){i.push(e.slice(o,o+4))}}else{for(var s=0;s<e.length;s+=4){i.push(e.subarray(s,s+4))}}e=i}for(var l=0;l<e.length;l++){var u=e[l];u=p(u,"uint8");var c=v(u,false);if(t[c]==null){var f=r.length;t[c]=Math.floor(f/4);r[f]=u[0];r[f+1]=u[1];r[f+2]=u[2];r[f+3]=u[3]}a[l]=t[c]}if(!this.tooManyColors&&r.length>n*4)this.tooManyColors=true;this.updatePalette(r);return a.length===1?a[0]:a};M.prototype.updatePalette=function(e){if(this.tooManyColors)return;var t=this.maxColors,r=this.paletteTexture;var n=Math.ceil(e.length*.25/t);if(n>1){e=e.slice();for(var a=e.length*.25%t;a<n*t;a++){e.push(0,0,0,0)}}if(r.height<n){r.resize(t,n)}r.subimage({width:Math.min(e.length*.25,t),height:n,data:e},0,0)};M.prototype.destroy=function(){this.groups.forEach(function(e){e.sizeBuffer.destroy();e.positionBuffer.destroy();e.positionFractBuffer.destroy();e.colorBuffer.destroy();e.activation.forEach(function(e){return e&&e.destroy&&e.destroy()});e.selectionBuffer.destroy();if(e.elements)e.elements.destroy()});this.groups.length=0;this.paletteTexture.destroy();this.markerTextures.forEach(function(e){return e&&e.destroy&&e.destroy()});return this};var E=e("object-assign");var S=function e(t,r){var n=new A(t,r);var a=n.render.bind(n);E(a,{render:a,update:n.update.bind(n),draw:n.draw.bind(n),destroy:n.destroy.bind(n),regl:n.regl,gl:n.gl,canvas:n.gl.canvas,groups:n.groups,markers:n.markerCache,palette:n.palette});return a};t.exports=S},{"@plotly/point-cluster":57,"array-bounds":70,"color-id":123,"color-normalize":125,"flatten-vertex-data":244,glslify:538,"is-iexplorer":466,"object-assign":499,"parse-rect":504,"pick-by-alias":511,"to-float32":577,"update-diff":599}],538:[function(e,t,r){arguments[4][257][0].apply(r,arguments)},{dup:257}],539:[function(e,t,r){"use strict";var n=e("regl-scatter2d");var a=e("pick-by-alias");var i=e("array-bounds");var o=e("raf");var s=e("array-range");var l=e("parse-rect");var u=e("flatten-vertex-data");t.exports=c;function c(e,t){if(!(this instanceof c)){return new c(e,t)}this.traces=[];this.passes={};this.regl=e;this.scatter=n(e);this.canvas=this.scatter.canvas}c.prototype.render=function(){var e=this;var t;var r=[],n=arguments.length;while(n--)r[n]=arguments[n];if(r.length){(t=this).update.apply(t,r)}if(this.regl.attributes.preserveDrawingBuffer){return this.draw()}if(this.dirty){if(this.planned==null){this.planned=o(function(){e.draw();e.dirty=true;e.planned=null})}}else{this.draw();this.dirty=true;o(function(){e.dirty=false})}return this};c.prototype.update=function(){var e;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];if(!t.length){return}for(var n=0;n<t.length;n++){this.updateItem(n,t[n])}this.traces=this.traces.filter(Boolean);var a=[];var i=0;for(var o=0;o<this.traces.length;o++){var s=this.traces[o];var l=this.traces[o].passes;for(var u=0;u<l.length;u++){a.push(this.passes[l[u]])}s.passOffset=i;i+=s.passes.length}(e=this.scatter).update.apply(e,a);return this};c.prototype.updateItem=function(e,t){var r=this;var n=r.regl;if(t===null){this.traces[e]=null;return this}if(!t){return this}var o=a(t,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"});var s=this.traces[e]||(this.traces[e]={id:e,buffer:n.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:l([n._gl.drawingBufferWidth,n._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:true,upper:true,lower:true});if(o.color!=null){s.color=o.color}if(o.size!=null){s.size=o.size}if(o.marker!=null){s.marker=o.marker}if(o.borderColor!=null){s.borderColor=o.borderColor}if(o.borderSize!=null){s.borderSize=o.borderSize}if(o.opacity!=null){s.opacity=o.opacity}if(o.viewport){s.viewport=l(o.viewport)}if(o.diagonal!=null){s.diagonal=o.diagonal}if(o.upper!=null){s.upper=o.upper}if(o.lower!=null){s.lower=o.lower}if(o.data){s.buffer(u(o.data));s.columns=o.data.length;s.count=o.data[0].length;s.bounds=[];for(var c=0;c<s.columns;c++){s.bounds[c]=i(o.data[c],1)}}var d;if(o.range){s.range=o.range;d=s.range&&typeof s.range[0]!=="number"}if(o.domain){s.domain=o.domain}var v=false;if(o.padding!=null){if(Array.isArray(o.padding)&&o.padding.length===s.columns&&typeof o.padding[o.padding.length-1]==="number"){s.padding=o.padding.map(p);v=true}else{s.padding=p(o.padding)}}var m=s.columns;var g=s.count;var y=s.viewport.width;var x=s.viewport.height;var _=s.viewport.x;var b=s.viewport.y;var w=y/m;var T=x/m;s.passes=[];for(var k=0;k<m;k++){for(var A=0;A<m;A++){if(!s.diagonal&&A===k){continue}if(!s.upper&&k>A){continue}if(!s.lower&&k<A){continue}var M=f(s.id,k,A);var E=this.passes[M]||(this.passes[M]={});if(o.data){if(o.transpose){E.positions={x:{buffer:s.buffer,offset:A,count:g,stride:m},y:{buffer:s.buffer,offset:k,count:g,stride:m}}}else{E.positions={x:{buffer:s.buffer,offset:A*g,count:g},y:{buffer:s.buffer,offset:k*g,count:g}}}E.bounds=h(s.bounds,k,A)}if(o.domain||o.viewport||o.data){var S=v?h(s.padding,k,A):s.padding;if(s.domain){var C=h(s.domain,k,A);var L=C[0];var I=C[1];var O=C[2];var P=C[3];E.viewport=[_+L*y+S[0],b+I*x+S[1],_+O*y-S[2],b+P*x-S[3]]}else{E.viewport=[_+A*w+w*S[0],b+k*T+T*S[1],_+(A+1)*w-w*S[2],b+(k+1)*T-T*S[3]]}}if(o.color){E.color=s.color}if(o.size){E.size=s.size}if(o.marker){E.marker=s.marker}if(o.borderSize){E.borderSize=s.borderSize}if(o.borderColor){E.borderColor=s.borderColor}if(o.opacity){E.opacity=s.opacity}if(o.range){E.range=d?h(s.range,k,A):s.range||E.bounds}s.passes.push(M)}}return this};c.prototype.draw=function(){var e;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];if(!t.length){this.scatter.draw()}else{var n=[];for(var a=0;a<t.length;a++){if(typeof t[a]==="number"){var i=this.traces[t[a]];var o=i.passes;var l=i.passOffset;n.push.apply(n,s(l,l+o.length))}else if(t[a].length){var u=t[a];var c=this.traces[a];var f=c.passes;var h=c.passOffset;f=f.map(function(e,t){n[h+t]=u})}}(e=this.scatter).draw.apply(e,n)}return this};c.prototype.destroy=function(){this.traces.forEach(function(e){if(e.buffer&&e.buffer.destroy){e.buffer.destroy()}});this.traces=null;this.passes=null;this.scatter.destroy();return this};function f(e,t,r){var n=e.id!=null?e.id:e;var a=t;var i=r;var o=n<<16|(a&255)<<8|i&255;return o}function h(e,t,r){var n,a,i,o,s,l,u,c;var f=e[t],h=e[r];if(f.length>2){n=f[0];i=f[2];a=f[1];o=f[3]}else if(f.length){n=a=f[0];i=o=f[1]}else{n=f.x;a=f.y;i=f.x+f.width;o=f.y+f.height}if(h.length>2){s=h[0];u=h[2];l=h[1];c=h[3]}else if(h.length){s=l=h[0];u=c=h[1]}else{s=h.x;l=h.y;u=h.x+h.width;c=h.y+h.height}return[s,a,u,o]}function p(e){if(typeof e==="number"){return[e,e,e,e]}else if(e.length===2){return[e[0],e[1],e[0],e[1]]}else{var t=l(e);return[t.x,t.y,t.x+t.width,t.y+t.height]}}},{"array-bounds":70,"array-range":72,"flatten-vertex-data":244,"parse-rect":504,"pick-by-alias":511,raf:528,"regl-scatter2d":537}],540:[function(t,r,n){(function(t,a){"object"===typeof n&&"undefined"!==typeof r?r.exports=a():"function"===typeof e&&e.amd?e(a):t.createREGL=a()})(this,function(){function e(e,t){this.id=X++;this.type=e;this.data=t}function t(e){if(0===e.length)return[];var r=e.charAt(0),n=e.charAt(e.length-1);if(1<e.length&&r===n&&('"'===r||"'"===r))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,r.index)).concat(t(r[1])).concat(t(e.substr(r.index+r[0].length)));r=e.split(".");if(1===r.length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];e=[];for(n=0;n<r.length;++n)e=e.concat(t(r[n]));return e}function r(e){return"["+t(e).join("][")+"]"}function n(){var e={"":0},t=[""];return{id:function(r){var n=e[r];if(n)return n;n=e[r]=t.length;t.push(r);return n},str:function(e){return t[e]}}}function a(e,t,r){function n(){var t=window.innerWidth,n=window.innerHeight;e!==document.body&&(n=e.getBoundingClientRect(),t=n.right-n.left,n=n.bottom-n.top);a.width=r*t;a.height=r*n;W(a.style,{width:t+"px",height:n+"px"})}var a=document.createElement("canvas");W(a.style,{border:0,margin:0,padding:0,top:0,left:0});e.appendChild(a);e===document.body&&(a.style.position="absolute",W(e.style,{margin:0,padding:0}));var i;e!==document.body&&"function"===typeof ResizeObserver?(i=new ResizeObserver(function(){setTimeout(n)}),i.observe(e)):window.addEventListener("resize",n,!1);n();return{canvas:a,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",n);e.removeChild(a)}}}function i(e,t){function r(r){try{return e.getContext(r,t)}catch(e){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}function o(e){return"string"===typeof e?e.split():e}function s(e){return"string"===typeof e?document.querySelector(e):e}function l(e){var t=e||{},r,n,l,u;e={};var c=[],f=[],h="undefined"===typeof window?1:window.devicePixelRatio,p=!1,d=function(e){},v=function(){};"string"===typeof t?r=document.querySelector(t):"object"===typeof t&&("string"===typeof t.nodeName&&"function"===typeof t.appendChild&&"function"===typeof t.getBoundingClientRect?r=t:"function"===typeof t.drawArrays||"function"===typeof t.drawElements?(u=t,l=u.canvas):("gl"in t?u=t.gl:"canvas"in t?l=s(t.canvas):"container"in t&&(n=s(t.container)),"attributes"in t&&(e=t.attributes),"extensions"in t&&(c=o(t.extensions)),"optionalExtensions"in t&&(f=o(t.optionalExtensions)),"onDone"in t&&(d=t.onDone),"profile"in t&&(p=!!t.profile),"pixelRatio"in t&&(h=+t.pixelRatio)));r&&("canvas"===r.nodeName.toLowerCase()?l=r:n=r);if(!u){if(!l){r=a(n||document.body,d,h);if(!r)return null;l=r.canvas;v=r.onDestroy}void 0===e.premultipliedAlpha&&(e.premultipliedAlpha=!0);u=i(l,e)}return u?{gl:u,canvas:l,container:n,extensions:c,optionalExtensions:f,pixelRatio:h,profile:p,onDone:d,onDestroy:v}:(v(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function u(e,t){function r(t){t=t.toLowerCase();var r;try{r=n[t]=e.getExtension(t)}catch(e){}return!!r}for(var n={},a=0;a<t.extensions.length;++a){var i=t.extensions[a];if(!r(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}t.optionalExtensions.forEach(r);return{extensions:n,restore:function(){Object.keys(n).forEach(function(e){if(n[e]&&!r(e))throw Error("(regl): error restoring extension "+e)})}}}function c(e,t){for(var r=Array(e),n=0;n<e;++n)r[n]=t(n);return r}function f(e){var t,r;t=(65535<e)<<4;e>>>=t;r=(255<e)<<3;e>>>=r;t|=r;r=(15<e)<<2;e>>>=r;t|=r;r=(3<e)<<1;return t|r|e>>>r>>1}function h(){function e(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}t=r[f(e)>>2];return 0<t.length?t.pop():new ArrayBuffer(e)}function t(e){r[f(e.byteLength)>>2].push(e)}var r=c(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,r){var n=null;switch(t){case 5120:n=new Int8Array(e(r),0,r);break;case 5121:n=new Uint8Array(e(r),0,r);break;case 5122:n=new Int16Array(e(2*r),0,r);break;case 5123:n=new Uint16Array(e(2*r),0,r);break;case 5124:n=new Int32Array(e(4*r),0,r);break;case 5125:n=new Uint32Array(e(4*r),0,r);break;case 5126:n=new Float32Array(e(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n},freeType:function(e){t(e.buffer)}}}function p(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||ee(e.data))}function d(e,t,r,n,a,i){for(var o=0;o<t;++o)for(var s=e[o],l=0;l<r;++l)for(var u=s[l],c=0;c<n;++c)a[i++]=u[c]}function v(e,t,r,n,a){for(var i=1,o=r+1;o<t.length;++o)i*=t[o];var s=t[r];if(4===t.length-r){var l=t[r+1],u=t[r+2];t=t[r+3];for(o=0;o<s;++o)d(e[o],l,u,t,n,a),a+=i}else for(o=0;o<s;++o)v(e[o],t,r+1,n,a),a+=i}function m(e){return ne[Object.prototype.toString.call(e)]|0}function g(e,t){for(var r=0;r<t.length;++r)e[r]=t[r]}function y(e,t,r,n,a,i,o){for(var s=0,l=0;l<r;++l)for(var u=0;u<n;++u)e[s++]=t[a*l+i*u+o]}function x(e,t,r,n){function a(t){this.id=l++;this.buffer=e.createBuffer();this.type=t;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;r.profile&&(this.stats={size:0})}function i(t,r,n){t.byteLength=r.byteLength;e.bufferData(t.type,r,n)}function o(e,t,r,n,a,o){e.usage=r;if(Array.isArray(t)){if(e.dtype=n||5126,0<t.length)if(Array.isArray(t[0])){a=se(t);for(var s=n=1;s<a.length;++s)n*=a[s];e.dimension=n;t=oe(t,a,e.dtype);i(e,t,r);o?e.persistentData=t:Q.freeType(t)}else"number"===typeof t[0]?(e.dimension=a,a=Q.allocType(e.dtype,t.length),g(a,t),i(e,a,r),o?e.persistentData=a:Q.freeType(a)):ee(t[0])&&(e.dimension=t[0].length,e.dtype=n||m(t[0])||5126,t=oe(t,[t.length,t[0].length],e.dtype),i(e,t,r),o?e.persistentData=t:Q.freeType(t))}else if(ee(t))e.dtype=n||m(t),e.dimension=a,i(e,t,r),o&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(p(t)){a=t.shape;var l=t.stride,s=t.offset,u=0,c=0,f=0,h=0;1===a.length?(u=a[0],c=1,f=l[0],h=0):2===a.length&&(u=a[0],c=a[1],f=l[0],h=l[1]);e.dtype=n||m(t.data)||5126;e.dimension=c;a=Q.allocType(e.dtype,u*c);y(a,t.data,u,c,f,h,s);i(e,a,r);o?e.persistentData=a:Q.freeType(a)}else t instanceof ArrayBuffer&&(e.dtype=5121,e.dimension=a,i(e,t,r),o&&(e.persistentData=new Uint8Array(new Uint8Array(t))))}function s(r){t.bufferCount--;n(r);e.deleteBuffer(r.buffer);r.buffer=null;delete u[r.id]}var l=0,u={};a.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)};a.prototype.destroy=function(){s(this)};var c=[];r.profile&&(t.getTotalBufferSize=function(){var e=0;Object.keys(u).forEach(function(t){e+=u[t].stats.size});return e});return{create:function(n,i,l,c){function f(t){var n=35044,a=null,i=0,s=0,l=1;Array.isArray(t)||ee(t)||p(t)||t instanceof ArrayBuffer?a=t:"number"===typeof t?i=t|0:t&&("data"in t&&(a=t.data),"usage"in t&&(n=ie[t.usage]),"type"in t&&(s=ae[t.type]),"dimension"in t&&(l=t.dimension|0),"length"in t&&(i=t.length|0));h.bind();a?o(h,a,n,s,l,c):(i&&e.bufferData(h.type,i,n),h.dtype=s||5121,h.usage=n,h.dimension=l,h.byteLength=i);r.profile&&(h.stats.size=h.byteLength*le[h.dtype]);return f}t.bufferCount++;var h=new a(i);u[h.id]=h;l||f(n);f._reglType="buffer";f._buffer=h;f.subdata=function(t,r){var n=(r||0)|0,a;h.bind();if(ee(t)||t instanceof ArrayBuffer)e.bufferSubData(h.type,n,t);else if(Array.isArray(t)){if(0<t.length)if("number"===typeof t[0]){var i=Q.allocType(h.dtype,t.length);g(i,t);e.bufferSubData(h.type,n,i);Q.freeType(i)}else if(Array.isArray(t[0])||ee(t[0]))a=se(t),i=oe(t,a,h.dtype),e.bufferSubData(h.type,n,i),Q.freeType(i)}else if(p(t)){a=t.shape;var o=t.stride,s=i=0,l=0,u=0;1===a.length?(i=a[0],s=1,l=o[0],u=0):2===a.length&&(i=a[0],s=a[1],l=o[0],u=o[1]);a=Array.isArray(t.data)?h.dtype:m(t.data);a=Q.allocType(a,i*s);y(a,t.data,i,s,l,u,t.offset);e.bufferSubData(h.type,n,a);Q.freeType(a)}return f};r.profile&&(f.stats=h.stats);f.destroy=function(){s(h)};return f},createStream:function(e,t){var r=c.pop();r||(r=new a(e));r.bind();o(r,t,35040,0,1,!1);return r},destroyStream:function(e){c.push(e)},clear:function(){te(u).forEach(s);c.forEach(s)},getBuffer:function(e){return e&&e._buffer instanceof a?e._buffer:null},restore:function(){te(u).forEach(function(t){t.buffer=e.createBuffer();e.bindBuffer(t.type,t.buffer);e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:o}}function _(e,t,r,n){function a(e){this.id=l++;s[this.id]=this;this.buffer=e;this.primType=4;this.type=this.vertCount=0}function i(n,a,i,o,s,l,u){n.buffer.bind();var c;a?((c=u)||ee(a)&&(!p(a)||ee(a.data))||(c=t.oes_element_index_uint?5125:5123),r._initBuffer(n.buffer,a,i,c,3)):(e.bufferData(34963,l,i),n.buffer.dtype=c||5121,n.buffer.usage=i,n.buffer.dimension=3,n.buffer.byteLength=l);c=u;if(!u){switch(n.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=5125}n.buffer.dtype=c}n.type=c;a=s;0>a&&(a=n.buffer.byteLength,5123===c?a>>=1:5125===c&&(a>>=2));n.vertCount=a;a=o;0>o&&(a=4,o=n.buffer.dimension,1===o&&(a=0),2===o&&(a=1),3===o&&(a=4));n.primType=a}function o(e){n.elementsCount--;delete s[e.id];e.buffer.destroy();e.buffer=null}var s={},l=0,u={uint8:5121,uint16:5123};t.oes_element_index_uint&&(u.uint32=5125);a.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(e,t){function s(e){if(e)if("number"===typeof e)l(e),c.primType=4,c.vertCount=e|0,c.type=5121;else{var t=null,r=35044,n=-1,a=-1,o=0,f=0;if(Array.isArray(e)||ee(e)||p(e))t=e;else if("data"in e&&(t=e.data),"usage"in e&&(r=ie[e.usage]),"primitive"in e&&(n=ue[e.primitive]),"count"in e&&(a=e.count|0),"type"in e&&(f=u[e.type]),"length"in e)o=e.length|0;else if(o=a,5123===f||5122===f)o*=2;else if(5125===f||5124===f)o*=4;i(c,t,r,n,a,o,f)}else l(),c.primType=4,c.vertCount=0,c.type=5121;return s}var l=r.create(null,34963,!0),c=new a(l._buffer);n.elementsCount++;s(e);s._reglType="elements";s._elements=c;s.subdata=function(e,t){l.subdata(e,t);return s};s.destroy=function(){o(c)};return s},createStream:function(e){var t=c.pop();t||(t=new a(r.create(null,34963,!0,!1)._buffer));i(t,e,35040,-1,-1,0,0);return t},destroyStream:function(e){c.push(e)},getElements:function(e){return"function"===typeof e&&e._elements instanceof a?e._elements:null},clear:function(){te(s).forEach(o)}}}function b(e){for(var t=Q.allocType(5123,e.length),r=0;r<e.length;++r)if(isNaN(e[r]))t[r]=65535;else if(Infinity===e[r])t[r]=31744;else if(-Infinity===e[r])t[r]=64512;else{ce[0]=e[r];var n=fe[0],a=n>>>31<<15,i=(n<<1>>>24)-127,n=n>>13&1023;t[r]=-24>i?a:-14>i?a+(n+1024>>-14-i):15<i?a+31744:a+(i+15<<10)+n}return t}function w(e){return Array.isArray(e)||ee(e)}function T(e){return"[object "+e+"]"}function k(e){return Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}function A(e){return Array.isArray(e)&&0!==e.length&&w(e[0])?!0:!1}function M(e){return Object.prototype.toString.call(e)}function E(e){if(!e)return!1;var t=M(e);return 0<=be.indexOf(t)?!0:k(e)||A(e)||p(e)}function S(e,t){36193===e.type?(e.data=b(t),Q.freeType(t)):e.data=t}function C(e,t,r,n,a,i){e="undefined"!==typeof Te[e]?Te[e]:de[e]*we[t];i&&(e*=6);if(a){for(n=0;1<=r;)n+=e*r*r,r/=2;return n}return e*r*n}function L(e,t,r,n,a,i,o){function s(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.colorSpace=37444;this.channels=this.height=this.width=0}function l(e,t){e.internalformat=t.internalformat;e.format=t.format;e.type=t.type;e.compressed=t.compressed;e.premultiplyAlpha=t.premultiplyAlpha;e.flipY=t.flipY;e.unpackAlignment=t.unpackAlignment;e.colorSpace=t.colorSpace;e.width=t.width;e.height=t.height;e.channels=t.channels}function u(e,t){if("object"===typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha);"flipY"in t&&(e.flipY=t.flipY);"alignment"in t&&(e.unpackAlignment=t.alignment);"colorSpace"in t&&(e.colorSpace=H[t.colorSpace]);"type"in t&&(e.type=V[t.type]);var r=e.width,n=e.height,a=e.channels,i=!1;"shape"in t?(r=t.shape[0],n=t.shape[1],3===t.shape.length&&(a=t.shape[2],i=!0)):("radius"in t&&(r=n=t.radius),"width"in t&&(r=t.width),"height"in t&&(n=t.height),"channels"in t&&(a=t.channels,i=!0));e.width=r|0;e.height=n|0;e.channels=a|0;r=!1;"format"in t&&(r=t.format,n=e.internalformat=G[r],e.format=ie[n],r in V&&!("type"in t)&&(e.type=V[r]),r in q&&(e.compressed=!0),r=!0);!i&&r?e.channels=de[e.format]:i&&!r&&e.channels!==pe[e.format]&&(e.format=e.internalformat=pe[e.channels])}}function c(t){e.pixelStorei(37440,t.flipY);e.pixelStorei(37441,t.premultiplyAlpha);e.pixelStorei(37443,t.colorSpace);e.pixelStorei(3317,t.unpackAlignment)}function f(){s.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function h(e,t){var r=null;E(t)?r=t:t&&(u(e,t),"x"in t&&(e.xOffset=t.x|0),"y"in t&&(e.yOffset=t.y|0),E(t.data)&&(r=t.data));if(t.copy){var n=a.viewportWidth,i=a.viewportHeight;e.width=e.width||n-e.xOffset;e.height=e.height||i-e.yOffset;e.needsCopy=!0}else if(!r)e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;else if(ee(r))e.channels=e.channels||4,e.data=r,"type"in t||5121!==e.type||(e.type=ne[Object.prototype.toString.call(r)]|0);else if(k(r)){e.channels=e.channels||4;n=r;i=n.length;switch(e.type){case 5121:case 5123:case 5125:case 5126:i=Q.allocType(e.type,i);i.set(n);e.data=i;break;case 36193:e.data=b(n)}e.alignment=1;e.needsFree=!0}else if(p(r)){n=r.data;Array.isArray(n)||5121!==e.type||(e.type=ne[Object.prototype.toString.call(n)]|0);var i=r.shape,o=r.stride,s,l,c,f;3===i.length?(c=i[2],f=o[2]):f=c=1;s=i[0];l=i[1];i=o[0];o=o[1];e.alignment=1;e.width=s;e.height=l;e.channels=c;e.format=e.internalformat=pe[c];e.needsFree=!0;s=f;r=r.offset;c=e.width;f=e.height;l=e.channels;for(var h=Q.allocType(36193===e.type?5126:e.type,c*f*l),d=0,v=0;v<f;++v)for(var m=0;m<c;++m)for(var g=0;g<l;++g)h[d++]=n[i*m+o*v+s*g+r];S(e,h)}else if(M(r)===ve||M(r)===me||M(r)===ge)M(r)===ve||M(r)===me?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(M(r)===ye)e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(M(r)===xe)e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(M(r)===_e)e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(A(r)){n=e.width||r[0].length;i=e.height||r.length;o=e.channels;o=w(r[0][0])?o||r[0][0].length:o||1;s=re.shape(r);c=1;for(f=0;f<s.length;++f)c*=s[f];c=Q.allocType(36193===e.type?5126:e.type,c);re.flatten(r,s,"",c);S(e,c);e.alignment=1;e.width=n;e.height=i;e.channels=o;e.format=e.internalformat=pe[o];e.needsFree=!0}}function d(t,r,a,i,o){var s=t.element,l=t.data,u=t.internalformat,f=t.format,h=t.type,p=t.width,d=t.height;c(t);s?e.texSubImage2D(r,o,a,i,f,h,s):t.compressed?e.compressedTexSubImage2D(r,o,a,i,u,p,d,l):t.needsCopy?(n(),e.copyTexSubImage2D(r,o,a,i,t.xOffset,t.yOffset,p,d)):e.texSubImage2D(r,o,a,i,p,d,f,h,l)}function v(){return oe.pop()||new f}function m(e){e.needsFree&&Q.freeType(e.data);f.call(e);oe.push(e)}function g(){s.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function y(e,t,r){var n=e.images[0]=v();e.mipmask=1;n.width=e.width=t;n.height=e.height=r;n.channels=e.channels=4}function x(e,t){var r=null;if(E(t))r=e.images[0]=v(),l(r,e),h(r,t),e.mipmask=1;else if(u(e,t),Array.isArray(t.mipmap))for(var n=t.mipmap,a=0;a<n.length;++a)r=e.images[a]=v(),l(r,e),r.width>>=a,r.height>>=a,h(r,n[a]),e.mipmask|=1<<a;else r=e.images[0]=v(),l(r,e),h(r,t),e.mipmask=1;l(e,e.images[0])}function _(t,r){for(var a=t.images,i=0;i<a.length&&a[i];++i){var o=a[i],s=r,l=i,u=o.element,f=o.data,h=o.internalformat,p=o.format,d=o.type,v=o.width,m=o.height;c(o);u?e.texImage2D(s,l,p,p,d,u):o.compressed?e.compressedTexImage2D(s,l,h,v,m,0,f):o.needsCopy?(n(),e.copyTexImage2D(s,l,p,o.xOffset,o.yOffset,v,m,0)):e.texImage2D(s,l,p,v,m,0,p,d,f||null)}}function T(){var e=se.pop()||new g;s.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function L(e){for(var t=e.images,r=0;r<t.length;++r)t[r]&&m(t[r]),t[r]=null;se.push(e)}function I(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function O(e,t){"min"in t&&(e.minFilter=U[t.min],0<=he.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0));"mag"in t&&(e.magFilter=j[t.mag]);var r=e.wrapS,n=e.wrapT;if("wrap"in t){var a=t.wrap;"string"===typeof a?r=n=B[a]:Array.isArray(a)&&(r=B[a[0]],n=B[a[1]])}else"wrapS"in t&&(r=B[t.wrapS]),"wrapT"in t&&(n=B[t.wrapT]);e.wrapS=r;e.wrapT=n;"anisotropic"in t&&(e.anisotropic=t.anisotropic);if("mipmap"in t){r=!1;switch(typeof t.mipmap){case"string":e.mipmapHint=F[t.mipmap];r=e.genMipmaps=!0;break;case"boolean":r=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,r=!0}!r||"min"in t||(e.minFilter=9984)}}function P(r,n){e.texParameteri(n,10241,r.minFilter);e.texParameteri(n,10240,r.magFilter);e.texParameteri(n,10242,r.wrapS);e.texParameteri(n,10243,r.wrapT);t.ext_texture_filter_anisotropic&&e.texParameteri(n,34046,r.anisotropic);r.genMipmaps&&(e.hint(33170,r.mipmapHint),e.generateMipmap(n))}function D(t){s.call(this);this.mipmask=0;this.internalformat=6408;this.id=le++;this.refCount=1;this.target=t;this.texture=e.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new I;o.profile&&(this.stats={size:0})}function R(t){e.activeTexture(33984);e.bindTexture(t.target,t.texture)}function z(){var t=fe[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function N(t){var r=t.texture,n=t.unit,a=t.target;0<=n&&(e.activeTexture(33984+n),e.bindTexture(a,null),fe[n]=null);e.deleteTexture(r);t.texture=null;t.params=null;t.pixels=null;t.refCount=0;delete ue[t.id];i.textureCount--}var F={"don't care":4352,"dont care":4352,nice:4354,fast:4353},B={repeat:10497,clamp:33071,mirror:33648},j={nearest:9728,linear:9729},U=W({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},j),H={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},G={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},q={};t.ext_srgb&&(G.srgb=35904,G.srgba=35906);t.oes_texture_float&&(V.float32=V["float"]=5126);t.oes_texture_half_float&&(V.float16=V["half float"]=36193);t.webgl_depth_texture&&(W(G,{depth:6402,"depth stencil":34041}),W(V,{uint16:5123,uint32:5125,"depth stencil":34042}));t.webgl_compressed_texture_s3tc&&W(q,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});t.webgl_compressed_texture_atc&&W(q,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});t.webgl_compressed_texture_pvrtc&&W(q,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});t.webgl_compressed_texture_etc1&&(q["rgb etc1"]=36196);var Y=Array.prototype.slice.call(e.getParameter(34467));Object.keys(q).forEach(function(e){var t=q[e];0<=Y.indexOf(t)&&(G[e]=t)});var X=Object.keys(G);r.textureFormats=X;var Z=[];Object.keys(G).forEach(function(e){Z[G[e]]=e});var K=[];Object.keys(V).forEach(function(e){K[V[e]]=e});var J=[];Object.keys(j).forEach(function(e){J[j[e]]=e});var $=[];Object.keys(U).forEach(function(e){$[U[e]]=e});var ae=[];Object.keys(B).forEach(function(e){ae[B[e]]=e});var ie=X.reduce(function(e,r){var n=G[r];6409===n||6406===n||6409===n||6410===n||6402===n||34041===n||t.ext_srgb&&(35904===n||35906===n)?e[n]=n:32855===n||0<=r.indexOf("rgba")?e[n]=6408:e[n]=6407;return e},{}),oe=[],se=[],le=0,ue={},ce=r.maxTextureUnits,fe=Array(ce).map(function(){return null});W(D.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var r=0;r<ce;++r){var n=fe[r];if(n){if(0<n.bindCount)continue;n.unit=-1}fe[r]=this;t=r;break}o.profile&&i.maxTextureUnits<t+1&&(i.maxTextureUnits=t+1);this.unit=t;e.activeTexture(33984+t);e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&N(this)}});o.profile&&(i.getTotalTextureSize=function(){var e=0;Object.keys(ue).forEach(function(t){e+=ue[t].stats.size});return e});return{create2D:function(t,r){function n(e,t){var r=a.texInfo;I.call(r);var i=T();"number"===typeof e?"number"===typeof t?y(i,e|0,t|0):y(i,e|0,e|0):e?(O(r,e),x(i,e)):y(i,1,1);r.genMipmaps&&(i.mipmask=(i.width<<1)-1);a.mipmask=i.mipmask;l(a,i);a.internalformat=i.internalformat;n.width=i.width;n.height=i.height;R(a);_(i,3553);P(r,3553);z();L(i);o.profile&&(a.stats.size=C(a.internalformat,a.type,i.width,i.height,r.genMipmaps,!1));n.format=Z[a.internalformat];n.type=K[a.type];n.mag=J[r.magFilter];n.min=$[r.minFilter];n.wrapS=ae[r.wrapS];n.wrapT=ae[r.wrapT];return n}var a=new D(3553);ue[a.id]=a;i.textureCount++;n(t,r);n.subimage=function(e,t,r,i){t|=0;r|=0;i|=0;var o=v();l(o,a);o.width=0;o.height=0;h(o,e);o.width=o.width||(a.width>>i)-t;o.height=o.height||(a.height>>i)-r;R(a);d(o,3553,t,r,i);z();m(o);return n};n.resize=function(t,r){var i=t|0,s=r|0||i;if(i===a.width&&s===a.height)return n;n.width=a.width=i;n.height=a.height=s;R(a);for(var l=0;a.mipmask>>l;++l){var u=i>>l,c=s>>l;if(!u||!c)break;e.texImage2D(3553,l,a.format,u,c,0,a.format,a.type,null)}z();o.profile&&(a.stats.size=C(a.internalformat,a.type,i,s,!1,!1));return n};n._reglType="texture2d";n._texture=a;o.profile&&(n.stats=a.stats);n.destroy=function(){a.decRef()};return n},createCube:function(t,r,n,a,s,c){function f(e,t,r,n,a,i){var s,c=p.texInfo;I.call(c);for(s=0;6>s;++s)g[s]=T();if("number"===typeof e||!e)for(e=e|0||1,s=0;6>s;++s)y(g[s],e,e);else if("object"===typeof e)if(t)x(g[0],e),x(g[1],t),x(g[2],r),x(g[3],n),x(g[4],a),x(g[5],i);else if(O(c,e),u(p,e),"faces"in e)for(e=e.faces,s=0;6>s;++s)l(g[s],p),x(g[s],e[s]);else for(s=0;6>s;++s)x(g[s],e);l(p,g[0]);p.mipmask=c.genMipmaps?(g[0].width<<1)-1:g[0].mipmask;p.internalformat=g[0].internalformat;f.width=g[0].width;f.height=g[0].height;R(p);for(s=0;6>s;++s)_(g[s],34069+s);P(c,34067);z();o.profile&&(p.stats.size=C(p.internalformat,p.type,f.width,f.height,c.genMipmaps,!0));f.format=Z[p.internalformat];f.type=K[p.type];f.mag=J[c.magFilter];f.min=$[c.minFilter];f.wrapS=ae[c.wrapS];f.wrapT=ae[c.wrapT];for(s=0;6>s;++s)L(g[s]);return f}var p=new D(34067);ue[p.id]=p;i.cubeCount++;var g=Array(6);f(t,r,n,a,s,c);f.subimage=function(e,t,r,n,a){r|=0;n|=0;a|=0;var i=v();l(i,p);i.width=0;i.height=0;h(i,t);i.width=i.width||(p.width>>a)-r;i.height=i.height||(p.height>>a)-n;R(p);d(i,34069+e,r,n,a);z();m(i);return f};f.resize=function(t){t|=0;if(t!==p.width){f.width=p.width=t;f.height=p.height=t;R(p);for(var r=0;6>r;++r)for(var n=0;p.mipmask>>n;++n)e.texImage2D(34069+r,n,p.format,t>>n,t>>n,0,p.format,p.type,null);z();o.profile&&(p.stats.size=C(p.internalformat,p.type,f.width,f.height,!1,!0));return f}};f._reglType="textureCube";f._texture=p;o.profile&&(f.stats=p.stats);f.destroy=function(){p.decRef()};return f},clear:function(){for(var t=0;t<ce;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),fe[t]=null;te(ue).forEach(N);i.cubeCount=0;i.textureCount=0},getTexture:function(e){return null},restore:function(){for(var t=0;t<ce;++t){var r=fe[t];r&&(r.bindCount=0,r.unit=-1,fe[t]=null)}te(ue).forEach(function(t){t.texture=e.createTexture();e.bindTexture(t.target,t.texture);for(var r=0;32>r;++r)if(0!==(t.mipmask&1<<r))if(3553===t.target)e.texImage2D(3553,r,t.internalformat,t.width>>r,t.height>>r,0,t.internalformat,t.type,null);else for(var n=0;6>n;++n)e.texImage2D(34069+n,r,t.internalformat,t.width>>r,t.height>>r,0,t.internalformat,t.type,null);P(t.texInfo,t.target)})}}}function I(e,t,r,n,a,i){function o(e,t,r){this.target=e;this.texture=t;this.renderbuffer=r;var n=e=0;t?(e=t.width,n=t.height):r&&(e=r.width,n=r.height);this.width=e;this.height=n}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function l(e,t,r){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function u(t,r){r&&(r.texture?e.framebufferTexture2D(36160,t,r.target,r.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,r.renderbuffer._renderbuffer.renderbuffer))}function c(e){var t=3553,r=null,n=null,a=e;"object"===typeof e&&(a=e.data,"target"in e&&(t=e.target|0));e=a._reglType;"texture2d"===e?r=a:"textureCube"===e?r=a:"renderbuffer"===e&&(n=a,t=36161);return new o(t,r,n)}function f(e,t,r,i,s){if(r)return e=n.create2D({width:e,height:t,format:i,type:s}),e._texture.refCount=0,new o(3553,e,null);e=a.create({width:e,height:t,format:i});e._renderbuffer.refCount=0;return new o(36161,null,e)}function h(e){return e&&(e.texture||e.renderbuffer)}function p(e,t,r){e&&(e.texture?e.texture.resize(t,r):e.renderbuffer&&e.renderbuffer.resize(t,r),e.width=t,e.height=r)}function d(){this.id=T++;k[this.id]=this;this.framebuffer=e.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(e){e.colorAttachments.forEach(s);s(e.depthAttachment);s(e.stencilAttachment);s(e.depthStencilAttachment)}function m(t){e.deleteFramebuffer(t.framebuffer);t.framebuffer=null;i.framebufferCount--;delete k[t.id]}function g(t){var n;e.bindFramebuffer(36160,t.framebuffer);var a=t.colorAttachments;for(n=0;n<a.length;++n)u(36064+n,a[n]);for(n=a.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(36160,36064+n,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0);e.framebufferTexture2D(36160,36096,3553,null,0);e.framebufferTexture2D(36160,36128,3553,null,0);u(36096,t.depthAttachment);u(36128,t.stencilAttachment);u(33306,t.depthStencilAttachment);e.checkFramebufferStatus(36160);e.isContextLost();e.bindFramebuffer(36160,x.next?x.next.framebuffer:null);x.cur=x.next;e.getError()}function y(e,t){function r(e,t){var a,i=0,o=0,s=!0,u=!0;a=null;var p=!0,d="rgba",m="uint8",y=1,x=null,w=null,T=null,k=!1;if("number"===typeof e)i=e|0,o=t|0||i;else if(e){"shape"in e?(o=e.shape,i=o[0],o=o[1]):("radius"in e&&(i=o=e.radius),"width"in e&&(i=e.width),"height"in e&&(o=e.height));if("color"in e||"colors"in e)a=e.color||e.colors,Array.isArray(a);if(!a){"colorCount"in e&&(y=e.colorCount|0);"colorTexture"in e&&(p=!!e.colorTexture,d="rgba4");if("colorType"in e&&(m=e.colorType,!p))if("half float"===m||"float16"===m)d="rgba16f";else if("float"===m||"float32"===m)d="rgba32f";"colorFormat"in e&&(d=e.colorFormat,0<=_.indexOf(d)?p=!0:0<=b.indexOf(d)&&(p=!1))}if("depthTexture"in e||"depthStencilTexture"in e)k=!(!e.depthTexture&&!e.depthStencilTexture);"depth"in e&&("boolean"===typeof e.depth?s=e.depth:(x=e.depth,u=!1));"stencil"in e&&("boolean"===typeof e.stencil?u=e.stencil:(w=e.stencil,s=!1));"depthStencil"in e&&("boolean"===typeof e.depthStencil?s=u=e.depthStencil:(T=e.depthStencil,u=s=!1))}else i=o=1;var A=null,M=null,E=null,S=null;if(Array.isArray(a))A=a.map(c);else if(a)A=[c(a)];else for(A=Array(y),a=0;a<y;++a)A[a]=f(i,o,p,d,m);i=i||A[0].width;o=o||A[0].height;x?M=c(x):s&&!u&&(M=f(i,o,k,"depth","uint32"));w?E=c(w):u&&!s&&(E=f(i,o,!1,"stencil","uint8"));T?S=c(T):!x&&!w&&u&&s&&(S=f(i,o,k,"depth stencil","depth stencil"));s=null;for(a=0;a<A.length;++a)l(A[a],i,o),A[a]&&A[a].texture&&(u=Me[A[a].texture._texture.format]*Ee[A[a].texture._texture.type],null===s&&(s=u));l(M,i,o);l(E,i,o);l(S,i,o);v(n);n.width=i;n.height=o;n.colorAttachments=A;n.depthAttachment=M;n.stencilAttachment=E;n.depthStencilAttachment=S;r.color=A.map(h);r.depth=h(M);r.stencil=h(E);r.depthStencil=h(S);r.width=n.width;r.height=n.height;g(n);return r}var n=new d;i.framebufferCount++;r(e,t);return W(r,{resize:function(e,t){var a=Math.max(e|0,1),i=Math.max(t|0||a,1);if(a===n.width&&i===n.height)return r;for(var o=n.colorAttachments,s=0;s<o.length;++s)p(o[s],a,i);p(n.depthAttachment,a,i);p(n.stencilAttachment,a,i);p(n.depthStencilAttachment,a,i);n.width=r.width=a;n.height=r.height=i;g(n);return r},_reglType:"framebuffer",_framebuffer:n,destroy:function(){m(n);v(n)},use:function(e){x.setFBO({framebuffer:r},e)}})}var x={cur:null,next:null,dirty:!1,setFBO:null},_=["rgba"],b=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&b.push("srgba");t.ext_color_buffer_half_float&&b.push("rgba16f","rgb16f");t.webgl_color_buffer_float&&b.push("rgba32f");var w=["uint8"];t.oes_texture_half_float&&w.push("half float","float16");t.oes_texture_float&&w.push("float","float32");var T=0,k={};return W(x,{getFramebuffer:function(e){return"function"===typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer,e instanceof d)?e:null},create:y,createCube:function(e){function t(e){var a,i={color:null},o=0,s=null;a="rgba";var l="uint8",u=1;if("number"===typeof e)o=e|0;else if(e){"shape"in e?o=e.shape[0]:("radius"in e&&(o=e.radius|0),"width"in e?o=e.width|0:"height"in e&&(o=e.height|0));if("color"in e||"colors"in e)s=e.color||e.colors,Array.isArray(s);s||("colorCount"in e&&(u=e.colorCount|0),"colorType"in e&&(l=e.colorType),"colorFormat"in e&&(a=e.colorFormat));"depth"in e&&(i.depth=e.depth);"stencil"in e&&(i.stencil=e.stencil);"depthStencil"in e&&(i.depthStencil=e.depthStencil)}else o=1;if(s)if(Array.isArray(s))for(e=[],a=0;a<s.length;++a)e[a]=s[a];else e=[s];else for(e=Array(u),s={radius:o,format:a,type:l},a=0;a<u;++a)e[a]=n.createCube(s);i.color=Array(e.length);for(a=0;a<e.length;++a)u=e[a],o=o||u.width,i.color[a]={target:34069,data:e[a]};for(a=0;6>a;++a){for(u=0;u<e.length;++u)i.color[u].target=34069+a;0<a&&(i.depth=r[0].depth,i.stencil=r[0].stencil,i.depthStencil=r[0].depthStencil);if(r[a])r[a](i);else r[a]=y(i)}return W(t,{width:o,height:o,color:e})}var r=Array(6);t(e);return W(t,{faces:r,resize:function(e){var n=e|0;if(n===t.width)return t;var a=t.color;for(e=0;e<a.length;++e)a[e].resize(n);for(e=0;6>e;++e)r[e].resize(n);t.width=t.height=n;return t},_reglType:"framebufferCube",destroy:function(){r.forEach(function(e){e.destroy()})}})},clear:function(){te(k).forEach(m)},restore:function(){x.cur=null;x.next=null;x.dirty=!0;te(k).forEach(function(t){t.framebuffer=e.createFramebuffer();g(t)})}})}function O(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function P(e,t,r,n,a){function i(e){if(e!==v.currentVAO){var r=t.oes_vertex_array_object;e?r.bindVertexArrayOES(e.vao):r.bindVertexArrayOES(null);v.currentVAO=e}}function o(r){if(r!==v.currentVAO){if(r)r.bindAttrs();else for(var n=t.angle_instanced_arrays,a=0;a<f.length;++a){var i=f[a];i.buffer?(e.enableVertexAttribArray(a),e.vertexAttribPointer(a,i.size,i.type,i.normalized,i.stride,i.offfset),n&&n.vertexAttribDivisorANGLE(a,i.divisor)):(e.disableVertexAttribArray(a),e.vertexAttrib4f(a,i.x,i.y,i.z,i.w))}v.currentVAO=r}}function s(){te(d).forEach(function(e){e.destroy()})}function l(){this.id=++h;this.attributes=[];var e=t.oes_vertex_array_object;this.vao=e?e.createVertexArrayOES():null;d[this.id]=this;this.buffers=[]}function u(){t.oes_vertex_array_object&&te(d).forEach(function(e){e.refresh()})}var c=r.maxAttributes,f=Array(c);for(r=0;r<c;++r)f[r]=new O;var h=0,d={},v={Record:O,scope:{},state:f,currentVAO:null,targetVAO:null,restore:t.oes_vertex_array_object?u:function(){},createVAO:function(e){function t(e){for(var n=0;n<r.buffers.length;++n)r.buffers[n].destroy();r.buffers.length=0;n=r.attributes;n.length=e.length;for(var i=0;i<e.length;++i){var o=e[i],s=n[i]=new O;Array.isArray(o)||ee(o)||p(o)?(o=a.create(o,34962,!1,!0),s.buffer=a.getBuffer(o),s.size=s.buffer.dimension|0,s.normalized=!1,s.type=s.buffer.dtype,s.offset=0,s.stride=0,s.divisor=0,s.state=1,r.buffers.push(o)):a.getBuffer(o)?(s.buffer=a.getBuffer(o),s.size=s.buffer.dimension|0,s.normalized=!1,s.type=s.buffer.dtype,s.offset=0,s.stride=0,s.divisor=0,s.state=1):a.getBuffer(o.buffer)?(s.buffer=a.getBuffer(o.buffer),s.size=(+o.size||s.buffer.dimension)|0,s.normalized=!!o.normalized||!1,s.type="type"in o?ae[o.type]:s.buffer.dtype,s.offset=(o.offset||0)|0,s.stride=(o.stride||0)|0,s.divisor=(o.divisor||0)|0,s.state=1):"x"in o&&(s.x=+o.x||0,s.y=+o.y||0,s.z=+o.z||0,s.w=+o.w||0,s.state=2)}r.refresh();return t}var r=new l;n.vaoCount+=1;t.destroy=function(){r.destroy()};t._vao=r;t._reglType="vao";return t(e)},getVAO:function(e){return"function"===typeof e&&e._vao?e._vao:null},destroyBuffer:function(t){for(var r=0;r<f.length;++r){var n=f[r];n.buffer===t&&(e.disableVertexAttribArray(r),n.buffer=null)}},setVAO:t.oes_vertex_array_object?i:o,clear:t.oes_vertex_array_object?s:function(){}};l.prototype.bindAttrs=function(){for(var r=t.angle_instanced_arrays,n=this.attributes,a=0;a<n.length;++a){var i=n[a];i.buffer?(e.enableVertexAttribArray(a),e.bindBuffer(34962,i.buffer.buffer),e.vertexAttribPointer(a,i.size,i.type,i.normalized,i.stride,i.offset),r&&r.vertexAttribDivisorANGLE(a,i.divisor)):(e.disableVertexAttribArray(a),e.vertexAttrib4f(a,i.x,i.y,i.z,i.w))}for(r=n.length;r<c;++r)e.disableVertexAttribArray(r)};l.prototype.refresh=function(){var e=t.oes_vertex_array_object;e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),v.currentVAO=this)};l.prototype.destroy=function(){if(this.vao){var e=t.oes_vertex_array_object;this===v.currentVAO&&(v.currentVAO=null,e.bindVertexArrayOES(null));e.deleteVertexArrayOES(this.vao);this.vao=null}d[this.id]&&(delete d[this.id],--n.vaoCount)};return v}function D(e,t,r,n){function a(e,t,r,n){this.name=e;this.id=t;this.location=r;this.info=n}function i(e,t){for(var r=0;r<e.length;++r)if(e[r].id===t.id){e[r].location=t.location;return}e.push(t)}function o(r,n,a){a=35632===r?u:c;var i=a[n];if(!i){var o=t.str(n),i=e.createShader(r);e.shaderSource(i,o);e.compileShader(i);a[n]=i}return i}function s(e,t){this.id=p++;this.fragId=e;this.vertId=t;this.program=null;this.uniforms=[];this.attributes=[];n.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function l(r,s,l){var u;u=o(35632,r.fragId);var c=o(35633,r.vertId);s=r.program=e.createProgram();e.attachShader(s,u);e.attachShader(s,c);if(l)for(u=0;u<l.length;++u)c=l[u],e.bindAttribLocation(s,c[0],c[1]);e.linkProgram(s);c=e.getProgramParameter(s,35718);n.profile&&(r.stats.uniformsCount=c);var f=r.uniforms;for(u=0;u<c;++u)if(l=e.getActiveUniform(s,u))if(1<l.size)for(var h=0;h<l.size;++h){var p=l.name.replace("[0]","["+h+"]");i(f,new a(p,t.id(p),e.getUniformLocation(s,p),l))}else i(f,new a(l.name,t.id(l.name),e.getUniformLocation(s,l.name),l));c=e.getProgramParameter(s,35721);n.profile&&(r.stats.attributesCount=c);r=r.attributes;for(u=0;u<c;++u)(l=e.getActiveAttrib(s,u))&&i(r,new a(l.name,t.id(l.name),e.getAttribLocation(s,l.name),l))}var u={},c={},f={},h=[],p=0;n.profile&&(r.getMaxUniformsCount=function(){var e=0;h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)});return e},r.getMaxAttributesCount=function(){var e=0;h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)});return e});return{clear:function(){var t=e.deleteShader.bind(e);te(u).forEach(t);u={};te(c).forEach(t);c={};h.forEach(function(t){e.deleteProgram(t.program)});h.length=0;f={};r.shaderCount=0},program:function(e,t,n,a){var i=f[t];i||(i=f[t]={});var o=i[e];if(o&&!a)return o;t=new s(t,e);r.shaderCount++;l(t,n,a);o||(i[e]=t);h.push(t);return t},restore:function(){u={};c={};for(var e=0;e<h.length;++e)l(h[e],null,h[e].attributes.map(function(e){return[e.location,e.name]}))},shader:o,frag:-1,vert:-1}}function R(e,t,r,n,a,i,o){function s(a){var i;i=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var o=0,s=0,l=n.framebufferWidth,u=n.framebufferHeight,c=null;ee(a)?c=a:a&&(o=a.x|0,s=a.y|0,l=(a.width||n.framebufferWidth-o)|0,u=(a.height||n.framebufferHeight-s)|0,c=a.data||null);r();a=l*u*4;c||(5121===i?c=new Uint8Array(a):5126===i&&(c=c||new Float32Array(a)));e.pixelStorei(3333,4);e.readPixels(o,s,l,u,6408,i,c);return c}function l(e){var r;t.setFBO({framebuffer:e.framebuffer},function(){r=s(e)});return r}return function(e){return e&&"framebuffer"in e?l(e):s(e)}}function z(e){return Array.prototype.slice.call(e)}function N(e){return z(e).join("")}function F(){function e(){var e=[],t=[];return W(function(){e.push.apply(e,z(arguments))},{def:function(){var n="v"+r++;t.push(n);0<arguments.length&&(e.push(n,"="),e.push.apply(e,z(arguments)),e.push(";"));return n},toString:function(){return N([0<t.length?"var "+t.join(",")+";":"",N(e)])}})}function t(){function t(e,t){n(e,t,"=",r.def(e,t),";")}var r=e(),n=e(),a=r.toString,i=n.toString;return W(function(){r.apply(r,z(arguments))},{def:r.def,entry:r,exit:n,save:t,set:function(e,n,a){t(e,n);r(e,n,"=",a,";")},toString:function(){return a()+i()}})}var r=0,n=[],a=[],i=e(),o={};return{global:i,link:function(e){for(var t=0;t<a.length;++t)if(a[t]===e)return n[t];t="g"+r++;n.push(t);a.push(e);return t},block:e,proc:function(e,r){function n(){var e="a"+a.length;a.push(e);return e}var a=[];r=r||0;for(var i=0;i<r;++i)n();var i=t(),s=i.toString;return o[e]=W(i,{arg:n,toString:function(){return N(["function(",a.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=N(arguments),r=t(),n=t(),a=r.toString,i=n.toString;return W(r,{then:function(){r.apply(r,z(arguments));return this},else:function(){n.apply(n,z(arguments));return this},toString:function(){var t=i();t&&(t="else{"+t+"}");return N(["if(",e,"){",a(),"}",t])}})},compile:function(){var e=['"use strict";',i,"return {"];Object.keys(o).forEach(function(t){e.push('"',t,'":',o[t].toString(),",")});e.push("}");var t=N(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,a)}}}function B(e){return Array.isArray(e)||ee(e)||p(e)}function j(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function U(e,t,r,n){this.thisDep=e;this.contextDep=t;this.propDep=r;this.append=n}function H(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function V(e){return new U(!1,!1,!1,e)}function G(e,t){var r=e.type;return 0===r?(r=e.data.length,new U(!0,1<=r,2<=r,t)):4===r?(r=e.data,new U(r.thisDep,r.contextDep,r.propDep,t)):new U(3===r,2===r,1===r,t)}function q(e,t,r,n,a,i,o,s,l,u,f,h,p,d,v){function m(e){return e.replace(".","_")}function g(e,t,r){var n=m(e);pe.push(e);he[n]=fe[n]=!!r;de[n]=t}function y(e,t,r){var n=m(e);pe.push(e);Array.isArray(r)?(fe[n]=r.slice(),he[n]=r.slice()):fe[n]=he[n]=r;ve[n]=t}function x(){var e=F(),r=e.link,n=e.global;e.id=ye++;e.batchId="0";var a=r(me),i=e.shared={props:"a0"};Object.keys(me).forEach(function(e){i[e]=n.def(a,".",e)});var o=e.next={},s=e.current={};Object.keys(ve).forEach(function(e){Array.isArray(fe[e])&&(o[e]=n.def(i.next,".",e),s[e]=n.def(i.current,".",e))});var l=e.constants={};Object.keys(ge).forEach(function(e){l[e]=n.def(JSON.stringify(ge[e]))});e.invoke=function(t,n){switch(n.type){case 0:var a=["this",i.context,i.props,e.batchId];return t.def(r(n.data),".call(",a.slice(0,Math.max(n.data.length+1,4)),")");case 1:return t.def(i.props,n.data);case 2:return t.def(i.context,n.data);case 3:return t.def("this",n.data);case 4:return n.data.append(e,t),n.data.ref}};e.attribCache={};var c={};e.scopeAttrib=function(e){e=t.id(e);if(e in c)return c[e];var n=u.scope[e];n||(n=u.scope[e]=new oe);return c[e]=r(n)};return e}function _(e){var t=e["static"];e=e.dynamic;var r;if("profile"in t){var n=!!t.profile;r=V(function(e,t){return n});r.enable=n}else if("profile"in e){var a=e.profile;r=G(a,function(e,t){return e.invoke(t,a)})}return r}function b(e,t){var r=e["static"],n=e.dynamic;if("framebuffer"in r){var a=r.framebuffer;return a?(a=s.getFramebuffer(a),V(function(e,t){var r=e.link(a),n=e.shared;t.set(n.framebuffer,".next",r);n=n.context;t.set(n,".framebufferWidth",r+".width");t.set(n,".framebufferHeight",r+".height");return r})):V(function(e,t){var r=e.shared;t.set(r.framebuffer,".next","null");r=r.context;t.set(r,".framebufferWidth",r+".drawingBufferWidth");t.set(r,".framebufferHeight",r+".drawingBufferHeight");return"null"})}if("framebuffer"in n){var i=n.framebuffer;return G(i,function(e,t){var r=e.invoke(t,i),n=e.shared,a=n.framebuffer,r=t.def(a,".getFramebuffer(",r,")");t.set(a,".next",r);n=n.context;t.set(n,".framebufferWidth",r+"?"+r+".width:"+n+".drawingBufferWidth");t.set(n,".framebufferHeight",r+"?"+r+".height:"+n+".drawingBufferHeight");return r})}return null}function T(e,t,r){function n(e){if(e in a){var r=a[e];e=!0;var n=r.x|0,o=r.y|0,s,l;"width"in r?s=r.width|0:e=!1;"height"in r?l=r.height|0:e=!1;return new U(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var a=e.shared.context,i=s;"width"in r||(i=t.def(a,".","framebufferWidth","-",n));var u=l;"height"in r||(u=t.def(a,".","framebufferHeight","-",o));return[n,o,i,u]})}if(e in i){var u=i[e];e=G(u,function(e,t){var r=e.invoke(t,u),n=e.shared.context,a=t.def(r,".x|0"),i=t.def(r,".y|0"),o=t.def('"width" in ',r,"?",r,".width|0:","(",n,".","framebufferWidth","-",a,")"),r=t.def('"height" in ',r,"?",r,".height|0:","(",n,".","framebufferHeight","-",i,")");return[a,i,o,r]});t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep);return e}return t?new U(t.thisDep,t.contextDep,t.propDep,function(e,t){var r=e.shared.context;return[0,0,t.def(r,".","framebufferWidth"),t.def(r,".","framebufferHeight")]}):null}var a=e["static"],i=e.dynamic;if(e=n("viewport")){var o=e;e=new U(e.thisDep,e.contextDep,e.propDep,function(e,t){var r=o.append(e,t),n=e.shared.context;t.set(n,".viewportWidth",r[2]);t.set(n,".viewportHeight",r[3]);return r})}return{viewport:e,scissor_box:n("scissor.box")}}function k(e,t){var r=e["static"];if("string"===typeof r.frag&&"string"===typeof r.vert){if(0<Object.keys(t.dynamic).length)return null;var r=t["static"],n=Object.keys(r);if(0<n.length&&"number"===typeof r[n[0]]){for(var a=[],i=0;i<n.length;++i)a.push([r[n[i]]|0,n[i]]);return a}}return null}function A(e,r,n){function a(e){if(e in i){var r=t.id(i[e]);e=V(function(){return r});e.id=r;return e}if(e in o){var n=o[e];return G(n,function(e,t){var r=e.invoke(t,n);return t.def(e.shared.strings,".id(",r,")")})}return null}var i=e["static"],o=e.dynamic,s=a("frag"),l=a("vert"),u=null;H(s)&&H(l)?(u=f.program(l.id,s.id,null,n),e=V(function(e,t){return e.link(u)})):e=new U(s&&s.thisDep||l&&l.thisDep,s&&s.contextDep||l&&l.contextDep,s&&s.propDep||l&&l.propDep,function(e,t){var r=e.shared.shader,n;n=s?s.append(e,t):t.def(r,".","frag");var a;a=l?l.append(e,t):t.def(r,".","vert");return t.def(r+".program("+a+","+n+")")});return{frag:s,vert:l,progVar:e,program:u}}function M(e,t){function r(e,t){if(e in n){var r=n[e]|0;return V(function(e,n){t&&(e.OFFSET=r);return r})}if(e in a){var i=a[e];return G(i,function(e,r){var n=e.invoke(r,i);t&&(e.OFFSET=n);return n})}return t&&o?V(function(e,t){e.OFFSET="0";return 0}):null}var n=e["static"],a=e.dynamic,o=function(){if("elements"in n){var e=n.elements;B(e)?e=i.getElements(i.create(e,!0)):e&&(e=i.getElements(e));var t=V(function(t,r){if(e){var n=t.link(e);return t.ELEMENTS=n}return t.ELEMENTS=null});t.value=e;return t}if("elements"in a){var r=a.elements;return G(r,function(e,t){var n=e.shared,a=n.isBufferArgs,n=n.elements,i=e.invoke(t,r),o=t.def("null"),a=t.def(a,"(",i,")"),i=e.cond(a).then(o,"=",n,".createStream(",i,");")["else"](o,"=",n,".getElements(",i,");");t.entry(i);t.exit(e.cond(a).then(n,".destroyStream(",o,");"));return e.ELEMENTS=o})}return null}(),s=r("offset",!0);return{elements:o,primitive:function(){if("primitive"in n){var e=n.primitive;return V(function(t,r){return ue[e]})}if("primitive"in a){var t=a.primitive;return G(t,function(e,r){var n=e.constants.primTypes,a=e.invoke(r,t);return r.def(n,"[",a,"]")})}return o?H(o)?o.value?V(function(e,t){return t.def(e.ELEMENTS,".primType")}):V(function(){return 4}):new U(o.thisDep,o.contextDep,o.propDep,function(e,t){var r=e.ELEMENTS;return t.def(r,"?",r,".primType:",4)}):null}(),count:function(){if("count"in n){var e=n.count|0;return V(function(){return e})}if("count"in a){var t=a.count;return G(t,function(e,r){return e.invoke(r,t)})}return o?H(o)?o?s?new U(s.thisDep,s.contextDep,s.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):V(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):V(function(){return-1}):new U(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,function(e,t){var r=e.ELEMENTS;return e.OFFSET?t.def(r,"?",r,".vertCount-",e.OFFSET,":-1"):t.def(r,"?",r,".vertCount:-1")}):null}(),instances:r("instances",!1),offset:s}}function E(e,t){var r=e["static"],n=e.dynamic,a={};pe.forEach(function(e){function t(t,o){if(e in r){var s=t(r[e]);a[i]=V(function(){return s})}else if(e in n){var l=n[e];a[i]=G(l,function(e,t){return o(e,t,e.invoke(t,l))})}}var i=m(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,r){return r});case"depth.func":return t(function(e){return Ie[e]},function(e,t,r){return t.def(e.constants.compareFuncs,"[",r,"]")});case"depth.range":return t(function(e){return e},function(e,t,r){e=t.def("+",r,"[0]");t=t.def("+",r,"[1]");return[e,t]});case"blend.func":return t(function(e){return[Le["srcRGB"in e?e.srcRGB:e.src],Le["dstRGB"in e?e.dstRGB:e.dst],Le["srcAlpha"in e?e.srcAlpha:e.src],Le["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,r){function n(e,n){return t.def('"',e,n,'" in ',r,"?",r,".",e,n,":",r,".",e)}e=e.constants.blendFuncs;var a=n("src","RGB"),i=n("dst","RGB"),a=t.def(e,"[",a,"]"),o=t.def(e,"[",n("src","Alpha"),"]"),i=t.def(e,"[",i,"]");e=t.def(e,"[",n("dst","Alpha"),"]");return[a,i,o,e]});case"blend.equation":return t(function(e){if("string"===typeof e)return[se[e],se[e]];if("object"===typeof e)return[se[e.rgb],se[e.alpha]]},function(e,t,r){var n=e.constants.blendEquations,a=t.def(),i=t.def();e=e.cond("typeof ",r,'==="string"');e.then(a,"=",i,"=",n,"[",r,"];");e["else"](a,"=",n,"[",r,".rgb];",i,"=",n,"[",r,".alpha];");t(e);return[a,i]});case"blend.color":return t(function(e){return c(4,function(t){return+e[t]})},function(e,t,r){return c(4,function(e){return t.def("+",r,"[",e,"]")})});case"stencil.mask":return t(function(e){return e|0},function(e,t,r){return t.def(r,"|0")});case"stencil.func":return t(function(e){return[Ie[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,r){e=t.def('"cmp" in ',r,"?",e.constants.compareFuncs,"[",r,".cmp]",":",7680);var n=t.def(r,".ref|0");t=t.def('"mask" in ',r,"?",r,".mask|0:-1");return[e,n,t]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,Oe[t.fail||"keep"],Oe[t.zfail||"keep"],Oe[t.zpass||"keep"]]},function(t,r,n){function a(e){return r.def('"',e,'" in ',n,"?",i,"[",n,".",e,"]:",7680)}var i=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,a("fail"),a("zfail"),a("zpass")]});case"polygonOffset.offset":return t(function(e){return[e.factor|0,e.units|0]},function(e,t,r){e=t.def(r,".factor|0");t=t.def(r,".units|0");return[e,t]});case"cull.face":return t(function(e){var t=0;"front"===e?t=1028:"back"===e&&(t=1029);return t},function(e,t,r){return t.def(r,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,r){return r});case"frontFace":return t(function(e){return Pe[e]},function(e,t,r){return t.def(r+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,r){return c(4,function(e){return"!!"+r+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,r){e=t.def('"value" in ',r,"?+",r,".value:1");t=t.def("!!",r,".invert");return[e,t]})}});return a}function S(e,t){var r=e["static"],n=e.dynamic,a={};Object.keys(r).forEach(function(e){var t=r[e],n;if("number"===typeof t||"boolean"===typeof t)n=V(function(){return t});else if("function"===typeof t){var i=t._reglType;if("texture2d"===i||"textureCube"===i)n=V(function(e){return e.link(t)});else if("framebuffer"===i||"framebufferCube"===i)n=V(function(e){return e.link(t.color[0])})}else w(t)&&(n=V(function(e){return e.global.def("[",c(t.length,function(e){return t[e]}),"]")}));n.value=t;a[e]=n});Object.keys(n).forEach(function(e){var t=n[e];a[e]=G(t,function(e,r){return e.invoke(r,t)})});return a}function C(e,r){var n=e["static"],i=e.dynamic,o={};Object.keys(n).forEach(function(e){var r=n[e],i=t.id(e),s=new oe;if(B(r))s.state=1,s.buffer=a.getBuffer(a.create(r,34962,!1,!0)),s.type=0;else{var l=a.getBuffer(r);if(l)s.state=1,s.buffer=l,s.type=0;else if("constant"in r){var u=r.constant;s.buffer="null";s.state=2;"number"===typeof u?s.x=u:Se.forEach(function(e,t){t<u.length&&(s[e]=u[t])})}else{var l=B(r.buffer)?a.getBuffer(a.create(r.buffer,34962,!1,!0)):a.getBuffer(r.buffer),c=r.offset|0,f=r.stride|0,h=r.size|0,p=!!r.normalized,d=0;"type"in r&&(d=ae[r.type]);r=r.divisor|0;s.buffer=l;s.state=1;s.size=h;s.normalized=p;s.type=d||l.dtype;s.offset=c;s.stride=f;s.divisor=r}}o[e]=V(function(e,t){var r=e.attribCache;if(i in r)return r[i];var n={isStream:!1};Object.keys(s).forEach(function(e){n[e]=s[e]});s.buffer&&(n.buffer=e.link(s.buffer),n.type=n.type||n.buffer+".dtype");return r[i]=n})});Object.keys(i).forEach(function(e){var t=i[e];o[e]=G(t,function(e,r){function n(e){r(l[e],"=",a,".",e,"|0;")}var a=e.invoke(r,t),i=e.shared,o=e.constants,s=i.isBufferArgs,i=i.buffer,l={isStream:r.def(!1)},u=new oe;u.state=1;Object.keys(u).forEach(function(e){l[e]=r.def(""+u[e])});var c=l.buffer,f=l.type;r("if(",s,"(",a,")){",l.isStream,"=true;",c,"=",i,".createStream(",34962,",",a,");",f,"=",c,".dtype;","}else{",c,"=",i,".getBuffer(",a,");","if(",c,"){",f,"=",c,".dtype;",'}else if("constant" in ',a,"){",l.state,"=",2,";","if(typeof "+a+'.constant === "number"){',l[Se[0]],"=",a,".constant;",Se.slice(1).map(function(e){return l[e]}).join("="),"=0;","}else{",Se.map(function(e,t){return l[e]+"="+a+".constant.length>"+t+"?"+a+".constant["+t+"]:0;"}).join(""),"}}else{","if(",s,"(",a,".buffer)){",c,"=",i,".createStream(",34962,",",a,".buffer);","}else{",c,"=",i,".getBuffer(",a,".buffer);","}",f,'="type" in ',a,"?",o.glTypes,"[",a,".type]:",c,".dtype;",l.normalized,"=!!",a,".normalized;");n("size");n("offset");n("stride");n("divisor");r("}}");r.exit("if(",l.isStream,"){",i,".destroyStream(",c,");","}");return l})});return o}function L(e,t){var r=e["static"],n=e.dynamic;if("vao"in r){var a=r.vao;null!==a&&null===u.getVAO(a)&&(a=u.createVAO(a));return V(function(e){return e.link(u.getVAO(a))})}if("vao"in n){var i=n.vao;return G(i,function(e,t){var r=e.invoke(t,i);return t.def(e.shared.vao+".getVAO("+r+")")})}return null}function I(e){var t=e["static"],r=e.dynamic,n={};Object.keys(t).forEach(function(e){var r=t[e];n[e]=V(function(e,t){return"number"===typeof r||"boolean"===typeof r?""+r:e.link(r)})});Object.keys(r).forEach(function(e){var t=r[e];n[e]=G(t,function(e,r){return e.invoke(r,t)})});return n}function O(e,t,n,a,i){function o(e){var t=c[e];t&&(h[e]=t)}var s=k(e,t),l=b(e,i),c=T(e,l,i),f=M(e,i),h=E(e,i),p=A(e,i,s);o("viewport");o(m("scissor.box"));var d=0<Object.keys(h).length,l={framebuffer:l,draw:f,shader:p,state:h,dirty:d,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};l.profile=_(e,i);l.uniforms=S(n,i);l.drawVAO=l.scopeVAO=L(e,i);if(!l.drawVAO&&p.program&&!s&&r.angle_instanced_arrays){var v=!0;e=p.program.attributes.map(function(e){e=t["static"][e];v=v&&!!e;return e});if(v&&0<e.length){var g=u.getVAO(u.createVAO(e));l.drawVAO=new U(null,null,null,function(e,t){return e.link(g)});l.useVAO=!0}}s?l.useVAO=!0:l.attributes=C(t,i);l.context=I(a,i);return l}function P(e,t,r){var n=e.shared.context,a=e.scope();Object.keys(r).forEach(function(i){t.save(n,"."+i);a(n,".",i,"=",r[i].append(e,t),";")});t(a)}function D(e,t,r,n){var a=e.shared,i=a.gl,o=a.framebuffer,s;ce&&(s=t.def(a.extensions,".webgl_draw_buffers"));var l=e.constants,a=l.drawBuffer,l=l.backBuffer;e=r?r.append(e,t):t.def(o,".next");n||t("if(",e,"!==",o,".cur){");t("if(",e,"){",i,".bindFramebuffer(",36160,",",e,".framebuffer);");ce&&t(s,".drawBuffersWEBGL(",a,"[",e,".colorAttachments.length]);");t("}else{",i,".bindFramebuffer(",36160,",null);");ce&&t(s,".drawBuffersWEBGL(",l,");");t("}",o,".cur=",e,";");n||t("}")}function R(e,t,r){var n=e.shared,a=n.gl,i=e.current,o=e.next,s=n.current,l=n.next,u=e.cond(s,".dirty");pe.forEach(function(t){t=m(t);if(!(t in r.state)){var n,f;if(t in o){n=o[t];f=i[t];var h=c(fe[t].length,function(e){return u.def(n,"[",e,"]")});u(e.cond(h.map(function(e,t){return e+"!=="+f+"["+t+"]"}).join("||")).then(a,".",ve[t],"(",h,");",h.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";"))}else n=u.def(l,".",t),h=e.cond(n,"!==",s,".",t),u(h),t in de?h(e.cond(n).then(a,".enable(",de[t],");")["else"](a,".disable(",de[t],");"),s,".",t,"=",n,";"):h(a,".",ve[t],"(",n,");",s,".",t,"=",n,";")}});0===Object.keys(r.state).length&&u(s,".dirty=false;");t(u)}function z(e,t,r,n){var a=e.shared,i=e.current,o=a.current,s=a.gl;j(Object.keys(r)).forEach(function(a){var l=r[a];if(!n||n(l)){var u=l.append(e,t);if(de[a]){var c=de[a];H(l)?u?t(s,".enable(",c,");"):t(s,".disable(",c,");"):t(e.cond(u).then(s,".enable(",c,");")["else"](s,".disable(",c,");"));t(o,".",a,"=",u,";")}else if(w(u)){var f=i[a];t(s,".",ve[a],"(",u,");",u.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";")}else t(s,".",ve[a],"(",u,");",o,".",a,"=",u,";")}})}function N(e,t){le&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function q(e,t,r,n,a){function i(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function o(e){p=t.def();e(p,"=",i(),";");"string"===typeof a?e(c,".count+=",a,";"):e(c,".count++;");d&&(n?(v=t.def(),e(v,"=",h,".getNumPendingQueries();")):e(h,".beginQuery(",c,");"))}function s(e){e(c,".cpuTime+=",i(),"-",p,";");d&&(n?e(h,".pushScopeStats(",v,",",h,".getNumPendingQueries(),",c,");"):e(h,".endQuery();"))}function l(e){var r=t.def(f,".profile");t(f,".profile=",e,";");t.exit(f,".profile=",r,";")}var u=e.shared,c=e.stats,f=u.current,h=u.timer;r=r.profile;var p,v;if(r){if(H(r)){r.enable?(o(t),s(t.exit),l("true")):l("false");return}r=r.append(e,t);l(r)}else r=t.def(f,".profile");u=e.block();o(u);t("if(",r,"){",u,"}");e=e.block();s(e);t.exit("if(",r,"){",e,"}")}function Y(e,t,r,n,a){function i(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function o(r,n,a){function i(){t("if(!",c,".buffer){",l,".enableVertexAttribArray(",u,");}");var r=a.type,i;i=a.size?t.def(a.size,"||",n):n;t("if(",c,".type!==",r,"||",c,".size!==",i,"||",p.map(function(e){return c+"."+e+"!=="+a[e]}).join("||"),"){",l,".bindBuffer(",34962,",",f,".buffer);",l,".vertexAttribPointer(",[u,i,r,a.normalized,a.stride,a.offset],");",c,".type=",r,";",c,".size=",i,";",p.map(function(e){return c+"."+e+"="+a[e]+";"}).join(""),"}");le&&(r=a.divisor,t("if(",c,".divisor!==",r,"){",e.instancing,".vertexAttribDivisorANGLE(",[u,r],");",c,".divisor=",r,";}"))}function o(){t("if(",c,".buffer){",l,".disableVertexAttribArray(",u,");",c,".buffer=null;","}if(",Se.map(function(e,t){return c+"."+e+"!=="+h[t]}).join("||"),"){",l,".vertexAttrib4f(",u,",",h,");",Se.map(function(e,t){return c+"."+e+"="+h[t]+";"}).join(""),"}")}var l=s.gl,u=t.def(r,".location"),c=t.def(s.attributes,"[",u,"]");r=a.state;var f=a.buffer,h=[a.x,a.y,a.z,a.w],p=["buffer","normalized","offset","stride"];1===r?i():2===r?o():(t("if(",r,"===",1,"){"),i(),t("}else{"),o(),t("}"))}var s=e.shared;n.forEach(function(n){var s=n.name,l=r.attributes[s],u;if(l){if(!a(l))return;u=l.append(e,t)}else{if(!a(De))return;var c=e.scopeAttrib(s);u={};Object.keys(new oe).forEach(function(e){u[e]=t.def(c,".",e)})}o(e.link(n),i(n.info.type),u)})}function W(e,r,n,a,i){for(var o=e.shared,s=o.gl,l,u=0;u<a.length;++u){var f=a[u],h=f.name,p=f.info.type,d=n.uniforms[h],f=e.link(f)+".location",v;if(d){if(!i(d))continue;if(H(d)){h=d.value;if(35678===p||35680===p)p=e.link(h._texture||h.color[0]._texture),r(s,".uniform1i(",f,",",p+".bind());"),r.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)h=e.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),d=2,35675===p?d=3:35676===p&&(d=4),r(s,".uniformMatrix",d,"fv(",f,",false,",h,");");else{switch(p){case 5126:l="1f";break;case 35664:l="2f";break;case 35665:l="3f";break;case 35666:l="4f";break;case 35670:l="1i";break;case 5124:l="1i";break;case 35671:l="2i";break;case 35667:l="2i";break;case 35672:l="3i";break;case 35668:l="3i";break;case 35673:l="4i";break;case 35669:l="4i"}r(s,".uniform",l,"(",f,",",w(h)?Array.prototype.slice.call(h):h,");")}continue}else v=d.append(e,r)}else{if(!i(De))continue;v=r.def(o.uniforms,"[",t.id(h),"]")}35678===p?r("if(",v,"&&",v,'._reglType==="framebuffer"){',v,"=",v,".color[0];","}"):35680===p&&r("if(",v,"&&",v,'._reglType==="framebufferCube"){',v,"=",v,".color[0];","}");h=1;switch(p){case 35678:case 35680:p=r.def(v,"._texture");r(s,".uniform1i(",f,",",p,".bind());");r.exit(p,".unbind();");continue;case 5124:case 35670:l="1i";break;case 35667:case 35671:l="2i";h=2;break;case 35668:case 35672:l="3i";h=3;break;case 35669:case 35673:l="4i";h=4;break;case 5126:l="1f";break;case 35664:l="2f";h=2;break;case 35665:l="3f";h=3;break;case 35666:l="4f";h=4;break;case 35674:l="Matrix2fv";break;case 35675:l="Matrix3fv";break;case 35676:l="Matrix4fv"}r(s,".uniform",l,"(",f,",");if("M"===l.charAt(0)){var f=Math.pow(p-35674+2,2),m=e.global.def("new Float32Array(",f,")");r("false,(Array.isArray(",v,")||",v," instanceof Float32Array)?",v,":(",c(f,function(e){return m+"["+e+"]="+v+"["+e+"]"}),",",m,")")}else 1<h?r(c(h,function(e){return v+"["+e+"]"})):r(v);r(");")}}function X(e,t,r,n){function a(a){var i=c[a];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(e,r):i.append(e,t):t.def(u,".",a)}function i(){function e(){r(m,".drawElementsInstancedANGLE(",[h,d,g,p+"<<(("+g+"-5121)>>1)",v],");")}function t(){r(m,".drawArraysInstancedANGLE(",[h,p,d,v],");")}f?y?e():(r("if(",f,"){"),e(),r("}else{"),t(),r("}")):t()}function o(){function e(){r(l+".drawElements("+[h,d,g,p+"<<(("+g+"-5121)>>1)"]+");")}function t(){r(l+".drawArrays("+[h,p,d]+");")}f?y?e():(r("if(",f,"){"),e(),r("}else{"),t(),r("}")):t()}var s=e.shared,l=s.gl,u=s.draw,c=n.draw,f=function(){var a=c.elements,i=t;if(a){if(a.contextDep&&n.contextDynamic||a.propDep)i=r;a=a.append(e,i)}else a=i.def(u,".","elements");a&&i("if("+a+")"+l+".bindBuffer(34963,"+a+".buffer.buffer);");return a}(),h=a("primitive"),p=a("offset"),d=function(){var a=c.count,i=t;if(a){if(a.contextDep&&n.contextDynamic||a.propDep)i=r;a=a.append(e,i)}else a=i.def(u,".","count");return a}();if("number"===typeof d){if(0===d)return}else r("if(",d,"){"),r.exit("}");var v,m;le&&(v=a("instances"),m=e.instancing);var g=f+".type",y=c.elements&&H(c.elements);le&&("number"!==typeof v||0<=v)?"string"===typeof v?(r("if(",v,">0){"),i(),r("}else if(",v,"<0){"),o(),r("}")):i():o()}function K(e,t,r,n,a){t=x();a=t.proc("body",a);le&&(t.instancing=a.def(t.shared.extensions,".angle_instanced_arrays"));e(t,a,r,n);return t.compile().body}function J(e,t,r,n){N(e,t);r.useVAO?r.drawVAO?t(e.shared.vao,".setVAO(",r.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),Y(e,t,r,n.attributes,function(){return!0}));W(e,t,r,n.uniforms,function(){return!0});X(e,t,t,r)}function Q(e,t){var r=e.proc("draw",1);N(e,r);P(e,r,t.context);D(e,r,t.framebuffer);R(e,r,t);z(e,r,t.state);q(e,r,t,!1,!0);var n=t.shader.progVar.append(e,r);r(e.shared.gl,".useProgram(",n,".program);");if(t.shader.program)J(e,r,t,t.shader.program);else{r(e.shared.vao,".setVAO(null);");var a=e.global.def("{}"),i=r.def(n,".id"),o=r.def(a,"[",i,"]");r(e.cond(o).then(o,".call(this,a0);")["else"](o,"=",a,"[",i,"]=",e.link(function(r){return K(J,e,t,r,1)}),"(",n,");",o,".call(this,a0);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}function $(e,t,r,n){function a(){return!0}e.batchId="a1";N(e,t);Y(e,t,r,n.attributes,a);W(e,t,r,n.uniforms,a);X(e,t,t,r)}function ee(e,t,r,n){function a(e){return e.contextDep&&o||e.propDep}function i(e){return!a(e)}N(e,t);var o=r.contextDep,s=t.def(),l=t.def();e.shared.props=l;e.batchId=s;var u=e.scope(),c=e.scope();t(u.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",l,"=","a0","[",s,"];",c,"}",u.exit);r.needsContext&&P(e,c,r.context);r.needsFramebuffer&&D(e,c,r.framebuffer);z(e,c,r.state,a);r.profile&&a(r.profile)&&q(e,c,r,!1,!0);n?(r.useVAO?r.drawVAO?a(r.drawVAO)?c(e.shared.vao,".setVAO(",r.drawVAO.append(e,c),");"):u(e.shared.vao,".setVAO(",r.drawVAO.append(e,u),");"):u(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(u(e.shared.vao,".setVAO(null);"),Y(e,u,r,n.attributes,i),Y(e,c,r,n.attributes,a)),W(e,u,r,n.uniforms,i),W(e,c,r,n.uniforms,a),X(e,u,c,r)):(t=e.global.def("{}"),n=r.shader.progVar.append(e,c),l=c.def(n,".id"),u=c.def(t,"[",l,"]"),c(e.shared.gl,".useProgram(",n,".program);","if(!",u,"){",u,"=",t,"[",l,"]=",e.link(function(t){return K($,e,r,t,2)}),"(",n,");}",u,".call(this,a0[",s,"],",s,");"))}function te(e,t){function r(e){return e.contextDep&&a||e.propDep}var n=e.proc("batch",2);e.batchId="0";N(e,n);var a=!1,i=!0;Object.keys(t.context).forEach(function(e){a=a||t.context[e].propDep});a||(P(e,n,t.context),i=!1);var o=t.framebuffer,s=!1;o?(o.propDep?a=s=!0:o.contextDep&&a&&(s=!0),s||D(e,n,o)):D(e,n,null);t.state.viewport&&t.state.viewport.propDep&&(a=!0);R(e,n,t);z(e,n,t.state,function(e){return!r(e)});t.profile&&r(t.profile)||q(e,n,t,!1,"a1");t.contextDep=a;t.needsContext=i;t.needsFramebuffer=s;i=t.shader.progVar;if(i.contextDep&&a||i.propDep)ee(e,n,t,null);else if(i=i.append(e,n),n(e.shared.gl,".useProgram(",i,".program);"),t.shader.program)ee(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var o=e.global.def("{}"),s=n.def(i,".id"),l=n.def(o,"[",s,"]");n(e.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",o,"[",s,"]=",e.link(function(r){return K(ee,e,t,r,2)}),"(",i,");",l,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}function re(e,r){function n(t){var n=r.shader[t];n&&a.set(i.shader,"."+t,n.append(e,a))}var a=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;P(e,a,r.context);r.framebuffer&&r.framebuffer.append(e,a);j(Object.keys(r.state)).forEach(function(t){var n=r.state[t].append(e,a);w(n)?n.forEach(function(r,n){a.set(e.next[t],"["+n+"]",r)}):a.set(i.next,"."+t,n)});q(e,a,r,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(t){var n=r.draw[t];n&&a.set(i.draw,"."+t,""+n.append(e,a))});Object.keys(r.uniforms).forEach(function(n){a.set(i.uniforms,"["+t.id(n)+"]",r.uniforms[n].append(e,a))});Object.keys(r.attributes).forEach(function(t){var n=r.attributes[t].append(e,a),i=e.scopeAttrib(t);Object.keys(new oe).forEach(function(e){a.set(i,"."+e,n[e])})});r.scopeVAO&&a.set(i.vao,".targetVAO",r.scopeVAO.append(e,a));n("vert");n("frag");0<Object.keys(r.state).length&&(a(o,".dirty=true;"),a.exit(o,".dirty=true;"));a("a1(",e.shared.context,",a0,",e.batchId,");")}function ne(e){if("object"===typeof e&&!w(e)){for(var t=Object.keys(e),r=0;r<t.length;++r)if(Z.isDynamic(e[t[r]]))return!0;return!1}}function ie(e,t,r){function n(e,t){o.forEach(function(r){var n=a[r];Z.isDynamic(n)&&(n=e.invoke(t,n),t(c,".",r,"=",n,";"))})}var a=t["static"][r];if(a&&ne(a)){var i=e.global,o=Object.keys(a),s=!1,l=!1,u=!1,c=e.global.def("{}");o.forEach(function(t){var r=a[t];if(Z.isDynamic(r))"function"===typeof r&&(r=a[t]=Z.unbox(r)),t=G(r,null),s=s||t.thisDep,u=u||t.propDep,l=l||t.contextDep;else{i(c,".",t,"=");switch(typeof r){case"number":i(r);break;case"string":i('"',r,'"');break;case"object":Array.isArray(r)&&i("[",r.join(),"]");break;default:i(e.link(r))}i(";")}});t.dynamic[r]=new Z.DynamicVariable(4,{thisDep:s,contextDep:l,propDep:u,ref:c,append:n});delete t["static"][r]}}var oe=u.Record,se={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(se.min=32775,se.max=32776);var le=r.angle_instanced_arrays,ce=r.webgl_draw_buffers,fe={dirty:!0,profile:v.profile},he={},pe=[],de={},ve={};g("dither",3024);g("blend.enable",3042);y("blend.color","blendColor",[0,0,0,0]);y("blend.equation","blendEquationSeparate",[32774,32774]);y("blend.func","blendFuncSeparate",[1,0,1,0]);g("depth.enable",2929,!0);y("depth.func","depthFunc",513);y("depth.range","depthRange",[0,1]);y("depth.mask","depthMask",!0);y("colorMask","colorMask",[!0,!0,!0,!0]);g("cull.enable",2884);y("cull.face","cullFace",1029);y("frontFace","frontFace",2305);y("lineWidth","lineWidth",1);g("polygonOffset.enable",32823);y("polygonOffset.offset","polygonOffset",[0,0]);g("sample.alpha",32926);g("sample.enable",32928);y("sample.coverage","sampleCoverage",[1,!1]);g("stencil.enable",2960);y("stencil.mask","stencilMask",-1);y("stencil.func","stencilFunc",[519,0,-1]);y("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);y("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);g("scissor.enable",3089);y("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);y("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var me={gl:e,context:p,strings:t,next:he,current:fe,draw:h,elements:i,buffer:a,shader:f,attributes:u.state,vao:u,uniforms:l,framebuffer:s,extensions:r,timer:d,isBufferArgs:B},ge={primTypes:ue,compareFuncs:Ie,blendFuncs:Le,blendEquations:se,stencilOps:Oe,glTypes:ae,orientationType:Pe};ce&&(ge.backBuffer=[1029],ge.drawBuffer=c(n.maxDrawbuffers,function(e){return 0===e?[0]:c(e,function(e){return 36064+e})}));var ye=0;return{next:he,current:fe,procs:function(){var e=x(),t=e.proc("poll"),a=e.proc("refresh"),i=e.block();t(i);a(i);var o=e.shared,s=o.gl,l=o.next,u=o.current;i(u,".dirty=false;");D(e,t);D(e,a,null,!0);var f;le&&(f=e.link(le));r.oes_vertex_array_object&&a(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<n.maxAttributes;++h){var p=a.def(o.attributes,"[",h,"]"),d=e.cond(p,".buffer");d.then(s,".enableVertexAttribArray(",h,");",s,".bindBuffer(",34962,",",p,".buffer.buffer);",s,".vertexAttribPointer(",h,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);")["else"](s,".disableVertexAttribArray(",h,");",s,".vertexAttrib4f(",h,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;");a(d);le&&a(f,".vertexAttribDivisorANGLE(",h,",",p,".divisor);")}a(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);");Object.keys(de).forEach(function(r){var n=de[r],o=i.def(l,".",r),c=e.block();c("if(",o,"){",s,".enable(",n,")}else{",s,".disable(",n,")}",u,".",r,"=",o,";");a(c);t("if(",o,"!==",u,".",r,"){",c,"}")});Object.keys(ve).forEach(function(r){var n=ve[r],o=fe[r],f,h,p=e.block();p(s,".",n,"(");w(o)?(n=o.length,f=e.global.def(l,".",r),h=e.global.def(u,".",r),p(c(n,function(e){return f+"["+e+"]"}),");",c(n,function(e){return h+"["+e+"]="+f+"["+e+"];"}).join("")),t("if(",c(n,function(e){return f+"["+e+"]!=="+h+"["+e+"]"}).join("||"),"){",p,"}")):(f=i.def(l,".",r),h=i.def(u,".",r),p(f,");",u,".",r,"=",f,";"),t("if(",f,"!==",h,"){",p,"}"));a(p)});return e.compile()}(),compile:function(e,t,r,n,a){var i=x();i.stats=i.link(a);Object.keys(t["static"]).forEach(function(e){ie(i,t,e)});Ce.forEach(function(t){ie(i,e,t)});r=O(e,t,r,n,i);Q(i,r);re(i,r);te(i,r);return i.compile()}}}function Y(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}var W=function(e,t){for(var r=Object.keys(t),n=0;n<r.length;++n)e[r[n]]=t[r[n]];return e},X=0,Z={DynamicVariable:e,define:function(t,n){return new e(t,r(n+""))},isDynamic:function(t){return"function"===typeof t&&!t._reglType||t instanceof e},unbox:function(t,r){return"function"===typeof t?new e(0,t):t},accessor:r},K={next:"function"===typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"===typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},J="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Q=h();Q.zero=h();var $=function(e,t){var r=1;t.ext_texture_filter_anisotropic&&(r=e.getParameter(34047));var n=1,a=1;t.webgl_draw_buffers&&(n=e.getParameter(34852),a=e.getParameter(36063));var i=!!t.oes_texture_float;if(i){i=e.createTexture();e.bindTexture(3553,i);e.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var o=e.createFramebuffer();e.bindFramebuffer(36160,o);e.framebufferTexture2D(36160,36064,3553,i,0);e.bindTexture(3553,null);if(36053!==e.checkFramebufferStatus(36160))i=!1;else{e.viewport(0,0,1,1);e.clearColor(1,0,0,1);e.clear(16384);var s=Q.allocType(5126,4);e.readPixels(0,0,1,1,6408,5126,s);e.getError()?i=!1:(e.deleteFramebuffer(o),e.deleteTexture(i),i=1===s[0]);Q.freeType(s)}}s=!0;"undefined"!==typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(s=e.createTexture(),o=Q.allocType(5121,36),e.activeTexture(33984),e.bindTexture(34067,s),e.texImage2D(34069,0,6408,3,3,0,6408,5121,o),Q.freeType(o),e.bindTexture(34067,null),e.deleteTexture(s),s=!e.getError());return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:a,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:i,npotTextureCube:s}},ee=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},te=function(e){return Object.keys(e).map(function(t){return e[t]})},re={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,r,n){var a=1;if(t.length)for(var i=0;i<t.length;++i)a*=t[i];else a=0;r=n||Q.allocType(r,a);switch(t.length){case 0:break;case 1:n=t[0];for(t=0;t<n;++t)r[t]=e[t];break;case 2:n=t[0];t=t[1];for(i=a=0;i<n;++i)for(var o=e[i],s=0;s<t;++s)r[a++]=o[s];break;case 3:d(e,t[0],t[1],t[2],r,0);break;default:v(e,t,0,r,0)}return r}},ne={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ae={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ie={dynamic:35048,stream:35040,static:35044},oe=re.flatten,se=re.shape,le=[];le[5120]=1;le[5122]=2;le[5124]=4;le[5121]=1;le[5123]=2;le[5125]=4;le[5126]=4;var ue={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ce=new Float32Array(1),fe=new Uint32Array(ce.buffer),he=[9984,9986,9985,9987],pe=[0,6409,6410,6407,6408],de={};de[6409]=de[6406]=de[6402]=1;de[34041]=de[6410]=2;de[6407]=de[35904]=3;de[6408]=de[35906]=4;var ve=T("HTMLCanvasElement"),me=T("OffscreenCanvas"),ge=T("CanvasRenderingContext2D"),ye=T("ImageBitmap"),xe=T("HTMLImageElement"),_e=T("HTMLVideoElement"),be=Object.keys(ne).concat([ve,me,ge,ye,xe,_e]),we=[];we[5121]=1;we[5126]=4;we[36193]=2;we[5123]=2;we[5125]=4;var Te=[];Te[32854]=2;Te[32855]=2;Te[36194]=2;Te[34041]=4;Te[33776]=.5;Te[33777]=.5;Te[33778]=1;Te[33779]=1;Te[35986]=.5;Te[35987]=1;Te[34798]=1;Te[35840]=.5;Te[35841]=.25;Te[35842]=.5;Te[35843]=.25;Te[36196]=.5;var ke=[];ke[32854]=2;ke[32855]=2;ke[36194]=2;ke[33189]=2;ke[36168]=1;ke[34041]=4;ke[35907]=4;ke[34836]=16;ke[34842]=8;ke[34843]=6;var Ae=function(e,t,r,n,a){function i(e){this.id=u++;this.refCount=1;this.renderbuffer=e;this.format=32854;this.height=this.width=0;a.profile&&(this.stats={size:0})}function o(t){var r=t.renderbuffer;e.bindRenderbuffer(36161,null);e.deleteRenderbuffer(r);t.renderbuffer=null;t.refCount=0;delete c[t.id];n.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907);t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843);t.webgl_color_buffer_float&&(s.rgba32f=34836);var l=[];Object.keys(s).forEach(function(e){l[s[e]]=e});var u=0,c={};i.prototype.decRef=function(){0>=--this.refCount&&o(this)};a.profile&&(n.getTotalRenderbufferSize=function(){var e=0;Object.keys(c).forEach(function(t){e+=c[t].stats.size});return e});return{create:function(t,r){function o(t,r){var n=0,i=0,c=32854;"object"===typeof t&&t?("shape"in t?(i=t.shape,n=i[0]|0,i=i[1]|0):("radius"in t&&(n=i=t.radius|0),"width"in t&&(n=t.width|0),"height"in t&&(i=t.height|0)),"format"in t&&(c=s[t.format])):"number"===typeof t?(n=t|0,i="number"===typeof r?r|0:n):t||(n=i=1);if(n!==u.width||i!==u.height||c!==u.format)return o.width=u.width=n,o.height=u.height=i,u.format=c,e.bindRenderbuffer(36161,u.renderbuffer),e.renderbufferStorage(36161,c,n,i),a.profile&&(u.stats.size=ke[u.format]*u.width*u.height),o.format=l[u.format],o}var u=new i(e.createRenderbuffer());c[u.id]=u;n.renderbufferCount++;o(t,r);o.resize=function(t,r){var n=t|0,i=r|0||n;if(n===u.width&&i===u.height)return o;o.width=u.width=n;o.height=u.height=i;e.bindRenderbuffer(36161,u.renderbuffer);e.renderbufferStorage(36161,u.format,n,i);a.profile&&(u.stats.size=ke[u.format]*u.width*u.height);return o};o._reglType="renderbuffer";o._renderbuffer=u;a.profile&&(o.stats=u.stats);o.destroy=function(){u.decRef()};return o},clear:function(){te(c).forEach(o)},restore:function(){te(c).forEach(function(t){t.renderbuffer=e.createRenderbuffer();e.bindRenderbuffer(36161,t.renderbuffer);e.renderbufferStorage(36161,t.format,t.width,t.height)});e.bindRenderbuffer(36161,null)}}},Me=[];Me[6408]=4;Me[6407]=3;var Ee=[];Ee[5121]=1;Ee[5126]=4;Ee[36193]=2;var Se=["x","y","z","w"],Ce="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Le={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ie={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Oe={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Pe={cw:2304,ccw:2305},De=new U(!1,!1,!1,function(){}),Re=function(e,t){function r(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function n(e,t,n){var a=o.pop()||new r;a.startQueryIndex=e;a.endQueryIndex=t;a.sum=0;a.stats=n;s.push(a)}if(!t.ext_disjoint_timer_query)return null;var a=[],i=[],o=[],s=[],l=[],u=[];return{beginQuery:function(e){var r=a.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,r);i.push(r);n(i.length-1,i.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:n,update:function(){var e,r;e=i.length;if(0!==e){u.length=Math.max(u.length,e+1);l.length=Math.max(l.length,e+1);l[0]=0;var n=u[0]=0;for(r=e=0;r<i.length;++r){var c=i[r];t.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(n+=t.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),a.push(c)):i[e++]=c;l[r+1]=n;u[r+1]=e}i.length=e;for(r=e=0;r<s.length;++r){var n=s[r],f=n.startQueryIndex,c=n.endQueryIndex;n.sum+=l[c]-l[f];f=u[f];c=u[c];c===f?(n.stats.gpuTime+=n.sum/1e6,o.push(n)):(n.startQueryIndex=f,n.endQueryIndex=c,s[e++]=n)}s.length=e}},getNumPendingQueries:function(){return i.length},clear:function(){a.push.apply(a,i);for(var e=0;e<a.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(a[e]);i.length=0;a.length=0},restore:function(){i.length=0;a.length=0}}};return function(e){function t(){if(0===X.length)k&&k.update(),re=null;else{re=K.next(t);p();for(var e=X.length-1;0<=e;--e){var r=X[e];r&&r(S,null,0)}m.flush();k&&k.update()}}function r(){!re&&0<X.length&&(re=K.next(t))}function a(){re&&(K.cancel(t),re=null)}function i(e){e.preventDefault();a();Q.forEach(function(e){e()})}function o(e){m.getError();y.restore();F.restore();O.restore();B.restore();j.restore();U.restore();z.restore();k&&k.restore();H.procs.refresh();r();ee.forEach(function(e){e()})}function s(e){function t(e){var t={},r={};Object.keys(e).forEach(function(n){var a=e[n];Z.isDynamic(a)?r[n]=Z.unbox(a,n):t[n]=a});return{dynamic:r,static:t}}function r(e){for(;c.length<e;)c.push(null);return c}var n=t(e.context||{}),a=t(e.uniforms||{}),i=t(e.attributes||{}),o=t(function(e){function t(e){if(e in r){var t=r[e];delete r[e];Object.keys(t).forEach(function(n){r[e+"."+n]=t[n]})}}var r=W({},e);delete r.uniforms;delete r.attributes;delete r.context;delete r.vao;"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op);t("blend");t("depth");t("cull");t("stencil");t("polygonOffset");t("scissor");t("sample");"vao"in e&&(r.vao=e.vao);return r}(e));e={gpuTime:0,cpuTime:0,count:0};var n=H.compile(o,i,a,n,e),s=n.draw,l=n.batch,u=n.scope,c=[];return W(function(e,t){var n;if("function"===typeof e)return u.call(this,null,e,0);if("function"===typeof t)if("number"===typeof e)for(n=0;n<e;++n)u.call(this,null,t,n);else if(Array.isArray(e))for(n=0;n<e.length;++n)u.call(this,e[n],t,n);else return u.call(this,e,t,0);else if("number"===typeof e){if(0<e)return l.call(this,r(e|0),e|0)}else if(Array.isArray(e)){if(e.length)return l.call(this,e,e.length)}else return s.call(this,e)},{stats:e})}function c(e,t){var r=0;H.procs.poll();var n=t.color;n&&(m.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),r|=16384);"depth"in t&&(m.clearDepth(+t.depth),r|=256);"stencil"in t&&(m.clearStencil(t.stencil|0),r|=1024);m.clear(r)}function f(e){X.push(e);r();return{cancel:function(){function t(){var e=Y(X,t);X[e]=X[X.length-1];--X.length;0>=X.length&&a()}var r=Y(X,e);X[r]=t}}}function h(){var e=V.viewport,t=V.scissor_box;e[0]=e[1]=t[0]=t[1]=0;S.viewportWidth=S.framebufferWidth=S.drawingBufferWidth=e[2]=t[2]=m.drawingBufferWidth;S.viewportHeight=S.framebufferHeight=S.drawingBufferHeight=e[3]=t[3]=m.drawingBufferHeight}function p(){S.tick+=1;S.time=v();h();H.procs.poll()}function d(){h();H.procs.refresh();k&&k.update()}function v(){return(J()-A)/1e3}e=l(e);if(!e)return null;var m=e.gl,g=m.getContextAttributes();m.isContextLost();var y=u(m,e);if(!y)return null;var b=n(),w={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},T=y.extensions,k=Re(m,T),A=J(),M=m.drawingBufferWidth,E=m.drawingBufferHeight,S={tick:0,time:0,viewportWidth:M,viewportHeight:E,framebufferWidth:M,framebufferHeight:E,drawingBufferWidth:M,drawingBufferHeight:E,pixelRatio:e.pixelRatio},C=$(m,T),O=x(m,w,e,function(e){return z.destroyBuffer(e)}),z=P(m,T,C,w,O),N=_(m,T,O,w),F=D(m,b,w,e),B=L(m,T,C,function(){H.procs.poll()},S,w,e),j=Ae(m,T,C,w,e),U=I(m,T,C,B,j,w),H=q(m,b,T,C,O,N,B,U,{},z,F,{elements:null,primitive:4,count:-1,offset:0,instances:-1},S,k,e),b=R(m,U,H.procs.poll,S,g,T,C),V=H.next,G=m.canvas,X=[],Q=[],ee=[],te=[e.onDestroy],re=null;G&&(G.addEventListener("webglcontextlost",i,!1),G.addEventListener("webglcontextrestored",o,!1));var ne=U.setFBO=s({framebuffer:Z.define.call(null,1,"framebuffer")});d();g=W(s,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ne(W({framebuffer:e.framebuffer.faces[t]},e),c);else ne(e,c);else c(null,e)},prop:Z.define.bind(null,1),context:Z.define.bind(null,2),this:Z.define.bind(null,3),draw:s({}),buffer:function(e){return O.create(e,34962,!1,!1)},elements:function(e){return N.create(e,!1)},texture:B.create2D,cube:B.createCube,renderbuffer:j.create,framebuffer:U.create,framebufferCube:U.createCube,vao:z.createVAO,attributes:g,frame:f,on:function(e,t){var r;switch(e){case"frame":return f(t);case"lost":r=Q;break;case"restore":r=ee;break;case"destroy":r=te}r.push(t);return{cancel:function(){for(var e=0;e<r.length;++e)if(r[e]===t){r[e]=r[r.length-1];r.pop();break}}}},limits:C,hasExtension:function(e){return 0<=C.extensions.indexOf(e.toLowerCase())},read:b,destroy:function(){X.length=0;a();G&&(G.removeEventListener("webglcontextlost",i),G.removeEventListener("webglcontextrestored",o));F.clear();U.clear();j.clear();B.clear();N.clear();O.clear();z.clear();k&&k.clear();te.forEach(function(e){e()})},_gl:m,_refresh:d,poll:function(){p();k&&k.update()},now:v,stats:w});e.onDone(null,g);return g}})},{}],541:[function(e,t,r){
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */
"use strict";var n="";var a;t.exports=i;function i(e,t){if(typeof e!=="string"){throw new TypeError("expected a string")}if(t===1)return e;if(t===2)return e+e;var r=e.length*t;if(a!==e||typeof a==="undefined"){a=e;n=""}else if(n.length>=r){return n.substr(0,r)}while(r>n.length&&t>1){if(t&1){n+=e}t>>=1;e+=e}n+=e;n=n.substr(0,r);return n}},{}],542:[function(e,r,n){(function(e){(function(){r.exports=e.performance&&e.performance.now?function e(){return performance.now()}:Date.now||function e(){return+new Date}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],543:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=e.length;var r=e[e.length-1];var n=t;for(var a=t-2;a>=0;--a){var i=r;var o=e[a];r=i+o;var s=r-i;var l=o-s;if(l){e[--n]=r;r=l}}var u=0;for(var a=n;a<t;++a){var i=e[a];var o=r;r=i+o;var s=r-i;var l=o-s;if(l){e[u++]=l}}e[u++]=r;e.length=u;return e}},{}],544:[function(e,t,r){"use strict";var n=e("two-product");var a=e("robust-sum");var i=e("robust-scale");var o=e("robust-compress");var s=6;function l(e,t){var r=new Array(e.length-1);for(var n=1;n<e.length;++n){var a=r[n-1]=new Array(e.length-1);for(var i=0,o=0;i<e.length;++i){if(i===t){continue}a[o++]=e[n][i]}}return r}function u(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n){t[r][n]=["m[",r,"][",n,"]"].join("")}}return t}function c(e){if(e&1){return"-"}return""}function f(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",f(e.slice(0,t)),",",f(e.slice(t)),")"].join("")}}function h(e){if(e.length===2){return["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",h(l(e,r)),",",c(r),e[0][r],")"].join(""))}return f(t)}}function p(e){var t=new Function("sum","scale","prod","compress",["function robustDeterminant",e,"(m){return compress(",h(u(e)),")};return robustDeterminant",e].join(""));return t(a,i,n,o)}var d=[function e(){return[0]},function e(t){return[t[0][0]]}];function v(){while(d.length<s){d.push(p(d.length))}var e=[];var r=["function robustDeterminant(m){switch(m.length){"];for(var n=0;n<s;++n){e.push("det"+n);r.push("case ",n,":return det",n,"(m);")}r.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant");e.push("CACHE","gen",r.join(""));var a=Function.apply(undefined,e);t.exports=a.apply(undefined,d.concat([d,p]));for(var n=0;n<d.length;++n){t.exports[n]=d[n]}}v()},{"robust-compress":543,"robust-scale":550,"robust-sum":553,"two-product":582}],545:[function(e,t,r){"use strict";var n=e("two-product");var a=e("robust-sum");t.exports=i;function i(e,t){var r=n(e[0],t[0]);for(var i=1;i<e.length;++i){r=a(r,n(e[i],t[i]))}return r}},{"robust-sum":553,"two-product":582}],546:[function(e,t,r){"use strict";var n=e("two-product");var a=e("robust-sum");var i=e("robust-subtract");var o=e("robust-scale");var s=6;function l(e,t){var r=new Array(e.length-1);for(var n=1;n<e.length;++n){var a=r[n-1]=new Array(e.length-1);for(var i=0,o=0;i<e.length;++i){if(i===t){continue}a[o++]=e[n][i]}}return r}function u(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n){t[r][n]=["m",n,"[",e-r-2,"]"].join("")}}return t}function c(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",c(e.slice(0,t)),",",c(e.slice(t)),")"].join("")}}function f(e,t){if(e.charAt(0)==="m"){if(t.charAt(0)==="w"){var r=e.split("[");return["w",t.substr(1),"m",r[0].substr(1)].join("")}else{return["prod(",e,",",t,")"].join("")}}else{return f(t,e)}}function h(e){if(e&1!==0){return"-"}return""}function p(e){if(e.length===2){return[["diff(",f(e[0][0],e[1][1]),",",f(e[1][0],e[0][1]),")"].join("")]}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",c(p(l(e,r))),",",h(r),e[0][r],")"].join(""))}return t}}function d(e,t){var r=[];for(var n=0;n<t-2;++n){r.push(["prod(m",e,"[",n,"],m",e,"[",n,"])"].join(""))}return c(r)}function v(e){var t=[];var r=[];var s=u(e);for(var f=0;f<e;++f){s[0][f]="1";s[e-1][f]="w"+f}for(var f=0;f<e;++f){if((f&1)===0){t.push.apply(t,p(l(s,f)))}else{r.push.apply(r,p(l(s,f)))}}var h=c(t);var v=c(r);var m="exactInSphere"+e;var g=[];for(var f=0;f<e;++f){g.push("m"+f)}var y=["function ",m,"(",g.join(),"){"];for(var f=0;f<e;++f){y.push("var w",f,"=",d(f,e),";");for(var x=0;x<e;++x){if(x!==f){y.push("var w",f,"m",x,"=scale(w",f,",m",x,"[0]);")}}}y.push("var p=",h,",n=",v,",d=diff(p,n);return d[d.length-1];}return ",m);var _=new Function("sum","diff","prod","scale",y.join(""));return _(a,i,n,o)}function m(){return 0}function g(){return 0}function y(){return 0}var x=[m,g,y];function _(e){var t=x[e.length];if(!t){t=x[e.length]=v(e.length)}return t.apply(undefined,e)}function b(){while(x.length<=s){x.push(v(x.length))}var e=[];var r=["slow"];for(var n=0;n<=s;++n){e.push("a"+n);r.push("o"+n)}var a=["function testInSphere(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var n=2;n<=s;++n){a.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");")}a.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere");r.push(a.join(""));var i=Function.apply(undefined,r);t.exports=i.apply(undefined,[_].concat(x));for(var n=0;n<=s;++n){t.exports[n]=x[n]}}b()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":582}],547:[function(e,t,r){"use strict";var n=e("robust-determinant");var a=6;function i(e){var t="robustLinearSolve"+e+"d";var r=["function ",t,"(A,b){return ["];for(var a=0;a<e;++a){r.push("det([");for(var i=0;i<e;++i){if(i>0){r.push(",")}r.push("[");for(var o=0;o<e;++o){if(o>0){r.push(",")}if(o===a){r.push("+b[",i,"]")}else{r.push("+A[",i,"][",o,"]")}}r.push("]")}r.push("]),")}r.push("det(A)]}return ",t);var s=new Function("det",r.join(""));if(e<6){return s(n[e])}return s(n)}function o(){return[0]}function s(e,t){return[[t[0]],[e[0][0]]]}var l=[o,s];function u(){while(l.length<a){l.push(i(l.length))}var e=[];var r=["function dispatchLinearSolve(A,b){switch(A.length){"];for(var n=0;n<a;++n){e.push("s"+n);r.push("case ",n,":return s",n,"(A,b);")}r.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve");e.push("CACHE","g",r.join(""));var o=Function.apply(undefined,e);t.exports=o.apply(undefined,l.concat([l,i]));for(var n=0;n<a;++n){t.exports[n]=l[n]}}u()},{"robust-determinant":544}],548:[function(e,t,r){"use strict";var n=e("two-product");var a=e("robust-sum");var i=e("robust-scale");var o=e("robust-subtract");var s=5;var l=1.1102230246251565e-16;var u=(3+16*l)*l;var c=(7+56*l)*l;function f(e,t){var r=new Array(e.length-1);for(var n=1;n<e.length;++n){var a=r[n-1]=new Array(e.length-1);for(var i=0,o=0;i<e.length;++i){if(i===t){continue}a[o++]=e[n][i]}}return r}function h(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n){t[r][n]=["m",n,"[",e-r-1,"]"].join("")}}return t}function p(e){if(e&1){return"-"}return""}function d(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",d(e.slice(0,t)),",",d(e.slice(t)),")"].join("")}}function v(e){if(e.length===2){return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")]}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",d(v(f(e,r))),",",p(r),e[0][r],")"].join(""))}return t}}function m(e){var t=[];var r=[];var s=h(e);var l=[];for(var u=0;u<e;++u){if((u&1)===0){t.push.apply(t,v(f(s,u)))}else{r.push.apply(r,v(f(s,u)))}l.push("m"+u)}var c=d(t);var p=d(r);var m="orientation"+e+"Exact";var g=["function ",m,"(",l.join(),"){var p=",c,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",m].join("");var y=new Function("sum","prod","scale","sub",g);return y(a,n,i,o)}var g=m(3);var y=m(4);var x=[function e(){return 0},function e(){return 0},function e(t,r){return r[0]-t[0]},function e(t,r,n){var a=(t[1]-n[1])*(r[0]-n[0]);var i=(t[0]-n[0])*(r[1]-n[1]);var o=a-i;var s;if(a>0){if(i<=0){return o}else{s=a+i}}else if(a<0){if(i>=0){return o}else{s=-(a+i)}}else{return o}var l=u*s;if(o>=l||o<=-l){return o}return g(t,r,n)},function e(t,r,n,a){var i=t[0]-a[0];var o=r[0]-a[0];var s=n[0]-a[0];var l=t[1]-a[1];var u=r[1]-a[1];var f=n[1]-a[1];var h=t[2]-a[2];var p=r[2]-a[2];var d=n[2]-a[2];var v=o*f;var m=s*u;var g=s*l;var x=i*f;var _=i*u;var b=o*l;var w=h*(v-m)+p*(g-x)+d*(_-b);var T=(Math.abs(v)+Math.abs(m))*Math.abs(h)+(Math.abs(g)+Math.abs(x))*Math.abs(p)+(Math.abs(_)+Math.abs(b))*Math.abs(d);var k=c*T;if(w>k||-w>k){return w}return y(t,r,n,a)}];function _(e){var t=x[e.length];if(!t){t=x[e.length]=m(e.length)}return t.apply(undefined,e)}function b(){while(x.length<=s){x.push(m(x.length))}var e=[];var r=["slow"];for(var n=0;n<=s;++n){e.push("a"+n);r.push("o"+n)}var a=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var n=2;n<=s;++n){a.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");")}a.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");r.push(a.join(""));var i=Function.apply(undefined,r);t.exports=i.apply(undefined,[_].concat(x));for(var n=0;n<=s;++n){t.exports[n]=x[n]}}b()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":582}],549:[function(e,t,r){"use strict";var n=e("robust-sum");var a=e("robust-scale");t.exports=i;function i(e,t){if(e.length===1){return a(t,e[0])}if(t.length===1){return a(e,t[0])}if(e.length===0||t.length===0){return[0]}var r=[0];if(e.length<t.length){for(var i=0;i<e.length;++i){r=n(r,a(t,e[i]))}}else{for(var i=0;i<t.length;++i){r=n(r,a(e,t[i]))}}return r}},{"robust-scale":550,"robust-sum":553}],550:[function(e,t,r){"use strict";var n=e("two-product");var a=e("two-sum");t.exports=i;function i(e,t){var r=e.length;if(r===1){var i=n(e[0],t);if(i[0]){return i}return[i[1]]}var o=new Array(2*r);var s=[.1,.1];var l=[.1,.1];var u=0;n(e[0],t,s);if(s[0]){o[u++]=s[0]}for(var c=1;c<r;++c){n(e[c],t,l);var f=s[1];a(f,l[0],s);if(s[0]){o[u++]=s[0]}var h=l[1];var p=s[1];var d=h+p;var v=d-h;var m=p-v;s[1]=d;if(m){o[u++]=m}}if(s[1]){o[u++]=s[1]}if(u===0){o[u++]=0}o.length=u;return o}},{"two-product":582,"two-sum":583}],551:[function(e,t,r){"use strict";t.exports=i;var n=e("robust-orientation")[3];function a(e,t,r,n){for(var a=0;a<2;++a){var i=e[a];var o=t[a];var s=Math.min(i,o);var l=Math.max(i,o);var u=r[a];var c=n[a];var f=Math.min(u,c);var h=Math.max(u,c);if(h<s||l<f){return false}}return true}function i(e,t,r,i){var o=n(e,r,i);var s=n(t,r,i);if(o>0&&s>0||o<0&&s<0){return false}var l=n(r,e,t);var u=n(i,e,t);if(l>0&&u>0||l<0&&u<0){return false}if(o===0&&s===0&&l===0&&u===0){return a(e,t,r,i)}return true}},{"robust-orientation":548}],552:[function(e,t,r){"use strict";t.exports=a;function n(e,t){var r=e+t;var n=r-e;var a=r-n;var i=t-n;var o=e-a;var s=o+i;if(s){return[s,r]}return[r]}function a(e,t){var r=e.length|0;var a=t.length|0;if(r===1&&a===1){return n(e[0],-t[0])}var i=r+a;var o=new Array(i);var s=0;var l=0;var u=0;var c=Math.abs;var f=e[l];var h=c(f);var p=-t[u];var d=c(p);var v,m;if(h<d){m=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{m=p;u+=1;if(u<a){p=-t[u];d=c(p)}}if(l<r&&h<d||u>=a){v=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=-t[u];d=c(p)}}var g=v+m;var y=g-v;var x=m-y;var _=x;var b=g;var w,T,k,A,M;while(l<r&&u<a){if(h<d){v=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=-t[u];d=c(p)}}m=_;g=v+m;y=g-v;x=m-y;if(x){o[s++]=x}w=b+g;T=w-b;k=w-T;A=g-T;M=b-k;_=M+A;b=w}while(l<r){v=f;m=_;g=v+m;y=g-v;x=m-y;if(x){o[s++]=x}w=b+g;T=w-b;k=w-T;A=g-T;M=b-k;_=M+A;b=w;l+=1;if(l<r){f=e[l]}}while(u<a){v=p;m=_;g=v+m;y=g-v;x=m-y;if(x){o[s++]=x}w=b+g;T=w-b;k=w-T;A=g-T;M=b-k;_=M+A;b=w;u+=1;if(u<a){p=-t[u]}}if(_){o[s++]=_}if(b){o[s++]=b}if(!s){o[s++]=0}o.length=s;return o}},{}],553:[function(e,t,r){"use strict";t.exports=a;function n(e,t){var r=e+t;var n=r-e;var a=r-n;var i=t-n;var o=e-a;var s=o+i;if(s){return[s,r]}return[r]}function a(e,t){var r=e.length|0;var a=t.length|0;if(r===1&&a===1){return n(e[0],t[0])}var i=r+a;var o=new Array(i);var s=0;var l=0;var u=0;var c=Math.abs;var f=e[l];var h=c(f);var p=t[u];var d=c(p);var v,m;if(h<d){m=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{m=p;u+=1;if(u<a){p=t[u];d=c(p)}}if(l<r&&h<d||u>=a){v=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=t[u];d=c(p)}}var g=v+m;var y=g-v;var x=m-y;var _=x;var b=g;var w,T,k,A,M;while(l<r&&u<a){if(h<d){v=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=t[u];d=c(p)}}m=_;g=v+m;y=g-v;x=m-y;if(x){o[s++]=x}w=b+g;T=w-b;k=w-T;A=g-T;M=b-k;_=M+A;b=w}while(l<r){v=f;m=_;g=v+m;y=g-v;x=m-y;if(x){o[s++]=x}w=b+g;T=w-b;k=w-T;A=g-T;M=b-k;_=M+A;b=w;l+=1;if(l<r){f=e[l]}}while(u<a){v=p;m=_;g=v+m;y=g-v;x=m-y;if(x){o[s++]=x}w=b+g;T=w-b;k=w-T;A=g-T;M=b-k;_=M+A;b=w;u+=1;if(u<a){p=t[u]}}if(_){o[s++]=_}if(b){o[s++]=b}if(!s){o[s++]=0}o.length=s;return o}},{}],554:[function(e,t,r){"use strict";t.exports=function e(t){if(t<0){return-1}if(t>0){return 1}return 0}},{}],555:[function(e,t,r){"use strict";t.exports=i;var n=e("boundary-cells");var a=e("reduce-simplicial-complex");function i(e){return a(n(e))}},{"boundary-cells":100,"reduce-simplicial-complex":533}],556:[function(e,t,r){"use strict";t.exports=p;var n=e("ndarray");var a=e("typedarray-pool");var i=e("ndarray-sort");var o=e("./lib/codegen");function s(e){var t=e.length;var r=0;for(var n=0;n<t;++n){r=Math.max(r,e[n].length)|0}return r-1}function l(e,t){var r=e.length;var n=a.mallocUint8(r);for(var i=0;i<r;++i){n[i]=e[i]<t|0}return n}function u(e,t){var r=e.length;var o=t*(t+1)/2*r|0;var s=a.mallocUint32(o*2);var l=0;for(var u=0;u<r;++u){var c=e[u];var t=c.length;for(var f=0;f<t;++f){for(var h=0;h<f;++h){var p=c[h];var d=c[f];s[l++]=Math.min(p,d)|0;s[l++]=Math.max(p,d)|0}}}var v=l/2|0;i(n(s,[v,2]));var m=2;for(var u=2;u<l;u+=2){if(s[u-2]===s[u]&&s[u-1]===s[u+1]){continue}s[m++]=s[u];s[m++]=s[u+1]}return n(s,[m/2|0,2])}function c(e,t,r,i){var o=e.data;var s=e.shape[0];var l=a.mallocDouble(s);var u=0;for(var c=0;c<s;++c){var f=o[2*c];var h=o[2*c+1];if(r[f]===r[h]){continue}var p=t[f];var d=t[h];o[2*u]=f;o[2*u+1]=h;l[u++]=(d-i)/(d-p)}e.shape[0]=u;return n(l,[u])}function f(e,t){var r=a.mallocInt32(t*2);var n=e.shape[0];var i=e.data;r[0]=0;var o=0;for(var s=0;s<n;++s){var l=i[2*s];if(l!==o){r[2*o+1]=s;while(++o<l){r[2*o]=s;r[2*o+1]=s}r[2*o]=s}}r[2*o+1]=n;while(++o<t){r[2*o]=r[2*o+1]=n}return r}function h(e){var t=e.shape[0]|0;var r=e.data;var n=new Array(t);for(var a=0;a<t;++a){n[a]=[r[2*a],r[2*a+1]]}return n}function p(e,t,r,n){r=r||0;if(typeof n==="undefined"){n=s(e)}var i=e.length;if(i===0||n<1){return{cells:[],vertexIds:[],vertexWeights:[]}}var p=l(t,+r);var d=u(e,n);var v=c(d,t,p,+r);var m=f(d,t.length|0);var g=o(n)(e,d.data,m,p);var y=h(d);var x=[].slice.call(v.data,0,v.shape[0]);a.free(p);a.free(d.data);a.free(v.data);a.free(m);return{cells:g,vertexIds:y,vertexWeights:x}}},{"./lib/codegen":557,ndarray:495,"ndarray-sort":494,"typedarray-pool":595}],557:[function(e,t,r){"use strict";t.exports=s;var n=e("typedarray-pool");var a=e("marching-simplex-table");var i={};function o(e){var t=0;var r=new Array(e+1);r[0]=[[]];for(var i=1;i<=e;++i){var o=r[i]=a(i);for(var s=0;s<o.length;++s){t=Math.max(t,o[i].length)}}var l=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",e,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function u(e){if(e.length<=0){return}l.push("R.push(");for(var t=0;t<e.length;++t){var r=e[t];if(t>0){l.push(",")}l.push("[");for(var n=0;n<r.length;++n){var a=r[n];if(n>0){l.push(",")}l.push("B(C,E,c[",a[0],"],c[",a[1],"])")}l.push("]")}l.push(");")}for(var i=e+1;i>1;--i){if(i<e+1){l.push("else ")}l.push("if(l===",i,"){");var c=[];for(var s=0;s<i;++s){c.push("(S[c["+s+"]]<<"+s+")")}l.push("var M=",c.join("+"),";if(M===0||M===",(1<<i)-1,"){continue}switch(M){");var o=r[i-1];for(var s=0;s<o.length;++s){l.push("case ",s,":");u(o[s]);l.push("break;")}l.push("}}")}l.push("}return R;};return getContour",e,"d");var f=new Function("pool",l.join(""));return f(n)}function s(e){var t=i[e];if(!t){t=i[e]=o(e)}return t}},{"marching-simplex-table":474,"typedarray-pool":595}],558:[function(e,t,r){"use strict";"use restrict";var n=e("bit-twiddle"),a=e("union-find");function i(e){var t=0,r=Math.max;for(var n=0,a=e.length;n<a;++n){t=r(t,e[n].length)}return t-1}r.dimension=i;function o(e){var t=-1,r=Math.max;for(var n=0,a=e.length;n<a;++n){var i=e[n];for(var o=0,s=i.length;o<s;++o){t=r(t,i[o])}}return t+1}r.countVertices=o;function s(e){var t=new Array(e.length);for(var r=0,n=e.length;r<n;++r){t[r]=e[r].slice(0)}return t}r.cloneCells=s;function l(e,t){var r=e.length,n=e.length-t.length,a=Math.min;if(n){return n}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:var i=e[0]+e[1]-t[0]-t[1];if(i){return i}return a(e[0],e[1])-a(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];i=o+e[2]-(s+t[2]);if(i){return i}var l=a(e[0],e[1]),u=a(t[0],t[1]),i=a(l,e[2])-a(u,t[2]);if(i){return i}return a(l+e[2],o)-a(u+t[2],s);default:var c=e.slice(0);c.sort();var f=t.slice(0);f.sort();for(var h=0;h<r;++h){n=c[h]-f[h];if(n){return n}}return 0}}r.compareCells=l;function u(e,t){return l(e[0],t[0])}function c(e,t){if(t){var r=e.length;var n=new Array(r);for(var a=0;a<r;++a){n[a]=[e[a],t[a]]}n.sort(u);for(var a=0;a<r;++a){e[a]=n[a][0];t[a]=n[a][1]}return e}else{e.sort(l);return e}}r.normalize=c;function f(e){if(e.length===0){return[]}var t=1,r=e.length;for(var n=1;n<r;++n){var a=e[n];if(l(a,e[n-1])){if(n===t){t++;continue}e[t++]=a}}e.length=t;return e}r.unique=f;function h(e,t){var r=0,n=e.length-1,a=-1;while(r<=n){var i=r+n>>1,o=l(e[i],t);if(o<=0){if(o===0){a=i}r=i+1}else if(o>0){n=i-1}}return a}r.findCell=h;function p(e,t){var r=new Array(e.length);for(var a=0,i=r.length;a<i;++a){r[a]=[]}var o=[];for(var a=0,s=t.length;a<s;++a){var u=t[a];var c=u.length;for(var f=1,p=1<<c;f<p;++f){o.length=n.popCount(f);var d=0;for(var v=0;v<c;++v){if(f&1<<v){o[d++]=u[v]}}var m=h(e,o);if(m<0){continue}while(true){r[m++].push(a);if(m>=e.length||l(e[m],o)!==0){break}}}}return r}r.incidence=p;function d(e,t){if(!t){return p(f(m(e,0)),e,0)}var r=new Array(t);for(var n=0;n<t;++n){r[n]=[]}for(var n=0,a=e.length;n<a;++n){var i=e[n];for(var o=0,s=i.length;o<s;++o){r[i[o]].push(n)}}return r}r.dual=d;function v(e){var t=[];for(var r=0,n=e.length;r<n;++r){var a=e[r],i=a.length|0;for(var o=1,s=1<<i;o<s;++o){var l=[];for(var u=0;u<i;++u){if(o>>>u&1){l.push(a[u])}}t.push(l)}}return c(t)}r.explode=v;function m(e,t){if(t<0){return[]}var r=[],a=(1<<t+1)-1;for(var i=0;i<e.length;++i){var o=e[i];for(var s=a;s<1<<o.length;s=n.nextCombination(s)){var l=new Array(t+1),u=0;for(var f=0;f<o.length;++f){if(s&1<<f){l[u++]=o[f]}}r.push(l)}}return c(r)}r.skeleton=m;function g(e){var t=[];for(var r=0,n=e.length;r<n;++r){var a=e[r];for(var i=0,o=a.length;i<o;++i){var s=new Array(a.length-1);for(var l=0,u=0;l<o;++l){if(l!==i){s[u++]=a[l]}}t.push(s)}}return c(t)}r.boundary=g;function y(e,t){var r=new a(t);for(var n=0;n<e.length;++n){var i=e[n];for(var o=0;o<i.length;++o){for(var s=o+1;s<i.length;++s){r.link(i[o],i[s])}}}var l=[],u=r.ranks;for(var n=0;n<u.length;++n){u[n]=-1}for(var n=0;n<e.length;++n){var c=r.find(e[n][0]);if(u[c]<0){u[c]=l.length;l.push([e[n].slice(0)])}else{l[u[c]].push(e[n].slice(0))}}return l}function x(e){var t=f(c(m(e,0))),r=new a(t.length);for(var n=0;n<e.length;++n){var i=e[n];for(var o=0;o<i.length;++o){var s=h(t,[i[o]]);for(var l=o+1;l<i.length;++l){r.link(s,h(t,[i[l]]))}}}var u=[],p=r.ranks;for(var n=0;n<p.length;++n){p[n]=-1}for(var n=0;n<e.length;++n){var d=r.find(h(t,[e[n][0]]));if(p[d]<0){p[d]=u.length;u.push([e[n].slice(0)])}else{u[p[d]].push(e[n].slice(0))}}return u}function _(e,t){if(t){return y(e,t)}return x(e)}r.connectedComponents=_},{"bit-twiddle":97,"union-find":596}],559:[function(e,t,r){arguments[4][97][0].apply(r,arguments)},{dup:97}],560:[function(e,t,r){arguments[4][558][0].apply(r,arguments)},{"bit-twiddle":559,dup:558,"union-find":561}],561:[function(e,t,r){"use strict";"use restrict";t.exports=n;function n(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}n.prototype.length=function(){return this.roots.length};n.prototype.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};n.prototype.find=function(e){var t=this.roots;while(t[e]!==e){var r=t[e];t[e]=t[r];e=r}return e};n.prototype.link=function(e,t){var r=this.find(e),n=this.find(t);if(r===n){return}var a=this.ranks,i=this.roots,o=a[r],s=a[n];if(o<s){i[r]=n}else if(s<o){i[n]=r}else{i[n]=r;++a[r]}}},{}],562:[function(e,t,r){"use strict";t.exports=o;var n=e("robust-orientation");var a=e("simplicial-complex");function i(e,t,r){var a=Math.abs(n(e,t,r));var i=Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2));return a/i}function o(e,t,r){var n=t.length;var o=e.length;var s=new Array(n);var l=new Array(n);var u=new Array(n);var c=new Array(n);for(var f=0;f<n;++f){s[f]=l[f]=-1;u[f]=Infinity;c[f]=false}for(var f=0;f<o;++f){var h=e[f];if(h.length!==2){throw new Error("Input must be a graph")}var p=h[1];var d=h[0];if(l[d]!==-1){l[d]=-2}else{l[d]=p}if(s[p]!==-1){s[p]=-2}else{s[p]=d}}function v(e){if(c[e]){return Infinity}var r=s[e];var n=l[e];if(r<0||n<0){return Infinity}else{return i(t[e],t[r],t[n])}}function m(e,t){var r=k[e];var n=k[t];k[e]=n;k[t]=r;A[r]=t;A[n]=e}function g(e){return u[k[e]]}function y(e){if(e&1){return e-1>>1}return(e>>1)-1}function x(e){var t=g(e);while(true){var r=t;var n=2*e+1;var a=2*(e+1);var i=e;if(n<E){var o=g(n);if(o<r){i=n;r=o}}if(a<E){var s=g(a);if(s<r){i=a}}if(i===e){return e}m(e,i);e=i}}function _(e){var t=g(e);while(e>0){var r=y(e);if(r>=0){var n=g(r);if(t<n){m(e,r);e=r;continue}}return e}}function b(){if(E>0){var e=k[0];m(0,E-1);E-=1;x(0);return e}return-1}function w(e,t){var r=k[e];if(u[r]===t){return e}u[r]=-Infinity;_(e);b();u[r]=t;E+=1;return _(E-1)}function T(e){if(c[e]){return}c[e]=true;var t=s[e];var r=l[e];if(s[r]>=0){s[r]=t}if(l[t]>=0){l[t]=r}if(A[t]>=0){w(A[t],v(t))}if(A[r]>=0){w(A[r],v(r))}}var k=[];var A=new Array(n);for(var f=0;f<n;++f){var M=u[f]=v(f);if(M<Infinity){A[f]=k.length;k.push(f)}else{A[f]=-1}}var E=k.length;for(var f=E>>1;f>=0;--f){x(f)}while(true){var S=b();if(S<0||u[S]>r){break}T(S)}var C=[];for(var f=0;f<n;++f){if(!c[f]){A[f]=C.length;C.push(t[f].slice())}}var L=C.length;function I(e,t){if(e[t]<0){return t}var r=t;var n=t;do{var a=e[n];if(!c[n]||a<0||a===n){break}n=a;a=e[n];if(!c[n]||a<0||a===n){break}n=a;r=e[r]}while(r!==n);for(var i=t;i!==n;i=e[i]){e[i]=n}return n}var O=[];e.forEach(function(e){var t=I(s,e[0]);var r=I(l,e[1]);if(t>=0&&r>=0&&t!==r){var n=A[t];var a=A[r];if(n!==a){O.push([n,a])}}});a.unique(a.normalize(O));return{positions:C,edges:O}}},{"robust-orientation":548,"simplicial-complex":560}],563:[function(e,t,r){"use strict";t.exports=i;var n=e("robust-orientation");function a(e,t){var r,a;if(t[0][0]<t[1][0]){r=t[0];a=t[1]}else if(t[0][0]>t[1][0]){r=t[1];a=t[0]}else{var i=Math.min(e[0][1],e[1][1]);var o=Math.max(e[0][1],e[1][1]);var s=Math.min(t[0][1],t[1][1]);var l=Math.max(t[0][1],t[1][1]);if(o<s){return o-s}if(i>l){return i-l}return o-l}var u,c;if(e[0][1]<e[1][1]){u=e[0];c=e[1]}else{u=e[1];c=e[0]}var f=n(a,r,u);if(f){return f}f=n(a,r,c);if(f){return f}return c-a}function i(e,t){var r,i;if(t[0][0]<t[1][0]){r=t[0];i=t[1]}else if(t[0][0]>t[1][0]){r=t[1];i=t[0]}else{return a(t,e)}var o,s;if(e[0][0]<e[1][0]){o=e[0];s=e[1]}else if(e[0][0]>e[1][0]){o=e[1];s=e[0]}else{return-a(e,t)}var l=n(r,i,s);var u=n(r,i,o);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}l=n(s,o,i);u=n(s,o,r);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}return i[0]-s[0]}},{"robust-orientation":548}],564:[function(e,t,r){arguments[4][243][0].apply(r,arguments)},{dup:243}],565:[function(e,t,r){"use strict";t.exports=p;var n=e("binary-search-bounds");var a=e("functional-red-black-tree");var i=e("robust-orientation");var o=e("./lib/order-segments");function s(e,t,r){this.slabs=e;this.coordinates=t;this.horizontal=r}var l=s.prototype;function u(e,t){return e.y-t}function c(e,t){var r=null;while(e){var n=e.key;var a,o;if(n[0][0]<n[1][0]){a=n[0];o=n[1]}else{a=n[1];o=n[0]}var s=i(a,o,t);if(s<0){e=e.left}else if(s>0){if(t[0]!==n[1][0]){r=e;e=e.right}else{var l=c(e.right,t);if(l){return l}e=e.left}}else{if(t[0]!==n[1][0]){return e}else{var l=c(e.right,t);if(l){return l}e=e.left}}}return r}l.castUp=function(e){var t=n.le(this.coordinates,e[0]);if(t<0){return-1}var r=this.slabs[t];var a=c(this.slabs[t],e);var s=-1;if(a){s=a.value}if(this.coordinates[t]===e[0]){var l=null;if(a){l=a.key}if(t>0){var f=c(this.slabs[t-1],e);if(f){if(l){if(o(f.key,l)>0){l=f.key;s=f.value}}else{s=f.value;l=f.key}}}var h=this.horizontal[t];if(h.length>0){var p=n.ge(h,e[1],u);if(p<h.length){var d=h[p];if(e[1]===d.y){if(d.closed){return d.index}else{while(p<h.length-1&&h[p+1].y===e[1]){p=p+1;d=h[p];if(d.closed){return d.index}}if(d.y===e[1]&&!d.start){p=p+1;if(p>=h.length){return s}d=h[p]}}}if(d.start){if(l){var v=i(l[0],l[1],[e[0],d.y]);if(l[0][0]>l[1][0]){v=-v}if(v>0){s=d.index}}else{s=d.index}}else if(d.y!==e[1]){s=d.index}}}}return s};function f(e,t,r,n){this.y=e;this.index=t;this.start=r;this.closed=n}function h(e,t,r,n){this.x=e;this.segment=t;this.create=r;this.index=n}function p(e){var t=e.length;var r=2*t;var n=new Array(r);for(var i=0;i<t;++i){var l=e[i];var u=l[0][0]<l[1][0];n[2*i]=new h(l[0][0],l,u,i);n[2*i+1]=new h(l[1][0],l,!u,i)}n.sort(function(e,t){var r=e.x-t.x;if(r){return r}r=e.create-t.create;if(r){return r}return Math.min(e.segment[0][1],e.segment[1][1])-Math.min(t.segment[0][1],t.segment[1][1])});var c=a(o);var p=[];var d=[];var v=[];var m=-Infinity;for(var i=0;i<r;){var g=n[i].x;var y=[];while(i<r){var x=n[i];if(x.x!==g){break}i+=1;if(x.segment[0][0]===x.x&&x.segment[1][0]===x.x){if(x.create){if(x.segment[0][1]<x.segment[1][1]){y.push(new f(x.segment[0][1],x.index,true,true));y.push(new f(x.segment[1][1],x.index,false,false))}else{y.push(new f(x.segment[1][1],x.index,true,false));y.push(new f(x.segment[0][1],x.index,false,true))}}}else{if(x.create){c=c.insert(x.segment,x.index)}else{c=c.remove(x.segment)}}}p.push(c.root);d.push(g);v.push(y)}return new s(p,d,v)}},{"./lib/order-segments":563,"binary-search-bounds":564,"functional-red-black-tree":247,"robust-orientation":548}],566:[function(e,t,r){"use strict";var n=e("robust-dot-product");var a=e("robust-sum");t.exports=s;t.exports.positive=l;t.exports.negative=u;function i(e,t){var r=a(n(e,t),[t[t.length-1]]);return r[r.length-1]}function o(e,t,r,n){var a=n-t;var i=-t/a;if(i<0){i=0}else if(i>1){i=1}var o=1-i;var s=e.length;var l=new Array(s);for(var u=0;u<s;++u){l[u]=i*e[u]+o*r[u]}return l}function s(e,t){var r=[];var n=[];var a=i(e[e.length-1],t);for(var s=e[e.length-1],l=e[0],u=0;u<e.length;++u,s=l){l=e[u];var c=i(l,t);if(a<0&&c>0||a>0&&c<0){var f=o(s,c,l,a);r.push(f);n.push(f.slice())}if(c<0){n.push(l.slice())}else if(c>0){r.push(l.slice())}else{r.push(l.slice());n.push(l.slice())}a=c}return{positive:r,negative:n}}function l(e,t){var r=[];var n=i(e[e.length-1],t);for(var a=e[e.length-1],s=e[0],l=0;l<e.length;++l,a=s){s=e[l];var u=i(s,t);if(n<0&&u>0||n>0&&u<0){r.push(o(a,u,s,n))}if(u>=0){r.push(s.slice())}n=u}return r}function u(e,t){var r=[];var n=i(e[e.length-1],t);for(var a=e[e.length-1],s=e[0],l=0;l<e.length;++l,a=s){s=e[l];var u=i(s,t);if(n<0&&u>0||n>0&&u<0){r.push(o(a,u,s,n))}if(u<=0){r.push(s.slice())}n=u}return r}},{"robust-dot-product":545,"robust-sum":553}],567:[function(t,r,n){!function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(e){return i(s(e),arguments)}function a(e,t){return r.apply(null,[e].concat(t||[]))}function i(e,n){var a=1,i=e.length,o,s="",l,u,c,f,h,p,d,v;for(l=0;l<i;l++){if(typeof e[l]==="string"){s+=e[l]}else if(typeof e[l]==="object"){c=e[l];if(c.keys){o=n[a];for(u=0;u<c.keys.length;u++){if(o==undefined){throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[u],c.keys[u-1]))}o=o[c.keys[u]]}}else if(c.param_no){o=n[c.param_no]}else{o=n[a++]}if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&o instanceof Function){o=o()}if(t.numeric_arg.test(c.type)&&(typeof o!=="number"&&isNaN(o))){throw new TypeError(r("[sprintf] expecting number but found %T",o))}if(t.number.test(c.type)){d=o>=0}switch(c.type){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,c.width?parseInt(c.width):0);break;case"e":o=c.precision?parseFloat(o).toExponential(c.precision):parseFloat(o).toExponential();break;case"f":o=c.precision?parseFloat(o).toFixed(c.precision):parseFloat(o);break;case"g":o=c.precision?String(Number(o.toPrecision(c.precision))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o);o=c.precision?o.substring(0,c.precision):o;break;case"t":o=String(!!o);o=c.precision?o.substring(0,c.precision):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase();o=c.precision?o.substring(0,c.precision):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf();o=c.precision?o.substring(0,c.precision):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase();break}if(t.json.test(c.type)){s+=o}else{if(t.number.test(c.type)&&(!d||c.sign)){v=d?"+":"-";o=o.toString().replace(t.sign,"")}else{v=""}h=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ";p=c.width-(v+o).length;f=c.width?p>0?h.repeat(p):"":"";s+=c.align?v+o+f:h==="0"?v+f+o:f+v+o}}}return s}var o=Object.create(null);function s(e){if(o[e]){return o[e]}var r=e,n,a=[],i=0;while(r){if((n=t.text.exec(r))!==null){a.push(n[0])}else if((n=t.modulo.exec(r))!==null){a.push("%")}else if((n=t.placeholder.exec(r))!==null){if(n[2]){i|=1;var s=[],l=n[2],u=[];if((u=t.key.exec(l))!==null){s.push(u[1]);while((l=l.substring(u[0].length))!==""){if((u=t.key_access.exec(l))!==null){s.push(u[1])}else if((u=t.index_access.exec(l))!==null){s.push(u[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=s}else{i|=2}if(i===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}a.push({placeholder:n[0],param_no:n[1],keys:n[2],sign:n[3],pad_char:n[4],align:n[5],width:n[6],precision:n[7],type:n[8]})}else{throw new SyntaxError("[sprintf] unexpected placeholder")}r=r.substring(n[0].length)}return o[e]=a}if(typeof n!=="undefined"){n["sprintf"]=r;n["vsprintf"]=a}if(typeof window!=="undefined"){window["sprintf"]=r;window["vsprintf"]=a;if(typeof e==="function"&&e["amd"]){e(function(){return{sprintf:r,vsprintf:a}})}}}()},{}],568:[function(e,t,r){"use strict";var n=e("parenthesis");t.exports=function e(t,r,a){if(t==null)throw Error("First argument should be a string");if(r==null)throw Error("Separator should be a string or a RegExp");if(!a)a={};else if(typeof a==="string"||Array.isArray(a)){a={ignore:a}}if(a.escape==null)a.escape=true;if(a.ignore==null)a.ignore=["[]","()","{}","<>",'""',"''","``","“”","«»"];else{if(typeof a.ignore==="string"){a.ignore=[a.ignore]}a.ignore=a.ignore.map(function(e){if(e.length===1)e=e+e;return e})}var i=n.parse(t,{flat:true,brackets:a.ignore});var o=i[0];var s=o.split(r);if(a.escape){var l=[];for(var u=0;u<s.length;u++){var c=s[u];var f=s[u+1];if(c[c.length-1]==="\\"&&c[c.length-2]!=="\\"){l.push(c+r+f);u++}else{l.push(c)}}s=l}for(var u=0;u<s.length;u++){i[0]=s[u];s[u]=n.stringify(i,{flat:true})}return s}},{parenthesis:503}],569:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=e.length;var r=new Array(t);var n=new Array(t);var a=new Array(t);var i=new Array(t);var o=new Array(t);var s=new Array(t);for(var l=0;l<t;++l){r[l]=-1;n[l]=0;a[l]=false;i[l]=0;o[l]=-1;s[l]=[]}var u=0;var c=[];var f=[];function h(t){var l=[t],h=[t];r[t]=n[t]=u;a[t]=true;u+=1;while(h.length>0){t=h[h.length-1];var p=e[t];if(i[t]<p.length){for(var d=i[t];d<p.length;++d){var v=p[d];if(r[v]<0){r[v]=n[v]=u;a[v]=true;u+=1;l.push(v);h.push(v);break}else if(a[v]){n[t]=Math.min(n[t],n[v])|0}if(o[v]>=0){s[t].push(o[v])}}i[t]=d}else{if(n[t]===r[t]){var m=[];var g=[],y=0;for(var d=l.length-1;d>=0;--d){var x=l[d];a[x]=false;m.push(x);g.push(s[x]);y+=s[x].length;o[x]=c.length;if(x===t){l.length=d;break}}c.push(m);var _=new Array(y);for(var d=0;d<g.length;d++){for(var b=0;b<g[d].length;b++){_[--y]=g[d][b]}}f.push(_)}h.pop()}}}for(var l=0;l<t;++l){if(r[l]<0){h(l)}}var p;for(var l=0;l<f.length;l++){var d=f[l];if(d.length===0)continue;d.sort(function(e,t){return e-t});p=[d[0]];for(var v=1;v<d.length;v++){if(d[v]!==d[v-1]){p.push(d[v])}}f[l]=p}return{components:c,adjacencyList:f}}},{}],570:[function(e,t,r){"use strict";t.exports=u;var n=e("ndarray-extract-contour");var a=e("triangulate-hypercube");var i=e("zero-crossings");function o(e,t){var r=e.length;var i=["'use strict';"];var o="surfaceNets"+e.join("_")+"d"+t;i.push("var contour=genContour({","order:[",e.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");if(t==="generic"){i.push("getters:[0],")}var s=[];var l=[];for(var u=0;u<r;++u){s.push("d"+u);l.push("d"+u)}for(var u=0;u<1<<r;++u){s.push("v"+u);l.push("v"+u)}for(var u=0;u<1<<r;++u){s.push("p"+u);l.push("p"+u)}s.push("a","b","c");l.push("a","c");i.push("vertex:function vertexFunc(",s.join(),"){");var c=[];for(var u=0;u<1<<r;++u){c.push("(p"+u+"<<"+u+")")}i.push("var m=(",c.join("+"),")|0;if(m===0||m===",(1<<(1<<r))-1,"){return}");var f=[];var h=[];if(1<<(1<<r)<=128){i.push("switch(m){");h=i}else{i.push("switch(m>>>7){")}for(var u=0;u<1<<(1<<r);++u){if(1<<(1<<r)>128){if(u%128===0){if(f.length>0){h.push("}}")}var p="vExtra"+f.length;i.push("case ",u>>>7,":",p,"(m&0x7f,",l.join(),");break;");h=["function ",p,"(m,",l.join(),"){switch(m){"];f.push(h)}}h.push("case ",u&127,":");var d=new Array(r);var v=new Array(r);var m=new Array(r);var g=new Array(r);var y=0;for(var x=0;x<r;++x){d[x]=[];v[x]=[];m[x]=0;g[x]=0}for(var x=0;x<1<<r;++x){for(var _=0;_<r;++_){var b=x^1<<_;if(b>x){continue}if(!(u&1<<b)!==!(u&1<<x)){var w=1;if(u&1<<b){v[_].push("v"+b+"-v"+x)}else{v[_].push("v"+x+"-v"+b);w=-w}if(w<0){d[_].push("-v"+x+"-v"+b);m[_]+=2}else{d[_].push("v"+x+"+v"+b);m[_]-=2}y+=1;for(var T=0;T<r;++T){if(T===_){continue}if(b&1<<T){g[T]+=1}else{g[T]-=1}}}}}var k=[];for(var _=0;_<r;++_){if(d[_].length===0){k.push("d"+_+"-0.5")}else{var A="";if(m[_]<0){A=m[_]+"*c"}else if(m[_]>0){A="+"+m[_]+"*c"}var M=.5*(d[_].length/y);var E=.5+.5*(g[_]/y);k.push("d"+_+"-"+E+"-"+M+"*("+d[_].join("+")+A+")/("+v[_].join("+")+")")}}h.push("a.push([",k.join(),"]);","break;")}i.push("}},");if(f.length>0){h.push("}}")}var S=[];for(var u=0;u<1<<r-1;++u){S.push("v"+u)}S.push("c0","c1","p0","p1","a","b","c");i.push("cell:function cellFunc(",S.join(),"){");var C=a(r-1);i.push("if(p0){b.push(",C.map(function(e){return"["+e.map(function(e){return"v"+e})+"]"}).join(),")}else{b.push(",C.map(function(e){var t=e.slice();t.reverse();return"["+t.map(function(e){return"v"+e})+"]"}).join(),")}}});function ",o,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",o,";");for(var u=0;u<f.length;++u){i.push(f[u].join(""))}var L=new Function("genContour",i.join(""));return L(n)}function s(e,t){var r=i(e,t);var n=r.length;var a=new Array(n);var o=new Array(n);for(var s=0;s<n;++s){a[s]=[r[s]];o[s]=[s]}return{positions:a,cells:o}}var l={};function u(e,t){if(e.dimension<=0){return{positions:[],cells:[]}}else if(e.dimension===1){return s(e,t)}var r=e.order.join()+"-"+e.dtype;var n=l[r];var t=+t||0;if(!n){n=l[r]=o(e.order,e.dtype)}return n(e,t)}},{"ndarray-extract-contour":487,"triangulate-hypercube":580,"zero-crossings":624}],571:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function e(e,t){var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"])o["return"]()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var a=Math.PI*2;var i=function e(t,r,n,a,i,o,s){var l=t.x,u=t.y;l*=r;u*=n;var c=a*l-i*u;var f=i*l+a*u;return{x:c+o,y:f+s}};var o=function e(t,r){var n=r===1.5707963267948966?.551915024494:r===-1.5707963267948966?-.551915024494:4/3*Math.tan(r/4);var a=Math.cos(t);var i=Math.sin(t);var o=Math.cos(t+r);var s=Math.sin(t+r);return[{x:a-i*n,y:i+a*n},{x:o+s*n,y:s-o*n},{x:o,y:s}]};var s=function e(t,r,n,a){var i=t*a-r*n<0?-1:1;var o=t*n+r*a;if(o>1){o=1}if(o<-1){o=-1}return i*Math.acos(o)};var l=function e(t,r,n,i,o,l,u,c,f,h,p,d){var v=Math.pow(o,2);var m=Math.pow(l,2);var g=Math.pow(p,2);var y=Math.pow(d,2);var x=v*m-v*y-m*g;if(x<0){x=0}x/=v*y+m*g;x=Math.sqrt(x)*(u===c?-1:1);var _=x*o/l*d;var b=x*-l/o*p;var w=h*_-f*b+(t+n)/2;var T=f*_+h*b+(r+i)/2;var k=(p-_)/o;var A=(d-b)/l;var M=(-p-_)/o;var E=(-d-b)/l;var S=s(1,0,k,A);var C=s(k,A,M,E);if(c===0&&C>0){C-=a}if(c===1&&C<0){C+=a}return[w,T,S,C]};var u=function e(t){var r=t.px,s=t.py,u=t.cx,c=t.cy,f=t.rx,h=t.ry,p=t.xAxisRotation,d=p===undefined?0:p,v=t.largeArcFlag,m=v===undefined?0:v,g=t.sweepFlag,y=g===undefined?0:g;var x=[];if(f===0||h===0){return[]}var _=Math.sin(d*a/360);var b=Math.cos(d*a/360);var w=b*(r-u)/2+_*(s-c)/2;var T=-_*(r-u)/2+b*(s-c)/2;if(w===0&&T===0){return[]}f=Math.abs(f);h=Math.abs(h);var k=Math.pow(w,2)/Math.pow(f,2)+Math.pow(T,2)/Math.pow(h,2);if(k>1){f*=Math.sqrt(k);h*=Math.sqrt(k)}var A=l(r,s,u,c,f,h,m,y,_,b,w,T),M=n(A,4),E=M[0],S=M[1],C=M[2],L=M[3];var I=Math.abs(L)/(a/4);if(Math.abs(1-I)<1e-7){I=1}var O=Math.max(Math.ceil(I),1);L/=O;for(var P=0;P<O;P++){x.push(o(C,L));C+=L}return x.map(function(e){var t=i(e[0],f,h,b,_,E,S),r=t.x,n=t.y;var a=i(e[1],f,h,b,_,E,S),o=a.x,s=a.y;var l=i(e[2],f,h,b,_,E,S),u=l.x,c=l.y;return{x1:r,y1:n,x2:o,y2:s,x:u,y:c}})};r.default=u;t.exports=r.default},{}],572:[function(e,t,r){"use strict";var n=e("parse-svg-path");var a=e("abs-svg-path");var i=e("normalize-svg-path");var o=e("is-svg-path");var s=e("assert");t.exports=l;function l(e){if(Array.isArray(e)&&e.length===1&&typeof e[0]==="string")e=e[0];if(typeof e==="string"){s(o(e),"String is not an SVG path.");e=n(e)}s(Array.isArray(e),"Argument should be a string or an array of path segments.");e=a(e);e=i(e);if(!e.length)return[0,0,0,0];var t=[Infinity,Infinity,-Infinity,-Infinity];for(var r=0,l=e.length;r<l;r++){var u=e[r].slice(1);for(var c=0;c<u.length;c+=2){if(u[c+0]<t[0])t[0]=u[c+0];if(u[c+1]<t[1])t[1]=u[c+1];if(u[c+0]>t[2])t[2]=u[c+0];if(u[c+1]>t[3])t[3]=u[c+1]}}return t}},{"abs-svg-path":65,assert:73,"is-svg-path":471,"normalize-svg-path":573,"parse-svg-path":505}],573:[function(e,t,r){"use strict";t.exports=a;var n=e("svg-arc-to-cubic-bezier");function a(e){var t;var r=[];var a=0;var s=0;var l=0;var u=0;var c=null;var f=null;var h=0;var p=0;for(var d=0,v=e.length;d<v;d++){var m=e[d];var g=m[0];switch(g){case"M":l=m[1];u=m[2];break;case"A":var y=n({px:h,py:p,cx:m[6],cy:m[7],rx:m[1],ry:m[2],xAxisRotation:m[3],largeArcFlag:m[4],sweepFlag:m[5]});if(!y.length)continue;for(var x=0,_;x<y.length;x++){_=y[x];m=["C",_.x1,_.y1,_.x2,_.y2,_.x,_.y];if(x<y.length-1)r.push(m)}break;case"S":var b=h;var w=p;if(t=="C"||t=="S"){b+=b-a;w+=w-s}m=["C",b,w,m[1],m[2],m[3],m[4]];break;case"T":if(t=="Q"||t=="T"){c=h*2-c;f=p*2-f}else{c=h;f=p}m=o(h,p,c,f,m[1],m[2]);break;case"Q":c=m[1];f=m[2];m=o(h,p,m[1],m[2],m[3],m[4]);break;case"L":m=i(h,p,m[1],m[2]);break;case"H":m=i(h,p,m[1],p);break;case"V":m=i(h,p,h,m[1]);break;case"Z":m=i(h,p,l,u);break}t=g;h=m[m.length-2];p=m[m.length-1];if(m.length>4){a=m[m.length-4];s=m[m.length-3]}else{a=h;s=p}r.push(m)}return r}function i(e,t,r,n){return["C",e,t,r,n,r,n]}function o(e,t,r,n,a,i){return["C",e/3+2/3*r,t/3+2/3*n,a/3+2/3*r,i/3+2/3*n,a,i]}},{"svg-arc-to-cubic-bezier":571}],574:[function(e,t,r){"use strict";var n=e("svg-path-bounds");var a=e("parse-svg-path");var i=e("draw-svg-path");var o=e("is-svg-path");var s=e("bitmap-sdf");var l=document.createElement("canvas");var u=l.getContext("2d");t.exports=c;function c(e,t){if(!o(e))throw Error("Argument should be valid svg path string");if(!t)t={};var r,c;if(t.shape){r=t.shape[0];c=t.shape[1]}else{r=l.width=t.w||t.width||200;c=l.height=t.h||t.height||200}var f=Math.min(r,c);var p=t.stroke||0;var d=t.viewbox||t.viewBox||n(e);var v=[r/(d[2]-d[0]),c/(d[3]-d[1])];var m=Math.min(v[0]||0,v[1]||0)/2;u.fillStyle="black";u.fillRect(0,0,r,c);u.fillStyle="white";if(p){if(typeof p!="number")p=1;if(p>0){u.strokeStyle="white"}else{u.strokeStyle="black"}u.lineWidth=Math.abs(p)}u.translate(r*.5,c*.5);u.scale(m,m);if(h()){var g=new Path2D(e);u.fill(g);p&&u.stroke(g)}else{var y=a(e);i(u,y);u.fill();p&&u.stroke()}u.setTransform(1,0,0,1,0,0);var x=s(u,{cutoff:t.cutoff!=null?t.cutoff:.5,radius:t.radius!=null?t.radius:f*.5});return x}var f;function h(){if(f!=null)return f;var e=document.createElement("canvas").getContext("2d");e.canvas.width=e.canvas.height=1;if(!window.Path2D)return f=false;var t=new Path2D("M0,0h1v1h-1v-1Z");e.fillStyle="black";e.fill(t);var r=e.getImageData(0,0,1,1);return f=r&&r.data&&r.data[3]===255}},{"bitmap-sdf":98,"draw-svg-path":174,"is-svg-path":471,"parse-svg-path":505,"svg-path-bounds":572}],575:[function(e,t,r){(function(r){(function(){"use strict";t.exports=s;var n=e("vectorize-text");var a=window||r.global||{};var i=a.__TEXT_CACHE||{};a.__TEXT_CACHE={};function o(e){var t=e.cells;var r=e.positions;var n=new Float32Array(t.length*6);var a=0;var i=0;for(var o=0;o<t.length;++o){var s=t[o];for(var l=0;l<3;++l){var u=r[s[l]];n[a++]=u[0];n[a++]=u[1]+1.4;i=Math.max(u[0],i)}}return{data:n,shape:i}}function s(e,t,r){var r=r||{};var a=i[e];if(!a){a=i[e]={" ":{data:new Float32Array(0),shape:.2}}}var l=a[t];if(!l){if(t.length<=1||!/\d/.test(t)){l=a[t]=o(n(t,{triangles:true,font:e,textAlign:r.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:true,bolds:true,italics:true,subscripts:true,superscripts:true}}))}else{var u=t.split(/(\d|\s)/);var c=new Array(u.length);var f=0;var h=0;for(var p=0;p<u.length;++p){c[p]=s(e,u[p]);f+=c[p].data.length;h+=c[p].shape;if(p>0){h+=.02}}var d=new Float32Array(f);var v=0;var m=-.5*h;for(var p=0;p<c.length;++p){var g=c[p].data;for(var y=0;y<g.length;y+=2){d[v++]=g[y]+m;d[v++]=g[y+1]}m+=c[p].shape+.02}l=a[t]={data:d,shape:h}}}return l}}).call(this)}).call(this,e("_process"))},{_process:526,"vectorize-text":600}],576:[function(t,r,n){(function(t){var n=/^\s+/,a=/\s+$/,i=0,o=t.round,s=t.min,l=t.max,u=t.random;function c(e,t){e=e?e:"";t=t||{};if(e instanceof c){return e}if(!(this instanceof c)){return new c(e,t)}var r=f(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=o(100*this._a)/100,this._format=t.format||r.format;this._gradientType=t.gradientType;if(this._r<1){this._r=o(this._r)}if(this._g<1){this._g=o(this._g)}if(this._b<1){this._b=o(this._b)}this._ok=r.ok;this._tc_id=i++}c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb();var r,n,a,i,o,s;r=e.r/255;n=e.g/255;a=e.b/255;if(r<=.03928){i=r/12.92}else{i=t.pow((r+.055)/1.055,2.4)}if(n<=.03928){o=n/12.92}else{o=t.pow((n+.055)/1.055,2.4)}if(a<=.03928){s=a/12.92}else{s=t.pow((a+.055)/1.055,2.4)}return.2126*i+.7152*o+.0722*s},setAlpha:function(e){this._a=z(e);this._roundA=o(100*this._a)/100;return this},toHsv:function(){var e=v(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=v(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),n=o(e.v*100);return this._a==1?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=p(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=p(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),n=o(e.l*100);return this._a==1?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return g(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return y(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(N(this._r,255)*100)+"%",g:o(N(this._g,255)*100)+"%",b:o(N(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(N(this._r,255)*100)+"%, "+o(N(this._g,255)*100)+"%, "+o(N(this._b,255)*100)+"%)":"rgba("+o(N(this._r,255)*100)+"%, "+o(N(this._g,255)*100)+"%, "+o(N(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return D[g(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+x(this._r,this._g,this._b,this._a);var r=t;var n=this._gradientType?"GradientType = 1, ":"";if(e){var a=c(e);r="#"+x(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=false;var n=this._a<1&&this._a>=0;var a=!t&&n&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");if(a){if(e==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(e==="rgb"){r=this.toRgbString()}if(e==="prgb"){r=this.toPercentageRgbString()}if(e==="hex"||e==="hex6"){r=this.toHexString()}if(e==="hex3"){r=this.toHexString(true)}if(e==="hex4"){r=this.toHex8String(true)}if(e==="hex8"){r=this.toHex8String()}if(e==="name"){r=this.toName()}if(e==="hsl"){r=this.toHslString()}if(e==="hsv"){r=this.toHsvString()}return r||this.toHexString()},clone:function(){return c(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));this._r=r._r;this._g=r._g;this._b=r._b;this.setAlpha(r._a);return this},lighten:function(){return this._applyModification(T,arguments)},brighten:function(){return this._applyModification(k,arguments)},darken:function(){return this._applyModification(A,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(b,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(M,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(E,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(L,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(C,arguments)}};c.fromRatio=function(e,t){if(typeof e=="object"){var r={};for(var n in e){if(e.hasOwnProperty(n)){if(n==="a"){r[n]=e[n]}else{r[n]=V(e[n])}}}e=r}return c(e,t)};function f(e){var t={r:0,g:0,b:0};var r=1;var n=null;var a=null;var i=null;var o=false;var u=false;if(typeof e=="string"){e=X(e)}if(typeof e=="object"){if(W(e.r)&&W(e.g)&&W(e.b)){t=h(e.r,e.g,e.b);o=true;u=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if(W(e.h)&&W(e.s)&&W(e.v)){n=V(e.s);a=V(e.v);t=m(e.h,n,a);o=true;u="hsv"}else if(W(e.h)&&W(e.s)&&W(e.l)){n=V(e.s);i=V(e.l);t=d(e.h,n,i);o=true;u="hsl"}if(e.hasOwnProperty("a")){r=e.a}}r=z(r);return{ok:o,format:e.format||u,r:s(255,l(t.r,0)),g:s(255,l(t.g,0)),b:s(255,l(t.b,0)),a:r}}function h(e,t,r){return{r:N(e,255)*255,g:N(t,255)*255,b:N(r,255)*255}}function p(e,t,r){e=N(e,255);t=N(t,255);r=N(r,255);var n=l(e,t,r),a=s(e,t,r);var i,o,u=(n+a)/2;if(n==a){i=o=0}else{var c=n-a;o=u>.5?c/(2-n-a):c/(n+a);switch(n){case e:i=(t-r)/c+(t<r?6:0);break;case t:i=(r-e)/c+2;break;case r:i=(e-t)/c+4;break}i/=6}return{h:i,s:o,l:u}}function d(e,t,r){var n,a,i;e=N(e,360);t=N(t,100);r=N(r,100);function o(e,t,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*(2/3-r)*6;return e}if(t===0){n=a=i=r}else{var s=r<.5?r*(1+t):r+t-r*t;var l=2*r-s;n=o(l,s,e+1/3);a=o(l,s,e);i=o(l,s,e-1/3)}return{r:n*255,g:a*255,b:i*255}}function v(e,t,r){e=N(e,255);t=N(t,255);r=N(r,255);var n=l(e,t,r),a=s(e,t,r);var i,o,u=n;var c=n-a;o=n===0?0:c/n;if(n==a){i=0}else{switch(n){case e:i=(t-r)/c+(t<r?6:0);break;case t:i=(r-e)/c+2;break;case r:i=(e-t)/c+4;break}i/=6}return{h:i,s:o,v:u}}function m(e,r,n){e=N(e,360)*6;r=N(r,100);n=N(n,100);var a=t.floor(e),i=e-a,o=n*(1-r),s=n*(1-i*r),l=n*(1-(1-i)*r),u=a%6,c=[n,s,o,o,l,n][u],f=[l,n,n,s,o,o][u],h=[o,o,l,n,n,s][u];return{r:c*255,g:f*255,b:h*255}}function g(e,t,r,n){var a=[H(o(e).toString(16)),H(o(t).toString(16)),H(o(r).toString(16))];if(n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)){return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)}return a.join("")}function y(e,t,r,n,a){var i=[H(o(e).toString(16)),H(o(t).toString(16)),H(o(r).toString(16)),H(G(n))];if(a&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)){return i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0)}return i.join("")}function x(e,t,r,n){var a=[H(G(n)),H(o(e).toString(16)),H(o(t).toString(16)),H(o(r).toString(16))];return a.join("")}c.equals=function(e,t){if(!e||!t){return false}return c(e).toRgbString()==c(t).toRgbString()};c.random=function(){return c.fromRatio({r:u(),g:u(),b:u()})};function _(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.s-=t/100;r.s=F(r.s);return c(r)}function b(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.s+=t/100;r.s=F(r.s);return c(r)}function w(e){return c(e).desaturate(100)}function T(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.l+=t/100;r.l=F(r.l);return c(r)}function k(e,t){t=t===0?0:t||10;var r=c(e).toRgb();r.r=l(0,s(255,r.r-o(255*-(t/100))));r.g=l(0,s(255,r.g-o(255*-(t/100))));r.b=l(0,s(255,r.b-o(255*-(t/100))));return c(r)}function A(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.l-=t/100;r.l=F(r.l);return c(r)}function M(e,t){var r=c(e).toHsl();var n=(r.h+t)%360;r.h=n<0?360+n:n;return c(r)}function E(e){var t=c(e).toHsl();t.h=(t.h+180)%360;return c(t)}function S(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+120)%360,s:t.s,l:t.l}),c({h:(r+240)%360,s:t.s,l:t.l})]}function C(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+90)%360,s:t.s,l:t.l}),c({h:(r+180)%360,s:t.s,l:t.l}),c({h:(r+270)%360,s:t.s,l:t.l})]}function L(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+72)%360,s:t.s,l:t.l}),c({h:(r+216)%360,s:t.s,l:t.l})]}function I(e,t,r){t=t||6;r=r||30;var n=c(e).toHsl();var a=360/r;var i=[c(e)];for(n.h=(n.h-(a*t>>1)+720)%360;--t;){n.h=(n.h+a)%360;i.push(c(n))}return i}function O(e,t){t=t||6;var r=c(e).toHsv();var n=r.h,a=r.s,i=r.v;var o=[];var s=1/t;while(t--){o.push(c({h:n,s:a,v:i}));i=(i+s)%1}return o}c.mix=function(e,t,r){r=r===0?0:r||50;var n=c(e).toRgb();var a=c(t).toRgb();var i=r/100;var o={r:(a.r-n.r)*i+n.r,g:(a.g-n.g)*i+n.g,b:(a.b-n.b)*i+n.b,a:(a.a-n.a)*i+n.a};return c(o)};c.readability=function(e,r){var n=c(e);var a=c(r);return(t.max(n.getLuminance(),a.getLuminance())+.05)/(t.min(n.getLuminance(),a.getLuminance())+.05)};c.isReadable=function(e,t,r){var n=c.readability(e,t);var a,i;i=false;a=Z(r);switch(a.level+a.size){case"AAsmall":case"AAAlarge":i=n>=4.5;break;case"AAlarge":i=n>=3;break;case"AAAsmall":i=n>=7;break}return i};c.mostReadable=function(e,t,r){var n=null;var a=0;var i;var o,s,l;r=r||{};o=r.includeFallbackColors;s=r.level;l=r.size;for(var u=0;u<t.length;u++){i=c.readability(e,t[u]);if(i>a){a=i;n=c(t[u])}}if(c.isReadable(e,n,{level:s,size:l})||!o){return n}else{r.includeFallbackColors=false;return c.mostReadable(e,["#fff","#000"],r)}};var P=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var D=c.hexNames=R(P);function R(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[e[r]]=r}}return t}function z(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function N(e,r){if(j(e)){e="100%"}var n=U(e);e=s(r,l(0,parseFloat(e)));if(n){e=parseInt(e*r,10)/100}if(t.abs(e-r)<1e-6){return 1}return e%r/parseFloat(r)}function F(e){return s(1,l(0,e))}function B(e){return parseInt(e,16)}function j(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function U(e){return typeof e==="string"&&e.indexOf("%")!=-1}function H(e){return e.length==1?"0"+e:""+e}function V(e){if(e<=1){e=e*100+"%"}return e}function G(e){return t.round(parseFloat(e)*255).toString(16)}function q(e){return B(e)/255}var Y=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var r="(?:"+t+")|(?:"+e+")";var n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";var a="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function W(e){return!!Y.CSS_UNIT.exec(e)}function X(e){e=e.replace(n,"").replace(a,"").toLowerCase();var t=false;if(P[e]){e=P[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var r;if(r=Y.rgb.exec(e)){return{r:r[1],g:r[2],b:r[3]}}if(r=Y.rgba.exec(e)){return{r:r[1],g:r[2],b:r[3],a:r[4]}}if(r=Y.hsl.exec(e)){return{h:r[1],s:r[2],l:r[3]}}if(r=Y.hsla.exec(e)){return{h:r[1],s:r[2],l:r[3],a:r[4]}}if(r=Y.hsv.exec(e)){return{h:r[1],s:r[2],v:r[3]}}if(r=Y.hsva.exec(e)){return{h:r[1],s:r[2],v:r[3],a:r[4]}}if(r=Y.hex8.exec(e)){return{r:B(r[1]),g:B(r[2]),b:B(r[3]),a:q(r[4]),format:t?"name":"hex8"}}if(r=Y.hex6.exec(e)){return{r:B(r[1]),g:B(r[2]),b:B(r[3]),format:t?"name":"hex"}}if(r=Y.hex4.exec(e)){return{r:B(r[1]+""+r[1]),g:B(r[2]+""+r[2]),b:B(r[3]+""+r[3]),a:q(r[4]+""+r[4]),format:t?"name":"hex8"}}if(r=Y.hex3.exec(e)){return{r:B(r[1]+""+r[1]),g:B(r[2]+""+r[2]),b:B(r[3]+""+r[3]),format:t?"name":"hex"}}return false}function Z(e){var t,r;e=e||{level:"AA",size:"small"};t=(e.level||"AA").toUpperCase();r=(e.size||"small").toLowerCase();if(t!=="AA"&&t!=="AAA"){t="AA"}if(r!=="small"&&r!=="large"){r="small"}return{level:t,size:r}}if(typeof r!=="undefined"&&r.exports){r.exports=c}else if(typeof e==="function"&&e.amd){e(function(){return c})}else{window.tinycolor=c}})(Math)},{}],577:[function(e,t,r){"use strict";t.exports=i;t.exports.float32=t.exports.float=i;t.exports.fract32=t.exports.fract=a;var n=new Float32Array(1);function a(e){if(e.length){var t=i(e);for(var r=0,n=t.length;r<n;r++){t[r]=e[r]-t[r]}return t}return i(e-i(e))}function i(e){if(e.length){if(e instanceof Float32Array)return e;var t=new Float32Array(e);t.set(e);return t}n[0]=e;return n[0]}},{}],578:[function(e,t,r){"use strict";var n=e("parse-unit");t.exports=s;var a=96;function i(e,t){var r=n(getComputedStyle(e).getPropertyValue(t));return r[0]*s(r[1],e)}function o(e,t){var r=document.createElement("div");r.style["font-size"]="128"+e;t.appendChild(r);var n=i(r,"font-size")/128;t.removeChild(r);return n}function s(e,t){t=t||document.body;e=(e||"px").trim().toLowerCase();if(t===window||t===document){t=document.body}switch(e){case"%":return t.clientHeight/100;case"ch":case"ex":return o(e,t);case"em":return i(t,"font-size");case"rem":return i(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6}return 1}},{"parse-unit":506}],579:[function(t,r,n){(function(t,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof e==="function"&&e.amd?e(["exports"],a):(t=t||self,a(t.topojson=t.topojson||{}))})(this,function(e){"use strict";function t(e){return e}function r(e){if(e==null)return t;var r,n,a=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,t){if(!t)r=n=0;var l=2,u=e.length,c=new Array(u);c[0]=(r+=e[0])*a+o;c[1]=(n+=e[1])*i+s;while(l<u)c[l]=e[l],++l;return c}}function n(e){var t=r(e.transform),n,a=Infinity,i=a,o=-a,s=-a;function l(e){e=t(e);if(e[0]<a)a=e[0];if(e[0]>o)o=e[0];if(e[1]<i)i=e[1];if(e[1]>s)s=e[1]}function u(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(u);break;case"Point":l(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(l);break}}e.arcs.forEach(function(e){var r=-1,n=e.length,l;while(++r<n){l=t(e[r],r);if(l[0]<a)a=l[0];if(l[0]>o)o=l[0];if(l[1]<i)i=l[1];if(l[1]>s)s=l[1]}});for(n in e.objects){u(e.objects[n])}return[a,i,o,s]}function a(e,t){var r,n=e.length,a=n-t;while(a<--n)r=e[a],e[a++]=e[n],e[n]=r}function i(e,t){if(typeof t==="string")t=e.objects[t];return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(e,t)})}:o(e,t)}function o(e,t){var r=t.id,n=t.bbox,a=t.properties==null?{}:t.properties,i=s(e,t);return r==null&&n==null?{type:"Feature",properties:a,geometry:i}:n==null?{type:"Feature",id:r,properties:a,geometry:i}:{type:"Feature",id:r,bbox:n,properties:a,geometry:i}}function s(e,t){var n=r(e.transform),i=e.arcs;function o(e,t){if(t.length)t.pop();for(var r=i[e<0?~e:e],o=0,s=r.length;o<s;++o){t.push(n(r[o],o))}if(e<0)a(t,s)}function s(e){return n(e)}function l(e){var t=[];for(var r=0,n=e.length;r<n;++r)o(e[r],t);if(t.length<2)t.push(t[0]);return t}function u(e){var t=l(e);while(t.length<4)t.push(t[0]);return t}function c(e){return e.map(u)}function f(e){var t=e.type,r;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(f)};case"Point":r=s(e.coordinates);break;case"MultiPoint":r=e.coordinates.map(s);break;case"LineString":r=l(e.arcs);break;case"MultiLineString":r=e.arcs.map(l);break;case"Polygon":r=c(e.arcs);break;case"MultiPolygon":r=e.arcs.map(c);break;default:return null}return{type:t,coordinates:r}}return f(t)}function l(e,t){var r={},n={},a={},i=[],o=-1;t.forEach(function(r,n){var a=e.arcs[r<0?~r:r],i;if(a.length<3&&!a[1][0]&&!a[1][1]){i=t[++o],t[o]=r,t[n]=i}});t.forEach(function(e){var t=s(e),r=t[0],i=t[1],o,l;if(o=a[r]){delete a[o.end];o.push(e);o.end=i;if(l=n[i]){delete n[l.start];var u=l===o?o:o.concat(l);n[u.start=o.start]=a[u.end=l.end]=u}else{n[o.start]=a[o.end]=o}}else if(o=n[i]){delete n[o.start];o.unshift(e);o.start=r;if(l=a[r]){delete a[l.end];var c=l===o?o:l.concat(o);n[c.start=l.start]=a[c.end=o.end]=c}else{n[o.start]=a[o.end]=o}}else{o=[e];n[o.start=r]=a[o.end=i]=o}});function s(t){var r=e.arcs[t<0?~t:t],n=r[0],a;if(e.transform)a=[0,0],r.forEach(function(e){a[0]+=e[0],a[1]+=e[1]});else a=r[r.length-1];return t<0?[a,n]:[n,a]}function l(e,t){for(var n in e){var a=e[n];delete t[a.start];delete a.start;delete a.end;a.forEach(function(e){r[e<0?~e:e]=1});i.push(a)}}l(a,n);l(n,a);t.forEach(function(e){if(!r[e<0?~e:e])i.push([e])});return i}function u(e){return s(e,c.apply(this,arguments))}function c(e,t,r){var n,a,i;if(arguments.length>1)n=f(e,t,r);else for(a=0,n=new Array(i=e.arcs.length);a<i;++a)n[a]=a;return{type:"MultiLineString",arcs:l(e,n)}}function f(e,t,r){var n=[],a=[],i;function o(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:i})}function s(e){e.forEach(o)}function l(e){e.forEach(s)}function u(e){e.forEach(l)}function c(e){switch(i=e,e.type){case"GeometryCollection":e.geometries.forEach(c);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":u(e.arcs);break}}c(t);a.forEach(r==null?function(e){n.push(e[0].i)}:function(e){if(r(e[0].g,e[e.length-1].g))n.push(e[0].i)});return n}function h(e){var t=-1,r=e.length,n,a=e[r-1],i=0;while(++t<r)n=a,a=e[t],i+=n[0]*a[1]-n[1]*a[0];return Math.abs(i)}function p(e){return s(e,d.apply(this,arguments))}function d(e,t){var r={},n=[],a=[];t.forEach(i);function i(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(i);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o);break}}function o(e){e.forEach(function(t){t.forEach(function(t){(r[t=t<0?~t:t]||(r[t]=[])).push(e)})});n.push(e)}function u(t){return h(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])}n.forEach(function(e){if(!e._){var t=[],n=[e];e._=1;a.push(t);while(e=n.pop()){t.push(e);e.forEach(function(e){e.forEach(function(e){r[e<0?~e:e].forEach(function(e){if(!e._){e._=1;n.push(e)}})})})}}});n.forEach(function(e){delete e._});return{type:"MultiPolygon",arcs:a.map(function(t){var n=[],a;t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){if(r[e<0?~e:e].length<2){n.push(e)}})})});n=l(e,n);if((a=n.length)>1){for(var i=1,o=u(n[0]),s,c;i<a;++i){if((s=u(n[i]))>o){c=n[0],n[0]=n[i],n[i]=c,o=s}}}return n}).filter(function(e){return e.length>0})}}function v(e,t){var r=0,n=e.length;while(r<n){var a=r+n>>>1;if(e[a]<t)r=a+1;else n=a}return r}function m(e){var t={},r=e.map(function(){return[]});function n(e,r){e.forEach(function(e){if(e<0)e=~e;var n=t[e];if(n)n.push(r);else t[e]=[r]})}function a(e,t){e.forEach(function(e){n(e,t)})}function i(e,t){if(e.type==="GeometryCollection")e.geometries.forEach(function(e){i(e,t)});else if(e.type in o)o[e.type](e.arcs,t)}var o={LineString:n,MultiLineString:a,Polygon:a,MultiPolygon:function(e,t){e.forEach(function(e){a(e,t)})}};e.forEach(i);for(var s in t){for(var l=t[s],u=l.length,c=0;c<u;++c){for(var f=c+1;f<u;++f){var h=l[c],p=l[f],d;if((d=r[h])[s=v(d,p)]!==p)d.splice(s,0,p);if((d=r[p])[s=v(d,h)]!==h)d.splice(s,0,h)}}}return r}function g(e){if(e==null)return t;var r,n,a=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,t){if(!t)r=n=0;var l=2,u=e.length,c=new Array(u),f=Math.round((e[0]-o)/a),h=Math.round((e[1]-s)/i);c[0]=f-r,r=f;c[1]=h-n,n=h;while(l<u)c[l]=e[l],++l;return c}}function y(e,t){if(e.transform)throw new Error("already quantized");if(!t||!t.scale){if(!((s=Math.floor(t))>=2))throw new Error("n must be ≥2");u=e.bbox||n(e);var r=u[0],a=u[1],i=u[2],o=u[3],s;t={scale:[i-r?(i-r)/(s-1):1,o-a?(o-a)/(s-1):1],translate:[r,a]}}else{u=e.bbox}var l=g(t),u,c,f=e.objects,h={};function p(e){return l(e)}function d(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(d)};break;case"Point":t={type:"Point",coordinates:p(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(p)};break;default:return e}if(e.id!=null)t.id=e.id;if(e.bbox!=null)t.bbox=e.bbox;if(e.properties!=null)t.properties=e.properties;return t}function v(e){var t=0,r=1,n=e.length,a,i=new Array(n);i[0]=l(e[0],0);while(++t<n)if((a=l(e[t],t))[0]||a[1])i[r++]=a;if(r===1)i[r++]=[0,0];i.length=r;return i}for(c in f)h[c]=d(f[c]);return{type:"Topology",bbox:u,transform:t,objects:h,arcs:e.arcs.map(v)}}e.bbox=n;e.feature=i;e.merge=p;e.mergeArcs=d;e.mesh=u;e.meshArcs=c;e.neighbors=m;e.quantize=y;e.transform=r;e.untransform=g;Object.defineProperty(e,"__esModule",{value:true})})},{}],580:[function(e,t,r){"use strict";t.exports=o;var n=e("permutation-rank");var a=e("permutation-parity");var i=e("gamma");function o(e){if(e<0){return[]}if(e===0){return[[0]]}var t=Math.round(i(e+1))|0;var r=[];for(var o=0;o<t;++o){var s=n.unrank(e,o);var l=[0];var u=0;for(var c=0;c<s.length;++c){u+=1<<s[c];l.push(u)}if(a(s)<1){l[0]=u;l[e]=0}r.push(l)}return r}},{gamma:248,"permutation-parity":509,"permutation-rank":510}],581:[function(e,t,r){"use strict";t.exports=v;var n=e("filtered-vector");var a=e("gl-mat4/invert");var i=e("gl-mat4/rotate");var o=e("gl-vec3/cross");var s=e("gl-vec3/normalize");var l=e("gl-vec3/dot");function u(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function c(e){return Math.min(1,Math.max(-1,e))}function f(e){var t=Math.abs(e[0]);var r=Math.abs(e[1]);var n=Math.abs(e[2]);var a=[0,0,0];if(t>Math.max(r,n)){a[2]=1}else if(r>Math.max(t,n)){a[0]=1}else{a[1]=1}var i=0;var o=0;for(var l=0;l<3;++l){i+=e[l]*e[l];o+=a[l]*e[l]}for(var l=0;l<3;++l){a[l]-=o/i*e[l]}s(a,a);return a}function h(e,t,r,a,i,o,s,l){this.center=n(r);this.up=n(a);this.right=n(i);this.radius=n([o]);this.angle=n([s,l]);this.angle.bounds=[[-Infinity,-Math.PI/2],[Infinity,Math.PI/2]];this.setDistanceLimits(e,t);this.computedCenter=this.center.curve(0);this.computedUp=this.up.curve(0);this.computedRight=this.right.curve(0);this.computedRadius=this.radius.curve(0);this.computedAngle=this.angle.curve(0);this.computedToward=[0,0,0];this.computedEye=[0,0,0];this.computedMatrix=new Array(16);for(var u=0;u<16;++u){this.computedMatrix[u]=.5}this.recalcMatrix(0)}var p=h.prototype;p.setDistanceLimits=function(e,t){if(e>0){e=Math.log(e)}else{e=-Infinity}if(t>0){t=Math.log(t)}else{t=Infinity}t=Math.max(t,e);this.radius.bounds[0][0]=e;this.radius.bounds[1][0]=t};p.getDistanceLimits=function(e){var t=this.radius.bounds[0];if(e){e[0]=Math.exp(t[0][0]);e[1]=Math.exp(t[1][0]);return e}return[Math.exp(t[0][0]),Math.exp(t[1][0])]};p.recalcMatrix=function(e){this.center.curve(e);this.up.curve(e);this.right.curve(e);this.radius.curve(e);this.angle.curve(e);var t=this.computedUp;var r=this.computedRight;var n=0;var a=0;for(var i=0;i<3;++i){a+=t[i]*r[i];n+=t[i]*t[i]}var l=Math.sqrt(n);var c=0;for(var i=0;i<3;++i){r[i]-=t[i]*a/n;c+=r[i]*r[i];t[i]/=l}var f=Math.sqrt(c);for(var i=0;i<3;++i){r[i]/=f}var h=this.computedToward;o(h,t,r);s(h,h);var p=Math.exp(this.computedRadius[0]);var d=this.computedAngle[0];var v=this.computedAngle[1];var m=Math.cos(d);var g=Math.sin(d);var y=Math.cos(v);var x=Math.sin(v);var _=this.computedCenter;var b=m*y;var w=g*y;var T=x;var k=-m*x;var A=-g*x;var M=y;var E=this.computedEye;var S=this.computedMatrix;for(var i=0;i<3;++i){var C=b*r[i]+w*h[i]+T*t[i];S[4*i+1]=k*r[i]+A*h[i]+M*t[i];S[4*i+2]=C;S[4*i+3]=0}var L=S[1];var I=S[5];var O=S[9];var P=S[2];var D=S[6];var R=S[10];var z=I*R-O*D;var N=O*P-L*R;var F=L*D-I*P;var B=u(z,N,F);z/=B;N/=B;F/=B;S[0]=z;S[4]=N;S[8]=F;for(var i=0;i<3;++i){E[i]=_[i]+S[2+4*i]*p}for(var i=0;i<3;++i){var c=0;for(var j=0;j<3;++j){c+=S[i+4*j]*E[j]}S[12+i]=-c}S[15]=1};p.getMatrix=function(e,t){this.recalcMatrix(e);var r=this.computedMatrix;if(t){for(var n=0;n<16;++n){t[n]=r[n]}return t}return r};var d=[0,0,0];p.rotate=function(e,t,r,n){this.angle.move(e,t,r);if(n){this.recalcMatrix(e);var a=this.computedMatrix;d[0]=a[2];d[1]=a[6];d[2]=a[10];var o=this.computedUp;var s=this.computedRight;var l=this.computedToward;for(var u=0;u<3;++u){a[4*u]=o[u];a[4*u+1]=s[u];a[4*u+2]=l[u]}i(a,a,n,d);for(var u=0;u<3;++u){o[u]=a[4*u];s[u]=a[4*u+1]}this.up.set(e,o[0],o[1],o[2]);this.right.set(e,s[0],s[1],s[2])}};p.pan=function(e,t,r,n){t=t||0;r=r||0;n=n||0;this.recalcMatrix(e);var a=this.computedMatrix;var i=Math.exp(this.computedRadius[0]);var o=a[1];var s=a[5];var l=a[9];var c=u(o,s,l);o/=c;s/=c;l/=c;var f=a[0];var h=a[4];var p=a[8];var d=f*o+h*s+p*l;f-=o*d;h-=s*d;p-=l*d;var v=u(f,h,p);f/=v;h/=v;p/=v;var m=f*t+o*r;var g=h*t+s*r;var y=p*t+l*r;this.center.move(e,m,g,y);var x=Math.exp(this.computedRadius[0]);x=Math.max(1e-4,x+n);this.radius.set(e,Math.log(x))};p.translate=function(e,t,r,n){this.center.move(e,t||0,r||0,n||0)};p.setMatrix=function(e,t,r,n){var i=1;if(typeof r==="number"){i=r|0}if(i<0||i>3){i=1}var o=(i+2)%3;var s=(i+1)%3;if(!t){this.recalcMatrix(e);t=this.computedMatrix}var l=t[i];var f=t[i+4];var h=t[i+8];if(!n){var p=u(l,f,h);l/=p;f/=p;h/=p}else{var d=Math.abs(l);var v=Math.abs(f);var m=Math.abs(h);var g=Math.max(d,v,m);if(d===g){l=l<0?-1:1;f=h=0}else if(m===g){h=h<0?-1:1;l=f=0}else{f=f<0?-1:1;l=h=0}}var y=t[o];var x=t[o+4];var _=t[o+8];var b=y*l+x*f+_*h;y-=l*b;x-=f*b;_-=h*b;var w=u(y,x,_);y/=w;x/=w;_/=w;var T=f*_-h*x;var k=h*y-l*_;var A=l*x-f*y;var M=u(T,k,A);T/=M;k/=M;A/=M;this.center.jump(e,q,Y,W);this.radius.idle(e);this.up.jump(e,l,f,h);this.right.jump(e,y,x,_);var E,S;if(i===2){var C=t[1];var L=t[5];var I=t[9];var O=C*y+L*x+I*_;var P=C*T+L*k+I*A;if(N<0){E=-Math.PI/2}else{E=Math.PI/2}S=Math.atan2(P,O)}else{var D=t[2];var R=t[6];var z=t[10];var N=D*l+R*f+z*h;var F=D*y+R*x+z*_;var B=D*T+R*k+z*A;E=Math.asin(c(N));S=Math.atan2(B,F)}this.angle.jump(e,S,E);this.recalcMatrix(e);var j=t[2];var U=t[6];var H=t[10];var V=this.computedMatrix;a(V,t);var G=V[15];var q=V[12]/G;var Y=V[13]/G;var W=V[14]/G;var X=Math.exp(this.computedRadius[0]);this.center.jump(e,q-j*X,Y-U*X,W-H*X)};p.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())};p.idle=function(e){this.center.idle(e);this.up.idle(e);this.right.idle(e);this.radius.idle(e);this.angle.idle(e)};p.flush=function(e){this.center.flush(e);this.up.flush(e);this.right.flush(e);this.radius.flush(e);this.angle.flush(e)};p.setDistance=function(e,t){if(t>0){this.radius.set(e,Math.log(t))}};p.lookAt=function(e,t,r,n){this.recalcMatrix(e);t=t||this.computedEye;r=r||this.computedCenter;n=n||this.computedUp;var a=n[0];var i=n[1];var o=n[2];var s=u(a,i,o);if(s<1e-6){return}a/=s;i/=s;o/=s;var l=t[0]-r[0];var f=t[1]-r[1];var h=t[2]-r[2];var p=u(l,f,h);if(p<1e-6){return}l/=p;f/=p;h/=p;var d=this.computedRight;var v=d[0];var m=d[1];var g=d[2];var y=a*v+i*m+o*g;v-=y*a;m-=y*i;g-=y*o;var x=u(v,m,g);if(x<.01){v=i*h-o*f;m=o*l-a*h;g=a*f-i*l;x=u(v,m,g);if(x<1e-6){return}}v/=x;m/=x;g/=x;this.up.set(e,a,i,o);this.right.set(e,v,m,g);this.center.set(e,r[0],r[1],r[2]);this.radius.set(e,Math.log(p));var _=i*g-o*m;var b=o*v-a*g;var w=a*m-i*v;var T=u(_,b,w);_/=T;b/=T;w/=T;var k=a*l+i*f+o*h;var A=v*l+m*f+g*h;var M=_*l+b*f+w*h;var E=Math.asin(c(k));var S=Math.atan2(M,A);var C=this.angle._state;var L=C[C.length-1];var I=C[C.length-2];L=L%(2*Math.PI);var O=Math.abs(L+2*Math.PI-S);var P=Math.abs(L-S);var D=Math.abs(L-2*Math.PI-S);if(O<P){L+=2*Math.PI}if(D<P){L-=2*Math.PI}this.angle.jump(this.angle.lastT(),L,I);this.angle.set(e,S,E)};function v(e){e=e||{};var t=e.center||[0,0,0];var r=e.up||[0,1,0];var n=e.right||f(r);var a=e.radius||1;var i=e.theta||0;var c=e.phi||0;t=[].slice.call(t,0,3);r=[].slice.call(r,0,3);s(r,r);n=[].slice.call(n,0,3);s(n,n);if("eye"in e){var p=e.eye;var d=[p[0]-t[0],p[1]-t[1],p[2]-t[2]];o(n,d,r);if(u(n[0],n[1],n[2])<1e-6){n=f(r)}else{s(n,n)}a=u(d[0],d[1],d[2]);var v=l(r,d)/a;var m=l(n,d)/a;c=Math.acos(v);i=Math.acos(m)}a=Math.log(a);return new h(e.zoomMin,e.zoomMax,t,r,n,a,i,c)}},{"filtered-vector":242,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":365,"gl-vec3/dot":370,"gl-vec3/normalize":387}],582:[function(e,t,r){"use strict";t.exports=a;var n=+(Math.pow(2,27)+1);function a(e,t,r){var a=e*t;var i=n*e;var o=i-e;var s=i-o;var l=e-s;var u=n*t;var c=u-t;var f=u-c;var h=t-f;var p=a-s*f;var d=p-l*f;var v=d-s*h;var m=l*h-v;if(r){r[0]=m;r[1]=a;return r}return[m,a]}},{}],583:[function(e,t,r){"use strict";t.exports=n;function n(e,t,r){var n=e+t;var a=n-e;var i=n-a;var o=t-a;var s=e-i;if(r){r[0]=s+o;r[1]=n;return r}return[s+o,n]}},{}],584:[function(e,t,r){"use strict";var n=e("../prototype/is");t.exports=function(e){if(typeof e!=="function")return false;if(!hasOwnProperty.call(e,"length"))return false;try{if(typeof e.length!=="number")return false;if(typeof e.call!=="function")return false;if(typeof e.apply!=="function")return false}catch(e){return false}return!n(e)}},{"../prototype/is":591}],585:[function(e,t,r){"use strict";var n=e("../value/is"),a=e("../object/is"),i=e("../string/coerce"),o=e("./to-short-string");var s=function(e,t){return e.replace("%v",o(t))};t.exports=function(e,t,r){if(!a(r))throw new TypeError(s(t,e));if(!n(e)){if("default"in r)return r["default"];if(r.isOptional)return null}var o=i(r.errorMessage);if(!n(o))o=t;throw new TypeError(s(o,e))}},{"../object/is":588,"../string/coerce":592,"../value/is":594,"./to-short-string":587}],586:[function(e,t,r){"use strict";t.exports=function(e){try{return e.toString()}catch(t){try{return String(e)}catch(e){return null}}}},{}],587:[function(e,t,r){"use strict";var n=e("./safe-to-string");var a=/[\n\r\u2028\u2029]/g;t.exports=function(e){var t=n(e);if(t===null)return"<Non-coercible to string value>";if(t.length>100)t=t.slice(0,99)+"…";t=t.replace(a,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}});return t}},{"./safe-to-string":586}],588:[function(e,t,r){"use strict";var n=e("../value/is");var a={object:true,function:true,undefined:true};t.exports=function(e){if(!n(e))return false;return hasOwnProperty.call(a,typeof e)}},{"../value/is":594}],589:[function(e,t,r){"use strict";var n=e("../lib/resolve-exception"),a=e("./is");t.exports=function(e){if(a(e))return e;return n(e,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":585,"./is":590}],590:[function(e,t,r){"use strict";var n=e("../function/is");var a=/^\s*class[\s{/}]/,i=Function.prototype.toString;t.exports=function(e){if(!n(e))return false;if(a.test(i.call(e)))return false;return true}},{"../function/is":584}],591:[function(e,t,r){"use strict";var n=e("../object/is");t.exports=function(e){if(!n(e))return false;try{if(!e.constructor)return false;return e.constructor.prototype===e}catch(e){return false}}},{"../object/is":588}],592:[function(e,t,r){"use strict";var n=e("../value/is"),a=e("../object/is");var i=Object.prototype.toString;t.exports=function(e){if(!n(e))return null;if(a(e)){var t=e.toString;if(typeof t!=="function")return null;if(t===i)return null}try{return""+e}catch(e){return null}}},{"../object/is":588,"../value/is":594}],593:[function(e,t,r){"use strict";var n=e("../lib/resolve-exception"),a=e("./is");t.exports=function(e){if(a(e))return e;return n(e,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":585,"./is":594}],594:[function(e,t,r){"use strict";var n=void 0;t.exports=function(e){return e!==n&&e!==null}},{}],595:[function(e,r,n){(function(t){(function(){"use strict";var r=e("bit-twiddle");var a=e("dup");var i=e("buffer").Buffer;if(!t.__TYPEDARRAY_POOL){t.__TYPEDARRAY_POOL={UINT8:a([32,0]),UINT16:a([32,0]),UINT32:a([32,0]),BIGUINT64:a([32,0]),INT8:a([32,0]),INT16:a([32,0]),INT32:a([32,0]),BIGINT64:a([32,0]),FLOAT:a([32,0]),DOUBLE:a([32,0]),DATA:a([32,0]),UINT8C:a([32,0]),BUFFER:a([32,0])}}var o=typeof Uint8ClampedArray!=="undefined";var s=typeof BigUint64Array!=="undefined";var l=typeof BigInt64Array!=="undefined";var u=t.__TYPEDARRAY_POOL;if(!u.UINT8C){u.UINT8C=a([32,0])}if(!u.BIGUINT64){u.BIGUINT64=a([32,0])}if(!u.BIGINT64){u.BIGINT64=a([32,0])}if(!u.BUFFER){u.BUFFER=a([32,0])}var c=u.DATA,f=u.BUFFER;n.free=function e(t){if(i.isBuffer(t)){f[r.log2(t.length)].push(t)}else{if(Object.prototype.toString.call(t)!=="[object ArrayBuffer]"){t=t.buffer}if(!t){return}var n=t.length||t.byteLength;var a=r.log2(n)|0;c[a].push(t)}};function h(e){if(!e){return}var t=e.length||e.byteLength;var n=r.log2(t);c[n].push(e)}function p(e){h(e.buffer)}n.freeUint8=n.freeUint16=n.freeUint32=n.freeBigUint64=n.freeInt8=n.freeInt16=n.freeInt32=n.freeBigInt64=n.freeFloat32=n.freeFloat=n.freeFloat64=n.freeDouble=n.freeUint8Clamped=n.freeDataView=p;n.freeArrayBuffer=h;n.freeBuffer=function e(t){f[r.log2(t.length)].push(t)};n.malloc=function e(t,r){if(r===undefined||r==="arraybuffer"){return d(t)}else{switch(r){case"uint8":return v(t);case"uint16":return m(t);case"uint32":return g(t);case"int8":return y(t);case"int16":return x(t);case"int32":return _(t);case"float":case"float32":return b(t);case"double":case"float64":return w(t);case"uint8_clamped":return T(t);case"bigint64":return A(t);case"biguint64":return k(t);case"buffer":return E(t);case"data":case"dataview":return M(t);default:return null}}return null};function d(e){var e=r.nextPow2(e);var t=r.log2(e);var n=c[t];if(n.length>0){return n.pop()}return new ArrayBuffer(e)}n.mallocArrayBuffer=d;function v(e){return new Uint8Array(d(e),0,e)}n.mallocUint8=v;function m(e){return new Uint16Array(d(2*e),0,e)}n.mallocUint16=m;function g(e){return new Uint32Array(d(4*e),0,e)}n.mallocUint32=g;function y(e){return new Int8Array(d(e),0,e)}n.mallocInt8=y;function x(e){return new Int16Array(d(2*e),0,e)}n.mallocInt16=x;function _(e){return new Int32Array(d(4*e),0,e)}n.mallocInt32=_;function b(e){return new Float32Array(d(4*e),0,e)}n.mallocFloat32=n.mallocFloat=b;function w(e){return new Float64Array(d(8*e),0,e)}n.mallocFloat64=n.mallocDouble=w;function T(e){if(o){return new Uint8ClampedArray(d(e),0,e)}else{return v(e)}}n.mallocUint8Clamped=T;function k(e){if(s){return new BigUint64Array(d(8*e),0,e)}else{return null}}n.mallocBigUint64=k;function A(e){if(l){return new BigInt64Array(d(8*e),0,e)}else{return null}}n.mallocBigInt64=A;function M(e){return new DataView(d(e),0,e)}n.mallocDataView=M;function E(e){e=r.nextPow2(e);var t=r.log2(e);var n=f[t];if(n.length>0){return n.pop()}return new i(e)}n.mallocBuffer=E;n.clearCache=function e(){for(var t=0;t<32;++t){u.UINT8[t].length=0;u.UINT16[t].length=0;u.UINT32[t].length=0;u.INT8[t].length=0;u.INT16[t].length=0;u.INT32[t].length=0;u.FLOAT[t].length=0;u.DOUBLE[t].length=0;u.BIGUINT64[t].length=0;u.BIGINT64[t].length=0;u.UINT8C[t].length=0;c[t].length=0;f[t].length=0}}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"bit-twiddle":97,buffer:111,dup:176}],596:[function(e,t,r){"use strict";"use restrict";t.exports=n;function n(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}var a=n.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}});a.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};a.find=function(e){var t=e;var r=this.roots;while(r[e]!==e){e=r[e]}while(r[t]!==e){var n=r[t];r[t]=e;t=n}return e};a.link=function(e,t){var r=this.find(e),n=this.find(t);if(r===n){return}var a=this.ranks,i=this.roots,o=a[r],s=a[n];if(o<s){i[r]=n}else if(s<o){i[n]=r}else{i[n]=r;++a[r]}}},{}],597:[function(e,t,r){"use strict";function n(e,t){var r=1,n=e.length,a=e[0],i=e[0];for(var o=1;o<n;++o){i=a;a=e[o];if(t(a,i)){if(o===r){r++;continue}e[r++]=a}}e.length=r;return e}function a(e){var t=1,r=e.length,n=e[0],a=e[0];for(var i=1;i<r;++i,a=n){a=n;n=e[i];if(n!==a){if(i===t){t++;continue}e[t++]=n}}e.length=t;return e}function i(e,t,r){if(e.length===0){return e}if(t){if(!r){e.sort(t)}return n(e,t)}if(!r){e.sort()}return a(e)}t.exports=i},{}],598:[function(e,t,r){var n=/[\'\"]/;t.exports=function e(t){if(!t){return""}if(n.test(t.charAt(0))){t=t.substr(1)}if(n.test(t.charAt(t.length-1))){t=t.substr(0,t.length-1)}return t}},{}],599:[function(e,t,r){"use strict";t.exports=function e(t,r,n){if(!Array.isArray(n))n=[].slice.call(arguments,2);for(var a=0,i=n.length;a<i;a++){var o=n[a];for(var s in o){if(r[s]!==undefined&&!Array.isArray(r[s])&&t[s]===r[s])continue;if(s in r){var l;if(o[s]===true)l=r[s];else if(o[s]===false)continue;else if(typeof o[s]==="function"){l=o[s](r[s],t,r);if(l===undefined)continue}t[s]=l}}}return t}},{}],600:[function(e,t,r){"use strict";t.exports=o;var n=e("./lib/vtext");var a=null;var i=null;if(typeof document!=="undefined"){a=document.createElement("canvas");a.width=8192;a.height=1024;i=a.getContext("2d")}function o(e,t){if(typeof t!=="object"||t===null){t={}}return n(e,t.canvas||a,t.context||i,t)}},{"./lib/vtext":601}],601:[function(e,t,r){t.exports=A;t.exports.processPixels=k;var n=e("surface-nets");var a=e("ndarray");var i=e("simplify-planar-graph");var o=e("clean-pslg");var s=e("cdt2d");var l=e("planar-graph-to-polyline");var u="b";var c="b|";var f="i";var h="i|";var p="sup";var d="+";var v="+1";var m="sub";var g="-";var y="-1";function x(e,t,r,n){var a="<"+e+">";var i="</"+e+">";var o=a.length;var s=i.length;var l=t[0]===d||t[0]===g;var u=0;var c=-s;while(u>-1){u=r.indexOf(a,u);if(u===-1)break;c=r.indexOf(i,u+o);if(c===-1)break;if(c<=u)break;for(var f=u;f<c+s;++f){if(f<u+o||f>=c){n[f]=null;r=r.substr(0,f)+" "+r.substr(f+1)}else{if(n[f]!==null){var h=n[f].indexOf(t[0]);if(h===-1){n[f]+=t}else{if(l){n[f]=n[f].substr(0,h+1)+(1+parseInt(n[f][h+1]))+n[f].substr(h+2)}}}}}var p=u+o;var v=r.substr(p,c-p);var m=v.indexOf(a);if(m!==-1)u=m;else u=c+s}return n}function _(e,t,r){var n=t.textAlign||"start";var a=t.textBaseline||"alphabetic";var i=[1<<30,1<<30];var o=[0,0];var s=e.length;for(var l=0;l<s;++l){var u=e[l];for(var c=0;c<2;++c){i[c]=Math.min(i[c],u[c])|0;o[c]=Math.max(o[c],u[c])|0}}var f=0;switch(n){case"center":f=-.5*(i[0]+o[0]);break;case"right":case"end":f=-o[0];break;case"left":case"start":f=-i[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+n+"'")}var h=0;switch(a){case"hanging":case"top":h=-i[1];break;case"middle":h=-.5*(i[1]+o[1]);break;case"alphabetic":case"ideographic":h=-3*r;break;case"bottom":h=-o[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+a+"'")}var p=1/r;if("lineHeight"in t){p*=+t.lineHeight}else if("width"in t){p=t.width/(o[0]-i[0])}else if("height"in t){p=t.height/(o[1]-i[1])}return e.map(function(e){return[p*(e[0]+f),p*(e[1]+h)]})}function b(e,t,r,n,i,o){r=r.replace(/\n/g,"");if(o.breaklines===true){r=r.replace(/\<br\>/g,"\n")}else{r=r.replace(/\<br\>/g," ")}var s="";var l=[];for(L=0;L<r.length;++L){l[L]=s}if(o.bolds===true)l=x(u,c,r,l);if(o.italics===true)l=x(f,h,r,l);if(o.superscripts===true)l=x(p,v,r,l);if(o.subscripts===true)l=x(m,y,r,l);var _=[];var b="";for(L=0;L<r.length;++L){if(l[L]!==null){b+=r[L];_.push(l[L])}}var w=b.split("\n");var T=w.length;var k=Math.round(i*n);var A=n;var M=n*2;var E=0;var S=T*k+M;if(e.height<S){e.height=S}t.fillStyle="#000";t.fillRect(0,0,e.width,e.height);t.fillStyle="#fff";var C,L,I,O,P;var D=0;var R="";function z(){if(R!==""){var e=t.measureText(R).width;t.fillText(R,A+I,M+O);I+=e}}function N(){return""+Math.round(P)+"px "}function F(e,r){var n=""+t.font;if(o.subscripts===true){var a=e.indexOf(g);var i=r.indexOf(g);var s=a>-1?parseInt(e[1+a]):0;var l=i>-1?parseInt(r[1+i]):0;if(s!==l){n=n.replace(N(),"?px ");P*=Math.pow(.75,l-s);n=n.replace("?px ",N())}O+=.25*k*(l-s)}if(o.superscripts===true){var u=e.indexOf(d);var f=r.indexOf(d);var p=u>-1?parseInt(e[1+u]):0;var v=f>-1?parseInt(r[1+f]):0;if(p!==v){n=n.replace(N(),"?px ");P*=Math.pow(.75,v-p);n=n.replace("?px ",N())}O-=.25*k*(v-p)}if(o.bolds===true){var m=e.indexOf(c)>-1;var y=r.indexOf(c)>-1;if(!m&&y){if(x){n=n.replace("italic ","italic bold ")}else{n="bold "+n}}if(m&&!y){n=n.replace("bold ","")}}if(o.italics===true){var x=e.indexOf(h)>-1;var _=r.indexOf(h)>-1;if(!x&&_){n="italic "+n}if(x&&!_){n=n.replace("italic ","")}}t.font=n}for(C=0;C<T;++C){var B=w[C]+"\n";I=0;O=C*k;P=n;R="";for(L=0;L<B.length;++L){var j=L+D<_.length?_[L+D]:_[_.length-1];if(s===j){R+=B[L]}else{z();R=B[L];if(j!==undefined){F(s,j);s=j}}}z();D+=B.length;var U=Math.round(I+2*A)|0;if(E<U)E=U}var H=E;var V=M+k*T;var G=a(t.getImageData(0,0,H,V).data,[V,H,4]);return G.pick(-1,-1,0).transpose(1,0)}function w(e,t){var r=n(e,128);if(t){return i(r.cells,r.positions,.25)}return{edges:r.cells,positions:r.positions}}function T(e,t,r,n){var a=w(e,n);var i=_(a.positions,t,r);var u=a.edges;var c="ccw"===t.orientation;o(i,u);if(t.polygons||t.polygon||t.polyline){var f=l(u,i);var h=new Array(f.length);for(var p=0;p<f.length;++p){var d=f[p];var v=new Array(d.length);for(var m=0;m<d.length;++m){var g=d[m];var y=new Array(g.length);for(var x=0;x<g.length;++x){y[x]=i[g[x]].slice()}if(c){y.reverse()}v[m]=y}h[p]=v}return h}else if(t.triangles||t.triangulate||t.triangle){return{cells:s(i,u,{delaunay:false,exterior:false,interior:true}),positions:i}}else{return{edges:u,positions:i}}}function k(e,t,r){try{return T(e,t,r,true)}catch(e){}try{return T(e,t,r,false)}catch(e){}if(t.polygons||t.polyline||t.polygon){return[]}if(t.triangles||t.triangulate||t.triangle){return{cells:[],positions:[]}}return{edges:[],positions:[]}}function A(e,t,r,n){var a=64;var i=1.25;var o={breaklines:false,bolds:false,italics:false,subscripts:false,superscripts:false};if(n){if(n.size&&n.size>0)a=n.size;if(n.lineSpacing&&n.lineSpacing>0)i=n.lineSpacing;if(n.styletags&&n.styletags.breaklines)o.breaklines=n.styletags.breaklines?true:false;if(n.styletags&&n.styletags.bolds)o.bolds=n.styletags.bolds?true:false;if(n.styletags&&n.styletags.italics)o.italics=n.styletags.italics?true:false;if(n.styletags&&n.styletags.subscripts)o.subscripts=n.styletags.subscripts?true:false;if(n.styletags&&n.styletags.superscripts)o.superscripts=n.styletags.superscripts?true:false}r.font=[n.fontStyle,n.fontVariant,n.fontWeight,a+"px",n.font].filter(function(e){return e}).join(" ");r.textAlign="start";r.textBaseline="alphabetic";r.direction="ltr";var s=b(t,r,e,a,i,o);return k(s,n,a)}},{cdt2d:112,"clean-pslg":121,ndarray:495,"planar-graph-to-polyline":514,"simplify-planar-graph":562,"surface-nets":570}],602:[function(e,t,r){(function e(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function r(e){if(e.permitHostObjects___){e.permitHostObjects___(r)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=r}var n=false;if(typeof WeakMap==="function"){var a=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var i=new a;var o=Object.freeze({});i.set(o,1);if(i.get(o)!==1){n=true}else{t.exports=WeakMap;return}}}var s=Object.prototype.hasOwnProperty;var l=Object.getOwnPropertyNames;var u=Object.defineProperty;var c=Object.isExtensible;var f="weakmap:";var h=f+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var p=new ArrayBuffer(25);var d=new Uint8Array(p);crypto.getRandomValues(d);h=f+"rand:"+Array.prototype.map.call(d,function(e){return(e%36).toString(36)}).join("")+"___"}function v(e){return!(e.substr(0,f.length)==f&&e.substr(e.length-3)==="___")}u(Object,"getOwnPropertyNames",{value:function e(t){return l(t).filter(v)}});if("getPropertyNames"in Object){var m=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function e(t){return m(t).filter(v)}})}function g(e){if(e!==Object(e)){throw new TypeError("Not an object: "+e)}var t=e[h];if(t&&t.key===e){return t}if(!c(e)){return void 0}t={key:e};try{u(e,h,{value:t,writable:false,enumerable:false,configurable:false});return t}catch(e){return void 0}}(function(){var e=Object.freeze;u(Object,"freeze",{value:function t(r){g(r);return e(r)}});var t=Object.seal;u(Object,"seal",{value:function e(r){g(r);return t(r)}});var r=Object.preventExtensions;u(Object,"preventExtensions",{value:function e(t){g(t);return r(t)}})})();function y(e){e.prototype=null;return Object.freeze(e)}var x=false;function _(){if(!x&&typeof console!=="undefined"){x=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var b=0;var w=function(){if(!(this instanceof w)){_()}var e=[];var t=[];var r=b++;function n(n,a){var i;var o=g(n);if(o){return r in o?o[r]:a}else{i=e.indexOf(n);return i>=0?t[i]:a}}function a(t){var n=g(t);if(n){return r in n}else{return e.indexOf(t)>=0}}function i(n,a){var i;var o=g(n);if(o){o[r]=a}else{i=e.indexOf(n);if(i>=0){t[i]=a}else{i=e.length;t[i]=a;e[i]=n}}return this}function o(n){var a=g(n);var i,o;if(a){return r in a&&delete a[r]}else{i=e.indexOf(n);if(i<0){return false}o=e.length-1;e[i]=void 0;t[i]=t[o];e[i]=e[o];e.length=o;t.length=o;return true}}return Object.create(w.prototype,{get___:{value:y(n)},has___:{value:y(a)},set___:{value:y(i)},delete___:{value:y(o)}})};w.prototype=Object.create(Object.prototype,{get:{value:function e(t,r){return this.get___(t,r)},writable:true,configurable:true},has:{value:function e(t){return this.has___(t)},writable:true,configurable:true},set:{value:function e(t,r){return this.set___(t,r)},writable:true,configurable:true},delete:{value:function e(t){return this.delete___(t)},writable:true,configurable:true}});if(typeof a==="function"){(function(){if(n&&typeof Proxy!=="undefined"){Proxy=undefined}function e(){if(!(this instanceof w)){_()}var e=new a;var t=undefined;var i=false;function o(r,n){if(t){return e.has(r)?e.get(r):t.get___(r,n)}else{return e.get(r,n)}}function s(r){return e.has(r)||(t?t.has___(r):false)}var l;if(n){l=function(r,n){e.set(r,n);if(!e.has(r)){if(!t){t=new w}t.set(r,n)}return this}}else{l=function(r,n){if(i){try{e.set(r,n)}catch(e){if(!t){t=new w}t.set___(r,n)}}else{e.set(r,n)}return this}}function u(r){var n=!!e["delete"](r);if(t){return t.delete___(r)||n}return n}return Object.create(w.prototype,{get___:{value:y(o)},has___:{value:y(s)},set___:{value:y(l)},delete___:{value:y(u)},permitHostObjects___:{value:y(function(e){if(e===r){i=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}e.prototype=w.prototype;t.exports=e;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}t.exports=w}})()},{}],603:[function(e,t,r){var n=e("./hidden-store.js");t.exports=a;function a(){var e={};return function(t){if((typeof t!=="object"||t===null)&&typeof t!=="function"){throw new Error("Weakmap-shim: Key must be object")}var r=t.valueOf(e);return r&&r.identity===e?r:n(t,e)}}},{"./hidden-store.js":604}],604:[function(e,t,r){t.exports=n;function n(e,t){var r={identity:t};var n=e.valueOf;Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?n.apply(this,arguments):r},writable:true});return r}},{}],605:[function(e,t,r){var n=e("./create-store.js");t.exports=a;function a(){var e=n();return{get:function(t,r){var n=e(t);return n.hasOwnProperty("value")?n.value:r},set:function(t,r){e(t).value=r;return this},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}},{"./create-store.js":603}],606:[function(e,t,r){var n=e("get-canvas-context");t.exports=function e(t){return n("webgl",t)}},{"get-canvas-context":249}],607:[function(e,t,r){var n=e("../main");var a=e("object-assign");var i=n.instance();function o(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}o.prototype=new n.baseCalendar;a(o.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:false,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(e,t){if(typeof e==="string"){var r=e.match(l);return r?r[0]:""}var n=this._validateYear(e);var a=e.month();var i=""+this.toChineseMonth(n,a);if(t&&i.length<2){i="0"+i}if(this.isIntercalaryMonth(n,a)){i+="i"}return i},monthNames:function(e){if(typeof e==="string"){var t=e.match(u);return t?t[0]:""}var r=this._validateYear(e);var n=e.month();var a=this.toChineseMonth(r,n);var i=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][a-1];if(this.isIntercalaryMonth(r,n)){i="闰"+i}return i},monthNamesShort:function(e){if(typeof e==="string"){var t=e.match(c);return t?t[0]:""}var r=this._validateYear(e);var n=e.month();var a=this.toChineseMonth(r,n);var i=["一","二","三","四","五","六","七","八","九","十","十一","十二"][a-1];if(this.isIntercalaryMonth(r,n)){i="闰"+i}return i},parseMonth:function(e,t){e=this._validateYear(e);var r=parseInt(t);var n;if(!isNaN(r)){var a=t[t.length-1];n=a==="i"||a==="I"}else{if(t[0]==="闰"){n=true;t=t.substring(1)}if(t[t.length-1]==="月"){t=t.substring(0,t.length-1)}r=1+["一","二","三","四","五","六","七","八","九","十","十一","十二"].indexOf(t)}var i=this.toMonthIndex(e,r,n);return i},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:false}},_validateYear:function(e,t){if(e.year){e=e.year()}if(typeof e!=="number"||e<1888||e>2111){throw t.replace(/\{0\}/,this.local.name)}return e},toMonthIndex:function(e,t,r){var a=this.intercalaryMonth(e);var i=r&&t!==a;if(i||t<1||t>12){throw n.local.invalidMonth.replace(/\{0\}/,this.local.name)}var o;if(!a){o=t-1}else if(!r&&t<=a){o=t-1}else{o=t}return o},toChineseMonth:function(e,t){if(e.year){e=e.year();t=e.month()}var r=this.intercalaryMonth(e);var a=r?12:11;if(t<0||t>a){throw n.local.invalidMonth.replace(/\{0\}/,this.local.name)}var i;if(!r){i=t+1}else if(t<r){i=t+1}else{i=t}return i},intercalaryMonth:function(e){e=this._validateYear(e);var t=f[e-f[0]];var r=t>>13;return r},isIntercalaryMonth:function(e,t){if(e.year){e=e.year();t=e.month()}var r=this.intercalaryMonth(e);return!!r&&r===t},leapYear:function(e){return this.intercalaryMonth(e)!==0},weekOfYear:function(e,t,r){var a=this._validateYear(e,n.local.invalidyear);var o=h[a-h[0]];var s=o>>9&4095;var l=o>>5&15;var u=o&31;var c;c=i.newDate(s,l,u);c.add(4-(c.dayOfWeek()||7),"d");var f=this.toJD(e,t,r)-c.toJD();return 1+Math.floor(f/7)},monthsInYear:function(e){return this.leapYear(e)?13:12},daysInMonth:function(e,t){if(e.year){t=e.month();e=e.year()}e=this._validateYear(e);var r=f[e-f[0]];var a=r>>13;var i=a?12:11;if(t>i){throw n.local.invalidMonth.replace(/\{0\}/,this.local.name)}var o=r&1<<12-t?30:29;return o},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,s,r,n.local.invalidDate);e=this._validateYear(a.year());t=a.month();r=a.day();var o=this.isIntercalaryMonth(e,t);var s=this.toChineseMonth(e,t);var l=d(e,s,r,o);return i.toJD(l.year,l.month,l.day)},fromJD:function(e){var t=i.fromJD(e);var r=p(t.year(),t.month(),t.day());var n=this.toMonthIndex(r.year,r.month,r.isIntercalary);return this.newDate(r.year,n,r.day)},fromString:function(e){var t=e.match(s);var r=this._validateYear(+t[1]);var n=+t[2];var a=!!t[3];var i=this.toMonthIndex(r,n,a);var o=+t[4];return this.newDate(r,i,o)},add:function(e,t,r){var n=e.year();var a=e.month();var i=this.isIntercalaryMonth(n,a);var s=this.toChineseMonth(n,a);var l=Object.getPrototypeOf(o.prototype).add.call(this,e,t,r);if(r==="y"){var u=l.year();var c=l.month();var f=this.isIntercalaryMonth(u,s);var h=i&&f?this.toMonthIndex(u,s,true):this.toMonthIndex(u,s,false);if(h!==c){l.month(h)}}return l}});var s=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m;var l=/^\d?\d[iI]?/m;var u=/^闰?十?[一二三四五六七八九]?月/m;var c=/^闰?十?[一二三四五六七八九]?/m;n.calendars.chinese=o;var f=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548];var h=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function p(e,t,r,n){var a;var i;if(typeof e==="object"){a=e;i=t||{}}else{var o=typeof e==="number"&&e>=1888&&e<=2111;if(!o)throw new Error("Solar year outside range 1888-2111");var s=typeof t==="number"&&t>=1&&t<=12;if(!s)throw new Error("Solar month outside range 1 - 12");var l=typeof r==="number"&&r>=1&&r<=31;if(!l)throw new Error("Solar day outside range 1 - 31");a={year:e,month:t,day:r};i=n||{}}var u=h[a.year-h[0]];var c=a.year<<9|a.month<<5|a.day;i.year=c>=u?a.year:a.year-1;u=h[i.year-h[0]];var p=u>>9&4095;var d=u>>5&15;var v=u&31;var m;var g=new Date(p,d-1,v);var y=new Date(a.year,a.month-1,a.day);m=Math.round((y-g)/(24*3600*1e3));var x=f[i.year-f[0]];var _;for(_=0;_<13;_++){var b=x&1<<12-_?30:29;if(m<b){break}m-=b}var w=x>>13;if(!w||_<w){i.isIntercalary=false;i.month=1+_}else if(_===w){i.isIntercalary=true;i.month=_}else{i.isIntercalary=false;i.month=_}i.day=1+m;return i}function d(e,t,r,n,a){var i;var o;if(typeof e==="object"){o=e;i=t||{}}else{var s=typeof e==="number"&&e>=1888&&e<=2111;if(!s)throw new Error("Lunar year outside range 1888-2111");var l=typeof t==="number"&&t>=1&&t<=12;if(!l)throw new Error("Lunar month outside range 1 - 12");var u=typeof r==="number"&&r>=1&&r<=30;if(!u)throw new Error("Lunar day outside range 1 - 30");var c;if(typeof n==="object"){c=false;i=n}else{c=!!n;i=a||{}}o={year:e,month:t,day:r,isIntercalary:c}}var p;p=o.day-1;var d=f[o.year-f[0]];var v=d>>13;var m;if(!v){m=o.month-1}else if(o.month>v){m=o.month}else if(o.isIntercalary){m=o.month}else{m=o.month-1}for(var g=0;g<m;g++){var y=d&1<<12-g?30:29;p+=y}var x=h[o.year-h[0]];var _=x>>9&4095;var b=x>>5&15;var w=x&31;var T=new Date(_,b-1,w+p);i.year=T.getFullYear();i.month=1+T.getMonth();i.day=T.getDate();return i}},{"../main":621,"object-assign":499}],608:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=t.year()+(t.year()<0?1:0);return e%4===3||e%4===-1},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return 13},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===13&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();if(e<0){e++}return a.day()+(a.month()-1)*30+(e-1)*365+Math.floor(e/4)+this.jdEpoch-1},fromJD:function(e){var t=Math.floor(e)+.5-this.jdEpoch;var r=Math.floor((t-Math.floor((t+366)/1461))/365)+1;if(r<=0){r--}t=Math.floor(e)+.5-this.newDate(r,1,1).toJD();var n=Math.floor(t/30)+1;var a=t-(n-1)*30+1;return this.newDate(r,n,a)}});n.calendars.coptic=i},{"../main":621,"object-assign":499}],609:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:false}},leapYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return false},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return 13},daysInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return 400},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);return(a.day()+1)%8},weekDay:function(e,t,r){var n=this.dayOfWeek(e,t,r);return n>=2&&n<=6},extraInfo:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);return{century:o[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year()+(a.year()<0?1:0);t=a.month();r=a.day();return r+(t>1?16:0)+(t>2?(t-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var t=Math.floor(e/400)+1;e-=(t-1)*400;e+=e>15?16:0;var r=Math.floor(e/32)+1;var n=e-(r-1)*32+1;return this.newDate(t<=0?t-1:t,r,n)}});var o={20:"Fruitbat",21:"Anchovy"};n.calendars.discworld=i},{"../main":621,"object-assign":499}],610:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=t.year()+(t.year()<0?1:0);return e%4===3||e%4===-1},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return 13},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===13&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();if(e<0){e++}return a.day()+(a.month()-1)*30+(e-1)*365+Math.floor(e/4)+this.jdEpoch-1},fromJD:function(e){var t=Math.floor(e)+.5-this.jdEpoch;var r=Math.floor((t-Math.floor((t+366)/1461))/365)+1;if(r<=0){r--}t=Math.floor(e)+.5-this.newDate(r,1,1).toJD();var n=Math.floor(t/30)+1;var a=t-(n-1)*30+1;return this.newDate(r,n,a)}});n.calendars.ethiopian=i},{"../main":621,"object-assign":499}],611:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:false,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){e=e<0?e+1:e;return o(e*7+1,19)<7},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);e=t.year();return this.toJD(e===-1?+1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){if(e.year){t=e.month();e=e.year()}this._validate(e,t,this.minDay,n.local.invalidMonth);return t===12&&this.leapYear(e)?30:t===8&&o(this.daysInYear(e),10)===5?30:t===9&&o(this.daysInYear(e),10)===3?29:this.daysPerMonth[t-1]},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==6},extraInfo:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();t=a.month();r=a.day();var i=e<=0?e+1:e;var o=this.jdEpoch+this._delay1(i)+this._delay2(i)+r+1;if(t<7){for(var s=7;s<=this.monthsInYear(e);s++){o+=this.daysInMonth(e,s)}for(var s=1;s<t;s++){o+=this.daysInMonth(e,s)}}else{for(var s=7;s<t;s++){o+=this.daysInMonth(e,s)}}return o},_delay1:function(e){var t=Math.floor((235*e-234)/19);var r=12084+13753*t;var n=t*29+Math.floor(r/25920);if(o(3*(n+1),7)<3){n++}return n},_delay2:function(e){var t=this._delay1(e-1);var r=this._delay1(e);var n=this._delay1(e+1);return n-r===356?2:r-t===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;var t=Math.floor((e-this.jdEpoch)*98496/35975351)-1;while(e>=this.toJD(t===-1?+1:t+1,7,1)){t++}var r=e<this.toJD(t,1,1)?7:1;while(e>this.toJD(t,r,this.daysInMonth(t,r))){r++}var n=e-this.toJD(t,r,1)+1;return this.newDate(t,r,n)}});function o(e,t){return e-t*Math.floor(e/t)}n.calendars.hebrew=i},{"../main":621,"object-assign":499}],612:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khamīs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return(t.year()*11+14)%30<11},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(e){return this.leapYear(e)?355:354},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==5},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();t=a.month();r=a.day();e=e<=0?e+1:e;return r+Math.ceil(29.5*(t-1))+(e-1)*354+Math.floor((3+11*e)/30)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var t=Math.floor((30*(e-this.jdEpoch)+10646)/10631);t=t<=0?t-1:t;var r=Math.min(12,Math.ceil((e-29-this.toJD(t,1,1))/29.5)+1);var n=e-this.toJD(t,r,1)+1;return this.newDate(t,r,n)}});n.calendars.islamic=i},{"../main":621,"object-assign":499}],613:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=t.year()<0?t.year()+1:t.year();return e%4===0},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(4-(n.dayOfWeek()||7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();t=a.month();r=a.day();if(e<0){e++}if(t<=2){e--;t+=12}return Math.floor(365.25*(e+4716))+Math.floor(30.6001*(t+1))+r-1524.5},fromJD:function(e){var t=Math.floor(e+.5);var r=t+1524;var n=Math.floor((r-122.1)/365.25);var a=Math.floor(365.25*n);var i=Math.floor((r-a)/30.6001);var o=i-Math.floor(i<14?1:13);var s=n-Math.floor(o>2?4716:4715);var l=r-a-Math.floor(30.6001*i);if(s<=0){s--}return this.newDate(s,o,l)}});n.calendars.julian=i},{"../main":621,"object-assign":499}],614:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:true,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:false,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return false},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);e=t.year();var r=Math.floor(e/400);e=e%400;e+=e<0?400:0;var a=Math.floor(e/20);return r+"."+a+"."+e%20},forYear:function(e){e=e.split(".");if(e.length<3){throw"Invalid Mayan year"}var t=0;for(var r=0;r<e.length;r++){var n=parseInt(e[r],10);if(Math.abs(n)>19||r>0&&n<0){throw"Invalid Mayan year"}t=t*20+n}return t},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return 18},weekOfYear:function(e,t,r){this._validate(e,t,r,n.local.invalidDate);return 0},daysInYear:function(e){this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return 360},daysInMonth:function(e,t){this._validate(e,t,this.minDay,n.local.invalidMonth);return 20},daysInWeek:function(){return 5},dayOfWeek:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);return a.day()},weekDay:function(e,t,r){this._validate(e,t,r,n.local.invalidDate);return true},extraInfo:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);var i=a.toJD();var o=this._toHaab(i);var s=this._toTzolkin(i);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[s[0]-1],tzolkinDay:s[0],tzolkinTrecena:s[1]}},_toHaab:function(e){e-=this.jdEpoch;var t=o(e+8+(18-1)*20,365);return[Math.floor(t/20)+1,o(t,20)]},_toTzolkin:function(e){e-=this.jdEpoch;return[s(e+20,20),s(e+4,13)]},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);return a.day()+a.month()*20+a.year()*360+this.jdEpoch},fromJD:function(e){e=Math.floor(e)+.5-this.jdEpoch;var t=Math.floor(e/360);e=e%360;e+=e<0?360:0;var r=Math.floor(e/20);var n=e%20;return this.newDate(t,r,n)}});function o(e,t){return e-t*Math.floor(e/t)}function s(e,t){return o(e-1,t)+1}n.calendars.mayan=i},{"../main":621,"object-assign":499}],615:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;var o=n.instance("gregorian");a(i.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return o.leapYear(t.year()+(t.year()<1?1:0)+1469)},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(1-(n.dayOfWeek()||7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidMonth);var e=a.year();if(e<0){e++}var i=a.day();for(var s=1;s<a.month();s++){i+=this.daysPerMonth[s-1]}return i+o.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);var t=Math.floor((e-(this.jdEpoch-1))/366);while(e>=this.toJD(t+1,1,1)){t++}var r=e-Math.floor(this.toJD(t,1,1)+.5)+1;var n=1;while(r>this.daysInMonth(t,n)){r-=this.daysInMonth(t,n);n++}return this.newDate(t,n,r)}});n.calendars.nanakshahi=i},{"../main":621,"object-assign":499}],616:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:false}},leapYear:function(e){return this.daysInYear(e)!==this.daysPerYear},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);e=t.year();if(typeof this.NEPALI_CALENDAR_DATA[e]==="undefined"){return this.daysPerYear}var r=0;for(var a=this.minMonth;a<=12;a++){r+=this.NEPALI_CALENDAR_DATA[e][a]}return r},daysInMonth:function(e,t){if(e.year){t=e.month();e=e.year()}this._validate(e,t,this.minDay,n.local.invalidMonth);return typeof this.NEPALI_CALENDAR_DATA[e]==="undefined"?this.daysPerMonth[t-1]:this.NEPALI_CALENDAR_DATA[e][t]},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();t=a.month();r=a.day();var i=n.instance();var o=0;var s=t;var l=e;this._createMissingCalendarData(e);var u=e-(s>9||s===9&&r>=this.NEPALI_CALENDAR_DATA[l][0]?56:57);if(t!==9){o=r;s--}while(s!==9){if(s<=0){s=12;l--}o+=this.NEPALI_CALENDAR_DATA[l][s];s--}if(t===9){o+=r-this.NEPALI_CALENDAR_DATA[l][0];if(o<0){o+=i.daysInYear(u)}}else{o+=this.NEPALI_CALENDAR_DATA[l][9]-this.NEPALI_CALENDAR_DATA[l][0]}return i.newDate(u,1,1).add(o,"d").toJD()},fromJD:function(e){var t=n.instance();var r=t.fromJD(e);var a=r.year();var i=r.dayOfYear();var o=a+56;this._createMissingCalendarData(o);var s=9;var l=this.NEPALI_CALENDAR_DATA[o][0];var u=this.NEPALI_CALENDAR_DATA[o][s]-l+1;while(i>u){s++;if(s>12){s=1;o++}u+=this.NEPALI_CALENDAR_DATA[o][s]}var c=this.NEPALI_CALENDAR_DATA[o][s]-(u-i);return this.newDate(o,s,c)},_createMissingCalendarData:function(e){var t=this.daysPerMonth.slice(0);t.unshift(17);for(var r=e-1;r<e+2;r++){if(typeof this.NEPALI_CALENDAR_DATA[r]==="undefined"){this.NEPALI_CALENDAR_DATA[r]=t}}},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2000:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}});n.calendars.nepali=i},{"../main":621,"object-assign":499}],617:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Chæharshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Chæ","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return((t.year()-(t.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-((n.dayOfWeek()+1)%7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==5},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);e=a.year();t=a.month();r=a.day();var i=e-(e>=0?474:473);var s=474+o(i,2820);return r+(t<=7?(t-1)*31:(t-1)*30+6)+Math.floor((s*682-110)/2816)+(s-1)*365+Math.floor(i/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var t=e-this.toJD(475,1,1);var r=Math.floor(t/1029983);var n=o(t,1029983);var a=2820;if(n!==1029982){var i=Math.floor(n/366);var s=o(n,366);a=Math.floor((2134*i+2816*s+2815)/1028522)+i+1}var l=a+2820*r+474;l=l<=0?l-1:l;var u=e-this.toJD(l,1,1)+1;var c=u<=186?Math.ceil(u/31):Math.ceil((u-6)/30);var f=e-this.toJD(l,c,1)+1;return this.newDate(l,c,f)}});function o(e,t){return e-t*Math.floor(e/t)}n.calendars.persian=i;n.calendars.jalali=i},{"../main":621,"object-assign":499}],618:[function(e,t,r){var n=e("../main");var a=e("object-assign");var i=n.instance();function o(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}o.prototype=new n.baseCalendar;a(o.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=this._t2gYear(t.year());return i.leapYear(e)},weekOfYear:function(e,t,r){var a=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=this._t2gYear(a.year());return i.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);var e=this._t2gYear(a.year());return i.toJD(e,a.month(),a.day())},fromJD:function(e){var t=i.fromJD(e);var r=this._g2tYear(t.year());return this.newDate(r,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}});n.calendars.taiwan=o},{"../main":621,"object-assign":499}],619:[function(e,t,r){var n=e("../main");var a=e("object-assign");var i=n.instance();function o(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}o.prototype=new n.baseCalendar;a(o.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=this._t2gYear(t.year());return i.leapYear(e)},weekOfYear:function(e,t,r){var a=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);var e=this._t2gYear(a.year());return i.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);var e=this._t2gYear(a.year());return i.toJD(e,a.month(),a.day())},fromJD:function(e){var t=i.fromJD(e);var r=this._g2tYear(t.year());return this.newDate(r,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}});n.calendars.thai=o},{"../main":621,"object-assign":499}],620:[function(e,t,r){var n=e("../main");var a=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"UmmAlQura",hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalāthā’","Yawm al-Arba‘ā’","Yawm al-Khamīs","Yawm al-Jum‘a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:true}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,n.local.invalidYear);return this.daysInYear(t.year())===355},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=0;for(var r=1;r<=12;r++){t+=this.daysInMonth(e,r)}return t},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,n.local.invalidMonth);var a=r.toJD()-24e5+.5;var i=0;for(var s=0;s<o.length;s++){if(o[s]>a){return o[i]-o[i-1]}i++}return 30},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==5},toJD:function(e,t,r){var a=this._validate(e,t,r,n.local.invalidDate);var i=12*(a.year()-1)+a.month()-15292;var s=a.day()+o[i-1]-1;return s+24e5-.5},fromJD:function(e){var t=e-24e5+.5;var r=0;for(var n=0;n<o.length;n++){if(o[n]>t)break;r++}var a=r+15292;var i=Math.floor((a-1)/12);var s=i+1;var l=a-12*i;var u=t-o[r-1]+1;return this.newDate(s,l,u)},isValid:function(e,t,r){var a=n.baseCalendar.prototype.isValid.apply(this,arguments);if(a){e=e.year!=null?e.year:e;a=e>=1276&&e<=1500}return a},_validate:function(e,t,r,a){var i=n.baseCalendar.prototype._validate.apply(this,arguments);if(i.year<1276||i.year>1500){throw a.replace(/\{0\}/,this.local.name)}return i}});n.calendars.ummalqura=i;var o=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":621,"object-assign":499}],621:[function(e,t,r){var n=e("object-assign");function a(){this.regionalOptions=[];this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"};this.local=this.regionalOptions[""];this.calendars={};this._localCals={}}n(a.prototype,{instance:function(e,t){e=(e||"gregorian").toLowerCase();t=t||"";var r=this._localCals[e+"-"+t];if(!r&&this.calendars[e]){r=new this.calendars[e](t);this._localCals[e+"-"+t]=r}if(!r){throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,e)}return r},newDate:function(e,t,r,n,a){n=(e!=null&&e.year?e.calendar():typeof n==="string"?this.instance(n,a):n)||this.instance();return n.newDate(e,t,r)},substituteDigits:function(e){return function(t){return(t+"").replace(/[0-9]/g,function(t){return e[t]})}},substituteChineseDigits:function(e,t){return function(r){var n="";var a=0;while(r>0){var i=r%10;n=(i===0?"":e[i]+t[a])+n;a++;r=Math.floor(r/10)}if(n.indexOf(e[1]+t[1])===0){n=n.substr(1)}return n||e[0]}}});function i(e,t,r,n){this._calendar=e;this._year=t;this._month=r;this._day=n;if(this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day)){throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}}function o(e,t){e=""+e;return"000000".substring(0,t-e.length)+e}n(i.prototype,{newDate:function(e,t,r){return this._calendar.newDate(e==null?this:e,t,r)},year:function(e){return arguments.length===0?this._year:this.set(e,"y")},month:function(e){return arguments.length===0?this._month:this.set(e,"m")},day:function(e){return arguments.length===0?this._day:this.set(e,"d")},date:function(e,t,r){if(!this._calendar.isValid(e,t,r)){throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}this._year=e;this._month=t;this._day=r;return this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(e,t){return this._calendar.add(this,e,t)},set:function(e,t){return this._calendar.set(this,e,t)},compareTo:function(e){if(this._calendar.name!==e._calendar.name){throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,e._calendar.local.name)}var t=this._year!==e._year?this._year-e._year:this._month!==e._month?this.monthOfYear()-e.monthOfYear():this._day-e._day;return t===0?0:t<0?-1:+1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(e){return this._calendar.fromJD(e)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(e){return this._calendar.fromJSDate(e)},toString:function(){return(this.year()<0?"-":"")+o(Math.abs(this.year()),4)+"-"+o(this.month(),2)+"-"+o(this.day(),2)}});function s(){this.shortYearCutoff="+10"}n(s.prototype,{_validateLevel:0,newDate:function(e,t,r){if(e==null){return this.today()}if(e.year){this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);r=e.day();t=e.month();e=e.year()}return new i(this,e,t,r)},today:function(){return this.fromJSDate(new Date)},epoch:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+o(Math.abs(t.year()),4)},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return 12},monthOfYear:function(e,t){var r=this._validate(e,t,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return(r.month()+this.monthsInYear(r)-this.firstMonth)%this.monthsInYear(r)+this.minMonth},fromMonthOfYear:function(e,t){var r=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(e)+this.minMonth;this._validate(e,r,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return r},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(e,t,r){var n=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return n.toJD()-this.newDate(n.year(),this.fromMonthOfYear(n.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(e,t,r){var n=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(n))+2)%this.daysInWeek()},extraInfo:function(e,t,r){this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return{}},add:function(e,t,r){this._validate(e,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);return this._correctAdd(e,this._add(e,t,r),t,r)},_add:function(e,t,r){this._validateLevel++;if(r==="d"||r==="w"){var n=e.toJD()+t*(r==="w"?this.daysInWeek():1);var a=e.calendar().fromJD(n);this._validateLevel--;return[a.year(),a.month(),a.day()]}try{var i=e.year()+(r==="y"?t:0);var o=e.monthOfYear()+(r==="m"?t:0);var a=e.day();var s=function(e){while(o<e.minMonth){i--;o+=e.monthsInYear(i)}var t=e.monthsInYear(i);while(o>t-1+e.minMonth){i++;o-=t;t=e.monthsInYear(i)}};if(r==="y"){if(e.month()!==this.fromMonthOfYear(i,o)){o=this.newDate(i,e.month(),this.minDay).monthOfYear()}o=Math.min(o,this.monthsInYear(i));a=Math.min(a,this.daysInMonth(i,this.fromMonthOfYear(i,o)))}else if(r==="m"){s(this);a=Math.min(a,this.daysInMonth(i,this.fromMonthOfYear(i,o)))}var l=[i,this.fromMonthOfYear(i,o),a];this._validateLevel--;return l}catch(e){this._validateLevel--;throw e}},_correctAdd:function(e,t,r,n){if(!this.hasYearZero&&(n==="y"||n==="m")){if(t[0]===0||e.year()>0!==t[0]>0){var a={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[n];var i=r<0?-1:+1;t=this._add(e,r*a[0]+i*a[1],a[2])}}return e.date(t[0],t[1],t[2])},set:function(e,t,r){this._validate(e,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);var n=r==="y"?t:e.year();var a=r==="m"?t:e.month();var i=r==="d"?t:e.day();if(r==="y"||r==="m"){i=Math.min(i,this.daysInMonth(n,a))}return e.date(n,a,i)},isValid:function(e,t,r){this._validateLevel++;var n=this.hasYearZero||e!==0;if(n){var a=this.newDate(e,t,this.minDay);n=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(a)&&(r>=this.minDay&&r-this.minDay<this.daysInMonth(a))}this._validateLevel--;return n},toJSDate:function(e,t,r){var n=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return u.instance().fromJD(this.toJD(n)).toJSDate()},fromJSDate:function(e){return this.fromJD(u.instance().fromJSDate(e).toJD())},_validate:function(e,t,r,n){if(e.year){if(this._validateLevel===0&&this.name!==e.calendar().name){throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,e.calendar().local.name)}return e}try{this._validateLevel++;if(this._validateLevel===1&&!this.isValid(e,t,r)){throw n.replace(/\{0\}/,this.local.name)}var a=this.newDate(e,t,r);this._validateLevel--;return a}catch(e){this._validateLevel--;throw e}}});function l(e){this.local=this.regionalOptions[e]||this.regionalOptions[""]}l.prototype=new s;n(l.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);var e=t.year()+(t.year()<0?1:0);return e%4===0&&(e%100!==0||e%400===0)},weekOfYear:function(e,t,r){var n=this.newDate(e,t,r);n.add(4-(n.dayOfWeek()||7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);e=n.year();t=n.month();r=n.day();if(e<0){e++}if(t<3){t+=12;e--}var a=Math.floor(e/100);var i=2-a+Math.floor(a/4);return Math.floor(365.25*(e+4716))+Math.floor(30.6001*(t+1))+r+i-1524.5},fromJD:function(e){var t=Math.floor(e+.5);var r=Math.floor((t-1867216.25)/36524.25);r=t+1+r-Math.floor(r/4);var n=r+1524;var a=Math.floor((n-122.1)/365.25);var i=Math.floor(365.25*a);var o=Math.floor((n-i)/30.6001);var s=n-i-Math.floor(o*30.6001);var l=o-(o>13.5?13:1);var u=a-(l>2.5?4716:4715);if(u<=0){u--}return this.newDate(u,l,s)},toJSDate:function(e,t,r){var n=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);var a=new Date(n.year(),n.month()-1,n.day());a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);a.setHours(a.getHours()>12?a.getHours()+2:0);return a},fromJSDate:function(e){return this.newDate(e.getFullYear(),e.getMonth()+1,e.getDate())}});var u=t.exports=new a;u.cdate=i;u.baseCalendar=s;u.calendars.gregorian=l},{"object-assign":499}],622:[function(e,t,r){var n=e("object-assign");var a=e("./main");n(a.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"});a.local=a.regionalOptions[""];n(a.cdate.prototype,{formatDate:function(e,t){if(typeof e!=="string"){t=e;e=""}return this._calendar.formatDate(e||"",this,t)}});n(a.baseCalendar.prototype,{UNIX_EPOCH:a.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:a.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(e,t,r){if(typeof e!=="string"){r=t;t=e;e=""}if(!t){return""}if(t.calendar()!==this){throw a.local.invalidFormat||a.regionalOptions[""].invalidFormat}e=e||this.local.dateFormat;r=r||{};var n=r.dayNamesShort||this.local.dayNamesShort;var i=r.dayNames||this.local.dayNames;var o=r.monthNumbers||this.local.monthNumbers;var s=r.monthNamesShort||this.local.monthNamesShort;var l=r.monthNames||this.local.monthNames;var u=r.calculateWeek||this.local.calculateWeek;var c=function(t,r){var n=1;while(_+n<e.length&&e.charAt(_+n)===t){n++}_+=n-1;return Math.floor(n/(r||1))>1};var f=function(e,t,r,n){var a=""+t;if(c(e,n)){while(a.length<r){a="0"+a}}return a};var h=function(e,t,r,n){return c(e)?n[t]:r[t]};var p=this;var d=function(e){return typeof o==="function"?o.call(p,e,c("m")):g(f("m",e.month(),2))};var v=function(e,t){if(t){return typeof l==="function"?l.call(p,e):l[e.month()-p.minMonth]}else{return typeof s==="function"?s.call(p,e):s[e.month()-p.minMonth]}};var m=this.local.digits;var g=function(e){return r.localNumbers&&m?m(e):e};var y="";var x=false;for(var _=0;_<e.length;_++){if(x){if(e.charAt(_)==="'"&&!c("'")){x=false}else{y+=e.charAt(_)}}else{switch(e.charAt(_)){case"d":y+=g(f("d",t.day(),2));break;case"D":y+=h("D",t.dayOfWeek(),n,i);break;case"o":y+=f("o",t.dayOfYear(),3);break;case"w":y+=f("w",t.weekOfYear(),2);break;case"m":y+=d(t);break;case"M":y+=v(t,c("M"));break;case"y":y+=c("y",2)?t.year():(t.year()%100<10?"0":"")+t.year()%100;break;case"Y":c("Y",2);y+=t.formatYear();break;case"J":y+=t.toJD();break;case"@":y+=(t.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":y+=(t.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":if(c("'")){y+="'"}else{x=true}break;default:y+=e.charAt(_)}}}return y},parseDate:function(e,t,r){if(t==null){throw a.local.invalidArguments||a.regionalOptions[""].invalidArguments}t=typeof t==="object"?t.toString():t+"";if(t===""){return null}e=e||this.local.dateFormat;r=r||{};var n=r.shortYearCutoff||this.shortYearCutoff;n=typeof n!=="string"?n:this.today().year()%100+parseInt(n,10);var i=r.dayNamesShort||this.local.dayNamesShort;var o=r.dayNames||this.local.dayNames;var s=r.parseMonth||this.local.parseMonth;var l=r.monthNumbers||this.local.monthNumbers;var u=r.monthNamesShort||this.local.monthNamesShort;var c=r.monthNames||this.local.monthNames;var f=-1;var h=-1;var p=-1;var d=-1;var v=-1;var m=false;var g=false;var y=function(t,r){var n=1;while(M+n<e.length&&e.charAt(M+n)===t){n++}M+=n-1;return Math.floor(n/(r||1))>1};var x=function(e,r){var n=y(e,r);var i=[2,3,n?4:2,n?4:2,10,11,20]["oyYJ@!".indexOf(e)+1];var o=new RegExp("^-?\\d{1,"+i+"}");var s=t.substring(A).match(o);if(!s){throw(a.local.missingNumberAt||a.regionalOptions[""].missingNumberAt).replace(/\{0\}/,A)}A+=s[0].length;return parseInt(s[0],10)};var _=this;var b=function(){if(typeof l==="function"){y("m");var e=l.call(_,t.substring(A));A+=e.length;return e}return x("m")};var w=function(e,r,n,i){var o=y(e,i)?n:r;for(var s=0;s<o.length;s++){if(t.substr(A,o[s].length).toLowerCase()===o[s].toLowerCase()){A+=o[s].length;return s+_.minMonth}}throw(a.local.unknownNameAt||a.regionalOptions[""].unknownNameAt).replace(/\{0\}/,A)};var T=function(){if(typeof c==="function"){var e=y("M")?c.call(_,t.substring(A)):u.call(_,t.substring(A));A+=e.length;return e}return w("M",u,c)};var k=function(){if(t.charAt(A)!==e.charAt(M)){throw(a.local.unexpectedLiteralAt||a.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,A)}A++};var A=0;for(var M=0;M<e.length;M++){if(g){if(e.charAt(M)==="'"&&!y("'")){g=false}else{k()}}else{switch(e.charAt(M)){case"d":d=x("d");break;case"D":w("D",i,o);break;case"o":v=x("o");break;case"w":x("w");break;case"m":p=b();break;case"M":p=T();break;case"y":var E=M;m=!y("y",2);M=E;h=x("y",2);break;case"Y":h=x("Y",2);break;case"J":f=x("J")+.5;if(t.charAt(A)==="."){A++;x("J")}break;case"@":f=x("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":f=x("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":A=t.length;break;case"'":if(y("'")){k()}else{g=true}break;default:k()}}}if(A<t.length){throw a.local.unexpectedText||a.regionalOptions[""].unexpectedText}if(h===-1){h=this.today().year()}else if(h<100&&m){h+=n===-1?1900:this.today().year()-this.today().year()%100-(h<=n?0:100)}if(typeof p==="string"){p=s.call(this,h,p)}if(v>-1){p=1;d=v;for(var S=this.daysInMonth(h,p);d>S;S=this.daysInMonth(h,p)){p++;d-=S}}return f>-1?this.fromJD(f):this.newDate(h,p,d)},determineDate:function(e,t,r,n,a){if(r&&typeof r!=="object"){a=n;n=r;r=null}if(typeof n!=="string"){a=n;n=""}var i=this;var o=function(e){try{return i.parseDate(n,e,a)}catch(e){}e=e.toLowerCase();var t=(e.match(/^c/)&&r?r.newDate():null)||i.today();var o=/([+-]?[0-9]+)\s*(d|w|m|y)?/g;var s=o.exec(e);while(s){t.add(parseInt(s[1],10),s[2]||"d");s=o.exec(e)}return t};t=t?t.newDate():null;e=e==null?t:typeof e==="string"?o(e):typeof e==="number"?isNaN(e)||e===Infinity||e===-Infinity?t:i.today().add(e,"d"):i.newDate(e);return e}})},{"./main":621,"object-assign":499}],623:[function(e,t,r){t.exports=e("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg3_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":151}],624:[function(e,t,r){"use strict";t.exports=a;var n=e("./lib/zc-core");function a(e,t){var r=[];t=+t||0;n(e.hi(e.shape[0]-1),r,t);return r}},{"./lib/zc-core":623}],625:[function(e,t,r){"use strict";t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:true},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:true}]},{}],626:[function(e,t,r){"use strict";var n=e("./arrow_paths");var a=e("../../plots/font_attributes");var i=e("../../plots/cartesian/constants");var o=e("../../plot_api/plot_template").templatedArray;var s=e("../../constants/axis_placeable_objects");function l(e){return["In order for absolute positioning of the arrow to work, *a"+e+"ref* must be exactly the same as *"+e+"ref*, otherwise *a"+e+"ref* will revert to *pixel* (explained next).","For relative positioning, *a"+e+"ref* can be set to *pixel*,","in which case the *a"+e+"* value is specified in pixels","relative to *"+e+"*.","Absolute positioning is useful","for trendline annotations which should continue to indicate","the correct trend when zoomed. Relative positioning is useful","for specifying the text offset for an annotated point."].join(" ")}function u(e,t,r){return["Sets the",e,"component of the arrow tail about the arrow head.","If `a"+e+"ref` is `pixel`, a positive (negative)","component corresponds to an arrow pointing","from",r,"to",t,"("+t,"to",r+").","If `a"+e+"ref` is not `pixel` and is exactly the same as `"+e+"ref`,","this is an absolute value on that axis,","like `"+e+"`, specified in the same coordinates as `"+e+"ref`."].join(" ")}t.exports=o("annotation",{visible:{valType:"boolean",dflt:true,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:a({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:true,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",i.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",i.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[false,"onoff","onout"],dflt:false,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:a({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":746,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/font_attributes":856,"./arrow_paths":625}],627:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("./draw").draw;t.exports=function e(t){var r=t._fullLayout;var a=n.filterVisible(r.annotations);if(a.length&&t._fullData.length){return n.syncOrAsync([i,o],t)}};function o(e){var t=e._fullLayout;n.filterVisible(t.annotations).forEach(function(t){var r=a.getFromId(e,t.xref);var n=a.getFromId(e,t.yref);var i=a.getRefType(t.xref);var o=a.getRefType(t.yref);t._extremes={};if(i==="range")s(t,r);if(o==="range")s(t,n)})}function s(e,t){var r=t._id;var n=r.charAt(0);var i=e[n];var o=e["a"+n];var s=e[n+"ref"];var l=e["a"+n+"ref"];var u=e["_"+n+"padplus"];var c=e["_"+n+"padminus"];var f={x:1,y:-1}[n]*e[n+"shift"];var h=3*e.arrowsize*e.arrowwidth||0;var p=h+f;var d=h-f;var v=3*e.startarrowsize*e.arrowwidth||0;var m=v+f;var g=v-f;var y;if(l===s){var x=a.findExtremes(t,[t.r2c(i)],{ppadplus:p,ppadminus:d});var _=a.findExtremes(t,[t.r2c(o)],{ppadplus:Math.max(u,m),ppadminus:Math.max(c,g)});y={min:[x.min[0],_.min[0]],max:[x.max[0],_.max[0]]}}else{m=o?m+o:m;g=o?g-o:g;y=a.findExtremes(t,[t.r2c(i)],{ppadplus:Math.max(u,p,m),ppadminus:Math.max(c,d,g)})}e._extremes[r]=y}},{"../../lib":778,"../../plots/cartesian/axes":828,"./draw":632}],628:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");var i=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:o,onClick:s};function o(e,t){var r=l(e,t);return r.on.length>0||r.explicitOff.length>0}function s(e,t){var r=l(e,t);var o=r.on;var s=r.off.concat(r.explicitOff);var u={};var c=e._fullLayout.annotations;var f,h;if(!(o.length||s.length))return;for(f=0;f<o.length;f++){h=i(e.layout,"annotations",c[o[f]]);h.modifyItem("visible",true);n.extendFlat(u,h.getUpdateObj())}for(f=0;f<s.length;f++){h=i(e.layout,"annotations",c[s[f]]);h.modifyItem("visible",false);n.extendFlat(u,h.getUpdateObj())}return a.call("update",e,{},u)}function l(e,t){var r=e._fullLayout.annotations;var n=[];var a=[];var i=[];var o=(t||[]).length;var s,l,c,f,h,p,d,v;for(s=0;s<r.length;s++){c=r[s];f=c.clicktoshow;if(f){for(l=0;l<o;l++){h=t[l];p=h.xaxis;d=h.yaxis;if(p._id===c.xref&&d._id===c.yref&&p.d2r(h.x)===u(c._xclick,p)&&d.d2r(h.y)===u(c._yclick,d)){if(c.visible){if(f==="onout")v=a;else v=i}else{v=n}v.push(s);break}}if(l===o){if(c.visible&&f==="onout")a.push(s)}}}return{on:n,off:a,explicitOff:i}}function u(e,t){return t.type==="log"?t.l2r(e):t.d2r(e)}},{"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911}],629:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../color");t.exports=function e(t,r,i,o){o("opacity");var s=o("bgcolor");var l=o("bordercolor");var u=a.opacity(l);o("borderpad");var c=o("borderwidth");var f=o("showarrow");o("text",f?" ":i._dfltTitle.annotation);o("textangle");n.coerceFont(o,"font",i.font);o("width");o("align");var h=o("height");if(h)o("valign");if(f){var p=o("arrowside");var d;var v;if(p.indexOf("end")!==-1){d=o("arrowhead");v=o("arrowsize")}if(p.indexOf("start")!==-1){o("startarrowhead",d);o("startarrowsize",v)}o("arrowcolor",u?r.bordercolor:a.defaultLine);o("arrowwidth",(u&&c||1)*2);o("standoff");o("startstandoff")}var m=o("hovertext");var g=i.hoverlabel||{};if(m){var y=o("hoverlabel.bgcolor",g.bgcolor||(a.opacity(s)?a.rgb(s):a.defaultLine));var x=o("hoverlabel.bordercolor",g.bordercolor||a.contrast(y));n.coerceFont(o,"hoverlabel.font",{family:g.font.family,size:g.font.size,color:g.font.color||x})}o("captureevents",!!m)}},{"../../lib":778,"../color":643}],630:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib/to_log_range");t.exports=function e(t,r,i,o){r=r||{};var s=i==="log"&&r.type==="linear";var l=i==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.annotations;var c=r._id.charAt(0);var f;var h;function p(e){var t=f[e];var i=null;if(s)i=a(t,r.range);else i=Math.pow(10,t);if(!n(i))i=null;o(h+e,i)}for(var d=0;d<u.length;d++){f=u[d];h="annotations["+d+"].";if(f[c+"ref"]===r._id)p(c);if(f["a"+c+"ref"]===r._id)p("a"+c)}}},{"../../lib/to_log_range":805,"fast-isnumeric":241}],631:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("./common_defaults");var s=e("./attributes");t.exports=function e(t,r){i(t,r,{name:"annotations",handleItemDefaults:l})};function l(e,t,r){function i(r,a){return n.coerce(e,t,s,r,a)}var l=i("visible");var u=i("clicktoshow");if(!(l||u))return;o(e,t,r,i);var c=t.showarrow;var f=["x","y"];var h=[-10,-30];var p={_fullLayout:r};for(var d=0;d<2;d++){var v=f[d];var m=a.coerceRef(e,t,p,v,"","paper");if(m!=="paper"){var g=a.getFromId(p,m);g._annIndices.push(t._index)}a.coercePosition(t,p,i,m,v,.5);if(c){var y="a"+v;var x=a.coerceRef(e,t,p,y,"pixel",["pixel","paper"]);if(x!=="pixel"&&x!==m){x=t[y]="pixel"}var _=x==="pixel"?h[d]:.4;a.coercePosition(t,p,i,x,y,_)}i(v+"anchor");i(v+"shift")}n.noneOrAll(e,t,["x","y"]);if(c){n.noneOrAll(e,t,["ax","ay"])}if(u){var b=i("xclick");var w=i("yclick");t._xclick=b===undefined?t.x:a.cleanPosition(b,p,t.xref);t._yclick=w===undefined?t.y:a.cleanPosition(w,p,t.yref)}}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":626,"./common_defaults":629}],632:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../plots/plots");var o=e("../../lib");var s=o.strTranslate;var l=e("../../plots/cartesian/axes");var u=e("../color");var c=e("../drawing");var f=e("../fx");var h=e("../../lib/svg_text_utils");var p=e("../../lib/setcursor");var d=e("../dragelement");var v=e("../../plot_api/plot_template").arrayEditor;var m=e("./draw_arrow_head");t.exports={draw:g,drawOne:y,drawRaw:_};function g(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var r=0;r<t.annotations.length;r++){if(t.annotations[r].visible){y(e,r)}}return i.previousPromises(e)}function y(e,t){var r=e._fullLayout;var n=r.annotations[t]||{};var a=l.getFromId(e,n.xref);var i=l.getFromId(e,n.yref);if(a)a.setScale();if(i)i.setScale();_(e,n,t,false,a,i)}function x(e,t,r,n,a){var i=a[r];var o=a[r+"ref"];var s=r.indexOf("y")!==-1;var u=l.getRefType(o)==="domain";var c=s?n.h:n.w;if(e){if(u){return i+(s?-t:t)/e._length}else{return e.p2r(e.r2p(i)+t)}}else{return i+(s?-t:t)/c}}function _(e,t,r,i,g,y){var _=e._fullLayout;var b=e._fullLayout._size;var w=e._context.edits;var T,k;if(i){T="annotation-"+i;k=i+".annotations"}else{T="annotation";k="annotations"}var A=v(e.layout,k,t);var M=A.modifyBase;var E=A.modifyItem;var S=A.getUpdateObj;_._infolayer.selectAll("."+T+'[data-index="'+r+'"]').remove();var C="clip"+_._uid+"_ann"+r;if(!t._input||t.visible===false){n.selectAll("#"+C).remove();return}var L={x:{},y:{}};var I=+t.textangle||0;var O=_._infolayer.append("g").classed(T,true).attr("data-index",String(r)).style("opacity",t.opacity);var P=O.append("g").classed("annotation-text-g",true);var D=w[t.showarrow?"annotationTail":"annotationPosition"];var R=t.captureevents||w.annotationText||D;function z(e){var n={index:r,annotation:t._input,fullAnnotation:t,event:e};if(i){n.subplotId=i}return n}var N=P.append("g").style("pointer-events",R?"all":null).call(p,"pointer").on("click",function(){e._dragging=false;e.emit("plotly_clickannotation",z(n.event))});if(t.hovertext){N.on("mouseover",function(){var r=t.hoverlabel;var n=r.font;var a=this.getBoundingClientRect();var i=e.getBoundingClientRect();f.loneHover({x0:a.left-i.left,x1:a.right-i.left,y:(a.top+a.bottom)/2-i.top,text:t.hovertext,color:r.bgcolor,borderColor:r.bordercolor,fontFamily:n.family,fontSize:n.size,fontColor:n.color},{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:e})}).on("mouseout",function(){f.loneUnhover(_._hoverlayer.node())})}var F=t.borderwidth;var B=t.borderpad;var j=F+B;var U=N.append("rect").attr("class","bg").style("stroke-width",F+"px").call(u.stroke,t.bordercolor).call(u.fill,t.bgcolor);var H=t.width||t.height;var V=_._topclips.selectAll("#"+C).data(H?[0]:[]);V.enter().append("clipPath").classed("annclip",true).attr("id",C).append("rect");V.exit().remove();var G=t.font;var q=_._meta?o.templateString(t.text,_._meta):t.text;var Y=N.append("text").classed("annotation-text",true).text(q);function W(r){r.call(c.font,G).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"});h.convertToTspans(r,e,X);return r}function X(){var r=Y.selectAll("a");if(r.size()===1&&r.text()===Y.text()){var n=N.insert("a",":first-child").attr({"xlink:xlink:href":r.attr("xlink:href"),"xlink:xlink:show":r.attr("xlink:show")}).style({cursor:"pointer"});n.node().appendChild(U.node())}var f=N.select(".annotation-text-math-group");var v=!f.empty();var T=c.bBox((v?f:Y).node());var k=T.width;var A=T.height;var R=t.width||k;var B=t.height||A;var G=Math.round(R+2*j);var q=Math.round(B+2*j);function W(e,t){if(t==="auto"){if(e<1/3)t="left";else if(e>2/3)t="right";else t="center"}return{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var X=false;var Z=["x","y"];for(var K=0;K<Z.length;K++){var J=Z[K];var Q=t[J+"ref"]||J;var $=t["a"+J+"ref"];var ee={x:g,y:y}[J];var te=(I+(J==="x"?0:-90))*Math.PI/180;var re=G*Math.cos(te);var ne=q*Math.sin(te);var ae=Math.abs(re)+Math.abs(ne);var ie=t[J+"anchor"];var oe=t[J+"shift"]*(J==="x"?1:-1);var se=L[J];var le;var ue;var ce;var fe;var he;var pe=l.getRefType(Q);if(ee&&pe!=="domain"){var de=ee.r2fraction(t[J]);if(de<0||de>1){if($===Q){de=ee.r2fraction(t["a"+J]);if(de<0||de>1){X=true}}else{X=true}}le=ee._offset+ee.r2p(t[J]);fe=.5}else{var ve=pe==="domain";if(J==="x"){ce=t[J];le=ve?ee._offset+ee._length*ce:le=b.l+b.w*ce}else{ce=1-t[J];le=ve?ee._offset+ee._length*ce:le=b.t+b.h*ce}fe=t.showarrow?.5:ce}if(t.showarrow){se.head=le;var me=t["a"+J];he=re*W(.5,t.xanchor)-ne*W(.5,t.yanchor);if($===Q){var ge=l.getRefType($);if(ge==="domain"){if(J==="y"){me=1-me}se.tail=ee._offset+ee._length*me}else if(ge==="paper"){if(J==="y"){me=1-me;se.tail=b.t+b.h*me}else{se.tail=b.l+b.w*me}}else{se.tail=ee._offset+ee.r2p(me)}ue=he}else{se.tail=le+me;ue=he+me}se.text=se.tail+he;var ye=_[J==="x"?"width":"height"];if(Q==="paper"){se.head=o.constrain(se.head,1,ye-1)}if($==="pixel"){var xe=-Math.max(se.tail-3,se.text);var _e=Math.min(se.tail+3,se.text)-ye;if(xe>0){se.tail+=xe;se.text+=xe}else if(_e>0){se.tail-=_e;se.text-=_e}}se.tail+=oe;se.head+=oe}else{he=ae*W(fe,ie);ue=he;se.text=le+he}se.text+=oe;he+=oe;ue+=oe;t["_"+J+"padplus"]=ae/2+ue;t["_"+J+"padminus"]=ae/2-ue;t["_"+J+"size"]=ae;t["_"+J+"shift"]=he}if(X){N.remove();return}var be=0;var we=0;if(t.align!=="left"){be=(R-k)*(t.align==="center"?.5:1)}if(t.valign!=="top"){we=(B-A)*(t.valign==="middle"?.5:1)}if(v){f.select("svg").attr({x:j+be-1,y:j+we}).call(c.setClipUrl,H?C:null,e)}else{var Te=j+we-T.top;var ke=j+be-T.left;Y.call(h.positionText,ke,Te).call(c.setClipUrl,H?C:null,e)}V.select("rect").call(c.setRect,j,j,R,B);U.call(c.setRect,F/2,F/2,G-F,q-F);N.call(c.setTranslate,Math.round(L.x.text-G/2),Math.round(L.y.text-q/2));P.attr({transform:"rotate("+I+","+L.x.text+","+L.y.text+")"});var Ae=function(r,n){O.selectAll(".annotation-arrow-g").remove();var l=L.x.head;var f=L.y.head;var h=L.x.tail+r;var p=L.y.tail+n;var v=L.x.text+r;var _=L.y.text+n;var T=o.rotationXYMatrix(I,v,_);var k=o.apply2DTransform(T);var A=o.apply2DTransform2(T);var C=+U.attr("width");var D=+U.attr("height");var R=v-.5*C;var z=R+C;var F=_-.5*D;var B=F+D;var j=[[R,F,R,B],[R,B,z,B],[z,B,z,F],[z,F,R,F]].map(A);if(j.reduce(function(e,t){return e^!!o.segmentsIntersect(l,f,l+1e6,f+1e6,t[0],t[1],t[2],t[3])},false)){return}j.forEach(function(e){var t=o.segmentsIntersect(h,p,l,f,e[0],e[1],e[2],e[3]);if(t){h=t.x;p=t.y}});var H=t.arrowwidth;var V=t.arrowcolor;var G=t.arrowside;var q=O.append("g").style({opacity:u.opacity(V)}).classed("annotation-arrow-g",true);var Y=q.append("path").attr("d","M"+h+","+p+"L"+l+","+f).style("stroke-width",H+"px").call(u.stroke,u.rgb(V));m(Y,G,t);if(w.annotationPosition&&Y.node().parentNode&&!i){var W=l;var X=f;if(t.standoff){var Z=Math.sqrt(Math.pow(l-h,2)+Math.pow(f-p,2));W+=t.standoff*(h-l)/Z;X+=t.standoff*(p-f)/Z}var K=q.append("path").classed("annotation-arrow",true).classed("anndrag",true).classed("cursor-move",true).attr({d:"M3,3H-3V-3H3ZM0,0L"+(h-W)+","+(p-X),transform:s(W,X)}).style("stroke-width",H+6+"px").call(u.stroke,"rgba(0,0,0,0)").call(u.fill,"rgba(0,0,0,0)");var J,Q;d.init({element:K.node(),gd:e,prepFn:function(){var e=c.getTranslate(N);J=e.x;Q=e.y;if(g&&g.autorange){M(g._name+".autorange",true)}if(y&&y.autorange){M(y._name+".autorange",true)}},moveFn:function(e,r){var n=k(J,Q);var a=n[0]+e;var i=n[1]+r;N.call(c.setTranslate,a,i);E("x",x(g,e,"x",b,t));E("y",x(y,r,"y",b,t));if(t.axref===t.xref){E("ax",x(g,e,"ax",b,t))}if(t.ayref===t.yref){E("ay",x(y,r,"ay",b,t))}q.attr("transform",s(e,r));P.attr({transform:"rotate("+I+","+a+","+i+")"})},doneFn:function(){a.call("_guiRelayout",e,S());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}};if(t.showarrow)Ae(0,0);if(D){var Me;d.init({element:N.node(),gd:e,prepFn:function(){Me=P.attr("transform")},moveFn:function(e,r){var n="pointer";if(t.showarrow){if(t.axref===t.xref){E("ax",x(g,e,"ax",b,t))}else{E("ax",t.ax+e)}if(t.ayref===t.yref){E("ay",x(y,r,"ay",b.w,t))}else{E("ay",t.ay+r)}Ae(e,r)}else if(!i){var a,o;if(g){a=x(g,e,"x",b,t)}else{var l=t._xsize/b.w;var u=t.x+(t._xshift-t.xshift)/b.w-l/2;a=d.align(u+e/b.w,l,0,1,t.xanchor)}if(y){o=x(y,r,"y",b,t)}else{var c=t._ysize/b.h;var f=t.y-(t._yshift+t.yshift)/b.h-c/2;o=d.align(f-r/b.h,c,0,1,t.yanchor)}E("x",a);E("y",o);if(!g||!y){n=d.getCursor(g?.5:a,y?.5:o,t.xanchor,t.yanchor)}}else return;P.attr({transform:s(e,r)+Me});p(N,n)},clickFn:function(r,n){if(t.captureevents){e.emit("plotly_clickannotation",z(n))}},doneFn:function(){p(N);a.call("_guiRelayout",e,S());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}}if(w.annotationText){Y.call(h.makeEditable,{delegate:N,gd:e}).call(W).on("edit",function(r){t.text=r;this.call(W);E("text",r);if(g&&g.autorange){M(g._name+".autorange",true)}if(y&&y.autorange){M(y._name+".autorange",true)}a.call("_guiRelayout",e,S())})}else Y.call(W)}},{"../../lib":778,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/cartesian/axes":828,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../fx":683,"./draw_arrow_head":633,d3:169}],633:[function(e,t,r){"use strict";var n=e("d3");var a=e("../color");var i=e("./arrow_paths");var o=e("../../lib");var s=o.strScale;var l=o.strRotate;var u=o.strTranslate;t.exports=function e(t,r,o){var c=t.node();var f=i[o.arrowhead||0];var h=i[o.startarrowhead||0];var p=(o.arrowwidth||1)*(o.arrowsize||1);var d=(o.arrowwidth||1)*(o.startarrowsize||1);var v=r.indexOf("start")>=0;var m=r.indexOf("end")>=0;var g=f.backoff*p+o.standoff;var y=h.backoff*d+o.startstandoff;var x,_,b,w;if(c.nodeName==="line"){x={x:+t.attr("x1"),y:+t.attr("y1")};_={x:+t.attr("x2"),y:+t.attr("y2")};var T=x.x-_.x;var k=x.y-_.y;b=Math.atan2(k,T);w=b+Math.PI;if(g&&y){if(g+y>Math.sqrt(T*T+k*k)){z();return}}if(g){if(g*g>T*T+k*k){z();return}var A=g*Math.cos(b);var M=g*Math.sin(b);_.x+=A;_.y+=M;t.attr({x2:_.x,y2:_.y})}if(y){if(y*y>T*T+k*k){z();return}var E=y*Math.cos(b);var S=y*Math.sin(b);x.x-=E;x.y-=S;t.attr({x1:x.x,y1:x.y})}}else if(c.nodeName==="path"){var C=c.getTotalLength();var L="";if(C<g+y){z();return}var I=c.getPointAtLength(0);var O=c.getPointAtLength(.1);b=Math.atan2(I.y-O.y,I.x-O.x);x=c.getPointAtLength(Math.min(y,C));L="0px,"+y+"px,";var P=c.getPointAtLength(C);var D=c.getPointAtLength(C-.1);w=Math.atan2(P.y-D.y,P.x-D.x);_=c.getPointAtLength(Math.max(0,C-g));var R=L?y+g:g;L+=C-R+"px,"+C+"px";t.style("stroke-dasharray",L)}function z(){t.style("stroke-dasharray","0px,100px")}function N(e,r,i,f){if(!e.path)return;if(e.noRotate)i=0;n.select(c.parentNode).append("path").attr({class:t.attr("class"),d:e.path,transform:u(r.x,r.y)+l(i*180/Math.PI)+s(f)}).style({fill:a.rgb(o.arrowcolor),"stroke-width":0})}if(v)N(h,x,b,d);if(m)N(f,_,w,p)}},{"../../lib":778,"../color":643,"./arrow_paths":625,d3:169}],634:[function(e,t,r){"use strict";var n=e("./draw");var a=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:n.draw,drawOne:n.drawOne,drawRaw:n.drawRaw,hasClickToShow:a.hasClickToShow,onClick:a.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":840,"./attributes":626,"./calc_autorange":627,"./click":628,"./convert_coords":630,"./defaults":631,"./draw":632}],635:[function(e,t,r){"use strict";var n=e("../annotations/attributes");var a=e("../../plot_api/edit_types").overrideAll;var i=e("../../plot_api/plot_template").templatedArray;t.exports=a(i("annotation",{visible:n.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:n.xanchor,xshift:n.xshift,yanchor:n.yanchor,yshift:n.yshift,text:n.text,textangle:n.textangle,font:n.font,width:n.width,height:n.height,opacity:n.opacity,align:n.align,valign:n.valign,bgcolor:n.bgcolor,bordercolor:n.bordercolor,borderpad:n.borderpad,borderwidth:n.borderwidth,showarrow:n.showarrow,arrowcolor:n.arrowcolor,arrowhead:n.arrowhead,startarrowhead:n.startarrowhead,arrowside:n.arrowside,arrowsize:n.arrowsize,startarrowsize:n.startarrowsize,arrowwidth:n.arrowwidth,standoff:n.standoff,startstandoff:n.startstandoff,hovertext:n.hovertext,hoverlabel:n.hoverlabel,captureevents:n.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../annotations/attributes":626}],636:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");t.exports=function e(t){var r=t.fullSceneLayout;var n=r.annotations;for(var a=0;a<n.length;a++){i(n[a],t)}t.fullLayout._infolayer.selectAll(".annotation-"+t.id).remove()};function i(e,t){var r=t.fullSceneLayout;var i=r.domain;var o=t.fullLayout._size;var s={pdata:null,type:"linear",autorange:false,range:[-Infinity,Infinity]};e._xa={};n.extendFlat(e._xa,s);a.setConvert(e._xa);e._xa._offset=o.l+i.x[0]*o.w;e._xa.l2p=function(){return.5*(1+e._pdata[0]/e._pdata[3])*o.w*(i.x[1]-i.x[0])};e._ya={};n.extendFlat(e._ya,s);a.setConvert(e._ya);e._ya._offset=o.t+(1-i.y[1])*o.h;e._ya.l2p=function(){return.5*(1-e._pdata[1]/e._pdata[3])*o.h*(i.y[1]-i.y[0])}}},{"../../lib":778,"../../plots/cartesian/axes":828}],637:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("../annotations/common_defaults");var s=e("./attributes");t.exports=function e(t,r,n){i(t,r,{name:"annotations",handleItemDefaults:l,fullLayout:n.fullLayout})};function l(e,t,r,i){function l(r,a){return n.coerce(e,t,s,r,a)}function u(e){var n=e+"axis";var i={_fullLayout:{}};i._fullLayout[n]=r[n];return a.coercePosition(t,i,l,e,e,.5)}var c=l("visible");if(!c)return;o(e,t,i.fullLayout,l);u("x");u("y");u("z");n.noneOrAll(e,t,["x","y","z"]);t.xref="x";t.yref="y";t.zref="z";l("xanchor");l("yanchor");l("xshift");l("yshift");if(t.showarrow){t.axref="pixel";t.ayref="pixel";l("ax",-10);l("ay",-30);n.noneOrAll(e,t,["ax","ay"])}}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"../annotations/common_defaults":629,"./attributes":635}],638:[function(e,t,r){"use strict";var n=e("../annotations/draw").drawRaw;var a=e("../../plots/gl3d/project");var i=["x","y","z"];t.exports=function e(t){var r=t.fullSceneLayout;var o=t.dataScale;var s=r.annotations;for(var l=0;l<s.length;l++){var u=s[l];var c=false;for(var f=0;f<3;f++){var h=i[f];var p=u[h];var d=r[h+"axis"];var v=d.r2fraction(p);if(v<0||v>1){c=true;break}}if(c){t.fullLayout._infolayer.select(".annotation-"+t.id+'[data-index="'+l+'"]').remove()}else{u._pdata=a(t.glplot.cameraParams,[r.xaxis.r2l(u.x)*o[0],r.yaxis.r2l(u.y)*o[1],r.zaxis.r2l(u.z)*o[2]]);n(t.graphDiv,u,l,t.id,u._xa,u._ya)}}}},{"../../plots/gl3d/project":879,"../annotations/draw":632}],639:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:i,convert:e("./convert"),draw:e("./draw")};function i(e,t){var r=n.subplotsRegistry.gl3d;if(!r)return;var i=r.attrRegex;var o=Object.keys(e);for(var s=0;s<o.length;s++){var l=o[s];if(i.test(l)&&(e[l].annotations||[]).length){a.pushUnique(t._basePlotModules,r);a.pushUnique(t._subplots.gl3d,l)}}}},{"../../lib":778,"../../registry":911,"./attributes":635,"./convert":636,"./defaults":637,"./draw":638}],640:[function(e,t,r){"use strict";t.exports=e("world-calendars/dist/main");e("world-calendars/dist/plus");e("world-calendars/dist/calendars/chinese");e("world-calendars/dist/calendars/coptic");e("world-calendars/dist/calendars/discworld");e("world-calendars/dist/calendars/ethiopian");e("world-calendars/dist/calendars/hebrew");e("world-calendars/dist/calendars/islamic");e("world-calendars/dist/calendars/julian");e("world-calendars/dist/calendars/mayan");e("world-calendars/dist/calendars/nanakshahi");e("world-calendars/dist/calendars/nepali");e("world-calendars/dist/calendars/persian");e("world-calendars/dist/calendars/taiwan");e("world-calendars/dist/calendars/thai");e("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":607,"world-calendars/dist/calendars/coptic":608,"world-calendars/dist/calendars/discworld":609,"world-calendars/dist/calendars/ethiopian":610,"world-calendars/dist/calendars/hebrew":611,"world-calendars/dist/calendars/islamic":612,"world-calendars/dist/calendars/julian":613,"world-calendars/dist/calendars/mayan":614,"world-calendars/dist/calendars/nanakshahi":615,"world-calendars/dist/calendars/nepali":616,"world-calendars/dist/calendars/persian":617,"world-calendars/dist/calendars/taiwan":618,"world-calendars/dist/calendars/thai":619,"world-calendars/dist/calendars/ummalqura":620,"world-calendars/dist/main":621,"world-calendars/dist/plus":622}],641:[function(e,t,r){"use strict";var n=e("./calendars");var a=e("../../lib");var i=e("../../constants/numerical");var o=i.EPOCHJD;var s=i.ONEDAY;var l={valType:"enumerated",values:Object.keys(n.calendars),editType:"calc",dflt:"gregorian"};var u=function(e,t,r,n){var i={};i[r]=l;return a.coerce(e,t,i,r,n)};var c=function(e,t,r,n){for(var a=0;a<r.length;a++){u(e,t,r[a]+"calendar",n.calendar)}};var f={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"};var h={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"};var p={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]};var d="##";var v={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:d,w:d,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function m(e,t,r){var n=Math.floor((t+.05)/s)+o;var a=y(r).fromJD(n);var i=0;var l,u,c,f,h;while((i=e.indexOf("%",i))!==-1){l=e.charAt(i+1);if(l==="0"||l==="-"||l==="_"){c=3;u=e.charAt(i+2);if(l==="_")l="-"}else{u=l;l="0";c=2}f=v[u];if(!f){i+=c}else{if(f===d)h=d;else h=a.formatDate(f[l]);e=e.substr(0,i)+h+e.substr(i+c);i+=h.length}}return e}var g={};function y(e){var t=g[e];if(t)return t;t=g[e]=n.instance(e);return t}function x(e){return a.extendFlat({},l,{description:e})}function _(e){return"Sets the calendar system to use with `"+e+"` date data."}var b={xcalendar:x(_("x"))};var w=a.extendFlat({},b,{ycalendar:x(_("y"))});var T=a.extendFlat({},w,{zcalendar:x(_("z"))});var k=x(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));t.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:w,bar:w,box:w,heatmap:w,contour:w,histogram:w,histogram2d:w,histogram2dcontour:w,scatter3d:T,surface:T,mesh3d:T,scattergl:w,ohlc:b,candlestick:b},layout:{calendar:x(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:k},yaxis:{calendar:k},scene:{xaxis:{calendar:k},yaxis:{calendar:k},zaxis:{calendar:k}},polar:{radialaxis:{calendar:k}}},transforms:{filter:{valuecalendar:x(["Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:x(["Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:l,handleDefaults:u,handleTraceDefaults:c,CANONICAL_SUNDAY:h,CANONICAL_TICK:f,DFLTRANGE:p,getCal:y,worldCalFmt:m}},{"../../constants/numerical":753,"../../lib":778,"./calendars":640}],642:[function(e,t,r){"use strict";r.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];r.defaultLine="#444";r.lightLine="#eee";r.background="#fff";r.borderLine="#BEC8D9";r.lightFraction=100*(14-4)/(15-4)},{}],643:[function(e,t,r){"use strict";var n=e("tinycolor2");var a=e("fast-isnumeric");var i=t.exports={};var o=e("./attributes");i.defaults=o.defaults;var s=i.defaultLine=o.defaultLine;i.lightLine=o.lightLine;var l=i.background=o.background;i.tinyRGB=function(e){var t=e.toRgb();return"rgb("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+")"};i.rgb=function(e){return i.tinyRGB(n(e))};i.opacity=function(e){return e?n(e).getAlpha():0};i.addOpacity=function(e,t){var r=n(e).toRgb();return"rgba("+Math.round(r.r)+", "+Math.round(r.g)+", "+Math.round(r.b)+", "+t+")"};i.combine=function(e,t){var r=n(e).toRgb();if(r.a===1)return n(e).toRgbString();var a=n(t||l).toRgb();var i=a.a===1?a:{r:255*(1-a.a)+a.r*a.a,g:255*(1-a.a)+a.g*a.a,b:255*(1-a.a)+a.b*a.a};var o={r:i.r*(1-r.a)+r.r*r.a,g:i.g*(1-r.a)+r.g*r.a,b:i.b*(1-r.a)+r.b*r.a};return n(o).toRgbString()};i.contrast=function(e,t,r){var a=n(e);if(a.getAlpha()!==1)a=n(i.combine(e,l));var o=a.isDark()?t?a.lighten(t):l:r?a.darken(r):s;return o.toString()};i.stroke=function(e,t){var r=n(t);e.style({stroke:i.tinyRGB(r),"stroke-opacity":r.getAlpha()})};i.fill=function(e,t){var r=n(t);e.style({fill:i.tinyRGB(r),"fill-opacity":r.getAlpha()})};i.clean=function(e){if(!e||typeof e!=="object")return;var t=Object.keys(e);var r,n,a,o;for(r=0;r<t.length;r++){a=t[r];o=e[a];if(a.substr(a.length-5)==="color"){if(Array.isArray(o)){for(n=0;n<o.length;n++)o[n]=u(o[n])}else e[a]=u(o)}else if(a.substr(a.length-10)==="colorscale"&&Array.isArray(o)){for(n=0;n<o.length;n++){if(Array.isArray(o[n]))o[n][1]=u(o[n][1])}}else if(Array.isArray(o)){var s=o[0];if(!Array.isArray(s)&&s&&typeof s==="object"){for(n=0;n<o.length;n++)i.clean(o[n])}}else if(o&&typeof o==="object")i.clean(o)}};function u(e){if(a(e)||typeof e!=="string")return e;var t=e.trim();if(t.substr(0,3)!=="rgb")return e;var r=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!r)return e;var n=r[1].trim().split(/\s*[\s,]\s*/);var i=t.charAt(3)==="a"&&n.length===4;if(!i&&n.length!==3)return e;for(var o=0;o<n.length;o++){if(!n[o].length)return e;n[o]=Number(n[o]);if(!(n[o]>=0)){return e}if(o===3){if(n[o]>1)n[o]=1}else if(n[o]>=1){return e}}var s=Math.round(n[0]*255)+", "+Math.round(n[1]*255)+", "+Math.round(n[2]*255);if(i)return"rgba("+s+", "+n[3]+")";return"rgb("+s+")"}},{"./attributes":642,"fast-isnumeric":241,tinycolor2:576}],644:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/layout_attributes");var a=e("../../plots/font_attributes");var i=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;t.exports=o({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:n.linecolor,outlinewidth:n.linewidth,bordercolor:n.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:i({},n.ticks,{dflt:""}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,tickfont:a({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,title:{text:{valType:"string"},font:a({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:a({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/cartesian/layout_attributes":842,"../../plots/font_attributes":856}],645:[function(e,t,r){"use strict";t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],646:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plot_api/plot_template");var i=e("../../plots/cartesian/tick_value_defaults");var o=e("../../plots/cartesian/tick_mark_defaults");var s=e("../../plots/cartesian/tick_label_defaults");var l=e("./attributes");t.exports=function e(t,r,u){var c=a.newContainer(r,"colorbar");var f=t.colorbar||{};function h(e,t){return n.coerce(f,c,l,e,t)}var p=h("thicknessmode");h("thickness",p==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var d=h("lenmode");h("len",d==="fraction"?1:u.height-u.margin.t-u.margin.b);h("x");h("xanchor");h("xpad");h("y");h("yanchor");h("ypad");n.noneOrAll(f,c,["x","y"]);h("outlinecolor");h("outlinewidth");h("bordercolor");h("borderwidth");h("bgcolor");var v=h("ticklabelposition");i(f,c,h,"linear");var m={outerTicks:false,font:u.font};if(v.indexOf("inside")!==-1){m.bgColor="black"}s(f,c,h,"linear",m);o(f,c,h,"linear",m);h("title.text",u._dfltTitle.colorbar);n.coerceFont(h,"title.font",u.font);h("title.side")}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_mark_defaults":850,"../../plots/cartesian/tick_value_defaults":851,"./attributes":644}],647:[function(e,t,r){"use strict";var n=e("d3");var a=e("tinycolor2");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../plots/cartesian/axes");var l=e("../dragelement");var u=e("../../lib");var c=u.strTranslate;var f=e("../../lib/extend").extendFlat;var h=e("../../lib/setcursor");var p=e("../drawing");var d=e("../color");var v=e("../titles");var m=e("../../lib/svg_text_utils");var g=e("../colorscale/helpers").flipScale;var y=e("../../plots/cartesian/axis_defaults");var x=e("../../plots/cartesian/position_defaults");var _=e("../../plots/cartesian/layout_attributes");var b=e("../../constants/alignment");var w=b.LINE_SPACING;var T=b.FROM_TL;var k=b.FROM_BR;var A=e("./constants").cn;function M(e){var t=e._fullLayout;var r=t._infolayer.selectAll("g."+A.colorbar).data(E(e),function(e){return e._id});r.enter().append("g").attr("class",function(e){return e._id}).classed(A.colorbar,true);r.each(function(t){var r=n.select(this);u.ensureSingle(r,"rect",A.cbbg);u.ensureSingle(r,"g",A.cbfills);u.ensureSingle(r,"g",A.cblines);u.ensureSingle(r,"g",A.cbaxis,function(e){e.classed(A.crisp,true)});u.ensureSingle(r,"g",A.cbtitleunshift,function(e){e.append("g").classed(A.cbtitle,true)});u.ensureSingle(r,"rect",A.cboutline);var a=S(r,t,e);if(a&&a.then)(e._promises||[]).push(a);if(e._context.edits.colorbarPosition){C(r,t,e)}});r.exit().each(function(t){i.autoMargin(e,t._id)}).remove();r.order()}function E(e){var t=e._fullLayout;var r=e.calcdata;var n=[];var a;var i;var o;var s;function l(e){return f(e,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function u(){if(typeof s.calc==="function"){s.calc(e,o,a)}else{a._fillgradient=i.reversescale?g(i.colorscale):i.colorscale;a._zrange=[i[s.min],i[s.max]]}}for(var c=0;c<r.length;c++){var h=r[c];o=h[0].trace;var p=o._module.colorbar;if(o.visible===true&&p){var d=Array.isArray(p);var v=d?p:[p];for(var m=0;m<v.length;m++){s=v[m];var y=s.container;i=y?o[y]:o;if(i&&i.showscale){a=l(i.colorbar);a._id="cb"+o.uid+(d&&y?"-"+y:"");a._traceIndex=o.index;a._propPrefix=(y?y+".":"")+"colorbar.";a._meta=o._meta;u();n.push(a)}}}}for(var x in t._colorAxes){i=t[x];if(i.showscale){var _=t._colorAxes[x];a=l(i.colorbar);a._id="cb"+x;a._propPrefix=x+".colorbar.";a._meta=t._meta;s={min:"cmin",max:"cmax"};if(_[0]!=="heatmap"){o=_[1];s.calc=o._module.colorbar.calc}u();n.push(a)}}return n}function S(e,t,r){var o=r._fullLayout;var l=o._size;var h=t._fillcolor;var g=t._line;var y=t.title;var x=y.side;var _=t._zrange||n.extent((typeof h==="function"?h:g.color).domain());var b=typeof g.color==="function"?g.color:function(){return g.color};var M=typeof h==="function"?h:function(){return h};var E=t._levels;var S=L(r,t,_);var C=S.fill;var O=S.line;var P=Math.round(t.thickness*(t.thicknessmode==="fraction"?l.w:1));var D=P/l.w;var R=Math.round(t.len*(t.lenmode==="fraction"?l.h:1));var z=R/l.h;var N=t.xpad/l.w;var F=(t.borderwidth+t.outlinewidth)/2;var B=t.ypad/l.h;var j=Math.round(t.x*l.w+t.xpad);var U=t.x-D*({middle:.5,right:1}[t.xanchor]||0);var H=t.y+z*(({top:-.5,bottom:.5}[t.yanchor]||0)-.5);var V=Math.round(l.h*(1-H));var G=V-R;t._lenFrac=z;t._thickFrac=D;t._xLeftFrac=U;t._yBottomFrac=H;var q=t._axis=I(r,t,_);q.position=t.x+N+D;if(["top","bottom"].indexOf(x)!==-1){q.title.side=x;q.titlex=t.x+N;q.titley=H+(y.side==="top"?z-B:B)}if(g.color&&t.tickmode==="auto"){q.tickmode="linear";q.tick0=E.start;var Y=E.size;var W=u.constrain((V-G)/50,4,15)+1;var X=(_[1]-_[0])/((t.nticks||W)*Y);if(X>1){var Z=Math.pow(10,Math.floor(Math.log(X)/Math.LN10));Y*=Z*u.roundUp(X/Z,[2,5,10]);if((Math.abs(E.start)/E.size+1e-6)%1<2e-6){q.tick0=0}}q.dtick=Y}q.domain=[H+B,H+z-B];q.setScale();e.attr("transform",c(Math.round(l.l),Math.round(l.t)));var K=e.select("."+A.cbtitleunshift).attr("transform",c(-Math.round(l.l),-Math.round(l.t)));var J=e.select("."+A.cbaxis);var Q;var $=0;function ee(n,a){var i={propContainer:q,propName:t._propPrefix+"title",traceIndex:t._traceIndex,_meta:t._meta,placeholder:o._dfltTitle.colorbar,containerGroup:e.select("."+A.cbtitle)};var s=n.charAt(0)==="h"?n.substr(1):"h"+n;e.selectAll("."+s+",."+s+"-math-group").remove();v.draw(r,n,f(i,a||{}))}function te(){if(["top","bottom"].indexOf(x)!==-1){var e=l.l+(t.x+N)*l.w;var r=q.title.font.size;var n;if(x==="top"){n=(1-(H+z-B))*l.h+l.t+3+r*.75}else{n=(1-(H+B))*l.h+l.t-3-r*.25}ee(q._id+"title",{attributes:{x:e,y:n,"text-anchor":"start"}})}}function re(){if(["top","bottom"].indexOf(x)===-1){var e=q.title.font.size;var t=q._offset+q._length/2;var a=l.l+(q.position||0)*l.w+(q.side==="right"?10+e*(q.showticklabels?1:.5):-10-e*(q.showticklabels?.5:0));ee("h"+q._id+"title",{avoid:{selection:n.select(r).selectAll("g."+q._id+"tick"),side:x,offsetLeft:l.l,offsetTop:0,maxShift:o.width},attributes:{x:a,y:t,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}function ne(){if(["top","bottom"].indexOf(x)!==-1){var i=e.select("."+A.cbtitle);var o=i.select("text");var f=[-t.outlinewidth/2,t.outlinewidth/2];var h=i.select(".h"+q._id+"title-math-group").node();var d=15.6;if(o.node()){d=parseInt(o.node().style.fontSize,10)*w}if(h){$=p.bBox(h).height;if($>d){f[1]-=($-d)/2}}else if(o.node()&&!o.classed(A.jsPlaceholder)){$=p.bBox(o.node()).height}if($){$+=5;if(x==="top"){q.domain[1]-=$/l.h;f[1]*=-1}else{q.domain[0]+=$/l.h;var v=m.lineCount(o);f[1]+=(1-v)*d}i.attr("transform",c(f[0],f[1]));q.setScale()}}e.selectAll("."+A.cbfills+",."+A.cblines).attr("transform",c(0,Math.round(l.h*(1-q.domain[1]))));J.attr("transform",c(0,Math.round(-l.t)));var y=e.select("."+A.cbfills).selectAll("rect."+A.cbfill).attr("style","").data(C);y.enter().append("rect").classed(A.cbfill,true).style("stroke","none");y.exit().remove();var T=_.map(q.c2p).map(Math.round).sort(function(e,t){return e-t});y.each(function(e,i){var o=[i===0?_[0]:(C[i]+C[i-1])/2,i===C.length-1?_[1]:(C[i]+C[i+1])/2].map(q.c2p).map(Math.round);o[1]=u.constrain(o[1]+(o[1]>o[0])?1:-1,T[0],T[1]);var s=n.select(this).attr({x:j,width:Math.max(P,2),y:n.min(o),height:Math.max(n.max(o)-n.min(o),2)});if(t._fillgradient){p.gradient(s,r,t._id,"vertical",t._fillgradient,"fill")}else{var l=M(e).replace("e-","");s.attr("fill",a(l).toHexString())}});var k=e.select("."+A.cblines).selectAll("path."+A.cbline).data(g.color&&g.width?O:[]);k.enter().append("path").classed(A.cbline,true);k.exit().remove();k.each(function(e){n.select(this).attr("d","M"+j+","+(Math.round(q.c2p(e))+g.width/2%1)+"h"+P).call(p.lineGroupStyle,g.width,b(e),g.dash)});J.selectAll("g."+q._id+"tick,path").remove();var E=j+P+(t.outlinewidth||0)/2-(t.ticks==="outside"?1:0);var S=s.calcTicks(q);var L=s.getTickSigns(q)[2];s.drawTicks(r,q,{vals:q.ticks==="inside"?s.clipEnds(q,S):S,layer:J,path:s.makeTickPath(q,E,L),transFn:s.makeTransTickFn(q)});return s.drawLabels(r,q,{vals:S,layer:J,transFn:s.makeTransTickLabelFn(q),labelFns:s.makeLabelFns(q,E)})}function ae(){var n=P+t.outlinewidth/2;if(q.ticklabelposition.indexOf("inside")===-1){n+=p.bBox(J.node()).width}Q=K.select("text");if(Q.node()&&!Q.classed(A.jsPlaceholder)){var a=K.select(".h"+q._id+"title-math-group").node();var o;if(a&&["top","bottom"].indexOf(x)!==-1){o=p.bBox(a).width}else{o=p.bBox(K.node()).right-j-l.l}n=Math.max(n,o)}var s=2*t.xpad+n+t.borderwidth+t.outlinewidth/2;var u=V-G;e.select("."+A.cbbg).attr({x:j-t.xpad-(t.borderwidth+t.outlinewidth)/2,y:G-F,width:Math.max(s,2),height:Math.max(u+2*F,2)}).call(d.fill,t.bgcolor).call(d.stroke,t.bordercolor).style("stroke-width",t.borderwidth);e.selectAll("."+A.cboutline).attr({x:j,y:G+t.ypad+(x==="top"?$:0),width:Math.max(P,2),height:Math.max(u-2*t.ypad-$,2)}).call(d.stroke,t.outlinecolor).style({fill:"none","stroke-width":t.outlinewidth});var f=({center:.5,right:1}[t.xanchor]||0)*s;e.attr("transform",c(l.l-f,l.t));var h={};var v=T[t.yanchor];var m=k[t.yanchor];if(t.lenmode==="pixels"){h.y=t.y;h.t=u*v;h.b=u*m}else{h.t=h.b=0;h.yt=t.y+t.len*v;h.yb=t.y-t.len*m}var g=T[t.xanchor];var y=k[t.xanchor];if(t.thicknessmode==="pixels"){h.x=t.x;h.l=s*g;h.r=s*y}else{var _=s-P;h.l=_*g;h.r=_*y;h.xl=t.x-t.thickness*g;h.xr=t.x+t.thickness*y}i.autoMargin(r,t._id,h)}return u.syncOrAsync([i.previousPromises,te,ne,re,i.previousPromises,ae],r)}function C(e,t,r){var n=r._fullLayout;var a=n._size;var i,s,u;l.init({element:e.node(),gd:r,prepFn:function(){i=e.attr("transform");h(e)},moveFn:function(r,n){e.attr("transform",i+c(r,n));s=l.align(t._xLeftFrac+r/a.w,t._thickFrac,0,1,t.xanchor);u=l.align(t._yBottomFrac-n/a.h,t._lenFrac,0,1,t.yanchor);var o=l.getCursor(s,u,t.xanchor,t.yanchor);h(e,o)},doneFn:function(){h(e);if(s!==undefined&&u!==undefined){var n={};n[t._propPrefix+"x"]=s;n[t._propPrefix+"y"]=u;if(t._traceIndex!==undefined){o.call("_guiRestyle",r,n,t._traceIndex)}else{o.call("_guiRelayout",r,n)}}}})}function L(e,t,r){var n=t._levels;var a=[];var i=[];var o;var s;var l=n.end+n.size/100;var u=n.size;var c=1.001*r[0]-.001*r[1];var f=1.001*r[1]-.001*r[0];for(s=0;s<1e5;s++){o=n.start+s*u;if(u>0?o>=l:o<=l)break;if(o>c&&o<f)a.push(o)}if(t._fillgradient){i=[0]}else if(typeof t._fillcolor==="function"){var h=t._filllevels;if(h){l=h.end+h.size/100;u=h.size;for(s=0;s<1e5;s++){o=h.start+s*u;if(u>0?o>=l:o<=l)break;if(o>r[0]&&o<r[1])i.push(o)}}else{i=a.map(function(e){return e-n.size/2});i.push(i[i.length-1]+n.size)}}else if(t._fillcolor&&typeof t._fillcolor==="string"){i=[0]}if(n.size<0){a.reverse();i.reverse()}return{line:a,fill:i}}function I(e,t,r){var n=e._fullLayout;var a={type:"linear",range:r,tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:t.ticks,ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,ticklabelposition:t.ticklabelposition,tickfont:t.tickfont,tickangle:t.tickangle,tickformat:t.tickformat,exponentformat:t.exponentformat,minexponent:t.minexponent,separatethousands:t.separatethousands,showexponent:t.showexponent,showtickprefix:t.showtickprefix,tickprefix:t.tickprefix,showticksuffix:t.showticksuffix,ticksuffix:t.ticksuffix,title:t.title,showline:true,anchor:"free",side:"right",position:1};var i={type:"linear",_id:"y"+t._id};var o={letter:"y",font:n.font,noHover:true,noTickson:true,noTicklabelmode:true,calendar:n.calendar};function s(e,t){return u.coerce(a,i,_,e,t)}y(a,i,s,o,n);x(a,i,s,o);return i}t.exports={draw:M}},{"../../constants/alignment":745,"../../lib":778,"../../lib/extend":768,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_defaults":830,"../../plots/cartesian/layout_attributes":842,"../../plots/cartesian/position_defaults":845,"../../plots/plots":891,"../../registry":911,"../color":643,"../colorscale/helpers":654,"../dragelement":662,"../drawing":665,"../titles":738,"./constants":645,d3:169,tinycolor2:576}],648:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t){return n.isPlainObject(t.colorbar)}},{"../../lib":778}],649:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"colorbar",attributes:e("./attributes"),supplyDefaults:e("./defaults"),draw:e("./draw").draw,hasColorbar:e("./has_colorbar")}},{"./attributes":644,"./defaults":646,"./draw":647,"./has_colorbar":648}],650:[function(e,t,r){"use strict";var n=e("../colorbar/attributes");var a=e("../../lib/regex").counter;var i=e("./scales.js").scales;var o=Object.keys(i);function s(e){return"`"+e+"`"}t.exports=function e(t,r){t=t||"";r=r||{};var o=r.cLetter||"c";var l="onlyIfNumerical"in r?r.onlyIfNumerical:Boolean(t);var u="noScale"in r?r.noScale:t==="marker.line";var c="showScaleDflt"in r?r.showScaleDflt:o==="z";var f=typeof r.colorscaleDflt==="string"?i[r.colorscaleDflt]:null;var h=r.editTypeOverride||"";var p=t?t+".":"";var d,v;if("colorAttr"in r){d=r.colorAttr;v=r.colorAttr}else{d={z:"z",c:"color"}[o];v="in "+s(p+d)}var m=l?" Has an effect only if "+v+"is set to a numerical array.":"";var g=o+"auto";var y=o+"min";var x=o+"max";var _=o+"mid";var b=s(p+g);var w=s(p+y);var T=s(p+x);var k=w+" and "+T;var A={};A[y]=A[x]=undefined;var M={};M[g]=false;var E={};if(d==="color"){E.color={valType:"color",arrayOk:true,editType:h||"style"};if(r.anim){E.color.anim=true}}E[g]={valType:"boolean",dflt:true,editType:"calc",impliedEdits:A};E[y]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:M};E[x]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:M};E[_]={valType:"number",dflt:null,editType:"calc",impliedEdits:A};E.colorscale={valType:"colorscale",editType:"calc",dflt:f,impliedEdits:{autocolorscale:false}};E.autocolorscale={valType:"boolean",dflt:r.autoColorDflt===false?false:true,editType:"calc",impliedEdits:{colorscale:undefined}};E.reversescale={valType:"boolean",dflt:false,editType:"plot"};if(!u){E.showscale={valType:"boolean",dflt:c,editType:"calc"};E.colorbar=n}if(!r.noColorAxis){E.coloraxis={valType:"subplotid",regex:a("coloraxis"),dflt:null,editType:"calc"}}return E}},{"../../lib/regex":795,"../colorbar/attributes":644,"./scales.js":658}],651:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("./helpers").extractOpts;t.exports=function e(t,r,o){var s=t._fullLayout;var l=o.vals;var u=o.containerStr;var c=u?a.nestedProperty(r,u).get():r;var f=i(c);var h=f.auto!==false;var p=f.min;var d=f.max;var v=f.mid;var m=function(){return a.aggNums(Math.min,null,l)};var g=function(){return a.aggNums(Math.max,null,l)};if(p===undefined){p=m()}else if(h){if(c._colorAx&&n(p)){p=Math.min(p,m())}else{p=m()}}if(d===undefined){d=g()}else if(h){if(c._colorAx&&n(d)){d=Math.max(d,g())}else{d=g()}}if(h&&v!==undefined){if(d-v>v-p){p=v-(d-v)}else if(d-v<v-p){d=v+(v-p)}}if(p===d){p-=.5;d+=.5}f._sync("min",p);f._sync("max",d);if(f.autocolorscale){var y;if(p*d<0)y=s.colorscale.diverging;else if(p>=0)y=s.colorscale.sequential;else y=s.colorscale.sequentialminus;f._sync("colorscale",y)}}},{"../../lib":778,"./helpers":654,"fast-isnumeric":241}],652:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./helpers").hasColorscale;var i=e("./helpers").extractOpts;t.exports=function e(t,r){function o(e,t){var r=e["_"+t];if(r!==undefined){e[t]=r}}function s(e,t){var a=t.container?n.nestedProperty(e,t.container).get():e;if(a){if(a.coloraxis){a._colorAx=r[a.coloraxis]}else{var s=i(a);var l=s.auto;if(l||s.min===undefined){o(a,t.min)}if(l||s.max===undefined){o(a,t.max)}if(s.autocolorscale){o(a,"colorscale")}}}}for(var l=0;l<t.length;l++){var u=t[l];var c=u._module.colorbar;if(c){if(Array.isArray(c)){for(var f=0;f<c.length;f++){s(u,c[f])}}else{s(u,c)}}if(a(u,"marker.line")){s(u,{container:"marker.line",min:"cmin",max:"cmax"})}}for(var h in r._colorAxes){s(r[h],{min:"cmin",max:"cmax"})}}},{"../../lib":778,"./helpers":654}],653:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../colorbar/has_colorbar");var o=e("../colorbar/defaults");var s=e("./scales").isValid;var l=e("../../registry").traceIs;function u(e,t){var r=t.slice(0,t.length-1);return t?a.nestedProperty(e,r).get()||{}:e}t.exports=function e(t,r,c,f,h){var p=h.prefix;var d=h.cLetter;var v="_module"in r;var m=u(t,p);var g=u(r,p);var y=u(r._template||{},p)||{};var x=function(){delete t.coloraxis;delete r.coloraxis;return e(t,r,c,f,h)};if(v){var _=c._colorAxes||{};var b=f(p+"coloraxis");if(b){var w=l(r,"contour")&&a.nestedProperty(r,"contours.coloring").get()||"heatmap";var T=_[b];if(T){T[2].push(x);if(T[0]!==w){T[0]=false;a.warn(["Ignoring coloraxis:",b,"setting","as it is linked to incompatible colorscales."].join(" "))}}else{_[b]=[w,r,[x]]}return}}var k=m[d+"min"];var A=m[d+"max"];var M=n(k)&&n(A)&&k<A;var E=f(p+d+"auto",!M);if(E){f(p+d+"mid")}else{f(p+d+"min");f(p+d+"max")}var S=m.colorscale;var C=y.colorscale;var L;if(S!==undefined)L=!s(S);if(C!==undefined)L=!s(C);f(p+"autocolorscale",L);f(p+"colorscale");f(p+"reversescale");if(p!=="marker.line."){var I;if(p&&v)I=i(m);var O=f(p+"showscale",I);if(O){if(p&&y)g._template=y;o(m,g,c)}}}},{"../../lib":778,"../../registry":911,"../colorbar/defaults":646,"../colorbar/has_colorbar":648,"./scales":658,"fast-isnumeric":241}],654:[function(e,t,r){"use strict";var n=e("d3");var a=e("tinycolor2");var i=e("fast-isnumeric");var o=e("../../lib");var s=e("../color");var l=e("./scales").isValid;function u(e,t,r){var n=t?o.nestedProperty(e,t).get()||{}:e;var a=n[r||"color"];var s=false;if(o.isArrayOrTypedArray(a)){for(var u=0;u<a.length;u++){if(i(a[u])){s=true;break}}}return o.isPlainObject(n)&&(s||n.showscale===true||i(n.cmin)&&i(n.cmax)||l(n.colorscale)||o.isPlainObject(n.colorbar))}var c=["showscale","autocolorscale","colorscale","reversescale","colorbar"];var f=["min","max","mid","auto"];function h(e){var t=e._colorAx;var r=t?t:e;var n={};var a;var i,o;for(i=0;i<c.length;i++){o=c[i];n[o]=r[o]}if(t){a="c";for(i=0;i<f.length;i++){o=f[i];n[o]=r["c"+o]}}else{var s;for(i=0;i<f.length;i++){o=f[i];s="c"+o;if(s in r){n[o]=r[s];continue}s="z"+o;if(s in r){n[o]=r[s]}}a=s.charAt(0)}n._sync=function(e,t){var n=f.indexOf(e)!==-1?a+e:e;r[n]=r["_"+n]=t};return n}function p(e){var t=h(e);var r=t.min;var n=t.max;var a=t.reversescale?d(t.colorscale):t.colorscale;var i=a.length;var o=new Array(i);var s=new Array(i);for(var l=0;l<i;l++){var u=a[l];o[l]=r+u[0]*(n-r);s[l]=u[1]}return{domain:o,range:s}}function d(e){var t=e.length;var r=new Array(t);for(var n=t-1,a=0;n>=0;n--,a++){var i=e[n];r[a]=[1-i[0],i[1]]}return r}function v(e,t){t=t||{};var r=e.domain;var o=e.range;var l=o.length;var u=new Array(l);for(var c=0;c<l;c++){var f=a(o[c]).toRgb();u[c]=[f.r,f.g,f.b,f.a]}var h=n.scale.linear().domain(r).range(u).clamp(true);var p=t.noNumericCheck;var d=t.returnArray;var v;if(p&&d){v=h}else if(p){v=function(e){return g(h(e))}}else if(d){v=function(e){if(i(e))return h(e);else if(a(e).isValid())return e;else return s.defaultLine}}else{v=function(e){if(i(e))return g(h(e));else if(a(e).isValid())return e;else return s.defaultLine}}v.domain=h.domain;v.range=function(){return o};return v}function m(e,t){return v(p(e),t)}function g(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return a(t).toRgbString()}t.exports={hasColorscale:u,extractOpts:h,extractScale:p,flipScale:d,makeColorScaleFunc:v,makeColorScaleFuncFromTrace:m}},{"../../lib":778,"../color":643,"./scales":658,d3:169,"fast-isnumeric":241,tinycolor2:576}],655:[function(e,t,r){"use strict";var n=e("./scales");var a=e("./helpers");t.exports={moduleType:"component",name:"colorscale",attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),handleDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc"),scales:n.scales,defaultScale:n.defaultScale,getScale:n.get,isValidScale:n.isValid,hasColorscale:a.hasColorscale,extractOpts:a.extractOpts,extractScale:a.extractScale,flipScale:a.flipScale,makeColorScaleFunc:a.makeColorScaleFunc,makeColorScaleFuncFromTrace:a.makeColorScaleFuncFromTrace}},{"./attributes":650,"./calc":651,"./cross_trace_defaults":652,"./defaults":653,"./helpers":654,"./layout_attributes":656,"./layout_defaults":657,"./scales":658}],656:[function(e,t,r){"use strict";var n=e("../../lib/extend").extendFlat;var a=e("./attributes");var i=e("./scales").scales;var o="Note that `autocolorscale` must be true for this attribute to work.";t.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:i.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:i.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:i.RdBu,editType:"calc"}},coloraxis:n({_isSubplotObj:true,editType:"calc"},a("",{colorAttr:"corresponding trace color array(s)",noColorAxis:true,showScaleDflt:true}))}},{"../../lib/extend":768,"./attributes":650,"./scales":658}],657:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plot_api/plot_template");var i=e("./layout_attributes");var o=e("./defaults");t.exports=function e(t,r){function s(e,a){return n.coerce(t,r,i,e,a)}s("colorscale.sequential");s("colorscale.sequentialminus");s("colorscale.diverging");var l=r._colorAxes;var u,c;function f(e,t){return n.coerce(u,c,i.coloraxis,e,t)}for(var h in l){var p=l[h];if(p[0]){u=t[h]||{};c=a.newContainer(r,h,"coloraxis");c._name=h;o(u,c,r,f,{prefix:"",cLetter:"c"})}else{for(var d=0;d<p[2].length;d++){p[2][d]()}delete r._colorAxes[h]}}}},{"../../lib":778,"../../plot_api/plot_template":817,"./defaults":653,"./layout_attributes":656}],658:[function(e,t,r){"use strict";var n=e("tinycolor2");var a={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]};var i=a.RdBu;function o(e,t){if(!t)t=i;if(!e)return t;function r(){try{e=a[e]||JSON.parse(e)}catch(r){e=t}}if(typeof e==="string"){r();if(typeof e==="string")r()}if(!s(e))return t;return e}function s(e){var t=0;if(!Array.isArray(e)||e.length<2)return false;if(!e[0]||!e[e.length-1])return false;if(+e[0][0]!==0||+e[e.length-1][0]!==1)return false;for(var r=0;r<e.length;r++){var a=e[r];if(a.length!==2||+a[0]<t||!n(a[1]).isValid()){return false}t=+a[0]}return true}function l(e){if(a[e]!==undefined)return true;else return s(e)}t.exports={scales:a,defaultScale:i,get:o,isValid:l}},{tinycolor2:576}],659:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i){var o=(t-n)/(a-n);var s=o+r/(a-n);var l=(o+s)/2;if(i==="left"||i==="bottom")return o;if(i==="center"||i==="middle")return l;if(i==="right"||i==="top")return s;if(o<2/3-l)return o;if(s>4/3-l)return s;return l}},{}],660:[function(e,t,r){"use strict";var n=e("../../lib");var a=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function e(t,r,i,o){if(i==="left")t=0;else if(i==="center")t=1;else if(i==="right")t=2;else t=n.constrain(Math.floor(t*3),0,2);if(o==="bottom")r=0;else if(o==="middle")r=1;else if(o==="top")r=2;else r=n.constrain(Math.floor(r*3),0,2);return a[r][t]}},{"../../lib":778}],661:[function(e,t,r){"use strict";r.selectMode=function(e){return e==="lasso"||e==="select"};r.drawMode=function(e){return e==="drawclosedpath"||e==="drawopenpath"||e==="drawline"||e==="drawrect"||e==="drawcircle"};r.openMode=function(e){return e==="drawline"||e==="drawopenpath"};r.rectMode=function(e){return e==="select"||e==="drawline"||e==="drawrect"||e==="drawcircle"};r.freeMode=function(e){return e==="lasso"||e==="drawclosedpath"||e==="drawopenpath"};r.selectingOrDrawing=function(e){return r.freeMode(e)||r.rectMode(e)}},{}],662:[function(e,t,r){"use strict";var n=e("mouse-event-offset");var a=e("has-hover");var i=e("has-passive-events");var o=e("../../lib").removeElement;var s=e("../../plots/cartesian/constants");var l=t.exports={};l.align=e("./align");l.getCursor=e("./cursor");var u=e("./unhover");l.unhover=u.wrapped;l.unhoverRaw=u.raw;l.init=function e(t){var r=t.gd;var n=1;var u=r._context.doubleClickDelay;var h=t.element;var p,d,v,m,g,y,x,_;if(!r._mouseDownTime)r._mouseDownTime=0;h.style.pointerEvents="all";h.onmousedown=T;if(!i){h.ontouchstart=T}else{if(h._ontouchstart){h.removeEventListener("touchstart",h._ontouchstart)}h._ontouchstart=T;h.addEventListener("touchstart",T,{passive:false})}function b(e,t,r){if(Math.abs(e)<r)e=0;if(Math.abs(t)<r)t=0;return[e,t]}var w=t.clampFn||b;function T(e){r._dragged=false;r._dragging=true;var i=f(e);p=i[0];d=i[1];x=e.target;y=e;_=e.buttons===2||e.ctrlKey;if(typeof e.clientX==="undefined"&&typeof e.clientY==="undefined"){e.clientX=p;e.clientY=d}v=(new Date).getTime();if(v-r._mouseDownTime<u){n+=1}else{n=1;r._mouseDownTime=v}if(t.prepFn)t.prepFn(e,p,d);if(a&&!_){g=c();g.style.cursor=window.getComputedStyle(h).cursor}else if(!a){g=document;m=window.getComputedStyle(document.documentElement).cursor;document.documentElement.style.cursor=window.getComputedStyle(h).cursor}document.addEventListener("mouseup",A);document.addEventListener("touchend",A);if(t.dragmode!==false){e.preventDefault();document.addEventListener("mousemove",k);document.addEventListener("touchmove",k,{passive:false})}return}function k(e){e.preventDefault();var n=f(e);var a=t.minDrag||s.MINDRAG;var i=w(n[0]-p,n[1]-d,a);var o=i[0];var u=i[1];if(o||u){r._dragged=true;l.unhover(r)}if(r._dragged&&t.moveFn&&!_){r._dragdata={element:h,dx:o,dy:u};t.moveFn(o,u)}return}function A(e){delete r._dragdata;if(t.dragmode!==false){e.preventDefault();document.removeEventListener("mousemove",k);document.removeEventListener("touchmove",k)}document.removeEventListener("mouseup",A);document.removeEventListener("touchend",A);if(a){o(g)}else if(m){g.documentElement.style.cursor=m;m=null}if(!r._dragging){r._dragged=false;return}r._dragging=false;if((new Date).getTime()-r._mouseDownTime>u){n=Math.max(n-1,1)}if(r._dragged){if(t.doneFn)t.doneFn()}else{if(t.clickFn)t.clickFn(n,y);if(!_){var i;try{i=new MouseEvent("click",e)}catch(t){var s=f(e);i=document.createEvent("MouseEvents");i.initMouseEvent("click",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,s[0],s[1],e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}x.dispatchEvent(i)}}r._dragging=false;r._dragged=false;return}};function c(){var e=document.createElement("div");e.className="dragcover";var t=e.style;t.position="fixed";t.left=0;t.right=0;t.top=0;t.bottom=0;t.zIndex=999999999;t.background="none";document.body.appendChild(e);return e}l.coverSlip=c;function f(e){return n(e.changedTouches?e.changedTouches[0]:e,document.body)}},{"../../lib":778,"../../plots/cartesian/constants":834,"./align":659,"./cursor":660,"./unhover":663,"has-hover":440,"has-passive-events":441,"mouse-event-offset":484}],663:[function(e,t,r){"use strict";var n=e("../../lib/events");var a=e("../../lib/throttle");var i=e("../../lib/dom").getGraphDiv;var o=e("../fx/constants");var s=t.exports={};s.wrapped=function(e,t,r){e=i(e);if(e._fullLayout){a.clear(e._fullLayout._uid+o.HOVERID)}s.raw(e,t,r)};s.raw=function e(t,r){var a=t._fullLayout;var i=t._hoverdata;if(!r)r={};if(r.target&&n.triggerHandler(t,"plotly_beforehover",r)===false){return}a._hoverlayer.selectAll("g").remove();a._hoverlayer.selectAll("line").remove();a._hoverlayer.selectAll("circle").remove();t._hoverdata=undefined;if(r.target&&i){t.emit("plotly_unhover",{event:r,points:i})}}},{"../../lib/dom":766,"../../lib/events":767,"../../lib/throttle":804,"../fx/constants":677}],664:[function(e,t,r){"use strict";r.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],665:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("tinycolor2");var o=e("../../registry");var s=e("../color");var l=e("../colorscale");var u=e("../../lib");var c=u.strTranslate;var f=e("../../lib/svg_text_utils");var h=e("../../constants/xmlns_namespaces");var p=e("../../constants/alignment");var d=p.LINE_SPACING;var v=e("../../constants/interactions").DESELECTDIM;var m=e("../../traces/scatter/subtypes");var g=e("../../traces/scatter/make_bubble_size_func");var y=e("../../components/fx/helpers").appendArrayPointValue;var x=t.exports={};x.font=function(e,t,r,n){if(u.isPlainObject(t)){n=t.color;r=t.size;t=t.family}if(t)e.style("font-family",t);if(r+1)e.style("font-size",r+"px");if(n)e.call(s.fill,n)};x.setPosition=function(e,t,r){e.attr("x",t).attr("y",r)};x.setSize=function(e,t,r){e.attr("width",t).attr("height",r)};x.setRect=function(e,t,r,n,a){e.call(x.setPosition,t,r).call(x.setSize,n,a)};x.translatePoint=function(e,t,r,n){var i=r.c2p(e.x);var o=n.c2p(e.y);if(a(i)&&a(o)&&t.node()){if(t.node().nodeName==="text"){t.attr("x",i).attr("y",o)}else{t.attr("transform",c(i,o))}}else{return false}return true};x.translatePoints=function(e,t,r){e.each(function(e){var a=n.select(this);x.translatePoint(e,a,t,r)})};x.hideOutsideRangePoint=function(e,t,r,n,a,i){t.attr("display",r.isPtWithinRange(e,a)&&n.isPtWithinRange(e,i)?null:"none")};x.hideOutsideRangePoints=function(e,t){if(!t._hasClipOnAxisFalse)return;var r=t.xaxis;var a=t.yaxis;e.each(function(t){var i=t[0].trace;var s=i.xcalendar;var l=i.ycalendar;var u=o.traceIs(i,"bar-like")?".bartext":".point,.textpoint";e.selectAll(u).each(function(e){x.hideOutsideRangePoint(e,n.select(this),r,a,s,l)})})};x.crispRound=function(e,t,r){if(!t||!a(t))return r||0;if(e._context.staticPlot)return t;if(t<1)return 1;return Math.round(t)};x.singleLineStyle=function(e,t,r,n,a){t.style("fill","none");var i=(((e||[])[0]||{}).trace||{}).line||{};var o=r||i.width||0;var l=a||i.dash||"";s.stroke(t,n||i.color);x.dashLine(t,l,o)};x.lineGroupStyle=function(e,t,r,a){e.style("fill","none").each(function(e){var i=(((e||[])[0]||{}).trace||{}).line||{};var o=t||i.width||0;var l=a||i.dash||"";n.select(this).call(s.stroke,r||i.color).call(x.dashLine,l,o)})};x.dashLine=function(e,t,r){r=+r||0;t=x.dashStyle(t,r);e.style({"stroke-dasharray":t,"stroke-width":r+"px"})};x.dashStyle=function(e,t){t=+t||1;var r=Math.max(t,3);if(e==="solid")e="";else if(e==="dot")e=r+"px,"+r+"px";else if(e==="dash")e=3*r+"px,"+3*r+"px";else if(e==="longdash")e=5*r+"px,"+5*r+"px";else if(e==="dashdot"){e=3*r+"px,"+r+"px,"+r+"px,"+r+"px"}else if(e==="longdashdot"){e=5*r+"px,"+2*r+"px,"+r+"px,"+2*r+"px"}return e};x.singleFillStyle=function(e){var t=n.select(e.node());var r=t.data();var a=(((r[0]||[])[0]||{}).trace||{}).fillcolor;if(a){e.call(s.fill,a)}};x.fillGroupStyle=function(e){e.style("stroke-width",0).each(function(e){var t=n.select(this);if(e[0].trace){t.call(s.fill,e[0].trace.fillcolor)}})};var _=e("./symbol_defs");x.symbolNames=[];x.symbolFuncs=[];x.symbolNeedLines={};x.symbolNoDot={};x.symbolNoFill={};x.symbolList=[];Object.keys(_).forEach(function(e){var t=_[e];var r=t.n;x.symbolList.push(r,String(r),e,r+100,String(r+100),e+"-open");x.symbolNames[r]=e;x.symbolFuncs[r]=t.f;if(t.needLine){x.symbolNeedLines[r]=true}if(t.noDot){x.symbolNoDot[r]=true}else{x.symbolList.push(r+200,String(r+200),e+"-dot",r+300,String(r+300),e+"-open-dot")}if(t.noFill){x.symbolNoFill[r]=true}});var b=x.symbolNames.length;var w="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";x.symbolNumber=function(e){if(a(e)){e=+e}else if(typeof e==="string"){var t=0;if(e.indexOf("-open")>0){t=100;e=e.replace("-open","")}if(e.indexOf("-dot")>0){t+=200;e=e.replace("-dot","")}e=x.symbolNames.indexOf(e);if(e>=0){e+=t}}return e%100>=b||e>=400?0:Math.floor(Math.max(e,0))};function T(e,t){var r=e%100;return x.symbolFuncs[r](t)+(e>=200?w:"")}var k={x1:1,x2:0,y1:0,y2:0};var A={x1:0,x2:0,y1:1,y2:0};var M=n.format("~.1f");var E={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:true},horizontal:{node:"linearGradient",attrs:k},horizontalreversed:{node:"linearGradient",attrs:k,reversed:true},vertical:{node:"linearGradient",attrs:A},verticalreversed:{node:"linearGradient",attrs:A,reversed:true}};x.gradient=function(e,t,r,a,o,l){var c=o.length;var f=E[a];var h=new Array(c);for(var p=0;p<c;p++){if(f.reversed){h[c-1-p]=[M((1-o[p][0])*100),o[p][1]]}else{h[p]=[M(o[p][0]*100),o[p][1]]}}var d=t._fullLayout;var v="g"+d._uid+"-"+r;var m=d._defs.select(".gradients").selectAll("#"+v).data([a+h.join(";")],u.identity);m.exit().remove();m.enter().append(f.node).each(function(){var e=n.select(this);if(f.attrs)e.attr(f.attrs);e.attr("id",v);var t=e.selectAll("stop").data(h);t.exit().remove();t.enter().append("stop");t.each(function(e){var t=i(e[1]);n.select(this).attr({offset:e[0]+"%","stop-color":s.tinyRGB(t),"stop-opacity":t.getAlpha()})})});e.style(l,F(v,t)).style(l+"-opacity",null);var g=function(e){return"."+e.attr("class").replace(/\s/g,".")};var y=g(n.select(e.node().parentNode))+">"+g(e);d._gradientUrlQueryParts[y]=1};x.initGradients=function(e){var t=e._fullLayout;var r=u.ensureSingle(t._defs,"g","gradients");r.selectAll("linearGradient,radialGradient").remove();t._gradientUrlQueryParts={}};x.pointStyle=function(e,t,r){if(!e.size())return;var a=x.makePointStyleFns(t);e.each(function(e){x.singlePointStyle(e,n.select(this),t,a,r)})};x.singlePointStyle=function(e,t,r,n,a){var i=r.marker;var o=i.line;t.style("opacity",n.selectedOpacityFn?n.selectedOpacityFn(e):e.mo===undefined?i.opacity:e.mo);if(n.ms2mrc){var l;if(e.ms==="various"||i.size==="various"){l=3}else{l=n.ms2mrc(e.ms)}e.mrc=l;if(n.selectedSizeFn){l=e.mrc=n.selectedSizeFn(e)}var c=x.symbolNumber(e.mx||i.symbol)||0;e.om=c%200>=100;t.attr("d",T(c,l))}var f=false;var h,p,d;if(e.so){d=o.outlierwidth;p=o.outliercolor;h=i.outliercolor}else{var v=(o||{}).width;d=(e.mlw+1||v+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0;if("mlc"in e)p=e.mlcc=n.lineScale(e.mlc);else if(u.isArrayOrTypedArray(o.color))p=s.defaultLine;else p=o.color;if(u.isArrayOrTypedArray(i.color)){h=s.defaultLine;f=true}if("mc"in e){h=e.mcc=n.markerScale(e.mc)}else{h=i.color||"rgba(0,0,0,0)"}if(n.selectedColorFn){h=n.selectedColorFn(e)}}if(e.om){t.call(s.stroke,h).style({"stroke-width":(d||1)+"px",fill:"none"})}else{t.style("stroke-width",(e.isBlank?0:d)+"px");var m=i.gradient;var g=e.mgt;if(g)f=true;else g=m&&m.type;if(Array.isArray(g)){g=g[0];if(!E[g])g=0}if(g&&g!=="none"){var y=e.mgc;if(y)f=true;else y=m.color;var _=r.uid;if(f)_+="-"+e.i;x.gradient(t,a,_,g,[[0,y],[1,h]],"fill")}else{s.fill(t,h)}if(d){s.stroke(t,p)}}};x.makePointStyleFns=function(e){var t={};var r=e.marker;t.markerScale=x.tryColorscale(r,"");t.lineScale=x.tryColorscale(r,"line");if(o.traceIs(e,"symbols")){t.ms2mrc=m.isBubble(e)?g(e):function(){return(r.size||6)/2}}if(e.selectedpoints){u.extendFlat(t,x.makeSelectedPointStyleFns(e))}return t};x.makeSelectedPointStyleFns=function(e){var t={};var r=e.selected||{};var n=e.unselected||{};var a=e.marker||{};var i=r.marker||{};var s=n.marker||{};var l=a.opacity;var c=i.opacity;var f=s.opacity;var h=c!==undefined;var p=f!==undefined;if(u.isArrayOrTypedArray(l)||h||p){t.selectedOpacityFn=function(e){var t=e.mo===undefined?a.opacity:e.mo;if(e.selected){return h?c:t}else{return p?f:v*t}}}var d=a.color;var m=i.color;var g=s.color;if(m||g){t.selectedColorFn=function(e){var t=e.mcc||d;if(e.selected){return m||t}else{return g||t}}}var y=a.size;var x=i.size;var _=s.size;var b=x!==undefined;var w=_!==undefined;if(o.traceIs(e,"symbols")&&(b||w)){t.selectedSizeFn=function(e){var t=e.mrc||y/2;if(e.selected){return b?x/2:t}else{return w?_/2:t}}}return t};x.makeSelectedTextStyleFns=function(e){var t={};var r=e.selected||{};var n=e.unselected||{};var a=e.textfont||{};var i=r.textfont||{};var o=n.textfont||{};var l=a.color;var u=i.color;var c=o.color;t.selectedTextColorFn=function(e){var t=e.tc||l;if(e.selected){return u||t}else{if(c)return c;else return u?t:s.addOpacity(t,v)}};return t};x.selectedPointStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=x.makeSelectedPointStyleFns(t);var a=t.marker||{};var i=[];if(r.selectedOpacityFn){i.push(function(e,t){e.style("opacity",r.selectedOpacityFn(t))})}if(r.selectedColorFn){i.push(function(e,t){s.fill(e,r.selectedColorFn(t))})}if(r.selectedSizeFn){i.push(function(e,t){var n=t.mx||a.symbol||0;var i=r.selectedSizeFn(t);e.attr("d",T(x.symbolNumber(n),i));t.mrc2=i})}if(i.length){e.each(function(e){var t=n.select(this);for(var r=0;r<i.length;r++){i[r](t,e)}})}};x.tryColorscale=function(e,t){var r=t?u.nestedProperty(e,t).get():e;if(r){var n=r.color;if((r.colorscale||r._colorAx)&&u.isArrayOrTypedArray(n)){return l.makeColorScaleFuncFromTrace(r)}}return u.identity};var S={start:1,end:-1,middle:0,bottom:1,top:-1};function C(e,t,r,a){var i=n.select(e.node().parentNode);var o=t.indexOf("top")!==-1?"top":t.indexOf("bottom")!==-1?"bottom":"middle";var s=t.indexOf("left")!==-1?"end":t.indexOf("right")!==-1?"start":"middle";var l=a?a/.8+1:0;var u=(f.lineCount(e)-1)*d+1;var h=S[s]*l;var p=r*.75+S[o]*l+(S[o]-1)*u*r/2;e.attr("text-anchor",s);i.attr("transform",c(h,p))}function L(e,t){var r=e.ts||t.textfont.size;return a(r)&&r>0?r:0}x.textPointStyle=function(e,t,r){if(!e.size())return;var a;if(t.selectedpoints){var i=x.makeSelectedTextStyleFns(t);a=i.selectedTextColorFn}var o=t.texttemplate;var s=r._fullLayout;e.each(function(e){var i=n.select(this);var l=o?u.extractOption(e,t,"txt","texttemplate"):u.extractOption(e,t,"tx","text");if(!l&&l!==0){i.remove();return}if(o){var c=t._module.formatLabels?t._module.formatLabels(e,t,s):{};var h={};y(h,t,e.i);var p=t._meta||{};l=u.texttemplateString(l,c,s._d3locale,h,e,p)}var d=e.tp||t.textposition;var v=L(e,t);var m=a?a(e):e.tc||t.textfont.color;i.call(x.font,e.tf||t.textfont.family,v,m).text(l).call(f.convertToTspans,r).call(C,d,v,e.mrc)})};x.selectedTextStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=x.makeSelectedTextStyleFns(t);e.each(function(e){var a=n.select(this);var i=r.selectedTextColorFn(e);var o=e.tp||t.textposition;var l=L(e,t);s.fill(a,i);C(a,o,l,e.mrc2||e.mrc)})};var I=.5;x.smoothopen=function(e,t){if(e.length<3){return"M"+e.join("L")}var r="M"+e[0];var n=[];var a;for(a=1;a<e.length-1;a++){n.push(O(e[a-1],e[a],e[a+1],t))}r+="Q"+n[0][0]+" "+e[1];for(a=2;a<e.length-1;a++){r+="C"+n[a-2][1]+" "+n[a-1][0]+" "+e[a]}r+="Q"+n[e.length-3][1]+" "+e[e.length-1];return r};x.smoothclosed=function(e,t){if(e.length<3){return"M"+e.join("L")+"Z"}var r="M"+e[0];var n=e.length-1;var a=[O(e[n],e[0],e[1],t)];var i;for(i=1;i<n;i++){a.push(O(e[i-1],e[i],e[i+1],t))}a.push(O(e[n-1],e[n],e[0],t));for(i=1;i<=n;i++){r+="C"+a[i-1][1]+" "+a[i][0]+" "+e[i]}r+="C"+a[n][1]+" "+a[0][0]+" "+e[0]+"Z";return r};function O(e,t,r,a){var i=e[0]-t[0];var o=e[1]-t[1];var s=r[0]-t[0];var l=r[1]-t[1];var u=Math.pow(i*i+o*o,I/2);var c=Math.pow(s*s+l*l,I/2);var f=(c*c*i-u*u*s)*a;var h=(c*c*o-u*u*l)*a;var p=3*c*(u+c);var d=3*u*(u+c);return[[n.round(t[0]+(p&&f/p),2),n.round(t[1]+(p&&h/p),2)],[n.round(t[0]-(d&&f/d),2),n.round(t[1]-(d&&h/d),2)]]}var P={hv:function(e,t){return"H"+n.round(t[0],2)+"V"+n.round(t[1],2)},vh:function(e,t){return"V"+n.round(t[1],2)+"H"+n.round(t[0],2)},hvh:function(e,t){return"H"+n.round((e[0]+t[0])/2,2)+"V"+n.round(t[1],2)+"H"+n.round(t[0],2)},vhv:function(e,t){return"V"+n.round((e[1]+t[1])/2,2)+"H"+n.round(t[0],2)+"V"+n.round(t[1],2)}};var D=function(e,t){return"L"+n.round(t[0],2)+","+n.round(t[1],2)};x.steps=function(e){var t=P[e]||D;return function(e){var r="M"+n.round(e[0][0],2)+","+n.round(e[0][1],2);for(var a=1;a<e.length;a++){r+=t(e[a-1],e[a])}return r}};x.makeTester=function(){var e=u.ensureSingleById(n.select("body"),"svg","js-plotly-tester",function(e){e.attr(h.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})});var t=u.ensureSingle(e,"path","js-reference-point",function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});x.tester=e;x.testref=t};x.savedBBoxes={};var R=0;var z=1e4;x.bBox=function(e,t,r){if(!r)r=N(e);var a;if(r){a=x.savedBBoxes[r];if(a)return u.extendFlat({},a)}else if(e.childNodes.length===1){var i=e.childNodes[0];r=N(i);if(r){var o=+i.getAttribute("x")||0;var s=+i.getAttribute("y")||0;var l=i.getAttribute("transform");if(!l){var c=x.bBox(i,false,r);if(o){c.left+=o;c.right+=o}if(s){c.top+=s;c.bottom+=s}return c}r+="~"+o+"~"+s+"~"+l;a=x.savedBBoxes[r];if(a)return u.extendFlat({},a)}}var h,p;if(t){h=e}else{p=x.tester.node();h=e.cloneNode(true);p.appendChild(h)}n.select(h).attr("transform",null).call(f.positionText,0,0);var d=h.getBoundingClientRect();var v=x.testref.node().getBoundingClientRect();if(!t)p.removeChild(h);var m={height:d.height,width:d.width,left:d.left-v.left,top:d.top-v.top,right:d.right-v.left,bottom:d.bottom-v.top};if(R>=z){x.savedBBoxes={};R=0}if(r)x.savedBBoxes[r]=m;R++;return u.extendFlat({},m)};function N(e){var t=e.getAttribute("data-unformatted");if(t===null)return;return t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}x.setClipUrl=function(e,t,r){e.attr("clip-path",F(t,r))};function F(e,t){if(!e)return null;var r=t._context;var n=r._exportedPlot?"":r._baseUrl||"";return"url('"+n+"#"+e+"')"}x.getTranslate=function(e){var t=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/;var r=e.attr?"attr":"getAttribute";var n=e[r]("transform")||"";var a=n.replace(t,function(e,t,r){return[t,r].join(" ")}).split(" ");return{x:+a[0]||0,y:+a[1]||0}};x.setTranslate=function(e,t,r){var n=/(\btranslate\(.*?\);?)/;var a=e.attr?"attr":"getAttribute";var i=e.attr?"attr":"setAttribute";var o=e[a]("transform")||"";t=t||0;r=r||0;o=o.replace(n,"").trim();o+=c(t,r);o=o.trim();e[i]("transform",o);return o};x.getScale=function(e){var t=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/;var r=e.attr?"attr":"getAttribute";var n=e[r]("transform")||"";var a=n.replace(t,function(e,t,r){return[t,r].join(" ")}).split(" ");return{x:+a[0]||1,y:+a[1]||1}};x.setScale=function(e,t,r){var n=/(\bscale\(.*?\);?)/;var a=e.attr?"attr":"getAttribute";var i=e.attr?"attr":"setAttribute";var o=e[a]("transform")||"";t=t||1;r=r||1;o=o.replace(n,"").trim();o+="scale("+t+","+r+")";o=o.trim();e[i]("transform",o);return o};var B=/\s*sc.*/;x.setPointGroupScale=function(e,t,r){t=t||1;r=r||1;if(!e)return;var n=t===1&&r===1?"":"scale("+t+","+r+")";e.each(function(){var e=(this.getAttribute("transform")||"").replace(B,"");e+=n;e=e.trim();this.setAttribute("transform",e)})};var j=/translate\([^)]*\)\s*$/;x.setTextPointsScale=function(e,t,r){if(!e)return;e.each(function(){var e;var a=n.select(this);var i=a.select("text");if(!i.node())return;var o=parseFloat(i.attr("x")||0);var s=parseFloat(i.attr("y")||0);var l=(a.attr("transform")||"").match(j);if(t===1&&r===1){e=[]}else{e=[c(o,s),"scale("+t+","+r+")",c(-o,-s)]}if(l){e.push(l)}a.attr("transform",e.join(""))})}},{"../../components/fx/helpers":679,"../../constants/alignment":745,"../../constants/interactions":752,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../lib/svg_text_utils":803,"../../registry":911,"../../traces/scatter/make_bubble_size_func":1204,"../../traces/scatter/subtypes":1212,"../color":643,"../colorscale":655,"./symbol_defs":666,d3:169,"fast-isnumeric":241,tinycolor2:576}],666:[function(e,t,r){"use strict";var n=e("d3");t.exports={circle:{n:0,f:function(e){var t=n.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=n.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=n.round(e*.4,2);var r=n.round(e*1.2,2);return"M"+r+","+t+"H"+t+"V"+r+"H-"+t+"V"+t+"H-"+r+"V-"+t+"H-"+t+"V-"+r+"H"+t+"V-"+t+"H"+r+"Z"}},x:{n:4,f:function(e){var t=n.round(e*.8/Math.sqrt(2),2);var r="l"+t+","+t;var a="l"+t+",-"+t;var i="l-"+t+",-"+t;var o="l-"+t+","+t;return"M0,"+t+r+a+i+a+i+o+i+o+r+o+r+"Z"}},"triangle-up":{n:5,f:function(e){var t=n.round(e*2/Math.sqrt(3),2);var r=n.round(e/2,2);var a=n.round(e,2);return"M-"+t+","+r+"H"+t+"L0,-"+a+"Z"}},"triangle-down":{n:6,f:function(e){var t=n.round(e*2/Math.sqrt(3),2);var r=n.round(e/2,2);var a=n.round(e,2);return"M-"+t+",-"+r+"H"+t+"L0,"+a+"Z"}},"triangle-left":{n:7,f:function(e){var t=n.round(e*2/Math.sqrt(3),2);var r=n.round(e/2,2);var a=n.round(e,2);return"M"+r+",-"+t+"V"+t+"L-"+a+",0Z"}},"triangle-right":{n:8,f:function(e){var t=n.round(e*2/Math.sqrt(3),2);var r=n.round(e/2,2);var a=n.round(e,2);return"M-"+r+",-"+t+"V"+t+"L"+a+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=n.round(e*.6,2);var r=n.round(e*1.2,2);return"M-"+r+",-"+t+"H"+t+"V"+r+"Z"}},"triangle-se":{n:10,f:function(e){var t=n.round(e*.6,2);var r=n.round(e*1.2,2);return"M"+t+",-"+r+"V"+t+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(e){var t=n.round(e*.6,2);var r=n.round(e*1.2,2);return"M"+r+","+t+"H-"+t+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(e){var t=n.round(e*.6,2);var r=n.round(e*1.2,2);return"M-"+t+","+r+"V-"+t+"H"+r+"Z"}},pentagon:{n:13,f:function(e){var t=n.round(e*.951,2);var r=n.round(e*.588,2);var a=n.round(-e,2);var i=n.round(e*-.309,2);var o=n.round(e*.809,2);return"M"+t+","+i+"L"+r+","+o+"H-"+r+"L-"+t+","+i+"L0,"+a+"Z"}},hexagon:{n:14,f:function(e){var t=n.round(e,2);var r=n.round(e/2,2);var a=n.round(e*Math.sqrt(3)/2,2);return"M"+a+",-"+r+"V"+r+"L0,"+t+"L-"+a+","+r+"V-"+r+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=n.round(e,2);var r=n.round(e/2,2);var a=n.round(e*Math.sqrt(3)/2,2);return"M-"+r+","+a+"H"+r+"L"+t+",0L"+r+",-"+a+"H-"+r+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=n.round(e*.924,2);var r=n.round(e*.383,2);return"M-"+r+",-"+t+"H"+r+"L"+t+",-"+r+"V"+r+"L"+r+","+t+"H-"+r+"L-"+t+","+r+"V-"+r+"Z"}},star:{n:17,f:function(e){var t=e*1.4;var r=n.round(t*.225,2);var a=n.round(t*.951,2);var i=n.round(t*.363,2);var o=n.round(t*.588,2);var s=n.round(-t,2);var l=n.round(t*-.309,2);var u=n.round(t*.118,2);var c=n.round(t*.809,2);var f=n.round(t*.382,2);return"M"+r+","+l+"H"+a+"L"+i+","+u+"L"+o+","+c+"L0,"+f+"L-"+o+","+c+"L-"+i+","+u+"L-"+a+","+l+"H-"+r+"L0,"+s+"Z"}},hexagram:{n:18,f:function(e){var t=n.round(e*.66,2);var r=n.round(e*.38,2);var a=n.round(e*.76,2);return"M-"+a+",0l-"+r+",-"+t+"h"+a+"l"+r+",-"+t+"l"+r+","+t+"h"+a+"l-"+r+","+t+"l"+r+","+t+"h-"+a+"l-"+r+","+t+"l-"+r+",-"+t+"h-"+a+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=n.round(e*Math.sqrt(3)*.8,2);var r=n.round(e*.8,2);var a=n.round(e*1.6,2);var i=n.round(e*4,2);var o="A "+i+","+i+" 0 0 1 ";return"M-"+t+","+r+o+t+","+r+o+"0,-"+a+o+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=n.round(e*Math.sqrt(3)*.8,2);var r=n.round(e*.8,2);var a=n.round(e*1.6,2);var i=n.round(e*4,2);var o="A "+i+","+i+" 0 0 1 ";return"M"+t+",-"+r+o+"-"+t+",-"+r+o+"0,"+a+o+t+",-"+r+"Z"}},"star-square":{n:21,f:function(e){var t=n.round(e*1.1,2);var r=n.round(e*2,2);var a="A "+r+","+r+" 0 0 1 ";return"M-"+t+",-"+t+a+"-"+t+","+t+a+t+","+t+a+t+",-"+t+a+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=n.round(e*1.4,2);var r=n.round(e*1.9,2);var a="A "+r+","+r+" 0 0 1 ";return"M-"+t+",0"+a+"0,"+t+a+t+",0"+a+"0,-"+t+a+"-"+t+",0"+"Z"}},"diamond-tall":{n:23,f:function(e){var t=n.round(e*.7,2);var r=n.round(e*1.4,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=n.round(e*1.4,2);var r=n.round(e*.7,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:true},bowtie:{n:26,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:true},"circle-cross":{n:27,f:function(e){var t=n.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"circle-x":{n:28,f:function(e){var t=n.round(e,2);var r=n.round(e/Math.sqrt(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"square-cross":{n:29,f:function(e){var t=n.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"square-x":{n:30,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"diamond-cross":{n:31,f:function(e){var t=n.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:true,noDot:true},"diamond-x":{n:32,f:function(e){var t=n.round(e*1.3,2);var r=n.round(e*.65,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M-"+r+",-"+r+"L"+r+","+r+"M-"+r+","+r+"L"+r+",-"+r},needLine:true,noDot:true},"cross-thin":{n:33,f:function(e){var t=n.round(e*1.4,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"x-thin":{n:34,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},asterisk:{n:35,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*.85,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r},needLine:true,noDot:true,noFill:true},hash:{n:36,f:function(e){var t=n.round(e/2,2);var r=n.round(e,2);return"M"+t+","+r+"V-"+r+"m-"+r+",0V"+r+"M"+r+","+t+"H-"+r+"m0,-"+r+"H"+r},needLine:true,noFill:true},"y-up":{n:37,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*1.6,2);var a=n.round(e*.8,2);return"M-"+t+","+a+"L0,0M"+t+","+a+"L0,0M0,-"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-down":{n:38,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*1.6,2);var a=n.round(e*.8,2);return"M-"+t+",-"+a+"L0,0M"+t+",-"+a+"L0,0M0,"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-left":{n:39,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*1.6,2);var a=n.round(e*.8,2);return"M"+a+","+t+"L0,0M"+a+",-"+t+"L0,0M-"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"y-right":{n:40,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*1.6,2);var a=n.round(e*.8,2);return"M-"+a+","+t+"L0,0M-"+a+",-"+t+"L0,0M"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"line-ew":{n:41,f:function(e){var t=n.round(e*1.4,2);return"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"line-ns":{n:42,f:function(e){var t=n.round(e*1.4,2);return"M0,"+t+"V-"+t},needLine:true,noDot:true,noFill:true},"line-ne":{n:43,f:function(e){var t=n.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},"line-nw":{n:44,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:true,noDot:true,noFill:true},"arrow-up":{n:45,f:function(e){var t=n.round(e,2);var r=n.round(e*2,2);return"M0,0L-"+t+","+r+"H"+t+"Z"},noDot:true},"arrow-down":{n:46,f:function(e){var t=n.round(e,2);var r=n.round(e*2,2);return"M0,0L-"+t+",-"+r+"H"+t+"Z"},noDot:true},"arrow-left":{n:47,f:function(e){var t=n.round(e*2,2);var r=n.round(e,2);return"M0,0L"+t+",-"+r+"V"+r+"Z"},noDot:true},"arrow-right":{n:48,f:function(e){var t=n.round(e*2,2);var r=n.round(e,2);return"M0,0L-"+t+",-"+r+"V"+r+"Z"},noDot:true},"arrow-bar-up":{n:49,f:function(e){var t=n.round(e,2);var r=n.round(e*2,2);return"M-"+t+",0H"+t+"M0,0L-"+t+","+r+"H"+t+"Z"},needLine:true,noDot:true},"arrow-bar-down":{n:50,f:function(e){var t=n.round(e,2);var r=n.round(e*2,2);return"M-"+t+",0H"+t+"M0,0L-"+t+",-"+r+"H"+t+"Z"},needLine:true,noDot:true},"arrow-bar-left":{n:51,f:function(e){var t=n.round(e*2,2);var r=n.round(e,2);return"M0,-"+r+"V"+r+"M0,0L"+t+",-"+r+"V"+r+"Z"},needLine:true,noDot:true},"arrow-bar-right":{n:52,f:function(e){var t=n.round(e*2,2);var r=n.round(e,2);return"M0,-"+r+"V"+r+"M0,0L-"+t+",-"+r+"V"+r+"Z"},needLine:true,noDot:true}}},{d3:169}],667:[function(e,t,r){"use strict";t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],668:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../registry");var i=e("../../plots/cartesian/axes");var o=e("../../lib");var s=e("./compute_error");t.exports=function e(t){var r=t.calcdata;for(var n=0;n<r.length;n++){var o=r[n];var s=o[0].trace;if(s.visible===true&&a.traceIs(s,"errorBarsOK")){var u=i.getFromId(t,s.xaxis);var c=i.getFromId(t,s.yaxis);l(o,s,u,"x");l(o,s,c,"y")}}};function l(e,t,r,a){var l=t["error_"+a]||{};var u=l.visible&&["linear","log"].indexOf(r.type)!==-1;var c=[];if(!u)return;var f=s(l);for(var h=0;h<e.length;h++){var p=e[h];var d=p.i;if(d===undefined)d=h;else if(d===null)continue;var v=p[a];if(!n(r.c2l(v)))continue;var m=f(v,d);if(n(m[0])&&n(m[1])){var g=p[a+"s"]=v-m[0];var y=p[a+"h"]=v+m[1];c.push(g,y)}}var x=r._id;var _=t._extremes[x];var b=i.findExtremes(r,c,o.extendFlat({tozero:_.opts.tozero},{padded:true}));_.min=_.min.concat(b.min);_.max=_.max.concat(b.max)}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./compute_error":669,"fast-isnumeric":241}],669:[function(e,t,r){"use strict";t.exports=function e(t){var r=t.type;var a=t.symmetric;if(r==="data"){var i=t.array||[];if(a){return function e(t,r){var n=+i[r];return[n,n]}}else{var o=t.arrayminus||[];return function e(t,r){var n=+i[r];var a=+o[r];if(!isNaN(n)||!isNaN(a)){return[a||0,n||0]}return[NaN,NaN]}}}else{var s=n(r,t.value);var l=n(r,t.valueminus);if(a||t.valueminus===undefined){return function e(t){var r=s(t);return[r,r]}}else{return function e(t){return[l(t),s(t)]}}}};function n(e,t){if(e==="percent"){return function(e){return Math.abs(e*t/100)}}if(e==="constant"){return function(){return Math.abs(t)}}if(e==="sqrt"){return function(e){return Math.sqrt(Math.abs(e))}}}},{}],670:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../registry");var i=e("../../lib");var o=e("../../plot_api/plot_template");var s=e("./attributes");t.exports=function(e,t,r,l){var u="error_"+l.axis;var c=o.newContainer(t,u);var f=e[u]||{};function h(e,t){return i.coerce(f,c,s,e,t)}var p=f.array!==undefined||f.value!==undefined||f.type==="sqrt";var d=h("visible",p);if(d===false)return;var v=h("type","array"in f?"data":"percent");var m=true;if(v!=="sqrt"){m=h("symmetric",!((v==="data"?"arrayminus":"valueminus")in f))}if(v==="data"){h("array");h("traceref");if(!m){h("arrayminus");h("tracerefminus")}}else if(v==="percent"||v==="constant"){h("value");if(!m)h("valueminus")}var g="copy_"+l.inherit+"style";if(l.inherit){var y=t["error_"+l.inherit];if((y||{}).visible){h(g,!(f.color||n(f.thickness)||n(f.width)))}}if(!l.inherit||!c[g]){h("color",r);h("thickness");h("width",a.traceIs(t,"gl3d")?0:4)}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911,"./attributes":667,"fast-isnumeric":241}],671:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plot_api/edit_types").overrideAll;var i=e("./attributes");var o={error_x:n.extendFlat({},i),error_y:n.extendFlat({},i)};delete o.error_x.copy_zstyle;delete o.error_y.copy_zstyle;delete o.error_y.copy_ystyle;var s={error_x:n.extendFlat({},i),error_y:n.extendFlat({},i),error_z:n.extendFlat({},i)};delete s.error_x.copy_ystyle;delete s.error_y.copy_ystyle;delete s.error_z.copy_ystyle;delete s.error_z.copy_zstyle;t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:o,bar:o,histogram:o,scatter3d:a(s,"calc","nested"),scattergl:a(o,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:l};function l(e,t,r){if((t.error_y||{}).visible){r.yerr=e.yh-e.y;if(!t.error_y.symmetric)r.yerrneg=e.y-e.ys}if((t.error_x||{}).visible){r.xerr=e.xh-e.x;if(!t.error_x.symmetric)r.xerrneg=e.x-e.xs}}},{"../../lib":778,"../../plot_api/edit_types":810,"./attributes":667,"./calc":668,"./compute_error":669,"./defaults":670,"./plot":672,"./style":673}],672:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("../drawing");var o=e("../../traces/scatter/subtypes");t.exports=function e(t,r,l,u){var c;var f=l.xaxis;var h=l.yaxis;var p=u&&u.duration>0;r.each(function(e){var r=e[0].trace;var d=r.error_x||{};var v=r.error_y||{};var m;if(r.ids){m=function(e){return e.id}}var g=o.hasMarkers(r)&&r.marker.maxdisplayed>0;if(!v.visible&&!d.visible)e=[];var y=n.select(this).selectAll("g.errorbar").data(e,m);y.exit().remove();if(!e.length)return;if(!d.visible)y.selectAll("path.xerror").remove();if(!v.visible)y.selectAll("path.yerror").remove();y.style("opacity",1);var x=y.enter().append("g").classed("errorbar",true);if(p){x.style("opacity",0).transition().duration(u.duration).style("opacity",1)}i.setClipUrl(y,l.layerClipId,t);y.each(function(e){var t=n.select(this);var r=s(e,f,h);if(g&&!e.vis)return;var i;var o=t.select("path.yerror");if(v.visible&&a(r.x)&&a(r.yh)&&a(r.ys)){var l=v.width;i="M"+(r.x-l)+","+r.yh+"h"+2*l+"m-"+l+",0V"+r.ys;if(!r.noYS)i+="m-"+l+",0h"+2*l;c=!o.size();if(c){o=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",true)}else if(p){o=o.transition().duration(u.duration).ease(u.easing)}o.attr("d",i)}else o.remove();var m=t.select("path.xerror");if(d.visible&&a(r.y)&&a(r.xh)&&a(r.xs)){var y=(d.copy_ystyle?v:d).width;i="M"+r.xh+","+(r.y-y)+"v"+2*y+"m0,-"+y+"H"+r.xs;if(!r.noXS)i+="m0,-"+y+"v"+2*y;c=!m.size();if(c){m=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",true)}else if(p){m=m.transition().duration(u.duration).ease(u.easing)}m.attr("d",i)}else m.remove()})})};function s(e,t,r){var n={x:t.c2p(e.x),y:r.c2p(e.y)};if(e.yh!==undefined){n.yh=r.c2p(e.yh);n.ys=r.c2p(e.ys);if(!a(n.ys)){n.noYS=true;n.ys=r.c2p(e.ys,true)}}if(e.xh!==undefined){n.xh=t.c2p(e.xh);n.xs=t.c2p(e.xs);if(!a(n.xs)){n.noXS=true;n.xs=t.c2p(e.xs,true)}}return n}},{"../../traces/scatter/subtypes":1212,"../drawing":665,d3:169,"fast-isnumeric":241}],673:[function(e,t,r){"use strict";var n=e("d3");var a=e("../color");t.exports=function e(t){t.each(function(e){var t=e[0].trace;var r=t.error_y||{};var i=t.error_x||{};var o=n.select(this);o.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(a.stroke,r.color);if(i.copy_ystyle)i=r;o.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(a.stroke,i.color)})}},{"../color":643,d3:169}],674:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("./layout_attributes").hoverlabel;var i=e("../../lib/extend").extendFlat;t.exports={hoverlabel:{bgcolor:i({},a.bgcolor,{arrayOk:true}),bordercolor:i({},a.bordercolor,{arrayOk:true}),font:n({arrayOk:true,editType:"none"}),align:i({},a.align,{arrayOk:true}),namelength:i({},a.namelength,{arrayOk:true}),editType:"none"}}},{"../../lib/extend":768,"../../plots/font_attributes":856,"./layout_attributes":684}],675:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");t.exports=function e(t){var r=t.calcdata;var o=t._fullLayout;function s(e){return function(t){return n.coerceHoverinfo({hoverinfo:t},{_module:e._module},o)}}for(var l=0;l<r.length;l++){var u=r[l];var c=u[0].trace;if(a.traceIs(c,"pie-like"))continue;var f=a.traceIs(c,"2dMap")?i:n.fillArray;f(c.hoverinfo,u,"hi",s(c));if(c.hovertemplate)f(c.hovertemplate,u,"ht");if(!c.hoverlabel)continue;f(c.hoverlabel.bgcolor,u,"hbg");f(c.hoverlabel.bordercolor,u,"hbc");f(c.hoverlabel.font.size,u,"hts");f(c.hoverlabel.font.color,u,"htc");f(c.hoverlabel.font.family,u,"htf");f(c.hoverlabel.namelength,u,"hnl");f(c.hoverlabel.align,u,"hta")}};function i(e,t,r,a){a=a||n.identity;if(Array.isArray(e)){t[0][r]=a(e)}}},{"../../lib":778,"../../registry":911}],676:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("./hover").hover;t.exports=function e(t,r,i){var o=n.getComponentMethod("annotations","onClick")(t,t._hoverdata);if(i!==undefined){a(t,r,i,true)}function s(){t.emit("plotly_click",{points:t._hoverdata,event:r})}if(t._hoverdata&&r&&r.target){if(o&&o.then){o.then(s)}else s();if(r.stopImmediatePropagation)r.stopImmediatePropagation()}}},{"../../registry":911,"./hover":680}],677:[function(e,t,r){"use strict";t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],678:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("./hoverlabel_defaults");t.exports=function e(t,r,o,s){function l(e,i){return n.coerce(t,r,a,e,i)}var u=n.extendFlat({},s.hoverlabel);if(r.hovertemplate)u.namelength=-1;i(t,r,l,u)}},{"../../lib":778,"./attributes":674,"./hoverlabel_defaults":681}],679:[function(e,t,r){"use strict";var n=e("../../lib");r.getSubplot=function(e){return e.subplot||e.xaxis+e.yaxis||e.geo};r.isTraceInSubplots=function(e,t){if(e.type==="splom"){var n=e.xaxes||[];var a=e.yaxes||[];for(var i=0;i<n.length;i++){for(var o=0;o<a.length;o++){if(t.indexOf(n[i]+a[o])!==-1){return true}}}return false}return t.indexOf(r.getSubplot(e))!==-1};r.flat=function(e,t){var r=new Array(e.length);for(var n=0;n<e.length;n++){r[n]=t}return r};r.p2c=function(e,t){var r=new Array(e.length);for(var n=0;n<e.length;n++){r[n]=e[n].p2c(t)}return r};r.getDistanceFunction=function(e,t,n,a){if(e==="closest")return a||r.quadrature(t,n);return e.charAt(0)==="x"?t:n};r.getClosest=function(e,t,r){if(r.index!==false){if(r.index>=0&&r.index<e.length){r.distance=0}else r.index=false}else{for(var n=0;n<e.length;n++){var a=t(e[n]);if(a<=r.distance){r.index=n;r.distance=a}}}return r};r.inbox=function(e,t,r){return e*t<0||e===0?r:Infinity};r.quadrature=function(e,t){return function(r){var n=e(r);var a=t(r);return Math.sqrt(n*n+a*a)}};r.makeEventData=function(e,t,n){var a="index"in e?e.index:e.pointNumber;var i={data:t._input,fullData:t,curveNumber:t.index,pointNumber:a};if(t._indexToPoints){var o=t._indexToPoints[a];if(o.length===1){i.pointIndex=o[0]}else{i.pointIndices=o}}else{i.pointIndex=a}if(t._module.eventData){i=t._module.eventData(i,e,t,n,a)}else{if("xVal"in e)i.x=e.xVal;else if("x"in e)i.x=e.x;if("yVal"in e)i.y=e.yVal;else if("y"in e)i.y=e.y;if(e.xa)i.xaxis=e.xa;if(e.ya)i.yaxis=e.ya;if(e.zLabelVal!==undefined)i.z=e.zLabelVal}r.appendArrayPointValue(i,t,a);return i};r.appendArrayPointValue=function(e,t,r){var a=t._arrayAttrs;if(!a){return}for(var s=0;s<a.length;s++){var l=a[s];var u=i(l);if(e[u]===undefined){var c=n.nestedProperty(t,l).get();var f=o(c,r);if(f!==undefined)e[u]=f}}};r.appendArrayMultiPointValues=function(e,t,r){var a=t._arrayAttrs;if(!a){return}for(var s=0;s<a.length;s++){var l=a[s];var u=i(l);if(e[u]===undefined){var c=n.nestedProperty(t,l).get();var f=new Array(r.length);for(var h=0;h<r.length;h++){f[h]=o(c,r[h])}e[u]=f}}};var a={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function i(e){return a[e]||e}function o(e,t){if(Array.isArray(t)){if(Array.isArray(e)&&Array.isArray(e[t[0]])){return e[t[0]][t[1]]}}else{return e[t]}}var s={x:true,y:true};var l={"x unified":true,"y unified":true};r.isUnifiedHover=function(e){if(typeof e!=="string")return false;return!!l[e]};r.isXYhover=function(e){if(typeof e!=="string")return false;return!!s[e]}},{"../../lib":778}],680:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("tinycolor2");var o=e("../../lib");var s=o.strTranslate;var l=o.strRotate;var u=e("../../lib/events");var c=e("../../lib/svg_text_utils");var f=e("../../lib/override_cursor");var h=e("../drawing");var p=e("../color");var d=e("../dragelement");var v=e("../../plots/cartesian/axes");var m=e("../../registry");var g=e("./helpers");var y=e("./constants");var x=e("../legend/defaults");var _=e("../legend/draw");var b=y.YANGLE;var w=Math.PI*b/180;var T=1/Math.sin(w);var k=Math.cos(w);var A=Math.sin(w);var M=y.HOVERARROWSIZE;var E=y.HOVERTEXTPAD;r.hover=function e(t,r,n,a){t=o.getGraphDiv(t);o.throttle(t._fullLayout._uid+y.HOVERID,y.HOVERMINTIME,function(){S(t,r,n,a)})};r.loneHover=function e(t,r){var a=true;if(!Array.isArray(t)){a=false;t=[t]}var i=t.map(function(e){return{color:e.color||p.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,nameLength:e.nameLength,textAlign:e.textAlign,trace:e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:e.hovertemplate||false,eventData:e.eventData||false,hovertemplateLabels:e.hovertemplateLabels||false}});var o=n.select(r.container);var s=r.outerContainer?n.select(r.outerContainer):o;var l={hovermode:"closest",rotateLabels:false,bgColor:r.bgColor||p.background,container:o,outerContainer:s};var u=I(i,l,r.gd);var c=5;var f=0;var h=0;u.sort(function(e,t){return e.y0-t.y0}).each(function(e,t){var n=e.y0-e.by/2;if(n-c<f){e.offset=f-n+c}else{e.offset=0}f=n+e.by+e.offset;if(t===r.anchorIndex||0)h=e.offset}).each(function(e){e.offset-=h});var d=r.gd._fullLayout._invScaleX;var v=r.gd._fullLayout._invScaleY;D(u,l.rotateLabels,d,v);return a?u:u.node()};function S(e,t,r,i){if(!r)r="xy";var s=Array.isArray(r)?r:[r];var l=e._fullLayout;var c=l._plots||[];var h=c[r];var v=l._has("cartesian");if(h){var y=h.overlays.map(function(e){return e.id});s=s.concat(y)}var x=s.length;var _=new Array(x);var b=new Array(x);var w=false;for(var T=0;T<x;T++){var k=s[T];if(c[k]){w=true;_[T]=c[k].xaxis;b[T]=c[k].yaxis}else if(l[k]&&l[k]._subplot){var A=l[k]._subplot;_[T]=A.xaxis;b[T]=A.yaxis}else{o.warn("Unrecognized subplot: "+k);return}}var M=t.hovermode||l.hovermode;if(M&&!w)M="closest";if(["x","y","closest","x unified","y unified"].indexOf(M)===-1||!e.calcdata||e.querySelector(".zoombox")||e._dragging){return d.unhoverRaw(e,t)}var E=l.hoverdistance===-1?Infinity:l.hoverdistance;var S=l.spikedistance===-1?Infinity:l.spikedistance;var L=[];var O=[];var B,j;var U,H,V,G,q,Y,W,X,Z,K,J;var Q={hLinePoint:null,vLinePoint:null};var $=false;if(Array.isArray(t)){M="array";for(U=0;U<t.length;U++){V=e.calcdata[t[U].curveNumber||0];if(V){G=V[0].trace;if(V[0].trace.hoverinfo!=="skip"){O.push(V);if(G.orientation==="h"){$=true}}}}}else{for(H=0;H<e.calcdata.length;H++){V=e.calcdata[H];G=V[0].trace;if(G.hoverinfo!=="skip"&&g.isTraceInSubplots(G,s)){O.push(V);if(G.orientation==="h"){$=true}}}var ee=!t.target;var te,re;if(ee){if("xpx"in t)te=t.xpx;else te=_[0]._length/2;if("ypx"in t)re=t.ypx;else re=b[0]._length/2}else{if(u.triggerHandler(e,"plotly_beforehover",t)===false){return}var ne=t.target.getBoundingClientRect();te=t.clientX-ne.left;re=t.clientY-ne.top;l._calcInverseTransform(e);var ae=o.apply3DTransform(l._invTransform)(te,re);te=ae[0];re=ae[1];if(te<0||te>_[0]._length||re<0||re>b[0]._length){return d.unhoverRaw(e,t)}}t.pointerX=te+_[0]._offset;t.pointerY=re+b[0]._offset;if("xval"in t)B=g.flat(s,t.xval);else B=g.p2c(_,te);if("yval"in t)j=g.flat(s,t.yval);else j=g.p2c(b,re);if(!a(B[0])||!a(j[0])){o.warn("Fx.hover failed",t,e);return d.unhoverRaw(e,t)}}var ie=Infinity;function oe(e,r){for(H=0;H<O.length;H++){V=O[H];if(!V||!V[0]||!V[0].trace)continue;G=V[0].trace;if(G.visible!==true||G._length===0)continue;if(["carpet","contourcarpet"].indexOf(G._module.name)!==-1)continue;if(G.type==="splom"){Y=0;q=s[Y]}else{q=g.getSubplot(G);Y=s.indexOf(q)}W=M;if(g.isUnifiedHover(W)){W=W.charAt(0)}K={cd:V,trace:G,xa:_[Y],ya:b[Y],maxHoverDistance:E,maxSpikeDistance:S,index:false,distance:Math.min(ie,E),spikeDistance:Infinity,xSpike:undefined,ySpike:undefined,color:p.defaultLine,name:G.name,x0:undefined,x1:undefined,y0:undefined,y1:undefined,xLabelVal:undefined,yLabelVal:undefined,zLabelVal:undefined,text:undefined};if(l[q]){K.subplot=l[q]._subplot}if(l._splomScenes&&l._splomScenes[G.uid]){K.scene=l._splomScenes[G.uid]}J=L.length;if(W==="array"){var n=t[H];if("pointNumber"in n){K.index=n.pointNumber;W="closest"}else{W="";if("xval"in n){X=n.xval;W="x"}if("yval"in n){Z=n.yval;W=W?"closest":"y"}}}else if(e!==undefined&&r!==undefined){X=e;Z=r}else{X=B[Y];Z=j[Y]}if(E!==0){if(G._module&&G._module.hoverPoints){var i=G._module.hoverPoints(K,X,Z,W,l._hoverlayer);if(i){var u;for(var c=0;c<i.length;c++){u=i[c];if(a(u.x0)&&a(u.y0)){L.push(R(u,M))}}}}else{o.log("Unrecognized trace type in hover:",G)}}if(M==="closest"&&L.length>J){L.splice(0,J);ie=L[0].distance}if(v&&S!==0){if(L.length===0){K.distance=S;K.index=false;var f=G._module.hoverPoints(K,X,Z,"closest",l._hoverlayer);if(f){f=f.filter(function(e){return e.spikeDistance<=S})}if(f&&f.length){var h;var d=f.filter(function(e){return e.xa.showspikes&&e.xa.spikesnap!=="hovered data"});if(d.length){var m=d[0];if(a(m.x0)&&a(m.y0)){h=le(m);if(!Q.vLinePoint||Q.vLinePoint.spikeDistance>h.spikeDistance){Q.vLinePoint=h}}}var y=f.filter(function(e){return e.ya.showspikes&&e.ya.spikesnap!=="hovered data"});if(y.length){var x=y[0];if(a(x.x0)&&a(x.y0)){h=le(x);if(!Q.hLinePoint||Q.hLinePoint.spikeDistance>h.spikeDistance){Q.hLinePoint=h}}}}}}}}oe();function se(e,t){var r=null;var n=Infinity;var a;for(var i=0;i<e.length;i++){a=e[i].spikeDistance;if(a<=n&&a<=t){r=e[i];n=a}}return r}function le(e){if(!e)return null;return{xa:e.xa,ya:e.ya,x:e.xSpike!==undefined?e.xSpike:(e.x0+e.x1)/2,y:e.ySpike!==undefined?e.ySpike:(e.y0+e.y1)/2,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}}var ue={fullLayout:l,container:l._hoverlayer,outerContainer:l._paperdiv,event:t};var ce=e._spikepoints;var fe={vLinePoint:Q.vLinePoint,hLinePoint:Q.hLinePoint};e._spikepoints=fe;if(v&&S!==0){if(L.length!==0){var he=L.filter(function(e){return e.ya.showspikes});var pe=se(he,S);Q.hLinePoint=le(pe);var de=L.filter(function(e){return e.xa.showspikes});var ve=se(de,S);Q.vLinePoint=le(ve)}}if(L.length===0){var me=d.unhoverRaw(e,t);if(v&&(Q.hLinePoint!==null||Q.vLinePoint!==null)){if(F(ce)){z(e,Q,ue)}}return me}if(v){if(F(ce)){z(e,Q,ue)}}L.sort(function(e,t){return e.distance-t.distance});if(g.isXYhover(W)&&L[0].length!==0&&L[0].trace.type!=="splom"){var ge=L[0];var ye=ge.cd[ge.index];var xe=l.boxmode==="group"||l.violinmode==="group";var _e=ge.xVal;var be=ge.xa;if(be.type==="category")_e=be._categoriesMap[_e];if(be.type==="date")_e=be.d2c(_e);if(ye&&ye.t&&ye.t.posLetter===be._id&&xe){_e+=ye.t.dPos}var we=ge.yVal;be=ge.ya;if(be.type==="category")we=be._categoriesMap[we];if(be.type==="date")we=be.d2c(we);if(ye&&ye.t&&ye.t.posLetter===be._id&&xe){we+=ye.t.dPos}oe(_e,we);var Te={};L=L.filter(function(e){var t=C(e);if(!Te[t]){Te[t]=true;return Te[t]}})}var ke=e._hoverdata;var Ae=[];for(U=0;U<L.length;U++){var Me=L[U];var Ee=g.makeEventData(Me,Me.trace,Me.cd);if(Me.hovertemplate!==false){var Se=false;if(Me.cd[Me.index]&&Me.cd[Me.index].ht){Se=Me.cd[Me.index].ht}Me.hovertemplate=Se||Me.trace.hovertemplate||false}Me.eventData=[Ee];Ae.push(Ee)}e._hoverdata=Ae;var Ce=M==="y"&&(O.length>1||L.length>1)||M==="closest"&&$&&L.length>1;var Le=p.combine(l.plot_bgcolor||p.background,l.paper_bgcolor);var Ie={hovermode:M,rotateLabels:Ce,bgColor:Le,container:l._hoverlayer,outerContainer:l._paperdiv,commonLabelOpts:l.hoverlabel,hoverdistance:l.hoverdistance};var Oe=I(L,Ie,e);if(!g.isUnifiedHover(M)){P(Oe,Ce?"xa":"ya",l);D(Oe,Ce,l._invScaleX,l._invScaleY)}if(t.target&&t.target.tagName){var Pe=m.getComponentMethod("annotations","hasClickToShow")(e,Ae);f(n.select(t.target),Pe?"pointer":"")}if(!t.target||i||!N(e,t,ke))return;if(ke){e.emit("plotly_unhover",{event:t,points:ke})}e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:_,yaxes:b,xvals:B,yvals:j})}function C(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa,e.ya||""].join(",")}var L=/<extra>([\s\S]*)<\/extra>/;function I(e,t,r){var a=r._fullLayout;var i=t.hovermode;var u=t.rotateLabels;var f=t.bgColor;var d=t.container;var v=t.outerContainer;var m=t.commonLabelOpts||{};var w=t.fontFamily||y.HOVERFONT;var T=t.fontSize||y.HOVERFONTSIZE;var k=e[0];var A=k.xa;var S=k.ya;var L=i.charAt(0)==="y"?"yLabel":"xLabel";var I=k[L];var P=(String(I)||"").split(" ")[0];var D=v.node().getBoundingClientRect();var R=D.top;var z=D.width;var N=D.height;var F=I!==undefined&&k.distance<=t.hoverdistance&&(i==="x"||i==="y");if(F){var B=true;var j,U;for(j=0;j<e.length;j++){if(B&&e[j].zLabel===undefined)B=false;U=e[j].hoverinfo||e[j].trace.hoverinfo;if(U){var H=Array.isArray(U)?U:U.split("+");if(H.indexOf("all")===-1&&H.indexOf(i)===-1){F=false;break}}}if(B)F=false}var V=d.selectAll("g.axistext").data(F?[0]:[]);V.enter().append("g").classed("axistext",true);V.exit().remove();V.each(function(){var t=n.select(this);var l=o.ensureSingle(t,"path","",function(e){e.style({"stroke-width":"1px"})});var u=o.ensureSingle(t,"text","",function(e){e.attr("data-notex",1)});var f=m.bgcolor||p.defaultLine;var d=m.bordercolor||p.contrast(f);var v=p.contrast(f);var g={family:m.font.family||w,size:m.font.size||T,color:m.font.color||v};l.style({fill:f,stroke:d});u.text(I).call(h.font,g).call(c.positionText,0,0).call(c.convertToTspans,r);t.attr("transform","");var y=u.node().getBoundingClientRect();var x,_;if(i==="x"){var b=A.side==="top"?"-":"";u.attr("text-anchor","middle").call(c.positionText,0,A.side==="top"?R-y.bottom-M-E:R-y.top+M+E);x=A._offset+(k.x0+k.x1)/2;_=S._offset+(A.side==="top"?0:S._length);var C=y.width/2+E;if(x<C){x=C;l.attr("d","M-"+(C-M)+",0"+"L-"+(C-M*2)+","+b+M+"H"+(E+y.width/2)+"v"+b+(E*2+y.height)+"H-"+C+"V"+b+M+"Z")}else if(x>a.width-C){x=a.width-C;l.attr("d","M"+(C-M)+",0"+"L"+C+","+b+M+"v"+b+(E*2+y.height)+"H-"+C+"V"+b+M+"H"+(C-M*2)+"Z")}else{l.attr("d","M0,0"+"L"+M+","+b+M+"H"+(E+y.width/2)+"v"+b+(E*2+y.height)+"H-"+(E+y.width/2)+"V"+b+M+"H-"+M+"Z")}}else{var L;var O;var P;if(S.side==="right"){L="start";O=1;P="";x=A._offset+A._length}else{L="end";O=-1;P="-";x=A._offset}_=S._offset+(k.y0+k.y1)/2;u.attr("text-anchor",L);l.attr("d","M0,0"+"L"+P+M+","+M+"V"+(E+y.height/2)+"h"+P+(E*2+y.width)+"V-"+(E+y.height/2)+"H"+P+M+"V-"+M+"Z");var D=y.height/2;var z=R-y.top-D;var N="clip"+a._uid+"commonlabel"+S._id;var F;if(x<y.width+2*E+M){F="M-"+(M+E)+"-"+D+"h-"+(y.width-E)+"V"+D+"h"+(y.width-E)+"Z";var B=y.width-x+E;c.positionText(u,B,z);if(L==="end"){u.selectAll("tspan").each(function(){var e=n.select(this);var t=h.tester.append("text").text(e.text()).call(h.font,g);var r=t.node().getBoundingClientRect();if(Math.round(r.width)<Math.round(y.width)){e.attr("x",B-r.width)}t.remove()})}}else{c.positionText(u,O*(E+M),z);F=null}var j=a._topclips.selectAll("#"+N).data(F?[0]:[]);j.enter().append("clipPath").attr("id",N).append("path");j.exit().remove();j.select("path").attr("d",F);h.setClipUrl(u,F?N:null,r)}t.attr("transform",s(x,_));e=G(e)});function G(e){return e.filter(function(e){return e.zLabelVal!==undefined||(e[L]||"").split(" ")[0]===P})}if(g.isUnifiedHover(i)){d.selectAll("g.hovertext").remove();if(I!==undefined&&k.distance<=t.hoverdistance)e=G(e);if(e.length===0)return;var q={showlegend:true,legend:{title:{text:I,font:a.hoverlabel.font},font:a.hoverlabel.font,bgcolor:a.hoverlabel.bgcolor,bordercolor:a.hoverlabel.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:a.legend?a.legend.traceorder:undefined,orientation:"v"}};var Y={};x(q,Y,r._fullData);var W=Y.legend;W.entries=[];for(var X=0;X<e.length;X++){var Z=O(e[X],true,i,a,I);var K=Z[0];var J=Z[1];var Q=e[X];Q.name=J;if(J!==""){Q.text=J+" : "+K}else{Q.text=K}var $=Q.cd[Q.index];if($){if($.mc)Q.mc=$.mc;if($.mcc)Q.mc=$.mcc;if($.mlc)Q.mlc=$.mlc;if($.mlcc)Q.mlc=$.mlcc;if($.mlw)Q.mlw=$.mlw;if($.mrc)Q.mrc=$.mrc;if($.dir)Q.dir=$.dir}Q._distinct=true;W.entries.push([Q])}W.entries.sort(function(e,t){return e[0].trace.index-t[0].trace.index});W.layer=d;_(r,W);var ee=o.mean(e.map(function(e){return(e.y0+e.y1)/2}));var te=o.mean(e.map(function(e){return(e.x0+e.x1)/2}));var re=d.select("g.legend");var ne=re.node().getBoundingClientRect();te+=A._offset;ee+=S._offset-ne.height/2;var ae=ne.width+2*E;var ie=te+ae<=z;var oe=te-ae>=0;if(!ie&&oe){te-=ae}else{te+=2*E}var se=ne.height+2*E;var le=ee<=R;var ue=ee+se>=N;var ce=se<=N;if(ce){if(le){ee=S._offset+2*E}else if(ue){ee=N-se}}re.attr("transform",s(te,ee));return re}var fe=d.selectAll("g.hovertext").data(e,function(e){return C(e)});fe.enter().append("g").classed("hovertext",true).each(function(){var e=n.select(this);e.append("rect").call(p.fill,p.addOpacity(f,.8));e.append("text").classed("name",true);e.append("path").style("stroke-width","1px");e.append("text").classed("nums",true).call(h.font,w,T)});fe.exit().remove();fe.each(function(e){var t=n.select(this).attr("transform","");var o=e.color;if(Array.isArray(o)){o=o[e.eventData[0].pointNumber]}var d=e.bgcolor||o;var v=p.combine(p.opacity(d)?d:p.defaultLine,f);var m=p.combine(p.opacity(o)?o:p.defaultLine,f);var g=e.borderColor||p.contrast(v);var y=O(e,F,i,a,I,t);var x=y[0];var _=y[1];var k=t.select("text.nums").call(h.font,e.fontFamily||w,e.fontSize||T,e.fontColor||g).text(x).attr("data-notex",1).call(c.positionText,0,0).call(c.convertToTspans,r);var A=t.select("text.name");var S=0;var C=0;if(_&&_!==x){A.call(h.font,e.fontFamily||w,e.fontSize||T,m).text(_).attr("data-notex",1).call(c.positionText,0,0).call(c.convertToTspans,r);var L=A.node().getBoundingClientRect();S=L.width+2*E;C=L.height+2*E}else{A.remove();t.select("rect").remove()}t.select("path").style({fill:v,stroke:g});var P=k.node().getBoundingClientRect();var D=e.xa._offset+(e.x0+e.x1)/2;var B=e.ya._offset+(e.y0+e.y1)/2;var j=Math.abs(e.x1-e.x0);var U=Math.abs(e.y1-e.y0);var H=P.width+M+E+S;var V,G;e.ty0=R-P.top;e.bx=P.width+2*E;e.by=Math.max(P.height+2*E,C);e.anchor="start";e.txwidth=P.width;e.tx2width=S;e.offset=0;if(u){e.pos=D;V=B+U/2+H<=N;G=B-U/2-H>=0;if((e.idealAlign==="top"||!V)&&G){B-=U/2;e.anchor="end"}else if(V){B+=U/2;e.anchor="start"}else e.anchor="middle"}else{e.pos=B;V=D+j/2+H<=z;G=D-j/2-H>=0;if((e.idealAlign==="left"||!V)&&G){D-=j/2;e.anchor="end"}else if(V){D+=j/2;e.anchor="start"}else{e.anchor="middle";var q=H/2;var Y=D+q-z;var W=D-q;if(Y>0)D-=Y;if(W<0)D+=-W}}k.attr("text-anchor",e.anchor);if(S)A.attr("text-anchor",e.anchor);t.attr("transform",s(D,B)+(u?l(b):""))});return fe}function O(e,t,r,n,a,i){var s="";var l="";if(e.nameOverride!==undefined)e.name=e.nameOverride;if(e.name){if(e.trace._meta){e.name=o.templateString(e.name,e.trace._meta)}s=B(e.name,e.nameLength)}if(e.zLabel!==undefined){if(e.xLabel!==undefined)l+="x: "+e.xLabel+"<br>";if(e.yLabel!==undefined)l+="y: "+e.yLabel+"<br>";if(e.trace.type!=="choropleth"&&e.trace.type!=="choroplethmapbox"){l+=(l?"z: ":"")+e.zLabel}}else if(t&&e[r.charAt(0)+"Label"]===a){l=e[(r.charAt(0)==="x"?"y":"x")+"Label"]||""}else if(e.xLabel===undefined){if(e.yLabel!==undefined&&e.trace.type!=="scattercarpet"){l=e.yLabel}}else if(e.yLabel===undefined)l=e.xLabel;else l="("+e.xLabel+", "+e.yLabel+")";if((e.text||e.text===0)&&!Array.isArray(e.text)){l+=(l?"<br>":"")+e.text}if(e.extraText!==undefined)l+=(l?"<br>":"")+e.extraText;if(i&&l===""&&!e.hovertemplate){if(s==="")i.remove();l=s}var u=n._d3locale;var c=e.hovertemplate||false;var f=e.hovertemplateLabels||e;var h=e.eventData[0]||{};if(c){l=o.hovertemplateString(c,f,u,h,e.trace._meta);l=l.replace(L,function(t,r){s=B(r,e.nameLength);return""})}return[l,s]}function P(e,t,r){var n=0;var a=1;var i=e.size();var o=new Array(i);var s=0;e.each(function(e){var n=e[t];var i=n._id.charAt(0)==="x";var l=n.range;if(s===0&&l&&l[0]>l[1]!==i){a=-1}o[s++]=[{datum:e,traceIndex:e.trace.index,dp:0,pos:e.pos,posref:e.posref,size:e.by*(i?T:1)/2,pmin:0,pmax:i?r.width:r.height}]});o.sort(function(e,t){return e[0].posref-t[0].posref||a*(t[0].traceIndex-e[0].traceIndex)});var l,u,c,f,h,p,d;function v(e){var t=e[0];var r=e[e.length-1];u=t.pmin-t.pos-t.dp+t.size;c=r.pos+r.dp+r.size-t.pmax;if(u>.01){for(h=e.length-1;h>=0;h--)e[h].dp+=u;l=false}if(c<.01)return;if(u<-.01){for(h=e.length-1;h>=0;h--)e[h].dp-=c;l=false}if(!l)return;var n=0;for(f=0;f<e.length;f++){p=e[f];if(p.pos+p.dp+p.size>t.pmax)n++}for(f=e.length-1;f>=0;f--){if(n<=0)break;p=e[f];if(p.pos>t.pmax-1){p.del=true;n--}}for(f=0;f<e.length;f++){if(n<=0)break;p=e[f];if(p.pos<t.pmin+1){p.del=true;n--;c=p.size*2;for(h=e.length-1;h>=0;h--)e[h].dp-=c}}for(f=e.length-1;f>=0;f--){if(n<=0)break;p=e[f];if(p.pos+p.dp+p.size>t.pmax){p.del=true;n--}}}while(!l&&n<=i){n++;l=true;f=0;while(f<o.length-1){var m=o[f];var g=o[f+1];var y=m[m.length-1];var x=g[0];u=y.pos+y.dp+y.size-x.pos-x.dp+x.size;if(u>.01&&y.pmin===x.pmin&&y.pmax===x.pmax){for(h=g.length-1;h>=0;h--)g[h].dp+=u;m.push.apply(m,g);o.splice(f+1,1);d=0;for(h=m.length-1;h>=0;h--)d+=m[h].dp;c=d/m.length;for(h=m.length-1;h>=0;h--)m[h].dp-=c;l=false}else f++}o.forEach(v)}for(f=o.length-1;f>=0;f--){var _=o[f];for(h=_.length-1;h>=0;h--){var b=_[h];var w=b.datum;w.offset=b.dp;w.del=b.del}}}function D(e,t,r,a){var i=function(e){return e*r};var o=function(e){return e*a};e.each(function(e){var r=n.select(this);if(e.del)return r.remove();var a=r.select("text.nums");var s=e.anchor;var l=s==="end"?-1:1;var u={start:1,end:-1,middle:0}[s];var f=u*(M+E);var p=f+u*(e.txwidth+E);var d=0;var v=e.offset;var m=s==="middle";if(m){f-=e.tx2width/2;p+=e.txwidth/2+E}if(t){v*=-A;d=e.offset*k}r.select("path").attr("d",m?"M-"+i(e.bx/2+e.tx2width/2)+","+o(v-e.by/2)+"h"+i(e.bx)+"v"+o(e.by)+"h-"+i(e.bx)+"Z":"M0,0L"+i(l*M+d)+","+o(M+v)+"v"+o(e.by/2-M)+"h"+i(l*e.bx)+"v-"+o(e.by)+"H"+i(l*M+d)+"V"+o(v-M)+"Z");var g=d+f;var y=v+e.ty0-e.by/2+E;var x=e.textAlign||"auto";if(x!=="auto"){if(x==="left"&&s!=="start"){a.attr("text-anchor","start");g=m?-e.bx/2-e.tx2width/2+E:-e.bx-E}else if(x==="right"&&s!=="end"){a.attr("text-anchor","end");g=m?e.bx/2-e.tx2width/2-E:e.bx+E}}a.call(c.positionText,i(g),o(y));if(e.tx2width){r.select("text.name").call(c.positionText,i(p+u*E+d),o(v+e.ty0-e.by/2+E));r.select("rect").call(h.setRect,i(p+(u-1)*e.tx2width/2+d),o(v-e.by/2-1),i(e.tx2width),o(e.by+2))}})}function R(e,t){var r=e.index;var n=e.trace||{};var i=e.cd[0];var s=e.cd[r]||{};function l(e){return e||a(e)&&e===0}var u=Array.isArray(r)?function(e,t){var a=o.castOption(i,r,e);return l(a)?a:o.extractOption({},n,"",t)}:function(e,t){return o.extractOption(s,n,e,t)};function c(t,r,n){var a=u(r,n);if(l(a))e[t]=a}c("hoverinfo","hi","hoverinfo");c("bgcolor","hbg","hoverlabel.bgcolor");c("borderColor","hbc","hoverlabel.bordercolor");c("fontFamily","htf","hoverlabel.font.family");c("fontSize","hts","hoverlabel.font.size");c("fontColor","htc","hoverlabel.font.color");c("nameLength","hnl","hoverlabel.namelength");c("textAlign","hta","hoverlabel.align");e.posref=t==="y"||t==="closest"&&n.orientation==="h"?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2;e.x0=o.constrain(e.x0,0,e.xa._length);e.x1=o.constrain(e.x1,0,e.xa._length);e.y0=o.constrain(e.y0,0,e.ya._length);e.y1=o.constrain(e.y1,0,e.ya._length);if(e.xLabelVal!==undefined){e.xLabel="xLabel"in e?e.xLabel:v.hoverLabelText(e.xa,e.xLabelVal);e.xVal=e.xa.c2d(e.xLabelVal)}if(e.yLabelVal!==undefined){e.yLabel="yLabel"in e?e.yLabel:v.hoverLabelText(e.ya,e.yLabelVal);e.yVal=e.ya.c2d(e.yLabelVal)}if(e.zLabelVal!==undefined&&e.zLabel===undefined){e.zLabel=String(e.zLabelVal)}if(!isNaN(e.xerr)&&!(e.xa.type==="log"&&e.xerr<=0)){var f=v.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;if(e.xerrneg!==undefined){e.xLabel+=" +"+f+" / -"+v.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text}else e.xLabel+=" ± "+f;if(t==="x")e.distance+=1}if(!isNaN(e.yerr)&&!(e.ya.type==="log"&&e.yerr<=0)){var h=v.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;if(e.yerrneg!==undefined){e.yLabel+=" +"+h+" / -"+v.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text}else e.yLabel+=" ± "+h;if(t==="y")e.distance+=1}var p=e.hoverinfo||e.trace.hoverinfo;if(p&&p!=="all"){p=Array.isArray(p)?p:p.split("+");if(p.indexOf("x")===-1)e.xLabel=undefined;if(p.indexOf("y")===-1)e.yLabel=undefined;if(p.indexOf("z")===-1)e.zLabel=undefined;if(p.indexOf("text")===-1)e.text=undefined;if(p.indexOf("name")===-1)e.name=undefined}return e}function z(e,t,r){var n=r.container;var a=r.fullLayout;var o=a._size;var s=r.event;var l=!!t.hLinePoint;var u=!!t.vLinePoint;var c,f;n.selectAll(".spikeline").remove();if(!(u||l))return;var d=p.combine(a.plot_bgcolor,a.paper_bgcolor);if(l){var m=t.hLinePoint;var g,y;c=m&&m.xa;f=m&&m.ya;var x=f.spikesnap;if(x==="cursor"){g=s.pointerX;y=s.pointerY}else{g=c._offset+m.x;y=f._offset+m.y}var _=i.readability(m.color,d)<1.5?p.contrast(d):m.color;var b=f.spikemode;var w=f.spikethickness;var T=f.spikecolor||_;var k=v.getPxPosition(e,f);var A,M;if(b.indexOf("toaxis")!==-1||b.indexOf("across")!==-1){if(b.indexOf("toaxis")!==-1){A=k;M=g}if(b.indexOf("across")!==-1){var E=f._counterDomainMin;var S=f._counterDomainMax;if(f.anchor==="free"){E=Math.min(E,f.position);S=Math.max(S,f.position)}A=o.l+E*o.w;M=o.l+S*o.w}n.insert("line",":first-child").attr({x1:A,x2:M,y1:y,y2:y,"stroke-width":w,stroke:T,"stroke-dasharray":h.dashStyle(f.spikedash,w)}).classed("spikeline",true).classed("crisp",true);n.insert("line",":first-child").attr({x1:A,x2:M,y1:y,y2:y,"stroke-width":w+2,stroke:d}).classed("spikeline",true).classed("crisp",true)}if(b.indexOf("marker")!==-1){n.insert("circle",":first-child").attr({cx:k+(f.side!=="right"?w:-w),cy:y,r:w,fill:T}).classed("spikeline",true)}}if(u){var C=t.vLinePoint;var L,I;c=C&&C.xa;f=C&&C.ya;var O=c.spikesnap;if(O==="cursor"){L=s.pointerX;I=s.pointerY}else{L=c._offset+C.x;I=f._offset+C.y}var P=i.readability(C.color,d)<1.5?p.contrast(d):C.color;var D=c.spikemode;var R=c.spikethickness;var z=c.spikecolor||P;var N=v.getPxPosition(e,c);var F,B;if(D.indexOf("toaxis")!==-1||D.indexOf("across")!==-1){if(D.indexOf("toaxis")!==-1){F=N;B=I}if(D.indexOf("across")!==-1){var j=c._counterDomainMin;var U=c._counterDomainMax;if(c.anchor==="free"){j=Math.min(j,c.position);U=Math.max(U,c.position)}F=o.t+(1-U)*o.h;B=o.t+(1-j)*o.h}n.insert("line",":first-child").attr({x1:L,x2:L,y1:F,y2:B,"stroke-width":R,stroke:z,"stroke-dasharray":h.dashStyle(c.spikedash,R)}).classed("spikeline",true).classed("crisp",true);n.insert("line",":first-child").attr({x1:L,x2:L,y1:F,y2:B,"stroke-width":R+2,stroke:d}).classed("spikeline",true).classed("crisp",true)}if(D.indexOf("marker")!==-1){n.insert("circle",":first-child").attr({cx:L,cy:N-(c.side!=="top"?R:-R),r:R,fill:z}).classed("spikeline",true)}}}function N(e,t,r){if(!r||r.length!==e._hoverdata.length)return true;for(var n=r.length-1;n>=0;n--){var a=r[n];var i=e._hoverdata[n];if(a.curveNumber!==i.curveNumber||String(a.pointNumber)!==String(i.pointNumber)||String(a.pointNumbers)!==String(i.pointNumbers)){return true}}return false}function F(e,t){if(!t)return true;if(t.vLinePoint!==e._spikepoints.vLinePoint||t.hLinePoint!==e._spikepoints.hLinePoint)return true;return false}function B(e,t){return c.plainText(e||"",{len:t,allowedTags:["br","sub","sup","b","i","em"]})}},{"../../lib":778,"../../lib/events":767,"../../lib/override_cursor":789,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../legend/defaults":695,"../legend/draw":696,"./constants":677,"./helpers":679,d3:169,"fast-isnumeric":241,tinycolor2:576}],681:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../color");var i=e("./helpers").isUnifiedHover;t.exports=function e(t,r,o,s){s=s||{};function l(e){if(!s.font[e]){s.font[e]=r.legend?r.legend.font[e]:r.font[e]}}if(r&&i(r.hovermode)){if(!s.font)s.font={};l("size");l("family");l("color");if(r.legend){if(!s.bgcolor)s.bgcolor=a.combine(r.legend.bgcolor,r.paper_bgcolor);if(!s.bordercolor)s.bordercolor=r.legend.bordercolor}else{if(!s.bgcolor)s.bgcolor=r.paper_bgcolor}}o("hoverlabel.bgcolor",s.bgcolor);o("hoverlabel.bordercolor",s.bordercolor);o("hoverlabel.namelength",s.namelength);n.coerceFont(o,"hoverlabel.font",s.font);o("hoverlabel.align",s.align)}},{"../../lib":778,"../color":643,"./helpers":679}],682:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function e(t,r,o){function s(e,i){if(r[e]!==undefined)return r[e];return n.coerce(t,r,a,e,i)}var l=s("clickmode");var u;if(r._has("cartesian")){if(l.indexOf("select")>-1){u="closest"}else{r._isHoriz=i(o,r);u=r._isHoriz?"y":"x"}}else u="closest";return s("hovermode",u)};function i(e,t){var r=t._scatterStackOpts||{};for(var n=0;n<e.length;n++){var a=e[n];var i=a.xaxis+a.yaxis;var o=r[i]||{};var s=o[a.stackgroup]||{};if(a.orientation!=="h"&&s.orientation!=="h"){return false}}return true}},{"../../lib":778,"./layout_attributes":684}],683:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../dragelement");var o=e("./helpers");var s=e("./layout_attributes");var l=e("./hover");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:s},attributes:e("./attributes"),layoutAttributes:s,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:o.getDistanceFunction,getClosest:o.getClosest,inbox:o.inbox,quadrature:o.quadrature,appendArrayPointValue:o.appendArrayPointValue,castHoverOption:c,castHoverinfo:f,hover:l.hover,unhover:i.unhover,loneHover:l.loneHover,loneUnhover:u,click:e("./click")};function u(e){var t=a.isD3Selection(e)?e:n.select(e);t.selectAll("g.hovertext").remove();t.selectAll(".spikeline").remove()}function c(e,t,r){return a.castOption(e,t,"hoverlabel."+r)}function f(e,t,r){function n(r){return a.coerceHoverinfo({hoverinfo:r},{_module:e._module},t)}return a.castOption(e,r,"hoverinfo",n)}},{"../../lib":778,"../dragelement":662,"./attributes":674,"./calc":675,"./click":676,"./constants":677,"./defaults":678,"./helpers":679,"./hover":680,"./layout_attributes":684,"./layout_defaults":685,"./layout_global_defaults":686,d3:169}],684:[function(e,t,r){"use strict";var n=e("./constants");var a=e("../../plots/font_attributes")({editType:"none"});a.family.dflt=n.HOVERFONT;a.size.dflt=n.HOVERFONTSIZE;t.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",false],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",false,"x unified","y unified"],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:a,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":856,"./constants":677}],685:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./helpers").isUnifiedHover;var i=e("./layout_attributes");var o=e("./hovermode_defaults");var s=e("./hoverlabel_defaults");t.exports=function e(t,r,l){function u(e,a){return n.coerce(t,r,i,e,a)}var c=o(t,r,l);if(c){u("hoverdistance");u("spikedistance",a(c)?-1:undefined)}var f=u("dragmode");if(f==="select")u("selectdirection");var h=r._has("mapbox");var p=r._has("geo");var d=r._basePlotModules.length;if(r.dragmode==="zoom"&&((h||p)&&d===1||h&&p&&d===2)){r.dragmode="pan"}s(t,r,u)}},{"../../lib":778,"./helpers":679,"./hoverlabel_defaults":681,"./hovermode_defaults":682,"./layout_attributes":684}],686:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./hoverlabel_defaults");var i=e("./layout_attributes");t.exports=function e(t,r){function o(e,a){return n.coerce(t,r,i,e,a)}a(t,r,o)}},{"../../lib":778,"./hoverlabel_defaults":681,"./layout_attributes":684}],687:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../lib/regex").counter;var i=e("../../plots/domain").attributes;var o=e("../../plots/cartesian/constants").idRegex;var s=e("../../plot_api/plot_template");var l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:true,dimensions:2,items:{valType:"enumerated",values:[a("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:i({name:"grid",editType:"plot",noGridCell:true},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(e,t,r){var n=t[r+"axes"];var a=Object.keys((e._splomAxes||{})[r]||{});if(Array.isArray(n))return n;if(a.length)return a}function c(e,t){var r=e.grid||{};var a=u(t,r,"x");var i=u(t,r,"y");if(!e.grid&&!a&&!i)return;var o=Array.isArray(r.subplots)&&Array.isArray(r.subplots[0]);var c=Array.isArray(a);var h=Array.isArray(i);var p=c&&a!==r.xaxes&&h&&i!==r.yaxes;var d,v;if(o){d=r.subplots.length;v=r.subplots[0].length}else{if(h)d=i.length;if(c)v=a.length}var m=s.newContainer(t,"grid");function g(e,t){return n.coerce(r,m,l,e,t)}var y=g("rows",d);var x=g("columns",v);if(!(y*x>1)){delete t.grid;return}if(!o&&!c&&!h){var _=g("pattern")==="independent";if(_)o=true}m._hasSubplotGrid=o;var b=g("roworder");var w=b==="top to bottom";var T=o?.2:.1;var k=o?.3:.1;var A,M;if(p&&t._splomGridDflt){A=t._splomGridDflt.xside;M=t._splomGridDflt.yside}m._domains={x:f("x",g,T,A,x),y:f("y",g,k,M,y,w)}}function f(e,t,r,n,a,i){var o=t(e+"gap",r);var s=t("domain."+e);t(e+"side",n);var l=new Array(a);var u=s[0];var c=(s[1]-u)/(a-o);var f=c*(1-o);for(var h=0;h<a;h++){var p=u+c*h;l[i?a-1-h:h]=[p,p+f]}return l}function h(e,t){var r=t.grid;if(!r||!r._domains)return;var n=e.grid||{};var a=t._subplots;var i=r._hasSubplotGrid;var o=r.rows;var s=r.columns;var l=r.pattern==="independent";var c,f,h,d,v,m,g;var y=r._axisMap={};if(i){var x=n.subplots||[];m=r.subplots=new Array(o);var _=1;for(c=0;c<o;c++){var b=m[c]=new Array(s);var w=x[c]||[];for(f=0;f<s;f++){if(l){v=_===1?"xy":"x"+_+"y"+_;_++}else v=w[f];b[f]="";if(a.cartesian.indexOf(v)!==-1){g=v.indexOf("y");h=v.slice(0,g);d=v.slice(g);if(y[h]!==undefined&&y[h]!==f||y[d]!==undefined&&y[d]!==c){continue}b[f]=v;y[h]=f;y[d]=c}}}}else{var T=u(t,n,"x");var k=u(t,n,"y");r.xaxes=p(T,a.xaxis,s,y,"x");r.yaxes=p(k,a.yaxis,o,y,"y")}var A=r._anchors={};var M=r.roworder==="top to bottom";for(var E in y){var S=E.charAt(0);var C=r[S+"side"];var L,I,O;if(C.length<8){A[E]="free"}else if(S==="x"){if(C.charAt(0)==="t"===M){L=0;I=1;O=o}else{L=o-1;I=-1;O=-1}if(i){var P=y[E];for(c=L;c!==O;c+=I){v=m[c][P];if(!v)continue;g=v.indexOf("y");if(v.slice(0,g)===E){A[E]=v.slice(g);break}}}else{for(c=L;c!==O;c+=I){d=r.yaxes[c];if(a.cartesian.indexOf(E+d)!==-1){A[E]=d;break}}}}else{if(C.charAt(0)==="l"){L=0;I=1;O=s}else{L=s-1;I=-1;O=-1}if(i){var D=y[E];for(c=L;c!==O;c+=I){v=m[D][c];if(!v)continue;g=v.indexOf("y");if(v.slice(g)===E){A[E]=v.slice(0,g);break}}}else{for(c=L;c!==O;c+=I){h=r.xaxes[c];if(a.cartesian.indexOf(h+E)!==-1){A[E]=h;break}}}}}}function p(e,t,r,n,a){var i=new Array(r);var o;function s(e,r){if(t.indexOf(r)!==-1&&n[r]===undefined){i[e]=r;n[r]=e}else i[e]=""}if(Array.isArray(e)){for(o=0;o<r;o++){s(o,e[o])}}else{s(0,a);for(o=1;o<r;o++){s(o,a+(o+1))}}return i}t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:c,contentDefaults:h}},{"../../lib":778,"../../lib/regex":795,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/domain":855}],688:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/constants");var a=e("../../plot_api/plot_template").templatedArray;var i=e("../../constants/axis_placeable_objects");t.exports=a("image",{visible:{valType:"boolean",dflt:true,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",n.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",n.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":746,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834}],689:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib/to_log_range");t.exports=function e(t,r,i,o){r=r||{};var s=i==="log"&&r.type==="linear";var l=i==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.images;var c=r._id.charAt(0);var f;var h;for(var p=0;p<u.length;p++){f=u[p];h="images["+p+"].";if(f[c+"ref"]===r._id){var d=f[c];var v=f["size"+c];var m=null;var g=null;if(s){m=a(d,r.range);var y=v/Math.pow(10,m)/2;g=2*Math.log(y+Math.sqrt(1+y*y))/Math.LN10}else{m=Math.pow(10,d);g=m*(Math.pow(10,v/2)-Math.pow(10,-v/2))}if(!n(m)){m=null;g=null}else if(!n(g))g=null;o(h+c,m);o(h+"size"+c,g)}}}},{"../../lib/to_log_range":805,"fast-isnumeric":241}],690:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("./attributes");var s="images";t.exports=function e(t,r){var n={name:s,handleItemDefaults:l};i(t,r,n)};function l(e,t,r){function i(r,a){return n.coerce(e,t,o,r,a)}var s=i("source");var l=i("visible",!!s);if(!l)return t;i("layer");i("xanchor");i("yanchor");i("sizex");i("sizey");i("sizing");i("opacity");var u={_fullLayout:r};var c=["x","y"];for(var f=0;f<2;f++){var h=c[f];var p=a.coerceRef(e,t,u,h,"paper",undefined);if(p!=="paper"){var d=a.getFromId(u,p);d._imgIndices.push(t._index)}a.coercePosition(t,u,i,p,h,0)}return t}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":688}],691:[function(e,t,r){"use strict";var n=e("d3");var a=e("../drawing");var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/axis_ids");var s=e("../../constants/xmlns_namespaces");t.exports=function e(t){var r=t._fullLayout;var l=[];var u={};var c=[];var f;var h;for(h=0;h<r.images.length;h++){var p=r.images[h];if(p.visible){if(p.layer==="below"&&p.xref!=="paper"&&p.yref!=="paper"){f=o.ref2id(p.xref)+o.ref2id(p.yref);var d=r._plots[f];if(!d){c.push(p);continue}if(d.mainplot){f=d.mainplot.id}if(!u[f]){u[f]=[]}u[f].push(p)}else if(p.layer==="above"){l.push(p)}else{c.push(p)}}}var v={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function m(e){var r=n.select(this);if(this._imgSrc===e.source){return}r.attr("xmlns",s.svg);if(e.source&&e.source.slice(0,5)==="data:"){r.attr("xlink:href",e.source);this._imgSrc=e.source}else{var a=new Promise(function(t){var n=new Image;this.img=n;n.setAttribute("crossOrigin","anonymous");n.onerror=a;n.onload=function(){var e=document.createElement("canvas");e.width=this.width;e.height=this.height;var n=e.getContext("2d");n.drawImage(this,0,0);var a=e.toDataURL("image/png");r.attr("xlink:href",a);t()};r.on("error",a);n.src=e.source;this._imgSrc=e.source;function a(){r.remove();t()}}.bind(this));t._promises.push(a)}}function g(e){var o=n.select(this);var s=i.getFromId(t,e.xref);var l=i.getFromId(t,e.yref);var u=i.getRefType(e.xref)==="domain";var c=i.getRefType(e.yref)==="domain";var f=r._size;var h,p;if(s!==undefined){h=typeof e.xref==="string"&&u?s._length*e.sizex:Math.abs(s.l2p(e.sizex)-s.l2p(0))}else{h=e.sizex*f.w}if(l!==undefined){p=typeof e.yref==="string"&&c?l._length*e.sizey:Math.abs(l.l2p(e.sizey)-l.l2p(0))}else{p=e.sizey*f.h}var d=h*v.x[e.xanchor].offset;var m=p*v.y[e.yanchor].offset;var g=v.x[e.xanchor].sizing+v.y[e.yanchor].sizing;var y,x;if(s!==undefined){y=typeof e.xref==="string"&&u?s._length*e.x+s._offset:s.r2p(e.x)+s._offset}else{y=e.x*f.w+f.l}y+=d;if(l!==undefined){x=typeof e.yref==="string"&&c?l._length*(1-e.y)+l._offset:l.r2p(e.y)+l._offset}else{x=f.h-e.y*f.h+f.t}x+=m;switch(e.sizing){case"fill":g+=" slice";break;case"stretch":g="none";break}o.attr({x:y,y:x,width:h,height:p,preserveAspectRatio:g,opacity:e.opacity});var _=s&&i.getRefType(e.xref)!=="domain"?s._id:"";var b=l&&i.getRefType(e.yref)!=="domain"?l._id:"";var w=_+b;a.setClipUrl(o,w?"clip"+r._uid+w:null,t)}var y=r._imageLowerLayer.selectAll("image").data(c);var x=r._imageUpperLayer.selectAll("image").data(l);y.enter().append("image");x.enter().append("image");y.exit().remove();x.exit().remove();y.each(function(e){m.bind(this)(e);g.bind(this)(e)});x.each(function(e){m.bind(this)(e);g.bind(this)(e)});var _=Object.keys(r._plots);for(h=0;h<_.length;h++){f=_[h];var b=r._plots[f];if(!b.imagelayer)continue;var w=b.imagelayer.selectAll("image").data(u[f]||[]);w.enter().append("image");w.exit().remove();w.each(function(e){m.bind(this)(e);g.bind(this)(e)})}}},{"../../constants/xmlns_namespaces":754,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_ids":831,"../drawing":665,d3:169}],692:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":840,"./attributes":688,"./convert_coords":689,"./defaults":690,"./draw":691}],693:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:n({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",false],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",false],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:n({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":856,"../color/attributes":642}],694:[function(e,t,r){"use strict";t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],695:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../../plot_api/plot_template");var o=e("./attributes");var s=e("../../plots/layout_attributes");var l=e("./helpers");t.exports=function e(t,r,u){var c=t.legend||{};var f=0;var h=false;var p="normal";for(var d=0;d<u.length;d++){var v=u[d];if(!v.visible)continue;if(v.showlegend||v._dfltShowLegend&&!(v._module&&v._module.attributes&&v._module.attributes.showlegend&&v._module.attributes.showlegend.dflt===false)){f++;if(v.showlegend){h=true;if(n.traceIs(v,"pie-like")||v._input.showlegend===true){f++}}}if(n.traceIs(v,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(v.fill)!==-1){p=l.isGrouped({traceorder:p})?"grouped+reversed":"reversed"}if(v.legendgroup!==undefined&&v.legendgroup!==""){p=l.isReversed({traceorder:p})?"reversed+grouped":"grouped"}}var m=a.coerce(t,r,s,"showlegend",h&&f>1);if(m===false&&!c.uirevision)return;var g=i.newContainer(r,"legend");function y(e,t){return a.coerce(c,g,o,e,t)}y("uirevision",r.uirevision);if(m===false)return;y("bgcolor",r.paper_bgcolor);y("bordercolor");y("borderwidth");a.coerceFont(y,"font",r.font);var x=y("orientation");var _,b,w;if(x==="h"){_=0;if(n.getComponentMethod("rangeslider","isVisible")(t.xaxis)){b=1.1;w="bottom"}else{b=-.1;w="top"}}else{_=1.02;b=1;w="auto"}y("traceorder",p);if(l.isGrouped(r.legend))y("tracegroupgap");y("itemsizing");y("itemwidth");y("itemclick");y("itemdoubleclick");y("x",_);y("xanchor");y("y",b);y("yanchor",w);y("valign");a.noneOrAll(c,g,["x","y"]);var T=y("title.text");if(T){y("title.side",x==="h"?"left":"top");a.coerceFont(y,"title.font",r.font)}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/layout_attributes":882,"../../registry":911,"./attributes":693,"./helpers":699}],696:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib/events");var l=e("../dragelement");var u=e("../drawing");var c=e("../color");var f=e("../../lib/svg_text_utils");var h=e("./handle_click");var p=e("./constants");var d=e("../../constants/alignment");var v=d.LINE_SPACING;var m=d.FROM_TL;var g=d.FROM_BR;var y=e("./get_legend_data");var x=e("./style");var _=e("./helpers");t.exports=function e(t,r){var s=t._fullLayout;var f="legend"+s._uid;var h;if(!r){r=s.legend||{};r._main=true;h=s._infolayer}else{h=r.layer;f+="-hover"}if(!h)return;if(!t._legendMouseDownTime)t._legendMouseDownTime=0;var d;if(r._main){if(!t.calcdata)return;d=s.showlegend&&y(t.calcdata,r)}else{if(!r.entries)return;d=y(r.entries,r)}var v=s.hiddenlabels||[];if(r._main&&(!s.showlegend||!d.length)){h.selectAll(".legend").remove();s._topdefs.select("#"+f).remove();return i.autoMargin(t,"legend")}var g=a.ensureSingle(h,"g","legend",function(e){if(r._main)e.attr("pointer-events","all")});var _=a.ensureSingleById(s._topdefs,"clipPath",f,function(e){e.append("rect")});var T=a.ensureSingle(g,"rect","bg",function(e){e.attr("shape-rendering","crispEdges")});T.call(c.stroke,r.bordercolor).call(c.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px");var M=a.ensureSingle(g,"g","scrollbox");var E=r.title;r._titleWidth=0;r._titleHeight=0;if(E.text){var O=a.ensureSingle(M,"text","legendtitletext");O.attr("text-anchor","start").call(u.font,E.font).text(E.text);A(O,M,t,r)}else{M.selectAll(".legendtitletext").remove()}var P=a.ensureSingle(g,"rect","scrollbar",function(e){e.attr(p.scrollBarEnterAttrs).call(c.fill,p.scrollBarColor)});var D=M.selectAll("g.groups").data(d);D.enter().append("g").attr("class","groups");D.exit().remove();var R=D.selectAll("g.traces").data(a.identity);R.enter().append("g").attr("class","traces");R.exit().remove();R.style("opacity",function(e){var t=e[0].trace;if(o.traceIs(t,"pie-like")){return v.indexOf(e[0].label)!==-1?.5:1}else{return t.visible==="legendonly"?.5:1}}).each(function(){n.select(this).call(w,t,r)}).call(x,t,r).each(function(){if(r._main)n.select(this).call(k,t)});a.syncOrAsync([i.previousPromises,function(){return S(t,D,R,r)},function(){if(r._main&&C(t))return;var e=s._size;var i=r.borderwidth;var c=e.l+e.w*r.x-m[L(r)]*r._width;var d=e.t+e.h*(1-r.y)-m[I(r)]*r._effHeight;if(r._main&&s.margin.autoexpand){var v=c;var y=d;c=a.constrain(c,0,s.width-r._width);d=a.constrain(d,0,s.height-r._effHeight);if(c!==v){a.log("Constrain legend.x to make legend fit inside graph")}if(d!==y){a.log("Constrain legend.y to make legend fit inside graph")}}if(r._main)u.setTranslate(g,c,d);P.on(".drag",null);g.on("wheel",null);if(!r._main||r._height<=r._maxHeight||t._context.staticPlot){var x=r._effHeight;if(!r._main)x=r._height;T.attr({width:r._width-i,height:x-i,x:i/2,y:i/2});u.setTranslate(M,0,0);_.select("rect").attr({width:r._width-2*i,height:x-2*i,x:i,y:i});u.setClipUrl(M,f,t);u.setRect(P,0,0,0,0);delete r._scrollY}else{var w=Math.max(p.scrollBarMinHeight,r._effHeight*r._effHeight/r._height);var k=r._effHeight-w-2*p.scrollBarMargin;var A=r._height-r._effHeight;var E=k/A;var S=Math.min(r._scrollY||0,A);T.attr({width:r._width-2*i+p.scrollBarWidth+p.scrollBarMargin,height:r._effHeight-i,x:i/2,y:i/2});_.select("rect").attr({width:r._width-2*i+p.scrollBarWidth+p.scrollBarMargin,height:r._effHeight-2*i,x:i,y:i+S});u.setClipUrl(M,f,t);j(S,w,E);g.on("wheel",function(){S=a.constrain(r._scrollY+n.event.deltaY/k*A,0,A);j(S,w,E);if(S!==0&&S!==A){n.event.preventDefault()}});var O,D,R;var z=function(e,t,r){var n=(r-t)/E+e;return a.constrain(n,0,A)};var N=function(e,t,r){var n=(t-r)/E+e;return a.constrain(n,0,A)};var F=n.behavior.drag().on("dragstart",function(){var e=n.event.sourceEvent;if(e.type==="touchstart"){O=e.changedTouches[0].clientY}else{O=e.clientY}R=S}).on("drag",function(){var e=n.event.sourceEvent;if(e.buttons===2||e.ctrlKey)return;if(e.type==="touchmove"){D=e.changedTouches[0].clientY}else{D=e.clientY}S=z(R,O,D);j(S,w,E)});P.call(F);var B=n.behavior.drag().on("dragstart",function(){var e=n.event.sourceEvent;if(e.type==="touchstart"){O=e.changedTouches[0].clientY;R=S}}).on("drag",function(){var e=n.event.sourceEvent;if(e.type==="touchmove"){D=e.changedTouches[0].clientY;S=N(R,O,D);j(S,w,E)}});M.call(B)}function j(e,n,a){r._scrollY=t._fullLayout.legend._scrollY=e;u.setTranslate(M,0,-e);u.setRect(P,r._width,p.scrollBarMargin+e*a,p.scrollBarWidth,n);_.select("rect").attr("y",i+e)}if(t._context.edits.legendPosition){var U,H,V,G;g.classed("cursor-move",true);l.init({element:g.node(),gd:t,prepFn:function(){var e=u.getTranslate(g);V=e.x;G=e.y},moveFn:function(t,n){var a=V+t;var i=G+n;u.setTranslate(g,a,i);U=l.align(a,0,e.l,e.l+e.w,r.xanchor);H=l.align(i,0,e.t+e.h,e.t,r.yanchor)},doneFn:function(){if(U!==undefined&&H!==undefined){o.call("_guiRelayout",t,{"legend.x":U,"legend.y":H})}},clickFn:function(e,r){var n=h.selectAll("g.traces").filter(function(){var e=this.getBoundingClientRect();return r.clientX>=e.left&&r.clientX<=e.right&&r.clientY>=e.top&&r.clientY<=e.bottom});if(n.size()>0){b(t,g,n,e,r)}}})}}],t)};function b(e,t,r,n,a){var i=r.data()[0][0].trace;var l={event:a,node:r.node(),curveNumber:i.index,expandedIndex:i._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};if(i._group){l.group=i._group}if(o.traceIs(i,"pie-like")){l.label=r.datum()[0].label}var u=s.triggerHandler(e,"plotly_legendclick",l);if(u===false)return;if(n===1){t._clickTimeout=setTimeout(function(){h(r,e,n)},e._context.doubleClickDelay)}else if(n===2){if(t._clickTimeout)clearTimeout(t._clickTimeout);e._legendMouseDownTime=0;var c=s.triggerHandler(e,"plotly_legenddoubleclick",l);if(c!==false)h(r,e,n)}}function w(e,t,r){var n=e.data()[0][0];var i=n.trace;var s=o.traceIs(i,"pie-like");var l=i.index;var c=r._main&&t._context.edits.legendText&&!s;var h=r._maxNameLength;var d;if(!r.entries){d=s?n.label:i.name;if(i._meta){d=a.templateString(d,i._meta)}}else{d=n.text}var v=a.ensureSingle(e,"text","legendtext");v.attr("text-anchor","start").call(u.font,r.font).text(c?T(d,h):d);var m=r.itemwidth+p.itemGap*2;f.positionText(v,m,0);if(c){v.call(f.makeEditable,{gd:t,text:d}).call(A,e,t,r).on("edit",function(i){this.text(T(i,h)).call(A,e,t,r);var s=n.trace._fullInput||{};var u={};if(o.hasTransform(s,"groupby")){var c=o.getTransformIndices(s,"groupby");var f=c[c.length-1];var p=a.keyedContainer(s,"transforms["+f+"].styles","target","value.name");p.set(n.trace._group,i);u=p.constructUpdate()}else{u.name=i}return o.call("_guiRestyle",t,u,l)})}else{A(v,e,t,r)}}function T(e,t){var r=Math.max(4,t);if(e&&e.trim().length>=r/2)return e;e=e||"";for(var n=r-e.length;n>0;n--)e+=" ";return e}function k(e,t){var r=t._context.doubleClickDelay;var i;var o=1;var s=a.ensureSingle(e,"rect","legendtoggle",function(e){if(!t._context.staticPlot){e.style("cursor","pointer").attr("pointer-events","all")}e.call(c.fill,"rgba(0,0,0,0)")});if(t._context.staticPlot)return;s.on("mousedown",function(){i=(new Date).getTime();if(i-t._legendMouseDownTime<r){o+=1}else{o=1;t._legendMouseDownTime=i}});s.on("mouseup",function(){if(t._dragged||t._editing)return;var a=t._fullLayout.legend;if((new Date).getTime()-t._legendMouseDownTime>r){o=Math.max(o-1,1)}b(t,a,e,o,n.event)})}function A(e,t,r,n){if(!n._main)e.attr("data-notex",true);f.convertToTspans(e,r,function(){M(t,r,n)})}function M(e,t,r){var n=e.data()[0][0];if(r._main&&n&&!n.trace.showlegend){e.remove();return}var a=e.select("g[class*=math-group]");var i=a.node();if(!r)r=t._fullLayout.legend;var o=r.borderwidth;var s=(n?r:r.title).font.size*v;var l,c;if(i){var h=u.bBox(i);l=h.height;c=h.width;if(n){u.setTranslate(a,0,l*.25)}else{u.setTranslate(a,o,l*.75+o)}}else{var d=e.select(n?".legendtext":".legendtitletext");var m=f.lineCount(d);var g=d.node();l=s*m;c=g?u.bBox(g).width:0;var y=s*((m-1)/2-.3);if(n){var x=r.itemwidth+p.itemGap*2;f.positionText(d,x,-y)}else{f.positionText(d,p.titlePad+o,s+o)}}if(n){n.lineHeight=s;n.height=Math.max(l,16)+3;n.width=c}else{r._titleWidth=c;r._titleHeight=l}}function E(e){var t=0;var r=0;var n=e.title.side;if(n){if(n.indexOf("left")!==-1){t=e._titleWidth}if(n.indexOf("top")!==-1){r=e._titleHeight}}return[t,r]}function S(e,t,r,a){var i=e._fullLayout;if(!a)a=i.legend;var o=i._size;var s=_.isVertical(a);var l=_.isGrouped(a);var c=a.borderwidth;var f=2*c;var h=p.itemGap;var d=a.itemwidth+h*2;var v=2*(c+h);var m=I(a);var g=a.y<0||a.y===0&&m==="top";var y=a.y>1||a.y===1&&m==="bottom";a._maxHeight=Math.max(g||y?i.height/2:o.h,30);var x=0;a._width=0;a._height=0;var b=E(a);if(s){r.each(function(e){var t=e[0].height;u.setTranslate(this,c+b[0],c+b[1]+a._height+t/2+h);a._height+=t;a._width=Math.max(a._width,e[0].width)});x=d+a._width;a._width+=h+d+f;a._height+=v;if(l){t.each(function(e,t){u.setTranslate(this,0,t*a.tracegroupgap)});a._height+=(a._lgroupsLength-1)*a.tracegroupgap}}else{var w=L(a);var T=a.x<0||a.x===0&&w==="right";var k=a.x>1||a.x===1&&w==="left";var A=y||g;var M=i.width/2;a._maxWidth=Math.max(T?A&&w==="left"?o.l+o.w:M:k?A&&w==="right"?o.r+o.w:M:o.w,2*d);var S=0;var C=0;r.each(function(e){var t=e[0].width+d;S=Math.max(S,t);C+=t});x=null;var O=0;if(l){var P=0;var D=0;var R=0;t.each(function(){var e=0;var t=0;n.select(this).selectAll("g.traces").each(function(r){var n=r[0].height;u.setTranslate(this,b[0],b[1]+c+h+n/2+t);t+=n;e=Math.max(e,d+r[0].width)});P=Math.max(P,t);var r=e+h;if(r+c+D>a._maxWidth){O=Math.max(O,D);D=0;R+=P+a.tracegroupgap;P=t}u.setTranslate(this,D,R);D+=r});a._width=Math.max(O,D)+c;a._height=R+P+v}else{var z=r.size();var N=C+f+(z-1)*h<a._maxWidth;var F=0;var B=0;var j=0;var U=0;r.each(function(e){var t=e[0].height;var r=d+e[0].width;var n=(N?r:S)+h;if(n+c+B-h>=a._maxWidth){O=Math.max(O,U);B=0;j+=F;a._height+=F;F=0}u.setTranslate(this,b[0]+c+B,b[1]+c+j+t/2+h);U=B+r+h;B+=n;F=Math.max(F,t)});if(N){a._width=B+f;a._height=F+v}else{a._width=Math.max(O,U)+f;a._height+=F+v}}}a._width=Math.ceil(Math.max(a._width+b[0],a._titleWidth+2*(c+p.titlePad)));a._height=Math.ceil(Math.max(a._height+b[1],a._titleHeight+2*(c+p.itemGap)));a._effHeight=Math.min(a._height,a._maxHeight);var H=e._context.edits;var V=H.legendText||H.legendPosition;r.each(function(e){var t=n.select(this).select(".legendtoggle");var r=e[0].height;var a=V?d:x||d+e[0].width;if(!s)a+=h/2;u.setRect(t,0,-r/2,a,r)})}function C(e){var t=e._fullLayout;var r=t.legend;var n=L(r);var a=I(r);return i.autoMargin(e,"legend",{x:r.x,y:r.y,l:r._width*m[n],r:r._width*g[n],b:r._effHeight*g[a],t:r._effHeight*m[a]})}function L(e){return a.isRightAnchor(e)?"right":a.isCenterAnchor(e)?"center":"left"}function I(e){return a.isBottomAnchor(e)?"bottom":a.isMiddleAnchor(e)?"middle":"top"}},{"../../constants/alignment":745,"../../lib":778,"../../lib/events":767,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"./constants":694,"./get_legend_data":697,"./handle_click":698,"./helpers":699,"./style":701,d3:169}],697:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("./helpers");t.exports=function e(t,r){var i={};var o=[];var s=false;var l={};var u=0;var c=0;var f,h;var p=r._main;function d(e,t){if(e===""||!a.isGrouped(r)){var n="~~i"+u;o.push(n);i[n]=[[t]];u++}else if(o.indexOf(e)===-1){o.push(e);s=true;i[e]=[[t]]}else{i[e].push([t])}}for(f=0;f<t.length;f++){var v=t[f];var m=v[0];var g=m.trace;var y=g.legendgroup;if(p&&(!g.visible||!g.showlegend))continue;if(n.traceIs(g,"pie-like")){if(!l[y])l[y]={};for(h=0;h<v.length;h++){var x=v[h].label;if(!l[y][x]){d(y,{label:x,color:v[h].color,i:v[h].i,trace:g,pts:v[h].pts});l[y][x]=true;c=Math.max(c,(x||"").length)}}}else{d(y,m);c=Math.max(c,(g.name||"").length)}}if(!o.length)return[];var _=o.length;var b;var w;if(s&&a.isGrouped(r)){w=new Array(_);for(f=0;f<_;f++){b=i[o[f]];w[f]=a.isReversed(r)?b.reverse():b}}else{w=[new Array(_)];for(f=0;f<_;f++){b=i[o[f]][0];w[0][a.isReversed(r)?_-f-1:f]=b}_=1}r._lgroupsLength=_;r._maxNameLength=c;return w}},{"../../registry":911,"./helpers":699}],698:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");var i=true;t.exports=function e(t,r,o){var s=r._fullLayout;if(r._dragged||r._editing)return;var l=s.legend.itemclick;var u=s.legend.itemdoubleclick;if(o===1&&l==="toggle"&&u==="toggleothers"&&i&&r.data&&r._context.showTips){n.notifier(n._(r,"Double-click on legend to isolate one trace"),"long");i=false}else{i=false}var c;if(o===1)c=l;else if(o===2)c=u;if(!c)return;var f=s.hiddenlabels?s.hiddenlabels.slice():[];var h=t.data()[0][0];var p=r._fullData;var d=h.trace;var v=d.legendgroup;var m,g,y,x,_,b;var w={};var T=[];var k=[];var A=[];function M(e,t,r){var n=T.indexOf(e);var a=w[t];if(!a){a=w[t]=[]}if(T.indexOf(e)===-1){T.push(e);n=T.length-1}a[n]=r;return n}function E(e,t){var r=e._fullInput;if(a.hasTransform(r,"groupby")){var i=k[r.index];if(!i){var o=a.getTransformIndices(r,"groupby");var s=o[o.length-1];i=n.keyedContainer(r,"transforms["+s+"].styles","target","value.visible");k[r.index]=i}var l=i.get(e._group);if(l===undefined){l=true}if(l!==false){i.set(e._group,t)}A[r.index]=M(r.index,"visible",r.visible===false?false:true)}else{var u=r.visible===false?false:t;M(r.index,"visible",u)}}if(a.traceIs(d,"pie-like")){var S=h.label;var C=f.indexOf(S);if(c==="toggle"){if(C===-1)f.push(S);else f.splice(C,1)}else if(c==="toggleothers"){f=[];r.calcdata[0].forEach(function(e){if(S!==e.label){f.push(e.label)}});if(r._fullLayout.hiddenlabels&&r._fullLayout.hiddenlabels.length===f.length&&C===-1){f=[]}}a.call("_guiRelayout",r,"hiddenlabels",f)}else{var L=v&&v.length;var I=[];var O;if(L){for(m=0;m<p.length;m++){O=p[m];if(!O.visible)continue;if(O.legendgroup===v){I.push(m)}}}if(c==="toggle"){var P;switch(d.visible){case true:P="legendonly";break;case false:P=false;break;case"legendonly":P=true;break}if(L){for(m=0;m<p.length;m++){if(p[m].visible!==false&&p[m].legendgroup===v){E(p[m],P)}}}else{E(d,P)}}else if(c==="toggleothers"){var D,R,z,N;var F=true;for(m=0;m<p.length;m++){D=p[m]===d;z=p[m].showlegend!==true;if(D||z)continue;R=L&&p[m].legendgroup===v;if(!R&&p[m].visible===true&&!a.traceIs(p[m],"notLegendIsolatable")){F=false;break}}for(m=0;m<p.length;m++){if(p[m].visible===false)continue;if(a.traceIs(p[m],"notLegendIsolatable")){continue}switch(d.visible){case"legendonly":E(p[m],true);break;case true:N=F?true:"legendonly";D=p[m]===d;z=p[m].showlegend!==true&&!p[m].legendgroup;R=D||L&&p[m].legendgroup===v;E(p[m],R||z?true:N);break}}}for(m=0;m<k.length;m++){y=k[m];if(!y)continue;var B=y.constructUpdate();var j=Object.keys(B);for(g=0;g<j.length;g++){x=j[g];b=w[x]=w[x]||[];b[A[m]]=B[x]}}_=Object.keys(w);for(m=0;m<_.length;m++){x=_[m];for(g=0;g<T.length;g++){if(!w[x].hasOwnProperty(g)){w[x][g]=undefined}}}a.call("_guiRestyle",r,w,T)}}},{"../../lib":778,"../../registry":911}],699:[function(e,t,r){"use strict";r.isGrouped=function e(t){return(t.traceorder||"").indexOf("grouped")!==-1};r.isVertical=function e(t){return t.orientation!=="h"};r.isReversed=function e(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],700:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":693,"./defaults":695,"./draw":696,"./style":701}],701:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../lib");var o=i.strTranslate;var s=e("../drawing");var l=e("../color");var u=e("../colorscale/helpers").extractOpts;var c=e("../../traces/scatter/subtypes");var f=e("../../traces/pie/style_one");var h=e("../../traces/pie/helpers").castOption;var p=e("./constants");var d=12;var v=5;var m=2;var g=10;var y=5;t.exports=function e(t,r,_){var b=r._fullLayout;if(!_)_=b.legend;var w=_.itemsizing==="constant";var T=_.itemwidth;var k=(T+p.itemGap*2)/2;var A=o(k,0);var M=function(e,t,r,n){var a;if(e+1){a=e}else if(t&&t.width>0){a=t.width}else{return 0}return w?n:Math.min(a,r)};t.each(function(e){var t=n.select(this);var r=i.ensureSingle(t,"g","layers");r.style("opacity",e[0].trace.opacity);var a=_.valign;var s=e[0].lineHeight;var l=e[0].height;if(a==="middle"||!s||!l){r.attr("transform",null)}else{var u={top:1,bottom:-1}[a];var c=u*(.5*(s-l+3));r.attr("transform",o(0,c))}var f=r.selectAll("g.legendfill").data([e]);f.enter().append("g").classed("legendfill",true);var h=r.selectAll("g.legendlines").data([e]);h.enter().append("g").classed("legendlines",true);var p=r.selectAll("g.legendsymbols").data([e]);p.enter().append("g").classed("legendsymbols",true);p.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",true)}).each(B).each(C).each(I).each(L).each(P).each(N).each(z).each(E).each(S).each(D).each(R);function E(e){var t=e[0];var a=t.trace;var o=a.visible&&a.fill&&a.fill!=="none";var l=c.hasLines(a);var f=a.contours;var h=false;var p=false;var d,m;var y=u(a);var _=y.colorscale;var b=y.reversescale;var w=function(e){if(e.size()){var t="legendfill-"+a.uid;s.gradient(e,r,t,x(b),_,"fill")}};var k=function(e){if(e.size()){var t="legendline-"+a.uid;s.lineGroupStyle(e);s.gradient(e,r,t,x(b),_,"stroke")}};if(f){var A=f.coloring;if(A==="lines"){h=true}else{l=A==="none"||A==="heatmap"||f.showlines}if(f.type==="constraint"){o=f._operation!=="="}else if(A==="fill"||A==="heatmap"){p=true}}var E=c.hasMarkers(a)||c.hasText(a);var S=o||p;var C=l||h;var L=E||!S?"M5,0":C?"M5,-2":"M5,-3";var I=n.select(this);var O=I.select(".legendfill").selectAll("path").data(o||p?[e]:[]);O.enter().append("path").classed("js-fill",true);O.exit().remove();O.attr("d",L+"h"+T+"v6h-"+T+"z").call(o?s.fillGroupStyle:w);if(l||h){var P=M(undefined,a.line,g,v);m=i.minExtend(a,{line:{width:P}});d=[i.minExtend(t,{trace:m})]}var D=I.select(".legendlines").selectAll("path").data(l||h?[d]:[]);D.enter().append("path").classed("js-line",true);D.exit().remove();D.attr("d",L+(h?"l"+T+",0.0001":"h"+T)).call(l?s.lineGroupStyle:k)}function S(e){var t=e[0];var a=t.trace;var o=c.hasMarkers(a);var l=c.hasText(a);var u=c.hasLines(a);var f,h;function p(e,t,r,n){var o=i.nestedProperty(a,e).get();var s=i.isArrayOrTypedArray(o)&&t?t(o):o;if(w&&s&&n!==undefined){s=n}if(r){if(s<r[0])return r[0];else if(s>r[1])return r[1]}return s}function g(e){if(t._distinct&&t.index&&e[t.index])return e[t.index];return e[0]}if(o||l||u){var y={};var x={};if(o){y.mc=p("marker.color",g);y.mx=p("marker.symbol",g);y.mo=p("marker.opacity",i.mean,[.2,1]);y.mlc=p("marker.line.color",g);y.mlw=p("marker.line.width",i.mean,[0,5],m);x.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var _=p("marker.size",i.mean,[2,16],d);y.ms=_;x.marker.size=_}if(u){x.line={width:p("line.width",g,[0,10],v)}}if(l){y.tx="Aa";y.tp=p("textposition",g);y.ts=10;y.tc=p("textfont.color",g);y.tf=p("textfont.family",g)}f=[i.minExtend(t,y)];h=i.minExtend(a,x);h.selectedpoints=null;h.texttemplate=null}var b=n.select(this).select("g.legendpoints");var T=b.selectAll("path.scatterpts").data(o?f:[]);T.enter().insert("path",":first-child").classed("scatterpts",true).attr("transform",A);T.exit().remove();T.call(s.pointStyle,h,r);if(o)f[0].mrc=3;var k=b.selectAll("g.pointtext").data(l?f:[]);k.enter().append("g").classed("pointtext",true).append("text").attr("transform",A);k.exit().remove();k.selectAll("text").call(s.textPointStyle,h,r)}function C(e){var t=e[0].trace;var r=t.type==="waterfall";if(e[0]._distinct&&r){var a=e[0].trace[e[0].dir].marker;e[0].mc=a.color;e[0].mlw=a.line.width;e[0].mlc=a.line.color;return O(e,this,"waterfall")}var i=[];if(t.visible&&r){i=e[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]}var o=n.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(i);o.enter().append("path").classed("legendwaterfall",true).attr("transform",A).style("stroke-miterlimit",1);o.exit().remove();o.each(function(e){var r=n.select(this);var a=t[e[0]].marker;var i=M(undefined,a.line,y,m);r.attr("d",e[1]).style("stroke-width",i+"px").call(l.fill,a.color);if(i){r.call(l.stroke,a.line.color)}})}function L(e){O(e,this)}function I(e){O(e,this,"funnel")}function O(e,t,r){var i=e[0].trace;var o=i.marker||{};var s=o.line||{};var u=!r?a.traceIs(i,"bar"):i.visible&&i.type===r;var c=n.select(t).select("g.legendpoints").selectAll("path.legend"+r).data(u?[e]:[]);c.enter().append("path").classed("legend"+r,true).attr("d","M6,6H-6V-6H6Z").attr("transform",A);c.exit().remove();c.each(function(e){var t=n.select(this);var r=e[0];var a=M(r.mlw,o.line,y,m);t.style("stroke-width",a+"px").call(l.fill,r.mc||o.color);if(a)l.stroke(t,r.mlc||s.color)})}function P(e){var t=e[0].trace;var o=n.select(this).select("g.legendpoints").selectAll("path.legendbox").data(t.visible&&a.traceIs(t,"box-violin")?[e]:[]);o.enter().append("path").classed("legendbox",true).attr("d","M6,6H-6V-6H6Z").attr("transform",A);o.exit().remove();o.each(function(){var e=n.select(this);if((t.boxpoints==="all"||t.points==="all")&&l.opacity(t.fillcolor)===0&&l.opacity((t.line||{}).color)===0){var a=i.minExtend(t,{marker:{size:w?d:i.constrain(t.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});o.call(s.pointStyle,a,r)}else{var u=M(undefined,t.line,y,m);e.style("stroke-width",u+"px").call(l.fill,t.fillcolor);if(u)l.stroke(e,t.line.color)}})}function D(e){var t=e[0].trace;var r=n.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(t.visible&&t.type==="candlestick"?[e,e]:[]);r.enter().append("path").classed("legendcandle",true).attr("d",function(e,t){if(t)return"M-15,0H-8M-8,6V-6H8Z";return"M15,0H8M8,-6V6H-8Z"}).attr("transform",A).style("stroke-miterlimit",1);r.exit().remove();r.each(function(e,r){var a=n.select(this);var i=t[r?"increasing":"decreasing"];var o=M(undefined,i.line,y,m);a.style("stroke-width",o+"px").call(l.fill,i.fillcolor);if(o)l.stroke(a,i.line.color)})}function R(e){var t=e[0].trace;var r=n.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(t.visible&&t.type==="ohlc"?[e,e]:[]);r.enter().append("path").classed("legendohlc",true).attr("d",function(e,t){if(t)return"M-15,0H0M-8,-6V0";return"M15,0H0M8,6V0"}).attr("transform",A).style("stroke-miterlimit",1);r.exit().remove();r.each(function(e,r){var a=n.select(this);var i=t[r?"increasing":"decreasing"];var o=M(undefined,i.line,y,m);a.style("fill","none").call(s.dashLine,i.line.dash,o);if(o)l.stroke(a,i.line.color)})}function z(e){F(e,this,"pie")}function N(e){F(e,this,"funnelarea")}function F(e,t,r){var o=e[0];var s=o.trace;var l=!r?a.traceIs(s,r):s.visible&&s.type===r;var u=n.select(t).select("g.legendpoints").selectAll("path.legend"+r).data(l?[e]:[]);u.enter().append("path").classed("legend"+r,true).attr("d","M6,6H-6V-6H6Z").attr("transform",A);u.exit().remove();if(u.size()){var c=(s.marker||{}).line;var p=M(h(c.width,o.pts),c,y,m);var d=i.minExtend(s,{marker:{line:{width:p}}});d.marker.line.color=c.color;var v=i.minExtend(o,{trace:d});f(u,v,d)}}function B(e){var t=e[0].trace;var a;var o=[];if(t.visible){switch(t.type){case"histogram2d":case"heatmap":o=[["M-15,-2V4H15V-2Z"]];a=true;break;case"choropleth":case"choroplethmapbox":o=[["M-6,-6V6H6V-6Z"]];a=true;break;case"densitymapbox":o=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]];a="radial";break;case"cone":o=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]];a=false;break;case"streamtube":o=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]];a=false;break;case"surface":o=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]];a=true;break;case"mesh3d":o=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]];a=false;break;case"volume":o=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]];a=true;break;case"isosurface":o=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]];a=false;break}}var c=n.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(o);c.enter().append("path").classed("legend3dandfriends",true).attr("transform",A).style("stroke-miterlimit",1);c.exit().remove();c.each(function(e,o){var c=n.select(this);var f=u(t);var h=f.colorscale;var p=f.reversescale;var d=function(e){if(e.size()){var n="legendfill-"+t.uid;s.gradient(e,r,n,x(p,a==="radial"),h,"fill")}};var v;if(!h){var m=t.vertexcolor||t.facecolor||t.color;v=i.isArrayOrTypedArray(m)?m[o]||m[0]:m}else{if(!a){var g=h.length;v=o===0?h[p?g-1:0][1]:o===1?h[p?0:g-1][1]:h[Math.floor((g-1)/2)][1]}}c.attr("d",e[0]);if(v){c.call(l.fill,v)}else{c.call(d)}})}};function x(e,t){var r=t?"radial":"horizontal";return r+(e?"":"reversed")}},{"../../lib":778,"../../registry":911,"../../traces/pie/helpers":1166,"../../traces/pie/style_one":1172,"../../traces/scatter/subtypes":1212,"../color":643,"../colorscale/helpers":654,"../drawing":665,"./constants":694,d3:169}],702:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../plots/plots");var i=e("../../plots/cartesian/axis_ids");var o=e("../../fonts/ploticon");var s=e("../shapes/draw").eraseActiveShape;var l=e("../../lib");var u=l._;var c=t.exports={};c.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{};var r=t.format||"png";return r==="png"?u(e,"Download plot as a png"):u(e,"Download plot")},icon:o.camera,click:function(e){var t=e._context.toImageButtonOptions;var r={format:t.format||"png"};l.notifier(u(e,"Taking snapshot - this may take a few seconds"),"long");if(r.format!=="svg"&&l.isIE()){l.notifier(u(e,"IE only supports svg.  Changing format to svg."),"long");r.format="svg"}["filename","width","height","scale"].forEach(function(e){if(e in t){r[e]=t[e]}});n.call("downloadImage",e,r).then(function(t){l.notifier(u(e,"Snapshot succeeded")+" - "+t,"long")}).catch(function(){l.notifier(u(e,"Sorry, there was a problem downloading your snapshot!"),"long")})}};c.sendDataToCloud={name:"sendDataToCloud",title:function(e){return u(e,"Edit in Chart Studio")},icon:o.disk,click:function(e){a.sendDataToCloud(e)}};c.editInChartStudio={name:"editInChartStudio",title:function(e){return u(e,"Edit in Chart Studio")},icon:o.pencil,click:function(e){a.sendDataToCloud(e)}};c.zoom2d={name:"zoom2d",title:function(e){return u(e,"Zoom")},attr:"dragmode",val:"zoom",icon:o.zoombox,click:f};c.pan2d={name:"pan2d",title:function(e){return u(e,"Pan")},attr:"dragmode",val:"pan",icon:o.pan,click:f};c.select2d={name:"select2d",title:function(e){return u(e,"Box Select")},attr:"dragmode",val:"select",icon:o.selectbox,click:f};c.lasso2d={name:"lasso2d",title:function(e){return u(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:o.lasso,click:f};c.drawclosedpath={name:"drawclosedpath",title:function(e){return u(e,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:o.drawclosedpath,click:f};c.drawopenpath={name:"drawopenpath",title:function(e){return u(e,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:o.drawopenpath,click:f};c.drawline={name:"drawline",title:function(e){return u(e,"Draw line")},attr:"dragmode",val:"drawline",icon:o.drawline,click:f};c.drawrect={name:"drawrect",title:function(e){return u(e,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:o.drawrect,click:f};c.drawcircle={name:"drawcircle",title:function(e){return u(e,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:o.drawcircle,click:f};c.eraseshape={name:"eraseshape",title:function(e){return u(e,"Erase active shape")},icon:o.eraseshape,click:s};c.zoomIn2d={name:"zoomIn2d",title:function(e){return u(e,"Zoom in")},attr:"zoom",val:"in",icon:o.zoom_plus,click:f};c.zoomOut2d={name:"zoomOut2d",title:function(e){return u(e,"Zoom out")},attr:"zoom",val:"out",icon:o.zoom_minus,click:f};c.autoScale2d={name:"autoScale2d",title:function(e){return u(e,"Autoscale")},attr:"zoom",val:"auto",icon:o.autoscale,click:f};c.resetScale2d={name:"resetScale2d",title:function(e){return u(e,"Reset axes")},attr:"zoom",val:"reset",icon:o.home,click:f};c.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(e){return u(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:o.tooltip_basic,gravity:"ne",click:f};c.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(e){return u(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:o.tooltip_compare,gravity:"ne",click:f};function f(e,t){var r=t.currentTarget;var a=r.getAttribute("data-attr");var o=r.getAttribute("data-val")||true;var s=e._fullLayout;var l={};var u=i.list(e,null,true);var c=s._cartesianSpikesEnabled;var f,h;if(a==="zoom"){var p=o==="in"?.5:2;var d=(1+p)/2;var v=(1-p)/2;var m;for(h=0;h<u.length;h++){f=u[h];if(!f.fixedrange){m=f._name;if(o==="auto"){l[m+".autorange"]=true}else if(o==="reset"){if(f._rangeInitial===undefined){l[m+".autorange"]=true}else{var g=f._rangeInitial.slice();l[m+".range[0]"]=g[0];l[m+".range[1]"]=g[1]}if(f._showSpikeInitial!==undefined){l[m+".showspikes"]=f._showSpikeInitial;if(c==="on"&&!f._showSpikeInitial){c="off"}}}else{var y=[f.r2l(f.range[0]),f.r2l(f.range[1])];var x=[d*y[0]+v*y[1],d*y[1]+v*y[0]];l[m+".range[0]"]=f.l2r(x[0]);l[m+".range[1]"]=f.l2r(x[1])}}}}else{if(a==="hovermode"&&(o==="x"||o==="y")){o=s._isHoriz?"y":"x";r.setAttribute("data-val",o)}l[a]=o}s._cartesianSpikesEnabled=c;n.call("_guiRelayout",e,l)}c.zoom3d={name:"zoom3d",title:function(e){return u(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:o.zoombox,click:h};c.pan3d={name:"pan3d",title:function(e){return u(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:o.pan,click:h};c.orbitRotation={name:"orbitRotation",title:function(e){return u(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:o["3d_rotate"],click:h};c.tableRotation={name:"tableRotation",title:function(e){return u(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:o["z-axis"],click:h};function h(e,t){var r=t.currentTarget;var a=r.getAttribute("data-attr");var i=r.getAttribute("data-val")||true;var o=e._fullLayout._subplots.gl3d||[];var s={};var l=a.split(".");for(var u=0;u<o.length;u++){s[o[u]+"."+l[1]]=i}var c=i==="pan"?i:"zoom";s.dragmode=c;n.call("_guiRelayout",e,s)}c.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(e){return u(e,"Reset camera to default")},attr:"resetDefault",icon:o.home,click:p};c.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(e){return u(e,"Reset camera to last save")},attr:"resetLastSave",icon:o.movie,click:p};function p(e,t){var r=t.currentTarget;var a=r.getAttribute("data-attr");var i=a==="resetLastSave";var o=a==="resetDefault";var s=e._fullLayout;var l=s._subplots.gl3d||[];var u={};for(var c=0;c<l.length;c++){var f=l[c];var h=f+".camera";var p=f+".aspectratio";var d=f+".aspectmode";var v=s[f]._scene;var m;if(i){u[h+".up"]=v.viewInitial.up;u[h+".eye"]=v.viewInitial.eye;u[h+".center"]=v.viewInitial.center;m=true}else if(o){u[h+".up"]=null;u[h+".eye"]=null;u[h+".center"]=null;m=true}if(m){u[p+".x"]=v.viewInitial.aspectratio.x;u[p+".y"]=v.viewInitial.aspectratio.y;u[p+".z"]=v.viewInitial.aspectratio.z;u[d]=v.viewInitial.aspectmode}}n.call("_guiRelayout",e,u)}c.hoverClosest3d={name:"hoverClosest3d",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:v};function d(e,t){var r=t.currentTarget;var n=r._previousVal;var a=e._fullLayout;var i=a._subplots.gl3d||[];var o=["xaxis","yaxis","zaxis"];var s={};var l={};if(n){l=n;r._previousVal=null}else{for(var u=0;u<i.length;u++){var c=i[u];var f=a[c];var h=c+".hovermode";s[h]=f.hovermode;l[h]=false;for(var p=0;p<3;p++){var d=o[p];var v=c+"."+d+".showspikes";l[v]=false;s[v]=f[d].showspikes}}r._previousVal=s}return l}function v(e,t){var r=d(e,t);n.call("_guiRelayout",e,r)}c.zoomInGeo={name:"zoomInGeo",title:function(e){return u(e,"Zoom in")},attr:"zoom",val:"in",icon:o.zoom_plus,click:m};c.zoomOutGeo={name:"zoomOutGeo",title:function(e){return u(e,"Zoom out")},attr:"zoom",val:"out",icon:o.zoom_minus,click:m};c.resetGeo={name:"resetGeo",title:function(e){return u(e,"Reset")},attr:"reset",val:null,icon:o.autoscale,click:m};c.hoverClosestGeo={name:"hoverClosestGeo",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:y};function m(e,t){var r=t.currentTarget;var a=r.getAttribute("data-attr");var i=r.getAttribute("data-val")||true;var o=e._fullLayout;var s=o._subplots.geo||[];for(var l=0;l<s.length;l++){var u=s[l];var c=o[u];if(a==="zoom"){var f=c.projection.scale;var h=i==="in"?2*f:.5*f;n.call("_guiRelayout",e,u+".projection.scale",h)}}if(a==="reset"){b(e,"geo")}}c.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:y};c.hoverClosestPie={name:"hoverClosestPie",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:o.tooltip_basic,gravity:"ne",click:y};function g(e){var t=e._fullLayout;if(t.hovermode)return false;if(t._has("cartesian")){return t._isHoriz?"y":"x"}return"closest"}function y(e){var t=g(e);n.call("_guiRelayout",e,"hovermode",t)}c.resetViewSankey={name:"resetSankeyGroup",title:function(e){return u(e,"Reset view")},icon:o.home,click:function(e){var t={"node.groups":[],"node.x":[],"node.y":[]};for(var r=0;r<e._fullData.length;r++){var a=e._fullData[r]._viewInitial;t["node.groups"].push(a.node.groups.slice());t["node.x"].push(a.node.x.slice());t["node.y"].push(a.node.y.slice())}n.call("restyle",e,t)}};c.toggleHover={name:"toggleHover",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:function(e,t){var r=d(e,t);r.hovermode=g(e);n.call("_guiRelayout",e,r)}};c.resetViews={name:"resetViews",title:function(e){return u(e,"Reset views")},icon:o.home,click:function(e,t){var r=t.currentTarget;r.setAttribute("data-attr","zoom");r.setAttribute("data-val","reset");f(e,t);r.setAttribute("data-attr","resetLastSave");p(e,t);b(e,"geo");b(e,"mapbox")}};c.toggleSpikelines={name:"toggleSpikelines",title:function(e){return u(e,"Toggle Spike Lines")},icon:o.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout;var r=t._cartesianSpikesEnabled;t._cartesianSpikesEnabled=r==="on"?"off":"on";n.call("_guiRelayout",e,x(e))}};function x(e){var t=e._fullLayout;var r=t._cartesianSpikesEnabled==="on";var n=i.list(e,null,true);var a={};for(var o=0;o<n.length;o++){var s=n[o];a[s._name+".showspikes"]=r?true:s._showSpikeInitial}return a}c.resetViewMapbox={name:"resetViewMapbox",title:function(e){return u(e,"Reset view")},attr:"reset",icon:o.home,click:function(e){b(e,"mapbox")}};c.zoomInMapbox={name:"zoomInMapbox",title:function(e){return u(e,"Zoom in")},attr:"zoom",val:"in",icon:o.zoom_plus,click:_};c.zoomOutMapbox={name:"zoomOutMapbox",title:function(e){return u(e,"Zoom out")},attr:"zoom",val:"out",icon:o.zoom_minus,click:_};function _(e,t){var r=t.currentTarget;var a=r.getAttribute("data-val");var i=e._fullLayout;var o=i._subplots.mapbox||[];var s=1.05;var l={};for(var u=0;u<o.length;u++){var c=o[u];var f=i[c].zoom;var h=a==="in"?s*f:f/s;l[c+".zoom"]=h}n.call("_guiRelayout",e,l)}function b(e,t){var r=e._fullLayout;var a=r._subplots[t]||[];var i={};for(var o=0;o<a.length;o++){var s=a[o];var l=r[s]._subplot;var u=l.viewInitial;var c=Object.keys(u);for(var f=0;f<c.length;f++){var h=c[f];i[s+"."+h]=u[h]}}n.call("_guiRelayout",e,i)}},{"../../fonts/ploticon":757,"../../lib":778,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../shapes/draw":724}],703:[function(e,t,r){"use strict";r.manage=e("./manage")},{"./manage":704}],704:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids");var a=e("../../traces/scatter/subtypes");var i=e("../../registry");var o=e("../fx/helpers").isUnifiedHover;var s=e("./modebar");var l=e("./buttons");t.exports=function e(t){var r=t._fullLayout;var n=t._context;var a=r._modeBar;if(!n.displayModeBar&&!n.watermark){if(a){a.destroy();delete r._modeBar}return}if(!Array.isArray(n.modeBarButtonsToRemove)){throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "))}if(!Array.isArray(n.modeBarButtonsToAdd)){throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "))}var i=n.modeBarButtons;var o;if(Array.isArray(i)&&i.length){o=v(i)}else if(!n.displayModeBar&&n.watermark){o=[]}else{o=c(t)}if(a)a.update(t,o);else r._modeBar=s(t,o)};var u=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"];function c(e){var t=e._fullLayout;var r=e._fullData;var n=e._context;var a=n.modeBarButtonsToRemove;var i=n.modeBarButtonsToAdd;var s=t._has("cartesian");var c=t._has("gl3d");var v=t._has("geo");var m=t._has("pie");var g=t._has("funnelarea");var y=t._has("gl2d");var x=t._has("ternary");var _=t._has("mapbox");var b=t._has("polar");var w=t._has("sankey");var T=f(t);var k=o(t.hovermode);var A=[];function M(e){if(!e.length)return;var t=[];for(var r=0;r<e.length;r++){var n=e[r];if(a.indexOf(n)!==-1)continue;t.push(l[n])}A.push(t)}var E=["toImage"];if(n.showEditInChartStudio)E.push("editInChartStudio");else if(n.showSendToCloud)E.push("sendDataToCloud");M(E);var S=[];var C=[];var L=[];var I=[];if((s||y||m||g||x)+v+c+_+b>1){C=["toggleHover"];L=["resetViews"]}else if(v){S=["zoomInGeo","zoomOutGeo"];C=["hoverClosestGeo"];L=["resetGeo"]}else if(c){C=["hoverClosest3d"];L=["resetCameraDefault3d","resetCameraLastSave3d"]}else if(_){S=["zoomInMapbox","zoomOutMapbox"];C=["toggleHover"];L=["resetViewMapbox"]}else if(y){C=["hoverClosestGl2d"]}else if(m){C=["hoverClosestPie"]}else if(w){C=["hoverClosestCartesian","hoverCompareCartesian"];L=["resetViewSankey"]}else{C=["toggleHover"]}if(s){C=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]}if(p(r)||k){C=[]}if((s||y)&&!T){S=["zoomIn2d","zoomOut2d","autoScale2d"];if(L[0]!=="resetViews")L=["resetScale2d"]}if(c){I=["zoom3d","pan3d","orbitRotation","tableRotation"]}else if((s||y)&&!T||x){I=["zoom2d","pan2d"]}else if(_||v){I=["pan2d"]}else if(b){I=["zoom2d"]}if(h(r)){I.push("select2d","lasso2d")}if(Array.isArray(i)){var O=[];for(var P=0;P<i.length;P++){var D=i[P];if(typeof D==="string"){if(u.indexOf(D)!==-1){if(t._has("mapbox")||t._has("cartesian")){I.push(D)}}}else O.push(D)}i=O}M(I);M(S.concat(L));M(C);return d(A,i)}function f(e){var t=n.list({_fullLayout:e},null,true);for(var r=0;r<t.length;r++){if(!t[r].fixedrange){return false}}return true}function h(e){var t=false;for(var r=0;r<e.length;r++){if(t)break;var n=e[r];if(!n._module||!n._module.selectPoints)continue;if(i.traceIs(n,"scatter-like")){if(a.hasMarkers(n)||a.hasText(n)){t=true}}else if(i.traceIs(n,"box-violin")){if(n.boxpoints==="all"||n.points==="all"){t=true}}else{t=true}}return t}function p(e){for(var t=0;t<e.length;t++){if(!i.traceIs(e[t],"noHover"))return false}return true}function d(e,t){if(t.length){if(Array.isArray(t[0])){for(var r=0;r<t.length;r++){e.push(t[r])}}else e.push(t)}return e}function v(e){for(var t=0;t<e.length;t++){var r=e[t];for(var n=0;n<r.length;n++){var a=r[n];if(typeof a==="string"){if(l[a]!==undefined){e[t][n]=l[a]}else{throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}}}}return e}},{"../../plots/cartesian/axis_ids":831,"../../registry":911,"../../traces/scatter/subtypes":1212,"../fx/helpers":679,"./buttons":702,"./modebar":705}],705:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("../../lib");var o=e("../../fonts/ploticon");var s=new DOMParser;function l(e){this.container=e.container;this.element=document.createElement("div");this.update(e.graphInfo,e.buttons);this.container.appendChild(this.element)}var u=l.prototype;u.update=function(e,t){this.graphInfo=e;var r=this.graphInfo._context;var n=this.graphInfo._fullLayout;var a="modebar-"+n._uid;this.element.setAttribute("id",a);this._uid=a;this.element.className="modebar";if(r.displayModeBar==="hover")this.element.className+=" modebar--hover ease-bg";if(n.modebar.orientation==="v"){this.element.className+=" vertical";t=t.reverse()}var o=n.modebar;var s=r.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";i.deleteRelatedStyleRule(a);i.addRelatedStyleRule(a,s+"#"+a+" .modebar-group","background-color: "+o.bgcolor);i.addRelatedStyleRule(a,"#"+a+" .modebar-btn .icon path","fill: "+o.color);i.addRelatedStyleRule(a,"#"+a+" .modebar-btn:hover .icon path","fill: "+o.activecolor);i.addRelatedStyleRule(a,"#"+a+" .modebar-btn.active .icon path","fill: "+o.activecolor);var l=!this.hasButtons(t);var u=this.hasLogo!==r.displaylogo;var c=this.locale!==r.locale;this.locale=r.locale;if(l||u||c){this.removeAllButtons();this.updateButtons(t);if(r.watermark||r.displaylogo){var f=this.getLogo();if(r.watermark){f.className=f.className+" watermark"}if(n.modebar.orientation==="v"){this.element.insertBefore(f,this.element.childNodes[0])}else{this.element.appendChild(f)}this.hasLogo=true}}this.updateActiveButton()};u.updateButtons=function(e){var t=this;this.buttons=e;this.buttonElements=[];this.buttonsNames=[];this.buttons.forEach(function(e){var r=t.createGroup();e.forEach(function(e){var n=e.name;if(!n){throw new Error("must provide button 'name' in button config")}if(t.buttonsNames.indexOf(n)!==-1){throw new Error("button name '"+n+"' is taken")}t.buttonsNames.push(n);var a=t.createButton(e);t.buttonElements.push(a);r.appendChild(a)});t.element.appendChild(r)})};u.createGroup=function(){var e=document.createElement("div");e.className="modebar-group";return e};u.createButton=function(e){var t=this;var r=document.createElement("a");r.setAttribute("rel","tooltip");r.className="modebar-btn";var a=e.title;if(a===undefined)a=e.name;else if(typeof a==="function")a=a(this.graphInfo);if(a||a===0)r.setAttribute("data-title",a);if(e.attr!==undefined)r.setAttribute("data-attr",e.attr);var i=e.val;if(i!==undefined){if(typeof i==="function")i=i(this.graphInfo);r.setAttribute("data-val",i)}var s=e.click;if(typeof s!=="function"){throw new Error("must provide button 'click' function in button config")}else{r.addEventListener("click",function(r){e.click(t.graphInfo,r);t.updateActiveButton(r.currentTarget)})}r.setAttribute("data-toggle",e.toggle||false);if(e.toggle)n.select(r).classed("active",true);var l=e.icon;if(typeof l==="function"){r.appendChild(l())}else{r.appendChild(this.createIcon(l||o.question))}r.setAttribute("data-gravity",e.gravity||"n");return r};u.createIcon=function(e){var t=a(e.height)?Number(e.height):e.ascent-e.descent;var r="http://www.w3.org/2000/svg";var n;if(e.path){n=document.createElementNS(r,"svg");n.setAttribute("viewBox",[0,0,e.width,t].join(" "));n.setAttribute("class","icon");var i=document.createElementNS(r,"path");i.setAttribute("d",e.path);if(e.transform){i.setAttribute("transform",e.transform)}else if(e.ascent!==undefined){i.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")")}n.appendChild(i)}if(e.svg){var o=s.parseFromString(e.svg,"application/xml");n=o.childNodes[0]}n.setAttribute("height","1em");n.setAttribute("width","1em");return n};u.updateActiveButton=function(e){var t=this.graphInfo._fullLayout;var r=e!==undefined?e.getAttribute("data-attr"):null;this.buttonElements.forEach(function(e){var a=e.getAttribute("data-val")||true;var o=e.getAttribute("data-attr");var s=e.getAttribute("data-toggle")==="true";var l=n.select(e);if(s){if(o===r){l.classed("active",!l.classed("active"))}}else{var u=o===null?o:i.nestedProperty(t,o).get();l.classed("active",u===a)}})};u.hasButtons=function(e){var t=this.buttons;if(!t)return false;if(e.length!==t.length)return false;for(var r=0;r<e.length;++r){if(e[r].length!==t[r].length)return false;for(var n=0;n<e[r].length;n++){if(e[r][n].name!==t[r][n].name)return false}}return true};u.getLogo=function(){var e=this.createGroup();var t=document.createElement("a");t.href="https://plotly.com/";t.target="_blank";t.setAttribute("data-title",i._(this.graphInfo,"Produced with Plotly"));t.className="modebar-btn plotlyjsicon modebar-btn--logo";t.appendChild(this.createIcon(o.newplotlylogo));e.appendChild(t);return e};u.removeAllButtons=function(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}this.hasLogo=false};u.destroy=function(){i.removeElement(this.container.querySelector(".modebar"));i.deleteRelatedStyleRule(this._uid)};function c(e,t){var r=e._fullLayout;var a=new l({graphInfo:e,container:r._modebardiv.node(),buttons:t});if(r._privateplot){n.select(a.element).append("span").classed("badge-private float--left",true).text("PRIVATE")}return a}t.exports=c},{"../../fonts/ploticon":757,"../../lib":778,d3:169,"fast-isnumeric":241}],706:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("../color/attributes");var i=e("../../plot_api/plot_template").templatedArray;var o=i("button",{visible:{valType:"boolean",dflt:true,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:o,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:n({editType:"plot"}),bgcolor:{valType:"color",dflt:a.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":817,"../../plots/font_attributes":856,"../color/attributes":642}],707:[function(e,t,r){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],708:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../color");var i=e("../../plot_api/plot_template");var o=e("../../plots/array_container_defaults");var s=e("./attributes");var l=e("./constants");t.exports=function e(t,r,f,h,p){var d=t.rangeselector||{};var v=i.newContainer(r,"rangeselector");function m(e,t){return n.coerce(d,v,s,e,t)}var g=o(d,v,{name:"buttons",handleItemDefaults:u,calendar:p});var y=m("visible",g.length>0);if(y){var x=c(r,f,h);m("x",x[0]);m("y",x[1]);n.noneOrAll(t,r,["x","y"]);m("xanchor");m("yanchor");n.coerceFont(m,"font",f.font);var _=m("bgcolor");m("activecolor",a.contrast(_,l.lightAmount,l.darkAmount));m("bordercolor");m("borderwidth")}};function u(e,t,r,a){var i=a.calendar;function o(r,a){return n.coerce(e,t,s.buttons,r,a)}var l=o("visible");if(l){var u=o("step");if(u!=="all"){if(i&&i!=="gregorian"&&(u==="month"||u==="year")){t.stepmode="backward"}else{o("stepmode")}o("count")}o("label")}}function c(e,t,r){var n=r.filter(function(r){return t[r].anchor===e._id});var a=0;for(var i=0;i<n.length;i++){var o=t[n[i]].domain;if(o)a=Math.max(o[1],a)}return[e.domain[0],a+l.yPad]}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../color":643,"./attributes":706,"./constants":707}],709:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../plots/plots");var o=e("../color");var s=e("../drawing");var l=e("../../lib");var u=l.strTranslate;var c=e("../../lib/svg_text_utils");var f=e("../../plots/cartesian/axis_ids");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var d=h.FROM_TL;var v=h.FROM_BR;var m=e("./constants");var g=e("./get_update_object");t.exports=function e(t){var r=t._fullLayout;var i=r._infolayer.selectAll(".rangeselector").data(y(t),x);i.enter().append("g").classed("rangeselector",true);i.exit().remove();i.style({cursor:"pointer","pointer-events":"all"});i.each(function(e){var r=n.select(this);var i=e;var o=i.rangeselector;var s=r.selectAll("g.button").data(l.filterVisible(o.buttons));s.enter().append("g").classed("button",true);s.exit().remove();s.each(function(e){var r=n.select(this);var s=g(i,e);e._isActive=_(i,e,s);r.call(b,o,e);r.call(T,o,e,t);r.on("click",function(){if(t._dragged)return;a.call("_guiRelayout",t,s)});r.on("mouseover",function(){e._isHovered=true;r.call(b,o,e)});r.on("mouseout",function(){e._isHovered=false;r.call(b,o,e)})});A(t,s,o,i._name,r)})};function y(e){var t=f.list(e,"x",true);var r=[];for(var n=0;n<t.length;n++){var a=t[n];if(a.rangeselector&&a.rangeselector.visible){r.push(a)}}return r}function x(e){return e._id}function _(e,t,r){if(t.step==="all"){return e.autorange===true}else{var n=Object.keys(r);return e.range[0]===r[n[0]]&&e.range[1]===r[n[1]]}}function b(e,t,r){var n=l.ensureSingle(e,"rect","selector-rect",function(e){e.attr("shape-rendering","crispEdges")});n.attr({rx:m.rx,ry:m.ry});n.call(o.stroke,t.bordercolor).call(o.fill,w(t,r)).style("stroke-width",t.borderwidth+"px")}function w(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function T(e,t,r,n){function a(e){c.convertToTspans(e,n)}var i=l.ensureSingle(e,"text","selector-text",function(e){e.attr("text-anchor","middle")});i.call(s.font,t.font).text(k(r,n._fullLayout._meta)).call(a)}function k(e,t){if(e.label){return t?l.templateString(e.label,t):e.label}if(e.step==="all")return"all";return e.count+e.step.charAt(0)}function A(e,t,r,a,o){var f=0;var h=0;var g=r.borderwidth;t.each(function(){var e=n.select(this);var t=e.select(".selector-text");var a=r.font.size*p;var i=Math.max(a*c.lineCount(t),16)+3;h=Math.max(h,i)});t.each(function(){var e=n.select(this);var t=e.select(".selector-rect");var a=e.select(".selector-text");var i=a.node()&&s.bBox(a.node()).width;var o=r.font.size*p;var l=c.lineCount(a);var d=Math.max(i+10,m.minButtonWidth);e.attr("transform",u(g+f,g));t.attr({x:0,y:0,width:d,height:h});c.positionText(a,d/2,h/2-(l-1)*o/2+3);f+=d+5});var y=e._fullLayout._size;var x=y.l+y.w*r.x;var _=y.t+y.h*(1-r.y);var b="left";if(l.isRightAnchor(r)){x-=f;b="right"}if(l.isCenterAnchor(r)){x-=f/2;b="center"}var w="top";if(l.isBottomAnchor(r)){_-=h;w="bottom"}if(l.isMiddleAnchor(r)){_-=h/2;w="middle"}f=Math.ceil(f);h=Math.ceil(h);x=Math.round(x);_=Math.round(_);i.autoMargin(e,a+"-range-selector",{x:r.x,y:r.y,l:f*d[b],r:f*v[b],b:h*v[w],t:h*d[w]});o.attr("transform",u(x,_))}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../color":643,"../drawing":665,"./constants":707,"./get_update_object":710,d3:169}],710:[function(e,t,r){"use strict";var n=e("d3");t.exports=function e(t,r){var n=t._name;var i={};if(r.step==="all"){i[n+".autorange"]=true}else{var o=a(t,r);i[n+".range[0]"]=o[0];i[n+".range[1]"]=o[1]}return i};function a(e,t){var r=e.range;var a=new Date(e.r2l(r[1]));var i=t.step;var o=t.count;var s;switch(t.stepmode){case"backward":s=e.l2r(+n.time[i].utc.offset(a,-o));break;case"todate":var l=n.time[i].utc.offset(a,-o);s=e.l2r(+n.time[i].utc.ceil(l));break}var u=r[1];return[s,u]}},{d3:169}],711:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":706,"./defaults":708,"./draw":709}],712:[function(e,t,r){"use strict";var n=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:n.background,editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}}],editType:"calc",impliedEdits:{autorange:false}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"}},{"../color/attributes":642}],713:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids").list;var a=e("../../plots/cartesian/autorange").getAutoRange;var i=e("./constants");t.exports=function e(t){var r=n(t,"x",true);for(var o=0;o<r.length;o++){var s=r[o];var l=s[i.name];if(l&&l.visible&&l.autorange){l._input.autorange=true;l._input.range=l.range=a(t,s)}}}},{"../../plots/cartesian/autorange":827,"../../plots/cartesian/axis_ids":831,"./constants":714}],714:[function(e,t,r){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],715:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plot_api/plot_template");var i=e("../../plots/cartesian/axis_ids");var o=e("./attributes");var s=e("./oppaxis_attributes");t.exports=function e(t,r,l){var u=t[l];var c=r[l];if(!(u.rangeslider||r._requestRangeslider[c._id]))return;if(!n.isPlainObject(u.rangeslider)){u.rangeslider={}}var f=u.rangeslider;var h=a.newContainer(c,"rangeslider");function p(e,t){return n.coerce(f,h,o,e,t)}var d,v;function m(e,t){return n.coerce(d,v,s,e,t)}var g=p("visible");if(!g)return;p("bgcolor",r.plot_bgcolor);p("bordercolor");p("borderwidth");p("thickness");p("autorange",!c.isValidRange(f.range));p("range");var y=r._subplots;if(y){var x=y.cartesian.filter(function(e){return e.substr(0,e.indexOf("y"))===i.name2id(l)}).map(function(e){return e.substr(e.indexOf("y"),e.length)});var _=n.simpleMap(x,i.id2name);for(var b=0;b<_.length;b++){var w=_[b];d=f[w]||{};v=a.newContainer(h,w,"yaxis");var T=r[w];var k;if(d.range&&T.isValidRange(d.range)){k="fixed"}var A=m("rangemode",k);if(A!=="match"){m("range",T.range.slice())}}}h._input=f}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/cartesian/axis_ids":831,"./attributes":712,"./oppaxis_attributes":719}],716:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../plots/plots");var o=e("../../lib");var s=o.strTranslate;var l=e("../drawing");var u=e("../color");var c=e("../titles");var f=e("../../plots/cartesian");var h=e("../../plots/cartesian/axis_ids");var p=e("../dragelement");var d=e("../../lib/setcursor");var v=e("./constants");t.exports=function(e){var t=e._fullLayout;var r=t._rangeSliderData;for(var a=0;a<r.length;a++){var i=r[a][v.name];i._clipId=i._id+"-"+t._uid}function l(e){return e._name}var u=t._infolayer.selectAll("g."+v.containerClassName).data(r,l);u.exit().each(function(e){var r=e[v.name];t._topdefs.select("#"+r._clipId).remove()}).remove();if(r.length===0)return;u.enter().append("g").classed(v.containerClassName,true).attr("pointer-events","all");u.each(function(r){var a=n.select(this);var i=r[v.name];var l=t[h.id2name(r.anchor)];var u=i[h.id2name(r.anchor)];if(i.range){var f=o.simpleMap(i.range,r.r2l);var p=o.simpleMap(r.range,r.r2l);var d;if(p[0]<p[1]){d=[Math.min(f[0],p[0]),Math.max(f[1],p[1])]}else{d=[Math.max(f[0],p[0]),Math.min(f[1],p[1])]}i.range=i._input.range=o.simpleMap(d,r.l2r)}r.cleanRange("rangeslider.range");var g=t._size;var w=r.domain;i._width=g.w*(w[1]-w[0]);var M=Math.round(g.l+g.w*w[0]);var E=Math.round(g.t+g.h*(1-r._counterDomainMin)+(r.side==="bottom"?r._depth:0)+i._offsetShift+v.extraPad);a.attr("transform",s(M,E));i._rl=o.simpleMap(i.range,r.r2l);var S=i._rl[0];var C=i._rl[1];var L=C-S;i.p2d=function(e){return e/i._width*L+S};i.d2p=function(e){return(e-S)/L*i._width};if(r.rangebreaks){var I=r.locateBreaks(S,C);if(I.length){var O,P;var D=0;for(O=0;O<I.length;O++){P=I[O];D+=P.max-P.min}var R=i._width/(C-S-D);var z=[-R*S];for(O=0;O<I.length;O++){P=I[O];z.push(z[z.length-1]-R*(P.max-P.min))}i.d2p=function(e){var t=z[0];for(var r=0;r<I.length;r++){var n=I[r];if(e>=n.max)t=z[r+1];else if(e<n.min)break}return t+R*e};for(O=0;O<I.length;O++){P=I[O];P.pmin=i.d2p(P.min);P.pmax=i.d2p(P.max)}i.p2d=function(e){var t=z[0];for(var r=0;r<I.length;r++){var n=I[r];if(e>=n.pmax)t=z[r+1];else if(e<n.pmin)break}return(e-t)/R}}}if(u.rangemode!=="match"){var N=l.r2l(u.range[0]);var F=l.r2l(u.range[1]);var B=F-N;i.d2pOppAxis=function(e){return(e-N)/B*i._height}}a.call(x,e,r,i).call(_,e,r,i).call(b,e,r,i).call(T,e,r,i,u).call(k,e,r,i).call(A,e,r,i);m(a,e,r,i);y(a,e,r,i,l,u);if(r.side==="bottom"){c.draw(e,r._id+"title",{propContainer:r,propName:r._name+".title",placeholder:t._dfltTitle.x,attributes:{x:r._offset+r._length/2,y:E+i._height+i._offsetShift+10+1.5*r.title.font.size,"text-anchor":"middle"}})}})};function m(e,t,r,a){if(t._context.staticPlot)return;var i=e.select("rect."+v.slideBoxClassName).node();var s=e.select("rect."+v.grabAreaMinClassName).node();var l=e.select("rect."+v.grabAreaMaxClassName).node();function u(){var u=n.event;var c=u.target;var f=u.clientX||u.touches[0].clientX;var h=f-e.node().getBoundingClientRect().left;var v=a.d2p(r._rl[0]);var m=a.d2p(r._rl[1]);var y=p.coverSlip();this.addEventListener("touchmove",x);this.addEventListener("touchend",_);y.addEventListener("mousemove",x);y.addEventListener("mouseup",_);function x(o){var u=o.clientX||o.touches[0].clientX;var p=+u-f;var x,_,b;switch(c){case i:b="ew-resize";x=v+p;_=m+p;break;case s:b="col-resize";x=v+p;_=m;break;case l:b="col-resize";x=v;_=m+p;break;default:b="ew-resize";x=h;_=h+p;break}if(_<x){var w=_;_=x;x=w}a._pixelMin=x;a._pixelMax=_;d(n.select(y),b);g(e,t,r,a)}function _(){y.removeEventListener("mousemove",x);y.removeEventListener("mouseup",_);this.removeEventListener("touchmove",x);this.removeEventListener("touchend",_);o.removeElement(y)}}e.on("mousedown",u);e.on("touchstart",u)}function g(e,t,r,n){function i(e){return r.l2r(o.constrain(e,n._rl[0],n._rl[1]))}var s=i(n.p2d(n._pixelMin));var l=i(n.p2d(n._pixelMax));window.requestAnimationFrame(function(){a.call("_guiRelayout",t,r._name+".range",[s,l])})}function y(e,t,r,n,a,i){var l=v.handleWidth/2;function u(e){return o.constrain(e,0,n._width)}function c(e){return o.constrain(e,0,n._height)}function f(e){return o.constrain(e,-l,n._width+l)}var h=u(n.d2p(r._rl[0]));var p=u(n.d2p(r._rl[1]));e.select("rect."+v.slideBoxClassName).attr("x",h).attr("width",p-h);e.select("rect."+v.maskMinClassName).attr("width",h);e.select("rect."+v.maskMaxClassName).attr("x",p).attr("width",n._width-p);if(i.rangemode!=="match"){var d=n._height-c(n.d2pOppAxis(a._rl[1]));var m=n._height-c(n.d2pOppAxis(a._rl[0]));e.select("rect."+v.maskMinOppAxisClassName).attr("x",h).attr("height",d).attr("width",p-h);e.select("rect."+v.maskMaxOppAxisClassName).attr("x",h).attr("y",m).attr("height",n._height-m).attr("width",p-h);e.select("rect."+v.slideBoxClassName).attr("y",d).attr("height",m-d)}var g=.5;var y=Math.round(f(h-l))-g;var x=Math.round(f(p-l))+g;e.select("g."+v.grabberMinClassName).attr("transform",s(y,g));e.select("g."+v.grabberMaxClassName).attr("transform",s(x,g))}function x(e,t,r,n){var a=o.ensureSingle(e,"rect",v.bgClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});var i=n.borderwidth%2===0?n.borderwidth:n.borderwidth-1;var u=-n._offsetShift;var c=l.crispRound(t,n.borderwidth);a.attr({width:n._width+i,height:n._height+i,transform:s(u,u),fill:n.bgcolor,stroke:n.bordercolor,"stroke-width":c})}function _(e,t,r,n){var a=t._fullLayout;var i=o.ensureSingleById(a._topdefs,"clipPath",n._clipId,function(e){e.append("rect").attr({x:0,y:0})});i.select("rect").attr({width:n._width,height:n._height})}function b(e,t,r,a){var s=t.calcdata;var u=e.selectAll("g."+v.rangePlotClassName).data(r._subplotsWith,o.identity);u.enter().append("g").attr("class",function(e){return v.rangePlotClassName+" "+e}).call(l.setClipUrl,a._clipId,t);u.order();u.exit().remove();var c;u.each(function(e,o){var l=n.select(this);var u=o===0;var p=h.getFromId(t,e,"y");var d=p._name;var v=a[d];var m={data:[],layout:{xaxis:{type:r.type,domain:[0,1],range:a.range.slice(),calendar:r.calendar},width:a._width,height:a._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};if(r.rangebreaks){m.layout.xaxis.rangebreaks=r.rangebreaks}m.layout[d]={type:p.type,domain:[0,1],range:v.rangemode!=="match"?v.range.slice():p.range.slice(),calendar:p.calendar};if(p.rangebreaks){m.layout[d].rangebreaks=p.rangebreaks}i.supplyDefaults(m);var g=m._fullLayout.xaxis;var y=m._fullLayout[d];g.clearCalc();g.setScale();y.clearCalc();y.setScale();var x={id:e,plotgroup:l,xaxis:g,yaxis:y,isRangePlot:true};if(u)c=x;else{x.mainplot="xy";x.mainplotinfo=c}f.rangePlot(t,x,w(s,e))})}function w(e,t){var r=[];for(var n=0;n<e.length;n++){var a=e[n];var i=a[0].trace;if(i.xaxis+i.yaxis===t){r.push(a)}}return r}function T(e,t,r,n,a){var i=o.ensureSingle(e,"rect",v.maskMinClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});i.attr("height",n._height).call(u.fill,v.maskColor);var s=o.ensureSingle(e,"rect",v.maskMaxClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("height",n._height).call(u.fill,v.maskColor);if(a.rangemode!=="match"){var l=o.ensureSingle(e,"rect",v.maskMinOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});l.attr("width",n._width).call(u.fill,v.maskOppAxisColor);var c=o.ensureSingle(e,"rect",v.maskMaxOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});c.attr("width",n._width).style("border-top",v.maskOppBorder).call(u.fill,v.maskOppAxisColor)}}function k(e,t,r,n){if(t._context.staticPlot)return;var a=o.ensureSingle(e,"rect",v.slideBoxClassName,function(e){e.attr({y:0,cursor:v.slideBoxCursor,"shape-rendering":"crispEdges"})});a.attr({height:n._height,fill:v.slideBoxFill})}function A(e,t,r,n){var a=o.ensureSingle(e,"g",v.grabberMinClassName);var i=o.ensureSingle(e,"g",v.grabberMaxClassName);var s={x:0,width:v.handleWidth,rx:v.handleRadius,fill:u.background,stroke:u.defaultLine,"stroke-width":v.handleStrokeWidth,"shape-rendering":"crispEdges"};var l={y:Math.round(n._height/4),height:Math.round(n._height/2)};var c=o.ensureSingle(a,"rect",v.handleMinClassName,function(e){e.attr(s)});c.attr(l);var f=o.ensureSingle(i,"rect",v.handleMaxClassName,function(e){e.attr(s)});f.attr(l);var h={width:v.grabAreaWidth,x:0,y:0,fill:v.grabAreaFill,cursor:!t._context.staticPlot?v.grabAreaCursor:undefined};var p=o.ensureSingle(a,"rect",v.grabAreaMinClassName,function(e){e.attr(h)});p.attr("height",n._height);var d=o.ensureSingle(i,"rect",v.grabAreaMaxClassName,function(e){e.attr(h)});d.attr("height",n._height)}},{"../../lib":778,"../../lib/setcursor":799,"../../plots/cartesian":841,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../titles":738,"./constants":714,d3:169}],717:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids");var a=e("../../lib/svg_text_utils");var i=e("./constants");var o=e("../../constants/alignment").LINE_SPACING;var s=i.name;function l(e){var t=e&&e[s];return t&&t.visible}r.isVisible=l;r.makeData=function(e){var t=n.list({_fullLayout:e},"x",true);var r=e.margin;var a=[];if(!e._has("gl2d")){for(var i=0;i<t.length;i++){var o=t[i];if(l(o)){a.push(o);var u=o[s];u._id=s+o._id;u._height=(e.height-r.b-r.t)*u.thickness;u._offsetShift=Math.floor(u.borderwidth/2)}}}e._rangeSliderData=a};r.autoMarginOpts=function(e,t){var r=e._fullLayout;var n=t[s];var l=t._id.charAt(0);var u=0;var c=0;if(t.side==="bottom"){u=t._depth;if(t.title.text!==r._dfltTitle[l]){c=1.5*t.title.font.size+10+n._offsetShift;var f=(t.title.text.match(a.BR_TAG_ALL)||[]).length;c+=f*t.title.font.size*o}}return{x:0,y:t._counterDomainMin,l:0,r:0,t:0,b:n._height+u+Math.max(r.margin.b,c),pad:i.extraPad+n._offsetShift*2}}},{"../../constants/alignment":745,"../../lib/svg_text_utils":803,"../../plots/cartesian/axis_ids":831,"./constants":714}],718:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("./oppaxis_attributes");var o=e("./helpers");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:n.extendFlat({},a,{yaxis:i})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw"),isVisible:o.isVisible,makeData:o.makeData,autoMarginOpts:o.autoMarginOpts}},{"../../lib":778,"./attributes":712,"./calc_autorange":713,"./defaults":715,"./draw":716,"./helpers":717,"./oppaxis_attributes":719}],719:[function(e,t,r){"use strict";t.exports={_isSubplotObj:true,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],720:[function(e,t,r){"use strict";var n=e("../annotations/attributes");var a=e("../../traces/scatter/attributes").line;var i=e("../drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;var l=e("../../constants/axis_placeable_objects");t.exports=s("shape",{visible:{valType:"boolean",dflt:true,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:o({},n.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:o({},n.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:o({},a.color,{editType:"arraydraw"}),width:o({},a.width,{editType:"calc+arraydraw"}),dash:o({},i,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:false,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":746,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../traces/scatter/attributes":1187,"../annotations/attributes":626,"../drawing/attributes":664}],721:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("./constants");var o=e("./helpers");t.exports=function e(t){var r=t._fullLayout;var o=n.filterVisible(r.shapes);if(!o.length||!t._fullData.length)return;for(var u=0;u<o.length;u++){var f=o[u];f._extremes={};var h;var p;var d=a.getRefType(f.xref);var v=a.getRefType(f.yref);if(f.xref!=="paper"&&d!=="domain"){var m=f.xsizemode==="pixel"?f.xanchor:f.x0;var g=f.xsizemode==="pixel"?f.xanchor:f.x1;h=a.getFromId(t,f.xref);p=c(h,m,g,f.path,i.paramIsX);if(p){f._extremes[h._id]=a.findExtremes(h,p,s(f))}}if(f.yref!=="paper"&&v!=="domain"){var y=f.ysizemode==="pixel"?f.yanchor:f.y0;var x=f.ysizemode==="pixel"?f.yanchor:f.y1;h=a.getFromId(t,f.yref);p=c(h,y,x,f.path,i.paramIsY);if(p){f._extremes[h._id]=a.findExtremes(h,p,l(f))}}}};function s(e){return u(e.line.width,e.xsizemode,e.x0,e.x1,e.path,false)}function l(e){return u(e.line.width,e.ysizemode,e.y0,e.y1,e.path,true)}function u(e,t,r,a,s,l){var u=e/2;var c=l;if(t==="pixel"){var f=s?o.extractPathCoords(s,l?i.paramIsY:i.paramIsX):[r,a];var h=n.aggNums(Math.max,null,f);var p=n.aggNums(Math.min,null,f);var d=p<0?Math.abs(p)+u:u;var v=h>0?h+u:u;return{ppad:u,ppadplus:c?d:v,ppadminus:c?v:d}}else{return{ppad:u}}}function c(e,t,r,n,a){var s=e.type==="category"||e.type==="multicategory"?e.r2c:e.d2c;if(t!==undefined)return[s(t),s(r)];if(!n)return;var l=Infinity;var u=-Infinity;var c=n.match(i.segmentRE);var f;var h;var p;var d;var v;if(e.type==="date")s=o.decodeDate(s);for(f=0;f<c.length;f++){h=c[f];p=a[h.charAt(0)].drawn;if(p===undefined)continue;d=c[f].substr(1).match(i.paramRE);if(!d||d.length<p)continue;v=s(d[p]);if(v<l)l=v;if(v>u)u=v}if(u>=l)return[l,u]}},{"../../lib":778,"../../plots/cartesian/axes":828,"./constants":722,"./helpers":731}],722:[function(e,t,r){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:true,drawn:0},L:{0:true,drawn:0},H:{0:true,drawn:0},V:{},Q:{0:true,2:true,drawn:2},C:{0:true,2:true,4:true,drawn:4},T:{0:true,drawn:0},S:{0:true,2:true,drawn:2},Z:{}},paramIsY:{M:{1:true,drawn:1},L:{1:true,drawn:1},H:{},V:{0:true,drawn:0},Q:{1:true,3:true,drawn:3},C:{1:true,3:true,5:true,drawn:5},T:{1:true,drawn:1},S:{1:true,3:true,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],723:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("./attributes");var s=e("./helpers");t.exports=function e(t,r){i(t,r,{name:"shapes",handleItemDefaults:l})};function l(e,t,r){function i(r,a){return n.coerce(e,t,o,r,a)}var l=i("visible");if(!l)return;var u=i("path");var c=u?"path":"rect";var f=i("type",c);if(t.type!=="path")delete t.path;i("editable");i("layer");i("opacity");i("fillcolor");i("fillrule");var h=i("line.width");if(h){i("line.color");i("line.dash")}var p=i("xsizemode");var d=i("ysizemode");var v=["x","y"];for(var m=0;m<2;m++){var g=v[m];var y=g+"anchor";var x=g==="x"?p:d;var _={_fullLayout:r};var b;var w;var T;var k=a.coerceRef(e,t,_,g,undefined,"paper");var A=a.getRefType(k);if(A==="range"){b=a.getFromId(_,k);b._shapeIndices.push(t._index);T=s.rangeToShapePosition(b);w=s.shapePositionToRange(b)}else{w=T=n.identity}if(f!=="path"){var M=.25;var E=.75;var S=g+"0";var C=g+"1";var L=e[S];var I=e[C];e[S]=w(e[S],true);e[C]=w(e[C],true);if(x==="pixel"){i(S,0);i(C,10)}else{a.coercePosition(t,_,i,k,S,M);a.coercePosition(t,_,i,k,C,E)}t[S]=T(t[S]);t[C]=T(t[C]);e[S]=L;e[C]=I}if(x==="pixel"){var O=e[y];e[y]=w(e[y],true);a.coercePosition(t,_,i,k,y,.25);t[y]=T(t[y]);e[y]=O}}if(f==="path"){i("path")}else{n.noneOrAll(e,t,["x0","x1","y0","y1"])}}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":720,"./helpers":731}],724:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("./draw_newshape/helpers").readPaths;var s=e("./draw_newshape/display_outlines");var l=e("../../plots/cartesian/handle_outline").clearOutlineControllers;var u=e("../color");var c=e("../drawing");var f=e("../../plot_api/plot_template").arrayEditor;var h=e("../dragelement");var p=e("../../lib/setcursor");var d=e("./constants");var v=e("./helpers");t.exports={draw:m,drawOne:x,eraseActiveShape:E};function m(e){var t=e._fullLayout;t._shapeUpperLayer.selectAll("path").remove();t._shapeLowerLayer.selectAll("path").remove();for(var r in t._plots){var n=t._plots[r].shapelayer;if(n)n.selectAll("path").remove()}for(var a=0;a<t.shapes.length;a++){if(t.shapes[a].visible){x(e,a)}}}function g(e){return!!e._fullLayout._drawing}function y(e){return!e._context.edits.shapePosition}function x(e,t){e._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+t+'"]').remove();var r=v.makeOptionsAndPlotinfo(e,t);var n=r.options;var a=r.plotinfo;if(!n._input||n.visible===false)return;if(n.layer!=="below"){l(e._fullLayout._shapeUpperLayer)}else if(n.xref==="paper"||n.yref==="paper"){l(e._fullLayout._shapeLowerLayer)}else{if(a._hadPlotinfo){var i=a.mainplotinfo||a;l(i.shapelayer)}else{l(e._fullLayout._shapeLowerLayer)}}function l(r){var i=w(e,n);var l={"data-index":t,"fill-rule":n.fillrule,d:i};var h=n.opacity;var p=n.fillcolor;var d=n.line.width?n.line.color:"rgba(0,0,0,0)";var v=n.line.width;var m=n.line.dash;if(!v&&n.editable===true){v=5;m="solid"}var g=i[i.length-1]!=="Z";var x=y(e)&&n.editable&&e._fullLayout._activeShapeIndex===t;if(x){p=g?"rgba(0,0,0,0)":e._fullLayout.activeshape.fillcolor;h=e._fullLayout.activeshape.opacity}var T=r.append("path").attr(l).style("opacity",h).call(u.stroke,d).call(u.fill,p).call(c.dashLine,m,v);_(T,e,n);var k;if(x||e._context.edits.shapePosition)k=f(e.layout,"shapes",n);if(x){T.style({cursor:"move"});var M={element:T.node(),plotinfo:a,gd:e,editHelpers:k,isActiveShape:true};var E=o(i,e);s(E,T,M)}else{if(e._context.edits.shapePosition){b(e,T,n,t,r,k)}else if(n.editable===true){T.style("pointer-events",g||u.opacity(p)*h<=.5?"stroke":"all")}}T.node().addEventListener("click",function(){return A(e,T)})}}function _(e,t,r){var n=(r.xref+r.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");c.setClipUrl(e,n?"clip"+t._fullLayout._uid+n:null,t)}function b(e,t,r,o,s,l){var u=10;var f=10;var m=r.xsizemode==="pixel";var y=r.ysizemode==="pixel";var x=r.type==="line";var b=r.type==="path";var T=l.modifyItem;var A,M,E,S,C,L;var I,O,P,D,R,z,N,F;var B;var j=i.getFromId(e,r.xref);var U=i.getRefType(r.xref);var H=i.getFromId(e,r.yref);var V=i.getRefType(r.yref);var G=v.getDataToPixel(e,j,false,U);var q=v.getDataToPixel(e,H,true,V);var Y=v.getPixelToData(e,j,false,U);var W=v.getPixelToData(e,H,true,V);var X=J();var Z={element:X.node(),gd:e,prepFn:ee,doneFn:te,clickFn:re};var K;h.init(Z);X.node().onmousemove=$;function J(){return x?Q():t}function Q(){var e=10;var n=Math.max(r.line.width,e);var a=s.append("g").attr("data-index",o);a.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":n,"stroke-opacity":"0"});var i={"fill-opacity":"0"};var l=Math.max(n/2,e);a.append("circle").attr({"data-line-point":"start-point",cx:m?G(r.xanchor)+r.x0:G(r.x0),cy:y?q(r.yanchor)-r.y0:q(r.y0),r:l}).style(i).classed("cursor-grab",true);a.append("circle").attr({"data-line-point":"end-point",cx:m?G(r.xanchor)+r.x1:G(r.x1),cy:y?q(r.yanchor)-r.y1:q(r.y1),r:l}).style(i).classed("cursor-grab",true);return a}function $(r){if(g(e)){K=null;return}if(x){if(r.target.tagName==="path"){K="move"}else{K=r.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point"}}else{var n=Z.element.getBoundingClientRect();var a=n.right-n.left;var i=n.bottom-n.top;var o=r.clientX-n.left;var s=r.clientY-n.top;var l=!b&&a>u&&i>f&&!r.shiftKey?h.getCursor(o/a,1-s/i):"move";p(t,l);K=l.split("-")[0]}}function ee(n){if(g(e))return;if(m){C=G(r.xanchor)}if(y){L=q(r.yanchor)}if(r.type==="path"){B=r.path}else{A=m?r.x0:G(r.x0);M=y?r.y0:q(r.y0);E=m?r.x1:G(r.x1);S=y?r.y1:q(r.y1)}if(A<E){P=A;N="x0";D=E;F="x1"}else{P=E;N="x1";D=A;F="x0"}if(!y&&M<S||y&&M>S){I=M;R="y0";O=S;z="y1"}else{I=S;R="y1";O=M;z="y0"}$(n);ie(s,r);se(t,r,e);Z.moveFn=K==="move"?ne:ae;Z.altKey=n.altKey}function te(){if(g(e))return;p(t);oe(s);_(t,e,r);n.call("_guiRelayout",e,l.getUpdateObj())}function re(){if(g(e))return;oe(s)}function ne(n,a){if(r.type==="path"){var i=function(e){return e};var o=i;var l=i;if(m){T("xanchor",r.xanchor=Y(C+n))}else{o=function e(t){return Y(G(t)+n)};if(j&&j.type==="date")o=v.encodeDate(o)}if(y){T("yanchor",r.yanchor=W(L+a))}else{l=function e(t){return W(q(t)+a)};if(H&&H.type==="date")l=v.encodeDate(l)}T("path",r.path=k(B,o,l))}else{if(m){T("xanchor",r.xanchor=Y(C+n))}else{T("x0",r.x0=Y(A+n));T("x1",r.x1=Y(E+n))}if(y){T("yanchor",r.yanchor=W(L+a))}else{T("y0",r.y0=W(M+a));T("y1",r.y1=W(S+a))}}t.attr("d",w(e,r));ie(s,r)}function ae(n,a){if(b){var i=function(e){return e};var o=i;var l=i;if(m){T("xanchor",r.xanchor=Y(C+n))}else{o=function e(t){return Y(G(t)+n)};if(j&&j.type==="date")o=v.encodeDate(o)}if(y){T("yanchor",r.yanchor=W(L+a))}else{l=function e(t){return W(q(t)+a)};if(H&&H.type==="date")l=v.encodeDate(l)}T("path",r.path=k(B,o,l))}else if(x){if(K==="resize-over-start-point"){var c=A+n;var h=y?M-a:M+a;T("x0",r.x0=m?c:Y(c));T("y0",r.y0=y?h:W(h))}else if(K==="resize-over-end-point"){var p=E+n;var d=y?S-a:S+a;T("x1",r.x1=m?p:Y(p));T("y1",r.y1=y?d:W(d))}}else{var g=function(e){return K.indexOf(e)!==-1};var _=g("n");var U=g("s");var V=g("w");var X=g("e");var Z=_?I+a:I;var J=U?O+a:O;var Q=V?P+n:P;var $=X?D+n:D;if(y){if(_)Z=I-a;if(U)J=O-a}if(!y&&J-Z>f||y&&Z-J>f){T(R,r[R]=y?Z:W(Z));T(z,r[z]=y?J:W(J))}if($-Q>u){T(N,r[N]=m?Q:Y(Q));T(F,r[F]=m?$:Y($))}}t.attr("d",w(e,r));ie(s,r)}function ie(e,t){if(m||y){r()}function r(){var r=t.type!=="path";var n=e.selectAll(".visual-cue").data([0]);var i=1;n.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":i}).classed("visual-cue",true);var o=G(m?t.xanchor:a.midRange(r?[t.x0,t.x1]:v.extractPathCoords(t.path,d.paramIsX)));var s=q(y?t.yanchor:a.midRange(r?[t.y0,t.y1]:v.extractPathCoords(t.path,d.paramIsY)));o=v.roundPositionForSharpStrokeRendering(o,i);s=v.roundPositionForSharpStrokeRendering(s,i);if(m&&y){var l="M"+(o-1-i)+","+(s-1-i)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";n.attr("d",l)}else if(m){var u="M"+(o-1-i)+","+(s-9-i)+"v18 h2 v-18 Z";n.attr("d",u)}else{var c="M"+(o-9-i)+","+(s-1-i)+"h18 v2 h-18 Z";n.attr("d",c)}}}function oe(e){e.selectAll(".visual-cue").remove()}function se(e,t,r){var n=t.xref;var a=t.yref;var o=i.getFromId(r,n);var s=i.getFromId(r,a);var l="";if(n!=="paper"&&!o.autorange)l+=n;if(a!=="paper"&&!s.autorange)l+=a;c.setClipUrl(e,l?"clip"+r._fullLayout._uid+l:null,r)}}function w(e,t){var r=t.type;var n=i.getRefType(t.xref);var a=i.getRefType(t.yref);var o=i.getFromId(e,t.xref);var s=i.getFromId(e,t.yref);var l=e._fullLayout._size;var u,c,f,h;var p,d,m,g;if(o){if(n==="domain"){c=function(e){return o._offset+o._length*e}}else{u=v.shapePositionToRange(o);c=function(e){return o._offset+o.r2p(u(e,true))}}}else{c=function(e){return l.l+l.w*e}}if(s){if(a==="domain"){h=function(e){return s._offset+s._length*(1-e)}}else{f=v.shapePositionToRange(s);h=function(e){return s._offset+s.r2p(f(e,true))}}}else{h=function(e){return l.t+l.h*(1-e)}}if(r==="path"){if(o&&o.type==="date")c=v.decodeDate(c);if(s&&s.type==="date")h=v.decodeDate(h);return T(t,c,h)}if(t.xsizemode==="pixel"){var y=c(t.xanchor);p=y+t.x0;d=y+t.x1}else{p=c(t.x0);d=c(t.x1)}if(t.ysizemode==="pixel"){var x=h(t.yanchor);m=x-t.y0;g=x-t.y1}else{m=h(t.y0);g=h(t.y1)}if(r==="line")return"M"+p+","+m+"L"+d+","+g;if(r==="rect")return"M"+p+","+m+"H"+d+"V"+g+"H"+p+"Z";var _=(p+d)/2;var b=(m+g)/2;var w=Math.abs(_-p);var k=Math.abs(b-m);var A="A"+w+","+k;var M=_+w+","+b;var E=_+","+(b-k);return"M"+M+A+" 0 1,1 "+E+A+" 0 0,1 "+M+"Z"}function T(e,t,r){var n=e.path;var i=e.xsizemode;var o=e.ysizemode;var s=e.xanchor;var l=e.yanchor;return n.replace(d.segmentRE,function(e){var n=0;var u=e.charAt(0);var c=d.paramIsX[u];var f=d.paramIsY[u];var h=d.numParams[u];var p=e.substr(1).replace(d.paramRE,function(e){if(c[n]){if(i==="pixel")e=t(s)+Number(e);else e=t(e)}else if(f[n]){if(o==="pixel")e=r(l)-Number(e);else e=r(e)}n++;if(n>h)e="X";return e});if(n>h){p=p.replace(/[\s,]*X.*/,"");a.log("Ignoring extra params in segment "+e)}return u+p})}function k(e,t,r){return e.replace(d.segmentRE,function(e){var n=0;var a=e.charAt(0);var i=d.paramIsX[a];var o=d.paramIsY[a];var s=d.numParams[a];var l=e.substr(1).replace(d.paramRE,function(e){if(n>=s)return e;if(i[n])e=t(e);else if(o[n])e=r(e);n++;return e});return a+l})}function A(e,t){if(!y(e))return;var r=t.node();var n=+r.getAttribute("data-index");if(n>=0){if(n===e._fullLayout._activeShapeIndex){M(e);return}e._fullLayout._activeShapeIndex=n;e._fullLayout._deactivateShape=M;m(e)}}function M(e){if(!y(e))return;var t=e._fullLayout._activeShapeIndex;if(t>=0){l(e);delete e._fullLayout._activeShapeIndex;m(e)}}function E(e){if(!y(e))return;l(e);var t=e._fullLayout._activeShapeIndex;var r=(e.layout||{}).shapes||[];if(t<r.length){var a=[];for(var i=0;i<r.length;i++){if(i!==t){a.push(r[i])}}delete e._fullLayout._activeShapeIndex;n.call("_guiRelayout",e,{shapes:a})}}},{"../../lib":778,"../../lib/setcursor":799,"../../plot_api/plot_template":817,"../../plots/cartesian/axes":828,"../../plots/cartesian/handle_outline":838,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"./constants":722,"./draw_newshape/display_outlines":728,"./draw_newshape/helpers":729,"./helpers":731}],725:[function(e,t,r){"use strict";var n=e("../../drawing/attributes").dash;var a=e("../../../lib/extend").extendFlat;t.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:a({},n,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":768,"../../drawing/attributes":664}],726:[function(e,t,r){"use strict";var n=32;t.exports={CIRCLE_SIDES:n,i000:0,i090:n/4,i180:n/2,i270:n/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],727:[function(e,t,r){"use strict";var n=e("../../color");t.exports=function e(t,r,a){a("newshape.drawdirection");a("newshape.layer");a("newshape.fillcolor");a("newshape.fillrule");a("newshape.opacity");var i=a("newshape.line.width");if(i){var o=(t||{}).plot_bgcolor||"#FFF";a("newshape.line.color",n.contrast(o));a("newshape.line.dash")}a("activeshape.fillcolor");a("activeshape.opacity")}},{"../../color":643}],728:[function(e,t,r){"use strict";var n=e("../../dragelement");var a=e("../../dragelement/helpers");var i=a.drawMode;var o=e("../../../registry");var s=e("./constants");var l=s.i000;var u=s.i090;var c=s.i180;var f=s.i270;var h=e("../../../plots/cartesian/handle_outline");var p=h.clearOutlineControllers;var d=e("./helpers");var v=d.pointsShapeRectangle;var m=d.pointsShapeEllipse;var g=d.writePaths;var y=e("./newshapes");t.exports=function e(t,r,a,s){if(!s)s=0;var h=a.gd;function d(){e(t,r,a,s++);if(m(t[0])){_({redrawing:true})}}function _(e){a.isActiveShape=false;var t=y(r,a);if(Object.keys(t).length){o.call((e||{}).redrawing?"relayout":"_guiRelayout",h,t)}}var b=a.isActiveShape;var w=h._fullLayout;var T=w._zoomlayer;var k=a.dragmode;var A=i(k);if(A)h._fullLayout._drawing=true;else if(h._fullLayout._activeShapeIndex>=0)p(h);r.attr("d",g(t));var M;var E;var S;var C;var L;if(b&&!s){L=x([],t);var I=T.append("g").attr("class","outline-controllers");N(I);H()}function O(e){S=+e.srcElement.getAttribute("data-i");C=+e.srcElement.getAttribute("data-j");M[S][C].moveFn=P}function P(e,r){if(!t.length)return;var n=L[S][C][1];var a=L[S][C][2];var i=t[S];var o=i.length;if(v(i)){for(var s=0;s<o;s++){if(s===C)continue;var l=i[s];if(l[1]===i[C][1]){l[1]=n+e}if(l[2]===i[C][2]){l[2]=a+r}}i[C][1]=n+e;i[C][2]=a+r;if(!v(i)){for(var u=0;u<o;u++){for(var c=0;c<i[u].length;c++){i[u][c]=L[S][u][c]}}}}else{i[C][1]=n+e;i[C][2]=a+r}d()}function D(){_()}function R(){if(!t.length)return;if(!t[S])return;if(!t[S].length)return;var e=[];for(var r=0;r<t[S].length;r++){if(r!==C){e.push(t[S][r])}}if(e.length>1&&!(e.length===2&&e[1][0]==="Z")){if(C===0){e[0][0]="M"}t[S]=e;d();_()}}function z(e,r){if(e===2){S=+r.srcElement.getAttribute("data-i");C=+r.srcElement.getAttribute("data-j");var n=t[S];if(!v(n)&&!m(n)){R()}}}function N(e){M=[];for(var r=0;r<t.length;r++){var a=t[r];var i=v(a);var o=!i&&m(a);M[r]=[];for(var s=0;s<a.length;s++){if(a[s][0]==="Z")continue;if(o&&s!==l&&s!==u&&s!==c&&s!==f){continue}var p=a[s][1];var d=a[s][2];var g=e.append("circle").classed("cursor-grab",true).attr("data-i",r).attr("data-j",s).attr("cx",p).attr("cy",d).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});M[r][s]={element:g.node(),gd:h,prepFn:O,doneFn:D,clickFn:z};n.init(M[r][s])}}}function F(e,r){if(!t.length)return;for(var n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++){for(var i=0;i+2<t[n][a].length;i+=2){t[n][a][i+1]=L[n][a][i+1]+e;t[n][a][i+2]=L[n][a][i+2]+r}}}}function B(e,t){F(e,t);d()}function j(e){S=+e.srcElement.getAttribute("data-i");if(!S)S=0;E[S].moveFn=B}function U(){_()}function H(){E=[];if(!t.length)return;var e=0;E[e]={element:r[0][0],gd:h,prepFn:j,doneFn:U};n.init(E[e])}};function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];e[r]=[];for(var a=0;a<n.length;a++){e[r][a]=[];for(var i=0;i<n[a].length;i++){e[r][a][i]=n[a][i]}}}return e}},{"../../../plots/cartesian/handle_outline":838,"../../../registry":911,"../../dragelement":662,"../../dragelement/helpers":661,"./constants":726,"./helpers":729,"./newshapes":730}],729:[function(e,t,r){"use strict";var n=e("parse-svg-path");var a=e("./constants");var i=a.CIRCLE_SIDES;var o=a.SQRT2;var s=e("../../../plots/cartesian/helpers");var l=s.p2r;var u=s.r2p;var c=[0,3,4,5,6,1,2];var f=[0,3,4,1,2];r.writePaths=function(e){var t=e.length;if(!t)return"M0,0Z";var r="";for(var n=0;n<t;n++){var a=e[n].length;for(var i=0;i<a;i++){var o=e[n][i][0];if(o==="Z"){r+="Z"}else{var s=e[n][i].length;for(var l=0;l<s;l++){var u=l;if(o==="Q"||o==="S"){u=f[l]}else if(o==="C"){u=c[l]}r+=e[n][i][u];if(l>0&&l<s-1){r+=","}}}}}return r};r.readPaths=function(e,t,r,a){var o=n(e);var s=[];var c=-1;var f=function(){c++;s[c]=[]};var h;var p=0;var d=0;var v;var m;var g=function(){v=p;m=d};g();for(var y=0;y<o.length;y++){var x=[];var _,b,w,T;var k=o[y][0];var A=k;switch(k){case"M":f();p=+o[y][1];d=+o[y][2];x.push([A,p,d]);g();break;case"Q":case"S":_=+o[y][1];w=+o[y][2];p=+o[y][3];d=+o[y][4];x.push([A,p,d,_,w]);break;case"C":_=+o[y][1];w=+o[y][2];b=+o[y][3];T=+o[y][4];p=+o[y][5];d=+o[y][6];x.push([A,p,d,_,w,b,T]);break;case"T":case"L":p=+o[y][1];d=+o[y][2];x.push([A,p,d]);break;case"H":A="L";p=+o[y][1];x.push([A,p,d]);break;case"V":A="L";d=+o[y][1];x.push([A,p,d]);break;case"A":A="L";var M=+o[y][1];var E=+o[y][2];if(!+o[y][4]){M=-M;E=-E}var S=p-M;var C=d;for(h=1;h<=i/2;h++){var L=2*Math.PI*h/i;x.push([A,S+M*Math.cos(L),C+E*Math.sin(L)])}break;case"Z":if(p!==v||d!==m){p=v;d=m;x.push([A,p,d])}break}var I=(r||{}).domain;var O=t._fullLayout._size;var P=r&&r.xsizemode==="pixel";var D=r&&r.ysizemode==="pixel";var R=a===false;for(var z=0;z<x.length;z++){for(h=0;h+2<7;h+=2){var N=x[z][h+1];var F=x[z][h+2];if(N===undefined||F===undefined)continue;p=N;d=F;if(r){if(r.xaxis&&r.xaxis.p2r){if(R)N-=r.xaxis._offset;if(P){N=u(r.xaxis,r.xanchor)+N}else{N=l(r.xaxis,N)}}else{if(R)N-=O.l;if(I)N=I.x[0]+N/O.w;else N=N/O.w}if(r.yaxis&&r.yaxis.p2r){if(R)F-=r.yaxis._offset;if(D){F=u(r.yaxis,r.yanchor)-F}else{F=l(r.yaxis,F)}}else{if(R)F-=O.t;if(I)F=I.y[1]-F/O.h;else F=1-F/O.h}}x[z][h+1]=N;x[z][h+2]=F}s[c].push(x[z].slice())}}return s};function h(e,t){return Math.abs(e-t)<=1e-6}function p(e,t){var r=t[1]-e[1];var n=t[2]-e[2];return Math.sqrt(r*r+n*n)}r.pointsShapeRectangle=function(e){var t=e.length;if(t!==5)return false;for(var r=1;r<3;r++){var n=e[0][r]-e[1][r];var a=e[3][r]-e[2][r];if(!h(n,a))return false;var i=e[0][r]-e[3][r];var o=e[1][r]-e[2][r];if(!h(i,o))return false}if(!h(e[0][1],e[1][1])&&!h(e[0][1],e[3][1]))return false;return!!(p(e[0],e[1])*p(e[0],e[3]))};r.pointsShapeEllipse=function(e){var t=e.length;if(t!==i+1)return false;t=i;for(var r=0;r<t;r++){var n=(t*2-r)%t;var a=(t/2+n)%t;var o=(t/2+r)%t;if(!h(p(e[r],e[o]),p(e[n],e[a])))return false}return true};r.handleEllipse=function(e,t,n){if(!e)return[t,n];var a=r.ellipseOver({x0:t[0],y0:t[1],x1:n[0],y1:n[1]});var s=(a.x1+a.x0)/2;var l=(a.y1+a.y0)/2;var u=(a.x1-a.x0)/2;var c=(a.y1-a.y0)/2;if(!u)u=c=c/o;if(!c)c=u=u/o;var f=[];for(var h=0;h<i;h++){var p=h*2*Math.PI/i;f.push([s+u*Math.cos(p),l+c*Math.sin(p)])}return f};r.ellipseOver=function(e){var t=e.x0;var r=e.y0;var n=e.x1;var a=e.y1;var i=n-t;var s=a-r;t-=i;r-=s;var l=(t+n)/2;var u=(r+a)/2;var c=o;i*=c;s*=c;return{x0:l-i,y0:u-s,x1:l+i,y1:u+s}}},{"../../../plots/cartesian/helpers":839,"./constants":726,"parse-svg-path":505}],730:[function(e,t,r){"use strict";var n=e("../../dragelement/helpers");var a=n.drawMode;var i=n.openMode;var o=e("./constants");var s=o.i000;var l=o.i090;var u=o.i180;var c=o.i270;var f=o.cos45;var h=o.sin45;var p=e("../../../plots/cartesian/helpers");var d=p.p2r;var v=p.r2p;var m=e("../../../plots/cartesian/handle_outline");var g=m.clearSelect;var y=e("./helpers");var x=y.readPaths;var _=y.writePaths;var b=y.ellipseOver;t.exports=function e(t,r){if(!t.length)return;var n=t[0][0];if(!n)return;var o=n.getAttribute("d");var p=r.gd;var m=p._fullLayout.newshape;var y=r.plotinfo;var T=y.xaxis;var k=y.yaxis;var A=!!y.domain||!y.xaxis;var M=!!y.domain||!y.yaxis;var E=r.isActiveShape;var S=r.dragmode;var C=(p.layout||{}).shapes||[];if(!a(S)&&E!==undefined){var L=p._fullLayout._activeShapeIndex;if(L<C.length){switch(p._fullLayout.shapes[L].type){case"rect":S="drawrect";break;case"circle":S="drawcircle";break;case"line":S="drawline";break;case"path":var I=C[L].path||"";if(I[I.length-1]==="Z"){S="drawclosedpath"}else{S="drawopenpath"}break}}}var O=i(S);var P=x(o,p,y,E);var D={editable:true,xref:A?"paper":T._id,yref:M?"paper":k._id,layer:m.layer,opacity:m.opacity,line:{color:m.line.color,width:m.line.width,dash:m.line.dash}};if(!O){D.fillcolor=m.fillcolor;D.fillrule=m.fillrule}var R;if(P.length===1)R=P[0];if(R&&S==="drawrect"){D.type="rect";D.x0=R[0][1];D.y0=R[0][2];D.x1=R[2][1];D.y1=R[2][2]}else if(R&&S==="drawline"){D.type="line";D.x0=R[0][1];D.y0=R[0][2];D.x1=R[1][1];D.y1=R[1][2]}else if(R&&S==="drawcircle"){D.type="circle";var z=R[s][1];var N=R[l][1];var F=R[u][1];var B=R[c][1];var j=R[s][2];var U=R[l][2];var H=R[u][2];var V=R[c][2];var G=y.xaxis&&(y.xaxis.type==="date"||y.xaxis.type==="log");var q=y.yaxis&&(y.yaxis.type==="date"||y.yaxis.type==="log");if(G){z=v(y.xaxis,z);N=v(y.xaxis,N);F=v(y.xaxis,F);B=v(y.xaxis,B)}if(q){j=v(y.yaxis,j);U=v(y.yaxis,U);H=v(y.yaxis,H);V=v(y.yaxis,V)}var Y=(N+B)/2;var W=(j+H)/2;var X=(B-N+F-z)/2;var Z=(V-U+H-j)/2;var K=b({x0:Y,y0:W,x1:Y+X*f,y1:W+Z*h});if(G){K.x0=d(y.xaxis,K.x0);K.x1=d(y.xaxis,K.x1)}if(q){K.y0=d(y.yaxis,K.y0);K.y1=d(y.yaxis,K.y1)}D.x0=K.x0;D.y0=K.y0;D.x1=K.x1;D.y1=K.y1}else{D.type="path";if(T&&k)w(P,T,k);D.path=_(P);R=null}g(p);var J=r.editHelpers;var Q=(J||{}).modifyItem;var $=[];for(var ee=0;ee<C.length;ee++){var te=p._fullLayout.shapes[ee];$[ee]=te._input;if(E!==undefined&&ee===p._fullLayout._activeShapeIndex){var re=D;switch(te.type){case"line":case"rect":case"circle":Q("x0",re.x0);Q("x1",re.x1);Q("y0",re.y0);Q("y1",re.y1);break;case"path":Q("path",re.path);break}}}if(E===undefined){$.push(D);return $}return J?J.getUpdateObj():{}};function w(e,t,r){var n=t.type==="date";var a=r.type==="date";if(!n&&!a)return e;for(var i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++){for(var s=0;s+2<e[i][o].length;s+=2){if(n)e[i][o][s+1]=e[i][o][s+1].replace(" ","_");if(a)e[i][o][s+2]=e[i][o][s+2].replace(" ","_")}}}return e}},{"../../../plots/cartesian/handle_outline":838,"../../../plots/cartesian/helpers":839,"../../dragelement/helpers":661,"./constants":726,"./helpers":729}],731:[function(e,t,r){"use strict";var n=e("./constants");var a=e("../../lib");r.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(e){return e}};r.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(e){return e}};r.decodeDate=function(e){return function(t){if(t.replace)t=t.replace("_"," ");return e(t)}};r.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}};r.extractPathCoords=function(e,t){var r=[];var i=e.match(n.segmentRE);i.forEach(function(e){var i=t[e.charAt(0)].drawn;if(i===undefined)return;var o=e.substr(1).match(n.paramRE);if(!o||o.length<i)return;r.push(a.cleanNumber(o[i]))});return r};r.getDataToPixel=function(e,t,n,a){var i=e._fullLayout._size;var o;if(t){if(a==="domain"){o=function(e){return t._length*(n?1-e:e)+t._offset}}else{var s=r.shapePositionToRange(t);o=function(e){return t._offset+t.r2p(s(e,true))};if(t.type==="date")o=r.decodeDate(o)}}else if(n){o=function(e){return i.t+i.h*(1-e)}}else{o=function(e){return i.l+i.w*e}}return o};r.getPixelToData=function(e,t,n,a){var i=e._fullLayout._size;var o;if(t){if(a==="domain"){o=function(e){var r=(e-t._offset)/t._length;return n?1-r:r}}else{var s=r.rangeToShapePosition(t);o=function(e){return s(t.p2r(e-t._offset))}}}else if(n){o=function(e){return 1-(e-i.t)/i.h}}else{o=function(e){return(e-i.l)/i.w}}return o};r.roundPositionForSharpStrokeRendering=function(e,t){var r=Math.round(t%2)===1;var n=Math.round(e);return r?n+.5:n};r.makeOptionsAndPlotinfo=function(e,t){var r=e._fullLayout.shapes[t]||{};var n=e._fullLayout._plots[r.xref+r.yref];var a=!!n;if(a){n._hadPlotinfo=true}else{n={};if(r.xref&&r.xref!=="paper")n.xaxis=e._fullLayout[r.xref+"axis"];if(r.yref&&r.yref!=="paper")n.yaxis=e._fullLayout[r.yref+"axis"]}n.xsizemode=r.xsizemode;n.ysizemode=r.ysizemode;n.xanchor=r.xanchor;n.yanchor=r.yanchor;return{options:r,plotinfo:n}}},{"../../lib":778,"./constants":722}],732:[function(e,t,r){"use strict";var n=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),supplyDrawNewShapeDefaults:e("./draw_newshape/defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:n.draw,drawOne:n.drawOne}},{"../../plots/cartesian/include_components":840,"./attributes":720,"./calc_autorange":721,"./defaults":723,"./draw":724,"./draw_newshape/defaults":727}],733:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("../../plots/pad_attributes");var i=e("../../lib/extend").extendDeepAll;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/animation_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=e("./constants");var c=l("step",{visible:{valType:"boolean",dflt:true},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:true}});t.exports=o(l("slider",{visible:{valType:"boolean",dflt:true},active:{valType:"number",min:0,dflt:0},steps:c,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:i(a({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:s.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:true},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:n({})},font:n({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/animation_attributes":822,"../../plots/font_attributes":856,"../../plots/pad_attributes":890,"./constants":734}],734:[function(e,t,r){"use strict";t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],735:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/array_container_defaults");var i=e("./attributes");var o=e("./constants");var s=o.name;var l=i.steps;t.exports=function e(t,r){a(t,r,{name:s,handleItemDefaults:u})};function u(e,t,r){function o(r,a){return n.coerce(e,t,i,r,a)}var s=a(e,t,{name:"steps",handleItemDefaults:c});var l=0;for(var u=0;u<s.length;u++){if(s[u].visible)l++}var f;if(l<2)f=t.visible=false;else f=o("visible");if(!f)return;t._stepCount=l;var h=t._visibleSteps=n.filterVisible(s);var p=o("active");if(!(s[p]||{}).visible)t.active=h[0]._index;o("x");o("y");n.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("len");o("lenmode");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);var d=o("currentvalue.visible");if(d){o("currentvalue.xanchor");o("currentvalue.prefix");o("currentvalue.suffix");o("currentvalue.offset");n.coerceFont(o,"currentvalue.font",t.font)}o("transition.duration");o("transition.easing");o("bgcolor");o("activebgcolor");o("bordercolor");o("borderwidth");o("ticklen");o("tickwidth");o("tickcolor");o("minorticklen")}function c(e,t){function r(r,a){return n.coerce(e,t,l,r,a)}var a;if(e.method!=="skip"&&!Array.isArray(e.args)){a=t.visible=false}else a=r("visible");if(a){r("method");r("args");var i=r("label","step-"+t._index);r("value",i);r("execute")}}},{"../../lib":778,"../../plots/array_container_defaults":823,"./attributes":733,"./constants":734}],736:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../plots/plots");var i=e("../color");var o=e("../drawing");var s=e("../../lib");var l=s.strTranslate;var u=e("../../lib/svg_text_utils");var c=e("../../plot_api/plot_template").arrayEditor;var f=e("./constants");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var d=h.FROM_TL;var v=h.FROM_BR;t.exports=function e(t){var r=t._fullLayout;var i=g(r,t);var o=r._infolayer.selectAll("g."+f.containerClassName).data(i.length>0?[0]:[]);o.enter().append("g").classed(f.containerClassName,true).style("cursor","ew-resize");function s(e){if(e._commandObserver){e._commandObserver.remove();delete e._commandObserver}a.autoMargin(t,m(e))}o.exit().each(function(){n.select(this).selectAll("g."+f.groupClassName).each(s)}).remove();if(i.length===0)return;var l=o.selectAll("g."+f.groupClassName).data(i,y);l.enter().append("g").classed(f.groupClassName,true);l.exit().each(s).remove();for(var u=0;u<i.length;u++){var c=i[u];x(t,c)}l.each(function(e){var r=n.select(this);C(e);a.manageCommandObserver(t,e,e._visibleSteps,function(e){var n=r.data()[0];if(n.active===e.index)return;if(n._dragging)return;M(t,r,n,e.index,false,true)});_(t,n.select(this),e)})};function m(e){return f.autoMarginIdRoot+e._index}function g(e,t){var r=e[f.name];var n=[];for(var a=0;a<r.length;a++){var i=r[a];if(!i.visible)continue;i._gd=t;n.push(i)}return n}function y(e){return e._index}function x(e,t){var r=o.tester.selectAll("g."+f.labelGroupClass).data(t._visibleSteps);r.enter().append("g").classed(f.labelGroupClass,true);var i=0;var l=0;r.each(function(e){var r=n.select(this);var a=T(r,{step:e},t);var s=a.node();if(s){var u=o.bBox(s);l=Math.max(l,u.height);i=Math.max(i,u.width)}});r.remove();var c=t._dims={};c.inputAreaWidth=Math.max(f.railWidth,f.gripHeight);var h=e._fullLayout._size;c.lx=h.l+h.w*t.x;c.ly=h.t+h.h*(1-t.y);if(t.lenmode==="fraction"){c.outerLength=Math.round(h.w*t.len)}else{c.outerLength=t.len}c.inputAreaStart=0;c.inputAreaLength=Math.round(c.outerLength-t.pad.l-t.pad.r);var p=c.inputAreaLength-2*f.stepInset;var g=p/(t._stepCount-1);var y=i+f.labelPadding;c.labelStride=Math.max(1,Math.ceil(y/g));c.labelHeight=l;c.currentValueMaxWidth=0;c.currentValueHeight=0;c.currentValueTotalHeight=0;c.currentValueMaxLines=1;if(t.currentvalue.visible){var x=o.tester.append("g");r.each(function(e){var r=b(x,t,e.label);var n=r.node()&&o.bBox(r.node())||{width:0,height:0};var a=u.lineCount(r);c.currentValueMaxWidth=Math.max(c.currentValueMaxWidth,Math.ceil(n.width));c.currentValueHeight=Math.max(c.currentValueHeight,Math.ceil(n.height));c.currentValueMaxLines=Math.max(c.currentValueMaxLines,a)});c.currentValueTotalHeight=c.currentValueHeight+t.currentvalue.offset;x.remove()}c.height=c.currentValueTotalHeight+f.tickOffset+t.ticklen+f.labelOffset+c.labelHeight+t.pad.t+t.pad.b;var _="left";if(s.isRightAnchor(t)){c.lx-=c.outerLength;_="right"}if(s.isCenterAnchor(t)){c.lx-=c.outerLength/2;_="center"}var w="top";if(s.isBottomAnchor(t)){c.ly-=c.height;w="bottom"}if(s.isMiddleAnchor(t)){c.ly-=c.height/2;w="middle"}c.outerLength=Math.ceil(c.outerLength);c.height=Math.ceil(c.height);c.lx=Math.round(c.lx);c.ly=Math.round(c.ly);var k={y:t.y,b:c.height*v[w],t:c.height*d[w]};if(t.lenmode==="fraction"){k.l=0;k.xl=t.x-t.len*d[_];k.r=0;k.xr=t.x+t.len*v[_]}else{k.x=t.x;k.l=c.outerLength*d[_];k.r=c.outerLength*v[_]}a.autoMargin(e,m(t),k)}function _(e,t,r){if(!(r.steps[r.active]||{}).visible){r.active=r._visibleSteps[0]._index}t.call(b,r).call(D,r).call(k,r).call(S,r).call(P,e,r).call(w,e,r);var n=r._dims;o.setTranslate(t,n.lx+r.pad.l,n.ly+r.pad.t);t.call(L,r,false);t.call(b,r)}function b(e,t,r){if(!t.currentvalue.visible)return;var n=t._dims;var a,i;switch(t.currentvalue.xanchor){case"right":a=n.inputAreaLength-f.currentValueInset-n.currentValueMaxWidth;i="left";break;case"center":a=n.inputAreaLength*.5;i="middle";break;default:a=f.currentValueInset;i="left"}var l=s.ensureSingle(e,"text",f.labelClass,function(e){e.attr({"text-anchor":i,"data-notex":1})});var c=t.currentvalue.prefix?t.currentvalue.prefix:"";if(typeof r==="string"){c+=r}else{var h=t.steps[t.active].label;var d=t._gd._fullLayout._meta;if(d)h=s.templateString(h,d);c+=h}if(t.currentvalue.suffix){c+=t.currentvalue.suffix}l.call(o.font,t.currentvalue.font).text(c).call(u.convertToTspans,t._gd);var v=u.lineCount(l);var m=(n.currentValueMaxLines+1-v)*t.currentvalue.font.size*p;u.positionText(l,a,m);return l}function w(e,t,r){var n=s.ensureSingle(e,"rect",f.gripRectClass,function(n){n.call(E,t,e,r).style("pointer-events","all")});n.attr({width:f.gripWidth,height:f.gripHeight,rx:f.gripRadius,ry:f.gripRadius}).call(i.stroke,r.bordercolor).call(i.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px")}function T(e,t,r){var n=s.ensureSingle(e,"text",f.labelClass,function(e){e.attr({"text-anchor":"middle","data-notex":1})});var a=t.step.label;var i=r._gd._fullLayout._meta;if(i)a=s.templateString(a,i);n.call(o.font,r.font).text(a).call(u.convertToTspans,r._gd);return n}function k(e,t){var r=s.ensureSingle(e,"g",f.labelsClass);var a=t._dims;var i=r.selectAll("g."+f.labelGroupClass).data(a.labelSteps);i.enter().append("g").classed(f.labelGroupClass,true);i.exit().remove();i.each(function(e){var r=n.select(this);r.call(T,e,t);o.setTranslate(r,I(t,e.fraction),f.tickOffset+t.ticklen+t.font.size*p+f.labelOffset+a.currentValueTotalHeight)})}function A(e,t,r,n,a){var i=Math.round(n*(r._stepCount-1));var o=r._visibleSteps[i]._index;if(o!==r.active){M(e,t,r,o,true,a)}}function M(e,t,r,n,i,o){var s=r.active;r.active=n;c(e.layout,f.name,r).applyUpdate("active",n);var l=r.steps[r.active];t.call(L,r,o);t.call(b,r);e.emit("plotly_sliderchange",{slider:r,step:r.steps[r.active],interaction:i,previousActive:s});if(l&&l.method&&i){if(t._nextMethod){t._nextMethod.step=l;t._nextMethod.doCallback=i;t._nextMethod.doTransition=o}else{t._nextMethod={step:l,doCallback:i,doTransition:o};t._nextMethodRaf=window.requestAnimationFrame(function(){var r=t._nextMethod.step;if(!r.method)return;if(r.execute){a.executeAPICommand(e,r.method,r.args)}t._nextMethod=null;t._nextMethodRaf=null})}}}function E(e,t,r){var a=r.node();var o=n.select(t);function s(){return r.data()[0]}e.on("mousedown",function(){var e=s();t.emit("plotly_sliderstart",{slider:e});var l=r.select("."+f.gripRectClass);n.event.stopPropagation();n.event.preventDefault();l.call(i.fill,e.activebgcolor);var u=O(e,n.mouse(a)[0]);A(t,r,e,u,true);e._dragging=true;o.on("mousemove",function(){var e=s();var i=O(e,n.mouse(a)[0]);A(t,r,e,i,false)});o.on("mouseup",function(){var e=s();e._dragging=false;l.call(i.fill,e.bgcolor);o.on("mouseup",null);o.on("mousemove",null);t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})})})}function S(e,t){var r=e.selectAll("rect."+f.tickRectClass).data(t._visibleSteps);var a=t._dims;r.enter().append("rect").classed(f.tickRectClass,true);r.exit().remove();r.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"});r.each(function(e,r){var s=r%a.labelStride===0;var l=n.select(this);l.attr({height:s?t.ticklen:t.minorticklen}).call(i.fill,s?t.tickcolor:t.tickcolor);o.setTranslate(l,I(t,r/(t._stepCount-1))-.5*t.tickwidth,(s?f.tickOffset:f.minorTickOffset)+a.currentValueTotalHeight)})}function C(e){var t=e._dims;t.labelSteps=[];var r=e._stepCount;for(var n=0;n<r;n+=t.labelStride){t.labelSteps.push({fraction:n/(r-1),step:e._visibleSteps[n]})}}function L(e,t,r){var n=e.select("rect."+f.gripRectClass);var a=0;for(var i=0;i<t._stepCount;i++){if(t._visibleSteps[i]._index===t.active){a=i;break}}var o=I(t,a/(t._stepCount-1));if(t._invokingCommand)return;var s=n;if(r&&t.transition.duration>0){s=s.transition().duration(t.transition.duration).ease(t.transition.easing)}s.attr("transform",l(o-f.gripWidth*.5,t._dims.currentValueTotalHeight))}function I(e,t){var r=e._dims;return r.inputAreaStart+f.stepInset+(r.inputAreaLength-2*f.stepInset)*Math.min(1,Math.max(0,t))}function O(e,t){var r=e._dims;return Math.min(1,Math.max(0,(t-f.stepInset-r.inputAreaStart)/(r.inputAreaLength-2*f.stepInset-2*r.inputAreaStart)))}function P(e,t,r){var n=r._dims;var a=s.ensureSingle(e,"rect",f.railTouchRectClass,function(n){n.call(E,t,e,r).style("pointer-events","all")});a.attr({width:n.inputAreaLength,height:Math.max(n.inputAreaWidth,f.tickOffset+r.ticklen+n.labelHeight)}).call(i.fill,r.bgcolor).attr("opacity",0);o.setTranslate(a,0,n.currentValueTotalHeight)}function D(e,t){var r=t._dims;var n=r.inputAreaLength-f.railInset*2;var a=s.ensureSingle(e,"rect",f.railRectClass);a.attr({width:n,height:f.railWidth,rx:f.railRadius,ry:f.railRadius,"shape-rendering":"crispEdges"}).call(i.stroke,t.bordercolor).call(i.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px");o.setTranslate(a,f.railInset,(r.inputAreaWidth-f.railWidth)*.5+r.currentValueTotalHeight)}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/plots":891,"../color":643,"../drawing":665,"./constants":734,d3:169}],737:[function(e,t,r){"use strict";var n=e("./constants");t.exports={moduleType:"component",name:n.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":733,"./constants":734,"./defaults":735,"./draw":736}],738:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=s.strTranslate;var u=e("../drawing");var c=e("../color");var f=e("../../lib/svg_text_utils");var h=e("../../constants/interactions");var p=e("../../constants/alignment").OPPOSITE_SIDE;var d=/ [XY][0-9]* /;function v(e,t,r){var v=r.propContainer;var m=r.propName;var g=r.placeholder;var y=r.traceIndex;var x=r.avoid||{};var _=r.attributes;var b=r.transform;var w=r.containerGroup;var T=e._fullLayout;var k=1;var A=false;var M=v.title;var E=(M&&M.text?M.text:"").trim();var S=M&&M.font?M.font:{};var C=S.family;var L=S.size;var I=S.color;var O;if(m==="title.text")O="titleText";else if(m.indexOf("axis")!==-1)O="axisTitleText";else if(m.indexOf("colorbar"!==-1))O="colorbarTitleText";var P=e._context.edits[O];if(E==="")k=0;else if(E.replace(d," % ")===g.replace(d," % ")){k=.2;A=true;if(!P)E=""}if(r._meta){E=s.templateString(E,r._meta)}else if(T._meta){E=s.templateString(E,T._meta)}var D=E||P;if(!w){w=s.ensureSingle(T._infolayer,"g","g-"+t)}var R=w.selectAll("text").data(D?[0]:[]);R.enter().append("text");R.text(E).attr("class",t);R.exit().remove();if(!D)return w;function z(e){s.syncOrAsync([N,F],e)}function N(t){var r;if(b){r="";if(b.rotate){r+="rotate("+[b.rotate,_.x,_.y]+")"}if(b.offset){r+=l(0,b.offset)}}else{r=null}t.attr("transform",r);t.style({"font-family":C,"font-size":n.round(L,2)+"px",fill:c.rgb(I),opacity:k*c.opacity(I),"font-weight":i.fontWeight}).attr(_).call(f.convertToTspans,e);return i.previousPromises(e)}function F(e){var t=n.select(e.node().parentNode);if(x&&x.selection&&x.side&&E){t.attr("transform",null);var r=p[x.side];var i=x.side==="left"||x.side==="top"?-1:1;var o=a(x.pad)?x.pad:2;var c=u.bBox(t.node());var f={left:0,top:0,right:T.width,bottom:T.height};var h=x.maxShift||i*(f[x.side]-c[x.side]);var d=0;if(h<0){d=h}else{var v=x.offsetLeft||0;var m=x.offsetTop||0;c.left-=v;c.right-=v;c.top-=m;c.bottom-=m;x.selection.each(function(){var e=u.bBox(this);if(s.bBoxIntersect(c,e,o)){d=Math.max(d,i*(e[x.side]-c[r])+o)}});d=Math.min(h,d)}if(d>0||h<0){var g={left:[-d,0],right:[d,0],top:[0,-d],bottom:[0,d]}[x.side];t.attr("transform",l(g[0],g[1]))}}}R.call(z);function B(){k=0;A=true;R.text(g).on("mouseover.opacity",function(){n.select(this).transition().duration(h.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(h.HIDE_PLACEHOLDER).style("opacity",0)})}if(P){if(!E)B();else R.on(".opacity",null);R.call(f.makeEditable,{gd:e}).on("edit",function(t){if(y!==undefined){o.call("_guiRestyle",e,m,t,y)}else{o.call("_guiRelayout",e,m,t)}}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(z)}).on("input",function(e){this.text(e||" ").call(f.positionText,_.x,_.y)})}R.classed("js-placeholder",A);return w}t.exports={draw:v}},{"../../constants/alignment":745,"../../constants/interactions":752,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"../color":643,"../drawing":665,d3:169,"fast-isnumeric":241}],739:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("../color/attributes");var i=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/pad_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:true}});t.exports=o(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:true},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:i(s({editType:"arraydraw"}),{}),font:n({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:a.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/font_attributes":856,"../../plots/pad_attributes":890,"../color/attributes":642}],740:[function(e,t,r){"use strict";t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"◄",right:"►",up:"▲",down:"▼"}}},{}],741:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/array_container_defaults");var i=e("./attributes");var o=e("./constants");var s=o.name;var l=i.buttons;t.exports=function e(t,r){var n={name:s,handleItemDefaults:u};a(t,r,n)};function u(e,t,r){function o(r,a){return n.coerce(e,t,i,r,a)}var s=a(e,t,{name:"buttons",handleItemDefaults:c});var l=o("visible",s.length>0);if(!l)return;o("active");o("direction");o("type");o("showactive");o("x");o("y");n.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);o("bgcolor",r.paper_bgcolor);o("bordercolor");o("borderwidth")}function c(e,t){function r(r,a){return n.coerce(e,t,l,r,a)}var a=r("visible",e.method==="skip"||Array.isArray(e.args));if(a){r("method");r("args");r("args2");r("label");r("execute")}}},{"../../lib":778,"../../plots/array_container_defaults":823,"./attributes":739,"./constants":740}],742:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../plots/plots");var i=e("../color");var o=e("../drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../../plot_api/plot_template").arrayEditor;var c=e("../../constants/alignment").LINE_SPACING;var f=e("./constants");var h=e("./scrollbox");t.exports=function e(t){var r=t._fullLayout;var i=s.filterVisible(r[f.name]);function o(e){a.autoMargin(t,S(e))}var l=r._menulayer.selectAll("g."+f.containerClassName).data(i.length>0?[0]:[]);l.enter().append("g").classed(f.containerClassName,true).style("cursor","pointer");l.exit().each(function(){n.select(this).selectAll("g."+f.headerGroupClassName).each(o)}).remove();if(i.length===0)return;var u=l.selectAll("g."+f.headerGroupClassName).data(i,p);u.enter().append("g").classed(f.headerGroupClassName,true);var c=s.ensureSingle(l,"g",f.dropdownButtonGroupClassName,function(e){e.style("pointer-events","all")});for(var d=0;d<i.length;d++){var x=i[d];E(t,x)}var _="updatemenus"+r._uid;var b=new h(t,c,_);if(u.enter().size()){c.node().parentNode.appendChild(c.node());c.call(L)}u.exit().each(function(e){c.call(L);o(e)}).remove();u.each(function(e){var r=n.select(this);var i=e.type==="dropdown"?c:null;a.manageCommandObserver(t,e,e.buttons,function(n){m(t,e,e.buttons[n.index],r,i,b,n.index,true)});if(e.type==="dropdown"){g(t,r,c,b,e);if(v(c,e)){y(t,r,c,b,e)}}else{y(t,r,null,null,e)}})};function p(e){return e._index}function d(e){return+e.attr(f.menuIndexAttrName)===-1}function v(e,t){return+e.attr(f.menuIndexAttrName)===t._index}function m(e,t,r,n,a,i,o,s){t.active=o;u(e.layout,f.name,t).applyUpdate("active",o);if(t.type==="buttons"){y(e,n,null,null,t)}else if(t.type==="dropdown"){a.attr(f.menuIndexAttrName,"-1");g(e,n,a,i,t);if(!s){y(e,n,a,i,t)}}}function g(e,t,r,n,a){var i=s.ensureSingle(t,"g",f.headerClassName,function(e){e.style("pointer-events","all")});var l=a._dims;var u=a.active;var c=a.buttons[u]||f.blankHeaderOpts;var h={y:a.pad.t,yPad:0,x:a.pad.l,xPad:0,index:0};var p={width:l.headerWidth,height:l.headerHeight};i.call(b,a,c,e).call(C,a,h,p);var d=s.ensureSingle(t,"text",f.headerArrowClassName,function(e){e.attr("text-anchor","end").call(o.font,a.font).text(f.arrowSymbol[a.direction])});d.attr({x:l.headerWidth-f.arrowOffsetX+a.pad.l,y:l.headerHeight/2+f.textOffsetY+a.pad.t});i.on("click",function(){r.call(L,String(v(r,a)?-1:a._index));y(e,t,r,n,a)});i.on("mouseover",function(){i.call(A)});i.on("mouseout",function(){i.call(M,a)});o.setTranslate(t,l.lx,l.ly)}function y(e,t,r,i,o){if(!r){r=t;r.attr("pointer-events","all")}var l=!d(r)||o.type==="buttons"?o.buttons:[];var u=o.type==="dropdown"?f.dropdownButtonClassName:f.buttonClassName;var c=r.selectAll("g."+u).data(s.filterVisible(l));var h=c.enter().append("g").classed(u,true);var p=c.exit();if(o.type==="dropdown"){h.attr("opacity","0").transition().attr("opacity","1");p.transition().attr("opacity","0").remove()}else{p.remove()}var v=0;var g=0;var y=o._dims;var w=["up","down"].indexOf(o.direction)!==-1;if(o.type==="dropdown"){if(w){g=y.headerHeight+f.gapButtonHeader}else{v=y.headerWidth+f.gapButtonHeader}}if(o.type==="dropdown"&&o.direction==="up"){g=-f.gapButtonHeader+f.gapButton-y.openHeight}if(o.type==="dropdown"&&o.direction==="left"){v=-f.gapButtonHeader+f.gapButton-y.openWidth}var T={x:y.lx+v+o.pad.l,y:y.ly+g+o.pad.t,yPad:f.gapButton,xPad:f.gapButton,index:0};var E={l:T.x+o.borderwidth,t:T.y+o.borderwidth};c.each(function(s,l){var u=n.select(this);u.call(b,o,s,e).call(C,o,T);u.on("click",function(){if(n.event.defaultPrevented)return;if(s.execute){if(s.args2&&o.active===l){m(e,o,s,t,r,i,-1);a.executeAPICommand(e,s.method,s.args2)}else{m(e,o,s,t,r,i,l);a.executeAPICommand(e,s.method,s.args)}}e.emit("plotly_buttonclicked",{menu:o,button:s,active:o.active})});u.on("mouseover",function(){u.call(A)});u.on("mouseout",function(){u.call(M,o);c.call(k,o)})});c.call(k,o);if(w){E.w=Math.max(y.openWidth,y.headerWidth);E.h=T.y-E.t}else{E.w=T.x-E.l;E.h=Math.max(y.openHeight,y.headerHeight)}E.direction=o.direction;if(i){if(c.size()){x(e,t,r,i,o,E)}else{_(i)}}}function x(e,t,r,n,a,i){var o=a.direction;var s=o==="up"||o==="down";var l=a._dims;var u=a.active;var c,h;var p;if(s){h=0;for(p=0;p<u;p++){h+=l.heights[p]+f.gapButton}}else{c=0;for(p=0;p<u;p++){c+=l.widths[p]+f.gapButton}}n.enable(i,c,h);if(n.hbar){n.hbar.attr("opacity","0").transition().attr("opacity","1")}if(n.vbar){n.vbar.attr("opacity","0").transition().attr("opacity","1")}}function _(e){var t=!!e.hbar;var r=!!e.vbar;if(t){e.hbar.transition().attr("opacity","0").each("end",function(){t=false;if(!r)e.disable()})}if(r){e.vbar.transition().attr("opacity","0").each("end",function(){r=false;if(!t)e.disable()})}}function b(e,t,r,n){e.call(w,t).call(T,t,r,n)}function w(e,t){var r=s.ensureSingle(e,"rect",f.itemRectClassName,function(e){e.attr({rx:f.rx,ry:f.ry,"shape-rendering":"crispEdges"})});r.call(i.stroke,t.bordercolor).call(i.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function T(e,t,r,n){var a=s.ensureSingle(e,"text",f.itemTextClassName,function(e){e.attr({"text-anchor":"start","data-notex":1})});var i=r.label;var u=n._fullLayout._meta;if(u)i=s.templateString(i,u);a.call(o.font,t.font).text(i).call(l.convertToTspans,n)}function k(e,t){var r=t.active;e.each(function(e,a){var o=n.select(this);if(a===r&&t.showactive){o.select("rect."+f.itemRectClassName).call(i.fill,f.activeColor)}})}function A(e){e.select("rect."+f.itemRectClassName).call(i.fill,f.hoverColor)}function M(e,t){e.select("rect."+f.itemRectClassName).call(i.fill,t.bgcolor)}function E(e,t){var r=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0};var i=o.tester.selectAll("g."+f.dropdownButtonClassName).data(s.filterVisible(t.buttons));i.enter().append("g").classed(f.dropdownButtonClassName,true);var u=["up","down"].indexOf(t.direction)!==-1;i.each(function(a,i){var s=n.select(this);s.call(b,t,a,e);var h=s.select("."+f.itemTextClassName);var p=h.node()&&o.bBox(h.node()).width;var d=Math.max(p+f.textPadX,f.minWidth);var v=t.font.size*c;var m=l.lineCount(h);var g=Math.max(v*m,f.minHeight)+f.textOffsetY;g=Math.ceil(g);d=Math.ceil(d);r.widths[i]=d;r.heights[i]=g;r.height1=Math.max(r.height1,g);r.width1=Math.max(r.width1,d);if(u){r.totalWidth=Math.max(r.totalWidth,d);r.openWidth=r.totalWidth;r.totalHeight+=g+f.gapButton;r.openHeight+=g+f.gapButton}else{r.totalWidth+=d+f.gapButton;r.openWidth+=d+f.gapButton;r.totalHeight=Math.max(r.totalHeight,g);r.openHeight=r.totalHeight}});if(u){r.totalHeight-=f.gapButton}else{r.totalWidth-=f.gapButton}r.headerWidth=r.width1+f.arrowPadX;r.headerHeight=r.height1;if(t.type==="dropdown"){if(u){r.width1+=f.arrowPadX;r.totalHeight=r.height1}else{r.totalWidth=r.width1}r.totalWidth+=f.arrowPadX}i.remove();var h=r.totalWidth+t.pad.l+t.pad.r;var p=r.totalHeight+t.pad.t+t.pad.b;var d=e._fullLayout._size;r.lx=d.l+d.w*t.x;r.ly=d.t+d.h*(1-t.y);var v="left";if(s.isRightAnchor(t)){r.lx-=h;v="right"}if(s.isCenterAnchor(t)){r.lx-=h/2;v="center"}var m="top";if(s.isBottomAnchor(t)){r.ly-=p;m="bottom"}if(s.isMiddleAnchor(t)){r.ly-=p/2;m="middle"}r.totalWidth=Math.ceil(r.totalWidth);r.totalHeight=Math.ceil(r.totalHeight);r.lx=Math.round(r.lx);r.ly=Math.round(r.ly);a.autoMargin(e,S(t),{x:t.x,y:t.y,l:h*({right:1,center:.5}[v]||0),r:h*({left:1,center:.5}[v]||0),b:p*({top:1,middle:.5}[m]||0),t:p*({bottom:1,middle:.5}[m]||0)})}function S(e){return f.autoMarginIdRoot+e._index}function C(e,t,r,n){n=n||{};var a=e.select("."+f.itemRectClassName);var i=e.select("."+f.itemTextClassName);var s=t.borderwidth;var u=r.index;var h=t._dims;o.setTranslate(e,s+r.x,s+r.y);var p=["up","down"].indexOf(t.direction)!==-1;var d=n.height||(p?h.heights[u]:h.height1);a.attr({x:0,y:0,width:n.width||(p?h.width1:h.widths[u]),height:d});var v=t.font.size*c;var m=l.lineCount(i);var g=(m-1)*v/2;l.positionText(i,f.textOffsetX,d/2-g+f.textOffsetY);if(p){r.y+=h.heights[u]+r.yPad}else{r.x+=h.widths[u]+r.xPad}r.index++}function L(e,t){e.attr(f.menuIndexAttrName,t||"-1").selectAll("g."+f.dropdownButtonClassName).remove()}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/plots":891,"../color":643,"../drawing":665,"./constants":740,"./scrollbox":744,d3:169}],743:[function(e,t,r){arguments[4][737][0].apply(r,arguments)},{"./attributes":739,"./constants":740,"./defaults":741,"./draw":742,dup:737}],744:[function(e,t,r){"use strict";t.exports=s;var n=e("d3");var a=e("../color");var i=e("../drawing");var o=e("../../lib");function s(e,t,r){this.gd=e;this.container=t;this.id=r;this.position=null;this.translateX=null;this.translateY=null;this.hbar=null;this.vbar=null;this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]);this.bg.exit().on(".drag",null).on("wheel",null).remove();this.bg.enter().append("rect").classed("scrollbox-bg",true).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}s.barWidth=2;s.barLength=20;s.barRadius=2;s.barPad=1;s.barColor="#808BA4";s.prototype.enable=function e(t,r,o){var l=this.gd._fullLayout;var u=l.width;var c=l.height;this.position=t;var f=this.position.l;var h=this.position.w;var p=this.position.t;var d=this.position.h;var v=this.position.direction;var m=v==="down";var g=v==="left";var y=v==="right";var x=v==="up";var _=h;var b=d;var w,T;var k,A;if(!m&&!g&&!y&&!x){this.position.direction="down";m=true}var M=m||x;if(M){w=f;T=w+_;if(m){k=p;A=Math.min(k+b,c);b=A-k}else{A=p+b;k=Math.max(A-b,0);b=A-k}}else{k=p;A=k+b;if(g){T=f+_;w=Math.max(T-_,0);_=T-w}else{w=f;T=Math.min(w+_,u);_=T-w}}this._box={l:w,t:k,w:_,h:b};var E=h>_;var S=s.barLength+2*s.barPad;var C=s.barWidth+2*s.barPad;var L=f;var I=p+d;if(I+C>c)I=c-C;var O=this.container.selectAll("rect.scrollbar-horizontal").data(E?[0]:[]);O.exit().on(".drag",null).remove();O.enter().append("rect").classed("scrollbar-horizontal",true).call(a.fill,s.barColor);if(E){this.hbar=O.attr({rx:s.barRadius,ry:s.barRadius,x:L,y:I,width:S,height:C});this._hbarXMin=L+S/2;this._hbarTranslateMax=_-S}else{delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}var P=d>b;var D=s.barWidth+2*s.barPad;var R=s.barLength+2*s.barPad;var z=f+h;var N=p;if(z+D>u)z=u-D;var F=this.container.selectAll("rect.scrollbar-vertical").data(P?[0]:[]);F.exit().on(".drag",null).remove();F.enter().append("rect").classed("scrollbar-vertical",true).call(a.fill,s.barColor);if(P){this.vbar=F.attr({rx:s.barRadius,ry:s.barRadius,x:z,y:N,width:D,height:R});this._vbarYMin=N+R/2;this._vbarTranslateMax=b-R}else{delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}var B=this.id;var j=w-.5;var U=P?T+D+.5:T+.5;var H=k-.5;var V=E?A+C+.5:A+.5;var G=l._topdefs.selectAll("#"+B).data(E||P?[0]:[]);G.exit().remove();G.enter().append("clipPath").attr("id",B).append("rect");if(E||P){this._clipRect=G.select("rect").attr({x:Math.floor(j),y:Math.floor(H),width:Math.ceil(U)-Math.floor(j),height:Math.ceil(V)-Math.floor(H)});this.container.call(i.setClipUrl,B,this.gd);this.bg.attr({x:f,y:p,width:h,height:d})}else{this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null);delete this._clipRect}if(E||P){var q=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(q);var Y=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault();n.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));if(E){this.hbar.on(".drag",null).call(Y)}if(P){this.vbar.on(".drag",null).call(Y)}}this.setTranslate(r,o)};s.prototype.disable=function e(){if(this.hbar||this.vbar){this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null);delete this._clipRect}if(this.hbar){this.hbar.on(".drag",null);this.hbar.remove();delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}if(this.vbar){this.vbar.on(".drag",null);this.vbar.remove();delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}};s.prototype._onBoxDrag=function e(){var t=this.translateX;var r=this.translateY;if(this.hbar){t-=n.event.dx}if(this.vbar){r-=n.event.dy}this.setTranslate(t,r)};s.prototype._onBoxWheel=function e(){var t=this.translateX;var r=this.translateY;if(this.hbar){t+=n.event.deltaY}if(this.vbar){r+=n.event.deltaY}this.setTranslate(t,r)};s.prototype._onBarDrag=function e(){var t=this.translateX;var r=this.translateY;if(this.hbar){var a=t+this._hbarXMin;var i=a+this._hbarTranslateMax;var s=o.constrain(n.event.x,a,i);var l=(s-a)/(i-a);var u=this.position.w-this._box.w;t=l*u}if(this.vbar){var c=r+this._vbarYMin;var f=c+this._vbarTranslateMax;var h=o.constrain(n.event.y,c,f);var p=(h-c)/(f-c);var d=this.position.h-this._box.h;r=p*d}this.setTranslate(t,r)};s.prototype.setTranslate=function e(t,r){var n=this.position.w-this._box.w;var a=this.position.h-this._box.h;t=o.constrain(t||0,0,n);r=o.constrain(r||0,0,a);this.translateX=t;this.translateY=r;this.container.call(i.setTranslate,this._box.l-this.position.l-t,this._box.t-this.position.t-r);if(this._clipRect){this._clipRect.attr({x:Math.floor(this.position.l+t-.5),y:Math.floor(this.position.t+r-.5)})}if(this.hbar){var s=t/n;this.hbar.call(i.setTranslate,t+s*this._hbarTranslateMax,r)}if(this.vbar){var l=r/a;this.vbar.call(i.setTranslate,t,r+l*this._vbarTranslateMax)}}},{"../../lib":778,"../color":643,"../drawing":665,d3:169}],745:[function(e,t,r){"use strict";t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],746:[function(e,t,r){"use strict";t.exports={axisRefDescription:function(e,t,r){return["If set to a",e,"axis id (e.g. *"+e+"* or","*"+e+"2*), the `"+e+"` position refers to a",e,"coordinate. If set to *paper*, the `"+e+"`","position refers to the distance from the",t,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",t,"("+r+"). If set to a",e,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",t,"of the domain of that axis: e.g.,","*"+e+"2 domain* refers to the domain of the second",e," axis and a",e,"position of 0.5 refers to the","point between the",t,"and the",r,"of the domain of the","second",e,"axis."].join(" ")}}},{}],747:[function(e,t,r){"use strict";t.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"▲"},DECREASING:{COLOR:"#FF4136",SYMBOL:"▼"}}},{}],748:[function(e,t,r){"use strict";t.exports={FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format#locale_format"}},{}],749:[function(e,t,r){"use strict";t.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],750:[function(e,t,r){"use strict";t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],751:[function(e,t,r){"use strict";t.exports={circle:"●","circle-open":"○",square:"■","square-open":"□",diamond:"◆","diamond-open":"◇",cross:"+",x:"❌"}},{}],752:[function(e,t,r){"use strict";t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],753:[function(e,t,r){"use strict";t.exports={BADNUM:undefined,FP_SAFE:Number.MAX_VALUE/1e4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"−"}},{}],754:[function(e,t,r){"use strict";r.xmlns="http://www.w3.org/2000/xmlns/";r.svg="http://www.w3.org/2000/svg";r.xlink="http://www.w3.org/1999/xlink";r.svgAttrs={xmlns:r.svg,"xmlns:xlink":r.xlink}},{}],755:[function(e,t,r){"use strict";r.version=e("./version").version;e("es6-promise").polyfill();e("../build/plotcss");e("./fonts/mathjax_config")();var n=e("./registry");var a=r.register=n.register;var i=e("./plot_api");var o=Object.keys(i);for(var s=0;s<o.length;s++){var l=o[s];if(l.charAt(0)!=="_")r[l]=i[l];a({moduleType:"apiMethod",name:l,fn:i[l]})}a(e("./traces/scatter"));a([e("./components/legend"),e("./components/fx"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars"),e("./components/colorscale"),e("./components/colorbar")]);a([e("./locale-en"),e("./locale-en-us")]);if(window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)){a(window.PlotlyLocales);delete window.PlotlyLocales}r.Icons=e("./fonts/ploticon");r.Plots=e("./plots/plots");r.Fx=e("./components/fx");r.Snapshot=e("./snapshot");r.PlotSchema=e("./plot_api/plot_schema");r.Queue=e("./lib/queue");r.d3=e("d3")},{"../build/plotcss":1,"./components/annotations":634,"./components/annotations3d":639,"./components/colorbar":649,"./components/colorscale":655,"./components/errorbars":671,"./components/fx":683,"./components/grid":687,"./components/images":692,"./components/legend":700,"./components/rangeselector":711,"./components/rangeslider":718,"./components/shapes":732,"./components/sliders":737,"./components/updatemenus":743,"./fonts/mathjax_config":756,"./fonts/ploticon":757,"./lib/queue":794,"./locale-en":808,"./locale-en-us":807,"./plot_api":812,"./plot_api/plot_schema":816,"./plots/plots":891,"./registry":911,"./snapshot":916,"./traces/scatter":1199,"./version":1370,d3:169,"es6-promise":224}],756:[function(e,t,r){"use strict";t.exports=function(){if(typeof MathJax!=="undefined"){var e=(window.PlotlyConfig||{}).MathJaxConfig!=="local";if(e){MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:true,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});MathJax.Hub.Configured()}}}},{}],757:[function(e,t,r){"use strict";t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],758:[function(e,t,r){"use strict";r.isLeftAnchor=function e(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3};r.isCenterAnchor=function e(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3};r.isRightAnchor=function e(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3};r.isTopAnchor=function e(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3};r.isMiddleAnchor=function e(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3};r.isBottomAnchor=function e(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],759:[function(e,t,r){"use strict";var n=e("./mod");var a=n.mod;var i=n.modHalf;var o=Math.PI;var s=2*o;function l(e){return e/180*o}function u(e){return e/o*180}function c(e){return Math.abs(e[1]-e[0])>s-1e-14}function f(e,t){return i(t-e,s)}function h(e,t){return Math.abs(f(e,t))}function p(e,t){if(c(t))return true;var r,n;if(t[0]<t[1]){r=t[0];n=t[1]}else{r=t[1];n=t[0]}r=a(r,s);n=a(n,s);if(r>n)n+=s;var i=a(e,s);var o=i+s;return i>=r&&i<=n||o>=r&&o<=n}function d(e,t,r,n){if(!p(t,n))return false;var a,i;if(r[0]<r[1]){a=r[0];i=r[1]}else{a=r[1];i=r[0]}return e>=a&&e<=i}function v(e,t,r,n,a,i,l){a=a||0;i=i||0;var u=c([r,n]);var f,h,p;var d,v;if(u){f=0;h=o;p=s}else{if(r<n){f=r;p=n}else{f=n;p=r}}if(e<t){d=e;v=t}else{d=t;v=e}function m(e,t){return[e*Math.cos(t)+a,i-e*Math.sin(t)]}var g=Math.abs(p-f)<=o?0:1;function y(e,t,r){return"A"+[e,e]+" "+[0,g,r]+" "+m(e,t)}var x;if(u){if(d===null){x="M"+m(v,f)+y(v,h,0)+y(v,p,0)+"Z"}else{x="M"+m(d,f)+y(d,h,0)+y(d,p,0)+"Z"+"M"+m(v,f)+y(v,h,1)+y(v,p,1)+"Z"}}else{if(d===null){x="M"+m(v,f)+y(v,p,0);if(l)x+="L0,0Z"}else{x="M"+m(d,f)+"L"+m(v,f)+y(v,p,0)+"L"+m(d,p)+y(d,f,1)+"Z"}}return x}function m(e,t,r,n,a){return v(null,e,t,r,n,a,0)}function g(e,t,r,n,a){return v(null,e,t,r,n,a,1)}function y(e,t,r,n,a,i){return v(e,t,r,n,a,i,1)}t.exports={deg2rad:l,rad2deg:u,angleDelta:f,angleDist:h,isFullCircle:c,isAngleInsideSector:p,isPtInsideSector:d,pathArc:m,pathSector:g,pathAnnulus:y}},{"./mod":785}],760:[function(e,t,r){"use strict";var n=Array.isArray;var a=typeof ArrayBuffer==="undefined"||!ArrayBuffer.isView?{isView:function(){return false}}:ArrayBuffer;var i=typeof DataView==="undefined"?function(){}:DataView;function o(e){return a.isView(e)&&!(e instanceof i)}r.isTypedArray=o;function s(e){return n(e)||o(e)}r.isArrayOrTypedArray=s;function l(e){return!s(e[0])}r.isArray1D=l;r.ensureArray=function(e,t){if(!n(e))e=[];e.length=t;return e};r.concat=function(){var e=[];var t=true;var r=0;var a,i,o,s,l,u,c,f;for(o=0;o<arguments.length;o++){s=arguments[o];u=s.length;if(u){if(i)e.push(s);else{i=s;l=u}if(n(s)){a=false}else{t=false;if(!r){a=s.constructor}else if(a!==s.constructor){a=false}}r+=u}}if(!r)return[];if(!e.length)return i;if(t)return i.concat.apply(i,e);if(a){c=new a(r);c.set(i);for(o=0;o<e.length;o++){s=e[o];c.set(s,l);l+=s.length}return c}c=new Array(r);for(f=0;f<i.length;f++)c[f]=i[f];for(o=0;o<e.length;o++){s=e[o];for(f=0;f<s.length;f++)c[l+f]=s[f];l+=f}return c};r.maxRowLength=function(e){return u(e,Math.max,0)};r.minRowLength=function(e){return u(e,Math.min,Infinity)};function u(e,t,r){if(s(e)){if(s(e[0])){var n=r;for(var a=0;a<e.length;a++){n=t(n,e[a].length)}return n}else{return e.length}}return 0}},{}],761:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../constants/numerical").BADNUM;var i=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;t.exports=function e(t){if(typeof t==="string"){t=t.replace(i,"")}if(n(t))return Number(t);return a}},{"../constants/numerical":753,"fast-isnumeric":241}],762:[function(e,t,r){"use strict";t.exports=function e(t){var r=t._fullLayout;if(r._glcanvas&&r._glcanvas.size()){r._glcanvas.each(function(e){if(e.regl)e.regl.clear({color:true,depth:true})})}}},{}],763:[function(e,t,r){"use strict";t.exports=function e(t){if(t._responsiveChartHandler){window.removeEventListener("resize",t._responsiveChartHandler);delete t._responsiveChartHandler}}},{}],764:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("tinycolor2");var i=e("../plots/attributes");var o=e("../components/colorscale/scales");var s=e("../constants/interactions").DESELECTDIM;var l=e("./nested_property");var u=e("./regex").counter;var c=e("./mod").modHalf;var f=e("./array").isArrayOrTypedArray;r.valObjectMeta={data_array:{coerceFunction:function(e,t,r){if(f(e))t.set(e);else if(r!==undefined)t.set(r)}},enumerated:{coerceFunction:function(e,t,r,n){if(n.coerceNumber)e=+e;if(n.values.indexOf(e)===-1)t.set(r);else t.set(e)},validateFunction:function(e,t){if(t.coerceNumber)e=+e;var r=t.values;for(var n=0;n<r.length;n++){var a=String(r[n]);if(a.charAt(0)==="/"&&a.charAt(a.length-1)==="/"){var i=new RegExp(a.substr(1,a.length-2));if(i.test(e))return true}else if(e===r[n])return true}return false}},boolean:{coerceFunction:function(e,t,r){if(e===true||e===false)t.set(e);else t.set(r)}},number:{coerceFunction:function(e,t,r,a){if(!n(e)||a.min!==undefined&&e<a.min||a.max!==undefined&&e>a.max){t.set(r)}else t.set(+e)}},integer:{coerceFunction:function(e,t,r,a){if(e%1||!n(e)||a.min!==undefined&&e<a.min||a.max!==undefined&&e>a.max){t.set(r)}else t.set(+e)}},string:{coerceFunction:function(e,t,r,n){if(typeof e!=="string"){var a=typeof e==="number";if(n.strict===true||!a)t.set(r);else t.set(String(e))}else if(n.noBlank&&!e)t.set(r);else t.set(e)}},color:{coerceFunction:function(e,t,r){if(a(e).isValid())t.set(e);else t.set(r)}},colorlist:{coerceFunction:function(e,t,r){function n(e){return a(e).isValid()}if(!Array.isArray(e)||!e.length)t.set(r);else if(e.every(n))t.set(e);else t.set(r)}},colorscale:{coerceFunction:function(e,t,r){t.set(o.get(e,r))}},angle:{coerceFunction:function(e,t,r){if(e==="auto")t.set("auto");else if(!n(e))t.set(r);else t.set(c(+e,360))}},subplotid:{coerceFunction:function(e,t,r,n){var a=n.regex||u(r);if(typeof e==="string"&&a.test(e)){t.set(e);return}t.set(r)},validateFunction:function(e,t){var r=t.dflt;if(e===r)return true;if(typeof e!=="string")return false;if(u(r).test(e))return true;return false}},flaglist:{coerceFunction:function(e,t,r,n){if(typeof e!=="string"){t.set(r);return}if((n.extras||[]).indexOf(e)!==-1){t.set(e);return}var a=e.split("+");var i=0;while(i<a.length){var o=a[i];if(n.flags.indexOf(o)===-1||a.indexOf(o)<i){a.splice(i,1)}else i++}if(!a.length)t.set(r);else t.set(a.join("+"))}},any:{coerceFunction:function(e,t,r){if(e===undefined)t.set(r);else t.set(e)}},info_array:{coerceFunction:function(e,t,n,a){function i(e,t,n){var a;var i={set:function(e){a=e}};if(n===undefined)n=t.dflt;r.valObjectMeta[t.valType].coerceFunction(e,i,n,t);return a}var o=a.dimensions===2||a.dimensions==="1-2"&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e)){t.set(n);return}var s=a.items;var l=[];var u=Array.isArray(s);var c=u&&o&&Array.isArray(s[0]);var f=o&&u&&!c;var h=u&&!f?s.length:e.length;var p,d,v,m,g,y;n=Array.isArray(n)?n:[];if(o){for(p=0;p<h;p++){l[p]=[];v=Array.isArray(e[p])?e[p]:[];if(f)g=s.length;else if(u)g=s[p].length;else g=v.length;for(d=0;d<g;d++){if(f)m=s[d];else if(u)m=s[p][d];else m=s;y=i(v[d],m,(n[p]||[])[d]);if(y!==undefined)l[p][d]=y}}}else{for(p=0;p<h;p++){y=i(e[p],u?s[p]:s,n[p]);if(y!==undefined)l[p]=y}}t.set(l)},validateFunction:function(e,t){if(!Array.isArray(e))return false;var r=t.items;var n=Array.isArray(r);var a=t.dimensions===2;if(!t.freeLength&&e.length!==r.length)return false;for(var i=0;i<e.length;i++){if(a){if(!Array.isArray(e[i])||!t.freeLength&&e[i].length!==r[i].length){return false}for(var o=0;o<e[i].length;o++){if(!h(e[i][o],n?r[i][o]:r)){return false}}}else if(!h(e[i],n?r[i]:r))return false}return true}}};r.coerce=function(e,t,n,a,i){var o=l(n,a).get();var s=l(e,a);var u=l(t,a);var c=s.get();var p=t._template;if(c===undefined&&p){c=l(p,a).get();p=0}if(i===undefined)i=o.dflt;if(o.arrayOk&&f(c)){u.set(c);return c}var d=r.valObjectMeta[o.valType].coerceFunction;d(c,u,i,o);var v=u.get();if(p&&v===i&&!h(c,o)){c=l(p,a).get();d(c,u,i,o);v=u.get()}return v};r.coerce2=function(e,t,n,a,i){var o=l(e,a);var s=r.coerce(e,t,n,a,i);var u=o.get();return u!==undefined&&u!==null?s:false};r.coerceFont=function(e,t,r){var n={};r=r||{};n.family=e(t+".family",r.family);n.size=e(t+".size",r.size);n.color=e(t+".color",r.color);return n};r.coerceHoverinfo=function(e,t,n){var a=t._module.attributes;var o=a.hoverinfo?a:i;var s=o.hoverinfo;var l;if(n._dataLength===1){var u=s.dflt==="all"?s.flags.slice():s.dflt.split("+");u.splice(u.indexOf("name"),1);l=u.join("+")}return r.coerce(e,t,o,"hoverinfo",l)};r.coerceSelectionMarkerOpacity=function(e,t){if(!e.marker)return;var r=e.marker.opacity;if(r===undefined)return;var n;var a;if(!f(r)&&!e.selected&&!e.unselected){n=r;a=s*r}t("selected.marker.opacity",n);t("unselected.marker.opacity",a)};function h(e,t){var n=r.valObjectMeta[t.valType];if(t.arrayOk&&f(e))return true;if(n.validateFunction){return n.validateFunction(e,t)}var a={};var i=a;var o={set:function(e){i=e}};n.coerceFunction(e,o,a,t);return i!==a}r.validate=h},{"../components/colorscale/scales":658,"../constants/interactions":752,"../plots/attributes":824,"./array":760,"./mod":785,"./nested_property":786,"./regex":795,"fast-isnumeric":241,tinycolor2:576}],765:[function(e,t,r){"use strict";var n=e("d3-time-format").timeFormat;var a=e("fast-isnumeric");var i=e("./loggers");var o=e("./mod").mod;var s=e("../constants/numerical");var l=s.BADNUM;var u=s.ONEDAY;var c=s.ONEHOUR;var f=s.ONEMIN;var h=s.ONESEC;var p=s.EPOCHJD;var d=e("../registry");var v=e("d3-time-format").utcFormat;var m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m;var g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m;var y=(new Date).getFullYear()-70;function x(e){return e&&d.componentsRegistry.calendars&&typeof e==="string"&&e!=="gregorian"}r.dateTick0=function(e,t){var n=_(e,!!t);if(t<2)return n;var a=r.dateTime2ms(n,e);a+=u*(t-1);return r.ms2DateTime(a,0,e)};function _(e,t){if(x(e)){return t?d.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:d.getComponentMethod("calendars","CANONICAL_TICK")[e]}else{return t?"2000-01-02":"2000-01-01"}}r.dfltRange=function(e){if(x(e)){return d.getComponentMethod("calendars","DFLTRANGE")[e]}else{return["2000-01-01","2001-01-01"]}};r.isJSDate=function(e){return typeof e==="object"&&e!==null&&typeof e.getTime==="function"};var b,w;r.dateTime2ms=function(e,t){if(r.isJSDate(e)){var n=e.getTimezoneOffset()*f;var a=(e.getUTCMinutes()-e.getMinutes())*f+(e.getUTCSeconds()-e.getSeconds())*h+(e.getUTCMilliseconds()-e.getMilliseconds());if(a){var i=3*f;n=n-i/2+o(a-n+i/2,i)}e=Number(e)-n;if(e>=b&&e<=w)return e;return l}if(typeof e!=="string"&&typeof e!=="number")return l;e=String(e);var s=x(t);var v=e.charAt(0);if(s&&(v==="G"||v==="g")){e=e.substr(1);t=""}var _=s&&t.substr(0,7)==="chinese";var T=e.match(_?g:m);if(!T)return l;var k=T[1];var A=T[3]||"1";var M=Number(T[5]||1);var E=Number(T[7]||0);var S=Number(T[9]||0);var C=Number(T[11]||0);if(s){if(k.length===2)return l;k=Number(k);var L;try{var I=d.getComponentMethod("calendars","getCal")(t);if(_){var O=A.charAt(A.length-1)==="i";A=parseInt(A,10);L=I.newDate(k,I.toMonthIndex(k,A,O),M)}else{L=I.newDate(k,Number(A),M)}}catch(e){return l}if(!L)return l;return(L.toJD()-p)*u+E*c+S*f+C*h}if(k.length===2){k=(Number(k)+2e3-y)%100+y}else k=Number(k);A-=1;var P=new Date(Date.UTC(2e3,A,M,E,S));P.setUTCFullYear(k);if(P.getUTCMonth()!==A)return l;if(P.getUTCDate()!==M)return l;return P.getTime()+C*h};b=r.MIN_MS=r.dateTime2ms("-9999");w=r.MAX_MS=r.dateTime2ms("9999-12-31 23:59:59.9999");r.isDateTime=function(e,t){return r.dateTime2ms(e,t)!==l};function T(e,t){return String(e+Math.pow(10,t)).substr(1)}var k=90*u;var A=3*c;var M=5*f;r.ms2DateTime=function(e,t,r){if(typeof e!=="number"||!(e>=b&&e<=w))return l;if(!t)t=0;var n=Math.floor(o(e+.05,1)*10);var a=Math.round(e-n/10);var i,s,m,g,y,_;if(x(r)){var T=Math.floor(a/u)+p;var S=Math.floor(o(e,u));try{i=d.getComponentMethod("calendars","getCal")(r).fromJD(T).formatDate("yyyy-mm-dd")}catch(e){i=v("G%Y-%m-%d")(new Date(a))}if(i.charAt(0)==="-"){while(i.length<11)i="-0"+i.substr(1)}else{while(i.length<10)i="0"+i}s=t<k?Math.floor(S/c):0;m=t<k?Math.floor(S%c/f):0;g=t<A?Math.floor(S%f/h):0;y=t<M?S%h*10+n:0}else{_=new Date(a);i=v("%Y-%m-%d")(_);s=t<k?_.getUTCHours():0;m=t<k?_.getUTCMinutes():0;g=t<A?_.getUTCSeconds():0;y=t<M?_.getUTCMilliseconds()*10+n:0}return E(i,s,m,g,y)};r.ms2DateTimeLocal=function(e){if(!(e>=b+u&&e<=w-u))return l;var t=Math.floor(o(e+.05,1)*10);var r=new Date(Math.round(e-t/10));var a=n("%Y-%m-%d")(r);var i=r.getHours();var s=r.getMinutes();var c=r.getSeconds();var f=r.getUTCMilliseconds()*10+t;return E(a,i,s,c,f)};function E(e,t,r,n,a){if(t||r||n||a){e+=" "+T(t,2)+":"+T(r,2);if(n||a){e+=":"+T(n,2);if(a){var i=4;while(a%10===0){i-=1;a/=10}e+="."+T(a,i)}}}return e}r.cleanDate=function(e,t,n){if(e===l)return t;if(r.isJSDate(e)||typeof e==="number"&&isFinite(e)){if(x(n)){i.error("JS Dates and milliseconds are incompatible with world calendars",e);return t}e=r.ms2DateTimeLocal(+e);if(!e&&t!==undefined)return t}else if(!r.isDateTime(e,n)){i.error("unrecognized date",e);return t}return e};var S=/%\d?f/g;function C(e,t,r,n){e=e.replace(S,function(e){var r=Math.min(+e.charAt(1)||6,6);var n=(t/1e3%1+2).toFixed(r).substr(2).replace(/0+$/,"")||"0";return n});var a=new Date(Math.floor(t+.05));if(x(n)){try{e=d.getComponentMethod("calendars","worldCalFmt")(e,t,n)}catch(e){return"Invalid"}}return r(e)(a)}var L=[59,59.9,59.99,59.999,59.9999];function I(e,t){var r=o(e+.05,u);var n=T(Math.floor(r/c),2)+":"+T(o(Math.floor(r/f),60),2);if(t!=="M"){if(!a(t))t=0;var i=Math.min(o(e/h,60),L[t]);var s=(100+i).toFixed(t).substr(1);if(t>0){s=s.replace(/0+$/,"").replace(/[\.]$/,"")}n+=":"+s}return n}r.formatDate=function(e,t,r,n,a,i){a=x(a)&&a;if(!t){if(r==="y")t=i.year;else if(r==="m")t=i.month;else if(r==="d"){t=i.dayMonth+"\n"+i.year}else{return I(e,r)+"\n"+C(i.dayMonthYear,e,n,a)}}return C(t,e,n,a)};var O=3*u;r.incrementMonth=function(e,t,r){r=x(r)&&r;var n=o(e,u);e=Math.round(e-n);if(r){try{var a=Math.round(e/u)+p;var s=d.getComponentMethod("calendars","getCal")(r);var l=s.fromJD(a);if(t%12)s.add(l,t,"m");else s.add(l,t/12,"y");return(l.toJD()-p)*u+n}catch(t){i.error("invalid ms "+e+" in calendar "+r)}}var c=new Date(e+O);return c.setUTCMonth(c.getUTCMonth()+t)+n-O};r.findExactDates=function(e,t){var r=0;var n=0;var i=0;var o=0;var s;var l;var c=x(t)&&d.getComponentMethod("calendars","getCal")(t);for(var f=0;f<e.length;f++){l=e[f];if(!a(l)){o++;continue}if(l%u)continue;if(c){try{s=c.fromJD(l/u+p);if(s.day()===1){if(s.month()===1)r++;else n++}else i++}catch(e){}}else{s=new Date(l);if(s.getUTCDate()===1){if(s.getUTCMonth()===0)r++;else n++}else i++}}n+=r;i+=n;var h=e.length-o;return{exactYears:r/h,exactMonths:n/h,exactDays:i/h}}},{"../constants/numerical":753,"../registry":911,"./loggers":782,"./mod":785,"d3-time-format":166,"fast-isnumeric":241}],766:[function(e,t,r){"use strict";var n=e("d3");var a=e("./loggers");var i=e("./matrix");var o=e("gl-mat4");function s(e){var t;if(typeof e==="string"){t=document.getElementById(e);if(t===null){throw new Error("No DOM element with id '"+e+"' exists on the page.")}return t}else if(e===null||e===undefined){throw new Error("DOM element provided is null or undefined")}return e}function l(e){var t=n.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")}function u(e){var t=e&&e.parentNode;if(t)t.removeChild(e)}function c(e,t){f("global",e,t)}function f(e,t,r){var n="plotly.js-style-"+e;var i=document.getElementById(n);if(!i){i=document.createElement("style");i.setAttribute("id",n);i.appendChild(document.createTextNode(""));document.head.appendChild(i)}var o=i.sheet;if(o.insertRule){o.insertRule(t+"{"+r+"}",0)}else if(o.addRule){o.addRule(t,r,0)}else a.warn("addStyleRule failed")}function h(e){var t="plotly.js-style-"+e;var r=document.getElementById(t);if(r)u(r)}function p(e){var t=v(e);var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.forEach(function(e){var t=d(e);if(t){var n=i.convertCssMatrix(t);r=o.multiply(r,r,n)}});return r}function d(e){var t=window.getComputedStyle(e,null);var r=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");if(r==="none")return null;return r.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(e){return+e})}function v(e){var t=[];while(m(e)){t.push(e);e=e.parentNode}return t}function m(e){return e&&(e instanceof Element||e instanceof HTMLElement)}function g(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.top===t.top&&e.left===t.left&&e.right===t.right&&e.bottom===t.bottom}t.exports={getGraphDiv:s,isPlotDiv:l,removeElement:u,addStyleRule:c,addRelatedStyleRule:f,deleteRelatedStyleRule:h,getFullTransformMatrix:p,getElementTransformMatrix:d,getElementAndAncestors:v,equalDomRects:g}},{"./loggers":782,"./matrix":784,d3:169,"gl-mat4":292}],767:[function(e,t,r){"use strict";var n=e("events").EventEmitter;var a={init:function(e){if(e._ev instanceof n)return e;var t=new n;var r=new n;e._ev=t;e._internalEv=r;e.on=t.on.bind(t);e.once=t.once.bind(t);e.removeListener=t.removeListener.bind(t);e.removeAllListeners=t.removeAllListeners.bind(t);e._internalOn=r.on.bind(r);e._internalOnce=r.once.bind(r);e._removeInternalListener=r.removeListener.bind(r);e._removeAllInternalListeners=r.removeAllListeners.bind(r);e.emit=function(n,a){if(typeof jQuery!=="undefined"){jQuery(e).trigger(n,a)}t.emit(n,a);r.emit(n,a)};return e},triggerHandler:function(e,t,r){var n;var a;if(typeof jQuery!=="undefined"){n=jQuery(e).triggerHandler(t,r)}var i=e._ev;if(!i)return n;var o=i._events[t];if(!o)return n;function s(e){if(e.listener){i.removeListener(t,e.listener);if(!e.fired){e.fired=true;return e.listener.apply(i,[r])}}else{return e.apply(i,[r])}}o=Array.isArray(o)?o:[o];var l;for(l=0;l<o.length-1;l++){s(o[l])}a=s(o[l]);return n!==undefined?n:a},purge:function(e){delete e._ev;delete e.on;delete e.once;delete e.removeListener;delete e.removeAllListeners;delete e.emit;delete e._ev;delete e._internalEv;delete e._internalOn;delete e._internalOnce;delete e._removeInternalListener;delete e._removeAllInternalListeners;return e}};t.exports=a},{events:110}],768:[function(e,t,r){"use strict";var n=e("./is_plain_object.js");var a=Array.isArray;function i(e,t){var r,n;for(r=0;r<e.length;r++){n=e[r];if(n!==null&&typeof n==="object"){return false}if(n!==void 0){t[r]=n}}return true}r.extendFlat=function(){return o(arguments,false,false,false)};r.extendDeep=function(){return o(arguments,true,false,false)};r.extendDeepAll=function(){return o(arguments,true,true,false)};r.extendDeepNoArrays=function(){return o(arguments,true,false,true)};function o(e,t,r,s){var l=e[0];var u=e.length;var c,f,h,p,d,v,m;if(u===2&&a(l)&&a(e[1])&&l.length===0){m=i(e[1],l);if(m){return l}else{l.splice(0,l.length)}}for(var g=1;g<u;g++){c=e[g];for(f in c){h=l[f];p=c[f];if(s&&a(p)){l[f]=p}else if(t&&p&&(n(p)||(d=a(p)))){if(d){d=false;v=h&&a(h)?h:[]}else{v=h&&n(h)?h:{}}l[f]=o([v,p],t,r,s)}else if(typeof p!=="undefined"||r){l[f]=p}}}return l}},{"./is_plain_object.js":779}],769:[function(e,t,r){"use strict";t.exports=function e(t){var r={};var n=[];var a=0;for(var i=0;i<t.length;i++){var o=t[i];if(r[o]!==1){r[o]=1;n[a++]=o}}return n}},{}],770:[function(e,t,r){"use strict";t.exports=function e(t){var r=i(t)?a:n;var o=[];for(var s=0;s<t.length;s++){var l=t[s];if(r(l))o.push(l)}return o};function n(e){return e.visible===true}function a(e){var t=e[0].trace;return t.visible===true&&t._length!==0}function i(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}},{}],771:[function(e,t,r){"use strict";var n=e("d3");var a=e("country-regex");var i=e("@turf/area");var o=e("@turf/centroid");var s=e("@turf/bbox");var l=e("./identity");var u=e("./loggers");var c=e("./is_plain_object");var f=e("./nested_property");var h=e("./polygon");var p=Object.keys(a);var d={"ISO-3":l,"USA-states":l,"country names":v};function v(e){for(var t=0;t<p.length;t++){var r=p[t];var n=new RegExp(a[r]);if(n.test(e.trim().toLowerCase()))return r}u.log("Unrecognized country name: "+e+".");return false}function m(e,t,r){if(!t||typeof t!=="string")return false;var n=d[e](t);var a;var i,o;if(n){if(e==="USA-states"){a=[];for(o=0;o<r.length;o++){i=r[o];if(i.properties&&i.properties.gu&&i.properties.gu==="USA"){a.push(i)}}}else{a=r}for(o=0;o<a.length;o++){i=a[o];if(i.id===n)return i}u.log(["Location with id",n,"does not have a matching topojson feature at this resolution."].join(" "))}return false}function g(e){var t=e.geometry;var r=t.coordinates;var n=e.id;var a=[];var i,o,s,l;function u(e){for(var t=0;t<e.length-1;t++){if(e[t][0]>0&&e[t+1][0]<0)return t}return null}if(n==="RUS"||n==="FJI"){i=function(e){var t;if(u(e)===null){t=e}else{t=new Array(e.length);for(l=0;l<e.length;l++){t[l]=[e[l][0]<0?e[l][0]+360:e[l][0],e[l][1]]}}a.push(h.tester(t))}}else if(n==="ATA"){i=function(e){var t=u(e);if(t===null){return a.push(h.tester(e))}var r=new Array(e.length+1);var n=0;for(l=0;l<e.length;l++){if(l>t){r[n++]=[e[l][0]+360,e[l][1]]}else if(l===t){r[n++]=e[l];r[n++]=[e[l][0],-90]}else{r[n++]=e[l]}}var i=h.tester(r);i.pts.pop();a.push(i)}}else{i=function(e){a.push(h.tester(e))}}switch(t.type){case"MultiPolygon":for(o=0;o<r.length;o++){for(s=0;s<r[o].length;s++){i(r[o][s])}}break;case"Polygon":for(o=0;o<r.length;o++){i(r[o])}break}return a}function y(e){var t=e.geojson;var r=window.PlotlyGeoAssets||{};var n=typeof t==="string"?r[t]:t;if(!c(n)){u.error("Oops ... something went wrong when fetching "+t);return false}return n}function x(e){var t=e[0].trace;var r=y(t);if(!r)return false;var n={};var a=[];var i;for(i=0;i<t._length;i++){var o=e[i];if(o.loc||o.loc===0){n[o.loc]=o}}function s(e){var r=f(e,t.featureidkey||"id").get();var i=n[r];if(i){var o=e.geometry;if(o.type==="Polygon"||o.type==="MultiPolygon"){var s={type:"Feature",id:r,geometry:o,properties:{}};s.properties.ct=_(s);i.fIn=e;i.fOut=s;a.push(s)}else{u.log(["Location",i.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}}delete n[r]}switch(r.type){case"FeatureCollection":var l=r.features;for(i=0;i<l.length;i++){s(l[i])}break;case"Feature":s(r);break;default:u.warn(["Invalid GeoJSON type",(r.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" "));return false}for(var c in n){u.log(["Location *"+c+"*","does not have a matching feature with id-key","*"+t.featureidkey+"*."].join(" "))}return a}function _(e){var t=e.geometry;var r;if(t.type==="MultiPolygon"){var n=t.coordinates;var a=0;for(var s=0;s<n.length;s++){var l={type:"Polygon",coordinates:n[s]};var u=i.default(l);if(u>a){a=u;r=l}}}else{r=t}return o.default(r).geometry.coordinates}function b(e){var t=window.PlotlyGeoAssets||{};var r=[];function a(e){return new Promise(function(r,a){n.json(e,function(n,i){if(n){delete t[e];var o=n.status===404?'GeoJSON at URL "'+e+'" does not exist.':"Unexpected error while fetching from "+e;return a(new Error(o))}t[e]=i;return r(i)})})}function i(e){return new Promise(function(r,n){var a=0;var i=setInterval(function(){if(t[e]&&t[e]!=="pending"){clearInterval(i);return r(t[e])}if(a>100){clearInterval(i);return n("Unexpected error while fetching from "+e)}a++},50)})}for(var o=0;o<e.length;o++){var s=e[o][0].trace;var l=s.geojson;if(typeof l==="string"){if(!t[l]){t[l]="pending";r.push(a(l))}else if(t[l]==="pending"){r.push(i(l))}}}return r}function w(e){return s.default(e)}t.exports={locationToFeature:m,feature2polygons:g,getTraceGeojson:y,extractTraceFeature:x,fetchTraceGeoData:b,computeBbox:w}},{"./identity":776,"./is_plain_object":779,"./loggers":782,"./nested_property":786,"./polygon":790,"@turf/area":59,"@turf/bbox":60,"@turf/centroid":61,"country-regex":139,d3:169}],772:[function(e,t,r){"use strict";var n=e("../constants/numerical").BADNUM;r.calcTraceToLineCoords=function(e){var t=e[0].trace;var r=t.connectgaps;var a=[];var i=[];for(var o=0;o<e.length;o++){var s=e[o];var l=s.lonlat;if(l[0]!==n){i.push(l)}else if(!r&&i.length>0){a.push(i);i=[]}}if(i.length>0){a.push(i)}return a};r.makeLine=function(e){if(e.length===1){return{type:"LineString",coordinates:e[0]}}else{return{type:"MultiLineString",coordinates:e}}};r.makePolygon=function(e){if(e.length===1){return{type:"Polygon",coordinates:e}}else{var t=new Array(e.length);for(var r=0;r<e.length;r++){t[r]=[e[r]]}return{type:"MultiPolygon",coordinates:t}}};r.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":753}],773:[function(e,t,r){"use strict";var n=e("./mod").mod;r.segmentsIntersect=a;function a(e,t,r,n,a,i,o,s){var l=r-e;var u=a-e;var c=o-a;var f=n-t;var h=i-t;var p=s-i;var d=l*p-c*f;if(d===0)return null;var v=(u*p-c*h)/d;var m=(u*f-l*h)/d;if(m<0||m>1||v<0||v>1)return null;return{x:e+l*v,y:t+f*v}}r.segmentDistance=function e(t,r,n,o,s,l,u,c){if(a(t,r,n,o,s,l,u,c))return 0;var f=n-t;var h=o-r;var p=u-s;var d=c-l;var v=f*f+h*h;var m=p*p+d*d;var g=Math.min(i(f,h,v,s-t,l-r),i(f,h,v,u-t,c-r),i(p,d,m,t-s,r-l),i(p,d,m,n-s,o-l));return Math.sqrt(g)};function i(e,t,r,n,a){var i=n*e+a*t;if(i<0){return n*n+a*a}else if(i>r){var o=n-e;var s=a-t;return o*o+s*s}else{var l=n*t-a*e;return l*l/r}}var o,s,l;r.getTextLocation=function e(t,r,a,i){if(t!==s||i!==l){o={};s=t;l=i}if(o[a]){return o[a]}var u=t.getPointAtLength(n(a-i/2,r));var c=t.getPointAtLength(n(a+i/2,r));var f=Math.atan((c.y-u.y)/(c.x-u.x));var h=t.getPointAtLength(n(a,r));var p=(h.x*4+u.x+c.x)/6;var d=(h.y*4+u.y+c.y)/6;var v={x:p,y:d,theta:f};o[a]=v;return v};r.clearLocationCache=function(){s=null};r.getVisibleSegment=function e(t,r,n){var a=r.left;var i=r.right;var o=r.top;var s=r.bottom;var l=0;var u=t.getTotalLength();var c=u;var f,h;function p(e){var r=t.getPointAtLength(e);if(e===0)f=r;else if(e===u)h=r;var n=r.x<a?a-r.x:r.x>i?r.x-i:0;var l=r.y<o?o-r.y:r.y>s?r.y-s:0;return Math.sqrt(n*n+l*l)}var d=p(l);while(d){l+=d+n;if(l>c)return;d=p(l)}d=p(c);while(d){c-=d+n;if(l>c)return;d=p(c)}return{min:l,max:c,len:c-l,total:u,isClosed:l===0&&c===u&&Math.abs(f.x-h.x)<.1&&Math.abs(f.y-h.y)<.1}};r.findPointOnPath=function e(t,r,n,a){a=a||{};var i=a.pathLength||t.getTotalLength();var o=a.tolerance||.001;var s=a.iterationLimit||30;var l=t.getPointAtLength(0)[n]>t.getPointAtLength(i)[n]?-1:1;var u=0;var c=0;var f=i;var h;var p;var d;while(u<s){h=(c+f)/2;p=t.getPointAtLength(h);d=p[n]-r;if(Math.abs(d)<o){return p}else{if(l*d>0){f=h}else{c=h}u++}}return p}},{"./mod":785}],774:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("tinycolor2");var i=e("color-normalize");var o=e("../components/colorscale");var s=e("../components/color/attributes").defaultLine;var l=e("./array").isArrayOrTypedArray;var u=i(s);var c=1;function f(e,t){var r=e;r[3]*=t;return r}function h(e){if(n(e))return u;var t=i(e);return t.length?t:u}function p(e){return n(e)?e:c}function d(e,t,r){var n=e.color;var a=l(n);var s=l(t);var d=o.extractOpts(e);var v=[];var m,g,y,x,_;if(d.colorscale!==undefined){m=o.makeColorScaleFuncFromTrace(e)}else{m=h}if(a){g=function(e,t){return e[t]===undefined?u:i(m(e[t]))}}else g=h;if(s){y=function(e,t){return e[t]===undefined?c:p(e[t])}}else y=p;if(a||s){for(var b=0;b<r;b++){x=g(n,b);_=y(t,b);v[b]=f(x,_)}}else v=f(i(n),t);return v}function v(e){var t=o.extractOpts(e);var r=t.colorscale;if(t.reversescale)r=o.flipScale(t.colorscale);return r.map(function(e){var t=e[0];var r=a(e[1]);var n=r.toRgb();return{index:t,rgb:[n.r,n.g,n.b,n.a]}})}t.exports={formatColor:d,parseColorScale:v}},{"../components/color/attributes":642,"../components/colorscale":655,"./array":760,"color-normalize":125,"fast-isnumeric":241,tinycolor2:576}],775:[function(e,t,r){"use strict";var n=e("./identity");function a(e){return[e]}t.exports={keyFun:function(e){return e.key},repeat:a,descend:n,wrap:a,unwrap:function(e){return e[0]}}},{"./identity":776}],776:[function(e,t,r){"use strict";t.exports=function e(t){return t}},{}],777:[function(e,t,r){"use strict";t.exports=function e(t,r){if(!r)return t;var n=1/Math.abs(r);var a=n>1?(n*t+n*r)/n:t+r;var i=String(a).length;if(i>16){var o=String(r).length;var s=String(t).length;if(i>=s+o){var l=parseFloat(a).toPrecision(12);if(l.indexOf("e+")===-1)a=+l}}return a}},{}],778:[function(e,t,r){"use strict";var n=e("d3");var a=e("d3-time-format").utcFormat;var i=e("fast-isnumeric");var o=e("../constants/numerical");var s=o.FP_SAFE;var l=o.BADNUM;var u=t.exports={};u.nestedProperty=e("./nested_property");u.keyedContainer=e("./keyed_container");u.relativeAttr=e("./relative_attr");u.isPlainObject=e("./is_plain_object");u.toLogRange=e("./to_log_range");u.relinkPrivateKeys=e("./relink_private");var c=e("./array");u.isTypedArray=c.isTypedArray;u.isArrayOrTypedArray=c.isArrayOrTypedArray;u.isArray1D=c.isArray1D;u.ensureArray=c.ensureArray;u.concat=c.concat;u.maxRowLength=c.maxRowLength;u.minRowLength=c.minRowLength;var f=e("./mod");u.mod=f.mod;u.modHalf=f.modHalf;var h=e("./coerce");u.valObjectMeta=h.valObjectMeta;u.coerce=h.coerce;u.coerce2=h.coerce2;u.coerceFont=h.coerceFont;u.coerceHoverinfo=h.coerceHoverinfo;u.coerceSelectionMarkerOpacity=h.coerceSelectionMarkerOpacity;u.validate=h.validate;var p=e("./dates");u.dateTime2ms=p.dateTime2ms;u.isDateTime=p.isDateTime;u.ms2DateTime=p.ms2DateTime;u.ms2DateTimeLocal=p.ms2DateTimeLocal;u.cleanDate=p.cleanDate;u.isJSDate=p.isJSDate;u.formatDate=p.formatDate;u.incrementMonth=p.incrementMonth;u.dateTick0=p.dateTick0;u.dfltRange=p.dfltRange;u.findExactDates=p.findExactDates;u.MIN_MS=p.MIN_MS;u.MAX_MS=p.MAX_MS;var d=e("./search");u.findBin=d.findBin;u.sorterAsc=d.sorterAsc;u.sorterDes=d.sorterDes;u.distinctVals=d.distinctVals;u.roundUp=d.roundUp;u.sort=d.sort;u.findIndexOfMin=d.findIndexOfMin;var v=e("./stats");u.aggNums=v.aggNums;u.len=v.len;u.mean=v.mean;u.median=v.median;u.midRange=v.midRange;u.variance=v.variance;u.stdev=v.stdev;u.interp=v.interp;var m=e("./matrix");u.init2dArray=m.init2dArray;u.transposeRagged=m.transposeRagged;u.dot=m.dot;u.translationMatrix=m.translationMatrix;u.rotationMatrix=m.rotationMatrix;u.rotationXYMatrix=m.rotationXYMatrix;u.apply3DTransform=m.apply3DTransform;u.apply2DTransform=m.apply2DTransform;u.apply2DTransform2=m.apply2DTransform2;u.convertCssMatrix=m.convertCssMatrix;u.inverseTransformMatrix=m.inverseTransformMatrix;var g=e("./angles");u.deg2rad=g.deg2rad;u.rad2deg=g.rad2deg;u.angleDelta=g.angleDelta;u.angleDist=g.angleDist;u.isFullCircle=g.isFullCircle;u.isAngleInsideSector=g.isAngleInsideSector;u.isPtInsideSector=g.isPtInsideSector;u.pathArc=g.pathArc;u.pathSector=g.pathSector;u.pathAnnulus=g.pathAnnulus;var y=e("./anchor_utils");u.isLeftAnchor=y.isLeftAnchor;u.isCenterAnchor=y.isCenterAnchor;u.isRightAnchor=y.isRightAnchor;u.isTopAnchor=y.isTopAnchor;u.isMiddleAnchor=y.isMiddleAnchor;u.isBottomAnchor=y.isBottomAnchor;var x=e("./geometry2d");u.segmentsIntersect=x.segmentsIntersect;u.segmentDistance=x.segmentDistance;u.getTextLocation=x.getTextLocation;u.clearLocationCache=x.clearLocationCache;u.getVisibleSegment=x.getVisibleSegment;u.findPointOnPath=x.findPointOnPath;var _=e("./extend");u.extendFlat=_.extendFlat;u.extendDeep=_.extendDeep;u.extendDeepAll=_.extendDeepAll;u.extendDeepNoArrays=_.extendDeepNoArrays;var b=e("./loggers");u.log=b.log;u.warn=b.warn;u.error=b.error;var w=e("./regex");u.counterRegex=w.counter;var T=e("./throttle");u.throttle=T.throttle;u.throttleDone=T.done;u.clearThrottle=T.clear;var k=e("./dom");u.getGraphDiv=k.getGraphDiv;u.isPlotDiv=k.isPlotDiv;u.removeElement=k.removeElement;u.addStyleRule=k.addStyleRule;u.addRelatedStyleRule=k.addRelatedStyleRule;u.deleteRelatedStyleRule=k.deleteRelatedStyleRule;u.getFullTransformMatrix=k.getFullTransformMatrix;u.getElementTransformMatrix=k.getElementTransformMatrix;u.getElementAndAncestors=k.getElementAndAncestors;u.equalDomRects=k.equalDomRects;u.clearResponsive=e("./clear_responsive");u.preserveDrawingBuffer=e("./preserve_drawing_buffer");u.makeTraceGroups=e("./make_trace_groups");u._=e("./localize");u.notifier=e("./notifier");u.filterUnique=e("./filter_unique");u.filterVisible=e("./filter_visible");u.pushUnique=e("./push_unique");u.increment=e("./increment");u.cleanNumber=e("./clean_number");u.ensureNumber=function e(t){if(!i(t))return l;t=Number(t);if(t<-s||t>s)return l;return i(t)?Number(t):l};u.isIndex=function(e,t){if(t!==undefined&&e>=t)return false;return i(e)&&e>=0&&e%1===0};u.noop=e("./noop");u.identity=e("./identity");u.repeat=function(e,t){var r=new Array(t);for(var n=0;n<t;n++){r[n]=e}return r};u.swapAttrs=function(e,t,r,n){if(!r)r="x";if(!n)n="y";for(var a=0;a<t.length;a++){var i=t[a];var o=u.nestedProperty(e,i.replace("?",r));var s=u.nestedProperty(e,i.replace("?",n));var l=o.get();o.set(s.get());s.set(l)}};u.raiseToTop=function e(t){t.parentNode.appendChild(t)};u.cancelTransition=function(e){return e.transition().duration(0)};u.constrain=function(e,t,r){if(t>r)return Math.max(r,Math.min(t,e));return Math.max(t,Math.min(r,e))};u.bBoxIntersect=function(e,t,r){r=r||0;return e.left<=t.right+r&&t.left<=e.right+r&&e.top<=t.bottom+r&&t.top<=e.bottom+r};u.simpleMap=function(e,t,r,n,a){var i=e.length;var o=new Array(i);for(var s=0;s<i;s++)o[s]=t(e[s],r,n,a);return o};u.randstr=function e(t,r,n,a){if(!n)n=16;if(r===undefined)r=24;if(r<=0)return"0";var i=Math.log(Math.pow(2,r))/Math.log(n);var o="";var s,l,c;for(s=2;i===Infinity;s*=2){i=Math.log(Math.pow(2,r/s))/Math.log(n)*s}var f=i-Math.floor(i);for(s=0;s<Math.floor(i);s++){c=Math.floor(Math.random()*n).toString(n);o=c+o}if(f){l=Math.pow(n,f);c=Math.floor(Math.random()*l).toString(n);o=c+o}var h=parseInt(o,n);if(t&&t[o]||h!==Infinity&&h>=Math.pow(2,r)){if(a>10){u.warn("randstr failed uniqueness");return o}return e(t,r,n,(a||0)+1)}else return o};u.OptionControl=function(e,t){if(!e)e={};if(!t)t="opt";var r={};r.optionList=[];r._newoption=function(n){n[t]=e;r[n.name]=n;r.optionList.push(n)};r["_"+t]=e;return r};u.smooth=function(e,t){t=Math.round(t)||0;if(t<2)return e;var r=e.length;var n=2*r;var a=2*t-1;var i=new Array(a);var o=new Array(r);var s;var l;var u;var c;for(s=0;s<a;s++){i[s]=(1-Math.cos(Math.PI*(s+1)/t))/(2*t)}for(s=0;s<r;s++){c=0;for(l=0;l<a;l++){u=s+l+1-t;if(u<-r)u-=n*Math.round(u/n);else if(u>=n)u-=n*Math.floor(u/n);if(u<0)u=-1-u;else if(u>=r)u=n-1-u;c+=e[u]*i[l]}o[s]=c}return o};u.syncOrAsync=function(e,t,r){var n,a;function i(){return u.syncOrAsync(e,t,r)}while(e.length){a=e.splice(0,1)[0];n=a(t);if(n&&n.then){return n.then(i).then(undefined,u.promiseError)}}return r&&r(t)};u.stripTrailingSlash=function(e){if(e.substr(-1)==="/")return e.substr(0,e.length-1);return e};u.noneOrAll=function(e,t,r){if(!e)return;var n=false;var a=true;var i;var o;for(i=0;i<r.length;i++){o=e[r[i]];if(o!==undefined&&o!==null)n=true;else a=false}if(n&&!a){for(i=0;i<r.length;i++){e[r[i]]=t[r[i]]}}};u.mergeArray=function(e,t,r,n){var a=typeof n==="function";if(u.isArrayOrTypedArray(e)){var i=Math.min(e.length,t.length);for(var o=0;o<i;o++){var s=e[o];t[o][r]=a?n(s):s}}};u.mergeArrayCastPositive=function(e,t,r){return u.mergeArray(e,t,r,function(e){var t=+e;return!isFinite(t)?0:t>0?t:0})};u.fillArray=function(e,t,r,n){n=n||u.identity;if(u.isArrayOrTypedArray(e)){for(var a=0;a<t.length;a++){t[a][r]=n(e[a])}}};u.castOption=function(e,t,r,n){n=n||u.identity;var a=u.nestedProperty(e,r).get();if(u.isArrayOrTypedArray(a)){if(Array.isArray(t)&&u.isArrayOrTypedArray(a[t[0]])){return n(a[t[0]][t[1]])}else{return n(a[t])}}else{return a}};u.extractOption=function(e,t,r,n){if(r in e)return e[r];var a=u.nestedProperty(t,n).get();if(!Array.isArray(a))return a};function A(e){var t={};for(var r in e){var n=e[r];for(var a=0;a<n.length;a++){t[n[a]]=+r}}return t}u.tagSelected=function(e,t,r){var n=t.selectedpoints;var a=t._indexToPoints;var i;if(a){i=A(a)}function o(t){return t!==undefined&&t<e.length}for(var s=0;s<n.length;s++){var l=n[s];if(u.isIndex(l)||u.isArrayOrTypedArray(l)&&u.isIndex(l[0])&&u.isIndex(l[1])){var c=i?i[l]:l;var f=r?r[c]:c;if(o(f)){e[f].selected=1}}}};u.selIndices2selPoints=function(e){var t=e.selectedpoints;var r=e._indexToPoints;if(r){var n=A(r);var a=[];for(var i=0;i<t.length;i++){var o=t[i];if(u.isIndex(o)){var s=n[o];if(u.isIndex(s)){a.push(s)}}}return a}else{return t}};u.getTargetArray=function(e,t){var r=t.target;if(typeof r==="string"&&r){var n=u.nestedProperty(e,r).get();return Array.isArray(n)?n:false}else if(Array.isArray(r)){return r}return false};u.minExtend=function(e,t){var r={};if(typeof t!=="object")t={};var n=3;var a=Object.keys(e);var i,o,s;for(i=0;i<a.length;i++){o=a[i];s=e[o];if(o.charAt(0)==="_"||typeof s==="function")continue;else if(o==="module")r[o]=s;else if(Array.isArray(s)){if(o==="colorscale"){r[o]=s.slice()}else{r[o]=s.slice(0,n)}}else if(u.isTypedArray(s)){r[o]=s.subarray(0,n)}else if(s&&typeof s==="object")r[o]=u.minExtend(e[o],t[o]);else r[o]=s}a=Object.keys(t);for(i=0;i<a.length;i++){o=a[i];s=t[o];if(typeof s!=="object"||!(o in r)||typeof r[o]!=="object"){r[o]=s}}return r};u.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};u.containsAny=function(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])!==-1)return true}return false};u.isIE=function(){return typeof window.navigator.msSaveBlob!=="undefined"};var M=/MSIE [1-9]\./;u.isIE9orBelow=function(){return u.isIE()&&M.test(window.navigator.userAgent)};var E=/Version\/[\d\.]+.*Safari/;u.isSafari=function(){return E.test(window.navigator.userAgent)};var S=/iPad|iPhone|iPod/;u.isIOS=function(){return S.test(window.navigator.userAgent)};u.isD3Selection=function(e){return e&&typeof e.classed==="function"};u.ensureSingle=function(e,t,r,n){var a=e.select(t+(r?"."+r:""));if(a.size())return a;var i=e.append(t);if(r)i.classed(r,true);if(n)i.call(n);return i};u.ensureSingleById=function(e,t,r,n){var a=e.select(t+"#"+r);if(a.size())return a;var i=e.append(t).attr("id",r);if(n)i.call(n);return i};u.objectFromPath=function(e,t){var r=e.split(".");var n;var a=n={};for(var i=0;i<r.length;i++){var o=r[i];var s=null;var l=r[i].match(/(.*)\[([0-9]+)\]/);if(l){o=l[1];s=l[2];n=n[o]=[];if(i===r.length-1){n[s]=t}else{n[s]={}}n=n[s]}else{if(i===r.length-1){n[o]=t}else{n[o]={}}n=n[o]}}return a};var C=/^([^\[\.]+)\.(.+)?/;var L=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;u.expandObjectPaths=function(e){var t,r,n,a,i,o,s;if(typeof e==="object"&&!Array.isArray(e)){for(r in e){if(e.hasOwnProperty(r)){if(t=r.match(C)){a=e[r];n=t[1];delete e[r];e[n]=u.extendDeepNoArrays(e[n]||{},u.objectFromPath(r,u.expandObjectPaths(a))[n])}else if(t=r.match(L)){a=e[r];n=t[1];i=parseInt(t[2]);delete e[r];e[n]=e[n]||[];if(t[3]==="."){s=t[4];o=e[n][i]=e[n][i]||{};u.extendDeepNoArrays(o,u.objectFromPath(s,u.expandObjectPaths(a)))}else{e[n][i]=u.expandObjectPaths(a)}}else{e[r]=u.expandObjectPaths(e[r])}}}}return e};u.numSeparate=function(e,t,r){if(!r)r=false;if(typeof t!=="string"||t.length===0){throw new Error("Separator string required for formatting!")}if(typeof e==="number"){e=String(e)}var n=/(\d+)(\d{3})/;var a=t.charAt(0);var i=t.charAt(1);var o=e.split(".");var s=o[0];var l=o.length>1?a+o[1]:"";if(i&&(o.length>1||s.length>4||r)){while(n.test(s)){s=s.replace(n,"$1"+i+"$2")}}return s+l};u.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var I=/^\w*$/;u.templateString=function(e,t){var r={};return e.replace(u.TEMPLATE_STRING_REGEX,function(e,n){var a;if(I.test(n)){a=t[n]}else{r[n]=r[n]||u.nestedProperty(t,n).get;a=r[n]()}return u.isValidTextValue(a)?a:""})};var O={max:10,count:0,name:"hovertemplate"};u.hovertemplateString=function(){return R.apply(O,arguments)};var P={max:10,count:0,name:"texttemplate"};u.texttemplateString=function(){return R.apply(P,arguments)};var D=/^[:|\|]/;function R(e,t,r){var i=this;var o=arguments;if(!t)t={};var s={};return e.replace(u.TEMPLATE_STRING_REGEX,function(e,l,c){var f,h,p;for(p=3;p<o.length;p++){f=o[p];if(!f)continue;if(f.hasOwnProperty(l)){h=f[l];break}if(!I.test(l)){h=s[l]||u.nestedProperty(f,l).get();if(h)s[l]=h}if(h!==undefined)break}if(h===undefined&&i){if(i.count<i.max){u.warn("Variable '"+l+"' in "+i.name+" could not be found!");h=e}if(i.count===i.max){u.warn("Too many "+i.name+" warnings - additional warnings will be suppressed")}i.count++;return e}if(c){var d;if(c[0]===":"){d=r?r.numberFormat:n.format;h=d(c.replace(D,""))(h)}if(c[0]==="|"){d=r?r.timeFormat:a;var v=u.dateTime2ms(h);h=u.formatDate(v,c.replace(D,""),false,d)}}else{if(t.hasOwnProperty(l+"Label"))h=t[l+"Label"]}return h})}var z=48;var N=57;u.subplotSort=function(e,t){var r=Math.min(e.length,t.length)+1;var n=0;var a=0;for(var i=0;i<r;i++){var o=e.charCodeAt(i)||0;var s=t.charCodeAt(i)||0;var l=o>=z&&o<=N;var u=s>=z&&s<=N;if(l)n=10*n+o-z;if(u)a=10*a+s-z;if(!l||!u){if(n!==a)return n-a;if(o!==s)return o-s}}return a-n};var F=2e9;u.seedPseudoRandom=function(){F=2e9};u.pseudoRandom=function(){var e=F;F=(69069*F+1)%4294967296;if(Math.abs(F-e)<429496729)return u.pseudoRandom();return F/4294967296};u.fillText=function(e,t,r){var n=Array.isArray(r)?function(e){r.push(e)}:function(e){r.text=e};var a=u.extractOption(e,t,"htx","hovertext");if(u.isValidTextValue(a))return n(a);var i=u.extractOption(e,t,"tx","text");if(u.isValidTextValue(i))return n(i)};u.isValidTextValue=function(e){return e||e===0};u.formatPercent=function(e,t){t=t||0;var r=(Math.round(100*e*Math.pow(10,t))*Math.pow(.1,t)).toFixed(t)+"%";for(var n=0;n<t;n++){if(r.indexOf(".")!==-1){r=r.replace("0%","%");r=r.replace(".%","%")}}return r};u.isHidden=function(e){var t=window.getComputedStyle(e).display;return!t||t==="none"};u.strTranslate=function(e,t){return e||t?"translate("+e+","+t+")":""};u.strRotate=function(e){return e?"rotate("+e+")":""};u.strScale=function(e){return e!==1?"scale("+e+")":""};u.getTextTransform=function(e){var t=e.noCenter;var r=e.textX;var n=e.textY;var a=e.targetX;var i=e.targetY;var o=e.anchorX||0;var s=e.anchorY||0;var l=e.rotate;var c=e.scale;if(!c)c=0;else if(c>1)c=1;return u.strTranslate(a-c*(r+o),i-c*(n+s))+u.strScale(c)+(l?"rotate("+l+(t?"":" "+r+" "+n)+")":"")};u.ensureUniformFontSize=function(e,t){var r=u.extendFlat({},t);r.size=Math.max(t.size,e._fullLayout.uniformtext.minsize||0);return r};u.join2=function(e,t,r){var n=e.length;if(n>1){return e.slice(0,-1).join(t)+r+e[n-1]}return e.join(t)}},{"../constants/numerical":753,"./anchor_utils":758,"./angles":759,"./array":760,"./clean_number":761,"./clear_responsive":763,"./coerce":764,"./dates":765,"./dom":766,"./extend":768,"./filter_unique":769,"./filter_visible":770,"./geometry2d":773,"./identity":776,"./increment":777,"./is_plain_object":779,"./keyed_container":780,"./localize":781,"./loggers":782,"./make_trace_groups":783,"./matrix":784,"./mod":785,"./nested_property":786,"./noop":787,"./notifier":788,"./preserve_drawing_buffer":792,"./push_unique":793,"./regex":795,"./relative_attr":796,"./relink_private":797,"./search":798,"./stats":801,"./throttle":804,"./to_log_range":805,d3:169,"d3-time-format":166,"fast-isnumeric":241}],779:[function(e,t,r){"use strict";t.exports=function e(t){if(window&&window.process&&window.process.versions){return Object.prototype.toString.call(t)==="[object Object]"}return Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t)===Object.prototype}},{}],780:[function(e,t,r){"use strict";var n=e("./nested_property");var a=/^\w*$/;var i=0;var o=1;var s=2;var l=3;var u=4;t.exports=function e(t,r,c,f){c=c||"name";f=f||"value";var h,p,d;var v={};if(r&&r.length){d=n(t,r);p=d.get()}else{p=t}r=r||"";var m={};if(p){for(h=0;h<p.length;h++){m[p[h][c]]=h}}var g=a.test(f);var y={set:function(e,t){var r=t===null?u:i;if(!p){if(!d||r===u)return;p=[];d.set(p)}var a=m[e];if(a===undefined){if(r===u)return;r=r|l;a=p.length;m[e]=a}else if(t!==(g?p[a][f]:n(p[a],f).get())){r=r|s}var o=p[a]=p[a]||{};o[c]=e;if(g){o[f]=t}else{n(o,f).set(t)}if(t!==null){r=r&~u}v[a]=v[a]|r;return y},get:function(e){if(!p)return;var t=m[e];if(t===undefined){return undefined}else if(g){return p[t][f]}else{return n(p[t],f).get()}},rename:function(e,t){var r=m[e];if(r===undefined)return y;v[r]=v[r]|o;m[t]=r;delete m[e];p[r][c]=t;return y},remove:function(e){var t=m[e];if(t===undefined)return y;var r=p[t];if(Object.keys(r).length>2){v[t]=v[t]|s;return y.set(e,null)}if(g){for(h=t;h<p.length;h++){v[h]=v[h]|l}for(h=t;h<p.length;h++){m[p[h][c]]--}p.splice(t,1);delete m[e]}else{n(r,f).set(null);v[t]=v[t]|s|u}return y},constructUpdate:function(){var e,t;var a={};var i=Object.keys(v);for(var l=0;l<i.length;l++){t=i[l];e=r+"["+t+"]";if(p[t]){if(v[t]&o){a[e+"."+c]=p[t][c]}if(v[t]&s){if(g){a[e+"."+f]=v[t]&u?null:p[t][f]}else{a[e+"."+f]=v[t]&u?null:n(p[t],f).get()}}}else{a[e]=null}}return a}};return y}},{"./nested_property":786}],781:[function(e,t,r){"use strict";var n=e("../registry");t.exports=function e(t,r){var a=t._context.locale;for(var i=0;i<2;i++){var o=t._context.locales;for(var s=0;s<2;s++){var l=(o[a]||{}).dictionary;if(l){var u=l[r];if(u)return u}o=n.localeRegistry}var c=a.split("-")[0];if(c===a)break;a=c}return r}},{"../registry":911}],782:[function(e,t,r){"use strict";var n=e("../plot_api/plot_config").dfltConfig;var a=e("./notifier");var i=t.exports={};i.log=function(){var e;if(n.logging>1){var t=["LOG:"];for(e=0;e<arguments.length;e++){t.push(arguments[e])}o(console.trace||console.log,t)}if(n.notifyOnLogging>1){var r=[];for(e=0;e<arguments.length;e++){r.push(arguments[e])}a(r.join("<br>"),"long")}};i.warn=function(){var e;if(n.logging>0){var t=["WARN:"];for(e=0;e<arguments.length;e++){t.push(arguments[e])}o(console.trace||console.log,t)}if(n.notifyOnLogging>0){var r=[];for(e=0;e<arguments.length;e++){r.push(arguments[e])}a(r.join("<br>"),"stick")}};i.error=function(){var e;if(n.logging>0){var t=["ERROR:"];for(e=0;e<arguments.length;e++){t.push(arguments[e])}o(console.error,t)}if(n.notifyOnLogging>0){var r=[];for(e=0;e<arguments.length;e++){r.push(arguments[e])}a(r.join("<br>"),"stick")}};function o(e,t){if(e&&e.apply){try{e.apply(console,t);return}catch(e){}}for(var r=0;r<t.length;r++){try{e(t[r])}catch(e){console.log(t[r])}}}},{"../plot_api/plot_config":815,"./notifier":788}],783:[function(e,t,r){"use strict";var n=e("d3");t.exports=function e(t,r,a){var i=t.selectAll("g."+a.replace(/\s/g,".")).data(r,function(e){return e[0].trace.uid});i.exit().remove();i.enter().append("g").attr("class",a);i.order();var o=t.classed("rangeplot")?"nodeRangePlot3":"node3";i.each(function(e){e[0][o]=n.select(this)});return i}},{d3:169}],784:[function(e,t,r){"use strict";var n=e("gl-mat4");r.init2dArray=function(e,t){var r=new Array(e);for(var n=0;n<e;n++)r[n]=new Array(t);return r};r.transposeRagged=function(e){var t=0;var r=e.length;var n,a;for(n=0;n<r;n++)t=Math.max(t,e[n].length);var i=new Array(t);for(n=0;n<t;n++){i[n]=new Array(r);for(a=0;a<r;a++)i[n][a]=e[a][n]}return i};r.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var n=e.length;var a;var i;if(e[0].length){a=new Array(n);for(i=0;i<n;i++)a[i]=r.dot(e[i],t)}else if(t[0].length){var o=r.transposeRagged(t);a=new Array(o.length);for(i=0;i<o.length;i++)a[i]=r.dot(e,o[i])}else{a=0;for(i=0;i<n;i++)a+=e[i]*t[i]}return a};r.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]};r.rotationMatrix=function(e){var t=e*Math.PI/180;return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]};r.rotationXYMatrix=function(e,t,n){return r.dot(r.dot(r.translationMatrix(t,n),r.rotationMatrix(e)),r.translationMatrix(-t,-n))};r.apply3DTransform=function(e){return function(){var t=arguments;var n=arguments.length===1?t[0]:[t[0],t[1],t[2]||0];return r.dot(e,[n[0],n[1],n[2],1]).slice(0,3)}};r.apply2DTransform=function(e){return function(){var t=arguments;if(t.length===3){t=t[0]}var n=arguments.length===1?t[0]:[t[0],t[1]];return r.dot(e,[n[0],n[1],1]).slice(0,2)}};r.apply2DTransform2=function(e){var t=r.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}};r.convertCssMatrix=function(e){if(e){var t=e.length;if(t===16)return e;if(t===6){return[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,e[4],e[5],0,1]}}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};r.inverseTransformMatrix=function(e){var t=[];n.invert(t,e);return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}},{"gl-mat4":292}],785:[function(e,t,r){"use strict";function n(e,t){var r=e%t;return r<0?r+t:r}function a(e,t){return Math.abs(e)>t/2?e-Math.round(e/t)*t:e}t.exports={mod:n,modHalf:a}},{}],786:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("./array").isArrayOrTypedArray;t.exports=function e(t,r){if(n(r))r=String(r);else if(typeof r!=="string"||r.substr(r.length-4)==="[-1]"){throw"bad property string"}var a=0;var o=r.split(".");var s;var u;var c;while(a<o.length){s=String(o[a]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/);if(s){if(s[1])o[a]=s[1];else if(a===0)o.splice(0,1);else throw"bad property string";u=s[2].substr(1,s[2].length-2).split("][");for(c=0;c<u.length;c++){a++;o.splice(a,0,Number(u[c]))}}a++}if(typeof t!=="object"){return h(t,r,o)}return{set:l(t,o,r),get:i(t,o),astr:r,parts:o,obj:t}};function i(e,t){return function(){var r=e;var n;var o;var s;var l;var u;for(l=0;l<t.length-1;l++){n=t[l];if(n===-1){o=true;s=[];for(u=0;u<r.length;u++){s[u]=i(r[u],t.slice(l+1))();if(s[u]!==s[0])o=false}return o?s[0]:s}if(typeof n==="number"&&!a(r)){return undefined}r=r[n];if(typeof r!=="object"||r===null){return undefined}}if(typeof r!=="object"||r===null)return undefined;s=r[t[l]];if(s===null)return undefined;return s}}var o=/(^|\.)args\[/;function s(e,t){return e===undefined||e===null&&!t.match(o)}function l(e,t,r){return function(n){var i=e;var o="";var l=[[e,o]];var h=s(n,r);var p;var d;for(d=0;d<t.length-1;d++){p=t[d];if(typeof p==="number"&&!a(i)){throw"array index but container is not an array"}if(p===-1){h=!c(i,t.slice(d+1),n,r);if(h)break;else return}if(!f(i,p,t[d+1],h)){break}i=i[p];if(typeof i!=="object"||i===null){throw"container is not an object"}o=u(o,p);l.push([i,o])}if(h){if(d===t.length-1){delete i[t[d]];if(Array.isArray(i)&&+t[d]===i.length-1){while(i.length&&i[i.length-1]===undefined){i.pop()}}}}else i[t[d]]=n}}function u(e,t){var r=t;if(n(t))r="["+t+"]";else if(e)r="."+t;return e+r}function c(e,t,r,n){var i=a(r);var o=true;var u=r;var c=n.replace("-1",0);var h=i?false:s(r,c);var p=t[0];var d;for(d=0;d<e.length;d++){c=n.replace("-1",d);if(i){u=r[d%r.length];h=s(u,c)}if(h)o=false;if(!f(e,d,p,h)){continue}l(e[d],t,n.replace("-1",d))(u)}return o}function f(e,t,r,n){if(e[t]===undefined){if(n)return false;if(typeof r==="number")e[t]=[];else e[t]={}}return true}function h(e,t,r){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:r,obj:e}}},{"./array":760,"fast-isnumeric":241}],787:[function(e,t,r){"use strict";t.exports=function e(){}},{}],788:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=[];t.exports=function(e,t){if(i.indexOf(e)!==-1)return;i.push(e);var r=1e3;if(a(t))r=t;else if(t==="long")r=3e3;var o=n.select("body").selectAll(".plotly-notifier").data([0]);o.enter().append("div").classed("plotly-notifier",true);var s=o.selectAll(".notifier-note").data(i);function l(e){e.duration(700).style("opacity",0).each("end",function(e){var t=i.indexOf(e);if(t!==-1)i.splice(t,1);n.select(this).remove()})}s.enter().append("div").classed("notifier-note",true).style("opacity",0).each(function(e){var a=n.select(this);a.append("button").classed("notifier-close",true).html("&times;").on("click",function(){a.transition().call(l)});var i=a.append("p");var o=e.split(/<br\s*\/?>/g);for(var s=0;s<o.length;s++){if(s)i.append("br");i.append("span").text(o[s])}if(t==="stick"){a.transition().duration(350).style("opacity",1)}else{a.transition().duration(700).style("opacity",1).transition().delay(r).call(l)}})}},{d3:169,"fast-isnumeric":241}],789:[function(e,t,r){"use strict";var n=e("./setcursor");var a="data-savedcursor";var i="!!";t.exports=function e(t,r){var o=t.attr(a);if(r){if(!o){var s=(t.attr("class")||"").split(" ");for(var l=0;l<s.length;l++){var u=s[l];if(u.indexOf("cursor-")===0){t.attr(a,u.substr(7)).classed(u,false)}}if(!t.attr(a)){t.attr(a,i)}}n(t,r)}else if(o){t.attr(a,null);if(o===i)n(t);else n(t,o)}}},{"./setcursor":799}],790:[function(e,t,r){"use strict";var n=e("./matrix").dot;var a=e("../constants/numerical").BADNUM;var i=t.exports={};i.tester=function e(t){var r=t.slice();var n=r[0][0];var i=n;var o=r[0][1];var s=o;var l;r.push(r[0]);for(l=1;l<r.length;l++){n=Math.min(n,r[l][0]);i=Math.max(i,r[l][0]);o=Math.min(o,r[l][1]);s=Math.max(s,r[l][1])}var u=false;var c;if(r.length===5){if(r[0][0]===r[1][0]){if(r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]){u=true;c=function(e){return e[0]===r[0][0]}}}else if(r[0][1]===r[1][1]){if(r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]){u=true;c=function(e){return e[1]===r[0][1]}}}}function f(e,t){var r=e[0];var l=e[1];if(r===a||r<n||r>i||l===a||l<o||l>s){return false}if(t&&c(e))return false;return true}function h(e,t){var l=e[0];var u=e[1];if(l===a||l<n||l>i||u===a||u<o||u>s){return false}var c=r.length;var f=r[0][0];var h=r[0][1];var p=0;var d;var v;var m;var g;var y;for(d=1;d<c;d++){v=f;m=h;f=r[d][0];h=r[d][1];g=Math.min(v,f);if(l<g||l>Math.max(v,f)||u>Math.max(m,h)){continue}else if(u<Math.min(m,h)){if(l!==g)p++}else{if(f===v)y=u;else y=m+(l-v)*(h-m)/(f-v);if(u===y){if(d===1&&t)return false;return true}if(u<=y&&l!==g)p++}}return p%2===1}var p=true;var d=r[0];for(l=1;l<r.length;l++){if(d[0]!==r[l][0]||d[1]!==r[l][1]){p=false;break}}return{xmin:n,xmax:i,ymin:o,ymax:s,pts:r,contains:u?f:h,isRect:u,degenerate:p}};i.isSegmentBent=function e(t,r,a,i){var o=t[r];var s=[t[a][0]-o[0],t[a][1]-o[1]];var l=n(s,s);var u=Math.sqrt(l);var c=[-s[1]/u,s[0]/u];var f;var h;var p;for(f=r+1;f<a;f++){h=[t[f][0]-o[0],t[f][1]-o[1]];p=n(h,s);if(p<0||p>l||Math.abs(n(h,c))>i)return true}return false};i.filter=function e(t,r){var n=[t[0]];var a=0;var o=0;function s(e){t.push(e);var s=n.length;var l=a;n.splice(o+1);for(var u=l+1;u<t.length;u++){if(u===t.length-1||i.isSegmentBent(t,l,u+1,r)){n.push(t[u]);if(n.length<s-2){a=u;o=n.length-1}l=u}}}if(t.length>1){var l=t.pop();s(l)}return{addPt:s,raw:t,filtered:n}}},{"../constants/numerical":753,"./matrix":784}],791:[function(e,r,n){(function(t){(function(){"use strict";var n=e("./show_no_webgl_msg");var a=e("regl");r.exports=function e(r,i){var o=r._fullLayout;var s=true;o._glcanvas.each(function(e){if(e.regl)return;if(e.pick&&!o._has("parcoords"))return;try{e.regl=a({canvas:this,attributes:{antialias:!e.pick,preserveDrawingBuffer:true},pixelRatio:r._context.plotGlPixelRatio||t.devicePixelRatio,extensions:i||[]})}catch(e){s=false}if(!e.regl)s=false;if(s){this.addEventListener("webglcontextlost",function(t){if(r&&r.emit){r.emit("plotly_webglcontextlost",{event:t,layer:e.key})}},false)}});if(!s){n({container:o._glcontainer.node()})}return s}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./show_no_webgl_msg":800,regl:540}],792:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("is-mobile");t.exports=function e(t){var r;if(t&&t.hasOwnProperty("userAgent")){r=t.userAgent}else{r=i()}if(typeof r!=="string")return true;var o=a({ua:{headers:{"user-agent":r}},tablet:true,featureDetect:false});if(!o){var s=r.split(" ");for(var l=1;l<s.length;l++){var u=s[l];if(u.indexOf("Safari")!==-1){for(var c=l-1;c>-1;c--){var f=s[c];if(f.substr(0,8)==="Version/"){var h=f.substr(8).split(".")[0];if(n(h))h=+h;if(h>=13)return true}}}}}return o};function i(){var e;if(typeof navigator!=="undefined"){e=navigator.userAgent}if(e&&e.headers&&typeof e.headers["user-agent"]==="string"){e=e.headers["user-agent"]}return e}},{"fast-isnumeric":241,"is-mobile":467}],793:[function(e,t,r){"use strict";t.exports=function e(t,r){if(r instanceof RegExp){var n=r.toString();for(var a=0;a<t.length;a++){if(t[a]instanceof RegExp&&t[a].toString()===n){return t}}t.push(r)}else if((r||r===0)&&t.indexOf(r)===-1)t.push(r);return t}},{}],794:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plot_api/plot_config").dfltConfig;function i(e,t){var r=[];var a;for(var i=0;i<t.length;i++){a=t[i];if(a===e)r[i]=a;else if(typeof a==="object"){r[i]=Array.isArray(a)?n.extendDeep([],a):n.extendDeepAll({},a)}else r[i]=a}return r}var o={};o.add=function(e,t,r,n,i){var o,s;e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};s=e.undoQueue.index;if(e.autoplay){if(!e.undoQueue.inSequence)e.autoplay=false;return}if(!e.undoQueue.sequence||e.undoQueue.beginSequence){o={undo:{calls:[],args:[]},redo:{calls:[],args:[]}};e.undoQueue.queue.splice(s,e.undoQueue.queue.length-s,o);e.undoQueue.index+=1}else{o=e.undoQueue.queue[s-1]}e.undoQueue.beginSequence=false;if(o){o.undo.calls.unshift(t);o.undo.args.unshift(r);o.redo.calls.push(n);o.redo.args.push(i)}if(e.undoQueue.queue.length>a.queueLength){e.undoQueue.queue.shift();e.undoQueue.index--}};o.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=true;e.undoQueue.beginSequence=true};o.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=false;e.undoQueue.beginSequence=false};o.undo=function e(t){var r,n;if(t.framework&&t.framework.isPolar){t.framework.undo();return}if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index<=0){return}t.undoQueue.index--;r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(n=0;n<r.undo.calls.length;n++){o.plotDo(t,r.undo.calls[n],r.undo.args[n])}t.undoQueue.inSequence=false;t.autoplay=false};o.redo=function e(t){var r,n;if(t.framework&&t.framework.isPolar){t.framework.redo();return}if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index>=t.undoQueue.queue.length){return}r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(n=0;n<r.redo.calls.length;n++){o.plotDo(t,r.redo.calls[n],r.redo.args[n])}t.undoQueue.inSequence=false;t.autoplay=false;t.undoQueue.index++};o.plotDo=function(e,t,r){e.autoplay=true;r=i(e,r);t.apply(null,r)};t.exports=o},{"../lib":778,"../plot_api/plot_config":815}],795:[function(e,t,r){"use strict";r.counter=function(e,t,r,n){var a=(t||"")+(r?"":"$");var i=n===false?"":"^";if(e==="xy"){return new RegExp(i+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+a)}return new RegExp(i+e+"([2-9]|[1-9][0-9]+)?"+a)}},{}],796:[function(e,t,r){"use strict";var n=/^(.*)(\.[^\.\[\]]+|\[\d\])$/;var a=/^[^\.\[\]]+$/;t.exports=function(e,t){while(t){var r=e.match(n);if(r)e=r[1];else if(e.match(a))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if(t.charAt(0)==="^")t=t.slice(1);else break}if(e&&t.charAt(0)!=="["){return e+"."+t}return e+t}},{}],797:[function(e,t,r){"use strict";var n=e("./array").isArrayOrTypedArray;var a=e("./is_plain_object");t.exports=function e(t,r){for(var i in r){var o=r[i];var s=t[i];if(s===o)continue;if(i.charAt(0)==="_"||typeof o==="function"){if(i in t)continue;t[i]=o}else if(n(o)&&n(s)&&a(o[0])){if(i==="customdata"||i==="ids")continue;var l=Math.min(o.length,s.length);for(var u=0;u<l;u++){if(s[u]!==o[u]&&a(o[u])&&a(s[u])){e(s[u],o[u])}}}else if(a(o)&&a(s)){e(s,o);if(!Object.keys(s).length)delete t[i]}}}},{"./array":760,"./is_plain_object":779}],798:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("./loggers");var i=e("./identity");var o=e("../constants/numerical").BADNUM;var s=1e-9;r.findBin=function(e,t,r){if(n(t.start)){return r?Math.ceil((e-t.start)/t.size-s)-1:Math.floor((e-t.start)/t.size+s)}else{var i=0;var o=t.length;var h=0;var p=o>1?(t[o-1]-t[0])/(o-1):1;var d,v;if(p>=0){v=r?l:u}else{v=r?f:c}e+=p*s*(r?-1:1)*(p>=0?1:-1);while(i<o&&h++<100){d=Math.floor((i+o)/2);if(v(t[d],e))i=d+1;else o=d}if(h>90)a.log("Long binary search...");return i-1}};function l(e,t){return e<t}function u(e,t){return e<=t}function c(e,t){return e>t}function f(e,t){return e>=t}r.sorterAsc=function(e,t){return e-t};r.sorterDes=function(e,t){return t-e};r.distinctVals=function(e,t){var n=(t||{}).unitMinDiff;var a=e.slice();a.sort(r.sorterAsc);var i;for(i=a.length-1;i>-1;i--){if(a[i]!==o)break}var s=1;if(!n)s=a[i]-a[0]||1;var l=s/(i||1)/1e4;var u=[];var c;for(var f=0;f<=i;f++){var h=a[f];var p=h-c;if(c===undefined){u.push(h);c=h}else if(p>l){s=Math.min(s,p);u.push(h);c=h}}return{vals:u,minDiff:s}};r.roundUp=function(e,t,r){var n=0;var a=t.length-1;var i;var o=0;var s=r?0:1;var l=r?1:0;var u=r?Math.ceil:Math.floor;while(n<a&&o++<100){i=u((n+a)/2);if(t[i]<=e)n=i+s;else a=i-l}return t[n]};r.sort=function(e,t){var r=0;var n=0;for(var a=1;a<e.length;a++){var i=t(e[a],e[a-1]);if(i<0)r=1;else if(i>0)n=1;if(r&&n)return e.sort(t)}return n?e:e.reverse()};r.findIndexOfMin=function(e,t){t=t||i;var r=Infinity;var n;for(var a=0;a<e.length;a++){var o=t(e[a]);if(o<r){r=o;n=a}}return n}},{"../constants/numerical":753,"./identity":776,"./loggers":782,"fast-isnumeric":241}],799:[function(e,t,r){"use strict";t.exports=function e(t,r){(t.attr("class")||"").split(" ").forEach(function(e){if(e.indexOf("cursor-")===0)t.classed(e,false)});if(r)t.classed("cursor-"+r,true)}},{}],800:[function(e,t,r){"use strict";var n=e("../components/color");var a=function(){};t.exports=function e(t){for(var r in t){if(typeof t[r]==="function")t[r]=a}t.destroy=function(){t.container.parentNode.removeChild(t.container)};var i=document.createElement("div");i.className="no-webgl";i.style.cursor="pointer";i.style.fontSize="24px";i.style.color=n.defaults[0];i.style.position="absolute";i.style.left=i.style.top="0px";i.style.width=i.style.height="100%";i.style["background-color"]=n.lightLine;i.style["z-index"]=30;var o=document.createElement("p");o.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info";o.style.position="relative";o.style.top="50%";o.style.left="50%";o.style.height="30%";o.style.width="50%";o.style.margin="-15% 0 0 -25%";i.appendChild(o);t.container.appendChild(i);t.container.style.background="#FFFFFF";t.container.onclick=function(){window.open("https://get.webgl.org")};return false}},{"../components/color":643}],801:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("./array").isArrayOrTypedArray;r.aggNums=function(e,t,i,o){var s,l;if(!o||o>i.length)o=i.length;if(!n(t))t=false;if(a(i[0])){l=new Array(o);for(s=0;s<o;s++)l[s]=r.aggNums(e,t,i[s]);i=l}for(s=0;s<o;s++){if(!n(t))t=i[s];else if(n(i[s]))t=e(+t,+i[s])}return t};r.len=function(e){return r.aggNums(function(e){return e+1},0,e)};r.mean=function(e,t){if(!t)t=r.len(e);return r.aggNums(function(e,t){return e+t},0,e)/t};r.midRange=function(e){if(e===undefined||e.length===0)return undefined;return(r.aggNums(Math.max,null,e)+r.aggNums(Math.min,null,e))/2};r.variance=function(e,t,a){if(!t)t=r.len(e);if(!n(a))a=r.mean(e,t);return r.aggNums(function(e,t){return e+Math.pow(t-a,2)},0,e)/t};r.stdev=function(e,t,n){return Math.sqrt(r.variance(e,t,n))};r.median=function(e){var t=e.slice().sort();return r.interp(t,.5)};r.interp=function(e,t){if(!n(t))throw"n should be a finite number";t=t*e.length-.5;if(t<0)return e[0];if(t>e.length-1)return e[e.length-1];var r=t%1;return r*e[Math.ceil(t)]+(1-r)*e[Math.floor(t)]}},{"./array":760,"fast-isnumeric":241}],802:[function(e,t,r){"use strict";var n=e("color-normalize");function a(e){if(!e)return[0,0,0,1];return n(e)}t.exports=a},{"color-normalize":125}],803:[function(e,t,r){"use strict";var n=e("d3");var a=e("../lib");var i=a.strTranslate;var o=e("../constants/xmlns_namespaces");var s=e("../constants/alignment").LINE_SPACING;function l(e,t){return e.node().getBoundingClientRect()[t]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;r.convertToTspans=function(e,t,a){var o=e.text();var s=!e.attr("data-notex")&&typeof MathJax!=="undefined"&&o.match(u);var c=n.select(e.node().parentNode);if(c.empty())return;var f=e.attr("class")?e.attr("class").split(" ")[0]:"text";f+="-math";c.selectAll("svg."+f).remove();c.selectAll("g."+f+"-group").remove();e.style("display",null).attr({"data-unformatted":o,"data-math":"N"});function h(){if(!c.empty()){f=e.attr("class")+"-math";c.select("svg."+f).remove()}e.text("").style("white-space","pre");var t=P(e.node(),o);if(t){e.style("pointer-events","all")}r.positionText(e);if(a)a.call(e)}if(s){(t&&t._promises||[]).push(new Promise(function(t){e.style("display","none");var r=parseInt(e.node().style.fontSize,10);var n={fontSize:r};p(s[2],n,function(n,s,u){c.selectAll("svg."+f).remove();c.selectAll("g."+f+"-group").remove();var p=n&&n.select("svg");if(!p||!p.node()){h();t();return}var d=c.append("g").classed(f+"-group",true).attr({"pointer-events":"none","data-unformatted":o,"data-math":"Y"});d.node().appendChild(p.node());if(s&&s.node()){p.node().insertBefore(s.node().cloneNode(true),p.node().firstChild)}p.attr({class:f,height:u.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var v=e.node().style.fill||"black";var m=p.select("g");m.attr({fill:v,stroke:v});var g=l(m,"width");var y=l(m,"height");var x=+e.attr("x")-g*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"];var _=r||l(e,"height");var b=-_/4;if(f[0]==="y"){d.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+")"+i(-g/2,b-y/2)});p.attr({x:+e.attr("x"),y:+e.attr("y")})}else if(f[0]==="l"){p.attr({x:e.attr("x"),y:b-y/2})}else if(f[0]==="a"&&f.indexOf("atitle")!==0){p.attr({x:0,y:b})}else{p.attr({x:x,y:+e.attr("y")+b-y/2})}if(a)a.call(e,d);t(d)})}))}else h();return e};var c=/(<|&lt;|&#60;)/g;var f=/(>|&gt;|&#62;)/g;function h(e){return e.replace(c,"\\lt ").replace(f,"\\gt ")}function p(e,t,r){var i,o,s,l;MathJax.Hub.Queue(function(){o=a.extendDeepAll({},MathJax.Hub.config);s=MathJax.Hub.processSectionDelay;if(MathJax.Hub.processSectionDelay!==undefined){MathJax.Hub.processSectionDelay=0}return MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){i=MathJax.Hub.config.menuSettings.renderer;if(i!=="SVG"){return MathJax.Hub.setRenderer("SVG")}},function(){var r="math-output-"+a.randstr({},64);l=n.select("body").append("div").attr({id:r}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(h(e));return MathJax.Hub.Typeset(l.node())},function(){var t=n.select("body").select("#MathJax_SVG_glyphs");if(l.select(".MathJax_SVG").empty()||!l.select("svg").node()){a.log("There was an error in the tex syntax.",e);r()}else{var o=l.select("svg").node().getBoundingClientRect();r(l.select(".MathJax_SVG"),t,o)}l.remove();if(i!=="SVG"){return MathJax.Hub.setRenderer(i)}},function(){if(s!==undefined){MathJax.Hub.processSectionDelay=s}return MathJax.Hub.Config(o)})}var d={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"};var v={sub:"0.3em",sup:"-0.6em"};var m={sub:"-0.21em",sup:"0.42em"};var g="​";var y=["http:","https:","mailto:","",undefined,":"];var x=r.NEWLINES=/(\r\n?|\n)/g;var _=/(<[^<>]*>)/;var b=/<(\/?)([^ >]*)(\s+(.*))?>/i;var w=/<br(\s+.*)?>/i;r.BR_TAG_ALL=/<br(\s+.*)?>/gi;var T=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i;var k=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i;var A=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i;var M=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function E(e,t){if(!e)return null;var r=e.match(t);var n=r&&(r[3]||r[4]);return n&&I(n)}var S=/(^|;)\s*color:/;r.plainText=function(e,t){t=t||{};var r=t.len!==undefined&&t.len!==-1?t.len:Infinity;var n=t.allowedTags!==undefined?t.allowedTags:["br"];var a="...";var i=a.length;var o=e.split(_);var s=[];var l="";var u=0;for(var c=0;c<o.length;c++){var f=o[c];var h=f.match(b);var p=h&&h[2].toLowerCase();if(p){if(n.indexOf(p)!==-1){s.push(f);l=p}}else{var d=f.length;if(u+d<r){s.push(f);u+=d}else if(u<r){var v=r-u;if(l&&(l!=="br"||v<=i||d<=i)){s.pop()}if(r>i){s.push(f.substr(0,v-i)+a)}else{s.push(f.substr(0,v))}break}l=""}}return s.join("")};var C={mu:"μ",amp:"&",lt:"<",gt:">",nbsp:" ",times:"×",plusmn:"±",deg:"°"};var L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function I(e){return e.replace(L,function(e,t){var r;if(t.charAt(0)==="#"){r=O(t.charAt(1)==="x"?parseInt(t.substr(2),16):parseInt(t.substr(1),10))}else r=C[t];return r||e})}r.convertEntities=I;function O(e){if(e>1114111)return;var t=String.fromCodePoint;if(t)return t(e);var r=String.fromCharCode;if(e<=65535)return r(e);return r((e>>10)+55232,e%1024+56320)}function P(e,t){t=t.replace(x," ");var r=false;var i=[];var l;var u=-1;function c(){u++;var t=document.createElementNS(o.svg,"tspan");n.select(t).attr({class:"line",dy:u*s+"em"});e.appendChild(t);l=t;var r=i;i=[{node:t}];if(r.length>1){for(var a=1;a<r.length;a++){f(r[a])}}}function f(e){var t=e.type;var r={};var a;if(t==="a"){a="a";var s=e.target;var u=e.href;var c=e.popup;if(u){r={"xlink:xlink:show":s==="_blank"||s.charAt(0)!=="_"?"new":"replace",target:s,"xlink:xlink:href":u};if(c){r.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+c+'");return false;'}}}else a="tspan";if(e.style)r.style=e.style;var f=document.createElementNS(o.svg,a);if(t==="sup"||t==="sub"){h(l,g);l.appendChild(f);var p=document.createElementNS(o.svg,"tspan");h(p,g);n.select(p).attr("dy",m[t]);r.dy=v[t];l.appendChild(f);l.appendChild(p)}else{l.appendChild(f)}n.select(f).attr(r);l=e.node=f;i.push(e)}function h(e,t){e.appendChild(document.createTextNode(t))}function p(e){if(i.length===1){a.log("Ignoring unexpected end tag </"+e+">.",t);return}var r=i.pop();if(e!==r.type){a.log("Start tag <"+r.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t)}l=i[i.length-1].node}var C=w.test(t);if(C)c();else{l=e;i=[{node:e}]}var L=t.split(_);for(var O=0;O<L.length;O++){var P=L[O];var D=P.match(b);var R=D&&D[2].toLowerCase();var z=d[R];if(R==="br"){c()}else if(z===undefined){h(l,I(P))}else{if(D[1]){p(R)}else{var N=D[4];var F={type:R};var B=E(N,T);if(B){B=B.replace(S,"$1 fill:");if(z)B+=";"+z}else if(z)B=z;if(B)F.style=B;if(R==="a"){r=true;var j=E(N,k);if(j){var U=document.createElement("a");U.href=j;if(y.indexOf(U.protocol)!==-1){F.href=encodeURI(decodeURI(j));F.target=E(N,A)||"_blank";F.popup=E(N,M)}}}f(F)}}}return r}r.sanitizeHTML=function e(t){t=t.replace(x," ");var r=document.createElement("p");var a=r;var i=[];var o=t.split(_);for(var s=0;s<o.length;s++){var l=o[s];var u=l.match(b);var c=u&&u[2].toLowerCase();if(c in d){if(u[1]){if(i.length){a=i.pop()}}else{var f=u[4];var h=E(f,T);var p=h?{style:h}:{};if(c==="a"){var v=E(f,k);if(v){var m=document.createElement("a");m.href=v;if(y.indexOf(m.protocol)!==-1){p.href=encodeURI(decodeURI(v));var g=E(f,A);if(g){p.target=g}}}}var w=document.createElement(c);a.appendChild(w);n.select(w).attr(p);a=w;i.push(w)}}else{a.appendChild(document.createTextNode(I(l)))}}var M="innerHTML";return r[M]};r.lineCount=function e(t){return t.selectAll("tspan.line").size()||1};r.positionText=function e(t,r,a){return t.each(function(){var e=n.select(this);function t(t,r){if(r===undefined){r=e.attr(t);if(r===null){e.attr(t,0);r=0}}else e.attr(t,r);return r}var i=t("x",r);var o=t("y",a);if(this.nodeName==="text"){e.selectAll("tspan.line").attr({x:i,y:o})}})};function D(e,t,r){var n=r.horizontalAlign;var i=r.verticalAlign||"top";var o=e.node().getBoundingClientRect();var s=t.node().getBoundingClientRect();var l;var u;var c;if(i==="bottom"){u=function(){return o.bottom-l.height}}else if(i==="middle"){u=function(){return o.top+(o.height-l.height)/2}}else{u=function(){return o.top}}if(n==="right"){c=function(){return o.right-l.width}}else if(n==="center"){c=function(){return o.left+(o.width-l.width)/2}}else{c=function(){return o.left}}return function(){l=this.node().getBoundingClientRect();var e=c()-s.left;var t=u()-s.top;var n=r.gd||{};if(r.gd){n._fullLayout._calcInverseTransform(n);var i=a.apply3DTransform(n._fullLayout._invTransform)(e,t);e=i[0];t=i[1]}this.style({top:t+"px",left:e+"px","z-index":1e3});return this}}r.makeEditable=function(e,t){var r=t.gd;var a=t.delegate;var i=n.dispatch("edit","input","cancel");var o=a||e;e.style({"pointer-events":a?"none":"all"});if(e.size()!==1)throw new Error("boo");function s(){u();e.style({opacity:0});var t=o.attr("class");var r;if(t)r="."+t.split(" ")[0]+"-math-group";else r="[class*=-math-group]";if(r){n.select(e.node().parentNode).select(r).style({opacity:0})}}function l(e){var t=e.node();var r=document.createRange();r.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges();n.addRange(r);t.focus()}function u(){var a=n.select(r);var o=a.select(".svg-container");var s=o.append("div");var u=e.node().style;var c=parseFloat(u.fontSize||12);var f=t.text;if(f===undefined)f=e.attr("data-unformatted");s.classed("plugin-editable editable",true).style({position:"absolute","font-family":u.fontFamily||"Arial","font-size":c,color:t.fill||u.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-c/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:true}).text(f).call(D(e,o,t)).on("blur",function(){r._editing=false;e.text(this.textContent).style({opacity:1});var t=n.select(this).attr("class");var a;if(t)a="."+t.split(" ")[0]+"-math-group";else a="[class*=-math-group]";if(a){n.select(e.node().parentNode).select(a).style({opacity:0})}var o=this.textContent;n.select(this).transition().duration(0).remove();n.select(document).on("mouseup",null);i.edit.call(e,o)}).on("focus",function(){var e=this;r._editing=true;n.select(document).on("mouseup",function(){if(n.event.target===e)return false;if(document.activeElement===s.node())s.node().blur()})}).on("keyup",function(){if(n.event.which===27){r._editing=false;e.style({opacity:1});n.select(this).style({opacity:0}).on("blur",function(){return false}).transition().remove();i.cancel.call(e,this.textContent)}else{i.input.call(e,this.textContent);n.select(this).call(D(e,o,t))}}).on("keydown",function(){if(n.event.which===13)this.blur()}).call(l)}if(t.immediate)s();else o.on("click",s);return n.rebind(e,i,"on")}},{"../constants/alignment":745,"../constants/xmlns_namespaces":754,"../lib":778,d3:169}],804:[function(e,t,r){"use strict";var n={};r.throttle=function e(t,r,i){var o=n[t];var s=Date.now();if(!o){for(var l in n){if(n[l].ts<s-6e4){delete n[l]}}o=n[t]={ts:0,timer:null}}a(o);function u(){i();o.ts=Date.now();if(o.onDone){o.onDone();o.onDone=null}}if(s>o.ts+r){u();return}o.timer=setTimeout(function(){u();o.timer=null},r)};r.done=function(e){var t=n[e];if(!t||!t.timer)return Promise.resolve();return new Promise(function(e){var r=t.onDone;t.onDone=function n(){if(r)r();e();t.onDone=null}})};r.clear=function(e){if(e){a(n[e]);delete n[e]}else{for(var t in n)r.clear(t)}};function a(e){if(e&&e.timer!==null){clearTimeout(e.timer);e.timer=null}}},{}],805:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports=function e(t,r){if(t>0)return Math.log(t)/Math.LN10;var a=Math.log(Math.min(r[0],r[1]))/Math.LN10;if(!n(a))a=Math.log(Math.max(r[0],r[1]))/Math.LN10-6;return a}},{"fast-isnumeric":241}],806:[function(e,t,r){"use strict";var n=t.exports={};var a=e("../plots/geo/constants").locationmodeToLayer;var i=e("topojson-client").feature;n.getTopojsonName=function(e){return[e.scope.replace(/ /g,"-"),"_",e.resolution.toString(),"m"].join("")};n.getTopojsonPath=function(e,t){return e+t+".json"};n.getTopojsonFeatures=function(e,t){var r=a[e.locationmode];var n=t.objects[r];return i(t,n).features}},{"../plots/geo/constants":858,"topojson-client":579}],807:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],808:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],809:[function(e,t,r){"use strict";var n=e("../registry");t.exports=function e(t){var r=n.layoutArrayContainers;var a=n.layoutArrayRegexes;var i=t.split("[")[0];var o;var s;for(var l=0;l<a.length;l++){s=t.match(a[l]);if(s&&s.index===0){o=s[0];break}}if(!o)o=r[r.indexOf(i)];if(!o)return false;var u=t.substr(o.length);if(!u)return{array:o,index:"",property:""};s=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/);if(!s)return false;return{array:o,index:Number(s[1]),property:s[3]||""}}},{"../registry":911}],810:[function(e,t,r){"use strict";var n=e("../lib");var a=n.extendFlat;var i=n.isPlainObject;var o={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]};var s={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]};var l=o.flags.slice().concat(["fullReplot"]);var u=s.flags.slice().concat("layoutReplot");t.exports={traces:o,layout:s,traceFlags:function(){return c(l)},layoutFlags:function(){return c(u)},update:function(e,t){var r=t.editType;if(r&&r!=="none"){var n=r.split("+");for(var a=0;a<n.length;a++){e[n[a]]=true}}},overrideAll:f};function c(e){var t={};for(var r=0;r<e.length;r++)t[e[r]]=false;return t}function f(e,t,r){var n=a({},e);for(var o in n){var s=n[o];if(i(s)){n[o]=h(s,t,r,o)}}if(r==="from-root")n.editType=t;return n}function h(e,t,r,n){if(e.valType){var i=a({},e);i.editType=t;if(Array.isArray(e.items)){i.items=new Array(e.items.length);for(var o=0;o<e.items.length;o++){i.items[o]=h(e.items[o],t,"from-root")}}return i}else{return f(e,t,n.charAt(0)==="_"?"nested":"from-root")}}},{"../lib":778}],811:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("gl-mat4/fromQuat");var i=e("../registry");var o=e("../lib");var s=e("../plots/plots");var l=e("../plots/cartesian/axis_ids");var u=e("../components/color");var c=l.cleanId;var f=l.getFromTrace;var h=i.traceIs;r.clearPromiseQueue=function(e){if(Array.isArray(e._promises)&&e._promises.length>0){o.log("Clearing previous rejected promises from queue.")}e._promises=[]};r.cleanLayout=function(e){var t,n;if(!e)e={};if(e.xaxis1){if(!e.xaxis)e.xaxis=e.xaxis1;delete e.xaxis1}if(e.yaxis1){if(!e.yaxis)e.yaxis=e.yaxis1;delete e.yaxis1}if(e.scene1){if(!e.scene)e.scene=e.scene1;delete e.scene1}var i=(s.subplotsRegistry.cartesian||{}).attrRegex;var l=(s.subplotsRegistry.polar||{}).attrRegex;var f=(s.subplotsRegistry.ternary||{}).attrRegex;var h=(s.subplotsRegistry.gl3d||{}).attrRegex;var v=Object.keys(e);for(t=0;t<v.length;t++){var m=v[t];if(i&&i.test(m)){var g=e[m];if(g.anchor&&g.anchor!=="free"){g.anchor=c(g.anchor)}if(g.overlaying)g.overlaying=c(g.overlaying);if(!g.type){if(g.isdate)g.type="date";else if(g.islog)g.type="log";else if(g.isdate===false&&g.islog===false)g.type="linear"}if(g.autorange==="withzero"||g.autorange==="tozero"){g.autorange=true;g.rangemode="tozero"}delete g.islog;delete g.isdate;delete g.categories;if(y(g,"domain"))delete g.domain;if(g.autotick!==undefined){if(g.tickmode===undefined){g.tickmode=g.autotick?"auto":"linear"}delete g.autotick}d(g)}else if(l&&l.test(m)){var x=e[m];d(x.radialaxis)}else if(f&&f.test(m)){var _=e[m];d(_.aaxis);d(_.baxis);d(_.caxis)}else if(h&&h.test(m)){var b=e[m];var w=b.cameraposition;if(Array.isArray(w)&&w[0].length===4){var T=w[0];var k=w[1];var A=w[2];var M=a([],T);var E=[];for(n=0;n<3;++n){E[n]=k[n]+A*M[2+4*n]}b.camera={eye:{x:E[0],y:E[1],z:E[2]},center:{x:k[0],y:k[1],z:k[2]},up:{x:0,y:0,z:1}};delete b.cameraposition}d(b.xaxis);d(b.yaxis);d(b.zaxis)}}var S=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<S;t++){var C=e.annotations[t];if(!o.isPlainObject(C))continue;if(C.ref){if(C.ref==="paper"){C.xref="paper";C.yref="paper"}else if(C.ref==="data"){C.xref="x";C.yref="y"}delete C.ref}p(C,"xref");p(C,"yref")}var L=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<L;t++){var I=e.shapes[t];if(!o.isPlainObject(I))continue;p(I,"xref");p(I,"yref")}var O=Array.isArray(e.images)?e.images.length:0;for(t=0;t<O;t++){var P=e.images[t];if(!o.isPlainObject(P))continue;p(P,"xref");p(P,"yref")}var D=e.legend;if(D){if(D.x>3){D.x=1.02;D.xanchor="left"}else if(D.x<-2){D.x=-.02;D.xanchor="right"}if(D.y>3){D.y=1.02;D.yanchor="bottom"}else if(D.y<-2){D.y=-.02;D.yanchor="top"}}d(e);if(e.dragmode==="rotate")e.dragmode="orbit";u.clean(e);if(e.template&&e.template.layout){r.cleanLayout(e.template.layout)}return e};function p(e,t){var r=e[t];var n=t.charAt(0);if(r&&r!=="paper"){e[t]=c(r,n,true)}}function d(e){if(e){if(typeof e.title==="string"||typeof e.title==="number"){e.title={text:e.title}}t("titlefont","font");t("titleposition","position");t("titleside","side");t("titleoffset","offset")}function t(t,r){var n=e[t];var a=e.title&&e.title[r];if(n&&!a){if(!e.title){e.title={}}e.title[r]=e[t];delete e[t]}}}r.cleanData=function(e){for(var t=0;t<e.length;t++){var n=e[t];var a;if(n.type==="histogramy"&&"xbins"in n&&!("ybins"in n)){n.ybins=n.xbins;delete n.xbins}if(n.error_y&&"opacity"in n.error_y){var l=u.defaults;var f=n.error_y.color||(h(n,"bar")?u.defaultLine:l[t%l.length]);n.error_y.color=u.addOpacity(u.rgb(f),u.opacity(f)*n.error_y.opacity);delete n.error_y.opacity}if("bardir"in n){if(n.bardir==="h"&&(h(n,"bar")||n.type.substr(0,9)==="histogram")){n.orientation="h";r.swapXYData(n)}delete n.bardir}if(n.type==="histogramy")r.swapXYData(n);if(n.type==="histogramx"||n.type==="histogramy"){n.type="histogram"}if("scl"in n&&!("colorscale"in n)){n.colorscale=n.scl;delete n.scl}if("reversescl"in n&&!("reversescale"in n)){n.reversescale=n.reversescl;delete n.reversescl}if(n.xaxis)n.xaxis=c(n.xaxis,"x");if(n.yaxis)n.yaxis=c(n.yaxis,"y");if(h(n,"gl3d")&&n.scene){n.scene=s.subplotsRegistry.gl3d.cleanId(n.scene)}if(!h(n,"pie-like")&&!h(n,"bar-like")){if(Array.isArray(n.textposition)){for(a=0;a<n.textposition.length;a++){n.textposition[a]=g(n.textposition[a])}}else if(n.textposition){n.textposition=g(n.textposition)}}var p=i.getModule(n);if(p&&p.colorbar){var x=p.colorbar.container;var _=x?n[x]:n;if(_&&_.colorscale){if(_.colorscale==="YIGnBu")_.colorscale="YlGnBu";if(_.colorscale==="YIOrRd")_.colorscale="YlOrRd"}}if(n.type==="surface"&&o.isPlainObject(n.contours)){var b=["x","y","z"];for(a=0;a<b.length;a++){var w=n.contours[b[a]];if(!o.isPlainObject(w))continue;if(w.highlightColor){w.highlightcolor=w.highlightColor;delete w.highlightColor}if(w.highlightWidth){w.highlightwidth=w.highlightWidth;delete w.highlightWidth}}}if(n.type==="candlestick"||n.type==="ohlc"){var T=(n.increasing||{}).showlegend!==false;var k=(n.decreasing||{}).showlegend!==false;var A=v(n.increasing);var M=v(n.decreasing);if(A!==false&&M!==false){var E=m(A,M,T,k);if(E)n.name=E}else if((A||M)&&!n.name){n.name=A||M}}if(Array.isArray(n.transforms)){var S=n.transforms;for(a=0;a<S.length;a++){var C=S[a];if(!o.isPlainObject(C))continue;switch(C.type){case"filter":if(C.filtersrc){C.target=C.filtersrc;delete C.filtersrc}if(C.calendar){if(!C.valuecalendar){C.valuecalendar=C.calendar}delete C.calendar}break;case"groupby":C.styles=C.styles||C.style;if(C.styles&&!Array.isArray(C.styles)){var L=C.styles;var I=Object.keys(L);C.styles=[];for(var O=0;O<I.length;O++){C.styles.push({target:I[O],value:L[I[O]]})}}break}}}if(y(n,"line"))delete n.line;if("marker"in n){if(y(n.marker,"line"))delete n.marker.line;if(y(n,"marker"))delete n.marker}u.clean(n);if(n.autobinx){delete n.autobinx;delete n.xbins}if(n.autobiny){delete n.autobiny;delete n.ybins}d(n);if(n.colorbar)d(n.colorbar);if(n.marker&&n.marker.colorbar)d(n.marker.colorbar);if(n.line&&n.line.colorbar)d(n.line.colorbar);if(n.aaxis)d(n.aaxis);if(n.baxis)d(n.baxis)}};function v(e){if(!o.isPlainObject(e))return false;var t=e.name;delete e.name;delete e.showlegend;return(typeof t==="string"||typeof t==="number")&&String(t)}function m(e,t,r,n){if(r&&!n)return e;if(n&&!r)return t;if(!e.trim())return t;if(!t.trim())return e;var a=Math.min(e.length,t.length);var i;for(i=0;i<a;i++){if(e.charAt(i)!==t.charAt(i))break}var o=e.substr(0,i);return o.trim()}function g(e){var t="middle";var r="center";if(typeof e==="string"){if(e.indexOf("top")!==-1)t="top";else if(e.indexOf("bottom")!==-1)t="bottom";if(e.indexOf("left")!==-1)r="left";else if(e.indexOf("right")!==-1)r="right"}return t+" "+r}function y(e,t){return t in e&&typeof e[t]==="object"&&Object.keys(e[t]).length===0}r.swapXYData=function(e){var t;o.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]);if(Array.isArray(e.z)&&Array.isArray(e.z[0])){if(e.transpose)delete e.transpose;else e.transpose=true}if(e.error_x&&e.error_y){var r=e.error_y;var n="copy_ystyle"in r?r.copy_ystyle:!(r.color||r.thickness||r.width);o.swapAttrs(e,["error_?.copy_ystyle"]);if(n){o.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}}if(typeof e.hoverinfo==="string"){var a=e.hoverinfo.split("+");for(t=0;t<a.length;t++){if(a[t]==="x")a[t]="y";else if(a[t]==="y")a[t]="x"}e.hoverinfo=a.join("+")}};r.coerceTraceIndices=function(e,t){if(n(t)){return[t]}else if(!Array.isArray(t)||!t.length){return e.data.map(function(e,t){return t})}else if(Array.isArray(t)){var r=[];for(var a=0;a<t.length;a++){if(o.isIndex(t[a],e.data.length)){r.push(t[a])}else{o.warn("trace index (",t[a],") is not a number or is out of bounds")}}return r}return t};r.manageArrayContainers=function(e,t,r){var a=e.obj;var i=e.parts;var s=i.length;var l=i[s-1];var u=n(l);if(u&&t===null){var c=i.slice(0,s-1).join(".");var f=o.nestedProperty(a,c).get();f.splice(l,1)}else if(u&&e.get()===undefined){if(e.get()===undefined)r[e.astr]=null;e.set(t)}else{e.set(t)}};var x=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function _(e){var t=e.search(x);if(t>0)return e.substr(0,t)}r.hasParent=function(e,t){var r=_(t);while(r){if(r in e)return true;r=_(r)}return false};var b=["x","y","z"];r.clearAxisTypes=function(e,t,r){for(var n=0;n<t.length;n++){var a=e._fullData[n];for(var i=0;i<3;i++){var s=f(e,a,b[i]);if(s&&s.type!=="log"){var l=s._name;var u=s._id.substr(1);if(u.substr(0,5)==="scene"){if(r[u]!==undefined)continue;l=u+"."+l}var c=l+".type";if(r[l]===undefined&&r[c]===undefined){o.nestedProperty(e.layout,c).set(null)}}}}}},{"../components/color":643,"../lib":778,"../plots/cartesian/axis_ids":831,"../plots/plots":891,"../registry":911,"fast-isnumeric":241,"gl-mat4/fromQuat":282}],812:[function(e,t,r){"use strict";var n=e("./plot_api");r.plot=n.plot;r.newPlot=n.newPlot;r.restyle=n.restyle;r.relayout=n.relayout;r.redraw=n.redraw;r.update=n.update;r._guiRestyle=n._guiRestyle;r._guiRelayout=n._guiRelayout;r._guiUpdate=n._guiUpdate;r._storeDirectGUIEdit=n._storeDirectGUIEdit;r.react=n.react;r.extendTraces=n.extendTraces;r.prependTraces=n.prependTraces;r.addTraces=n.addTraces;r.deleteTraces=n.deleteTraces;r.moveTraces=n.moveTraces;r.purge=n.purge;r.addFrames=n.addFrames;r.deleteFrames=n.deleteFrames;r.animate=n.animate;r.setPlotConfig=n.setPlotConfig;r.toImage=e("./to_image");r.validate=e("./validate");r.downloadImage=e("../snapshot/download");var a=e("./template_api");r.makeTemplate=a.makeTemplate;r.validateTemplate=a.validateTemplate},{"../snapshot/download":913,"./plot_api":814,"./template_api":819,"./to_image":820,"./validate":821}],813:[function(e,t,r){"use strict";var n=e("../lib/is_plain_object");var a=e("../lib/noop");var i=e("../lib/loggers");var o=e("../lib/search").sorterAsc;var s=e("../registry");r.containerArrayMatch=e("./container_array_match");var l=r.isAddVal=function e(t){return t==="add"||n(t)};var u=r.isRemoveVal=function e(t){return t===null||t==="remove"};r.applyContainerArrayChanges=function e(t,r,n,c,f){var h=r.astr;var p=s.getComponentMethod(h,"supplyLayoutDefaults");var d=s.getComponentMethod(h,"draw");var v=s.getComponentMethod(h,"drawOne");var m=c.replot||c.recalc||p===a||d===a;var g=t.layout;var y=t._fullLayout;if(n[""]){if(Object.keys(n).length>1){i.warn("Full array edits are incompatible with other edits",h)}var x=n[""][""];if(u(x))r.set(null);else if(Array.isArray(x))r.set(x);else{i.warn("Unrecognized full array edit value",h,x);return true}if(m)return false;p(g,y);d(t);return true}var _=Object.keys(n).map(Number).sort(o);var b=r.get();var w=b||[];var T=f(y,h).get();var k=[];var A=-1;var M=w.length;var E;var S;var C;var L;var I;var O;var P,D;for(E=0;E<_.length;E++){C=_[E];L=n[C];I=Object.keys(L);O=L[""],P=l(O);if(C<0||C>w.length-(P?0:1)){i.warn("index out of range",h,C);continue}if(O!==undefined){if(I.length>1){i.warn("Insertion & removal are incompatible with edits to the same index.",h,C)}if(u(O)){k.push(C)}else if(P){if(O==="add")O={};w.splice(C,0,O);if(T)T.splice(C,0,{})}else{i.warn("Unrecognized full object edit value",h,C,O)}if(A===-1)A=C}else{for(S=0;S<I.length;S++){D=h+"["+C+"].";f(w[C],I[S],D).set(L[I[S]])}}}for(E=k.length-1;E>=0;E--){w.splice(k[E],1);if(T)T.splice(k[E],1)}if(!w.length)r.set(null);else if(!b)r.set(w);if(m)return false;p(g,y);if(v!==a){var R;if(A===-1){R=_}else{M=Math.max(w.length,M);R=[];for(E=0;E<_.length;E++){C=_[E];if(C>=A)break;R.push(C)}for(E=A;E<M;E++){R.push(E)}}for(E=0;E<R.length;E++){v(t,R[E])}}else d(t);return true}},{"../lib/is_plain_object":779,"../lib/loggers":782,"../lib/noop":787,"../lib/search":798,"../registry":911,"./container_array_match":809}],814:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("has-hover");var o=e("../lib");var s=o.nestedProperty;var l=e("../lib/events");var u=e("../lib/queue");var c=e("../registry");var f=e("./plot_schema");var h=e("../plots/plots");var p=e("../plots/polar/legacy");var d=e("../plots/cartesian/axes");var v=e("../components/drawing");var m=e("../components/color");var g=e("../plots/cartesian/graph_interact").initInteractions;var y=e("../constants/xmlns_namespaces");var x=e("../lib/svg_text_utils");var _=e("../plots/cartesian/select").clearSelect;var b=e("./plot_config").dfltConfig;var w=e("./manage_arrays");var T=e("./helpers");var k=e("./subroutines");var A=e("./edit_types");var M=e("../plots/cartesian/constants").AX_NAME_PATTERN;var E=0;var S=5;function C(e,t,a,i){var s;e=o.getGraphDiv(e);l.init(e);if(o.isPlainObject(t)){var u=t;t=u.data;a=u.layout;i=u.config;s=u.frames}var f=l.triggerHandler(e,"plotly_beforeplot",[t,a,i]);if(f===false)return Promise.reject();if(!t&&!a&&!o.isPlotDiv(e)){o.warn("Calling Plotly.plot as if redrawing "+"but this container doesn't yet have a plot.",e)}function p(){if(s){return r.addFrames(e,s)}}D(e,i);if(!a)a={};n.select(e).classed("js-plotly-plot",true);v.makeTester();if(!Array.isArray(e._promises))e._promises=[];var m=(e.data||[]).length===0&&Array.isArray(t);if(Array.isArray(t)){T.cleanData(t);if(m)e.data=t;else e.data.push.apply(e.data,t);e.empty=false}if(!e.layout||m){e.layout=T.cleanLayout(a)}h.supplyDefaults(e);var y=e._fullLayout;var x=y._has("cartesian");if(!y._has("polar")&&t&&t[0]&&t[0].r){o.log("Legacy polar charts are deprecated!");return R(e,t,a)}y._replotting=true;if(m||y._shouldCreateBgLayer){Oe(e);if(y._shouldCreateBgLayer){delete y._shouldCreateBgLayer}}if(e.framework!==Oe){e.framework=Oe;Oe(e)}v.initGradients(e);if(m)d.saveShowSpikeInitial(e);var _=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;if(_)h.doCalcdata(e);for(var b=0;b<e.calcdata.length;b++){e.calcdata[b][0].trace=e._fullData[b]}if(e._context.responsive){if(!e._responsiveChartHandler){e._responsiveChartHandler=function(){if(!o.isHidden(e))h.resize(e)};window.addEventListener("resize",e._responsiveChartHandler)}}else{o.clearResponsive(e)}var w=o.extendFlat({},y._size);var A=0;function M(){var t=y._basePlotModules;for(var r=0;r<t.length;r++){if(t[r].drawFramework){t[r].drawFramework(e)}}if(!y._glcanvas&&y._has("gl")){y._glcanvas=y._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:true,pick:false},{key:"focusLayer",context:false,pick:false},{key:"pickLayer",context:false,pick:true}],function(e){return e.key});y._glcanvas.enter().append("canvas").attr("class",function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})}if(y._glcanvas){y._glcanvas.attr("width",y.width).attr("height",y.height);var n=y._glcanvas.data()[0].regl;if(n){if(Math.floor(y.width)!==n._gl.drawingBufferWidth||Math.floor(y.height)!==n._gl.drawingBufferHeight){var a="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(A){o.error(a)}else{o.log(a+" Clearing graph and plotting again.");h.cleanPlot([],{},e._fullData,y);h.supplyDefaults(e);y=e._fullLayout;h.doCalcdata(e);A++;return M()}}}}if(y.modebar.orientation==="h"){y._modebardiv.style("height",null).style("width","100%")}else{y._modebardiv.style("width",null).style("height",y.height+"px")}return h.previousPromises(e)}function E(){h.clearAutoMarginIds(e);k.drawMarginPushers(e);d.allowAutoMargin(e);if(y._has("pie")){var t=e._fullData;for(var r=0;r<t.length;r++){var n=t[r];if(n.type==="pie"&&n.automargin){h.allowAutoMargin(e,"pie."+n.uid+".automargin")}}}h.doAutoMargin(e);return h.previousPromises(e)}function S(){if(!h.didMarginChange(w,y._size))return;return o.syncOrAsync([E,k.layoutStyles],e)}function C(){if(!_){I();return}return o.syncOrAsync([c.getComponentMethod("shapes","calcAutorange"),c.getComponentMethod("annotations","calcAutorange"),I],e)}function I(){if(e._transitioning)return;k.doAutoRangeAndConstraints(e);if(m)d.saveRangeInitial(e);c.getComponentMethod("rangeslider","calcAutorange")(e)}function O(){return d.draw(e,m?"":"redraw")}var P=[h.previousPromises,p,M,E,S];if(x)P.push(C);P.push(k.layoutStyles);if(x){P.push(O,function e(t){if(t._fullLayout._insideTickLabelsAutorange){ae(t,t._fullLayout._insideTickLabelsAutorange).then(function(){t._fullLayout._insideTickLabelsAutorange=undefined})}})}P.push(k.drawData,k.finalDraw,g,h.addLinks,h.rehover,h.redrag,h.doAutoMargin,z,h.previousPromises);function z(e){if(e._fullLayout._insideTickLabelsAutorange){if(m)d.saveRangeInitial(e,true)}}var N=o.syncOrAsync(P,e);if(!N||!N.then)N=Promise.resolve();return N.then(function(){L(e);return e})}function L(e){var t=e._fullLayout;if(t._redrawFromAutoMarginCount){t._redrawFromAutoMarginCount--}else{e.emit("plotly_afterplot")}}function I(e){return o.extendFlat(b,e)}function O(e,t){try{e._fullLayout._paper.style("background",t)}catch(e){o.error(e)}}function P(e,t){var r=m.combine(t,"white");O(e,r)}function D(e,t){if(!e._context){e._context=o.extendDeep({},b);var r=n.select("base");e._context._baseUrl=r.size()&&r.attr("href")?window.location.href.split("#")[0]:""}var a=e._context;var s,l,u;if(t){l=Object.keys(t);for(s=0;s<l.length;s++){u=l[s];if(u==="editable"||u==="edits")continue;if(u in a){if(u==="setBackground"&&t[u]==="opaque"){a[u]=P}else{a[u]=t[u]}}}if(t.plot3dPixelRatio&&!a.plotGlPixelRatio){a.plotGlPixelRatio=a.plot3dPixelRatio}var c=t.editable;if(c!==undefined){a.editable=c;l=Object.keys(a.edits);for(s=0;s<l.length;s++){a.edits[l[s]]=c}}if(t.edits){l=Object.keys(t.edits);for(s=0;s<l.length;s++){u=l[s];if(u in a.edits){a.edits[u]=t.edits[u]}}}a._exportedPlot=t._exportedPlot}if(a.staticPlot){a.editable=false;a.edits={};a.autosizable=false;a.scrollZoom=false;a.doubleClick=false;a.showTips=false;a.showLink=false;a.displayModeBar=false}if(a.displayModeBar==="hover"&&!i){a.displayModeBar=true}if(a.setBackground==="transparent"||typeof a.setBackground!=="function"){a.setBackground=O}a._hasZeroHeight=a._hasZeroHeight||e.clientHeight===0;a._hasZeroWidth=a._hasZeroWidth||e.clientWidth===0;var f=a.scrollZoom;var h=a._scrollZoom={};if(f===true){h.cartesian=1;h.gl3d=1;h.geo=1;h.mapbox=1}else if(typeof f==="string"){var p=f.split("+");for(s=0;s<p.length;s++){h[p[s]]=1}}else if(f!==false){h.gl3d=1;h.geo=1;h.mapbox=1}}function R(e,t,r){var a=n.select(e).selectAll(".plot-container").data([0]);a.enter().insert("div",":first-child").classed("plot-container plotly",true);var i=a.selectAll(".svg-container").data([0]);i.enter().append("div").classed("svg-container",true).style("position","relative");i.html("");if(t)e.data=t;if(r)e.layout=r;p.manager.fillLayout(e);i.style({width:e._fullLayout.width+"px",height:e._fullLayout.height+"px"});e.framework=p.manager.framework(e);e.framework({data:e.data,layout:e.layout},i.node());e.framework.setUndoPoint();var s=e.framework.svg();var l=1;var u=e._fullLayout.title?e._fullLayout.title.text:"";if(u===""||!u)l=0;var c=function(){this.call(x.convertToTspans,e)};var f=s.select(".title-group text").call(c);if(e._context.edits.titleText){var d=o._(e,"Click to enter Plot title");if(!u||u===d){l=.2;f.attr({"data-unformatted":d}).text(d).style({opacity:l}).on("mouseover.opacity",function(){n.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(1e3).style("opacity",0)})}var v=function(){this.call(x.makeEditable,{gd:e}).on("edit",function(t){e.framework({layout:{title:{text:t}}});this.text(t).call(c);this.call(v)}).on("cancel",function(){var e=this.attr("data-unformatted");this.text(e).call(c)})};f.call(v)}e._context.setBackground(e,e._fullLayout.paper_bgcolor);h.addLinks(e);return Promise.resolve()}function z(e){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}T.cleanData(e.data);T.cleanLayout(e.layout);e.calcdata=undefined;return r.plot(e).then(function(){e.emit("plotly_redraw");return e})}function N(e,t,n,a){e=o.getGraphDiv(e);h.cleanPlot([],{},e._fullData||[],e._fullLayout||{});h.purge(e);return r.plot(e,t,n,a)}function F(e,t){var r=t+1;var n=[];var a;var i;for(a=0;a<e.length;a++){i=e[a];if(i<0){n.push(r+i)}else{n.push(i)}}return n}function B(e,t,r){var n,a;for(n=0;n<t.length;n++){a=t[n];if(a!==parseInt(a,10)){throw new Error("all values in "+r+" must be integers")}if(a>=e.data.length||a<-e.data.length){throw new Error(r+" must be valid indices for gd.data.")}if(t.indexOf(a,n+1)>-1||a>=0&&t.indexOf(-e.data.length+a)>-1||a<0&&t.indexOf(e.data.length+a)>-1){throw new Error("each index in "+r+" must be unique.")}}}function j(e,t,r){if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("currentIndices is a required argument.")}else if(!Array.isArray(t)){t=[t]}B(e,t,"currentIndices");if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"){B(e,r,"newIndices")}if(typeof r!=="undefined"&&t.length!==r.length){throw new Error("current and new indices must be of equal length.")}}function U(e,t,r){var n,a;if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("traces must be defined.")}if(!Array.isArray(t)){t=[t]}for(n=0;n<t.length;n++){a=t[n];if(typeof a!=="object"||(Array.isArray(a)||a===null)){throw new Error("all values in traces array must be non-array objects")}}if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"&&r.length!==t.length){throw new Error("if indices is specified, traces.length must equal indices.length")}}function H(e,t,r,n){var a=o.isPlainObject(n);if(!Array.isArray(e.data)){throw new Error("gd.data must be an array")}if(!o.isPlainObject(t)){throw new Error("update must be a key:value object")}if(typeof r==="undefined"){throw new Error("indices must be an integer or array of integers")}B(e,r,"indices");for(var i in t){if(!Array.isArray(t[i])||t[i].length!==r.length){throw new Error("attribute "+i+" must be an array of length equal to indices array length")}if(a&&(!(i in n)||!Array.isArray(n[i])||n[i].length!==t[i].length)){throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 "+"corrispondence with the keys and number of traces in the update object")}}}function V(e,t,r,n){var i=o.isPlainObject(n);var l=[];var u,c,f,h,p;if(!Array.isArray(r))r=[r];r=F(r,e.data.length-1);for(var d in t){for(var v=0;v<r.length;v++){u=e.data[r[v]];f=s(u,d);c=f.get();h=t[d][v];if(!o.isArrayOrTypedArray(h)){throw new Error("attribute: "+d+" index: "+v+" must be an array")}if(!o.isArrayOrTypedArray(c)){throw new Error("cannot extend missing or non-array attribute: "+d)}if(c.constructor!==h.constructor){throw new Error("cannot extend array with an array of a different type: "+d)}p=i?n[d][v]:n;if(!a(p))p=-1;l.push({prop:f,target:c,insert:h,maxp:Math.floor(p)})}}return l}function G(e,t,r,n,a){H(e,t,r,n);var i=V(e,t,r,n);var o={};var s={};for(var l=0;l<i.length;l++){var u=i[l].prop;var c=i[l].maxp;var f=a(i[l].target,i[l].insert,c);u.set(f[0]);if(!Array.isArray(o[u.astr]))o[u.astr]=[];o[u.astr].push(f[1]);if(!Array.isArray(s[u.astr]))s[u.astr]=[];s[u.astr].push(i[l].target.length)}return{update:o,maxPoints:s}}function q(e,t){var r=new e.constructor(e.length+t.length);r.set(e);r.set(t,e.length);return r}function Y(e,t,n,a){e=o.getGraphDiv(e);function i(e,t,r){var n,a;if(o.isTypedArray(e)){if(r<0){var i=new e.constructor(0);var s=q(e,t);if(r<0){n=s;a=i}else{n=i;a=s}}else{n=new e.constructor(r);a=new e.constructor(e.length+t.length-r);if(r===t.length){n.set(t);a.set(e)}else if(r<t.length){var l=t.length-r;n.set(t.subarray(l));a.set(e);a.set(t.subarray(0,l),e.length)}else{var u=r-t.length;var c=e.length-u;n.set(e.subarray(c));n.set(t,u);a.set(e.subarray(0,c))}}}else{n=e.concat(t);a=r>=0&&r<n.length?n.splice(0,n.length-r):[]}return[n,a]}var s=G(e,t,n,a,i);var l=r.redraw(e);var c=[e,s.update,n,s.maxPoints];u.add(e,r.prependTraces,c,Y,arguments);return l}function W(e,t,n,a){e=o.getGraphDiv(e);function i(e,t,r){var n,a;if(o.isTypedArray(e)){if(r<=0){var i=new e.constructor(0);var s=q(t,e);if(r<0){n=s;a=i}else{n=i;a=s}}else{n=new e.constructor(r);a=new e.constructor(e.length+t.length-r);if(r===t.length){n.set(t);a.set(e)}else if(r<t.length){var l=t.length-r;n.set(t.subarray(0,l));a.set(t.subarray(l));a.set(e,l)}else{var u=r-t.length;n.set(t);n.set(e.subarray(0,u),t.length);a.set(e.subarray(u))}}}else{n=t.concat(e);a=r>=0&&r<n.length?n.splice(r,n.length):[]}return[n,a]}var s=G(e,t,n,a,i);var l=r.redraw(e);var c=[e,s.update,n,s.maxPoints];u.add(e,r.extendTraces,c,W,arguments);return l}function X(e,t,n){e=o.getGraphDiv(e);var a=[];var i=r.deleteTraces;var s=X;var l=[e,a];var c=[e,t];var f;var h;U(e,t,n);if(!Array.isArray(t)){t=[t]}t=t.map(function(e){return o.extendFlat({},e)});T.cleanData(t);for(f=0;f<t.length;f++){e.data.push(t[f])}for(f=0;f<t.length;f++){a.push(-t.length+f)}if(typeof n==="undefined"){h=r.redraw(e);u.add(e,i,l,s,c);return h}if(!Array.isArray(n)){n=[n]}try{j(e,a,n)}catch(r){e.data.splice(e.data.length-t.length,t.length);throw r}u.startSequence(e);u.add(e,i,l,s,c);h=r.moveTraces(e,a,n);u.stopSequence(e);return h}function Z(e,t){e=o.getGraphDiv(e);var n=[];var a=r.addTraces;var i=Z;var s=[e,n,t];var l=[e,t];var c;var f;if(typeof t==="undefined"){throw new Error("indices must be an integer or array of integers.")}else if(!Array.isArray(t)){t=[t]}B(e,t,"indices");t=F(t,e.data.length-1);t.sort(o.sorterDes);for(c=0;c<t.length;c+=1){f=e.data.splice(t[c],1)[0];n.push(f)}var h=r.redraw(e);u.add(e,a,s,i,l);return h}function K(e,t,n){e=o.getGraphDiv(e);var a=[];var i=[];var s=K;var l=K;var c=[e,n,t];var f=[e,t,n];var h;j(e,t,n);t=Array.isArray(t)?t:[t];if(typeof n==="undefined"){n=[];for(h=0;h<t.length;h++){n.push(-t.length+h)}}n=Array.isArray(n)?n:[n];t=F(t,e.data.length-1);n=F(n,e.data.length-1);for(h=0;h<e.data.length;h++){if(t.indexOf(h)===-1){a.push(e.data[h])}}for(h=0;h<t.length;h++){i.push({newIndex:n[h],trace:e.data[t[h]]})}i.sort(function(e,t){return e.newIndex-t.newIndex});for(h=0;h<i.length;h+=1){a.splice(i[h].newIndex,0,i[h].trace)}e.data=a;var p=r.redraw(e);u.add(e,s,c,l,f);return p}function J(e,t,n,a){e=o.getGraphDiv(e);T.clearPromiseQueue(e);var i={};if(typeof t==="string")i[t]=n;else if(o.isPlainObject(t)){i=o.extendFlat({},t);if(a===undefined)a=n}else{o.warn("Restyle fail.",t,n,a);return Promise.reject()}if(Object.keys(i).length)e.changed=true;var s=T.coerceTraceIndices(e,a);var l=re(e,i,s);var c=l.flags;if(c.calc)e.calcdata=undefined;if(c.clearAxisTypes)T.clearAxisTypes(e,s,{});var f=[];if(c.fullReplot){f.push(r.plot)}else{f.push(h.previousPromises);h.supplyDefaults(e);if(c.markerSize){h.doCalcdata(e);oe(f)}if(c.style)f.push(k.doTraceStyle);if(c.colorbars)f.push(k.doColorBars);f.push(L)}f.push(h.rehover,h.redrag);u.add(e,J,[e,l.undoit,l.traces],J,[e,l.redoit,l.traces]);var p=o.syncOrAsync(f,e);if(!p||!p.then)p=Promise.resolve();return p.then(function(){e.emit("plotly_restyle",l.eventData);return e})}function Q(e){if(e===undefined)return null;return e}function $(e,t){if(!t)return s;return function(t,r,n){var a=s(t,r);var i=a.set;a.set=function(t){var o=(n||"")+r;ee(o,a.get(),t,e);i(t)};return a}}function ee(e,t,r,n){if(Array.isArray(t)||Array.isArray(r)){var a=Array.isArray(t)?t:[];var i=Array.isArray(r)?r:[];var s=Math.max(a.length,i.length);for(var l=0;l<s;l++){ee(e+"["+l+"]",a[l],i[l],n)}}else if(o.isPlainObject(t)||o.isPlainObject(r)){var u=o.isPlainObject(t)?t:{};var c=o.isPlainObject(r)?r:{};var f=o.extendFlat({},u,c);for(var h in f){ee(e+"."+h,u[h],c[h],n)}}else if(n[e]===undefined){n[e]=Q(t)}}function te(e,t,r){for(var n in r){var a=s(e,n);ee(n,a.get(),r[n],t)}}function re(e,t,r){var n=e._fullLayout;var a=e._fullData;var i=e.data;var l=n._guiEditing;var u=$(n._preGUI,l);var p=o.extendDeepAll({},t);var v;ne(t);var m=A.traceFlags();var g={};var y={};var x;function _(){return r.map(function(){return undefined})}function b(e){var t=d.id2name(e);if(x.indexOf(t)===-1)x.push(t)}function w(e){return"LAYOUT"+e+".autorange"}function k(e){return"LAYOUT"+e+".range"}function M(e){for(var t=e;t<a.length;t++){if(a[t]._input===i[e])return a[t]}}function E(a,o,s){if(Array.isArray(a)){a.forEach(function(e){E(e,o,s)});return}if(a in t||T.hasParent(t,a))return;var c;if(a.substr(0,6)==="LAYOUT"){c=u(e.layout,a.replace("LAYOUT",""))}else{var f=r[s];var h=n._tracePreGUI[M(f)._fullInput.uid];c=$(h,l)(i[f],a)}if(!(a in y)){y[a]=_()}if(y[a][s]===undefined){y[a][s]=Q(c.get())}if(o!==undefined){c.set(o)}}function S(e){return function(t){return a[t][e]}}function C(e){return function(t,n){return t===false?a[r[n]][e]:null}}for(var L in t){if(T.hasParent(t,L)){throw new Error("cannot set "+L+" and a parent attribute simultaneously")}var I=t[L];var O;var P;var D;var R;var z;var N;if(L==="autobinx"||L==="autobiny"){L=L.charAt(L.length-1)+"bins";if(Array.isArray(I))I=I.map(C(L));else if(I===false)I=r.map(S(L));else I=null}g[L]=I;if(L.substr(0,6)==="LAYOUT"){D=u(e.layout,L.replace("LAYOUT",""));y[L]=[Q(D.get())];D.set(Array.isArray(I)?I[0]:I);m.calc=true;continue}y[L]=_();for(v=0;v<r.length;v++){O=i[r[v]];P=M(r[v]);var F=n._tracePreGUI[P._fullInput.uid];D=$(F,l)(O,L);R=D.get();z=Array.isArray(I)?I[v%I.length]:I;if(z===undefined)continue;var B=D.parts[D.parts.length-1];var j=L.substr(0,L.length-B.length-1);var U=j?j+".":"";var H=j?s(P,j).get():P;N=f.getTraceValObject(P,D.parts);if(N&&N.impliedEdits&&z!==null){for(var V in N.impliedEdits){E(o.relativeAttr(L,V),N.impliedEdits[V],v)}}else if((B==="thicknessmode"||B==="lenmode")&&R!==z&&(z==="fraction"||z==="pixels")&&H){var G=n._size;var q=H.orient;var Y=q==="top"||q==="bottom";if(B==="thicknessmode"){var W=Y?G.h:G.w;E(U+"thickness",H.thickness*(z==="fraction"?1/W:W),v)}else{var X=Y?G.w:G.h;E(U+"len",H.len*(z==="fraction"?1/X:X),v)}}else if(L==="type"&&(z==="pie"!==(R==="pie")||z==="funnelarea"!==(R==="funnelarea"))){var Z="x";var K="y";if((z==="bar"||R==="bar")&&O.orientation==="h"){Z="y";K="x"}o.swapAttrs(O,["?","?src"],"labels",Z);o.swapAttrs(O,["d?","?0"],"label",Z);o.swapAttrs(O,["?","?src"],"values",K);if(R==="pie"||R==="funnelarea"){s(O,"marker.color").set(s(O,"marker.colors").get());n._pielayer.selectAll("g.trace").remove()}else if(c.traceIs(O,"cartesian")){s(O,"marker.colors").set(s(O,"marker.color").get())}}y[L][v]=Q(R);var J=["swapxy","swapxyaxes","orientation","orientationaxes"];if(J.indexOf(L)!==-1){if(L==="orientation"){D.set(z);var ee=O.x&&!O.y?"h":"v";if((D.get()||ee)===P.orientation){continue}}else if(L==="orientationaxes"){O.orientation={v:"h",h:"v"}[P.orientation]}T.swapXYData(O);m.calc=m.clearAxisTypes=true}else if(h.dataArrayContainers.indexOf(D.parts[0])!==-1){T.manageArrayContainers(D,z,y);m.calc=true}else{if(N){if(N.arrayOk&&!c.traceIs(P,"regl")&&(o.isArrayOrTypedArray(z)||o.isArrayOrTypedArray(R))){m.calc=true}else A.update(m,N)}else{m.calc=true}D.set(z)}}if(["swapxyaxes","orientationaxes"].indexOf(L)!==-1){d.swap(e,r)}if(L==="orientationaxes"){var te=s(e.layout,"hovermode");var re=te.get();if(re==="x"){te.set("y")}else if(re==="y"){te.set("x")}else if(re==="x unified"){te.set("y unified")}else if(re==="y unified"){te.set("x unified")}}if(["orientation","type"].indexOf(L)!==-1){x=[];for(v=0;v<r.length;v++){var ae=i[r[v]];if(c.traceIs(ae,"cartesian")){b(ae.xaxis||"x");b(ae.yaxis||"y")}}E(x.map(w),true,0);E(x.map(k),[0,1],0)}}if(m.calc||m.plot){m.fullReplot=true}return{flags:m,undoit:y,redoit:g,traces:r,eventData:o.extendDeepNoArrays([],[p,r])}}function ne(e){var t=o.counterRegex("axis",".title",false,false);var r=/colorbar\.title$/;var n=Object.keys(e);var a,i,s;for(a=0;a<n.length;a++){i=n[a];s=e[i];if((i==="title"||t.test(i)||r.test(i))&&(typeof s==="string"||typeof s==="number")){l(i,i.replace("title","title.text"))}else if(i.indexOf("titlefont")>-1){l(i,i.replace("titlefont","title.font"))}else if(i.indexOf("titleposition")>-1){l(i,i.replace("titleposition","title.position"))}else if(i.indexOf("titleside")>-1){l(i,i.replace("titleside","title.side"))}else if(i.indexOf("titleoffset")>-1){l(i,i.replace("titleoffset","title.offset"))}}function l(t,r){e[r]=e[t];delete e[t]}}function ae(e,t,r){e=o.getGraphDiv(e);T.clearPromiseQueue(e);if(e.framework&&e.framework.isPolar){return Promise.resolve(e)}var n={};if(typeof t==="string"){n[t]=r}else if(o.isPlainObject(t)){n=o.extendFlat({},t)}else{o.warn("Relayout fail.",t,r);return Promise.reject()}if(Object.keys(n).length)e.changed=true;var a=ce(e,n);var i=a.flags;if(i.calc)e.calcdata=undefined;var s=[h.previousPromises];if(i.layoutReplot){s.push(k.layoutReplot)}else if(Object.keys(n).length){ie(e,i,a)||h.supplyDefaults(e);if(i.legend)s.push(k.doLegend);if(i.layoutstyle)s.push(k.layoutStyles);if(i.axrange)oe(s,a.rangesAltered);if(i.ticks)s.push(k.doTicksRelayout);if(i.modebar)s.push(k.doModeBar);if(i.camera)s.push(k.doCamera);if(i.colorbars)s.push(k.doColorBars);s.push(L)}s.push(h.rehover,h.redrag);u.add(e,ae,[e,a.undoit],ae,[e,a.redoit]);var l=o.syncOrAsync(s,e);if(!l||!l.then)l=Promise.resolve(e);return l.then(function(){e.emit("plotly_relayout",a.eventData);return e})}function ie(e,t,r){var n=e._fullLayout;if(!t.axrange)return false;for(var a in t){if(a!=="axrange"&&t[a])return false}for(var i in r.rangesAltered){var o=d.id2name(i);var s=e.layout[o];var l=n[o];l.autorange=s.autorange;if(s.range){l.range=s.range.slice()}l.cleanRange();if(l._matchGroup){for(var u in l._matchGroup){if(u!==i){var c=n[d.id2name(u)];c.autorange=l.autorange;c.range=l.range.slice();c._input.range=l.range.slice()}}}}return true}function oe(e,t){var r=t?function(e){var r=[];var n=true;for(var a in t){var i=d.getFromId(e,a);r.push(a);if((i.ticklabelposition||"").indexOf("inside")!==-1){if(i._anchorAxis){r.push(i._anchorAxis._id)}}if(i._matchGroup){for(var o in i._matchGroup){if(!t[o]){r.push(o)}}}if(i.automargin)n=false}return d.draw(e,r,{skipTitle:n})}:function(e){return d.draw(e,"redraw")};e.push(_,k.doAutoRangeAndConstraints,r,k.drawData,k.finalDraw)}var se=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/;var le=/^[xyz]axis[0-9]*\.autorange$/;var ue=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function ce(e,t){var r=e.layout;var n=e._fullLayout;var a=n._guiEditing;var i=$(n._preGUI,a);var l=Object.keys(t);var u=d.list(e);var h=o.extendDeepAll({},t);var p={};var v,m,g;ne(t);l=Object.keys(t);for(m=0;m<l.length;m++){if(l[m].indexOf("allaxes")===0){for(g=0;g<u.length;g++){var y=u[g]._id.substr(1);var x=y.indexOf("scene")!==-1?y+".":"";var _=l[m].replace("allaxes",x+u[g]._name);if(!t[_])t[_]=t[l[m]]}delete t[l[m]]}}var b=A.layoutFlags();var k={};var E={};function S(e,n){if(Array.isArray(e)){e.forEach(function(e){S(e,n)});return}if(e in t||T.hasParent(t,e))return;var a=i(r,e);if(!(e in E)){E[e]=Q(a.get())}if(n!==undefined)a.set(n)}var C={};var L;function I(e){var t=d.name2id(e.split(".")[0]);C[t]=1;return t}for(var O in t){if(T.hasParent(t,O)){throw new Error("cannot set "+O+" and a parent attribute simultaneously")}var P=i(r,O);var D=t[O];var R=P.parts.length;var z=R-1;while(z>0&&typeof P.parts[z]!=="string")z--;var N=P.parts[z];var F=P.parts[z-1]+"."+N;var B=P.parts.slice(0,z).join(".");var j=s(e.layout,B).get();var U=s(n,B).get();var H=P.get();if(D===undefined)continue;k[O]=D;E[O]=N==="reverse"?D:Q(H);var V=f.getLayoutValObject(n,P.parts);if(V&&V.impliedEdits&&D!==null){for(var G in V.impliedEdits){S(o.relativeAttr(O,G),V.impliedEdits[G])}}if(["width","height"].indexOf(O)!==-1){if(D){S("autosize",null);var q=O==="height"?"width":"height";S(q,n[q])}else{n[O]=e._initialAutoSize[O]}}else if(O==="autosize"){S("width",D?null:n.width);S("height",D?null:n.height)}else if(F.match(se)){I(F);s(n,B+"._inputRange").set(null)}else if(F.match(le)){I(F);s(n,B+"._inputRange").set(null);var Y=s(n,B).get();if(Y._inputDomain){Y._input.domain=Y._inputDomain.slice()}}else if(F.match(ue)){s(n,B+"._inputDomain").set(null)}if(N==="type"){L=j;var W=U.type==="linear"&&D==="log";var X=U.type==="log"&&D==="linear";if(W||X){if(!L||!L.range){S(B+".autorange",true)}else if(!U.autorange){var Z=L.range[0];var K=L.range[1];if(W){if(Z<=0&&K<=0){S(B+".autorange",true)}if(Z<=0)Z=K/1e6;else if(K<=0)K=Z/1e6;S(B+".range[0]",Math.log(Z)/Math.LN10);S(B+".range[1]",Math.log(K)/Math.LN10)}else{S(B+".range[0]",Math.pow(10,Z));S(B+".range[1]",Math.pow(10,K))}}else if(W){L.range=L.range[1]>L.range[0]?[1,2]:[2,1]}if(Array.isArray(n._subplots.polar)&&n._subplots.polar.length&&n[P.parts[0]]&&P.parts[1]==="radialaxis"){delete n[P.parts[0]]._subplot.viewInitial["radialaxis.range"]}c.getComponentMethod("annotations","convertCoords")(e,U,D,S);c.getComponentMethod("images","convertCoords")(e,U,D,S)}else{S(B+".autorange",true);S(B+".range",null)}s(n,B+"._inputRange").set(null)}else if(N.match(M)){var J=s(n,O).get();var ee=(D||{}).type;if(!ee||ee==="-")ee="linear";c.getComponentMethod("annotations","convertCoords")(e,J,ee,S);c.getComponentMethod("images","convertCoords")(e,J,ee,S)}var te=w.containerArrayMatch(O);if(te){v=te.array;m=te.index;var re=te.property;var ae=V||{editType:"calc"};if(m!==""&&re===""){if(w.isAddVal(D)){E[O]=null}else if(w.isRemoveVal(D)){E[O]=(s(r,v).get()||[])[m]}else{o.warn("unrecognized full object value",t)}}A.update(b,ae);if(!p[v])p[v]={};var ie=p[v][m];if(!ie)ie=p[v][m]={};ie[re]=D;delete t[O]}else if(N==="reverse"){if(j.range)j.range.reverse();else{S(B+".autorange",true);j.range=[1,0]}if(U.autorange)b.calc=true;else b.plot=true}else{if(n._has("scatter-like")&&n._has("regl")&&(O==="dragmode"&&(D==="lasso"||D==="select")&&!(H==="lasso"||H==="select"))){b.plot=true}else if(n._has("gl2d")){b.plot=true}else if(V)A.update(b,V);else b.calc=true;P.set(D)}}for(v in p){var oe=w.applyContainerArrayChanges(e,i(r,v),p[v],b,i);if(!oe)b.plot=true}for(var ce in C){L=d.getFromId(e,ce);var he=L&&L._constraintGroup;if(he){b.calc=true;for(var pe in he){if(!C[pe]){d.getFromId(e,pe)._constraintShrinkable=true}}}}if(fe(e)||t.height||t.width)b.plot=true;if(b.plot||b.calc){b.layoutReplot=true}return{flags:b,rangesAltered:C,undoit:E,redoit:k,eventData:h}}function fe(e){var t=e._fullLayout;var r=t.width;var n=t.height;if(e.layout.autosize)h.plotAutoSize(e,e.layout,t);return t.width!==r||t.height!==n}function he(e,t,n,a){e=o.getGraphDiv(e);T.clearPromiseQueue(e);if(e.framework&&e.framework.isPolar){return Promise.resolve(e)}if(!o.isPlainObject(t))t={};if(!o.isPlainObject(n))n={};if(Object.keys(t).length)e.changed=true;if(Object.keys(n).length)e.changed=true;var i=T.coerceTraceIndices(e,a);var s=re(e,o.extendFlat({},t),i);var l=s.flags;var c=ce(e,o.extendFlat({},n));var f=c.flags;if(l.calc||f.calc)e.calcdata=undefined;if(l.clearAxisTypes)T.clearAxisTypes(e,i,n);var p=[];if(f.layoutReplot){p.push(k.layoutReplot)}else if(l.fullReplot){p.push(r.plot)}else{p.push(h.previousPromises);ie(e,f,c)||h.supplyDefaults(e);if(l.style)p.push(k.doTraceStyle);if(l.colorbars||f.colorbars)p.push(k.doColorBars);if(f.legend)p.push(k.doLegend);if(f.layoutstyle)p.push(k.layoutStyles);if(f.axrange)oe(p,c.rangesAltered);if(f.ticks)p.push(k.doTicksRelayout);if(f.modebar)p.push(k.doModeBar);if(f.camera)p.push(k.doCamera);p.push(L)}p.push(h.rehover,h.redrag);u.add(e,he,[e,s.undoit,c.undoit,s.traces],he,[e,s.redoit,c.redoit,s.traces]);var d=o.syncOrAsync(p,e);if(!d||!d.then)d=Promise.resolve(e);return d.then(function(){e.emit("plotly_update",{data:s.eventData,layout:c.eventData});return e})}function pe(e){return function t(r){r._fullLayout._guiEditing=true;var n=e.apply(null,arguments);r._fullLayout._guiEditing=false;return n}}var de=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}];var ve=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];var a=e.match(n.pattern);if(a){return{head:a[1],attr:n.attr}}}}function ge(e,t){var r=s(t,e).get();if(r!==undefined)return r;var n=e.split(".");n.pop();while(n.length>1){n.pop();r=s(t,n.join(".")+".uirevision").get();if(r!==undefined)return r}return t.uirevision}function ye(e,t){for(var r=0;r<t.length;r++){if(t[r]._fullInput.uid===e)return r}return-1}function xe(e,t,r){for(var n=0;n<t.length;n++){if(t[n].uid===e)return n}return!t[r]||t[r].uid?-1:r}function _e(e,t){var r=o.isPlainObject(e);var n=Array.isArray(e);if(r||n){return(r&&o.isPlainObject(t)||n&&Array.isArray(t))&&JSON.stringify(e)===JSON.stringify(t)}return e===t}function be(e,t,r,n){var a=n._preGUI;var i,l,u,c,f,h,p,d;var v=[];var m={};for(i in a){f=me(i,de);if(f){l=f.attr||f.head+".uirevision";u=s(n,l).get();c=u&&ge(l,t);if(c&&c===u){h=a[i];if(h===null)h=undefined;p=s(t,i);d=p.get();if(_e(d,h)){if(d===undefined&&i.substr(i.length-9)==="autorange"){v.push(i.substr(0,i.length-10))}p.set(Q(s(n,i).get()));continue}}}else{o.warn("unrecognized GUI edit: "+i)}delete a[i];if(i.substr(i.length-8,6)==="range["){m[i.substr(0,i.length-9)]=1}}for(var g=0;g<v.length;g++){var y=v[g];if(m[y]){var x=s(t,y).get();if(x)delete x.autorange}}var _=n._tracePreGUI;for(var b in _){var w=_[b];var T=null;var k;for(i in w){if(!T){var A=ye(b,r);if(A<0){delete _[b];break}var M=r[A];k=M._fullInput;var E=xe(b,e,k.index);if(E<0){delete _[b];break}T=e[E]}f=me(i,ve);if(f){if(f.attr){u=s(n,f.attr).get();c=u&&ge(f.attr,t)}else{u=k.uirevision;c=T.uirevision;if(c===undefined)c=t.uirevision}if(c&&c===u){h=w[i];if(h===null)h=undefined;p=s(T,i);d=p.get();if(_e(d,h)){p.set(Q(s(k,i).get()));continue}}}else{o.warn("unrecognized GUI edit: "+i+" in trace uid "+b)}delete w[i]}}}function we(e,t,n,a){var i,s;function l(){return r.addFrames(e,i)}e=o.getGraphDiv(e);T.clearPromiseQueue(e);var u=e._fullData;var f=e._fullLayout;if(!o.isPlotDiv(e)||!u||!f){s=r.newPlot(e,t,n,a)}else{if(o.isPlainObject(t)){var p=t;t=p.data;n=p.layout;a=p.config;i=p.frames}var d=false;if(a){var v=o.extendDeep({},e._context);e._context=undefined;D(e,a);d=Me(v,e._context)}e.data=t||[];T.cleanData(e.data);e.layout=n||{};T.cleanLayout(e.layout);be(e.data,e.layout,u,f);h.supplyDefaults(e,{skipUpdateCalc:true});var m=e._fullData;var g=e._fullLayout;var y=g.datarevision===undefined;var x=g.transition;var _=ke(e,f,g,y,x);var b=_.newDataRevision;var w=Te(e,u,m,y,x,b);if(fe(e))_.layoutReplot=true;if(w.calc||_.calc){e.calcdata=undefined;var A=Object.getOwnPropertyNames(g);for(var M=0;M<A.length;M++){var E=A[M];var S=E.substring(0,5);if(S==="xaxis"||S==="yaxis"){var C=g[E]._emptyCategories;if(C)C()}}}else{h.supplyDefaultsUpdateCalc(e.calcdata,m)}var I=[];if(i){e._transitionData={};h.createTransitionData(e);I.push(l)}if(g.transition&&!d&&(w.anim||_.anim)){if(_.ticks)I.push(k.doTicksRelayout);h.doCalcdata(e);k.doAutoRangeAndConstraints(e);I.push(function(){return h.transitionFromReact(e,w,_,f)})}else if(w.fullReplot||_.layoutReplot||d){e._fullLayout._skipDefaults=true;I.push(r.plot)}else{for(var O in _.arrays){var P=_.arrays[O];if(P.length){var R=c.getComponentMethod(O,"drawOne");if(R!==o.noop){for(var z=0;z<P.length;z++){R(e,P[z])}}else{var N=c.getComponentMethod(O,"draw");if(N===o.noop){throw new Error("cannot draw components: "+O)}N(e)}}}I.push(h.previousPromises);if(w.style)I.push(k.doTraceStyle);if(w.colorbars||_.colorbars)I.push(k.doColorBars);if(_.legend)I.push(k.doLegend);if(_.layoutstyle)I.push(k.layoutStyles);if(_.axrange)oe(I);if(_.ticks)I.push(k.doTicksRelayout);if(_.modebar)I.push(k.doModeBar);if(_.camera)I.push(k.doCamera);I.push(L)}I.push(h.rehover,h.redrag);s=o.syncOrAsync(I,e);if(!s||!s.then)s=Promise.resolve(e)}return s.then(function(){e.emit("plotly_react",{data:t,layout:n});return e})}function Te(e,t,r,n,a,i){var o=t.length===r.length;if(!a&&!o){return{fullReplot:true,calc:true}}var s=A.traceFlags();s.arrays={};s.nChanges=0;s.nChangesAnim=0;var l,u;function c(e){var t=f.getTraceValObject(u,e);if(!u._module.animatable&&t.anim){t.anim=false}return t}var p={getValObject:c,flags:s,immutable:n,transition:a,newDataRevision:i,gd:e};var d={};for(l=0;l<t.length;l++){if(r[l]){u=r[l]._fullInput;if(h.hasMakesDataTransform(u))u=r[l];if(d[u.uid])continue;d[u.uid]=1;Ae(t[l]._fullInput,u,[],p)}}if(s.calc||s.plot){s.fullReplot=true}if(a&&s.nChanges&&s.nChangesAnim){s.anim=s.nChanges===s.nChangesAnim&&o?"all":"some"}return s}function ke(e,t,r,n,a){var i=A.layoutFlags();i.arrays={};i.rangesAltered={};i.nChanges=0;i.nChangesAnim=0;function o(e){return f.getLayoutValObject(r,e)}var s={getValObject:o,flags:i,immutable:n,transition:a,gd:e};Ae(t,r,[],s);if(i.plot||i.calc){i.layoutReplot=true}if(a&&i.nChanges&&i.nChangesAnim){i.anim=i.nChanges===i.nChangesAnim?"all":"some"}return i}function Ae(e,t,r,n){var a,i,l;var u=n.getValObject;var c=n.flags;var f=n.immutable;var h=n.inArray;var p=n.arrayIndex;function d(){var e=a.editType;if(h&&e.indexOf("arraydraw")!==-1){o.pushUnique(c.arrays[h],p);return}A.update(c,a);if(e!=="none"){c.nChanges++}if(n.transition&&a.anim){c.nChangesAnim++}if(se.test(l)||le.test(l)){c.rangesAltered[r[0]]=1}if(ue.test(l)){s(t,"_inputDomain").set(null)}if(i==="datarevision"){c.newDataRevision=1}}function v(e){return e.valType==="data_array"||e.arrayOk}for(i in e){if(c.calc&&!n.transition)return;var m=e[i];var g=t[i];var y=r.concat(i);l=y.join(".");if(i.charAt(0)==="_"||typeof m==="function"||m===g)continue;if((i==="tick0"||i==="dtick")&&r[0]!=="geo"){var x=t.tickmode;if(x==="auto"||x==="array"||!x)continue}if(i==="range"&&t.autorange)continue;if((i==="zmin"||i==="zmax")&&t.type==="contourcarpet")continue;a=u(y);if(!a)continue;if(a._compareAsJSON&&JSON.stringify(m)===JSON.stringify(g))continue;var _=a.valType;var b;var w=v(a);var T=Array.isArray(m);var k=Array.isArray(g);if(T&&k){var M="_input_"+i;var E=e[M];var S=t[M];if(Array.isArray(E)&&E===S)continue}if(g===undefined){if(w&&T)c.calc=true;else d()}else if(a._isLinkedToArray){var C=[];var L=false;if(!h)c.arrays[i]=C;var I=Math.min(m.length,g.length);var O=Math.max(m.length,g.length);if(I!==O){if(a.editType==="arraydraw"){L=true}else{d();continue}}for(b=0;b<I;b++){Ae(m[b],g[b],y.concat(b),o.extendFlat({inArray:i,arrayIndex:b},n))}if(L){for(b=I;b<O;b++){C.push(b)}}}else if(!_&&o.isPlainObject(m)){Ae(m,g,y,n)}else if(w){if(T&&k){if(f){c.calc=true}if(f||n.newDataRevision){d()}}else if(T!==k){c.calc=true}else d()}else if(T&&k){if(m.length!==g.length||String(m)!==String(g)){d()}}else{d()}}for(i in t){if(!(i in e||i.charAt(0)==="_"||typeof t[i]==="function")){a=u(r.concat(i));if(v(a)&&Array.isArray(t[i])){c.calc=true;return}else d()}}}function Me(e,t){var r;for(r in e){if(r.charAt(0)==="_")continue;var n=e[r];var a=t[r];if(n!==a){if(o.isPlainObject(n)&&o.isPlainObject(a)){if(Me(n,a)){return true}}else if(Array.isArray(n)&&Array.isArray(a)){if(n.length!==a.length){return true}for(var i=0;i<n.length;i++){if(n[i]!==a[i]){if(o.isPlainObject(n[i])&&o.isPlainObject(a[i])){if(Me(n[i],a[i])){return true}}else{return true}}}}else{return true}}}}function Ee(e,t,r){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before animating it. For more details, see "+"https://plotly.com/javascript/animations/")}var n=e._transitionData;if(!n._frameQueue){n._frameQueue=[]}r=h.supplyAnimationDefaults(r);var a=r.transition;var i=r.frame;if(n._frameWaitingCnt===undefined){n._frameWaitingCnt=0}function s(e){if(Array.isArray(a)){if(e>=a.length){return a[0]}else{return a[e]}}else{return a}}function l(e){if(Array.isArray(i)){if(e>=i.length){return i[0]}else{return i[e]}}else{return i}}function u(e,t){var r=0;return function(){if(e&&++r===t){return e()}}}return new Promise(function(i,c){function f(){if(n._frameQueue.length===0){return}while(n._frameQueue.length){var t=n._frameQueue.pop();if(t.onInterrupt){t.onInterrupt()}}e.emit("plotly_animationinterrupted",[])}function p(t){if(t.length===0)return;for(var a=0;a<t.length;a++){var o;if(t[a].type==="byname"){o=h.computeFrame(e,t[a].name)}else{o=t[a].data}var f=l(a);var p=s(a);p.duration=Math.min(p.duration,f.duration);var d={frame:o,name:t[a].name,frameOpts:f,transitionOpts:p};if(a===t.length-1){d.onComplete=u(i,2);d.onInterrupt=c}n._frameQueue.push(d)}if(r.mode==="immediate"){n._lastFrameAt=-Infinity}if(!n._animationRaf){m()}}function d(){e.emit("plotly_animated");window.cancelAnimationFrame(n._animationRaf);n._animationRaf=null}function v(){if(n._currentFrame&&n._currentFrame.onComplete){n._currentFrame.onComplete()}var t=n._currentFrame=n._frameQueue.shift();if(t){var r=t.name?t.name.toString():null;e._fullLayout._currentFrame=r;n._lastFrameAt=Date.now();n._timeToNext=t.frameOpts.duration;h.transition(e,t.frame.data,t.frame.layout,T.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then(function(){if(t.onComplete){t.onComplete()}});e.emit("plotly_animatingframe",{name:r,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else{d()}}function m(){e.emit("plotly_animating");n._lastFrameAt=-Infinity;n._timeToNext=0;n._runningTransitions=0;n._currentFrame=null;var t=function(){n._animationRaf=window.requestAnimationFrame(t);if(Date.now()-n._lastFrameAt>n._timeToNext){v()}};t()}var g=0;function y(e){if(Array.isArray(a)){if(g>=a.length){e.transitionOpts=a[g]}else{e.transitionOpts=a[0]}}else{e.transitionOpts=a}g++;return e}var x,_;var b=[];var w=t===undefined||t===null;var k=Array.isArray(t);var A=!w&&!k&&o.isPlainObject(t);if(A){b.push({type:"object",data:y(o.extendFlat({},t))})}else if(w||["string","number"].indexOf(typeof t)!==-1){for(x=0;x<n._frames.length;x++){_=n._frames[x];if(!_)continue;if(w||String(_.group)===String(t)){b.push({type:"byname",name:String(_.name),data:y({name:_.name})})}}}else if(k){for(x=0;x<t.length;x++){var M=t[x];if(["number","string"].indexOf(typeof M)!==-1){M=String(M);b.push({type:"byname",name:M,data:y({name:M})})}else if(o.isPlainObject(M)){b.push({type:"object",data:y(o.extendFlat({},M))})}}}for(x=0;x<b.length;x++){_=b[x];if(_.type==="byname"&&!n._frameHash[_.data.name]){o.warn('animate failure: frame not found: "'+_.data.name+'"');c();return}}if(["next","immediate"].indexOf(r.mode)!==-1){f()}if(r.direction==="reverse"){b.reverse()}var E=e._fullLayout._currentFrame;if(E&&r.fromcurrent){var S=-1;for(x=0;x<b.length;x++){_=b[x];if(_.type==="byname"&&_.name===E){S=x;break}}if(S>0&&S<b.length-1){var C=[];for(x=0;x<b.length;x++){_=b[x];if(b[x].type!=="byname"||x>S){C.push(_)}}b=C}}if(b.length>0){p(b)}else{e.emit("plotly_animated");i()}})}function Se(e,t,r){e=o.getGraphDiv(e);if(t===null||t===undefined){return Promise.resolve()}if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before adding frames. For more details, see "+"https://plotly.com/javascript/animations/")}var n,a,i,s;var l=e._transitionData._frames;var c=e._transitionData._frameHash;if(!Array.isArray(t)){throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t)}var f=l.length+t.length*2;var p=[];var d={};for(n=t.length-1;n>=0;n--){if(!o.isPlainObject(t[n]))continue;var v=t[n].name;var m=(c[v]||d[v]||{}).name;var g=t[n].name;var y=c[m]||d[m];if(m&&g&&typeof g==="number"&&y&&E<S){E++;o.warn('addFrames: overwriting frame "'+(c[m]||d[m]).name+'" with a frame whose name of type "number" also equates to "'+m+'". This is valid but may potentially lead to unexpected '+"behavior since all plotly.js frame names are stored internally "+"as strings.");if(E===S){o.warn("addFrames: This API call has yielded too many of these warnings. "+"For the rest of this call, further warnings about numeric frame "+"names will be suppressed.")}}d[v]={name:v};p.push({frame:h.supplyFrameDefaults(t[n]),index:r&&r[n]!==undefined&&r[n]!==null?r[n]:f+n})}p.sort(function(e,t){if(e.index>t.index)return-1;if(e.index<t.index)return 1;return 0});var x=[];var _=[];var b=l.length;for(n=p.length-1;n>=0;n--){a=p[n].frame;if(typeof a.name==="number"){o.warn("Warning: addFrames accepts frames with numeric names, but the numbers are"+"implicitly cast to strings")}if(!a.name){while(c[a.name="frame "+e._transitionData._counter++]);}if(c[a.name]){for(i=0;i<l.length;i++){if((l[i]||{}).name===a.name)break}x.push({type:"replace",index:i,value:a});_.unshift({type:"replace",index:i,value:l[i]})}else{s=Math.max(0,Math.min(p[n].index,b));x.push({type:"insert",index:s,value:a});_.unshift({type:"delete",index:s});b++}}var w=h.modifyFrames;var T=h.modifyFrames;var k=[e,_];var A=[e,x];if(u)u.add(e,w,k,T,A);return h.modifyFrames(e,x)}function Ce(e,t){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}var r,n;var a=e._transitionData._frames;var i=[];var s=[];if(!t){t=[];for(r=0;r<a.length;r++){t.push(r)}}t=t.slice();t.sort();for(r=t.length-1;r>=0;r--){n=t[r];i.push({type:"delete",index:n});s.unshift({type:"insert",index:n,value:a[n]})}var l=h.modifyFrames;var c=h.modifyFrames;var f=[e,s];var p=[e,i];if(u)u.add(e,l,f,c,p);return h.modifyFrames(e,i)}function Le(e){e=o.getGraphDiv(e);var t=e._fullLayout||{};var r=e._fullData||[];h.cleanPlot([],{},r,t);h.purge(e);l.purge(e);if(t._container)t._container.remove();delete e._context;return e}function Ie(e){var t=e._fullLayout;var r=e.getBoundingClientRect();if(o.equalDomRects(r,t._lastBBox))return;var n=t._invTransform=o.inverseTransformMatrix(o.getFullTransformMatrix(e));t._invScaleX=Math.sqrt(n[0][0]*n[0][0]+n[0][1]*n[0][1]+n[0][2]*n[0][2]);t._invScaleY=Math.sqrt(n[1][0]*n[1][0]+n[1][1]*n[1][1]+n[1][2]*n[1][2]);t._lastBBox=r}function Oe(e){var t=n.select(e);var r=e._fullLayout;r._calcInverseTransform=Ie;r._calcInverseTransform(e);r._container=t.selectAll(".plot-container").data([0]);r._container.enter().insert("div",":first-child").classed("plot-container",true).classed("plotly",true);r._paperdiv=r._container.selectAll(".svg-container").data([0]);r._paperdiv.enter().append("div").classed("user-select-none",true).classed("svg-container",true).style("position","relative");r._glcontainer=r._paperdiv.selectAll(".gl-container").data([{}]);r._glcontainer.enter().append("div").classed("gl-container",true);r._paperdiv.selectAll(".main-svg").remove();r._paperdiv.select(".modebar-container").remove();r._paper=r._paperdiv.insert("svg",":first-child").classed("main-svg",true);r._toppaper=r._paperdiv.append("svg").classed("main-svg",true);r._modebardiv=r._paperdiv.append("div");delete r._modeBar;r._hoverpaper=r._paperdiv.append("svg").classed("main-svg",true);if(!r._uid){var a={};n.selectAll("defs").each(function(){if(this.id)a[this.id.split("-")[1]]=1});r._uid=o.randstr(a)}r._paperdiv.selectAll(".main-svg").attr(y.svgAttrs);r._defs=r._paper.append("defs").attr("id","defs-"+r._uid);r._clips=r._defs.append("g").classed("clips",true);r._topdefs=r._toppaper.append("defs").attr("id","topdefs-"+r._uid);r._topclips=r._topdefs.append("g").classed("clips",true);r._bgLayer=r._paper.append("g").classed("bglayer",true);r._draggers=r._paper.append("g").classed("draglayer",true);var i=r._paper.append("g").classed("layer-below",true);r._imageLowerLayer=i.append("g").classed("imagelayer",true);r._shapeLowerLayer=i.append("g").classed("shapelayer",true);r._cartesianlayer=r._paper.append("g").classed("cartesianlayer",true);r._polarlayer=r._paper.append("g").classed("polarlayer",true);r._ternarylayer=r._paper.append("g").classed("ternarylayer",true);r._geolayer=r._paper.append("g").classed("geolayer",true);r._funnelarealayer=r._paper.append("g").classed("funnelarealayer",true);r._pielayer=r._paper.append("g").classed("pielayer",true);r._treemaplayer=r._paper.append("g").classed("treemaplayer",true);r._sunburstlayer=r._paper.append("g").classed("sunburstlayer",true);r._indicatorlayer=r._toppaper.append("g").classed("indicatorlayer",true);r._glimages=r._paper.append("g").classed("glimages",true);var s=r._toppaper.append("g").classed("layer-above",true);r._imageUpperLayer=s.append("g").classed("imagelayer",true);r._shapeUpperLayer=s.append("g").classed("shapelayer",true);r._infolayer=r._toppaper.append("g").classed("infolayer",true);r._menulayer=r._toppaper.append("g").classed("menulayer",true);r._zoomlayer=r._toppaper.append("g").classed("zoomlayer",true);r._hoverlayer=r._hoverpaper.append("g").classed("hoverlayer",true);r._modebardiv.classed("modebar-container",true).style("position","absolute").style("top","0px").style("right","0px");e.emit("plotly_framework")}r.animate=Ee;r.addFrames=Se;r.deleteFrames=Ce;r.addTraces=X;r.deleteTraces=Z;r.extendTraces=Y;r.moveTraces=K;r.prependTraces=W;r.newPlot=N;r.plot=C;r.purge=Le;r.react=we;r.redraw=z;r.relayout=ae;r.restyle=J;r.setPlotConfig=I;r.update=he;r._guiRelayout=pe(ae);r._guiRestyle=pe(J);r._guiUpdate=pe(he);r._storeDirectGUIEdit=te},{"../components/color":643,"../components/drawing":665,"../constants/xmlns_namespaces":754,"../lib":778,"../lib/events":767,"../lib/queue":794,"../lib/svg_text_utils":803,"../plots/cartesian/axes":828,"../plots/cartesian/constants":834,"../plots/cartesian/graph_interact":837,"../plots/cartesian/select":847,"../plots/plots":891,"../plots/polar/legacy":899,"../registry":911,"./edit_types":810,"./helpers":811,"./manage_arrays":813,"./plot_config":815,"./plot_schema":816,"./subroutines":818,d3:169,"fast-isnumeric":241,"has-hover":440}],815:[function(e,t,r){"use strict";var n={staticPlot:{valType:"boolean",dflt:false},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:false},edits:{annotationPosition:{valType:"boolean",dflt:false},annotationTail:{valType:"boolean",dflt:false},annotationText:{valType:"boolean",dflt:false},axisTitleText:{valType:"boolean",dflt:false},colorbarPosition:{valType:"boolean",dflt:false},colorbarTitleText:{valType:"boolean",dflt:false},legendPosition:{valType:"boolean",dflt:false},legendText:{valType:"boolean",dflt:false},shapePosition:{valType:"boolean",dflt:false},titleText:{valType:"boolean",dflt:false}},autosizable:{valType:"boolean",dflt:false},responsive:{valType:"boolean",dflt:false},fillFrame:{valType:"boolean",dflt:false},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[true,false],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[false,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:true},showAxisRangeEntryBoxes:{valType:"boolean",dflt:true},showTips:{valType:"boolean",dflt:true},showLink:{valType:"boolean",dflt:false},linkText:{valType:"string",dflt:"Edit chart",noBlank:true},sendData:{valType:"boolean",dflt:true},showSources:{valType:"any",dflt:false},displayModeBar:{valType:"enumerated",values:["hover",true,false],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:false},showEditInChartStudio:{valType:"boolean",dflt:false},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:false},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:true},watermark:{valType:"boolean",dflt:false},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:true,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}};var a={};function i(e,t){for(var r in e){var n=e[r];if(n.valType){t[r]=n.dflt}else{if(!t[r]){t[r]={}}i(n,t[r])}}}i(n,a);t.exports={configAttributes:n,dfltConfig:a}},{}],816:[function(e,t,r){"use strict";var n=e("../registry");var a=e("../lib");var i=e("../plots/attributes");var o=e("../plots/layout_attributes");var s=e("../plots/frame_attributes");var l=e("../plots/animation_attributes");var u=e("./plot_config").configAttributes;var c=e("../plots/polar/legacy/area_attributes");var f=e("../plots/polar/legacy/axis_attributes");var h=e("./edit_types");var p=a.extendFlat;var d=a.extendDeepAll;var v=a.isPlainObject;var m=a.isArrayOrTypedArray;var g=a.nestedProperty;var y=a.valObjectMeta;var x="_isSubplotObj";var _="_isLinkedToArray";var b="_arrayAttrRegexps";var w="_deprecated";var T=[x,_,b,w];r.IS_SUBPLOT_OBJ=x;r.IS_LINKED_TO_ARRAY=_;r.DEPRECATED=w;r.UNDERSCORE_ATTRS=T;r.get=function(){var e={};n.allTypes.concat("area").forEach(function(t){e[t]=E(t)});var t={};Object.keys(n.transformsRegistry).forEach(function(e){t[e]=C(e)});return{defs:{valObjects:y,metaKeys:T.concat(["description","role","editType","impliedEdits"]),editType:{traces:h.traces,layout:h.layout},impliedEdits:{}},traces:e,layout:S(),transforms:t,frames:L(),animation:I(l),config:I(u)}};r.crawl=function(e,t,n,a){var i=n||0;a=a||"";Object.keys(e).forEach(function(n){var o=e[n];if(T.indexOf(n)!==-1)return;var s=(a?a+".":"")+n;t(o,n,e,i,s);if(r.isValObject(o))return;if(v(o)&&n!=="impliedEdits"){r.crawl(o,t,i+1,s)}})};r.isValObject=function(e){return e&&e.valType!==undefined};r.findArrayAttributes=function(e){var t=[];var n=[];var a=[];var o,s;function l(e,t,r,i){n=n.slice(0,i).concat([t]);a=a.slice(0,i).concat([e&&e._isLinkedToArray]);var s=e&&(e.valType==="data_array"||e.arrayOk===true)&&!(n[i-1]==="colorbar"&&(t==="ticktext"||t==="tickvals"));if(!s)return;u(o,0,"")}function u(e,r,i){var o=e[n[r]];var l=i+n[r];if(r===n.length-1){if(m(o)){t.push(s+l)}}else{if(a[r]){if(Array.isArray(o)){for(var c=0;c<o.length;c++){if(v(o[c])){u(o[c],r+1,l+"["+c+"].")}}}}else if(v(o)){u(o,r+1,l+".")}}}o=e;s="";r.crawl(i,l);if(e._module&&e._module.attributes){r.crawl(e._module.attributes,l)}var c=e.transforms;if(c){for(var f=0;f<c.length;f++){var h=c[f];var p=h._module;if(p){s="transforms["+f+"].";o=h;r.crawl(p.attributes,l)}}}return t};r.getTraceValObject=function(e,t){var r=t[0];var a=1;var o,s;if(r==="transforms"){if(t.length===1){return i.transforms}var l=e.transforms;if(!Array.isArray(l)||!l.length)return false;var u=t[1];if(!M(u)||u>=l.length){return false}o=(n.transformsRegistry[l[u].type]||{}).attributes;s=o&&o[t[2]];a=3}else if(e.type==="area"){s=c[r]}else{var f=e._module;if(!f)f=(n.modules[e.type||i.type.dflt]||{})._module;if(!f)return false;o=f.attributes;s=o&&o[r];if(!s){var h=f.basePlotModule;if(h&&h.attributes){s=h.attributes[r]}}if(!s)s=i[r]}return A(s,t,a)};r.getLayoutValObject=function(e,t){var r=k(e,t[0]);return A(r,t,1)};function k(e,t){var r,a,i,s;var l=e._basePlotModules;if(l){var u;for(r=0;r<l.length;r++){i=l[r];if(i.attrRegex&&i.attrRegex.test(t)){if(i.layoutAttrOverrides)return i.layoutAttrOverrides;if(!u&&i.layoutAttributes)u=i.layoutAttributes}var c=i.baseLayoutAttrOverrides;if(c&&t in c)return c[t]}if(u)return u}var h=e._modules;if(h){for(r=0;r<h.length;r++){s=h[r].layoutAttributes;if(s&&t in s){return s[t]}}}for(a in n.componentsRegistry){i=n.componentsRegistry[a];if(i.name==="colorscale"&&t.indexOf("coloraxis")===0){return i.layoutAttributes[t]}else if(!i.schema&&t===i.name){return i.layoutAttributes}}if(t in o)return o[t];if(t==="radialaxis"||t==="angularaxis"){return f[t]}return f.layout[t]||false}function A(e,t,r){if(!e)return false;if(e._isLinkedToArray){if(M(t[r]))r++;else if(r<t.length)return false}for(;r<t.length;r++){var n=e[t[r]];if(v(n))e=n;else break;if(r===t.length-1)break;if(e._isLinkedToArray){r++;if(!M(t[r]))return false}else if(e.valType==="info_array"){r++;var a=t[r];if(!M(a))return false;var i=e.items;if(Array.isArray(i)){if(a>=i.length)return false;if(e.dimensions===2){r++;if(t.length===r)return e;var o=t[r];if(!M(o))return false;e=i[a][o]}else e=i[a]}else{e=i}}}return e}function M(e){return e===Math.round(e)&&e>=0}function E(e){var t,a;if(e==="area"){t={attributes:c};a={}}else{t=n.modules[e]._module,a=t.basePlotModule}var o={};o.type=null;var s=d({},i);var l=d({},t.attributes);r.crawl(l,function(e,t,r,n,a){g(s,a).set(undefined);if(e===undefined)g(l,a).set(undefined)});d(o,s);if(n.traceIs(e,"noOpacity")){delete o.opacity}if(!n.traceIs(e,"showLegend")){delete o.showlegend;delete o.legendgroup}if(n.traceIs(e,"noHover")){delete o.hoverinfo;delete o.hoverlabel}if(!t.selectPoints){delete o.selectedpoints}d(o,l);if(a.attributes){d(o,a.attributes)}o.type=e;var u={meta:t.meta||{},categories:t.categories||{},animatable:Boolean(t.animatable),type:e,attributes:I(o)};if(t.layoutAttributes){var f={};d(f,t.layoutAttributes);u.layoutAttributes=I(f)}if(!t.animatable){r.crawl(u,function(e){if(r.isValObject(e)&&"anim"in e){delete e.anim}})}return u}function S(){var e={};var t,r;d(e,o);for(t in n.subplotsRegistry){r=n.subplotsRegistry[t];if(!r.layoutAttributes)continue;if(Array.isArray(r.attr)){for(var a=0;a<r.attr.length;a++){z(e,r,r.attr[a])}}else{var i=r.attr==="subplot"?r.name:r.attr;z(e,r,i)}}e=R(e);for(t in n.componentsRegistry){r=n.componentsRegistry[t];var s=r.schema;if(s&&(s.subplots||s.layout)){var l=s.subplots;if(l&&l.xaxis&&!l.yaxis){for(var u in l.xaxis){delete e.yaxis[u]}}}else if(r.name==="colorscale"){d(e,r.layoutAttributes)}else if(r.layoutAttributes){N(e,r.layoutAttributes,r.name)}}return{layoutAttributes:I(e)}}function C(e){var t=n.transformsRegistry[e];var r=d({},t.attributes);Object.keys(n.componentsRegistry).forEach(function(t){var a=n.componentsRegistry[t];if(a.schema&&a.schema.transforms&&a.schema.transforms[e]){Object.keys(a.schema.transforms[e]).forEach(function(t){N(r,a.schema.transforms[e][t],t)})}});return{attributes:I(r)}}function L(){var e={frames:d({},s)};I(e);return e.frames}function I(e){O(e);P(e);D(e);return e}function O(e){function t(e){return{valType:"string",editType:"none"}}function n(e,n,a){if(r.isValObject(e)){if(e.valType==="data_array"){e.role="data";a[n+"src"]=t(n)}else if(e.arrayOk===true){a[n+"src"]=t(n)}}else if(v(e)){e.role="object"}}r.crawl(e,n)}function P(e){function t(e,t,r){if(!e)return;var n=e[_];if(!n)return;delete e[_];r[t]={items:{}};r[t].items[n]=e;r[t].role="object"}r.crawl(e,t)}function D(e){function t(e){for(var r in e){if(v(e[r])){t(e[r])}else if(Array.isArray(e[r])){for(var n=0;n<e[r].length;n++){t(e[r][n])}}else{if(e[r]instanceof RegExp){e[r]=e[r].toString()}}}}t(e)}function R(e){p(e,{radialaxis:f.radialaxis,angularaxis:f.angularaxis});p(e,f.layout);return e}function z(e,t,r){var n=g(e,r);var a=d({},t.layoutAttributes);a[x]=true;n.set(a)}function N(e,t,r){var n=g(e,r);n.set(d(n.get()||{},t))}},{"../lib":778,"../plots/animation_attributes":822,"../plots/attributes":824,"../plots/frame_attributes":857,"../plots/layout_attributes":882,"../plots/polar/legacy/area_attributes":897,"../plots/polar/legacy/axis_attributes":898,"../registry":911,"./edit_types":810,"./plot_config":815}],817:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plots/attributes");var i="templateitemname";var o={name:{valType:"string",editType:"none"}};o[i]={valType:"string",editType:"calc"};r.templatedArray=function(e,t){t._isLinkedToArray=e;t.name=o.name;t[i]=o[i];return t};r.traceTemplater=function(e){var t={};var r,i;for(r in e){i=e[r];if(Array.isArray(i)&&i.length){t[r]=0}}function o(o){r=n.coerce(o,{},a,"type");var s={type:r,_template:null};if(r in t){i=e[r];var l=t[r]%i.length;t[r]++;s._template=i[l]}else{}return s}return{newTrace:o}};r.newContainer=function(e,t,r){var a=e._template;var i=a&&(a[t]||r&&a[r]);if(!n.isPlainObject(i))i=null;var o=e[t]={_template:i};return o};r.arrayTemplater=function(e,t,r){var n=e._template;var a=n&&n[l(t)];var o=n&&n[t];if(!Array.isArray(o)||!o.length){o=[]}var u={};function c(e){var t={name:e.name,_input:e};var n=t[i]=e[i];if(!s(n)){t._template=a;return t}for(var l=0;l<o.length;l++){var c=o[l];if(c.name===n){u[n]=1;t._template=c;return t}}t[r]=e[r]||false;t._template=false;return t}function f(){var e=[];for(var t=0;t<o.length;t++){var r=o[t];var n=r.name;if(s(n)&&!u[n]){var a={_template:r,name:n,_input:{_templateitemname:n}};a[i]=r[i];e.push(a);u[n]=1}}return e}return{newItem:c,defaultItems:f}};function s(e){return e&&typeof e==="string"}function l(e){var t=e.length-1;if(e.charAt(t)!=="s"){n.warn("bad argument to arrayDefaultKey: "+e)}return e.substr(0,e.length-1)+"defaults"}r.arrayDefaultKey=l;r.arrayEditor=function(e,t,r){var a=(n.nestedProperty(e,t).get()||[]).length;var o=r._index;var s=o>=a&&(r._input||{})._templateitemname;if(s)o=a;var l=t+"["+o+"]";var u;function c(){u={};if(s){u[l]={};u[l][i]=s}}c();function f(e,t){u[e]=t}function h(e,t){if(s){n.nestedProperty(u[l],e).set(t)}else{u[l+"."+e]=t}}function p(){var e=u;c();return e}function d(t,r){if(t)h(t,r);var a=p();for(var i in a){n.nestedProperty(e,i).set(a[i])}}return{modifyBase:f,modifyItem:h,getUpdateObj:p,applyUpdate:d}}},{"../lib":778,"../plots/attributes":824}],818:[function(e,t,r){"use strict";var n=e("d3");var a=e("../registry");var i=e("../plots/plots");var o=e("../lib");var s=e("../lib/clear_gl_canvases");var l=e("../components/color");var u=e("../components/drawing");var c=e("../components/titles");var f=e("../components/modebar");var h=e("../plots/cartesian/axes");var p=e("../constants/alignment");var d=e("../plots/cartesian/constraints");var v=d.enforce;var m=d.clean;var g=e("../plots/cartesian/autorange").doAutoRange;var y="start";var x="middle";var _="end";r.layoutStyles=function(e){return o.syncOrAsync([i.doAutoMargin,w],e)};function b(e,t,r){for(var n=0;n<r.length;n++){var a=r[n][0];var i=r[n][1];if(a[0]>=e[1]||a[1]<=e[0]){continue}if(i[0]<t[1]&&i[1]>t[0]){return true}}return false}function w(e){var t=e._fullLayout;var a=t._size;var s=a.p;var c=h.list(e,"",true);var d,v,m,g,y,x;t._paperdiv.style({width:e._context.responsive&&t.autosize&&!e._context._hasZeroWidth&&!e.layout.width?"100%":t.width+"px",height:e._context.responsive&&t.autosize&&!e._context._hasZeroHeight&&!e.layout.height?"100%":t.height+"px"}).selectAll(".main-svg").call(u.setSize,t.width,t.height);e._context.setBackground(e,t.paper_bgcolor);r.drawMainTitle(e);f.manage(e);if(!t._has("cartesian")){return i.previousPromises(e)}function _(e,t,r){var n=e._lw/2;if(e._id.charAt(0)==="x"){if(!t)return a.t+a.h*(1-(e.position||0))+n%1;else if(r==="top")return t._offset-s-n;return t._offset+t._length+s+n}if(!t)return a.l+a.w*(e.position||0)+n%1;else if(r==="right")return t._offset+t._length+s+n;return t._offset-s-n}for(d=0;d<c.length;d++){g=c[d];var w=g._anchorAxis;g._linepositions={};g._lw=u.crispRound(e,g.linewidth,1);g._mainLinePosition=_(g,w,g.side);g._mainMirrorPosition=g.mirror&&w?_(g,w,p.OPPOSITE_SIDE[g.side]):null}var k=[];var M=[];var E=[];var S=l.opacity(t.paper_bgcolor)===1&&l.opacity(t.plot_bgcolor)===1&&t.paper_bgcolor===t.plot_bgcolor;for(v in t._plots){m=t._plots[v];if(m.mainplot){if(m.bg){m.bg.remove()}m.bg=undefined}else{var C=m.xaxis.domain;var L=m.yaxis.domain;var I=m.plotgroup;if(b(C,L,E)){var O=I.node();var P=m.bg=o.ensureSingle(I,"rect","bg");O.insertBefore(P.node(),O.childNodes[0]);M.push(v)}else{I.select("rect.bg").remove();E.push([C,L]);if(!S){k.push(v);M.push(v)}}}}var D=t._bgLayer.selectAll(".bg").data(k);D.enter().append("rect").classed("bg",true);D.exit().remove();D.each(function(e){t._plots[e].bg=n.select(this)});for(d=0;d<M.length;d++){m=t._plots[M[d]];y=m.xaxis;x=m.yaxis;if(m.bg&&y._offset!==undefined&&x._offset!==undefined){m.bg.call(u.setRect,y._offset-s,x._offset-s,y._length+2*s,x._length+2*s).call(l.fill,t.plot_bgcolor).style("stroke-width",0)}}if(!t._hasOnlyLargeSploms){for(v in t._plots){m=t._plots[v];y=m.xaxis;x=m.yaxis;var R=m.clipId="clip"+t._uid+v+"plot";var z=o.ensureSingleById(t._clips,"clipPath",R,function(e){e.classed("plotclip",true).append("rect")});m.clipRect=z.select("rect").attr({width:y._length,height:x._length});u.setTranslate(m.plot,y._offset,x._offset);var N;var F;if(m._hasClipOnAxisFalse){N=null;F=R}else{N=R;F=null}u.setClipUrl(m.plot,N,e);m.layerClipId=F}}var B,j,U,H,V,G;var q,Y,W,X,Z,K;var J;function Q(e){return"M"+B+","+e+"H"+j}function $(e){return"M"+y._offset+","+e+"h"+y._length}function ee(e){return"M"+e+","+Y+"V"+q}function te(e){return"M"+e+","+x._offset+"v"+x._length}function re(e,t,r){if(!e.showline||v!==e._mainSubplot)return"";if(!e._anchorAxis)return r(e._mainLinePosition);var n=t(e._mainLinePosition);if(e.mirror)n+=t(e._mainMirrorPosition);return n}for(v in t._plots){m=t._plots[v];y=m.xaxis;x=m.yaxis;var ne="M0,0";if(T(y,v)){V=A(y,"left",x,c);B=y._offset-(V?s+V:0);G=A(y,"right",x,c);j=y._offset+y._length+(G?s+G:0);U=_(y,x,"bottom");H=_(y,x,"top");J=!y._anchorAxis||v!==y._mainSubplot;if(J&&(y.mirror==="allticks"||y.mirror==="all")){y._linepositions[v]=[U,H]}ne=re(y,Q,$);if(J&&y.showline&&(y.mirror==="all"||y.mirror==="allticks")){ne+=Q(U)+Q(H)}m.xlines.style("stroke-width",y._lw+"px").call(l.stroke,y.showline?y.linecolor:"rgba(0,0,0,0)")}m.xlines.attr("d",ne);var ae="M0,0";if(T(x,v)){Z=A(x,"bottom",y,c);q=x._offset+x._length+(Z?s:0);K=A(x,"top",y,c);Y=x._offset-(K?s:0);W=_(x,y,"left");X=_(x,y,"right");J=!x._anchorAxis||v!==x._mainSubplot;if(J&&(x.mirror==="allticks"||x.mirror==="all")){x._linepositions[v]=[W,X]}ae=re(x,ee,te);if(J&&x.showline&&(x.mirror==="all"||x.mirror==="allticks")){ae+=ee(W)+ee(X)}m.ylines.style("stroke-width",x._lw+"px").call(l.stroke,x.showline?x.linecolor:"rgba(0,0,0,0)")}m.ylines.attr("d",ae)}h.makeClipPaths(e);return i.previousPromises(e)}function T(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||e.mirror==="all"||e.mirror==="allticks")}function k(e,t,r){if(!r.showline||!r._lw)return false;if(r.mirror==="all"||r.mirror==="allticks")return true;var n=r._anchorAxis;if(!n)return false;var a=p.FROM_BL[t];if(r.side===t){return n.domain[a]===e.domain[a]}return r.mirror&&n.domain[1-a]===e.domain[1-a]}function A(e,t,r,n){if(k(e,t,r)){return r._lw}for(var a=0;a<n.length;a++){var i=n[a];if(i._mainAxis===r._mainAxis&&k(e,t,i)){return i._lw}}return 0}r.drawMainTitle=function(e){var t=e._fullLayout;var r=S(t);var n=C(t);c.draw(e,"gtitle",{propContainer:t,propName:"title.text",placeholder:t._dfltTitle.plot,attributes:{x:M(t,r),y:E(t,n),"text-anchor":r,dy:n}})};function M(e,t){var r=e.title;var n=e._size;var a=0;if(t===y){a=r.pad.l}else if(t===_){a=-r.pad.r}switch(r.xref){case"paper":return n.l+n.w*r.x+a;case"container":default:return e.width*r.x+a}}function E(e,t){var r=e.title;var n=e._size;var a=0;if(t==="0em"||!t){a=-r.pad.b}else if(t===p.CAP_SHIFT+"em"){a=r.pad.t}if(r.y==="auto"){return n.t/2}else{switch(r.yref){case"paper":return n.t+n.h-n.h*r.y+a;case"container":default:return e.height-e.height*r.y+a}}}function S(e){var t=e.title;var r=x;if(o.isRightAnchor(t)){r=_}else if(o.isLeftAnchor(t)){r=y}return r}function C(e){var t=e.title;var r="0em";if(o.isTopAnchor(t)){r=p.CAP_SHIFT+"em"}else if(o.isMiddleAnchor(t)){r=p.MID_SHIFT+"em"}return r}r.doTraceStyle=function(e){var t=e.calcdata;var n=[];var o;for(o=0;o<t.length;o++){var l=t[o];var u=l[0]||{};var c=u.trace||{};var f=c._module||{};var h=f.arraysToCalcdata;if(h)h(l,c);var p=f.editStyle;if(p)n.push({fn:p,cd0:u})}if(n.length){for(o=0;o<n.length;o++){var d=n[o];d.fn(e,d.cd0)}s(e);r.redrawReglTraces(e)}i.style(e);a.getComponentMethod("legend","draw")(e);return i.previousPromises(e)};r.doColorBars=function(e){a.getComponentMethod("colorbar","draw")(e);return i.previousPromises(e)};r.layoutReplot=function(e){var t=e.layout;e.layout=undefined;return a.call("plot",e,"",t)};r.doLegend=function(e){a.getComponentMethod("legend","draw")(e);return i.previousPromises(e)};r.doTicksRelayout=function(e){h.draw(e,"redraw");if(e._fullLayout._hasOnlyLargeSploms){a.subplotsRegistry.splom.updateGrid(e);s(e);r.redrawReglTraces(e)}r.drawMainTitle(e);return i.previousPromises(e)};r.doModeBar=function(e){var t=e._fullLayout;f.manage(e);for(var r=0;r<t._basePlotModules.length;r++){var n=t._basePlotModules[r].updateFx;if(n)n(e)}return i.previousPromises(e)};r.doCamera=function(e){var t=e._fullLayout;var r=t._subplots.gl3d;for(var n=0;n<r.length;n++){var a=t[r[n]];var i=a._scene;i.setViewport(a)}};r.drawData=function(e){var t=e._fullLayout;s(e);var n=t._basePlotModules;for(var o=0;o<n.length;o++){n[o].plot(e)}r.redrawReglTraces(e);i.style(e);a.getComponentMethod("shapes","draw")(e);a.getComponentMethod("annotations","draw")(e);a.getComponentMethod("images","draw")(e);t._replotting=false;return i.previousPromises(e)};r.redrawReglTraces=function(e){var t=e._fullLayout;if(t._has("regl")){var r=e._fullData;var n=[];var a=[];var i,s;if(t._hasOnlyLargeSploms){t._splomGrid.draw()}for(i=0;i<r.length;i++){var l=r[i];if(l.visible===true&&l._length!==0){if(l.type==="splom"){t._splomScenes[l.uid].draw()}else if(l.type==="scattergl"){o.pushUnique(n,l.xaxis+l.yaxis)}else if(l.type==="scatterpolargl"){o.pushUnique(a,l.subplot)}}}for(i=0;i<n.length;i++){s=t._plots[n[i]];if(s._scene)s._scene.draw()}for(i=0;i<a.length;i++){s=t[a[i]]._subplot;if(s._scene)s._scene.draw()}}};r.doAutoRangeAndConstraints=function(e){var t=h.list(e,"",true);var r;var n={};for(var a=0;a<t.length;a++){r=t[a];if(!n[r._id]){n[r._id]=1;m(e,r);g(e,r);var i=r._matchGroup;if(i){for(var o in i){var s=h.getFromId(e,o);g(e,s,r.range);n[o]=1}}}}v(e)};r.finalDraw=function(e){a.getComponentMethod("rangeslider","draw")(e);a.getComponentMethod("rangeselector","draw")(e)};r.drawMarginPushers=function(e){a.getComponentMethod("legend","draw")(e);a.getComponentMethod("rangeselector","draw")(e);a.getComponentMethod("sliders","draw")(e);a.getComponentMethod("updatemenus","draw")(e);a.getComponentMethod("colorbar","draw")(e)}},{"../components/color":643,"../components/drawing":665,"../components/modebar":703,"../components/titles":738,"../constants/alignment":745,"../lib":778,"../lib/clear_gl_canvases":762,"../plots/cartesian/autorange":827,"../plots/cartesian/axes":828,"../plots/cartesian/constraints":835,"../plots/plots":891,"../registry":911,d3:169}],819:[function(e,t,r){"use strict";var n=e("../lib");var a=n.isPlainObject;var i=e("./plot_schema");var o=e("../plots/plots");var s=e("../plots/attributes");var l=e("./plot_template");var u=e("./plot_config").dfltConfig;r.makeTemplate=function(e){e=n.isPlainObject(e)?e:n.getGraphDiv(e);e=n.extendDeep({_context:u},{data:e.data,layout:e.layout});o.supplyDefaults(e);var t=e.data||[];var r=e.layout||{};r._basePlotModules=e._fullLayout._basePlotModules;r._modules=e._fullLayout._modules;var i={data:{},layout:{}};t.forEach(function(e){var t={};h(e,t,d.bind(null,e));var r=n.coerce(e,{},s,"type");var a=i.data[r];if(!a)a=i.data[r]=[];a.push(t)});h(r,i.layout,p.bind(null,r));delete i.layout.template;var l=r.template;if(a(l)){var f=l.layout;var v,m,g,y,x,_;if(a(f)){c(f,i.layout)}var b=l.data;if(a(b)){for(m in i.data){g=b[m];if(Array.isArray(g)){x=i.data[m];_=x.length;y=g.length;for(v=0;v<_;v++){c(g[v%y],x[v])}for(v=_;v<y;v++){x.push(n.extendDeep({},g[v]))}}}for(m in b){if(!(m in i.data)){i.data[m]=n.extendDeep([],b[m])}}}}return i};function c(e,t){e=n.extendDeep({},e);var r=Object.keys(e).sort();var i,o;function s(t,r,n){if(a(r)&&a(t)){c(t,r)}else if(Array.isArray(r)&&Array.isArray(t)){var i=l.arrayTemplater({_template:e},n);for(o=0;o<r.length;o++){var s=r[o];var u=i.newItem(s)._template;if(u)c(u,s)}var f=i.defaultItems();for(o=0;o<f.length;o++)r.push(f[o]._template);for(o=0;o<r.length;o++)delete r[o].templateitemname}}for(i=0;i<r.length;i++){var u=r[i];var h=e[u];if(u in t){s(h,t[u],u)}else t[u]=h;if(f(u)===u){for(var p in t){var d=f(p);if(p!==d&&d===u&&!(p in e)){s(h,t[p],u)}}}}}function f(e){return e.replace(/[0-9]+$/,"")}function h(e,t,r,i,o){var s=o&&r(o);for(var u in e){var c=e[u];var p=v(e,u,i);var d=v(e,u,o);var m=r(d);if(!m){var g=f(u);if(g!==u){d=v(e,g,o);m=r(d)}}if(s&&s===m)continue;if(!m||m._noTemplating||m.valType==="data_array"||m.arrayOk&&Array.isArray(c)){continue}if(!m.valType&&a(c)){h(c,t,r,p,d)}else if(m._isLinkedToArray&&Array.isArray(c)){var y=false;var x=0;var _={};for(var b=0;b<c.length;b++){var w=c[b];if(a(w)){var T=w.name;if(T){if(!_[T]){h(w,t,r,v(c,x,p),v(c,x,d));x++;_[T]=1}}else if(!y){var k=l.arrayDefaultKey(u);var A=v(e,k,i);var M=v(c,x,p);h(w,t,r,M,v(c,x,d));var E=n.nestedProperty(t,M);var S=n.nestedProperty(t,A);S.set(E.get());E.set(null);y=true}}}}else{var C=n.nestedProperty(t,p);C.set(c)}}}function p(e,t){return i.getLayoutValObject(e,n.nestedProperty({},t).parts)}function d(e,t){return i.getTraceValObject(e,n.nestedProperty({},t).parts)}function v(e,t,r){var n;if(!r)n=t;else if(Array.isArray(e))n=r+"["+t+"]";else n=r+"."+t;return n}r.validateTemplate=function(e,t){var r=n.extendDeep({},{_context:u,data:e.data,layout:e.layout});var i=r.layout||{};if(!a(t))t=i.template||{};var s=t.layout;var l=t.data;var c=[];r.layout=i;r.layout.template=t;o.supplyDefaults(r);var h=r._fullLayout;var p=r._fullData;var d={};function y(e,t){for(var r in e){if(r.charAt(0)!=="_"&&a(e[r])){var n=f(r);var i=[];var o;for(o=0;o<t.length;o++){i.push(v(e,r,t[o]));if(n!==r)i.push(v(e,n,t[o]))}for(o=0;o<i.length;o++){d[i[o]]=1}y(e[r],i)}}}function x(e,t){for(var r in e){if(r.indexOf("defaults")===-1&&a(e[r])){var n=v(e,r,t);if(d[n]){x(e[r],n)}else{c.push({code:"unused",path:n})}}}}if(!a(s)){c.push({code:"layout"})}else{y(h,["layout"]);x(s,"layout")}if(!a(l)){c.push({code:"data"})}else{var _={};var b;for(var w=0;w<p.length;w++){var T=p[w];b=T.type;_[b]=(_[b]||0)+1;if(!T._fullInput._template){c.push({code:"missing",index:T._fullInput.index,traceType:b})}}for(b in l){var k=l[b].length;var A=_[b]||0;if(k>A){c.push({code:"unused",traceType:b,templateCount:k,dataCount:A})}else if(A>k){c.push({code:"reused",traceType:b,templateCount:k,dataCount:A})}}}function M(e,t){for(var r in e){if(r.charAt(0)==="_")continue;var n=e[r];var i=v(e,r,t);if(a(n)){if(Array.isArray(e)&&n._template===false&&n.templateitemname){c.push({code:"missing",path:i,templateitemname:n.templateitemname})}M(n,i)}else if(Array.isArray(n)&&m(n)){M(n,i)}}}M({data:p,layout:h},"");if(c.length)return c.map(g)};function m(e){for(var t=0;t<e.length;t++){if(a(e[t]))return true}}function g(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":if(e.path){t="There are no templates for item "+e.path+" with name "+e.templateitemname}else{t="There are no templates for trace "+e.index+", of type "+e.traceType+"."}break;case"unused":if(e.path){t="The template item at "+e.path+" was not used in constructing the plot."}else if(e.dataCount){t="Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type."}else{t="The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data."}break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";break}e.msg=t;return e}},{"../lib":778,"../plots/attributes":824,"../plots/plots":891,"./plot_config":815,"./plot_schema":816,"./plot_template":817}],820:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("./plot_api");var i=e("../plots/plots");var o=e("../lib");var s=e("../snapshot/helpers");var l=e("../snapshot/tosvg");var u=e("../snapshot/svgtoimg");var c=e("../version").version;var f={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:false},imageDataOnly:{valType:"boolean",dflt:false}};function h(e,t){t=t||{};var r;var h;var p;var d;if(o.isPlainObject(e)){r=e.data||[];h=e.layout||{};p=e.config||{};d={}}else{e=o.getGraphDiv(e);r=o.extendDeep([],e.data);h=o.extendDeep({},e.layout);p=e._context;d=e._fullLayout||{}}function v(e){return!(e in t)||o.validate(t[e],f[e])}if(!v("width")&&t.width!==null||!v("height")&&t.height!==null){throw new Error("Height and width should be pixel values.")}if(!v("format")){throw new Error("Export format is not "+o.join2(f.format.values,", "," or ")+".")}var m={};function g(e,r){return o.coerce(t,m,f,e,r)}var y=g("format");var x=g("width");var _=g("height");var b=g("scale");var w=g("setBackground");var T=g("imageDataOnly");var k=document.createElement("div");k.style.position="absolute";k.style.left="-5000px";document.body.appendChild(k);var A=o.extendFlat({},h);if(x){A.width=x}else if(t.width===null&&n(d.width)){A.width=d.width}if(_){A.height=_}else if(t.height===null&&n(d.height)){A.height=d.height}var M=o.extendFlat({},p,{_exportedPlot:true,staticPlot:true,setBackground:w});var E=s.getRedrawFunc(k);function S(){return new Promise(function(e){setTimeout(e,s.getDelay(k._fullLayout))})}function C(){return new Promise(function(e,t){var r=l(k,y,b);var n=k._fullLayout.width;var f=k._fullLayout.height;function h(){a.purge(k);document.body.removeChild(k)}if(y==="full-json"){var p=i.graphJson(k,false,"keepdata","object",true,true);p.version=c;p=JSON.stringify(p);h();if(T){return e(p)}else{return e(s.encodeJSON(p))}}h();if(y==="svg"){if(T){return e(r)}else{return e(s.encodeSVG(r))}}var d=document.createElement("canvas");d.id=o.randstr();u({format:y,width:n,height:f,scale:b,canvas:d,svg:r,promise:true}).then(e).catch(t)})}function L(e){if(T){return e.replace(s.IMAGE_URL_PREFIX,"")}else{return e}}return new Promise(function(e,t){a.plot(k,r,A,M).then(E).then(S).then(C).then(function(t){e(L(t))}).catch(function(e){t(e)})})}t.exports=h},{"../lib":778,"../plots/plots":891,"../snapshot/helpers":915,"../snapshot/svgtoimg":917,"../snapshot/tosvg":919,"../version":1370,"./plot_api":814,"fast-isnumeric":241}],821:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plots/plots");var i=e("./plot_schema");var o=e("./plot_config").dfltConfig;var s=n.isPlainObject;var l=Array.isArray;var u=n.isArrayOrTypedArray;t.exports=function e(t,r){if(t===undefined)t=[];if(r===undefined)r={};var u=i.get();var h=[];var p={_context:n.extendFlat({},o)};var v,m;if(l(t)){p.data=n.extendDeep([],t);v=t}else{p.data=[];v=[];h.push(d("array","data"))}if(s(r)){p.layout=n.extendDeep({},r);m=r}else{p.layout={};m={};if(arguments.length>1){h.push(d("object","layout"))}}a.supplyDefaults(p);var g=p._fullData;var y=v.length;for(var x=0;x<y;x++){var _=v[x];var b=["data",x];if(!s(_)){h.push(d("object",b));continue}var w=g[x];var T=w.type;var k=u.traces[T].attributes;k.type={valType:"enumerated",values:[T]};if(w.visible===false&&_.visible!==false){h.push(d("invisible",b))}c(_,w,k,h,b);var A=_.transforms;var M=w.transforms;if(A){if(!l(A)){h.push(d("array",b,["transforms"]))}b.push("transforms");for(var E=0;E<A.length;E++){var S=["transforms",E];var C=A[E].type;if(!s(A[E])){h.push(d("object",b,S));continue}var L=u.transforms[C]?u.transforms[C].attributes:{};L.type={valType:"enumerated",values:Object.keys(u.transforms)};c(A[E],M[E],L,h,b,S)}}}var I=p._fullLayout;var O=f(u,g);c(m,I,O,h,"layout");return h.length===0?void 0:h};function c(e,t,r,a,i,o){o=o||[];var f=Object.keys(e);for(var h=0;h<f.length;h++){var p=f[h];if(p==="transforms")continue;var g=o.slice();g.push(p);var y=e[p];var x=t[p];var _=m(r,p);var b=(_||{}).valType;var w=b==="info_array";var T=b==="colorscale";var k=(_||{}).items;if(!v(r,p)){a.push(d("schema",i,g))}else if(s(y)&&s(x)&&b!=="any"){c(y,x,_,a,i,g)}else if(w&&l(y)){if(y.length>x.length){a.push(d("unused",i,g.concat(x.length)))}var A=x.length;var M=Array.isArray(k);if(M)A=Math.min(A,k.length);var E,S,C,L,I;if(_.dimensions===2){for(S=0;S<A;S++){if(l(y[S])){if(y[S].length>x[S].length){a.push(d("unused",i,g.concat(S,x[S].length)))}var O=x[S].length;for(E=0;E<(M?Math.min(O,k[S].length):O);E++){C=M?k[S][E]:k;L=y[S][E];I=x[S][E];if(!n.validate(L,C)){a.push(d("value",i,g.concat(S,E),L))}else if(I!==L&&I!==+L){a.push(d("dynamic",i,g.concat(S,E),L,I))}}}else{a.push(d("array",i,g.concat(S),y[S]))}}}else{for(S=0;S<A;S++){C=M?k[S]:k;L=y[S];I=x[S];if(!n.validate(L,C)){a.push(d("value",i,g.concat(S),L))}else if(I!==L&&I!==+L){a.push(d("dynamic",i,g.concat(S),L,I))}}}}else if(_.items&&!w&&l(y)){var P=k[Object.keys(k)[0]];var D=[];var R,z;for(R=0;R<x.length;R++){var N=x[R]._index||R;z=g.slice();z.push(N);if(s(y[N])&&s(x[R])){D.push(N);var F=y[N];var B=x[R];if(s(F)&&F.visible!==false&&B.visible===false){a.push(d("invisible",i,z))}else c(F,B,P,a,i,z)}}for(R=0;R<y.length;R++){z=g.slice();z.push(R);if(!s(y[R])){a.push(d("object",i,z,y[R]))}else if(D.indexOf(R)===-1){a.push(d("unused",i,z))}}}else if(!s(y)&&s(x)){a.push(d("object",i,g,y))}else if(!u(y)&&u(x)&&!w&&!T){a.push(d("array",i,g,y))}else if(!(p in t)){a.push(d("unused",i,g,y))}else if(!n.validate(y,_)){a.push(d("value",i,g,y))}else if(_.valType==="enumerated"&&(_.coerceNumber&&y!==+x||y!==x)){a.push(d("dynamic",i,g,y,x))}}return a}function f(e,t){var r=e.layout.layoutAttributes;for(var a=0;a<t.length;a++){var i=t[a];var o=e.traces[i.type];var s=o.layoutAttributes;if(s){if(i.subplot){n.extendFlat(r[o.attributes.subplot.dflt],s)}else{n.extendFlat(r,s)}}}return r}var h={object:function(e,t){var r;if(e==="layout"&&t==="")r="The layout argument";else if(e[0]==="data"&&t===""){r="Trace "+e[1]+" in the data argument"}else r=p(e)+"key "+t;return r+" must be linked to an object container"},array:function(e,t){var r;if(e==="data")r="The data argument";else r=p(e)+"key "+t;return r+" must be linked to an array container"},schema:function(e,t){return p(e)+"key "+t+" is not part of the schema"},unused:function(e,t,r){var n=s(r)?"container":"key";return p(e)+n+" "+t+" did not get coerced"},dynamic:function(e,t,r,n){return[p(e)+"key",t,"(set to '"+r+"')","got reset to","'"+n+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?p(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,r){return[p(e)+"key "+t,"is set to an invalid value ("+r+")"].join(" ")}};function p(e){if(l(e))return"In data trace "+e[1]+", ";return"In "+e+", "}function d(e,t,r,a,i){r=r||"";var o,s;if(l(t)){o=t[0];s=t[1]}else{o=t;s=null}var u=x(r);var c=h[e](t,u,a,i);n.log(c);return{code:e,container:o,trace:s,path:r,astr:u,msg:c}}function v(e,t){var r=y(t);var n=r.keyMinusId;var a=r.id;if(n in e&&e[n]._isSubplotObj&&a){return true}return t in e}function m(e,t){if(t in e)return e[t];var r=y(t);return e[r.keyMinusId]}var g=n.counterRegex("([a-z]+)");function y(e){var t=e.match(g);return{keyMinusId:t&&t[1],id:t&&t[2]}}function x(e){if(!l(e))return String(e);var t="";for(var r=0;r<e.length;r++){var n=e[r];if(typeof n==="number"){t=t.substr(0,t.length-1)+"["+n+"]"}else{t+=n}if(r<e.length-1)t+="."}return t}},{"../lib":778,"../plots/plots":891,"./plot_config":815,"./plot_schema":816}],822:[function(e,t,r){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:false},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:true}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],823:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plot_api/plot_template");t.exports=function e(t,r,i){var o=i.name;var s=i.inclusionAttr||"visible";var l=r[o];var u=n.isArrayOrTypedArray(t[o])?t[o]:[];var c=r[o]=[];var f=a.arrayTemplater(r,o,s);var h,p;for(h=0;h<u.length;h++){var d=u[h];if(!n.isPlainObject(d)){p=f.newItem({});p[s]=false}else{p=f.newItem(d)}p._index=h;if(p[s]!==false){i.handleItemDefaults(d,p,r,i)}c.push(p)}var v=f.defaultItems();for(h=0;h<v.length;h++){p=v[h];p._index=c.length;i.handleItemDefaults({},p,r,i,{});c.push(p)}if(n.isArrayOrTypedArray(l)){var m=Math.min(l.length,c.length);for(h=0;h<m;h++){n.relinkPrivateKeys(c[h],l[h])}}return c}},{"../lib":778,"../plot_api/plot_template":817}],824:[function(e,t,r){"use strict";var n=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:true},visible:{valType:"enumerated",values:[true,false,"legendonly"],dflt:true,editType:"calc"},showlegend:{valType:"boolean",dflt:true,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:true},ids:{valType:"data_array",editType:"calc",anim:true},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:true,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:true,dflt:"all",editType:"none"},hoverlabel:n.hoverlabel,stream:{token:{valType:"string",noBlank:true,strict:true,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":674}],825:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=a.dateTime2ms;var o=a.incrementMonth;var s=e("../../constants/numerical");var l=s.ONEAVGMONTH;t.exports=function e(t,r,a,s){if(r.type!=="date")return s;var u=t[a+"periodalignment"];if(!u)return s;var c=t[a+"period"];var f;if(n(c)){c=+c;if(c<=0)return s}else if(typeof c==="string"&&c.charAt(0)==="M"){var h=+c.substring(1);if(h>0&&Math.round(h)===h){f=h}else return s}var p=r.calendar;var d="start"===u;var v="end"===u;var m=t[a+"period0"];var g=i(m,p)||0;var y=[];var x=s.length;for(var _=0;_<x;_++){var b=s[_];var w,T,k;if(f){w=Math.round((b-g)/(f*l));k=o(g,f*w,p);while(k>b){k=o(k,-f,p)}while(k<=b){k=o(k,f,p)}T=o(k,-f,p)}else{w=Math.round((b-g)/c);k=g+w*c;while(k>b){k-=c}while(k<=b){k+=c}T=k-c}y[_]=d?T:v?k:(T+k)/2}return y}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],826:[function(e,t,r){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],827:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../constants/numerical").FP_SAFE;var o=e("../../registry");var s=e("./axis_ids");var l=s.getFromId;var u=s.isLinked;t.exports={getAutoRange:c,makePadFn:h,doAutoRange:m,findExtremes:g,concatExtremes:v};function c(e,t){var r,n;var i=[];var o=e._fullLayout;var s=h(o,t,0);var l=h(o,t,1);var u=v(e,t);var c=u.min;var p=u.max;if(c.length===0||p.length===0){return a.simpleMap(t.range,t.r2l)}var d=c[0].val;var m=p[0].val;for(r=1;r<c.length;r++){if(d!==m)break;d=Math.min(d,c[r].val)}for(r=1;r<p.length;r++){if(d!==m)break;m=Math.max(m,p[r].val)}var g=false;if(t.range){var y=a.simpleMap(t.range,t.r2l);g=y[1]<y[0]}if(t.autorange==="reversed"){g=true;t.autorange=true}var x=t.rangemode;var _=x==="tozero";var b=x==="nonnegative";var w=t._length;var T=w/10;var k=0;var A,M,E,S,C,L;for(r=0;r<c.length;r++){A=c[r];for(n=0;n<p.length;n++){M=p[n];L=M.val-A.val-f(t,A.val,M.val);if(L>0){C=w-s(A)-l(M);if(C>T){if(L/C>k){E=A;S=M;k=L/C}}else if(L/w>k){E={val:A.val,nopad:1};S={val:M.val,nopad:1};k=L/w}}}}function I(e,t){return Math.max(e,l(t))}if(d===m){var O=d-1;var P=d+1;if(_){if(d===0){i=[0,1]}else{var D=(d>0?p:c).reduce(I,0);var R=d/(1-Math.min(.5,D/w));i=d>0?[0,R]:[R,0]}}else if(b){i=[Math.max(0,O),Math.max(1,P)]}else{i=[O,P]}}else{if(_){if(E.val>=0){E={val:0,nopad:1}}if(S.val<=0){S={val:0,nopad:1}}}else if(b){if(E.val-k*s(E)<0){E={val:0,nopad:1}}if(S.val<=0){S={val:1,nopad:1}}}k=(S.val-E.val-f(t,A.val,M.val))/(w-s(E)-l(S));i=[E.val-k*s(E),S.val+k*l(S)]}if(g)i.reverse();return a.simpleMap(i,t.l2r||Number)}function f(e,t,r){var n=0;if(e.rangebreaks){var a=e.locateBreaks(t,r);for(var i=0;i<a.length;i++){var o=a[i];n+=o.max-o.min}}return n}function h(e,t,r){var n=.05*t._length;var i=t._anchorAxis||{};if((t.ticklabelposition||"").indexOf("inside")!==-1||(i.ticklabelposition||"").indexOf("inside")!==-1){var o=t.autorange==="reversed";if(!o){var s=a.simpleMap(t.range,t.r2l);o=s[1]<s[0]}if(o)r=!r}var l=0;if(!u(e,t._id)){l=d(t,r)}n=Math.max(l,n);if(t.constrain==="domain"&&t._inputDomain){n*=(t._inputDomain[1]-t._inputDomain[0])/(t.domain[1]-t.domain[0])}return function e(t){if(t.nopad)return 0;return t.pad+(t.extrapad?n:l)}}var p=3;function d(e,t){var r=0;var n=e._anchorAxis||{};if((n.ticklabelposition||"").indexOf("inside")!==-1){if(!t&&(n.side==="left"||n.side==="bottom")||t&&(n.side==="top"||n.side==="right")){var i=e._id.charAt(0)==="x";if(n._vals){var o=a.deg2rad(n._tickAngles[n._id+"tick"]||0);var s=Math.abs(Math.cos(o));var l=Math.abs(Math.sin(o));n._vals.forEach(function(e){if(e.bb){var t=2*p+e.bb.width;var n=2*p+e.bb.height;r=Math.max(r,i?Math.max(t*s,n*l):Math.max(n*s,t*l))}})}if(n.ticks==="inside"&&n.ticklabelposition==="inside"){r+=n.ticklen||0}}}return r}function v(e,t,r){var n=t._id;var a=e._fullData;var i=e._fullLayout;var o=[];var s=[];var u,c,f;function h(e,t){for(u=0;u<t.length;u++){var r=e[t[u]];var a=(r._extremes||{})[n];if(r.visible===true&&a){for(c=0;c<a.min.length;c++){f=a.min[c];y(o,f.val,f.pad,{extrapad:f.extrapad})}for(c=0;c<a.max.length;c++){f=a.max[c];x(s,f.val,f.pad,{extrapad:f.extrapad})}}}}h(a,t._traceIndices);h(i.annotations||[],t._annIndices||[]);h(i.shapes||[],t._shapeIndices||[]);if(t._matchGroup&&!r){for(var p in t._matchGroup){if(p!==t._id){var d=l(e,p);var m=v(e,d,true);var g=t._length/d._length;for(c=0;c<m.min.length;c++){f=m.min[c];y(o,f.val,f.pad*g,{extrapad:f.extrapad})}for(c=0;c<m.max.length;c++){f=m.max[c];x(s,f.val,f.pad*g,{extrapad:f.extrapad})}}}}return{min:o,max:s}}function m(e,t,r){t.setScale();if(t.autorange){t.range=r?r.slice():c(e,t);t._r=t.range.slice();t._rl=a.simpleMap(t._r,t.r2l);var n=t._input;var i={};i[t._attr+".range"]=t.range;i[t._attr+".autorange"]=t.autorange;o.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,i);n.range=t.range.slice();n.autorange=t.autorange}var s=t._anchorAxis;if(s&&s.rangeslider){var l=s.rangeslider[t._name];if(l){if(l.rangemode==="auto"){l.range=c(e,t)}}s._input.rangeslider[t._name]=a.extendFlat({},l)}}function g(e,t,r){if(!r)r={};if(!e._m)e.setScale();var a=[];var o=[];var s=t.length;var l=r.padded||false;var u=r.tozero&&(e.type==="linear"||e.type==="-");var c=e.type==="log";var f=false;var h=r.vpadLinearized||false;var p,d,v,m,g,_,w,T,k;function A(e){if(Array.isArray(e)){f=true;return function(t){return Math.max(Number(e[t]||0),0)}}else{var t=Math.max(Number(e||0),0);return function(){return t}}}var M=A((e._m>0?r.ppadplus:r.ppadminus)||r.ppad||0);var E=A((e._m>0?r.ppadminus:r.ppadplus)||r.ppad||0);var S=A(r.vpadplus||r.vpad);var C=A(r.vpadminus||r.vpad);if(!f){T=Infinity;k=-Infinity;if(c){for(p=0;p<s;p++){d=t[p];if(d<T&&d>0)T=d;if(d>k&&d<i)k=d}}else{for(p=0;p<s;p++){d=t[p];if(d<T&&d>-i)T=d;if(d>k&&d<i)k=d}}t=[T,k];s=2}var L={tozero:u,extrapad:l};function I(r){v=t[r];if(!n(v))return;_=M(r);w=E(r);if(h){m=e.c2l(v)-C(r);g=e.c2l(v)+S(r)}else{T=v-C(r);k=v+S(r);if(c&&T<k/10)T=k/10;m=e.c2l(T);g=e.c2l(k)}if(u){m=Math.min(0,m);g=Math.max(0,g)}if(b(m)){y(a,m,w,L)}if(b(g)){x(o,g,_,L)}}var O=Math.min(6,s);for(p=0;p<O;p++)I(p);for(p=s-1;p>=O;p--)I(p);return{min:a,max:o,opts:r}}function y(e,t,r,n){_(e,t,r,n,w)}function x(e,t,r,n){_(e,t,r,n,T)}function _(e,t,r,n,a){var i=n.tozero;var o=n.extrapad;var s=true;for(var l=0;l<e.length&&s;l++){var u=e[l];if(a(u.val,t)&&u.pad>=r&&(u.extrapad||!o)){s=false;break}else if(a(t,u.val)&&u.pad<=r&&(o||!u.extrapad)){e.splice(l,1);l--}}if(s){var c=i&&t===0;e.push({val:t,pad:c?0:r,extrapad:c?false:o})}}function b(e){return n(e)&&Math.abs(e)<i}function w(e,t){return e<=t}function T(e,t){return e>=t}},{"../../constants/numerical":753,"../../lib":778,"../../registry":911,"./axis_ids":831,"fast-isnumeric":241}],828:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=s.strTranslate;var u=e("../../lib/svg_text_utils");var c=e("../../components/titles");var f=e("../../components/color");var h=e("../../components/drawing");var p=e("./layout_attributes");var d=e("./clean_ticks");var v=e("../../constants/numerical");var m=v.ONEMAXYEAR;var g=v.ONEAVGYEAR;var y=v.ONEMINYEAR;var x=v.ONEMAXQUARTER;var _=v.ONEAVGQUARTER;var b=v.ONEMINQUARTER;var w=v.ONEMAXMONTH;var T=v.ONEAVGMONTH;var k=v.ONEMINMONTH;var A=v.ONEWEEK;var M=v.ONEDAY;var E=M/2;var S=v.ONEHOUR;var C=v.ONEMIN;var L=v.ONESEC;var I=v.MINUS_SIGN;var O=v.BADNUM;var P=e("../../constants/alignment");var D=P.MID_SHIFT;var R=P.CAP_SHIFT;var z=P.LINE_SPACING;var N=P.OPPOSITE_SIDE;var F=3;var B=t.exports={};B.setConvert=e("./set_convert");var j=e("./axis_autotype");var U=e("./axis_ids");var H=U.idSort;var V=U.isLinked;B.id2name=U.id2name;B.name2id=U.name2id;B.cleanId=U.cleanId;B.list=U.list;B.listIds=U.listIds;B.getFromId=U.getFromId;B.getFromTrace=U.getFromTrace;var G=e("./autorange");B.getAutoRange=G.getAutoRange;B.findExtremes=G.findExtremes;var q=1e-4;function Y(e){var t=(e[1]-e[0])*q;return[e[0]-t,e[1]+t]}B.coerceRef=function(e,t,r,n,a,i){var o=n.charAt(n.length-1);var l=r._fullLayout._subplots[o+"axis"];var u=n+"ref";var c={};if(!a)a=l[0]||(typeof i==="string"?i:i[0]);if(!i)i=a;l=l.concat(l.map(function(e){return e+" domain"}));c[u]={valType:"enumerated",values:l.concat(i?typeof i==="string"?[i]:i:[]),dflt:a};return s.coerce(e,t,c,u)};B.getRefType=function(e){if(e===undefined){return e}if(e==="paper"){return"paper"}if(e==="pixel"){return"pixel"}if(/( domain)$/.test(e)){return"domain"}else{return"range"}};B.coercePosition=function(e,t,r,n,a,i){var o,l;var u=B.getRefType(n);if(u!=="range"){o=s.ensureNumber;l=r(a,i)}else{var c=B.getFromId(t,n);i=c.fraction2r(i);l=r(a,i);o=c.cleanPos}e[a]=o(l)};B.cleanPosition=function(e,t,r){var n=r==="paper"||r==="pixel"?s.ensureNumber:B.getFromId(t,r).cleanPos;return n(e)};B.redrawComponents=function(e,t){t=t?t:B.listIds(e);var r=e._fullLayout;function n(n,a,i,s){var l=o.getComponentMethod(n,a);var u={};for(var c=0;c<t.length;c++){var f=r[B.id2name(t[c])];var h=f[i];for(var p=0;p<h.length;p++){var d=h[p];if(!u[d]){l(e,d);u[d]=1;if(s)return}}}}n("annotations","drawOne","_annIndices");n("shapes","drawOne","_shapeIndices");n("images","draw","_imgIndices",true)};var W=B.getDataConversions=function(e,t,r,n){var a;var i=r==="x"||r==="y"||r==="z"?r:n;if(Array.isArray(i)){a={type:j(n,undefined,{autotypenumbers:e._fullLayout.autotypenumbers}),_categories:[]};B.setConvert(a);if(a.type==="category"){for(var o=0;o<n.length;o++){a.d2c(n[o])}}}else{a=B.getFromTrace(e,t,i)}if(a)return{d2c:a.d2c,c2d:a.c2d};if(i==="ids")return{d2c:Z,c2d:Z};return{d2c:X,c2d:X}};function X(e){return+e}function Z(e){return String(e)}B.getDataToCoordFunc=function(e,t,r,n){return W(e,t,r,n).d2c};B.counterLetter=function(e){var t=e.charAt(0);if(t==="x")return"y";if(t==="y")return"x"};B.minDtick=function(e,t,r,n){if(["log","category","multicategory"].indexOf(e.type)!==-1||!n){e._minDtick=0}else if(e._minDtick===undefined){e._minDtick=t;e._forceTick0=r}else if(e._minDtick){if((e._minDtick/t+1e-6)%1<2e-6&&((r-e._forceTick0)/t%1+1.000001)%1<2e-6){e._minDtick=t;e._forceTick0=r}else if((t/e._minDtick+1e-6)%1>2e-6||((r-e._forceTick0)/e._minDtick%1+1.000001)%1>2e-6){e._minDtick=0}}};B.saveRangeInitial=function(e,t){var r=B.list(e,"",true);var n=false;for(var a=0;a<r.length;a++){var i=r[a];var o=i._rangeInitial===undefined;var s=o||!(i.range[0]===i._rangeInitial[0]&&i.range[1]===i._rangeInitial[1]);if(o&&i.autorange===false||t&&s){i._rangeInitial=i.range.slice();n=true}}return n};B.saveShowSpikeInitial=function(e,t){var r=B.list(e,"",true);var n=false;var a="on";for(var i=0;i<r.length;i++){var o=r[i];var s=o._showSpikeInitial===undefined;var l=s||!(o.showspikes===o._showspikes);if(s||t&&l){o._showSpikeInitial=o.showspikes;n=true}if(a==="on"&&!o.showspikes){a="off"}}e._fullLayout._cartesianSpikesEnabled=a;return n};B.autoBin=function(e,t,r,n,i,o){var l=s.aggNums(Math.min,null,e);var u=s.aggNums(Math.max,null,e);if(t.type==="category"||t.type==="multicategory"){return{start:l-.5,end:u+.5,size:Math.max(1,Math.round(o)||1),_dataSpan:u-l}}if(!i)i=t.calendar;var c;if(t.type==="log"){c={type:"linear",range:[l,u]}}else{c={type:t.type,range:s.simpleMap([l,u],t.c2r,0,i),calendar:i}}B.setConvert(c);o=o&&d.dtick(o,c.type);if(o){c.dtick=o;c.tick0=d.tick0(undefined,c.type,i)}else{var f;if(r)f=(u-l)/r;else{var h=s.distinctVals(e);var p=Math.pow(10,Math.floor(Math.log(h.minDiff)/Math.LN10));var v=p*s.roundUp(h.minDiff/p,[.9,1.9,4.9,9.9],true);f=Math.max(v,2*s.stdev(e)/Math.pow(e.length,n?.25:.4));if(!a(f))f=1}B.autoTicks(c,f)}var m=c.dtick;var g=B.tickIncrement(B.tickFirst(c),m,"reverse",i);var y,x;if(typeof m==="number"){g=K(g,e,c,l,u);x=1+Math.floor((u-g)/m);y=g+x*m}else{if(c.dtick.charAt(0)==="M"){g=J(g,e,m,l,i)}y=g;x=0;while(y<=u){y=B.tickIncrement(y,m,false,i);x++}}return{start:t.c2r(g,0,i),end:t.c2r(y,0,i),size:m,_dataSpan:u-l}};function K(e,t,r,n,i){var o=0;var s=0;var l=0;var u=0;function c(t){return(1+(t-e)*100/r.dtick)%100<2}for(var f=0;f<t.length;f++){if(t[f]%1===0)l++;else if(!a(t[f]))u++;if(c(t[f]))o++;if(c(t[f]+r.dtick/2))s++}var h=t.length-u;if(l===h&&r.type!=="date"){if(r.dtick<1){e=n-.5*r.dtick}else{e-=.5;if(e+r.dtick<n)e+=r.dtick}}else if(s<h*.1){if(o>h*.3||c(n)||c(i)){var p=r.dtick/2;e+=e+p<n?p:-p}}return e}function J(e,t,r,n,a){var i=s.findExactDates(t,a);var o=.8;if(i.exactDays>o){var l=Number(r.substr(1));if(i.exactYears>o&&l%12===0){e=B.tickIncrement(e,"M6","reverse")+M*1.5}else if(i.exactMonths>o){e=B.tickIncrement(e,"M1","reverse")+M*15.5}else{e-=E}var u=B.tickIncrement(e,r);if(u<=n)return u}return e}B.prepTicks=function(e,t){var r=s.simpleMap(e.range,e.r2l,undefined,undefined,t);e._dtickInit=e.dtick;e._tick0Init=e.tick0;if(e.tickmode==="auto"||!e.dtick){var n=e.nticks;var a;if(!n){if(e.type==="category"||e.type==="multicategory"){a=e.tickfont?(e.tickfont.size||12)*1.2:15;n=e._length/a}else{a=e._id.charAt(0)==="y"?40:80;n=s.constrain(e._length/a,4,9)+1}if(e._name==="radialaxis")n*=2}if(e.tickmode==="array")n*=100;e._roughDTick=Math.abs(r[1]-r[0])/n;B.autoTicks(e,e._roughDTick);if(e._minDtick>0&&e.dtick<e._minDtick*2){e.dtick=e._minDtick;e.tick0=e.l2r(e._forceTick0)}}if(e.ticklabelmode==="period"){$(e)}if(!e.tick0){e.tick0=e.type==="date"?"2000-01-01":0}if(e.type==="date"&&e.dtick<.1)e.dtick=.1;ce(e)};function Q(e){return+e.substring(1)}function $(e){var t;function r(){return!(a(e.dtick)||e.dtick.charAt(0)!=="M")}var n=r();var i=B.getTickFormat(e);if(i){var o=e._dtickInit!==e.dtick;if(!/%[fLQsSMX]/.test(i)){if(/%[HI]/.test(i)){t=S;if(o&&!n&&e.dtick<S)e.dtick=S}else if(/%p/.test(i)){t=E;if(o&&!n&&e.dtick<E)e.dtick=E}else if(/%[Aadejuwx]/.test(i)){t=M;if(o&&!n&&e.dtick<M)e.dtick=M}else if(/%[UVW]/.test(i)){t=A;if(o&&!n&&e.dtick<A)e.dtick=A}else if(/%[Bbm]/.test(i)){t=T;if(o&&(n?Q(e.dtick)<1:e.dtick<k))e.dtick="M1"}else if(/%[q]/.test(i)){t=_;if(o&&(n?Q(e.dtick)<3:e.dtick<b))e.dtick="M3"}else if(/%[Yy]/.test(i)){t=g;if(o&&(n?Q(e.dtick)<12:e.dtick<y))e.dtick="M12"}}}n=r();if(n&&e.tick0===e._dowTick0){e.tick0=e._rawTick0}e._definedDelta=t}function ee(e,t,r){for(var n=0;n<e.length;n++){var a=e[n].value;var i=n;var o=n+1;if(n<e.length-1){i=n;o=n+1}else if(n>0){i=n-1;o=n}else{i=n;o=n}var s=e[i].value;var l=e[o].value;var u=Math.abs(l-s);var c=r||u;var f=0;if(c>=y){if(u>=y&&u<=m){f=u}else{f=g}}else if(r===_&&c>=b){if(u>=b&&u<=x){f=u}else{f=_}}else if(c>=k){if(u>=k&&u<=w){f=u}else{f=T}}else if(r===A&&c>=A){f=A}else if(c>=M){f=M}else if(r===E&&c>=E){f=E}else if(r===S&&c>=S){f=S}var h;if(f>=u){f=u;h=true}var p=a+f;if(t.rangebreaks&&f>0){var d=84;var v=0;for(var C=0;C<d;C++){var L=(C+.5)/d;if(t.maskBreaks(a*(1-L)+L*p)!==O)v++}f*=v/d;if(!f){e[n].drop=true}if(h&&u>A)f=u}if(f>0||n===0){e[n].periodX=a+f/2}}}B.calcTicks=function e(t,r){B.prepTicks(t,r);var n=s.simpleMap(t.range,t.r2l,undefined,undefined,r);if(t.tickmode==="array")return te(t);var i=Y(n);var o=i[0];var l=i[1];var u=n[1]<n[0];var c=Math.min(n[0],n[1]);var f=Math.max(n[0],n[1]);var h=t.type==="log"&&!(a(t.dtick)||t.dtick.charAt(0)==="L");var p=t.ticklabelmode==="period";t._tmin=B.tickFirst(t,r);if(t._tmin<o!==u)return[];if(t.type==="category"||t.type==="multicategory"){l=u?Math.max(-.5,l):Math.min(t._categories.length-.5,l)}var d=t._tmin;if(t.rangebreaks&&t._tick0Init!==t.tick0){d=qe(d,t);if(!u){d=B.tickIncrement(d,t.dtick,!u,t.calendar)}}if(p){d=B.tickIncrement(d,t.dtick,!u,t.calendar)}var v=Math.max(1e3,t._length||0);var m=[];var g=null;for(;u?d>=l:d<=l;d=B.tickIncrement(d,t.dtick,u,t.calendar)){if(t.rangebreaks){if(!u){if(d<o)continue;if(t.maskBreaks(d)===O&&qe(d,t)>=f)break}}if(m.length>v||d===g)break;g=d;var y=false;if(h&&d!==(d|0)){y=true}m.push({minor:y,value:d})}if(p)ee(m,t,t._definedDelta);var x;if(t.rangebreaks){var _=t._id.charAt(0)==="y";var b=1;if(t.tickmode==="auto"){b=t.tickfont?t.tickfont.size:12}var w=NaN;for(x=m.length-1;x>-1;x--){if(m[x].drop){m.splice(x,1);continue}m[x].value=qe(m[x].value,t);var T=t.c2p(m[x].value);if(_?w>T-b:w<T+b){m.splice(u?x+1:x,1)}else{w=T}}}if(Ge(t)&&Math.abs(n[1]-n[0])===360){m.pop()}t._tmax=(m[m.length-1]||{}).value;t._prevDateHead="";t._inCalcTicks=true;var k=[];var A,M;for(x=0;x<m.length;x++){var E=m[x].minor;var S=m[x].value;A=B.tickText(t,S,false,E);M=m[x].periodX;if(M!==undefined){A.periodX=M;if(M>f||M<c){if(M>f)A.periodX=f;if(M<c)A.periodX=c;A.text=" ";t._prevDateHead=""}}k.push(A)}t._inCalcTicks=false;return k};function te(e){var t=e.tickvals;var r=e.ticktext;var n=new Array(t.length);var a=s.simpleMap(e.range,e.r2l);var i=Y(a);var o=Math.min(i[0],i[1]);var l=Math.max(i[0],i[1]);var u=0;if(!Array.isArray(r))r=[];var c=e.type==="category"?e.d2l_noadd:e.d2l;if(e.type==="log"&&String(e.dtick).charAt(0)!=="L"){e.dtick="L"+Math.pow(10,Math.floor(Math.min(e.range[0],e.range[1]))-1)}for(var f=0;f<t.length;f++){var h=c(t[f]);if(h>o&&h<l){if(r[f]===undefined)n[u]=B.tickText(e,h);else n[u]=fe(e,h,String(r[f]));u++}}if(u<t.length)n.splice(u,t.length-u);if(e.rangebreaks){n=n.filter(function(t){return e.maskBreaks(t.x)!==O})}return n}var re=[2,5,10];var ne=[1,2,3,6,12];var ae=[1,2,5,10,15,30];var ie=[1,2,3,7,14];var oe=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1];var se=[-.301,0,.301,.699,1];var le=[15,30,45,90,180];function ue(e,t,r){return t*s.roundUp(e/t,r)}B.autoTicks=function(e,t){var r;function n(e){return Math.pow(e,Math.floor(Math.log(t)/Math.LN10))}if(e.type==="date"){e.tick0=s.dateTick0(e.calendar,0);var i=2*t;if(i>g){t/=g;r=n(10);e.dtick="M"+12*ue(t,r,re)}else if(i>T){t/=T;e.dtick="M"+ue(t,1,ne)}else if(i>M){e.dtick=ue(t,M,e._hasDayOfWeekBreaks?[1,2,7,14]:ie);var o=B.getTickFormat(e);var l=e.ticklabelmode==="period";if(l)e._rawTick0=e.tick0;if(/%[uVW]/.test(o)){e.tick0=s.dateTick0(e.calendar,2)}else{e.tick0=s.dateTick0(e.calendar,1)}if(l)e._dowTick0=e.tick0}else if(i>S){e.dtick=ue(t,S,ne)}else if(i>C){e.dtick=ue(t,C,ae)}else if(i>L){e.dtick=ue(t,L,ae)}else{r=n(10);e.dtick=ue(t,r,re)}}else if(e.type==="log"){e.tick0=0;var u=s.simpleMap(e.range,e.r2l);if(t>.7){e.dtick=Math.ceil(t)}else if(Math.abs(u[1]-u[0])<1){var c=1.5*Math.abs((u[1]-u[0])/t);t=Math.abs(Math.pow(10,u[1])-Math.pow(10,u[0]))/c;r=n(10);e.dtick="L"+ue(t,r,re)}else{e.dtick=t>.3?"D2":"D1"}}else if(e.type==="category"||e.type==="multicategory"){e.tick0=0;e.dtick=Math.ceil(Math.max(t,1))}else if(Ge(e)){e.tick0=0;r=1;e.dtick=ue(t,r,le)}else{e.tick0=0;r=n(10);e.dtick=ue(t,r,re)}if(e.dtick===0)e.dtick=1;if(!a(e.dtick)&&typeof e.dtick!=="string"){var f=e.dtick;e.dtick=1;throw"ax.dtick error: "+String(f)}};function ce(e){var t=e.dtick;e._tickexponent=0;if(!a(t)&&typeof t!=="string"){t=1}if(e.type==="category"||e.type==="multicategory"){e._tickround=null}if(e.type==="date"){var r=e.r2l(e.tick0);var n=e.l2r(r).replace(/(^-|i)/g,"");var i=n.length;if(String(t).charAt(0)==="M"){if(i>10||n.substr(5)!=="01-01")e._tickround="d";else e._tickround=+t.substr(1)%12===0?"y":"m"}else if(t>=M&&i<=10||t>=M*15)e._tickround="d";else if(t>=C&&i<=16||t>=S)e._tickround="M";else if(t>=L&&i<=19||t>=C)e._tickround="S";else{var o=e.l2r(r+t).replace(/^-/,"").length;e._tickround=Math.max(i,o)-20;if(e._tickround<0)e._tickround=4}}else if(a(t)||t.charAt(0)==="L"){var s=e.range.map(e.r2d||Number);if(!a(t))t=Number(t.substr(1));e._tickround=2-Math.floor(Math.log(t)/Math.LN10+.01);var l=Math.max(Math.abs(s[0]),Math.abs(s[1]));var u=Math.floor(Math.log(l)/Math.LN10+.01);var c=e.minexponent===undefined?3:e.minexponent;if(Math.abs(u)>c){if(_e(e.exponentformat)&&!be(u)){e._tickexponent=3*Math.round((u-1)/3)}else e._tickexponent=u}}else{e._tickround=null}}B.tickIncrement=function(e,t,r,i){var o=r?-1:1;if(a(t))return s.increment(e,o*t);var l=t.charAt(0);var u=o*Number(t.substr(1));if(l==="M")return s.incrementMonth(e,u,i);if(l==="L")return Math.log(Math.pow(10,e)+u)/Math.LN10;if(l==="D"){var c=t==="D2"?se:oe;var f=e+o*.01;var h=s.roundUp(s.mod(f,1),c,r);return Math.floor(f)+Math.log(n.round(Math.pow(10,h),1))/Math.LN10}throw"unrecognized dtick "+String(t)};B.tickFirst=function(e,t){var r=e.r2l||Number;var i=s.simpleMap(e.range,r,undefined,undefined,t);var o=i[1]<i[0];var l=o?Math.floor:Math.ceil;var u=Y(i)[0];var c=e.dtick;var f=r(e.tick0);if(a(c)){var h=l((u-f)/c)*c+f;if(e.type==="category"||e.type==="multicategory"){h=s.constrain(h,0,e._categories.length-1)}return h}var p=c.charAt(0);var d=Number(c.substr(1));if(p==="M"){var v=0;var m=f;var g,y,x;while(v<10){g=B.tickIncrement(m,c,o,e.calendar);if((g-u)*(m-u)<=0){if(o)return Math.min(m,g);return Math.max(m,g)}y=(u-(m+g)/2)/(g-m);x=p+(Math.abs(Math.round(y))||1)*d;m=B.tickIncrement(m,x,y<0?!o:o,e.calendar);v++}s.error("tickFirst did not converge",e);return m}else if(p==="L"){return Math.log(l((Math.pow(10,u)-f)/d)*d+f)/Math.LN10}else if(p==="D"){var _=c==="D2"?se:oe;var b=s.roundUp(s.mod(u,1),_,o);return Math.floor(u)+Math.log(n.round(Math.pow(10,b),1))/Math.LN10}else throw"unrecognized dtick "+String(c)};B.tickText=function(e,t,r,n){var a=fe(e,t);var i=e.tickmode==="array";var o=r||i;var l=e.type;var u=l==="category"?e.d2l_noadd:e.d2l;var c;if(i&&Array.isArray(e.ticktext)){var f=s.simpleMap(e.range,e.r2l);var h=(Math.abs(f[1]-f[0])-(e._lBreaks||0))/1e4;for(c=0;c<e.ticktext.length;c++){if(Math.abs(t-u(e.tickvals[c]))<h)break}if(c<e.ticktext.length){a.text=String(e.ticktext[c]);return a}}function p(n){if(n===undefined)return true;if(r)return n==="none";var a={first:e._tmin,last:e._tmax}[n];return n!=="all"&&t!==a}var d=r?"never":e.exponentformat!=="none"&&p(e.showexponent)?"hide":"";if(l==="date")he(e,a,r,o);else if(l==="log")pe(e,a,r,o,d);else if(l==="category")de(e,a);else if(l==="multicategory")ve(e,a,r);else if(Ge(e))ge(e,a,r,o,d);else me(e,a,r,o,d);if(!n){if(e.tickprefix&&!p(e.showtickprefix))a.text=e.tickprefix+a.text;if(e.ticksuffix&&!p(e.showticksuffix))a.text+=e.ticksuffix}if(e.tickson==="boundaries"||e.showdividers){var v=function(t){var r=e.l2p(t);return r>=0&&r<=e._length?t:null};a.xbnd=[v(a.x-.5),v(a.x+e.dtick-.5)]}return a};B.hoverLabelText=function(e,t,r){if(r!==O&&r!==t){return B.hoverLabelText(e,t)+" - "+B.hoverLabelText(e,r)}var n=e.type==="log"&&t<=0;var a=B.tickText(e,e.c2l(n?-t:t),"hover").text;if(n){return t===0?"0":I+a}return a};function fe(e,t,r){var n=e.tickfont||{};return{x:t,dx:0,dy:0,text:r||"",fontSize:n.size,font:n.family,fontColor:n.color}}function he(e,t,r,n){var i=e._tickround;var o=r&&e.hoverformat||B.getTickFormat(e);if(n){if(a(i))i=4;else i={y:"m",m:"d",d:"M",M:"S",S:4}[i]}var l=s.formatDate(t.x,o,i,e._dateFormat,e.calendar,e._extraFormat);var u;var c=l.indexOf("\n");if(c!==-1){u=l.substr(c+1);l=l.substr(0,c)}if(n){if(l==="00:00:00"||l==="00:00"){l=u;u=""}else if(l.length===8){l=l.replace(/:00$/,"")}}if(u){if(r){if(i==="d")l+=", "+u;else l=u+(l?", "+l:"")}else{if(!e._inCalcTicks||e._prevDateHead!==u){e._prevDateHead=u;l+="<br>"+u}else{var f=(e.ticklabelposition||"").indexOf("inside")!==-1;var h=e._realSide||e.side;if(!f&&h==="top"||f&&h==="bottom"){l+="<br> "}}}}t.text=l}function pe(e,t,r,n,i){var o=e.dtick;var l=t.x;var u=e.tickformat;var c=typeof o==="string"&&o.charAt(0);if(i==="never"){i=""}if(n&&c!=="L"){o="L3";c="L"}if(u||c==="L"){t.text=we(Math.pow(10,l),e,i,n)}else if(a(o)||c==="D"&&s.mod(l+.01,1)<.1){var f=Math.round(l);var h=Math.abs(f);var p=e.exponentformat;if(p==="power"||_e(p)&&be(f)){if(f===0)t.text=1;else if(f===1)t.text="10";else t.text="10<sup>"+(f>1?"":I)+h+"</sup>";t.fontSize*=1.25}else if((p==="e"||p==="E")&&h>2){t.text="1"+p+(f>0?"+":I)+h}else{t.text=we(Math.pow(10,l),e,"","fakehover");if(o==="D1"&&e._id.charAt(0)==="y"){t.dy-=t.fontSize/6}}}else if(c==="D"){t.text=String(Math.round(Math.pow(10,s.mod(l,1))));t.fontSize*=.75}else throw"unrecognized dtick "+String(o);if(e.dtick==="D1"){var d=String(t.text).charAt(0);if(d==="0"||d==="1"){if(e._id.charAt(0)==="y"){t.dx-=t.fontSize/4}else{t.dy+=t.fontSize/2;t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(l<0?.5:.25)}}}}function de(e,t){var r=e._categories[Math.round(t.x)];if(r===undefined)r="";t.text=String(r)}function ve(e,t,r){var n=Math.round(t.x);var a=e._categories[n]||[];var i=a[1]===undefined?"":String(a[1]);var o=a[0]===undefined?"":String(a[0]);if(r){t.text=o+" - "+i}else{t.text=i;t.text2=o}}function me(e,t,r,n,a){if(a==="never"){a=""}else if(e.showexponent==="all"&&Math.abs(t.x/e.dtick)<1e-6){a="hide"}t.text=we(t.x,e,a,n)}function ge(e,t,r,n,a){if(e.thetaunit==="radians"&&!r){var i=t.x/180;if(i===0){t.text="0"}else{var o=ye(i);if(o[1]>=100){t.text=we(s.deg2rad(t.x),e,a,n)}else{var l=t.x<0;if(o[1]===1){if(o[0]===1)t.text="π";else t.text=o[0]+"π"}else{t.text=["<sup>",o[0],"</sup>","⁄","<sub>",o[1],"</sub>","π"].join("")}if(l)t.text=I+t.text}}}else{t.text=we(t.x,e,a,n)}}function ye(e){function t(e,t){return Math.abs(e-t)<=1e-6}function r(e,n){return t(n,0)?e:r(n,e%n)}function n(e){var r=1;while(!t(Math.round(e*r)/r,e)){r*=10}return r}var a=n(e);var i=e*a;var o=Math.abs(r(i,a));return[Math.round(i/o),Math.round(a/o)]}var xe=["f","p","n","μ","m","","k","M","G","T"];function _e(e){return e==="SI"||e==="B"}function be(e){return e>14||e<-15}function we(e,t,r,n){var i=e<0;var o=t._tickround;var l=r||t.exponentformat||"B";var u=t._tickexponent;var c=B.getTickFormat(t);var f=t.separatethousands;if(n){var h={exponentformat:l,minexponent:t.minexponent,dtick:t.showexponent==="none"?t.dtick:a(e)?Math.abs(e)||1:1,range:t.showexponent==="none"?t.range.map(t.r2d):[0,e||1]};ce(h);o=(Number(h._tickround)||0)+4;u=h._tickexponent;if(t.hoverformat)c=t.hoverformat}if(c)return t._numFormat(c)(e).replace(/-/g,I);var p=Math.pow(10,-o)/2;if(l==="none")u=0;e=Math.abs(e);if(e<p){e="0";i=false}else{e+=p;if(u){e*=Math.pow(10,-u);o+=u}if(o===0)e=String(Math.floor(e));else if(o<0){e=String(Math.round(e));e=e.substr(0,e.length+o);for(var d=o;d<0;d++)e+="0"}else{e=String(e);var v=e.indexOf(".")+1;if(v)e=e.substr(0,v+o).replace(/\.?0+$/,"")}e=s.numSeparate(e,t._separators,f)}if(u&&l!=="hide"){if(_e(l)&&be(u))l="power";var m;if(u<0)m=I+-u;else if(l!=="power")m="+"+u;else m=String(u);if(l==="e"||l==="E"){e+=l+m}else if(l==="power"){e+="×10<sup>"+m+"</sup>"}else if(l==="B"&&u===9){e+="B"}else if(_e(l)){e+=xe[u/3+5]}}if(i)return I+e;return e}B.getTickFormat=function(e){var t;function r(e){return typeof e!=="string"?e:Number(e.replace("M",""))*T}function n(e,t){var r=["L","D"];if(typeof e===typeof t){if(typeof e==="number"){return e-t}else{var n=r.indexOf(e.charAt(0));var a=r.indexOf(t.charAt(0));if(n===a){return Number(e.replace(/(L|D)/g,""))-Number(t.replace(/(L|D)/g,""))}else{return n-a}}}else{return typeof e==="number"?1:-1}}function a(e,t,r){var n=r||function(e){return e};var a=t[0];var i=t[1];return(!a&&typeof a!=="number"||n(a)<=n(e))&&(!i&&typeof i!=="number"||n(i)>=n(e))}function i(e,t){var r=t[0]===null;var a=t[1]===null;var i=n(e,t[0])>=0;var o=n(e,t[1])<=0;return(r||i)&&(a||o)}var o,s;if(e.tickformatstops&&e.tickformatstops.length>0){switch(e.type){case"date":case"linear":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&a(e.dtick,s.dtickrange,r)){o=s;break}}break}case"log":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&i(e.dtick,s.dtickrange)){o=s;break}}break}default:}}return o?o.value:e.tickformat};B.getSubplots=function(e,t){var r=e._fullLayout._subplots;var n=r.cartesian.concat(r.gl2d||[]);var a=t?B.findSubplotsWithAxis(n,t):n;a.sort(function(e,t){var r=e.substr(1).split("y");var n=t.substr(1).split("y");if(r[0]===n[0])return+r[1]-+n[1];return+r[0]-+n[0]});return a};B.findSubplotsWithAxis=function(e,t){var r=new RegExp(t._id.charAt(0)==="x"?"^"+t._id+"y":t._id+"$");var n=[];for(var a=0;a<e.length;a++){var i=e[a];if(r.test(i))n.push(i)}return n};B.makeClipPaths=function(e){var t=e._fullLayout;if(t._hasOnlyLargeSploms)return;var r={_offset:0,_length:t.width,_id:""};var a={_offset:0,_length:t.height,_id:""};var i=B.list(e,"x",true);var o=B.list(e,"y",true);var s=[];var l,u;for(l=0;l<i.length;l++){s.push({x:i[l],y:a});for(u=0;u<o.length;u++){if(l===0)s.push({x:r,y:o[u]});s.push({x:i[l],y:o[u]})}}var c=t._clips.selectAll(".axesclip").data(s,function(e){return e.x._id+e.y._id});c.enter().append("clipPath").classed("axesclip",true).attr("id",function(e){return"clip"+t._uid+e.x._id+e.y._id}).append("rect");c.exit().remove();c.each(function(e){n.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})})};B.draw=function(e,t,r){var n=e._fullLayout;if(t==="redraw"){n._paper.selectAll("g.subplot").each(function(e){var t=e[0];var r=n._plots[t];if(r){var a=r.xaxis;var i=r.yaxis;r.xaxislayer.selectAll("."+a._id+"tick").remove();r.yaxislayer.selectAll("."+i._id+"tick").remove();r.xaxislayer.selectAll("."+a._id+"tick2").remove();r.yaxislayer.selectAll("."+i._id+"tick2").remove();r.xaxislayer.selectAll("."+a._id+"divider").remove();r.yaxislayer.selectAll("."+i._id+"divider").remove();if(r.gridlayer)r.gridlayer.selectAll("path").remove();if(r.zerolinelayer)r.zerolinelayer.selectAll("path").remove();n._infolayer.select(".g-"+a._id+"title").remove();n._infolayer.select(".g-"+i._id+"title").remove()}})}var a=!t||t==="redraw"?B.listIds(e):t;return s.syncOrAsync(a.map(function(t){return function(){if(!t)return;var n=B.getFromId(e,t);var a=B.drawOne(e,n,r);n._r=n.range.slice();n._rl=s.simpleMap(n._r,n.r2l);return a}}))};B.drawOne=function(e,t,r){r=r||{};var n,a,l;t.setScale();var u=e._fullLayout;var c=t._id;var f=c.charAt(0);var h=B.counterLetter(c);var p=u._plots[t._mainSubplot];if(!p)return;var d=p[f+"axislayer"];var v=t._mainLinePosition;var m=t._mainMirrorPosition;var g=t._vals=B.calcTicks(t);var y=[t.mirror,v,m].join("_");for(n=0;n<g.length;n++){g[n].axInfo=y}t._selections={};if(t._tickAngles)t._prevTickAngles=t._tickAngles;t._tickAngles={};t._depth=null;var x={};function _(e){var r=c+(e||"tick");if(!x[r])x[r]=Me(t,r);return x[r]}if(!t.visible)return;var b=B.makeTransTickFn(t);var w=B.makeTransTickLabelFn(t);var T;var k;var A=t.ticks==="inside";var M=t.ticks==="outside";if(t.tickson==="boundaries"){var E=Te(t,g);k=B.clipEnds(t,E);T=A?k:E}else{k=B.clipEnds(t,g);T=A&&t.ticklabelmode!=="period"?k:g}var S=t._gridVals=k;var C=Ae(t,g);if(!u._hasOnlyLargeSploms){var L=t._subplotsWith;var I={};for(n=0;n<L.length;n++){a=L[n];l=u._plots[a];var O=l[h+"axis"];var P=O._mainAxis._id;if(I[P])continue;I[P]=1;var D=f==="x"?"M0,"+O._offset+"v"+O._length:"M"+O._offset+",0h"+O._length;B.drawGrid(e,t,{vals:S,counterAxis:O,layer:l.gridlayer.select("."+c),path:D,transFn:b});B.drawZeroLine(e,t,{counterAxis:O,layer:l.zerolinelayer,path:D,transFn:b})}}var R=B.getTickSigns(t);var F=[];if(t.ticks){var j=B.makeTickPath(t,v,R[2]);var U;var H;if(t._anchorAxis&&t.mirror&&t.mirror!==true){U=B.makeTickPath(t,m,R[3]);H=j+U}else{U="";H=j}var V;if(t.showdividers&&M&&t.tickson==="boundaries"){var G={};for(n=0;n<C.length;n++){G[C[n].x]=1}V=function(e){return G[e.x]?U:H}}else{V=H}B.drawTicks(e,t,{vals:T,layer:d,path:V,transFn:b});if(t.mirror==="allticks"){F=Object.keys(t._linepositions||{})}}for(n=0;n<F.length;n++){a=F[n];l=u._plots[a];var q=t._linepositions[a]||[];var Y=B.makeTickPath(t,q[0],R[0])+B.makeTickPath(t,q[1],R[1]);B.drawTicks(e,t,{vals:T,layer:l[f+"axislayer"],path:Y,transFn:b})}var W=[];W.push(function(){return B.drawLabels(e,t,{vals:g,layer:d,transFn:w,labelFns:B.makeLabelFns(t,v)})});if(t.type==="multicategory"){var X={x:2,y:10}[f];W.push(function(){var r={x:"height",y:"width"}[f];var n=_()[r]+X+(t._tickAngles[c+"tick"]?t.tickfont.size*z:0);return B.drawLabels(e,t,{vals:ke(t,g),layer:d,cls:c+"tick2",repositionOnUpdate:true,secondary:true,transFn:b,labelFns:B.makeLabelFns(t,v+n*R[4])})});W.push(function(){t._depth=R[4]*(_("tick2")[t.side]-v);return Le(e,t,{vals:C,layer:d,path:B.makeTickPath(t,v,R[4],t._depth),transFn:b})})}else if(t.title.hasOwnProperty("standoff")){W.push(function(){t._depth=R[4]*(_()[t.side]-v)})}var Z=o.getComponentMethod("rangeslider","isVisible")(t);W.push(function(){var r=t.side.charAt(0);var n=N[t.side].charAt(0);var a=B.getPxPosition(e,t);var s=M?t.ticklen:0;var l;var c;var p;var d;if(t.automargin||Z){if(t.type==="multicategory"){l=_("tick2")}else{l=_();if(f==="x"&&r==="b"){t._depth=Math.max(l.width>0?l.bottom-a:0,s)}}}if(t.automargin){c={x:0,y:0,r:0,l:0,t:0,b:0};var v=[0,1];if(f==="x"){if(r==="b"){c[r]=t._depth}else{c[r]=t._depth=Math.max(l.width>0?a-l.top:0,s);v.reverse()}if(l.width>0){var m=l.right-(t._offset+t._length);if(m>0){c.xr=1;c.r=m}var g=t._offset-l.left;if(g>0){c.xl=0;c.l=g}}}else{if(r==="l"){c[r]=t._depth=Math.max(l.height>0?a-l.left:0,s)}else{c[r]=t._depth=Math.max(l.height>0?l.right-a:0,s);v.reverse()}if(l.height>0){var y=l.bottom-(t._offset+t._length);if(y>0){c.yb=0;c.b=y}var x=t._offset-l.top;if(x>0){c.yt=1;c.t=x}}}c[h]=t.anchor==="free"?t.position:t._anchorAxis.domain[v[0]];if(t.title.text!==u._dfltTitle[f]){c[r]+=Ie(t)+(t.title.standoff||0)}if(t.mirror&&t.anchor!=="free"){p={x:0,y:0,r:0,l:0,t:0,b:0};p[n]=t.linewidth;if(t.mirror&&t.mirror!==true)p[n]+=s;if(t.mirror===true||t.mirror==="ticks"){p[h]=t._anchorAxis.domain[v[1]]}else if(t.mirror==="all"||t.mirror==="allticks"){p[h]=[t._counterDomainMin,t._counterDomainMax][v[1]]}}}if(Z){d=o.getComponentMethod("rangeslider","autoMarginOpts")(e,t)}i.autoMargin(e,Ne(t),c);i.autoMargin(e,Fe(t),p);i.autoMargin(e,Be(t),d)});if(!r.skipTitle&&!(Z&&t.side==="bottom")){W.push(function(){return Oe(e,t)})}return s.syncOrAsync(W)};function Te(e,t){var r=[];var n;var a=function(e,t){var n=e.xbnd[t];if(n!==null){r.push(s.extendFlat({},e,{x:n}))}};if(t.length){for(n=0;n<t.length;n++){a(t[n],0)}a(t[n-1],1)}return r}function ke(e,t){var r=[];var n={};for(var a=0;a<t.length;a++){var i=t[a];if(n[i.text2]){n[i.text2].push(i.x)}else{n[i.text2]=[i.x]}}for(var o in n){r.push(fe(e,s.interp(n[o],.5),o))}return r}function Ae(e,t){var r=[];var n,a;var i=t.length&&t[t.length-1].x<t[0].x;var o=function(e,t){var n=e.xbnd[t];if(n!==null){r.push(s.extendFlat({},e,{x:n}))}};if(e.showdividers&&t.length){for(n=0;n<t.length;n++){var l=t[n];if(l.text2!==a){o(l,i?1:0)}a=l.text2}o(t[n-1],i?0:1)}return r}function Me(e,t){var r,n;var a,i;if(e._selections[t].size()){r=Infinity;n=-Infinity;a=Infinity;i=-Infinity;e._selections[t].each(function(){var e=ze(this);var t=h.bBox(e.node().parentNode);r=Math.min(r,t.top);n=Math.max(n,t.bottom);a=Math.min(a,t.left);i=Math.max(i,t.right)})}else{r=0;n=0;a=0;i=0}return{top:r,bottom:n,left:a,right:i,height:n-r,width:i-a}}B.getTickSigns=function(e){var t=e._id.charAt(0);var r={x:"top",y:"right"}[t];var n=e.side===r?1:-1;var a=[-1,1,n,-n];if(e.ticks!=="inside"===(t==="x")){a=a.map(function(e){return-e})}if(e.side){a.push({l:-1,t:-1,r:1,b:1}[e.side.charAt(0)])}return a};B.makeTransTickFn=function(e){return e._id.charAt(0)==="x"?function(t){return l(e._offset+e.l2p(t.x),0)}:function(t){return l(0,e._offset+e.l2p(t.x))}};B.makeTransTickLabelFn=function(e){var t=Se(e);var r=t[0];var n=t[1];return e._id.charAt(0)==="x"?function(t){return l(r+e._offset+e.l2p(Ee(t)),n)}:function(t){return l(n,r+e._offset+e.l2p(Ee(t)))}};function Ee(e){return e.periodX!==undefined?e.periodX:e.x}function Se(e){var t=e.ticklabelposition||"";var r=function(e){return t.indexOf(e)!==-1};var n=r("top");var a=r("left");var i=r("right");var o=r("bottom");var s=r("inside");var l=o||a||n||i;if(!l&&!s)return[0,0];var u=e.side;var c=l?(e.tickwidth||0)/2:0;var f=F;var h=e.tickfont?e.tickfont.size:12;if(o||n){c+=h*R;f+=(e.linewidth||0)/2}if(a||i){c+=(e.linewidth||0)/2;f+=F}if(s&&u==="top"){f-=h*(1-R)}if(a||n)c=-c;if(u==="bottom"||u==="right")f=-f;return[l?c:0,s?f:0]}B.makeTickPath=function(e,t,r,n){n=n!==undefined?n:e.ticklen;var a=e._id.charAt(0);var i=(e.linewidth||1)/2;return a==="x"?"M0,"+(t+i*r)+"v"+n*r:"M"+(t+i*r)+",0h"+n*r};B.makeLabelFns=function(e,t,r){var n=e.ticklabelposition||"";var i=function(e){return n.indexOf(e)!==-1};var o=i("top");var l=i("left");var u=i("right");var c=i("bottom");var f=c||l||o||u;var h=i("inside");var p=n==="inside"&&e.ticks==="inside"||!h&&e.ticks==="outside"&&e.tickson!=="boundaries";var d=0;var v=0;var m=p?e.ticklen:0;if(h){m*=-1}else if(f){m=0}if(p){d+=m;if(r){var g=s.deg2rad(r);d=m*Math.cos(g)+1;v=m*Math.sin(g)}}if(e.showticklabels&&(p||e.showline)){d+=.2*e.tickfont.size}d+=(e.linewidth||1)/2*(h?-1:1);var y={labelStandoff:d,labelShift:v};var x,_,b,w;var T=0;var k=e.side;var A=e._id.charAt(0);var M=e.tickangle;var E;if(A==="x"){E=!h&&k==="bottom"||h&&k==="top";w=E?1:-1;if(h)w*=-1;x=v*w;_=t+d*w;b=E?1:-.2;if(Math.abs(M)===90){if(h){b+=D}else{if(M===-90&&k==="bottom"){b=R}else if(M===90&&k==="top"){b=D}else{b=.5}}T=D/2*(M/90)}y.xFn=function(e){return e.dx+x+T*e.fontSize};y.yFn=function(e){return e.dy+_+e.fontSize*b};y.anchorFn=function(e,t){if(f){if(l)return"end";if(u)return"start"}if(!a(t)||t===0||t===180){return"middle"}return t*w<0!==h?"end":"start"};y.heightFn=function(t,r,n){return r<-60||r>60?-.5*n:e.side==="top"!==h?-n:0}}else if(A==="y"){E=!h&&k==="left"||h&&k==="right";w=E?1:-1;if(h)w*=-1;x=d;_=v*w;b=0;if(!h&&Math.abs(M)===90){if(M===-90&&k==="left"||M===90&&k==="right"){b=R}else{b=.5}}if(h){var S=a(M)?+M:0;if(S!==0){var C=s.deg2rad(S);T=Math.abs(Math.sin(C))*R*w;b=0}}y.xFn=function(e){return e.dx+t-(x+e.fontSize*b)*w+T*e.fontSize};y.yFn=function(e){return e.dy+_+e.fontSize*D};y.anchorFn=function(e,t){if(a(t)&&Math.abs(t)===90){return"middle"}return E?"end":"start"};y.heightFn=function(t,r,n){if(e.side==="right")r*=-1;return r<-30?-n:r<30?-.5*n:0}}return y};function Ce(e){return[e.text,e.x,e.axInfo,e.font,e.fontSize,e.fontColor].join("_")}B.drawTicks=function(e,t,r){r=r||{};var n=t._id+"tick";var a=r.vals;if(t.ticklabelmode==="period"){a=a.slice();a.shift()}var i=r.layer.selectAll("path."+n).data(t.ticks?a:[],Ce);i.exit().remove();i.enter().append("path").classed(n,1).classed("ticks",1).classed("crisp",r.crisp!==false).call(f.stroke,t.tickcolor).style("stroke-width",h.crispRound(e,t.tickwidth,1)+"px").attr("d",r.path);i.attr("transform",r.transFn)};B.drawGrid=function(e,t,r){r=r||{};var n=t._id+"grid";var a=r.vals;var i=r.counterAxis;if(t.showgrid===false){a=[]}else if(i&&B.shouldShowZeroLine(e,t,i)){var o=t.tickmode==="array";for(var s=0;s<a.length;s++){var l=a[s].x;if(o?!l:Math.abs(l)<t.dtick/100){a=a.slice(0,s).concat(a.slice(s+1));if(o)s--;else break}}}var u=r.layer.selectAll("path."+n).data(a,Ce);u.exit().remove();u.enter().append("path").classed(n,1).classed("crisp",r.crisp!==false);t._gw=h.crispRound(e,t.gridwidth,1);u.attr("transform",r.transFn).attr("d",r.path).call(f.stroke,t.gridcolor||"#ddd").style("stroke-width",t._gw+"px");if(typeof r.path==="function")u.attr("d",r.path)};B.drawZeroLine=function(e,t,r){r=r||r;var n=t._id+"zl";var a=B.shouldShowZeroLine(e,t,r.counterAxis);var i=r.layer.selectAll("path."+n).data(a?[{x:0,id:t._id}]:[]);i.exit().remove();i.enter().append("path").classed(n,1).classed("zl",1).classed("crisp",r.crisp!==false).each(function(){r.layer.selectAll("path").sort(function(e,t){return H(e.id,t.id)})});i.attr("transform",r.transFn).attr("d",r.path).call(f.stroke,t.zerolinecolor||f.defaultLine).style("stroke-width",h.crispRound(e,t.zerolinewidth,t._gw||1)+"px")};B.drawLabels=function(e,t,r){r=r||{};var i=e._fullLayout;var o=t._id;var c=o.charAt(0);var f=r.cls||o+"tick";var p=r.vals;var d=r.labelFns;var v=r.secondary?0:t.tickangle;var m=(t._prevTickAngles||{})[f];var g=r.layer.selectAll("g."+f).data(t.showticklabels?p:[],Ce);var y=[];g.enter().append("g").classed(f,1).append("text").attr("text-anchor","middle").each(function(t){var r=n.select(this);var a=e._promises.length;r.call(u.positionText,d.xFn(t),d.yFn(t)).call(h.font,t.font,t.fontSize,t.fontColor).text(t.text).call(u.convertToTspans,e);if(e._promises[a]){y.push(e._promises.pop().then(function(){x(r,v)}))}else{x(r,v)}});g.exit().remove();if(r.repositionOnUpdate){g.each(function(e){n.select(this).select("text").call(u.positionText,d.xFn(e),d.yFn(e))})}function x(e,i){var o=(t.ticklabelposition||"").indexOf("inside")!==-1;e.each(function(e){var s=n.select(this);var c=s.select(".text-math-group");var f=d.anchorFn(e,i);var p=r.transFn.call(s.node(),e)+(a(i)&&+i!==0?" rotate("+i+","+d.xFn(e)+","+(d.yFn(e)-e.fontSize/2)+")":"");var v=u.lineCount(s);var m=z*e.fontSize;var g=d.heightFn(e,a(i)?+i:0,(v-1)*m);if(g){p+=l(0,g)}if(c.empty()){var y=s.select("text");y.attr({transform:p,"text-anchor":f});if(o){y.style({opacity:100});if(t._hideOutOfRangeInsideTickLabels){t._hideOutOfRangeInsideTickLabels()}}}else{var x=h.bBox(c.node()).width;var _=x*{end:-.5,start:.5}[f];c.attr("transform",p+l(_,0))}})}t._hideOutOfRangeInsideTickLabels=undefined;if((t.ticklabelposition||"").indexOf("inside")!==-1){t._hideOutOfRangeInsideTickLabels=function(){var e=s.simpleMap(t.range,t.r2l);var r=t.l2p(e[0]);var a=t.l2p(e[1]);var i=Math.min(r,a)+t._offset;var o=Math.max(r,a)+t._offset;var l=t._id.charAt(0)==="x";g.each(function(e){var r=n.select(this);var a=r.select(".text-math-group");if(a.empty()){var s=h.bBox(r.node());var u=false;if(l){if(s.right>o)u=true;else if(s.left<i)u=true}else{if(s.bottom>o)u=true;else if(s.top+(t.tickangle?0:e.fontSize/4)<i)u=true}if(u)r.select("text").style({opacity:0})}})}}x(g,m+1?m:v);function _(){return y.length&&Promise.all(y)}var b=null;function w(){x(g,v);if(p.length&&c==="x"&&!a(v)&&(t.type!=="log"||String(t.dtick).charAt(0)!=="D")){b=0;var e=0;var n=[];var i;g.each(function(r){e=Math.max(e,r.fontSize);var a=t.l2p(r.x);var i=ze(this);var o=h.bBox(i.node());n.push({top:0,bottom:10,height:10,left:a-o.width/2,right:a+o.width/2+2,width:o.width+2})});if((t.tickson==="boundaries"||t.showdividers)&&!r.secondary){var o=2;if(t.ticks)o+=t.tickwidth/2;for(i=0;i<n.length;i++){var l=p[i].xbnd;var u=n[i];if(l[0]!==null&&u.left-t.l2p(l[0])<o||l[1]!==null&&t.l2p(l[1])-u.right<o){b=90;break}}}else{var f=p.length;var d=Math.abs((p[f-1].x-p[0].x)*t._m)/(f-1);var m=t.ticklabelposition||"";var y=function(e){return m.indexOf(e)!==-1};var _=y("top");var w=y("left");var T=y("right");var k=y("bottom");var A=k||w||_||T;var M=!A?0:(t.tickwidth||0)+2*F;var E=d<e*2.5||t.type==="multicategory";for(i=0;i<n.length-1;i++){if(s.bBoxIntersect(n[i],n[i+1],M)){b=E?90:30;break}}}if(b){x(g,b)}}}if(t._selections){t._selections[f]=g}var T=[_];if(t.automargin&&i._redrawFromAutoMarginCount&&m===90){b=90;T.push(function(){x(g,m)})}else{T.push(w)}if(t._tickAngles){T.push(function(){t._tickAngles[f]=b===null?a(v)?v:0:b})}var k=t._anchorAxis;if(k&&k.autorange&&(t.ticklabelposition||"").indexOf("inside")!==-1&&!V(i,t._id)){if(!i._insideTickLabelsAutorange){i._insideTickLabelsAutorange={}}i._insideTickLabelsAutorange[k._name+".autorange"]=k.autorange;T.push(function e(){g.each(function(e,r){var n=ze(this);t._vals[r].bb=h.bBox(n.node())})})}var A=s.syncOrAsync(T);if(A&&A.then)e._promises.push(A);return A};function Le(e,t,r){var n=t._id+"divider";var a=r.vals;var i=r.layer.selectAll("path."+n).data(a,Ce);i.exit().remove();i.enter().insert("path",":first-child").classed(n,1).classed("crisp",1).call(f.stroke,t.dividercolor).style("stroke-width",h.crispRound(e,t.dividerwidth,1)+"px");i.attr("transform",r.transFn).attr("d",r.path)}B.getPxPosition=function(e,t){var r=e._fullLayout._size;var n=t._id.charAt(0);var a=t.side;var i;if(t.anchor!=="free"){i=t._anchorAxis}else if(n==="x"){i={_offset:r.t+(1-(t.position||0))*r.h,_length:0}}else if(n==="y"){i={_offset:r.l+(t.position||0)*r.w,_length:0}}if(a==="top"||a==="left"){return i._offset}else if(a==="bottom"||a==="right"){return i._offset+i._length}};function Ie(e){var t=e.title.font.size;var r=(e.title.text.match(u.BR_TAG_ALL)||[]).length;if(e.title.hasOwnProperty("standoff")){return r?t*(R+r*z):t*R}else{return r?t*(r+1)*z:t}}function Oe(e,t){var r=e._fullLayout;var n=t._id;var a=n.charAt(0);var i=t.title.font.size;var o;if(t.title.hasOwnProperty("standoff")){o=t._depth+t.title.standoff+Ie(t)}else{var s=(t.ticklabelposition||"").indexOf("inside")!==-1;if(t.type==="multicategory"){o=t._depth}else{var l=1.5*i;if(s){l=.5*i;if(t.ticks==="outside"){l+=t.ticklen}}o=10+l+(t.linewidth?t.linewidth-1:0)}if(!s){if(a==="x"){o+=t.side==="top"?i*(t.showticklabels?1:0):i*(t.showticklabels?1.5:.5)}else{o+=t.side==="right"?i*(t.showticklabels?1:.5):i*(t.showticklabels?.5:0)}}}var u=B.getPxPosition(e,t);var f,p,d;if(a==="x"){p=t._offset+t._length/2;d=t.side==="top"?u-o:u+o}else{d=t._offset+t._length/2;p=t.side==="right"?u+o:u-o;f={rotate:"-90",offset:0}}var v;if(t.type!=="multicategory"){var m=t._selections[t._id+"tick"];v={selection:m,side:t.side};if(m&&m.node()&&m.node().parentNode){var g=h.getTranslate(m.node().parentNode);v.offsetLeft=g.x;v.offsetTop=g.y}if(t.title.hasOwnProperty("standoff")){v.pad=0}}return c.draw(e,n+"title",{propContainer:t,propName:t._name+".title.text",placeholder:r._dfltTitle[a],avoid:v,transform:f,attributes:{x:p,y:d,"text-anchor":"middle"}})}B.shouldShowZeroLine=function(e,t,r){var n=s.simpleMap(t.range,t.r2l);return n[0]*n[1]<=0&&t.zeroline&&(t.type==="linear"||t.type==="-")&&!(t.rangebreaks&&t.maskBreaks(0)===O)&&(Pe(t,0)||!De(e,t,r,n)||Re(e,t))};B.clipEnds=function(e,t){return t.filter(function(t){return Pe(e,t.x)})};function Pe(e,t){var r=e.l2p(t);return r>1&&r<e._length-1}function De(e,t,r,n){var a=r._mainAxis;if(!a)return;var i=e._fullLayout;var o=t._id.charAt(0);var s=B.counterLetter(t._id);var l=t._offset+(Math.abs(n[0])<Math.abs(n[1])===(o==="x")?0:t._length);function u(e){if(!e.showline||!e.linewidth)return false;var r=Math.max((e.linewidth+t.zerolinewidth)/2,1);function n(e){return typeof e==="number"&&Math.abs(e-l)<r}if(n(e._mainLinePosition)||n(e._mainMirrorPosition)){return true}var a=e._linepositions||{};for(var i in a){if(n(a[i][0])||n(a[i][1])){return true}}}var c=i._plots[r._mainSubplot];if(!(c.mainplotinfo||c).overlays.length){return u(r,l)}var f=B.list(e,s);for(var h=0;h<f.length;h++){var p=f[h];if(p._mainAxis===a&&u(p,l)){return true}}}function Re(e,t){var r=e._fullData;var n=t._mainSubplot;var a=t._id.charAt(0);for(var i=0;i<r.length;i++){var s=r[i];if(s.visible===true&&s.xaxis+s.yaxis===n){if(o.traceIs(s,"bar-like")&&s.orientation==={x:"h",y:"v"}[a])return true;if(s.fill&&s.fill.charAt(s.fill.length-1)===a)return true}}return false}function ze(e){var t=n.select(e);var r=t.select(".text-math-group");return r.empty()?t.select("text"):r}B.allowAutoMargin=function(e){var t=B.list(e,"",true);for(var r=0;r<t.length;r++){var n=t[r];if(n.automargin){i.allowAutoMargin(e,Ne(n));if(n.mirror){i.allowAutoMargin(e,Fe(n))}}if(o.getComponentMethod("rangeslider","isVisible")(n)){i.allowAutoMargin(e,Be(n))}}};function Ne(e){return e._id+".automargin"}function Fe(e){return Ne(e)+".mirror"}function Be(e){return e._id+".rangeslider"}B.swap=function(e,t){var r=je(e,t);for(var n=0;n<r.length;n++){He(e,r[n].x,r[n].y)}};function je(e,t){var r=[];var n,a;for(n=0;n<t.length;n++){var i=[];var o=e._fullData[t[n]].xaxis;var s=e._fullData[t[n]].yaxis;if(!o||!s)continue;for(a=0;a<r.length;a++){if(r[a].x.indexOf(o)!==-1||r[a].y.indexOf(s)!==-1){i.push(a)}}if(!i.length){r.push({x:[o],y:[s]});continue}var l=r[i[0]];var u;if(i.length>1){for(a=1;a<i.length;a++){u=r[i[a]];Ue(l.x,u.x);Ue(l.y,u.y)}}Ue(l.x,[o]);Ue(l.y,[s])}return r}function Ue(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])===-1)e.push(t[r])}}function He(e,t,r){var n=[];var a=[];var i=e.layout;var o,l;for(o=0;o<t.length;o++)n.push(B.getFromId(e,t[o]));for(o=0;o<r.length;o++)a.push(B.getFromId(e,r[o]));var u=Object.keys(p);var c=["anchor","domain","overlaying","position","side","tickangle","editType"];var f=["linear","log"];for(o=0;o<u.length;o++){var h=u[o];var d=n[0][h];var v=a[0][h];var m=true;var g=false;var y=false;if(h.charAt(0)==="_"||typeof d==="function"||c.indexOf(h)!==-1){continue}for(l=1;l<n.length&&m;l++){var x=n[l][h];if(h==="type"&&f.indexOf(d)!==-1&&f.indexOf(x)!==-1&&d!==x){g=true}else if(x!==d)m=false}for(l=1;l<a.length&&m;l++){var _=a[l][h];if(h==="type"&&f.indexOf(v)!==-1&&f.indexOf(_)!==-1&&v!==_){y=true}else if(a[l][h]!==v)m=false}if(m){if(g)i[n[0]._name].type="linear";if(y)i[a[0]._name].type="linear";Ve(i,h,n,a,e._fullLayout._dfltTitle)}}for(o=0;o<e._fullLayout.annotations.length;o++){var b=e._fullLayout.annotations[o];if(t.indexOf(b.xref)!==-1&&r.indexOf(b.yref)!==-1){s.swapAttrs(i.annotations[o],["?"])}}}function Ve(e,t,r,n,a){var i=s.nestedProperty;var o=i(e[r[0]._name],t).get();var l=i(e[n[0]._name],t).get();var u;if(t==="title"){if(o&&o.text===a.x){o.text=a.y}if(l&&l.text===a.y){l.text=a.x}}for(u=0;u<r.length;u++){i(e,r[u]._name+"."+t).set(l)}for(u=0;u<n.length;u++){i(e,n[u]._name+"."+t).set(o)}}function Ge(e){return e._id==="angularaxis"}function qe(e,t){var r=t._rangebreaks.length;for(var n=0;n<r;n++){var a=t._rangebreaks[n];if(e>=a.min&&e<a.max){return a.max}}return e}},{"../../components/color":643,"../../components/drawing":665,"../../components/titles":738,"../../constants/alignment":745,"../../constants/numerical":753,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"./autorange":827,"./axis_autotype":829,"./axis_ids":831,"./clean_ticks":833,"./layout_attributes":842,"./set_convert":848,d3:169,"fast-isnumeric":241}],829:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../constants/numerical").BADNUM;var o=a.isArrayOrTypedArray;var s=a.isDateTime;var l=a.cleanNumber;var u=Math.round;t.exports=function e(t,r,n){var a=t;var i=n.noMultiCategory;if(o(a)&&!a.length)return"-";if(!i&&v(a))return"multicategory";if(i&&Array.isArray(a[0])){var s=[];for(var l=0;l<a.length;l++){if(o(a[l])){for(var u=0;u<a[l].length;u++){s.push(a[l][u])}}}a=s}if(h(a,r))return"date";var c=n.autotypenumbers!=="strict";if(d(a,c))return"category";if(f(a,c))return"linear";return"-"};function c(e,t){return t?n(e):typeof e==="number"}function f(e,t){var r=e.length;for(var n=0;n<r;n++){if(c(e[n],t))return true}return false}function h(e,t){var r=e.length;var a=p(r);var i=0;var o=0;var l={};for(var c=0;c<r;c+=a){var f=u(c);var h=e[f];var d=String(h);if(l[d])continue;l[d]=1;if(s(h,t))i++;if(n(h))o++}return i>o*2}function p(e){return Math.max(1,(e-1)/1e3)}function d(e,t){var r=e.length;var n=p(r);var a=0;var o=0;var s={};for(var c=0;c<r;c+=n){var f=u(c);var h=e[f];var d=String(h);if(s[d])continue;s[d]=1;var v=typeof h;if(v==="boolean")o++;else if(t?l(h)!==i:v==="number")a++;else if(v==="string")o++}return o>a*2}function v(e){return o(e[0])&&o(e[1])}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],830:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../registry");var i=e("../../lib");var o=e("../array_container_defaults");var s=e("./layout_attributes");var l=e("./tick_value_defaults");var u=e("./tick_mark_defaults");var c=e("./tick_label_defaults");var f=e("./category_order_defaults");var h=e("./line_grid_defaults");var p=e("./set_convert");var d=e("./constants").WEEKDAY_PATTERN;var v=e("./constants").HOUR_PATTERN;t.exports=function e(t,r,n,v,g){var y=v.letter;var x=v.font||{};var _=v.splomStash||{};var b=n("visible",!v.visibleDflt);var w=r._template||{};var T=r.type||w.type||"-";var k;if(T==="date"){var A=a.getComponentMethod("calendars","handleDefaults");A(t,r,"calendar",v.calendar);if(!v.noTicklabelmode){k=n("ticklabelmode")}}if(!v.noTicklabelposition||T==="multicategory"){i.coerce(t,r,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:k==="period"?["outside","inside"]:y==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")}p(r,g);var M=!r.isValidRange(t.range);if(M&&v.reverseDflt)M="reversed";var E=n("autorange",M);if(E&&(T==="linear"||T==="-"))n("rangemode");n("range");r.cleanRange();f(t,r,n,v);if(T!=="category"&&!v.noHover)n("hoverformat");var S=n("color");var C=S!==s.color.dflt?S:x.color;var L=_.label||g._dfltTitle[y];c(t,r,n,T,v,{pass:1});if(!b)return r;n("title.text",L);i.coerceFont(n,"title.font",{family:x.family,size:Math.round(x.size*1.2),color:C});l(t,r,n,T);c(t,r,n,T,v,{pass:2});u(t,r,n,v);h(t,r,n,{dfltColor:S,bgColor:v.bgColor,showGrid:v.showGrid,attributes:s});if(r.showline||r.ticks)n("mirror");if(v.automargin)n("automargin");var I=T==="multicategory";if(!v.noTickson&&(T==="category"||I)&&(r.ticks||r.showgrid)){var O;if(I)O="boundaries";var P=n("tickson",O);if(P==="boundaries"){delete r.ticklabelposition}}if(I){var D=n("showdividers");if(D){n("dividercolor");n("dividerwidth")}}if(T==="date"){o(t,r,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:m});if(!r.rangebreaks.length){delete r.rangebreaks}else{for(var R=0;R<r.rangebreaks.length;R++){if(r.rangebreaks[R].pattern===d){r._hasDayOfWeekBreaks=true;break}}p(r,g);if(g._has("scattergl")||g._has("splom")){for(var z=0;z<v.data.length;z++){var N=v.data[z];if(N.type==="scattergl"||N.type==="splom"){N.visible=false;i.warn(N.type+" traces do not work on axes with rangebreaks."+" Setting trace "+N.index+" to `visible: false`.")}}}}}return r};function m(e,t,r){function a(r,n){return i.coerce(e,t,s.rangebreaks,r,n)}var o=a("enabled");if(o){var l=a("bounds");if(l&&l.length>=2){var u="";var c,f;if(l.length===2){for(c=0;c<2;c++){f=y(l[c]);if(f){u=d;break}}}var h=a("pattern",u);if(h===d){for(c=0;c<2;c++){f=y(l[c]);if(f){t.bounds[c]=l[c]=f-1}}}if(h){for(c=0;c<2;c++){f=l[c];switch(h){case d:if(!n(f)){t.enabled=false;return}f=+f;if(f!==Math.floor(f)||f<0||f>=7){t.enabled=false;return}t.bounds[c]=l[c]=f;break;case v:if(!n(f)){t.enabled=false;return}f=+f;if(f<0||f>24){t.enabled=false;return}t.bounds[c]=l[c]=f;break}}}if(r.autorange===false){var p=r.range;if(p[0]<p[1]){if(l[0]<p[0]&&l[1]>p[1]){t.enabled=false;return}}else if(l[0]>p[0]&&l[1]<p[1]){t.enabled=false;return}}}else{var m=a("values");if(m&&m.length){a("dvalue")}else{t.enabled=false;return}}}}var g={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function y(e){if(typeof e!=="string")return;return g[e.substr(0,3).toLowerCase()]}},{"../../lib":778,"../../registry":911,"../array_container_defaults":823,"./category_order_defaults":832,"./constants":834,"./layout_attributes":842,"./line_grid_defaults":844,"./set_convert":848,"./tick_label_defaults":849,"./tick_mark_defaults":850,"./tick_value_defaults":851,"fast-isnumeric":241}],831:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("./constants");r.id2name=function e(t){if(typeof t!=="string"||!t.match(a.AX_ID_PATTERN))return;var r=t.split(" ")[0].substr(1);if(r==="1")r="";return t.charAt(0)+"axis"+r};r.name2id=function e(t){if(!t.match(a.AX_NAME_PATTERN))return;var r=t.substr(5);if(r==="1")r="";return t.charAt(0)+r};r.cleanId=function e(t,r,n){var i=/( domain)$/.test(t);if(typeof t!=="string"||!t.match(a.AX_ID_PATTERN))return;if(r&&t.charAt(0)!==r)return;if(i&&!n)return;var o=t.split(" ")[0].substr(1).replace(/^0+/,"");if(o==="1")o="";return t.charAt(0)+o+(i&&n?" domain":"")};r.list=function(e,t,n){var a=e._fullLayout;if(!a)return[];var i=r.listIds(e,t);var o=new Array(i.length);var s;for(s=0;s<i.length;s++){var l=i[s];o[s]=a[l.charAt(0)+"axis"+l.substr(1)]}if(!n){var u=a._subplots.gl3d||[];for(s=0;s<u.length;s++){var c=a[u[s]];if(t)o.push(c[t+"axis"]);else o.push(c.xaxis,c.yaxis,c.zaxis)}}return o};r.listIds=function(e,t){var r=e._fullLayout;if(!r)return[];var n=r._subplots;if(t)return n[t+"axis"];return n.xaxis.concat(n.yaxis)};r.getFromId=function(e,t,n){var a=e._fullLayout;t=t===undefined||typeof t!=="string"?t:t.replace(" domain","");if(n==="x")t=t.replace(/y[0-9]*/,"");else if(n==="y")t=t.replace(/x[0-9]*/,"");return a[r.id2name(t)]};r.getFromTrace=function(e,t,a){var i=e._fullLayout;var o=null;if(n.traceIs(t,"gl3d")){var s=t.scene;if(s.substr(0,5)==="scene"){o=i[s][a+"axis"]}}else{o=r.getFromId(e,t[a+"axis"]||a)}return o};r.idSort=function(e,t){var r=e.charAt(0);var n=t.charAt(0);if(r!==n)return r>n?1:-1;return+(e.substr(1)||1)-+(t.substr(1)||1)};r.ref2id=function(e){return/^[xyz]/.test(e)?e.split(" ")[0]:false};function i(e,t){if(t&&t.length){for(var r=0;r<t.length;r++){if(t[r][e])return true}}return false}r.isLinked=function(e,t){return i(t,e._axisMatchGroups)||i(t,e._axisConstraintGroups)}},{"../../registry":911,"./constants":834}],832:[function(e,t,r){"use strict";function n(e,t){var r=t.dataAttr||e._id.charAt(0);var n={};var a;var i,o;if(t.axData){a=t.axData}else{a=[];for(i=0;i<t.data.length;i++){var s=t.data[i];if(s[r+"axis"]===e._id){a.push(s)}}}for(i=0;i<a.length;i++){var l=a[i][r];for(o=0;o<l.length;o++){var u=l[o];if(u!==null&&u!==undefined){n[u]=1}}}return Object.keys(n)}t.exports=function e(t,r,a,i){if(r.type!=="category")return;var o=t.categoryarray;var s=Array.isArray(o)&&o.length>0;var l;if(s)l="array";var u=a("categoryorder",l);var c;if(u==="array"){c=a("categoryarray")}if(!s&&u==="array"){u=r.categoryorder="trace"}if(u==="trace"){r._initialCategories=[]}else if(u==="array"){r._initialCategories=c.slice()}else{c=n(r,i).sort();if(u==="category ascending"){r._initialCategories=c}else if(u==="category descending"){r._initialCategories=c.reverse()}}}},{}],833:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../constants/numerical");var o=i.ONEDAY;var s=i.ONEWEEK;r.dtick=function(e,t){var r=t==="log";var a=t==="date";var i=t==="category";var s=a?o:1;if(!e)return s;if(n(e)){e=Number(e);if(e<=0)return s;if(i){return Math.max(1,Math.round(e))}if(a){return Math.max(.1,e)}return e}if(typeof e!=="string"||!(a||r)){return s}var l=e.charAt(0);var u=e.substr(1);u=n(u)?Number(u):0;if(u<=0||!(a&&l==="M"&&u===Math.round(u)||r&&l==="L"||r&&l==="D"&&(u===1||u===2))){return s}return e};r.tick0=function(e,t,r,i){if(t==="date"){return a.cleanDate(e,a.dateTick0(r,i%s===0?1:0))}if(i==="D1"||i==="D2"){return undefined}return n(e)?Number(e):0}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],834:[function(e,t,r){"use strict";var n=e("../../lib/regex").counter;t.exports={idRegex:{x:n("x","( domain)?"),y:n("y","( domain)?")},attrRegex:n("[xy]axis"),xAxisMatch:n("xaxis"),yAxisMatch:n("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":795}],835:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./autorange");var i=e("./axis_ids").id2name;var o=e("./layout_attributes");var s=e("./scale_zoom");var l=e("./set_convert");var u=e("../../constants/numerical").ALMOST_EQUAL;var c=e("../../constants/alignment").FROM_BL;r.handleDefaults=function(e,t,r){var a=r.axIds;var o=r.axHasImage;var s=t._axisConstraintGroups=[];var u=t._axisMatchGroups=[];var c,h,p,d,v,m,g,y;for(c=0;c<a.length;c++){d=i(a[c]);v=e[d];m=t[d];f(v,m,{axIds:a,layoutOut:t,hasImage:o[d]})}function x(e,r){for(c=0;c<e.length;c++){h=e[c];for(p in h){t[i(p)][r]=h}}}x(u,"_matchGroup");for(c=0;c<s.length;c++){h=s[c];for(p in h){m=t[i(p)];if(m.fixedrange){for(var _ in h){var b=i(_);if((e[b]||{}).fixedrange===false){n.warn("fixedrange was specified as false for axis "+b+" but was overridden because another "+"axis in its constraint group has fixedrange true")}t[b].fixedrange=true}break}}}c=0;while(c<s.length){h=s[c];for(p in h){m=t[i(p)];if(m._matchGroup&&Object.keys(m._matchGroup).length===Object.keys(h).length){s.splice(c,1);c--}break}c++}x(s,"_constraintGroup");var w=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"];var T=false;var k=false;function A(){y=m[g];if(g==="rangebreaks"){k=m._hasDayOfWeekBreaks}}for(c=0;c<u.length;c++){h=u[c];for(var M=0;M<w.length;M++){g=w[M];y=null;var E;for(p in h){d=i(p);v=e[d];m=t[d];if(!(g in m)){continue}if(!m.matches){E=m;if(g in v){A();break}}if(y===null&&g in v){A()}}if(g==="range"&&y){T=true}if(g==="autorange"&&y===null&&T){y=false}if(y===null&&g in E){y=E[g]}if(y!==null){for(p in h){m=t[i(p)];m[g]=g==="range"?y.slice():y;if(g==="rangebreaks"){m._hasDayOfWeekBreaks=k;l(m,t)}}}}}};function f(e,t,r){var a=r.axIds;var s=r.layoutOut;var l=r.hasImage;var u=s._axisConstraintGroups;var c=s._axisMatchGroups;var f=t._id;var v=f.charAt(0);var m=((s._splomAxes||{})[v]||{})[f]||{};var g=t._id;var y=g.charAt(0)==="x";t._matchGroup=null;t._constraintGroup=null;function x(r,a){return n.coerce(e,t,o,r,a)}x("constrain",l?"domain":"range");n.coerce(e,t,{constraintoward:{valType:"enumerated",values:y?["left","center","right"]:["bottom","middle","top"],dflt:y?"center":"middle"}},"constraintoward");var _=t.type;var b,w;var T=[];for(b=0;b<a.length;b++){w=a[b];if(w===g)continue;var k=s[i(w)];if(k.type===_){T.push(w)}}var A=p(u,g);if(A){var M=[];for(b=0;b<T.length;b++){w=T[b];if(!A[w])M.push(w)}T=M}var E=T.length;var S,C;if(E&&(e.matches||m.matches)){S=n.coerce(e,t,{matches:{valType:"enumerated",values:T,dflt:T.indexOf(m.matches)!==-1?m.matches:undefined}},"matches")}var L=l&&!y?t.anchor:undefined;if(E&&!S&&(e.scaleanchor||L)){C=n.coerce(e,t,{scaleanchor:{valType:"enumerated",values:T}},"scaleanchor",L)}if(S){t._matchGroup=d(c,g,S,1);var I=s[i(S)];var O=h(s,t)/h(s,I);if(y!==(S.charAt(0)==="x")){O=(y?"x":"y")+O}d(u,g,S,O)}else if(e.matches&&a.indexOf(e.matches)!==-1){n.warn("ignored "+t._name+'.matches: "'+e.matches+'" to avoid an infinite loop')}if(C){var P=x("scaleratio");if(!P)P=t.scaleratio=1;d(u,g,C,P)}else if(e.scaleanchor&&a.indexOf(e.scaleanchor)!==-1){n.warn("ignored "+t._name+'.scaleanchor: "'+e.scaleanchor+'" to avoid either an infinite loop '+"and possibly inconsistent scaleratios, or because this axis "+"declares a *matches* constraint.")}}function h(e,t){var r=t.domain;if(!r){r=e[i(t.overlaying)].domain}return r[1]-r[0]}function p(e,t){for(var r=0;r<e.length;r++){if(e[r][t]){return e[r]}}return null}function d(e,t,r,n){var a,i,o,s,l;var u=p(e,t);if(u===null){u={};u[t]=1;l=e.length;e.push(u)}else{l=e.indexOf(u)}var c=Object.keys(u);for(a=0;a<e.length;a++){o=e[a];if(a!==l&&o[r]){var f=o[r];for(i=0;i<c.length;i++){s=c[i];o[s]=v(f,v(n,u[s]))}e.splice(l,1);return}}if(n!==1){for(i=0;i<c.length;i++){var h=c[i];u[h]=v(n,u[h])}}u[r]=1}function v(e,t){var r="";var n="";var a,i;if(typeof e==="string"){r=e.match(/^[xy]*/)[0];a=r.length;e=+e.substr(a)}if(typeof t==="string"){n=t.match(/^[xy]*/)[0];i=n.length;t=+t.substr(i)}var o=e*t;if(!a&&!i){return o}if(!a||!i||r.charAt(0)===n.charAt(0)){return r+n+e*t}if(a===i){return o}return(a>i?r.substr(i):n.substr(a))+o}function m(e,t){var r=t._size;var n=r.h/r.w;var a={};var i=Object.keys(e);for(var o=0;o<i.length;o++){var s=i[o];var l=e[s];if(typeof l==="string"){var u=l.match(/^[xy]*/)[0];var c=u.length;l=+l.substr(c);var f=u.charAt(0)==="y"?n:1/n;for(var h=0;h<c;h++){l*=f}}a[s]=l}return a}r.enforce=function e(t){var r=t._fullLayout;var n=r._axisConstraintGroups||[];var o,l,c,f,h,p,d,v;for(o=0;o<n.length;o++){c=m(n[o],r);var y=Object.keys(c);var x=Infinity;var _=0;var b=Infinity;var w={};var T={};var k=false;for(l=0;l<y.length;l++){f=y[l];T[f]=h=r[i(f)];if(h._inputDomain)h.domain=h._inputDomain.slice();else h._inputDomain=h.domain.slice();if(!h._inputRange)h._inputRange=h.range.slice();h.setScale();w[f]=p=Math.abs(h._m)/c[f];x=Math.min(x,p);if(h.constrain==="domain"||!h._constraintShrinkable){b=Math.min(b,p)}delete h._constraintShrinkable;_=Math.max(_,p);if(h.constrain==="domain")k=true}if(x>u*_&&!k)continue;for(l=0;l<y.length;l++){f=y[l];p=w[f];h=T[f];d=h.constrain;if(p!==b||d==="domain"){v=p/b;if(d==="range"){s(h,v)}else{var A=h._inputDomain;var M=(h.domain[1]-h.domain[0])/(A[1]-A[0]);var E=(h.r2l(h.range[1])-h.r2l(h.range[0]))/(h.r2l(h._inputRange[1])-h.r2l(h._inputRange[0]));v/=M;if(v*E<1){h.domain=h._input.domain=A.slice();s(h,v);continue}if(E<1){h.range=h._input.range=h._inputRange.slice();v*=E}if(h.autorange){var S=h.r2l(h.range[0]);var C=h.r2l(h.range[1]);var L=(S+C)/2;var I=L;var O=L;var P=Math.abs(C-L);var D=L-P*v*1.0001;var R=L+P*v*1.0001;var z=a.makePadFn(r,h,0);var N=a.makePadFn(r,h,1);g(h,v);var F=Math.abs(h._m);var B=a.concatExtremes(t,h);var j=B.min;var U=B.max;var H;var V;for(V=0;V<j.length;V++){H=j[V].val-z(j[V])/F;if(H>D&&H<I){I=H}}for(V=0;V<U.length;V++){H=U[V].val+N(U[V])/F;if(H<R&&H>O){O=H}}var G=(O-I)/(2*P);v/=G;I=h.l2r(I);O=h.l2r(O);h.range=h._input.range=S<C?[I,O]:[O,I]}g(h,v)}}}}};r.getAxisGroup=function e(t,r){var n=t._axisMatchGroups;for(var a=0;a<n.length;a++){var i=n[a];if(i[r])return"g"+a}return r};r.clean=function e(t,r){if(r._inputDomain){var n=false;var a=r._id;var i=t._fullLayout._axisConstraintGroups;for(var o=0;o<i.length;o++){if(i[o][a]){n=true;break}}if(!n||r.constrain!=="domain"){r._input.domain=r.domain=r._inputDomain;delete r._inputDomain}}};function g(e,t){var r=e._inputDomain;var n=c[e.constraintoward];var a=r[0]+(r[1]-r[0])*n;e.domain=e._input.domain=[a+(r[0]-a)/t,a+(r[1]-a)/t];e.setScale()}},{"../../constants/alignment":745,"../../constants/numerical":753,"../../lib":778,"./autorange":827,"./axis_ids":831,"./layout_attributes":842,"./scale_zoom":846,"./set_convert":848}],836:[function(e,t,r){"use strict";var n=e("d3");var a=e("tinycolor2");var i=e("has-passive-events");var o=e("../../registry");var s=e("../../lib");var l=s.strTranslate;var u=e("../../lib/svg_text_utils");var c=e("../../components/color");var f=e("../../components/drawing");var h=e("../../components/fx");var p=e("./axes");var d=e("../../lib/setcursor");var v=e("../../components/dragelement");var m=e("../../components/dragelement/helpers");var g=m.selectingOrDrawing;var y=m.freeMode;var x=e("../../constants/alignment").FROM_TL;var _=e("../../lib/clear_gl_canvases");var b=e("../../plot_api/subroutines").redrawReglTraces;var w=e("../plots");var T=e("./axis_ids").getFromId;var k=e("./select").prepSelect;var A=e("./select").clearSelect;var M=e("./select").selectOnClick;var E=e("./scale_zoom");var S=e("./constants");var C=S.MINDRAG;var L=S.MINZOOM;var I=true;function O(e,t,r,i,l,c,d,m){var I=e._fullLayout._zoomlayer;var O=d+m==="nsew";var P=(d+m).length===1;var G,$;var ee,te;var re,ne;var ae,ie;var oe,se;var le;var ue;var ce,fe;var he;var pe,de;var ve,me,ge;var ye;var xe;var _e;function be(){G=t.xaxis;$=t.yaxis;oe=G._length;se=$._length;ae=G._offset;ie=$._offset;ee={};ee[G._id]=G;te={};te[$._id]=$;if(d&&m){var r=t.overlays;for(var n=0;n<r.length;n++){var a=r[n].xaxis;ee[a._id]=a;var i=r[n].yaxis;te[i._id]=i}}re=Q(ee);ne=Q(te);ce=R(re,m);fe=R(ne,d);he=!fe&&!ce;ue=K(e,e._fullLayout._axisMatchGroups,ee,te);le=K(e,e._fullLayout._axisConstraintGroups,ee,te,ue);var o=le.isSubplotConstrained||ue.isSubplotConstrained;pe=m||o;de=d||o;var s=e._fullLayout;ve=s._has("scattergl");me=s._has("splom");ge=s._has("svg")}be();var we=j(fe+ce,e._fullLayout.dragmode,O);var Te=D(t,d+m+"drag",we,r,i,l,c);if(he&&!O){Te.onmousedown=null;Te.style.pointerEvents="none";return Te}var ke={element:Te,gd:e,plotinfo:t};ke.prepFn=function(t,r,n){var a=ke.dragmode;var i=e._fullLayout.dragmode;if(i!==a){ke.dragmode=i}be();xe=e._fullLayout._invScaleX;_e=e._fullLayout._invScaleY;if(!he){if(O){if(t.shiftKey){if(i==="pan")i="zoom";else if(!g(i))i="pan"}else if(t.ctrlKey){i="pan"}}else{i="pan"}}if(y(i))ke.minDrag=1;else ke.minDrag=undefined;if(g(i)){ke.xaxes=re;ke.yaxes=ne;k(t,r,n,ke,i)}else{ke.clickFn=Me;if(g(a)){Ae()}if(!he){if(i==="zoom"){ke.moveFn=Fe;ke.doneFn=je;ke.minDrag=1;Ne(t,r,n)}else if(i==="pan"){ke.moveFn=Ye;ke.doneFn=Ke}}}e._fullLayout._redrag=function(){var t=e._dragdata;if(t&&t.element===Te){var r=e._fullLayout.dragmode;if(!g(r)){be();Je([0,0,oe,se]);ke.moveFn(t.dx,t.dy)}}}};function Ae(){ke.plotinfo.selection=false;A(e)}function Me(e,r){var a=ke.gd;if(a._fullLayout._activeShapeIndex>=0){a._fullLayout._deactivateShape(a);return}var i=a._fullLayout.clickmode;q(a);if(e===2&&!P)Ze();if(O){if(i.indexOf("select")>-1){M(r,a,re,ne,t.id,ke)}if(i.indexOf("event")>-1){h.click(a,r,t.id)}}else if(e===1&&P){var s=d?$:G;var l=d==="s"||m==="w"?0:1;var c=s._name+".range["+l+"]";var f=z(s,l);var p="left";var v="middle";if(s.fixedrange)return;if(d){v=d==="n"?"top":"bottom";if(s.side==="right")p="right"}else if(m==="e")p="right";if(a._context.showAxisRangeEntryBoxes){n.select(Te).call(u.makeEditable,{gd:a,immediate:true,background:a._fullLayout.paper_bgcolor,text:String(f),fill:s.tickfont?s.tickfont.color:"#444",horizontalAlign:p,verticalAlign:v}).on("edit",function(e){var t=s.d2r(e);if(t!==undefined){o.call("_guiRelayout",a,c,t)}})}}}v.init(ke);var Ee,Se;var Ce;var Le;var Ie;var Oe;var Pe;var De;var Re;var ze;function Ne(t,r,n){var i=Te.getBoundingClientRect();Ee=r-i.left;Se=n-i.top;e._fullLayout._calcInverseTransform(e);var o=s.apply3DTransform(e._fullLayout._invTransform)(Ee,Se);Ee=o[0];Se=o[1];Ce={l:Ee,r:Ee,w:0,t:Se,b:Se,h:0};Le=e._hmpixcount?e._hmlumcount/e._hmpixcount:a(e._fullLayout.plot_bgcolor).getLuminance();Ie="M0,0H"+oe+"V"+se+"H0V0";Oe=false;Pe="xy";ze=false;De=U(I,Le,ae,ie,Ie);Re=H(I,ae,ie)}function Fe(t,r){if(e._transitioningWithDuration){return false}var n=Math.max(0,Math.min(oe,xe*t+Ee));var a=Math.max(0,Math.min(se,_e*r+Se));var i=Math.abs(n-Ee);var o=Math.abs(a-Se);Ce.l=Math.min(Ee,n);Ce.r=Math.max(Ee,n);Ce.t=Math.min(Se,a);Ce.b=Math.max(Se,a);function s(){Pe="";Ce.r=Ce.l;Ce.t=Ce.b;Re.attr("d","M0,0Z")}if(le.isSubplotConstrained){if(i>L||o>L){Pe="xy";if(i/oe>o/se){o=i*se/oe;if(Se>a)Ce.t=Se-o;else Ce.b=Se+o}else{i=o*oe/se;if(Ee>n)Ce.l=Ee-i;else Ce.r=Ee+i}Re.attr("d",Z(Ce))}else{s()}}else if(ue.isSubplotConstrained){if(i>L||o>L){Pe="xy";var l=Math.min(Ce.l/oe,(se-Ce.b)/se);var u=Math.max(Ce.r/oe,(se-Ce.t)/se);Ce.l=l*oe;Ce.r=u*oe;Ce.b=(1-l)*se;Ce.t=(1-u)*se;Re.attr("d",Z(Ce))}else{s()}}else if(!fe||o<Math.min(Math.max(i*.6,C),L)){if(i<C||!ce){s()}else{Ce.t=0;Ce.b=se;Pe="x";Re.attr("d",W(Ce,Se))}}else if(!ce||i<Math.min(o*.6,L)){Ce.l=0;Ce.r=oe;Pe="y";Re.attr("d",X(Ce,Ee))}else{Pe="xy";Re.attr("d",Z(Ce))}Ce.w=Ce.r-Ce.l;Ce.h=Ce.b-Ce.t;if(Pe)ze=true;e._dragged=ze;V(De,Re,Ce,Ie,Oe,Le);Be();e.emit("plotly_relayouting",ye);Oe=true}function Be(){ye={};if(Pe==="xy"||Pe==="x"){N(re,Ce.l/oe,Ce.r/oe,ye,le.xaxes);We("x",ye)}if(Pe==="xy"||Pe==="y"){N(ne,(se-Ce.b)/se,(se-Ce.t)/se,ye,le.yaxes);We("y",ye)}}function je(){Be();q(e);Ke();Y(e)}var Ue=[0,0,oe,se];var He=null;var Ve=S.REDRAWDELAY;var Ge=t.mainplot?e._fullLayout._plots[t.mainplot]:t;function qe(t){if(!e._context._scrollZoom.cartesian&&!e._fullLayout._enablescrollzoom){return}Ae();if(e._transitioningWithDuration){t.preventDefault();t.stopPropagation();return}be();clearTimeout(He);var r=-t.deltaY;if(!isFinite(r))r=t.wheelDelta/10;if(!isFinite(r)){s.log("Did not find wheel motion attributes: ",t);return}var n=Math.exp(-Math.min(Math.max(r,-20),20)/200);var a=Ge.draglayer.select(".nsewdrag").node().getBoundingClientRect();var i=(t.clientX-a.left)/a.width;var o=(a.bottom-t.clientY)/a.height;var l;function u(e,t,r){if(e.fixedrange)return;var n=s.simpleMap(e.range,e.r2l);var a=n[0]+(n[1]-n[0])*t;function i(t){return e.l2r(a+(t-a)*r)}e.range=n.map(i)}if(pe){if(!m)i=.5;for(l=0;l<re.length;l++){u(re[l],i,n)}We("x");Ue[2]*=n;Ue[0]+=Ue[2]*i*(1/n-1)}if(de){if(!d)o=.5;for(l=0;l<ne.length;l++){u(ne[l],o,n)}We("y");Ue[3]*=n;Ue[1]+=Ue[3]*(1-o)*(1/n-1)}Je(Ue);Xe();e.emit("plotly_relayouting",ye);He=setTimeout(function(){Ue=[0,0,oe,se];Ke()},Ve);t.preventDefault();return}if(d.length*m.length!==1){J(Te,qe)}function Ye(t,r){t=t*xe;r=r*_e;if(e._transitioningWithDuration){return}e._fullLayout._replotting=true;if(ce==="ew"||fe==="ns"){var n=ce?-t:0;var a=fe?-r:0;if(ue.isSubplotConstrained){if(ce&&fe){var i=(t/oe-r/se)/2;t=i*oe;r=-i*se;n=-t;a=-r}if(fe){n=-a*oe/se}else{a=-n*se/oe}}if(ce){F(re,t);We("x")}if(fe){F(ne,r);We("y")}Je([n,a,oe,se]);Xe();e.emit("plotly_relayouting",ye);return}function o(e,t,r){var n=1-t;var a;var i;for(var o=0;o<e.length;o++){var s=e[o];if(s.fixedrange)continue;a=s;i=s._rl[n]+(s._rl[t]-s._rl[n])/B(r/s._length);var l=s.l2r(i);if(l!==false&&l!==undefined)s.range[t]=l}return a._length*(a._rl[t]-i)/(a._rl[t]-a._rl[n])}var s=ce==="w"===(fe==="n")?1:-1;if(ce&&fe&&(le.isSubplotConstrained||ue.isSubplotConstrained)){var l=(t/oe+s*r/se)/2;t=l*oe;r=s*l*se}var u,c;if(ce==="w")t=o(re,0,t);else if(ce==="e")t=o(re,1,-t);else if(!ce)t=0;if(fe==="n")r=o(ne,1,r);else if(fe==="s")r=o(ne,0,-r);else if(!fe)r=0;u=ce==="w"?t:0;c=fe==="n"?r:0;if(le.isSubplotConstrained&&!ue.isSubplotConstrained||ue.isSubplotConstrained&&ce&&fe&&s>0){var f;if(ue.isSubplotConstrained||!ce&&fe.length===1){for(f=0;f<re.length;f++){re[f].range=re[f]._r.slice();E(re[f],1-r/se)}t=r*oe/se;u=t/2}if(ue.isSubplotConstrained||!fe&&ce.length===1){for(f=0;f<ne.length;f++){ne[f].range=ne[f]._r.slice();E(ne[f],1-t/oe)}r=t*se/oe;c=r/2}}if(!ue.isSubplotConstrained||!fe){We("x")}if(!ue.isSubplotConstrained||!ce){We("y")}var h=oe-t;var p=se-r;if(ue.isSubplotConstrained&&!(ce&&fe)){if(ce){c=u?0:t*se/oe;p=h*se/oe}else{u=c?0:r*oe/se;h=p*oe/se}}Je([u,c,h,p]);Xe();e.emit("plotly_relayouting",ye)}function We(e,t){var r=ue.isSubplotConstrained?{x:ne,y:re}[e]:ue[e+"axes"];var n=ue.isSubplotConstrained?{x:re,y:ne}[e]:[];for(var a=0;a<r.length;a++){var i=r[a];var o=i._id;var s=ue.xLinks[o]||ue.yLinks[o];var l=n[0]||ee[s]||te[s];if(l){if(t){t[i._name+".range[0]"]=t[l._name+".range[0]"];t[i._name+".range[1]"]=t[l._name+".range[1]"]}else{i.range=l.range.slice()}}}}function Xe(){var t=[];var r;function n(e){for(r=0;r<e.length;r++){if(!e[r].fixedrange)t.push(e[r]._id)}}if(pe){n(re);n(le.xaxes);n(ue.xaxes)}if(de){n(ne);n(le.yaxes);n(ue.yaxes)}ye={};for(r=0;r<t.length;r++){var a=t[r];var i=T(e,a);p.drawOne(e,i,{skipTitle:true});ye[i._name+".range[0]"]=i.range[0];ye[i._name+".range[1]"]=i.range[1]}p.redrawComponents(e,t)}function Ze(){if(e._transitioningWithDuration)return;var t=e._context.doubleClick;var r=[];if(ce)r=r.concat(re);if(fe)r=r.concat(ne);if(ue.xaxes)r=r.concat(ue.xaxes);if(ue.yaxes)r=r.concat(ue.yaxes);var n={};var a,i,s;if(t==="reset+autosize"){t="autosize";for(i=0;i<r.length;i++){a=r[i];if(a._rangeInitial&&(a.range[0]!==a._rangeInitial[0]||a.range[1]!==a._rangeInitial[1])||!a._rangeInitial&&!a.autorange){t="reset";break}}}if(t==="autosize"){for(i=0;i<r.length;i++){a=r[i];if(!a.fixedrange)n[a._name+".autorange"]=true}}else if(t==="reset"){if(ce||le.isSubplotConstrained)r=r.concat(le.xaxes);if(fe&&!le.isSubplotConstrained)r=r.concat(le.yaxes);if(le.isSubplotConstrained){if(!ce)r=r.concat(re);else if(!fe)r=r.concat(ne)}for(i=0;i<r.length;i++){a=r[i];if(!a.fixedrange){if(!a._rangeInitial){n[a._name+".autorange"]=true}else{s=a._rangeInitial;n[a._name+".range[0]"]=s[0];n[a._name+".range[1]"]=s[1]}}}}e.emit("plotly_doubleclick",null);o.call("_guiRelayout",e,n)}function Ke(){Je([0,0,oe,se]);s.syncOrAsync([w.previousPromises,function(){e._fullLayout._replotting=false;o.call("_guiRelayout",e,ye)}],e)}function Je(t){var r=e._fullLayout;var n=r._plots;var a=r._subplots.cartesian;var i,l,u,c;if(me){o.subplotsRegistry.splom.drag(e)}if(ve){for(i=0;i<a.length;i++){l=n[a[i]];u=l.xaxis;c=l.yaxis;if(l._scene){var h=s.simpleMap(u.range,u.r2l);var p=s.simpleMap(c.range,c.r2l);l._scene.update({range:[h[0],p[0],h[1],p[1]]})}}}if(me||ve){_(e);b(e)}if(ge){var v=t[2]/G._length;var g=t[3]/$._length;for(i=0;i<a.length;i++){l=n[a[i]];u=l.xaxis;c=l.yaxis;var y=(pe||ue.isSubplotConstrained)&&!u.fixedrange&&ee[u._id];var x=(de||ue.isSubplotConstrained)&&!c.fixedrange&&te[c._id];var w,T;var k,A;if(y){w=v;k=m||ue.isSubplotConstrained?t[0]:et(u,w)}else if(ue.xaHash[u._id]){w=v;k=t[0]*u._length/G._length}else if(ue.yaHash[u._id]){w=g;k=fe==="ns"?-t[1]*u._length/$._length:et(u,w,{n:"top",s:"bottom"}[fe])}else{w=Qe(u,v,g);k=$e(u,w)}if(x){T=g;A=d||ue.isSubplotConstrained?t[1]:et(c,T)}else if(ue.yaHash[c._id]){T=g;A=t[1]*c._length/$._length}else if(ue.xaHash[c._id]){T=v;A=ce==="ew"?-t[0]*c._length/G._length:et(c,T,{e:"right",w:"left"}[ce])}else{T=Qe(c,v,g);A=$e(c,T)}if(!w&&!T){continue}if(!w)w=1;if(!T)T=1;var M=u._offset-k/w;var E=c._offset-A/T;l.clipRect.call(f.setTranslate,k,A).call(f.setScale,w,T);l.plot.call(f.setTranslate,M,E).call(f.setScale,1/w,1/T);if(w!==l.xScaleFactor||T!==l.yScaleFactor){f.setPointGroupScale(l.zoomScalePts,w,T);f.setTextPointsScale(l.zoomScaleTxt,w,T)}f.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l);l.xScaleFactor=w;l.yScaleFactor=T}}}function Qe(e,t,r){if(e.fixedrange)return 0;if(pe&&le.xaHash[e._id]){return t}if(de&&(le.isSubplotConstrained?le.xaHash:le.yaHash)[e._id]){return r}return 0}function $e(e,t){if(t){e.range=e._r.slice();E(e,t);return et(e,t)}return 0}function et(e,t,r){return e._length*(1-t)*x[r||e.constraintoward||"middle"]}return Te}function P(e,t,r,n){var a=s.ensureSingle(e.draglayer,t,r,function(t){t.classed("drag",true).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)});a.call(d,n);return a.node()}function D(e,t,r,a,i,o,s){var l=P(e,"rect",t,r);n.select(l).call(f.setRect,a,i,o,s);return l}function R(e,t){for(var r=0;r<e.length;r++){if(!e[r].fixedrange)return t}return""}function z(e,t){var r=e.range[t];var a=Math.abs(r-e.range[1-t]);var i;if(e.type==="date"){return r}else if(e.type==="log"){i=Math.ceil(Math.max(0,-Math.log(a)/Math.LN10))+3;return n.format("."+i+"g")(Math.pow(10,r))}else{i=Math.floor(Math.log(Math.abs(r))/Math.LN10)-Math.floor(Math.log(a)/Math.LN10)+4;return n.format("."+String(i)+"g")(r)}}function N(e,t,r,n,a){for(var i=0;i<e.length;i++){var o=e[i];if(o.fixedrange)continue;if(o.rangebreaks){var s=o._id.charAt(0)==="y";var l=s?1-t:t;var u=s?1-r:r;n[o._name+".range[0]"]=o.l2r(o.p2l(l*o._length));n[o._name+".range[1]"]=o.l2r(o.p2l(u*o._length))}else{var c=o._rl[0];var f=o._rl[1]-c;n[o._name+".range[0]"]=o.l2r(c+f*t);n[o._name+".range[1]"]=o.l2r(c+f*r)}}if(a&&a.length){var h=(t+(1-r))/2;N(a,h,1-h,n,[])}}function F(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!n.fixedrange){if(n.rangebreaks){var a=0;var i=n._length;var o=n.p2l(a+t)-n.p2l(a);var s=n.p2l(i+t)-n.p2l(i);var l=(o+s)/2;n.range=[n.l2r(n._rl[0]-l),n.l2r(n._rl[1]-l)]}else{n.range=[n.l2r(n._rl[0]-t/n._m),n.l2r(n._rl[1]-t/n._m)]}}}}function B(e){return 1-(e>=0?Math.min(e,.9):1/(1/Math.max(e,-.3)+3.222))}function j(e,t,r){if(!e)return"pointer";if(e==="nsew"){if(r)return"";if(t==="pan")return"move";return"crosshair"}return e.toLowerCase()+"-resize"}function U(e,t,r,n,a){return e.append("path").attr("class","zoombox").style({fill:t>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",l(r,n)).attr("d",a+"Z")}function H(e,t,r){return e.append("path").attr("class","zoombox-corners").style({fill:c.background,stroke:c.defaultLine,"stroke-width":1,opacity:0}).attr("transform",l(t,r)).attr("d","M0,0Z")}function V(e,t,r,n,a,i){e.attr("d",n+"M"+r.l+","+r.t+"v"+r.h+"h"+r.w+"v-"+r.h+"h-"+r.w+"Z");G(e,t,a,i)}function G(e,t,r,n){if(!r){e.transition().style("fill",n>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);t.transition().style("opacity",1).duration(200)}}function q(e){n.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function Y(e){if(I&&e.data&&e._context.showTips){s.notifier(s._(e,"Double-click to zoom back out"),"long");I=false}}function W(e,t){return"M"+(e.l-.5)+","+(t-L-.5)+"h-3v"+(2*L+1)+"h3ZM"+(e.r+.5)+","+(t-L-.5)+"h3v"+(2*L+1)+"h-3Z"}function X(e,t){return"M"+(t-L-.5)+","+(e.t-.5)+"v-3h"+(2*L+1)+"v3ZM"+(t-L-.5)+","+(e.b+.5)+"v3h"+(2*L+1)+"v-3Z"}function Z(e){var t=Math.floor(Math.min(e.b-e.t,e.r-e.l,L)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function K(e,t,r,n,a){var i=false;var o={};var l={};var u,c,f,h;var p=(a||{}).xaHash;var d=(a||{}).yaHash;for(var v=0;v<t.length;v++){var m=t[v];for(u in r){if(m[u]){for(f in m){if(!(a&&(p[f]||d[f]))&&!(f.charAt(0)==="x"?r:n)[f]){o[f]=u}}for(c in n){if(!(a&&(p[c]||d[c]))&&m[c]){i=true}}}}for(c in n){if(m[c]){for(h in m){if(!(a&&(p[h]||d[h]))&&!(h.charAt(0)==="x"?r:n)[h]){l[h]=c}}}}}if(i){s.extendFlat(o,l);l={}}var g={};var y=[];for(f in o){var x=T(e,f);y.push(x);g[x._id]=x}var _={};var b=[];for(h in l){var w=T(e,h);b.push(w);_[w._id]=w}return{xaHash:g,yaHash:_,xaxes:y,yaxes:b,xLinks:o,yLinks:l,isSubplotConstrained:i}}function J(e,t){if(!i){if(e.onwheel!==undefined)e.onwheel=t;else if(e.onmousewheel!==undefined)e.onmousewheel=t;else if(!e.isAddedWheelEvent){e.isAddedWheelEvent=true;e.addEventListener("wheel",t,{passive:false})}}else{var r=e.onwheel!==undefined?"wheel":"mousewheel";if(e._onwheel){e.removeEventListener(r,e._onwheel)}e._onwheel=t;e.addEventListener(r,t,{passive:false})}}function Q(e){var t=[];for(var r in e)t.push(e[r]);return t}t.exports={makeDragBox:O,makeDragger:P,makeRectDragger:D,makeZoombox:U,makeCorners:H,updateZoombox:V,xyCorners:Z,transitionZoombox:G,removeZoombox:q,showDoubleClickNotifier:Y,attachWheelEventHandler:J}},{"../../components/color":643,"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../constants/alignment":745,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plot_api/subroutines":818,"../../registry":911,"../plots":891,"./axes":828,"./axis_ids":831,"./constants":834,"./scale_zoom":846,"./select":847,d3:169,"has-passive-events":441,tinycolor2:576}],837:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/fx");var i=e("../../components/dragelement");var o=e("../../lib/setcursor");var s=e("./dragbox").makeDragBox;var l=e("./constants").DRAGGERSIZE;r.initInteractions=function e(t){var o=t._fullLayout;if(t._context.staticPlot){n.select(t).selectAll(".drag").remove();return}if(!o._has("cartesian")&&!o._has("splom"))return;var u=Object.keys(o._plots||{}).sort(function(e,t){if((o._plots[e].mainplot&&true)===(o._plots[t].mainplot&&true)){var r=e.split("y");var n=t.split("y");return r[0]===n[0]?Number(r[1]||1)-Number(n[1]||1):Number(r[0]||1)-Number(n[0]||1)}return o._plots[e].mainplot?1:-1});u.forEach(function(e){var r=o._plots[e];var n=r.xaxis;var u=r.yaxis;if(!r.mainplot){var c=s(t,r,n._offset,u._offset,n._length,u._length,"ns","ew");c.onmousemove=function(r){t._fullLayout._rehover=function(){if(t._fullLayout._hoversubplot===e&&t._fullLayout._plots[e]){a.hover(t,r,e)}};a.hover(t,r,e);t._fullLayout._lasthover=c;t._fullLayout._hoversubplot=e};c.onmouseout=function(e){if(t._dragging)return;t._fullLayout._hoversubplot=null;i.unhover(t,e)};if(t._context.showAxisDragHandles){s(t,r,n._offset-l,u._offset-l,l,l,"n","w");s(t,r,n._offset+n._length,u._offset-l,l,l,"n","e");s(t,r,n._offset-l,u._offset+u._length,l,l,"s","w");s(t,r,n._offset+n._length,u._offset+u._length,l,l,"s","e")}}if(t._context.showAxisDragHandles){if(e===n._mainSubplot){var f=n._mainLinePosition;if(n.side==="top")f-=l;s(t,r,n._offset+n._length*.1,f,n._length*.8,l,"","ew");s(t,r,n._offset,f,n._length*.1,l,"","w");s(t,r,n._offset+n._length*.9,f,n._length*.1,l,"","e")}if(e===u._mainSubplot){var h=u._mainLinePosition;if(u.side!=="right")h-=l;s(t,r,h,u._offset+u._length*.1,l,u._length*.8,"ns","");s(t,r,h,u._offset+u._length*.9,l,u._length*.1,"s","");s(t,r,h,u._offset,l,u._length*.1,"n","")}}});var c=o._hoverlayer.node();c.onmousemove=function(e){e.target=t._fullLayout._lasthover;a.hover(t,e,o._hoversubplot)};c.onclick=function(e){e.target=t._fullLayout._lasthover;a.click(t,e)};c.onmousedown=function(e){t._fullLayout._lasthover.onmousedown(e)};r.updateFx(t)};r.updateFx=function(e){var t=e._fullLayout;var r=t.dragmode==="pan"?"move":"crosshair";o(t._draggers,r)}},{"../../components/dragelement":662,"../../components/fx":683,"../../lib/setcursor":799,"./constants":834,"./dragbox":836,d3:169}],838:[function(e,t,r){"use strict";function n(e){var t=e._fullLayout._zoomlayer;if(t){t.selectAll(".outline-controllers").remove()}}function a(e){var t=e._fullLayout._zoomlayer;if(t){t.selectAll(".select-outline").remove()}e._fullLayout._drawing=false}t.exports={clearOutlineControllers:n,clearSelect:a}},{}],839:[function(e,t,r){"use strict";var n=e("../../lib").strTranslate;function a(e,t){switch(e.type){case"log":return e.p2d(t);case"date":return e.p2r(t,0,e.calendar);default:return e.p2r(t)}}function i(e,t){switch(e.type){case"log":return e.d2p(t);case"date":return e.r2p(t,0,e.calendar);default:return e.r2p(t)}}function o(e){var t=e._id.charAt(0)==="y"?1:0;return function(r){return a(e,r[t])}}function s(e){return n(e.xaxis._offset,e.yaxis._offset)}t.exports={p2r:a,r2p:i,axValue:o,getTransform:s}},{"../../lib":778}],840:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("./axis_ids");t.exports=function e(t){return function e(r,o){var s=r[t];if(!Array.isArray(s))return;var l=n.subplotsRegistry.cartesian;var u=l.idRegex;var c=o._subplots;var f=c.xaxis;var h=c.yaxis;var p=c.cartesian;var d=o._has("cartesian")||o._has("gl2d");for(var v=0;v<s.length;v++){var m=s[v];if(!a.isPlainObject(m))continue;var g=i.cleanId(m.xref,"x",false);var y=i.cleanId(m.yref,"y",false);var x=u.x.test(g);var _=u.y.test(y);if(x||_){if(!d)a.pushUnique(o._basePlotModules,l);var b=false;if(x&&f.indexOf(g)===-1){f.push(g);b=true}if(_&&h.indexOf(y)===-1){h.push(y);b=true}if(b&&x&&_){p.push(g+y)}}}}}},{"../../lib":778,"../../registry":911,"./axis_ids":831}],841:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../lib");var o=e("../plots");var s=e("../../components/drawing");var l=e("../get_data").getModuleCalcData;var u=e("./axis_ids");var c=e("./constants");var f=e("../../constants/xmlns_namespaces");var h=i.ensureSingle;function p(e,t,r){return i.ensureSingle(e,t,r,function(e){e.datum(r)})}r.name="cartesian";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=c.idRegex;r.attrRegex=c.attrRegex;r.attributes=e("./attributes");r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.transitionAxes=e("./transition_axes");r.finalizeSubplots=function(e,t){var r=t._subplots;var n=r.xaxis;var a=r.yaxis;var o=r.cartesian;var s=o.concat(r.gl2d||[]);var l={};var f={};var h,p,d;for(h=0;h<s.length;h++){var v=s[h].split("y");l[v[0]]=1;f["y"+v[1]]=1}for(h=0;h<n.length;h++){p=n[h];if(!l[p]){d=(e[u.id2name(p)]||{}).anchor;if(!c.idRegex.y.test(d))d="y";o.push(p+d);s.push(p+d);if(!f[d]){f[d]=1;i.pushUnique(a,d)}}}for(h=0;h<a.length;h++){d=a[h];if(!f[d]){p=(e[u.id2name(d)]||{}).anchor;if(!c.idRegex.x.test(p))p="x";o.push(p+d);s.push(p+d);if(!l[p]){l[p]=1;i.pushUnique(n,p)}}}if(!s.length){p="";d="";for(var m in e){if(c.attrRegex.test(m)){var g=m.charAt(0);if(g==="x"){if(!p||+m.substr(5)<+p.substr(5)){p=m}}else if(!d||+m.substr(5)<+d.substr(5)){d=m}}}p=p?u.name2id(p):"x";d=d?u.name2id(d):"y";n.push(p);a.push(d);o.push(p+d)}};r.plot=function(e,t,r,n){var a=e._fullLayout;var i=a._subplots.cartesian;var o=e.calcdata;var s;if(!Array.isArray(t)){t=[];for(s=0;s<o.length;s++)t.push(s)}for(s=0;s<i.length;s++){var l=i[s];var u=a._plots[l];var c=[];var f;for(var h=0;h<o.length;h++){var p=o[h];var v=p[0].trace;if(v.xaxis+v.yaxis===l){if(t.indexOf(v.index)!==-1||v.carpet){if(f&&f[0].trace.xaxis+f[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(v.fill)!==-1&&c.indexOf(f)===-1){c.push(f)}c.push(p)}f=p}}d(e,u,c,r,n)}};function d(e,t,r,i,o){var u=c.traceLayerClasses;var f=e._fullLayout;var h=f._modules;var p,d,v;var m=[];var g=[];for(var y=0;y<h.length;y++){p=h[y];var x=p.name;var _=a.modules[x].categories;if(_.svg){var b=p.layerName||x+"layer";var w=p.plot;d=l(r,w);v=d[0];r=d[1];if(v.length){m.push({i:u.indexOf(b),className:b,plotMethod:w,cdModule:v})}if(_.zoomScale){g.push("."+b)}}}m.sort(function(e,t){return e.i-t.i});var T=t.plot.selectAll("g.mlayer").data(m,function(e){return e.className});T.enter().append("g").attr("class",function(e){return e.className}).classed("mlayer",true).classed("rangeplot",t.isRangePlot);T.exit().remove();T.order();T.each(function(r){var a=n.select(this);var l=r.className;r.plotMethod(e,t,r.cdModule,a,i,o);if(c.clipOnAxisFalseQuery.indexOf("."+l)===-1){s.setClipUrl(a,t.layerClipId,e)}});if(f._has("scattergl")){p=a.getModule("scattergl");v=l(r,p)[0];p.plot(e,t,v)}if(!e._context.staticPlot){if(t._hasClipOnAxisFalse){t.clipOnAxisFalseTraces=t.plot.selectAll(c.clipOnAxisFalseQuery.join(",")).selectAll(".trace")}if(g.length){var k=t.plot.selectAll(g.join(",")).selectAll(".trace");t.zoomScalePts=k.selectAll("path.point");t.zoomScaleTxt=k.selectAll(".textpoint")}}}r.clean=function(e,t,r,n){var a=n._plots||{};var i=t._plots||{};var o=n._subplots||{};var s;var l,c;if(n._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms){for(c in a){s=a[c];if(s.plotgroup)s.plotgroup.remove()}}var f=n._has&&n._has("gl");var h=t._has&&t._has("gl");if(f&&!h){for(c in a){s=a[c];if(s._scene)s._scene.destroy()}}if(o.xaxis&&o.yaxis){var p=u.listIds({_fullLayout:n});for(l=0;l<p.length;l++){var d=p[l];if(!t[u.id2name(d)]){n._infolayer.selectAll(".g-"+d+"title").remove()}}}var v=n._has&&n._has("cartesian");var m=t._has&&t._has("cartesian");if(v&&!m){g(n._cartesianlayer.selectAll(".subplot"),n);n._defs.selectAll(".axesclip").remove();delete n._axisConstraintGroups;delete n._axisMatchGroups}else if(o.cartesian){for(l=0;l<o.cartesian.length;l++){var x=o.cartesian[l];if(!i[x]){var _="."+x+",."+x+"-x,."+x+"-y";n._cartesianlayer.selectAll(_).remove();y(x,n)}}}};r.drawFramework=function(e){var t=e._fullLayout;var r=v(e);var a=t._cartesianlayer.selectAll(".subplot").data(r,String);a.enter().append("g").attr("class",function(e){return"subplot "+e[0]});a.order();a.exit().call(g,t);a.each(function(r){var a=r[0];var i=t._plots[a];i.plotgroup=n.select(this);m(e,i);i.draglayer=h(t._draggers,"g",a)})};r.rangePlot=function(e,t,r){m(e,t);d(e,t,r);o.style(e)};function v(e){var t=e._fullLayout;var r=t._subplots.cartesian;var n=r.length;var a,i,o,s,l,u;var c=[];var f=[];for(a=0;a<n;a++){o=r[a];s=t._plots[o];l=s.xaxis;u=s.yaxis;var h=l._mainAxis;var p=u._mainAxis;var d=h._id+p._id;var v=t._plots[d];s.overlays=[];if(d!==o&&v){s.mainplot=d;s.mainplotinfo=v;f.push(o)}else{s.mainplot=undefined;s.mainplotinfo=undefined;c.push(o)}}for(a=0;a<f.length;a++){o=f[a];s=t._plots[o];s.mainplotinfo.overlays.push(s)}var m=c.concat(f);var g=new Array(n);for(a=0;a<n;a++){o=m[a];s=t._plots[o];l=s.xaxis;u=s.yaxis;var y=[o,l.layer,u.layer,l.overlaying||"",u.overlaying||""];for(i=0;i<s.overlays.length;i++){y.push(s.overlays[i].id)}g[a]=y}return g}function m(e,t){var r=t.plotgroup;var n=t.id;var a=c.layerValue2layerClass[t.xaxis.layer];var i=c.layerValue2layerClass[t.yaxis.layer];var o=e._fullLayout._hasOnlyLargeSploms;if(!t.mainplot){if(o){t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.xaxislayer=h(r,"g","xaxislayer-above");t.yaxislayer=h(r,"g","yaxislayer-above")}else{var s=h(r,"g","layer-subplot");t.shapelayer=h(s,"g","shapelayer");t.imagelayer=h(s,"g","imagelayer");t.gridlayer=h(r,"g","gridlayer");t.zerolinelayer=h(r,"g","zerolinelayer");h(r,"path","xlines-below");h(r,"path","ylines-below");t.overlinesBelow=h(r,"g","overlines-below");h(r,"g","xaxislayer-below");h(r,"g","yaxislayer-below");t.overaxesBelow=h(r,"g","overaxes-below");t.plot=h(r,"g","plot");t.overplot=h(r,"g","overplot");t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.overlinesAbove=h(r,"g","overlines-above");h(r,"g","xaxislayer-above");h(r,"g","yaxislayer-above");t.overaxesAbove=h(r,"g","overaxes-above");t.xlines=r.select(".xlines-"+a);t.ylines=r.select(".ylines-"+i);t.xaxislayer=r.select(".xaxislayer-"+a);t.yaxislayer=r.select(".yaxislayer-"+i)}}else{var l=t.mainplotinfo;var f=l.plotgroup;var d=n+"-x";var v=n+"-y";t.gridlayer=l.gridlayer;t.zerolinelayer=l.zerolinelayer;h(l.overlinesBelow,"path",d);h(l.overlinesBelow,"path",v);h(l.overaxesBelow,"g",d);h(l.overaxesBelow,"g",v);t.plot=h(l.overplot,"g",n);h(l.overlinesAbove,"path",d);h(l.overlinesAbove,"path",v);h(l.overaxesAbove,"g",d);h(l.overaxesAbove,"g",v);t.xlines=f.select(".overlines-"+a).select("."+d);t.ylines=f.select(".overlines-"+i).select("."+v);t.xaxislayer=f.select(".overaxes-"+a).select("."+d);t.yaxislayer=f.select(".overaxes-"+i).select("."+v)}if(!o){p(t.gridlayer,"g",t.xaxis._id);p(t.gridlayer,"g",t.yaxis._id);t.gridlayer.selectAll("g").map(function(e){return e[0]}).sort(u.idSort)}t.xlines.style("fill","none").classed("crisp",true);t.ylines.style("fill","none").classed("crisp",true)}function g(e,t){if(!e)return;var r={};e.each(function(e){var a=e[0];var i=n.select(this);i.remove();y(a,t);r[a]=true});for(var a in t._plots){var i=t._plots[a];var o=i.overlays||[];for(var s=0;s<o.length;s++){var l=o[s];if(r[l.id]){l.plot.selectAll(".trace").remove()}}}}function y(e,t){t._draggers.selectAll("g."+e).remove();t._defs.select("#clip"+t._uid+e+"plot").remove()}r.toSVG=function(e){var t=e._fullLayout._glimages;var r=n.select(e).selectAll(".svg-container");var a=r.filter(function(e,t){return t===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function i(){var e=this;var r=e.toDataURL("image/png");var n=t.append("svg:image");n.attr({xmlns:f.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}a.each(i)};r.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":665,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../registry":911,"../get_data":865,"../plots":891,"./attributes":826,"./axis_ids":831,"./constants":834,"./graph_interact":837,"./layout_attributes":842,"./layout_defaults":843,"./transition_axes":852,d3:169}],842:[function(e,t,r){"use strict";var n=e("../font_attributes");var a=e("../../components/color/attributes");var i=e("../../components/drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;var l=e("../../constants/docs").FORMAT_LINK;var u=e("../../constants/docs").DATE_FORMAT_LINK;var c=e("../../constants/numerical").ONEDAY;var f=e("./constants");var h=f.HOUR_PATTERN;var p=f.WEEKDAY_PATTERN;t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:a.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:n({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:true},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"axrange",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false},anim:true},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false},anim:true}],editType:"axrange",impliedEdits:{autorange:false},anim:true},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},scaleanchor:{valType:"enumerated",values:[f.idRegex.x.toString(),f.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[f.idRegex.x.toString(),f.idRegex.y.toString()],editType:"calc"},rangebreaks:s("rangebreak",{enabled:{valType:"boolean",dflt:true,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[p,h,""],editType:"calc"},values:{valType:"info_array",freeLength:true,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:c},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:undefined,dtick:undefined}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},mirror:{valType:"enumerated",values:[true,"ticks",false,"all","allticks"],dflt:false,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:a.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:true,editType:"ticks"},automargin:{valType:"boolean",dflt:false,editType:"ticks"},showspikes:{valType:"boolean",dflt:false,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:o({},i,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"data",editType:"none"},tickfont:n({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:false,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:s("tickformatstop",{enabled:{valType:"boolean",dflt:true,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:false,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:a.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:a.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:a.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:true,editType:"ticks"},dividercolor:{valType:"color",dflt:a.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",f.idRegex.x.toString(),f.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",f.idRegex.x.toString(),f.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:n({editType:"ticks"})}}},{"../../components/color/attributes":642,"../../components/drawing/attributes":664,"../../constants/docs":748,"../../constants/numerical":753,"../../lib/extend":768,"../../plot_api/plot_template":817,"../font_attributes":856,"./constants":834}],843:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../../components/fx/helpers").isUnifiedHover;var o=e("../../components/fx/hovermode_defaults");var s=e("../../plot_api/plot_template");var l=e("../layout_attributes");var u=e("./layout_attributes");var c=e("./type_defaults");var f=e("./axis_defaults");var h=e("./constraints");var p=e("./position_defaults");var d=e("./axis_ids");var v=d.id2name;var m=d.name2id;var g=e("./constants").AX_ID_PATTERN;var y=e("../../registry");var x=y.traceIs;var _=y.getComponentMethod;function b(e,t,r){if(Array.isArray(e[t]))e[t].push(r);else e[t]=[r]}t.exports=function e(t,r,y){var w=r.autotypenumbers;var T={};var k={};var A={};var M={};var E={};var S={};var C={};var L={};var I={};var O={};var P,D;for(P=0;P<y.length;P++){var R=y[P];if(!x(R,"cartesian")&&!x(R,"gl2d"))continue;var z;if(R.xaxis){z=v(R.xaxis);b(T,z,R)}else if(R.xaxes){for(D=0;D<R.xaxes.length;D++){b(T,v(R.xaxes[D]),R)}}var N;if(R.yaxis){N=v(R.yaxis);b(T,N,R)}else if(R.yaxes){for(D=0;D<R.yaxes.length;D++){b(T,v(R.yaxes[D]),R)}}if(R.type==="funnel"){if(R.orientation==="h"){if(z)k[z]=true;if(N)C[N]=true}else{if(N)A[N]=true}}else if(R.type==="image"){if(N)L[N]=true;if(z)L[z]=true}else{if(N){E[N]=true;S[N]=true}if(!x(R,"carpet")||R.type==="carpet"&&!R._cheater){if(z)M[z]=true}}if(R.type==="carpet"&&R._cheater){if(z)k[z]=true}if(x(R,"2dMap")){I[z]=true;I[N]=true}if(x(R,"oriented")){var F=R.orientation==="h"?N:z;O[F]=true}}var B=r._subplots;var j=B.xaxis;var U=B.yaxis;var H=n.simpleMap(j,v);var V=n.simpleMap(U,v);var G=H.concat(V);var q=a.background;if(j.length&&U.length){q=n.coerce(t,r,l,"plot_bgcolor")}var Y=a.combine(q,r.paper_bgcolor);var W;var X;var Z;var K;var J;function Q(){var e=T[W]||[];J._traceIndices=e.map(function(e){return e._expandedIndex});J._annIndices=[];J._shapeIndices=[];J._imgIndices=[];J._subplotsWith=[];J._counterAxes=[];J._name=J._attr=W;J._id=X}function $(e,t){return n.coerce(K,J,u,e,t)}function ee(e,t){return n.coerce2(K,J,u,e,t)}function te(e){return e==="x"?U:j}function re(e,r){var n=e==="x"?H:V;var a=[];for(var i=0;i<n.length;i++){var o=n[i];if(o!==r&&!(t[o]||{}).overlaying){a.push(m(o))}}return a}var ne={x:te("x"),y:te("y")};var ae=ne.x.concat(ne.y);var ie={};var oe=[];function se(){var e=K.matches;if(g.test(e)&&ae.indexOf(e)===-1){ie[e]=K.type;oe=Object.keys(ie)}}var le=o(t,r,y);var ue=i(le);for(P=0;P<G.length;P++){W=G[P];X=m(W);Z=W.charAt(0);if(!n.isPlainObject(t[W])){t[W]={}}K=t[W];J=s.newContainer(r,W,Z+"axis");Q();var ce=Z==="x"&&!M[W]&&k[W]||Z==="y"&&!E[W]&&A[W];var fe=Z==="y"&&(!S[W]&&C[W]||L[W]);var he={letter:Z,font:r.font,outerTicks:I[W],showGrid:!O[W],data:T[W]||[],bgColor:Y,calendar:r.calendar,automargin:true,visibleDflt:ce,reverseDflt:fe,autotypenumbersDflt:w,splomStash:((r._splomAxes||{})[Z]||{})[X]};$("uirevision",r.uirevision);c(K,J,$,he);f(K,J,$,he,r);var pe=ue&&Z===le.charAt(0);var de=ee("spikecolor",ue?J.color:undefined);var ve=ee("spikethickness",ue?1.5:undefined);var me=ee("spikedash",ue?"dot":undefined);var ge=ee("spikemode",ue?"across":undefined);var ye=ee("spikesnap",ue?"hovered data":undefined);var xe=$("showspikes",!!pe||!!de||!!ve||!!me||!!ge||!!ye);if(!xe){delete J.spikecolor;delete J.spikethickness;delete J.spikedash;delete J.spikemode;delete J.spikesnap}p(K,J,$,{letter:Z,counterAxes:ne[Z],overlayableAxes:re(Z,W),grid:r.grid});$("title.standoff");se();J._input=K}P=0;while(P<oe.length){X=oe[P++];W=v(X);Z=W.charAt(0);if(!n.isPlainObject(t[W])){t[W]={}}K=t[W];J=s.newContainer(r,W,Z+"axis");Q();var _e={letter:Z,font:r.font,outerTicks:I[W],showGrid:!O[W],data:[],bgColor:Y,calendar:r.calendar,automargin:true,visibleDflt:false,reverseDflt:false,autotypenumbersDflt:w,splomStash:((r._splomAxes||{})[Z]||{})[X]};$("uirevision",r.uirevision);J.type=ie[X]||"linear";f(K,J,$,_e,r);p(K,J,$,{letter:Z,counterAxes:ne[Z],overlayableAxes:re(Z,W),grid:r.grid});$("fixedrange");se();J._input=K}var be=_("rangeslider","handleDefaults");var we=_("rangeselector","handleDefaults");for(P=0;P<H.length;P++){W=H[P];K=t[W];J=r[W];be(t,r,W);if(J.type==="date"){we(K,J,r,V,J.calendar)}$("fixedrange")}for(P=0;P<V.length;P++){W=V[P];K=t[W];J=r[W];var Te=r[v(J.anchor)];var ke=_("rangeslider","isVisible")(Te);$("fixedrange",ke)}h.handleDefaults(t,r,{axIds:ae.concat(oe).sort(d.idSort),axHasImage:L})}},{"../../components/color":643,"../../components/fx/helpers":679,"../../components/fx/hovermode_defaults":682,"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911,"../layout_attributes":882,"./axis_defaults":830,"./axis_ids":831,"./constants":834,"./constraints":835,"./layout_attributes":842,"./position_defaults":845,"./type_defaults":853}],844:[function(e,t,r){"use strict";var n=e("tinycolor2").mix;var a=e("../../components/color/attributes").lightFraction;var i=e("../../lib");t.exports=function e(t,r,o,s){s=s||{};var l=s.dfltColor;function u(e,n){return i.coerce2(t,r,s.attributes,e,n)}var c=u("linecolor",l);var f=u("linewidth");var h=o("showline",s.showLine||!!c||!!f);if(!h){delete r.linecolor;delete r.linewidth}var p=n(l,s.bgColor,s.blend||a).toRgbString();var d=u("gridcolor",p);var v=u("gridwidth");var m=o("showgrid",s.showGrid||!!d||!!v);if(!m){delete r.gridcolor;delete r.gridwidth}if(!s.noZeroLine){var g=u("zerolinecolor",l);var y=u("zerolinewidth");var x=o("zeroline",s.showGrid||!!g||!!y);if(!x){delete r.zerolinecolor;delete r.zerolinewidth}}}},{"../../components/color/attributes":642,"../../lib":778,tinycolor2:576}],845:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");t.exports=function e(t,r,i,o){var s=o.counterAxes||[];var l=o.overlayableAxes||[];var u=o.letter;var c=o.grid;var f,h,p,d;if(c){h=c._domains[u][c._axisMap[r._id]];f=c._anchors[r._id];if(h){p=c[u+"side"].split(" ")[0];d=c.domain[u][p==="right"||p==="top"?1:0]}}h=h||[0,1];f=f||(n(t.position)?"free":s[0]||"free");p=p||(u==="x"?"bottom":"left");d=d||0;var v=a.coerce(t,r,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:f}},"anchor");if(v==="free")i("position",d);a.coerce(t,r,{side:{valType:"enumerated",values:u==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var m=false;if(l.length){m=a.coerce(t,r,{overlaying:{valType:"enumerated",values:[false].concat(l),dflt:false}},"overlaying")}if(!m){var g=i("domain",h);if(g[0]>g[1]-1/4096)r.domain=h;a.noneOrAll(t.domain,r.domain,h)}i("layer");return r}},{"../../lib":778,"fast-isnumeric":241}],846:[function(e,t,r){"use strict";var n=e("../../constants/alignment").FROM_BL;t.exports=function e(t,r,a){if(a===undefined){a=n[t.constraintoward||"center"]}var i=[t.r2l(t.range[0]),t.r2l(t.range[1])];var o=i[0]+(i[1]-i[0])*a;t.range=t._input.range=[t.l2r(o+(i[0]-o)*r),t.l2r(o+(i[1]-o)*r)];t.setScale()}},{"../../constants/alignment":745}],847:[function(e,t,r){"use strict";var n=e("polybooljs");var a=e("../../registry");var i=e("../../components/drawing").dashStyle;var o=e("../../components/color");var s=e("../../components/fx");var l=e("../../components/fx/helpers").makeEventData;var u=e("../../components/dragelement/helpers");var c=u.freeMode;var f=u.rectMode;var h=u.drawMode;var p=u.openMode;var d=u.selectMode;var v=e("../../components/shapes/draw_newshape/display_outlines");var m=e("../../components/shapes/draw_newshape/helpers").handleEllipse;var g=e("../../components/shapes/draw_newshape/newshapes");var y=e("../../lib");var x=e("../../lib/polygon");var _=e("../../lib/throttle");var b=e("./axis_ids").getFromId;var w=e("../../lib/clear_gl_canvases");var T=e("../../plot_api/subroutines").redrawReglTraces;var k=e("./constants");var A=k.MINSELECT;var M=x.filter;var E=x.tester;var S=e("./handle_outline").clearSelect;var C=e("./helpers");var L=C.p2r;var I=C.axValue;var O=C.getTransform;function P(e,t,r,n,a){var l=c(a);var u=f(a);var g=p(a);var x=h(a);var b=d(a);var w=a==="drawline";var T=a==="drawcircle";var S=w||T;var C=n.gd;var P=C._fullLayout;var R=P._zoomlayer;var z=n.element.getBoundingClientRect();var N=n.plotinfo;var H=O(N);var V=t-z.left;var G=r-z.top;P._calcInverseTransform(C);var q=y.apply3DTransform(P._invTransform)(V,G);V=q[0];G=q[1];var Y=P._invScaleX;var J=P._invScaleY;var Q=V;var $=G;var ee="M"+V+","+G;var te=n.xaxes[0]._length;var re=n.yaxes[0]._length;var ne=n.xaxes.concat(n.yaxes);var ae=e.altKey&&!(h(a)&&g);var ie,oe,se,le;var ue,ce,fe;B(e,C,n);if(l){ie=M([[V,G]],k.BENDPX)}var he=R.selectAll("path.select-outline-"+N.id).data(x?[0]:[1,2]);var pe=P.newshape;he.enter().append("path").attr("class",function(e){return"select-outline select-outline-"+e+" select-outline-"+N.id}).style(x?{opacity:pe.opacity/2,fill:g?undefined:pe.fillcolor,stroke:pe.line.color,"stroke-dasharray":i(pe.line.dash,pe.line.width),"stroke-width":pe.line.width+"px"}:{}).attr("fill-rule",pe.fillrule).classed("cursor-move",x?true:false).attr("transform",H).attr("d",ee+"Z");var de=R.append("path").attr("class","zoombox-corners").style({fill:o.background,stroke:o.defaultLine,"stroke-width":1}).attr("transform",H).attr("d","M0,0Z");var ve=P._uid+k.SELECTID;var me=[];var ge=U(C,n.xaxes,n.yaxes,n.subplot);function ye(e,t){return e-t}var xe;if(N.fillRangeItems){xe=N.fillRangeItems}else{if(u){xe=function(e,t){var r=e.range={};for(ue=0;ue<ne.length;ue++){var n=ne[ue];var a=n._id.charAt(0);r[n._id]=[L(n,t[a+"min"]),L(n,t[a+"max"])].sort(ye)}}}else{xe=function(e,t,r){var n=e.lassoPoints={};for(ue=0;ue<ne.length;ue++){var a=ne[ue];n[a._id]=r.filtered.map(I(a))}}}}n.moveFn=function(e,t){Q=Math.max(0,Math.min(te,Y*e+V));$=Math.max(0,Math.min(re,J*t+G));var r=Math.abs(Q-V);var a=Math.abs($-G);if(u){var i;var o,s;if(b){var c=P.selectdirection;if(c==="any"){if(a<Math.min(r*.6,A)){i="h"}else if(r<Math.min(a*.6,A)){i="v"}else{i="d"}}else{i=c}switch(i){case"h":o=T?re/2:0;s=re;break;case"v":o=T?te/2:0;s=te;break}}if(x){switch(P.newshape.drawdirection){case"vertical":i="h";o=T?re/2:0;s=re;break;case"horizontal":i="v";o=T?te/2:0;s=te;break;case"ortho":if(r<a){i="h";o=G;s=$}else{i="v";o=V;s=Q}break;default:i="d"}}if(i==="h"){le=S?m(T,[Q,o],[Q,s]):[[V,o],[V,s],[Q,s],[Q,o]];le.xmin=S?Q:Math.min(V,Q);le.xmax=S?Q:Math.max(V,Q);le.ymin=Math.min(o,s);le.ymax=Math.max(o,s);de.attr("d","M"+le.xmin+","+(G-A)+"h-4v"+2*A+"h4Z"+"M"+(le.xmax-1)+","+(G-A)+"h4v"+2*A+"h-4Z")}else if(i==="v"){le=S?m(T,[o,$],[s,$]):[[o,G],[o,$],[s,$],[s,G]];le.xmin=Math.min(o,s);le.xmax=Math.max(o,s);le.ymin=S?$:Math.min(G,$);le.ymax=S?$:Math.max(G,$);de.attr("d","M"+(V-A)+","+le.ymin+"v-4h"+2*A+"v4Z"+"M"+(V-A)+","+(le.ymax-1)+"v4h"+2*A+"v-4Z")}else if(i==="d"){le=S?m(T,[V,G],[Q,$]):[[V,G],[V,$],[Q,$],[Q,G]];le.xmin=Math.min(V,Q);le.xmax=Math.max(V,Q);le.ymin=Math.min(G,$);le.ymax=Math.max(G,$);de.attr("d","M0,0Z")}}else if(l){ie.addPt([Q,$]);le=ie.filtered}if(n.selectionDefs&&n.selectionDefs.length){se=X(n.mergedPolygons,le,ae);le.subtract=ae;oe=F(n.selectionDefs.concat([le]))}else{se=[le];oe=E(le)}v(K(se,g),he,n);if(b){_.throttle(ve,k.SELECTDELAY,function(){me=[];var e;var t=[];var r;for(ue=0;ue<ge.length;ue++){ce=ge[ue];r=ce._module.selectPoints(ce,oe);t.push(r);e=Z(r,ce);if(me.length){for(var a=0;a<e.length;a++){me.push(e[a])}}else me=e}fe={points:me};W(C,ge,fe);xe(fe,le,ie);n.gd.emit("plotly_selecting",fe)})}};n.clickFn=function(e,t){de.remove();if(C._fullLayout._activeShapeIndex>=0){C._fullLayout._deactivateShape(C);return}if(x)return;var r=P.clickmode;_.done(ve).then(function(){_.clear(ve);if(e===2){he.remove();for(ue=0;ue<ge.length;ue++){ce=ge[ue];ce._module.selectPoints(ce,false)}W(C,ge);j(n);C.emit("plotly_deselect",null)}else{if(r.indexOf("select")>-1){D(t,C,n.xaxes,n.yaxes,n.subplot,n,he)}if(r==="event"){C.emit("plotly_selected",undefined)}}s.click(C,t)}).catch(y.error)};n.doneFn=function(){de.remove();_.done(ve).then(function(){_.clear(ve);n.gd.emit("plotly_selected",fe);if(le&&n.selectionDefs){le.subtract=ae;n.selectionDefs.push(le);n.mergedPolygons.length=0;[].push.apply(n.mergedPolygons,se)}if(n.doneFnCompleted){n.doneFnCompleted(me)}}).catch(y.error);if(x){j(n)}}}function D(e,t,r,n,a,i,o){var s=t._hoverdata;var l=t._fullLayout;var u=l.clickmode;var c=u.indexOf("event")>-1;var f=[];var h,d,m,g,y;var x,_,b,w,T;if(H(s)){B(e,t,i);h=U(t,r,n,a);var k=V(s,h);var A=k.pointNumbers.length>0;if(A?q(h,k):Y(h)&&(_=G(k))){if(o)o.remove();for(T=0;T<h.length;T++){d=h[T];d._module.selectPoints(d,false)}W(t,h);j(i);if(c){t.emit("plotly_deselect",null)}}else{b=e.shiftKey&&(_!==undefined?_:G(k));m=R(k.pointNumber,k.searchInfo,b);var M=i.selectionDefs.concat([m]);g=F(M);for(T=0;T<h.length;T++){y=h[T]._module.selectPoints(h[T],g);x=Z(y,h[T]);if(f.length){for(var E=0;E<x.length;E++){f.push(x[E])}}else f=x}w={points:f};W(t,h,w);if(m&&i){i.selectionDefs.push(m)}if(o){var S=i.mergedPolygons;var C=p(i.dragmode);v(K(S,C),o,i)}if(c){t.emit("plotly_selected",w)}}}}function R(e,t,r){return{pointNumber:e,searchInfo:t,subtract:r}}function z(e){return"pointNumber"in e&&"searchInfo"in e}function N(e){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(t,r,n,a){var i=e.searchInfo.cd[0].trace._expandedIndex;var o=a.cd[0].trace._expandedIndex;return o===i&&n===e.pointNumber},isRect:false,degenerate:false,subtract:e.subtract}}function F(e){var t=[];var r=z(e[0])?0:e[0][0][0];var n=r;var a=z(e[0])?0:e[0][0][1];var i=a;for(var o=0;o<e.length;o++){if(z(e[o])){t.push(N(e[o]))}else{var s=x.tester(e[o]);s.subtract=e[o].subtract;t.push(s);r=Math.min(r,s.xmin);n=Math.max(n,s.xmax);a=Math.min(a,s.ymin);i=Math.max(i,s.ymax)}}function l(e,r,n,a){var i=false;for(var o=0;o<t.length;o++){if(t[o].contains(e,r,n,a)){i=t[o].subtract===false}}return i}return{xmin:r,xmax:n,ymin:a,ymax:i,pts:[],contains:l,isRect:false,degenerate:false}}function B(e,t,r){t._fullLayout._drawing=false;var n=t._fullLayout;var a=r.plotinfo;var i=r.dragmode;var o=n._lastSelectedSubplot&&n._lastSelectedSubplot===a.id;var s=(e.shiftKey||e.altKey)&&!(h(i)&&p(i));if(o&&s&&(a.selection&&a.selection.selectionDefs)&&!r.selectionDefs){r.selectionDefs=a.selection.selectionDefs;r.mergedPolygons=a.selection.mergedPolygons}else if(!s||!a.selection){j(r)}if(!o){S(t);n._lastSelectedSubplot=a.id}}function j(e){var t=e.dragmode;var r=e.plotinfo;var n=e.gd;if(n._fullLayout._activeShapeIndex>=0){n._fullLayout._deactivateShape(n)}if(h(t)){var i=n._fullLayout;var o=i._zoomlayer;var s=o.selectAll(".select-outline-"+r.id);if(s&&n._fullLayout._drawing){var l=g(s,e);if(l){a.call("_guiRelayout",n,{shapes:l})}n._fullLayout._drawing=false}}r.selection={};r.selection.selectionDefs=e.selectionDefs=[];r.selection.mergedPolygons=e.mergedPolygons=[]}function U(e,t,r,n){var a=[];var i=t.map(function(e){return e._id});var o=r.map(function(e){return e._id});var s,l,u;for(u=0;u<e.calcdata.length;u++){s=e.calcdata[u];l=s[0].trace;if(l.visible!==true||!l._module||!l._module.selectPoints)continue;if(n&&(l.subplot===n||l.geo===n)){a.push(h(l._module,s,t[0],r[0]))}else if(l.type==="splom"&&l._xaxes[i[0]]&&l._yaxes[o[0]]){var c=h(l._module,s,t[0],r[0]);c.scene=e._fullLayout._splomScenes[l.uid];a.push(c)}else if(l.type==="sankey"){var f=h(l._module,s,t[0],r[0]);a.push(f)}else{if(i.indexOf(l.xaxis)===-1)continue;if(o.indexOf(l.yaxis)===-1)continue;a.push(h(l._module,s,b(e,l.xaxis),b(e,l.yaxis)))}}return a;function h(e,t,r,n){return{_module:e,cd:t,xaxis:r,yaxis:n}}}function H(e){return e&&Array.isArray(e)&&e[0].hoverOnBox!==true}function V(e,t){var r=e[0];var n=-1;var a=[];var i,o;for(o=0;o<t.length;o++){i=t[o];if(r.fullData._expandedIndex===i.cd[0].trace._expandedIndex){if(r.hoverOnBox===true){break}if(r.pointNumber!==undefined){n=r.pointNumber}else if(r.binNumber!==undefined){n=r.binNumber;a=r.pointNumbers}break}}return{pointNumber:n,pointNumbers:a,searchInfo:i}}function G(e){var t=e.searchInfo.cd[0].trace;var r=e.pointNumber;var n=e.pointNumbers;var a=n.length>0;var i=a?n[0]:r;return t.selectedpoints?t.selectedpoints.indexOf(i)>-1:false}function q(e,t){var r=[];var n,a,i,o;for(o=0;o<e.length;o++){n=e[o];if(n.cd[0].trace.selectedpoints&&n.cd[0].trace.selectedpoints.length>0){r.push(n)}}if(r.length===1){i=r[0]===t.searchInfo;if(i){a=t.searchInfo.cd[0].trace;if(a.selectedpoints.length===t.pointNumbers.length){for(o=0;o<t.pointNumbers.length;o++){if(a.selectedpoints.indexOf(t.pointNumbers[o])<0){return false}}return true}}}return false}function Y(e){var t=0;var r,n,a;for(a=0;a<e.length;a++){r=e[a];n=r.cd[0].trace;if(n.selectedpoints){if(n.selectedpoints.length>1)return false;t+=n.selectedpoints.length;if(t>1)return false}}return t===1}function W(e,t,r){var n,i,o,s;for(n=0;n<t.length;n++){var l=t[n].cd[0].trace._fullInput;var u=e._fullLayout._tracePreGUI[l.uid]||{};if(u.selectedpoints===undefined){u.selectedpoints=l._input.selectedpoints||null}}if(r){var c=r.points||[];for(n=0;n<t.length;n++){s=t[n].cd[0].trace;s._input.selectedpoints=s._fullInput.selectedpoints=[];if(s._fullInput!==s)s.selectedpoints=[]}for(n=0;n<c.length;n++){var f=c[n];var h=f.data;var p=f.fullData;if(f.pointIndices){[].push.apply(h.selectedpoints,f.pointIndices);if(s._fullInput!==s){[].push.apply(p.selectedpoints,f.pointIndices)}}else{h.selectedpoints.push(f.pointIndex);if(s._fullInput!==s){p.selectedpoints.push(f.pointIndex)}}}}else{for(n=0;n<t.length;n++){s=t[n].cd[0].trace;delete s.selectedpoints;delete s._input.selectedpoints;if(s._fullInput!==s){delete s._fullInput.selectedpoints}}}var d=false;for(n=0;n<t.length;n++){i=t[n];o=i.cd;s=o[0].trace;if(a.traceIs(s,"regl")){d=true}var v=i._module;var m=v.styleOnSelect||v.style;if(m){m(e,o,o[0].node3);if(o[0].nodeRangePlot3)m(e,o,o[0].nodeRangePlot3)}}if(d){w(e);T(e)}}function X(e,t,r){var a;if(r){a=n.difference({regions:e,inverted:false},{regions:[t],inverted:false});return a.regions}a=n.union({regions:e,inverted:false},{regions:[t],inverted:false});return a.regions}function Z(e,t){if(Array.isArray(e)){var r=t.cd;var n=t.cd[0].trace;for(var a=0;a<e.length;a++){e[a]=l(e[a],n,r)}}return e}function K(e,t){var r=[];for(var n=0;n<e.length;n++){r[n]=[];for(var a=0;a<e[n].length;a++){r[n][a]=[];r[n][a][0]=a?"L":"M";for(var i=0;i<e[n][a].length;i++){r[n][a].push(e[n][a][i])}}if(!t){r[n].push(["Z",r[n][0][1],r[n][0][2]])}}return r}t.exports={prepSelect:P,clearSelect:S,clearSelectionsCache:j,selectOnClick:D}},{"../../components/color":643,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../components/fx/helpers":679,"../../components/shapes/draw_newshape/display_outlines":728,"../../components/shapes/draw_newshape/helpers":729,"../../components/shapes/draw_newshape/newshapes":730,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/polygon":790,"../../lib/throttle":804,"../../plot_api/subroutines":818,"../../registry":911,"./axis_ids":831,"./constants":834,"./handle_outline":838,"./helpers":839,polybooljs:517}],848:[function(e,t,r){"use strict";var n=e("d3");var a=e("d3-time-format").utcFormat;var i=e("fast-isnumeric");var o=e("../../lib");var s=o.cleanNumber;var l=o.ms2DateTime;var u=o.dateTime2ms;var c=o.ensureNumber;var f=o.isArrayOrTypedArray;var h=e("../../constants/numerical");var p=h.FP_SAFE;var d=h.BADNUM;var v=h.LOG_CLIP;var m=h.ONEWEEK;var g=h.ONEDAY;var y=h.ONEHOUR;var x=h.ONEMIN;var _=h.ONESEC;var b=e("./axis_ids");var w=e("./constants");var T=w.HOUR_PATTERN;var k=w.WEEKDAY_PATTERN;function A(e){return Math.pow(10,e)}function M(e){return e!==null&&e!==undefined}t.exports=function e(t,r){r=r||{};var h=t._id||"x";var E=h.charAt(0);function S(e,r){if(e>0)return Math.log(e)/Math.LN10;else if(e<=0&&r&&t.range&&t.range.length===2){var n=t.range[0];var a=t.range[1];return.5*(n+a-2*v*Math.abs(n-a))}else return d}function C(e,r,n,a){if((a||{}).msUTC&&i(e)){return+e}var s=u(e,n||t.calendar);if(s===d){if(i(e)){e=+e;var l=Math.floor(o.mod(e+.05,1)*10);var c=Math.round(e-l/10);s=u(new Date(c))+l/10}else return d}return s}function L(e,r,n){return l(e,r,n||t.calendar)}function I(e){return t._categories[Math.round(e)]}function O(e){if(M(e)){if(t._categoriesMap===undefined){t._categoriesMap={}}if(t._categoriesMap[e]!==undefined){return t._categoriesMap[e]}else{t._categories.push(typeof e==="number"?String(e):e);var r=t._categories.length-1;t._categoriesMap[e]=r;return r}}return d}function P(e,t){var r=new Array(t);for(var n=0;n<t;n++){var a=(e[0]||[])[n];var i=(e[1]||[])[n];r[n]=D([a,i])}return r}function D(e){if(t._categoriesMap){return t._categoriesMap[e]}}function R(e){var t=D(e);if(t!==undefined)return t;if(i(e))return+e}function z(e){return i(e)?+e:D(e)}function N(e,t,r){return n.round(r+t*e,2)}function F(e,t,r){return(e-r)/t}var B=function e(r){if(!i(r))return d;return N(r,t._m,t._b)};var j=function(e){return F(e,t._m,t._b)};if(t.rangebreaks){var U=E==="y";B=function(e){if(!i(e))return d;var r=t._rangebreaks.length;if(!r)return N(e,t._m,t._b);var n=U;if(t.range[0]>t.range[1])n=!n;var a=n?-1:1;var o=a*e;var s=0;for(var l=0;l<r;l++){var u=a*t._rangebreaks[l].min;var c=a*t._rangebreaks[l].max;if(o<u)break;if(o>c)s=l+1;else{s=o<(u+c)/2?l:l+1;break}}var f=t._B[s]||0;if(!isFinite(f))return 0;return N(e,t._m2,f)};j=function(e){var r=t._rangebreaks.length;if(!r)return F(e,t._m,t._b);var n=0;for(var a=0;a<r;a++){if(e<t._rangebreaks[a].pmin)break;if(e>t._rangebreaks[a].pmax)n=a+1}return F(e,t._m2,t._B[n])}}t.c2l=t.type==="log"?S:c;t.l2c=t.type==="log"?A:c;t.l2p=B;t.p2l=j;t.c2p=t.type==="log"?function(e,t){return B(S(e,t))}:B;t.p2c=t.type==="log"?function(e){return A(j(e))}:j;if(["linear","-"].indexOf(t.type)!==-1){t.d2r=t.r2d=t.d2c=t.r2c=t.d2l=t.r2l=s;t.c2d=t.c2r=t.l2d=t.l2r=c;t.d2p=t.r2p=function(e){return t.l2p(s(e))};t.p2d=t.p2r=j;t.cleanPos=c}else if(t.type==="log"){t.d2r=t.d2l=function(e,t){return S(s(e),t)};t.r2d=t.r2c=function(e){return A(s(e))};t.d2c=t.r2l=s;t.c2d=t.l2r=c;t.c2r=S;t.l2d=A;t.d2p=function(e,r){return t.l2p(t.d2r(e,r))};t.p2d=function(e){return A(j(e))};t.r2p=function(e){return t.l2p(s(e))};t.p2r=j;t.cleanPos=c}else if(t.type==="date"){t.d2r=t.r2d=o.identity;t.d2c=t.r2c=t.d2l=t.r2l=C;t.c2d=t.c2r=t.l2d=t.l2r=L;t.d2p=t.r2p=function(e,r,n){return t.l2p(C(e,0,n))};t.p2d=t.p2r=function(e,t,r){return L(j(e),t,r)};t.cleanPos=function(e){return o.cleanDate(e,d,t.calendar)}}else if(t.type==="category"){t.d2c=t.d2l=O;t.r2d=t.c2d=t.l2d=I;t.d2r=t.d2l_noadd=R;t.r2c=function(e){var r=z(e);return r!==undefined?r:t.fraction2r(.5)};t.l2r=t.c2r=c;t.r2l=z;t.d2p=function(e){return t.l2p(t.r2c(e))};t.p2d=function(e){return I(j(e))};t.r2p=t.d2p;t.p2r=j;t.cleanPos=function(e){if(typeof e==="string"&&e!=="")return e;return c(e)}}else if(t.type==="multicategory"){t.r2d=t.c2d=t.l2d=I;t.d2r=t.d2l_noadd=R;t.r2c=function(e){var r=R(e);return r!==undefined?r:t.fraction2r(.5)};t.r2c_just_indices=D;t.l2r=t.c2r=c;t.r2l=R;t.d2p=function(e){return t.l2p(t.r2c(e))};t.p2d=function(e){return I(j(e))};t.r2p=t.d2p;t.p2r=j;t.cleanPos=function(e){if(Array.isArray(e)||typeof e==="string"&&e!=="")return e;return c(e)};t.setupMultiCategory=function(e){var n=t._traceIndices;var a,i;var s=t._matchGroup;if(s&&t._categories.length===0){for(var l in s){if(l!==h){var u=r[b.id2name(l)];n=n.concat(u._traceIndices)}}}var c=[[0,{}],[0,{}]];var p=[];for(a=0;a<n.length;a++){var d=e[n[a]];if(E in d){var v=d[E];var m=d._length||o.minRowLength(v);if(f(v[0])&&f(v[1])){for(i=0;i<m;i++){var g=v[0][i];var y=v[1][i];if(M(g)&&M(y)){p.push([g,y]);if(!(g in c[0][1])){c[0][1][g]=c[0][0]++}if(!(y in c[1][1])){c[1][1][y]=c[1][0]++}}}}}}p.sort(function(e,t){var r=c[0][1];var n=r[e[0]]-r[t[0]];if(n)return n;var a=c[1][1];return a[e[1]]-a[t[1]]});for(a=0;a<p.length;a++){O(p[a])}}}t.fraction2r=function(e){var r=t.r2l(t.range[0]);var n=t.r2l(t.range[1]);return t.l2r(r+e*(n-r))};t.r2fraction=function(e){var r=t.r2l(t.range[0]);var n=t.r2l(t.range[1]);return(t.r2l(e)-r)/(n-r)};t.cleanRange=function(e,r){if(!r)r={};if(!e)e="range";var n=o.nestedProperty(t,e).get();var a,s;if(t.type==="date")s=o.dfltRange(t.calendar);else if(E==="y")s=w.DFLTRANGEY;else s=r.dfltRange||w.DFLTRANGEX;s=s.slice();if(t.rangemode==="tozero"||t.rangemode==="nonnegative"){s[0]=0}if(!n||n.length!==2){o.nestedProperty(t,e).set(s);return}if(t.type==="date"&&!t.autorange){n[0]=o.cleanDate(n[0],d,t.calendar);n[1]=o.cleanDate(n[1],d,t.calendar)}for(a=0;a<2;a++){if(t.type==="date"){if(!o.isDateTime(n[a],t.calendar)){t[e]=s;break}if(t.r2l(n[0])===t.r2l(n[1])){var l=o.constrain(t.r2l(n[0]),o.MIN_MS+1e3,o.MAX_MS-1e3);n[0]=t.l2r(l-1e3);n[1]=t.l2r(l+1e3);break}}else{if(!i(n[a])){if(i(n[1-a])){n[a]=n[1-a]*(a?10:.1)}else{t[e]=s;break}}if(n[a]<-p)n[a]=-p;else if(n[a]>p)n[a]=p;if(n[0]===n[1]){var u=Math.max(1,Math.abs(n[0]*1e-6));n[0]-=u;n[1]+=u}}}};t.setScale=function(e){var n=r._size;if(t.overlaying){var a=b.getFromId({_fullLayout:r},t.overlaying);t.domain=a.domain}var i=e&&t._r?"_r":"range";var o=t.calendar;t.cleanRange(i);var s=t.r2l(t[i][0],o);var l=t.r2l(t[i][1],o);var u=E==="y";if(u){t._offset=n.t+(1-t.domain[1])*n.h;t._length=n.h*(t.domain[1]-t.domain[0]);t._m=t._length/(s-l);t._b=-t._m*l}else{t._offset=n.l+t.domain[0]*n.w;t._length=n.w*(t.domain[1]-t.domain[0]);t._m=t._length/(l-s);t._b=-t._m*s}t._rangebreaks=[];t._lBreaks=0;t._m2=0;t._B=[];if(t.rangebreaks){var c,f;t._rangebreaks=t.locateBreaks(Math.min(s,l),Math.max(s,l));if(t._rangebreaks.length){for(c=0;c<t._rangebreaks.length;c++){f=t._rangebreaks[c];t._lBreaks+=Math.abs(f.max-f.min)}var h=u;if(s>l)h=!h;if(h)t._rangebreaks.reverse();var p=h?-1:1;t._m2=p*t._length/(Math.abs(l-s)-t._lBreaks);t._B.push(-t._m2*(u?l:s));for(c=0;c<t._rangebreaks.length;c++){f=t._rangebreaks[c];t._B.push(t._B[t._B.length-1]-p*t._m2*(f.max-f.min))}for(c=0;c<t._rangebreaks.length;c++){f=t._rangebreaks[c];f.pmin=B(f.min);f.pmax=B(f.max)}}}if(!isFinite(t._m)||!isFinite(t._b)||t._length<0){r._replotting=false;throw new Error("Something went wrong with axis scaling")}};t.maskBreaks=function(e){var r=t.rangebreaks||[];var n,a,i,l,u;for(var c=0;c<r.length;c++){var f=r[c];if(f.enabled){if(f.bounds){var h=f.pattern;n=o.simpleMap(f.bounds,h?s:t.d2c);a=n[0];i=n[1];switch(h){case k:u=new Date(e);l=u.getUTCDay();if(a>i){i+=7;if(l<a)l+=7}break;case T:u=new Date(e);var p=u.getUTCHours();var v=u.getUTCMinutes();var m=u.getUTCSeconds();var g=u.getUTCMilliseconds();l=p+(v/60+m/3600+g/36e5);if(a>i){i+=24;if(l<a)l+=24}break;case"":l=e;break}if(l>=a&&l<i)return d}else{var y=o.simpleMap(f.values,t.d2c).sort(o.sorterAsc);for(var x=0;x<y.length;x++){a=y[x];i=a+f.dvalue;if(e>=a&&e<i)return d}}}}return e};t.locateBreaks=function(e,r){var n,a,i,l;var u=[];if(!t.rangebreaks)return u;var c=t.rangebreaks.slice().sort(function(e,t){if(e.pattern===k&&t.pattern===T)return-1;if(t.pattern===k&&e.pattern===T)return 1;return 0});var f=function(t,n){t=o.constrain(t,e,r);n=o.constrain(n,e,r);if(t===n)return;var a=true;for(var i=0;i<u.length;i++){var s=u[i];if(t<s.max&&n>=s.min){if(t<s.min){s.min=t}if(n>s.max){s.max=n}a=false}}if(a){u.push({min:t,max:n})}};for(n=0;n<c.length;n++){var h=c[n];if(h.enabled){if(h.bounds){var p=e;var d=r;if(h.pattern){p=Math.floor(p)}a=o.simpleMap(h.bounds,h.pattern?s:t.r2l);i=a[0];l=a[1];var v=new Date(p);var b;var w;switch(h.pattern){case k:w=m;b=((l<i?7:0)+(l-i))*g;p+=i*g-(v.getUTCDay()*g+v.getUTCHours()*y+v.getUTCMinutes()*x+v.getUTCSeconds()*_+v.getUTCMilliseconds());break;case T:w=g;b=((l<i?24:0)+(l-i))*y;p+=i*y-(v.getUTCHours()*y+v.getUTCMinutes()*x+v.getUTCSeconds()*_+v.getUTCMilliseconds());break;default:p=Math.min(a[0],a[1]);d=Math.max(a[0],a[1]);w=d-p;b=w}for(var A=p;A<d;A+=w){f(A,A+b)}}else{var M=o.simpleMap(h.values,t.d2c);for(var E=0;E<M.length;E++){i=M[E];l=i+h.dvalue;f(i,l)}}}}u.sort(function(e,t){return e.min-t.min});return u};t.makeCalcdata=function(e,r,n){var a,i,s,l;var u=t.type;var c=u==="date"&&e[r+"calendar"];if(r in e){a=e[r];l=e._length||o.minRowLength(a);if(o.isTypedArray(a)&&(u==="linear"||u==="log")){if(l===a.length){return a}else if(a.subarray){return a.subarray(0,l)}}if(u==="multicategory"){return P(a,l)}i=new Array(l);for(s=0;s<l;s++){i[s]=t.d2c(a[s],0,c,n)}}else{var f=r+"0"in e?t.d2c(e[r+"0"],0,c):0;var h=e["d"+r]?Number(e["d"+r]):1;a=e[{x:"y",y:"x"}[r]];l=e._length||a.length;i=new Array(l);for(s=0;s<l;s++){i[s]=f+s*h}}if(t.rangebreaks){for(s=0;s<l;s++){i[s]=t.maskBreaks(i[s])}}return i};t.isValidRange=function(e){return Array.isArray(e)&&e.length===2&&i(t.r2l(e[0]))&&i(t.r2l(e[1]))};t.isPtWithinRange=function(e,r){var n=t.c2l(e[E],null,r);var a=t.r2l(t.range[0]);var i=t.r2l(t.range[1]);if(a<i){return a<=n&&n<=i}else{return i<=n&&n<=a}};t._emptyCategories=function(){t._categories=[];t._categoriesMap={}};t.clearCalc=function(){var e=t._matchGroup;if(e){var n=null;var a=null;for(var i in e){var o=r[b.id2name(i)];if(o._categories){n=o._categories;a=o._categoriesMap;break}}if(n&&a){t._categories=n;t._categoriesMap=a}else{t._emptyCategories()}}else{t._emptyCategories()}if(t._initialCategories){for(var s=0;s<t._initialCategories.length;s++){O(t._initialCategories[s])}}};t.sortByInitialCategories=function(){var e=[];t._emptyCategories();if(t._initialCategories){for(var n=0;n<t._initialCategories.length;n++){O(t._initialCategories[n])}}e=e.concat(t._traceIndices);var a=t._matchGroup;for(var i in a){if(h===i)continue;var o=r[b.id2name(i)];o._categories=t._categories;o._categoriesMap=t._categoriesMap;e=e.concat(o._traceIndices)}return e};var H=r._d3locale;if(t.type==="date"){t._dateFormat=H?H.timeFormat:a;t._extraFormat=r._extraFormat}t._separators=r.separators;t._numFormat=H?H.numberFormat:n.format;delete t._minDtick;delete t._forceTick0}},{"../../constants/numerical":753,"../../lib":778,"./axis_ids":831,"./constants":834,d3:169,"d3-time-format":166,"fast-isnumeric":241}],849:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color").contrast;var i=e("./layout_attributes");var o=e("../array_container_defaults");t.exports=function e(t,r,n,a,i,o){if(!o||o.pass===1){s(t,r,n,a,i)}if(!o||o.pass===2){l(t,r,n,a,i)}};function s(e,t,r,n,a){var i=u(e);var o=r("tickprefix");if(o)r("showtickprefix",i);var s=r("ticksuffix",a.tickSuffixDflt);if(s)r("showticksuffix",i)}function l(e,t,r,s,l){var f=u(e);var h=r("tickprefix");if(h)r("showtickprefix",f);var p=r("ticksuffix",l.tickSuffixDflt);if(p)r("showticksuffix",f);var d=r("showticklabels");if(d){var v=l.font||{};var m=t.color;var g=t.ticklabelposition||"";var y=g.indexOf("inside")!==-1?a(l.bgColor):m&&m!==i.color.dflt?m:v.color;n.coerceFont(r,"tickfont",{family:v.family,size:v.size,color:y});r("tickangle");if(s!=="category"){var x=r("tickformat");o(e,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:c});if(!t.tickformatstops.length){delete t.tickformatstops}if(!x&&s!=="date"){r("showexponent",f);r("exponentformat");r("minexponent");r("separatethousands")}}}}function u(e){var t=["showexponent","showtickprefix","showticksuffix"];var r=t.filter(function(t){return e[t]!==undefined});var n=function(t){return e[t]===e[r[0]]};if(r.every(n)||r.length===1){return e[r[0]]}}function c(e,t){function r(r,a){return n.coerce(e,t,i.tickformatstops,r,a)}var a=r("enabled");if(a){r("dtickrange");r("value")}}},{"../../components/color":643,"../../lib":778,"../array_container_defaults":823,"./layout_attributes":842}],850:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function e(t,r,i,o){var s=n.coerce2(t,r,a,"ticklen");var l=n.coerce2(t,r,a,"tickwidth");var u=n.coerce2(t,r,a,"tickcolor",r.color);var c=i("ticks",o.outerTicks||s||l||u?"outside":"");if(!c){delete r.ticklen;delete r.tickwidth;delete r.tickcolor}}},{"../../lib":778,"./layout_attributes":842}],851:[function(e,t,r){"use strict";var n=e("./clean_ticks");var a=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,i,o){function s(e){var n=t[e];return n!==undefined?n:(r._template||{})[e]}var l=s("tick0");var u=s("dtick");var c=s("tickvals");var f=a(c)?"array":u?"linear":"auto";var h=i("tickmode",f);if(h==="auto")i("nticks");else if(h==="linear"){var p=r.dtick=n.dtick(u,o);r.tick0=n.tick0(l,o,r.calendar,p)}else if(o!=="multicategory"){var d=i("tickvals");if(d===undefined)r.tickmode="auto";else i("ticktext")}}},{"../../lib":778,"./clean_ticks":833}],852:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../lib");var o=e("../../components/drawing");var s=e("./axes");t.exports=function e(t,r,l,u){var c=t._fullLayout;if(r.length===0){s.redrawComponents(t);return}function f(e){var t=e.xaxis;var r=e.yaxis;c._defs.select("#"+e.clipId+"> rect").call(o.setTranslate,0,0).call(o.setScale,1,1);e.plot.call(o.setTranslate,t._offset,r._offset).call(o.setScale,1,1);var n=e.plot.selectAll(".scatterlayer .trace");n.selectAll(".point").call(o.setPointGroupScale,1,1);n.selectAll(".textpoint").call(o.setTextPointsScale,1,1);n.call(o.hideOutsideRangePoints,e)}function h(e,r){var n=e.plotinfo;var a=n.xaxis;var l=n.yaxis;var u=a._length;var c=l._length;var f=!!e.xr1;var h=!!e.yr1;var p=[];if(f){var d=i.simpleMap(e.xr0,a.r2l);var v=i.simpleMap(e.xr1,a.r2l);var m=d[1]-d[0];var g=v[1]-v[0];p[0]=(d[0]*(1-r)+r*v[0]-d[0])/(d[1]-d[0])*u;p[2]=u*(1-r+r*g/m);a.range[0]=a.l2r(d[0]*(1-r)+r*v[0]);a.range[1]=a.l2r(d[1]*(1-r)+r*v[1])}else{p[0]=0;p[2]=u}if(h){var y=i.simpleMap(e.yr0,l.r2l);var x=i.simpleMap(e.yr1,l.r2l);var _=y[1]-y[0];var b=x[1]-x[0];p[1]=(y[1]*(1-r)+r*x[1]-y[1])/(y[0]-y[1])*c;p[3]=c*(1-r+r*b/_);l.range[0]=a.l2r(y[0]*(1-r)+r*x[0]);l.range[1]=l.l2r(y[1]*(1-r)+r*x[1])}else{p[1]=0;p[3]=c}s.drawOne(t,a,{skipTitle:true});s.drawOne(t,l,{skipTitle:true});s.redrawComponents(t,[a._id,l._id]);var w=f?u/p[2]:1;var T=h?c/p[3]:1;var k=f?p[0]:0;var A=h?p[1]:0;var M=f?p[0]/p[2]*u:0;var E=h?p[1]/p[3]*c:0;var S=a._offset-M;var C=l._offset-E;n.clipRect.call(o.setTranslate,k,A).call(o.setScale,1/w,1/T);n.plot.call(o.setTranslate,S,C).call(o.setScale,w,T);o.setPointGroupScale(n.zoomScalePts,1/w,1/T);o.setTextPointsScale(n.zoomScaleTxt,1/w,1/T)}var p;if(u){p=u()}function d(){var e={};for(var n=0;n<r.length;n++){var i=r[n];var o=i.plotinfo.xaxis;var s=i.plotinfo.yaxis;if(i.xr1)e[o._name+".range"]=i.xr1.slice();if(i.yr1)e[s._name+".range"]=i.yr1.slice()}p&&p();return a.call("relayout",t,e).then(function(){for(var e=0;e<r.length;e++){f(r[e].plotinfo)}})}function v(){var e={};for(var n=0;n<r.length;n++){var i=r[n];var o=i.plotinfo.xaxis;var s=i.plotinfo.yaxis;if(i.xr0)e[o._name+".range"]=i.xr0.slice();if(i.yr0)e[s._name+".range"]=i.yr0.slice()}return a.call("relayout",t,e).then(function(){for(var e=0;e<r.length;e++){f(r[e].plotinfo)}})}var m,g,y;var x=n.ease(l.easing);t._transitionData._interruptCallbacks.push(function(){window.cancelAnimationFrame(y);y=null;return v()});function _(){g=Date.now();var e=Math.min(1,(g-m)/l.duration);var t=x(e);for(var n=0;n<r.length;n++){h(r[n],t)}if(g-m>l.duration){d();y=window.cancelAnimationFrame(_)}else{y=window.requestAnimationFrame(_)}}m=Date.now();y=window.requestAnimationFrame(_);return Promise.resolve()}},{"../../components/drawing":665,"../../lib":778,"../../registry":911,"./axes":828,d3:169}],853:[function(e,t,r){"use strict";var n=e("../../registry").traceIs;var a=e("./axis_autotype");t.exports=function e(t,r,n,a){n("autotypenumbers",a.autotypenumbersDflt);var o=n("type",(a.splomStash||{}).type);if(o==="-"){i(r,a.data);if(r.type==="-"){r.type="linear"}else{t.type=r.type}}};function i(e,t){if(e.type!=="-")return;var r=e._id;var i=r.charAt(0);var u;if(r.indexOf("scene")!==-1)r=i;var c=o(t,r,i);if(!c)return;if(c.type==="histogram"&&i==={v:"y",h:"x"}[c.orientation||"v"]){e.type="linear";return}var f=i+"calendar";var h=c[f];var p={noMultiCategory:!n(c,"cartesian")||n(c,"noMultiCategory")};if(c.type==="box"&&c._hasPreCompStats&&i==={h:"x",v:"y"}[c.orientation||"v"]){p.noMultiCategory=true}p.autotypenumbers=e.autotypenumbers;if(l(c,i)){var d=s(c);var v=[];for(u=0;u<t.length;u++){var m=t[u];if(!n(m,"box-violin")||(m[i+"axis"]||i)!==r)continue;if(m[d]!==undefined)v.push(m[d][0]);else if(m.name!==undefined)v.push(m.name);else v.push("text");if(m[f]!==h)h=undefined}e.type=a(v,h,p)}else if(c.type==="splom"){var g=c.dimensions;var y=g[c._axesDim[r]];if(y.visible)e.type=a(y.values,h,p)}else{e.type=a(c[i]||[c[i+"0"]],h,p)}}function o(e,t,r){for(var n=0;n<e.length;n++){var a=e[n];if(a.type==="splom"&&a._length>0&&(a["_"+r+"axes"]||{})[t]){return a}if((a[r+"axis"]||r)===t){if(l(a,r)){return a}else if((a[r]||[]).length||a[r+"0"]){return a}}}}function s(e){return{v:"x",h:"y"}[e.orientation||"v"]}function l(e,t){var r=s(e);var a=n(e,"box-violin");var i=n(e._fullInput||{},"candlestick");return a&&!i&&t===r&&e[r]===undefined&&e[r+"0"]===undefined}},{"../../registry":911,"./axis_autotype":829}],854:[function(e,t,r){"use strict";var n=e("../registry");var a=e("../lib");r.manageCommandObserver=function(e,t,n,o){var s={};var l=true;if(t&&t._commandObserver){s=t._commandObserver}if(!s.cache){s.cache={}}s.lookupTable={};var u=r.hasSimpleAPICommandBindings(e,n,s.lookupTable);if(t&&t._commandObserver){if(!u){if(t._commandObserver.remove){t._commandObserver.remove();t._commandObserver=null;return s}}else{return s}}if(u){i(e,u,s.cache);s.check=function t(){if(!l)return;var r=i(e,u,s.cache);if(r.changed&&o){if(s.lookupTable[r.value]!==undefined){s.disable();Promise.resolve(o({value:r.value,type:u.type,prop:u.prop,traces:u.traces,index:s.lookupTable[r.value]})).then(s.enable,s.enable)}}return r.changed};var c=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"];for(var f=0;f<c.length;f++){e._internalOn(c[f],s.check)}s.remove=function(){for(var t=0;t<c.length;t++){e._removeInternalListener(c[t],s.check)}}}else{a.log("Unable to automatically bind plot updates to API command");s.lookupTable={};s.remove=function(){}}s.disable=function e(){l=false};s.enable=function e(){l=true};if(t){t._commandObserver=s}return s};r.hasSimpleAPICommandBindings=function(e,t,n){var a;var i=t.length;var o;for(a=0;a<i;a++){var s;var l=t[a];var u=l.method;var c=l.args;if(!Array.isArray(c))c=[];if(!u){return false}var f=r.computeAPICommandBindings(e,u,c);if(f.length!==1){return false}if(!o){o=f[0];if(Array.isArray(o.traces)){o.traces.sort()}}else{s=f[0];if(s.type!==o.type){return false}if(s.prop!==o.prop){return false}if(Array.isArray(o.traces)){if(Array.isArray(s.traces)){s.traces.sort();for(var h=0;h<o.traces.length;h++){if(o.traces[h]!==s.traces[h]){return false}}}else{return false}}else{if(s.prop!==o.prop){return false}}}s=f[0];var p=s.value;if(Array.isArray(p)){if(p.length===1){p=p[0]}else{return false}}if(n){n[p]=a}}return o};function i(e,t,r){var n,i,o;var s=false;if(t.type==="data"){n=e._fullData[t.traces!==null?t.traces[0]:0]}else if(t.type==="layout"){n=e._fullLayout}else{return false}i=a.nestedProperty(n,t.prop).get();o=r[t.type]=r[t.type]||{};if(o.hasOwnProperty(t.prop)){if(o[t.prop]!==i){s=true}}o[t.prop]=i;return{changed:s,value:i}}r.executeAPICommand=function(e,t,r){if(t==="skip")return Promise.resolve();var i=n.apiMethodRegistry[t];var o=[e];if(!Array.isArray(r))r=[];for(var s=0;s<r.length;s++){o.push(r[s])}return i.apply(null,o).catch(function(e){a.warn("API call to Plotly."+t+" rejected.",e);return Promise.reject(e)})};r.computeAPICommandBindings=function(e,t,r){var n;if(!Array.isArray(r))r=[];switch(t){case"restyle":n=l(e,r);break;case"relayout":n=s(e,r);break;case"update":n=l(e,[r[0],r[2]]).concat(s(e,[r[1]]));break;case"animate":n=o(e,r);break;default:n=[]}return n};function o(e,t){if(Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1){return[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]}else{return[]}}function s(e,t){var r=[];var n=t[0];var i={};if(typeof n==="string"){i[n]=t[1]}else if(a.isPlainObject(n)){i=n}else{return r}u(i,function(e,t,n){r.push({type:"layout",prop:e,value:n})},"",0);return r}function l(e,t){var r,n,i,o;var s=[];n=t[0];i=t[1];r=t[2];o={};if(typeof n==="string"){o[n]=i}else if(a.isPlainObject(n)){o=n;if(r===undefined){r=i}}else{return s}if(r===undefined){r=null}u(o,function(t,n,a){var i;var o;if(Array.isArray(a)){o=a.slice();var l=Math.min(o.length,e.data.length);if(r){l=Math.min(l,r.length)}i=[];for(var u=0;u<l;u++){i[u]=r?r[u]:u}}else{o=a;i=r?r.slice():null}if(i===null){if(Array.isArray(o)){o=o[0]}}else if(Array.isArray(i)){if(!Array.isArray(o)){var c=o;o=[];for(var f=0;f<i.length;f++){o[f]=c}}o.length=Math.min(i.length,o.length)}s.push({type:"data",prop:t,traces:i,value:o})},"",0);return s}function u(e,t,r,n){Object.keys(e).forEach(function(i){var o=e[i];if(i[0]==="_")return;var s=r+(n>0?".":"")+i;if(a.isPlainObject(o)){u(o,t,s,n+1)}else{t(s,i,o)}})}},{"../lib":778,"../registry":911}],855:[function(e,t,r){"use strict";var n=e("../lib/extend").extendFlat;r.attributes=function(e,t){e=e||{};t=t||{};var r={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]};var a=e.name?e.name+" ":"";var i=e.trace?"trace ":"subplot ";var o=t.description?" "+t.description:"";var s={x:n({},r,{}),y:n({},r,{}),editType:e.editType};if(!e.noGridCell){s.row={valType:"integer",min:0,dflt:0,editType:e.editType};s.column={valType:"integer",min:0,dflt:0,editType:e.editType}}return s};r.defaults=function(e,t,r,n){var a=n&&n.x||[0,1];var i=n&&n.y||[0,1];var o=t.grid;if(o){var s=r("domain.column");if(s!==undefined){if(s<o.columns)a=o._domains.x[s];else delete e.domain.column}var l=r("domain.row");if(l!==undefined){if(l<o.rows)i=o._domains.y[l];else delete e.domain.row}}var u=r("domain.x",a);var c=r("domain.y",i);if(!(u[0]<u[1]))e.domain.x=a.slice();if(!(c[0]<c[1]))e.domain.y=i.slice()}},{"../lib/extend":768}],856:[function(e,t,r){"use strict";t.exports=function(e){var t=e.editType;var r=e.colorEditType;if(r===undefined)r=t;var n={family:{valType:"string",noBlank:true,strict:true,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:r},editType:t};if(e.arrayOk){n.family.arrayOk=true;n.size.arrayOk=true;n.color.arrayOk=true}return n}},{}],857:[function(e,t,r){"use strict";t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],858:[function(e,t,r){"use strict";r.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"};r.axesNames=["lonaxis","lataxis"];r.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360};r.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180};r.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}};r.clipPad=.001;r.precision=.1;r.landColor="#F0DC82";r.waterColor="#3399FF";r.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"};r.sphereSVG={type:"Sphere"};r.fillLayers={ocean:1,land:1,lakes:1};r.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1};r.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"];r.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"];r.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],859:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../lib");var o=i.strTranslate;var s=e("../../components/color");var l=e("../../components/drawing");var u=e("../../components/fx");var c=e("../plots");var f=e("../cartesian/axes");var h=e("../cartesian/autorange").getAutoRange;var p=e("../../components/dragelement");var d=e("../cartesian/select").prepSelect;var v=e("../cartesian/select").clearSelect;var m=e("../cartesian/select").selectOnClick;var g=e("./zoom");var y=e("./constants");var x=e("../../lib/geo_location_utils");var _=e("../../lib/topojson_utils");var b=e("topojson-client").feature;e("./projections")(n);function w(e){this.id=e.id;this.graphDiv=e.graphDiv;this.container=e.container;this.topojsonURL=e.topojsonURL;this.isStatic=e.staticPlot;this.topojsonName=null;this.topojson=null;this.projection=null;this.scope=null;this.viewInitial=null;this.fitScale=null;this.bounds=null;this.midPt=null;this.hasChoropleth=false;this.traceHash={};this.layers={};this.basePaths={};this.dataPaths={};this.dataPoints={};this.clipDef=null;this.clipRect=null;this.bgRect=null;this.makeFramework()}var T=w.prototype;t.exports=function e(t){return new w(t)};T.plot=function(e,t,r){var n=this;var a=t[this.id];var i=[];var o=false;for(var s in y.layerNameToAdjective){if(s!=="frame"&&a["show"+s]){o=true;break}}for(var l=0;l<e.length;l++){if(e[0][0].trace.locationmode){o=true;break}}if(o){var u=_.getTopojsonName(a);if(n.topojson===null||u!==n.topojsonName){n.topojsonName=u;if(PlotlyGeoAssets.topojson[n.topojsonName]===undefined){i.push(n.fetchTopojson())}}}i=i.concat(x.fetchTraceGeoData(e));r.push(new Promise(function(r,a){Promise.all(i).then(function(){n.topojson=PlotlyGeoAssets.topojson[n.topojsonName];n.update(e,t);r()}).catch(a)}))};T.fetchTopojson=function(){var e=this;var t=_.getTopojsonPath(e.topojsonURL,e.topojsonName);return new Promise(function(r,a){n.json(t,function(n,i){if(n){if(n.status===404){return a(new Error(["plotly.js could not find topojson file at",t,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")))}else{return a(new Error(["unexpected error while fetching topojson file at",t].join(" ")))}}PlotlyGeoAssets.topojson[e.topojsonName]=i;r()})})};T.update=function(e,t){var r=t[this.id];this.hasChoropleth=false;for(var n=0;n<e.length;n++){var a=e[n];var i=a[0].trace;if(i.type==="choropleth"){this.hasChoropleth=true}if(i.visible===true&&i._length>0){i._module.calcGeoJSON(a,t)}}var o=this.updateProjection(e,t);if(o)return;if(!this.viewInitial||this.scope!==r.scope){this.saveViewInitial(r)}this.scope=r.scope;this.updateBaseLayers(t,r);this.updateDims(t,r);this.updateFx(t,r);c.generalUpdatePerTraceModule(this.graphDiv,this,e,r);var s=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=s.selectAll(".point");this.dataPoints.text=s.selectAll("text");this.dataPaths.line=s.selectAll(".js-line");var l=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=l.selectAll("path");this.render()};T.updateProjection=function(e,t){var r=this.graphDiv;var n=t[this.id];var o=t._size;var s=n.domain;var l=n.projection;var u=n.lonaxis;var c=n.lataxis;var f=u._ax;var p=c._ax;var d=this.projection=k(n);var v=[[o.l+o.w*s.x[0],o.t+o.h*(1-s.y[1])],[o.l+o.w*s.x[1],o.t+o.h*(1-s.y[0])]];var m=n.center||{};var g=l.rotation||{};var x=u.range||[];var _=c.range||[];if(n.fitbounds){f._length=v[1][0]-v[0][0];p._length=v[1][1]-v[0][1];f.range=h(r,f);p.range=h(r,p);var b=(f.range[0]+f.range[1])/2;var w=(p.range[0]+p.range[1])/2;if(n._isScoped){m={lon:b,lat:w}}else if(n._isClipped){m={lon:b,lat:w};g={lon:b,lat:w,roll:g.roll};var T=l.type;var A=y.lonaxisSpan[T]/2||180;var E=y.lataxisSpan[T]/2||90;x=[b-A,b+A];_=[w-E,w+E]}else{m={lon:b,lat:w};g={lon:b,lat:g.lat,roll:g.roll}}}d.center([m.lon-g.lon,m.lat-g.lat]).rotate([-g.lon,-g.lat,g.roll]).parallels(l.parallels);var S=M(x,_);d.fitExtent(v,S);var C=this.bounds=d.getBounds(S);var L=this.fitScale=d.scale();var I=d.translate();if(!isFinite(C[0][0])||!isFinite(C[0][1])||!isFinite(C[1][0])||!isFinite(C[1][1])||isNaN(I[0])||isNaN(I[0])){var O=["fitbounds","projection.rotation","center","lonaxis.range","lataxis.range"];var P="Invalid geo settings, relayout'ing to default view.";var D={};for(var R=0;R<O.length;R++){D[this.id+"."+O[R]]=null}this.viewInitial=null;i.warn(P);r._promises.push(a.call("relayout",r,D));return P}if(n.fitbounds){var z=d.getBounds(M(f.range,p.range));var N=Math.min((C[1][0]-C[0][0])/(z[1][0]-z[0][0]),(C[1][1]-C[0][1])/(z[1][1]-z[0][1]));if(isFinite(N)){d.scale(N*L)}else{i.warn("Something went wrong during"+this.id+"fitbounds computations.")}}else{d.scale(l.scale*L)}var F=this.midPt=[(C[0][0]+C[1][0])/2,(C[0][1]+C[1][1])/2];d.translate([I[0]+(F[0]-I[0]),I[1]+(F[1]-I[1])]).clipExtent(C);if(n._isAlbersUsa){var B=d([m.lon,m.lat]);var j=d.translate();d.translate([j[0]-(B[0]-j[0]),j[1]-(B[1]-j[1])])}};T.updateBaseLayers=function(e,t){var r=this;var a=r.topojson;var i=r.layers;var o=r.basePaths;function u(e){return e==="lonaxis"||e==="lataxis"}function c(e){return Boolean(y.lineLayers[e])}function f(e){return Boolean(y.fillLayers[e])}var h=this.hasChoropleth?y.layersForChoropleth:y.layers;var p=h.filter(function(e){return c(e)||f(e)?t["show"+e]:u(e)?t[e].showgrid:true});var d=r.framework.selectAll(".layer").data(p,String);d.exit().each(function(e){delete i[e];delete o[e];n.select(this).remove()});d.enter().append("g").attr("class",function(e){return"layer "+e}).each(function(e){var t=i[e]=n.select(this);if(e==="bg"){r.bgRect=t.append("rect").style("pointer-events","all")}else if(u(e)){o[e]=t.append("path").style("fill","none")}else if(e==="backplot"){t.append("g").classed("choroplethlayer",true)}else if(e==="frontplot"){t.append("g").classed("scatterlayer",true)}else if(c(e)){o[e]=t.append("path").style("fill","none").style("stroke-miterlimit",2)}else if(f(e)){o[e]=t.append("path").style("stroke","none")}});d.order();d.each(function(r){var n=o[r];var i=y.layerNameToAdjective[r];if(r==="frame"){n.datum(y.sphereSVG)}else if(c(r)||f(r)){n.datum(b(a,a.objects[r]))}else if(u(r)){n.datum(A(r,t,e)).call(s.stroke,t[r].gridcolor).call(l.dashLine,"",t[r].gridwidth)}if(c(r)){n.call(s.stroke,t[i+"color"]).call(l.dashLine,"",t[i+"width"])}else if(f(r)){n.call(s.fill,t[i+"color"])}})};T.updateDims=function(e,t){var r=this.bounds;var n=(t.framewidth||0)/2;var a=r[0][0]-n;var i=r[0][1]-n;var o=r[1][0]-a+n;var u=r[1][1]-i+n;l.setRect(this.clipRect,a,i,o,u);this.bgRect.call(l.setRect,a,i,o,u).call(s.fill,t.bgcolor);this.xaxis._offset=a;this.xaxis._length=o;this.yaxis._offset=i;this.yaxis._length=u};T.updateFx=function(e,t){var r=this;var i=r.graphDiv;var o=r.bgRect;var s=e.dragmode;var l=e.clickmode;if(r.isStatic)return;function c(){var e=r.viewInitial;var t={};for(var n in e){t[r.id+"."+n]=e[n]}a.call("_guiRelayout",i,t);i.emit("plotly_doubleclick",null)}function f(e){return r.projection.invert([e[0]+r.xaxis._offset,e[1]+r.yaxis._offset])}var h;if(s==="select"){h=function(e,t){var n=e.range={};n[r.id]=[f([t.xmin,t.ymin]),f([t.xmax,t.ymax])]}}else if(s==="lasso"){h=function(e,t,n){var a=e.lassoPoints={};a[r.id]=n.filtered.map(f)}}var y={element:r.bgRect.node(),gd:i,plotinfo:{id:r.id,xaxis:r.xaxis,yaxis:r.yaxis,fillRangeItems:h},xaxes:[r.xaxis],yaxes:[r.yaxis],subplot:r.id,clickFn:function(e){if(e===2){v(i)}}};if(s==="pan"){o.node().onmousedown=null;o.call(g(r,t));o.on("dblclick.zoom",c);if(!i._context._scrollZoom.geo){o.on("wheel.zoom",null)}}else if(s==="select"||s==="lasso"){o.on(".zoom",null);y.prepFn=function(e,t,r){d(e,t,r,y,s)};p.init(y)}o.on("mousemove",function(){var e=r.projection.invert(n.mouse(this));if(!e||isNaN(e[0])||isNaN(e[1])){return p.unhover(i,n.event)}r.xaxis.p2c=function(){return e[0]};r.yaxis.p2c=function(){return e[1]};u.hover(i,n.event,r.id)});o.on("mouseout",function(){if(i._dragging)return;p.unhover(i,n.event)});o.on("click",function(){if(s!=="select"&&s!=="lasso"){if(l.indexOf("select")>-1){m(n.event,i,[r.xaxis],[r.yaxis],r.id,y)}if(l.indexOf("event")>-1){u.click(i,n.event)}}})};T.makeFramework=function(){var e=this;var t=e.graphDiv;var r=t._fullLayout;var a="clip"+r._uid+e.id;e.clipDef=r._clips.append("clipPath").attr("id",a);e.clipRect=e.clipDef.append("rect");e.framework=n.select(e.container).append("g").attr("class","geo "+e.id).call(l.setClipUrl,a,t);e.project=function(t){var r=e.projection(t);return r?[r[0]-e.xaxis._offset,r[1]-e.yaxis._offset]:[null,null]};e.xaxis={_id:"x",c2p:function(t){return e.project(t)[0]}};e.yaxis={_id:"y",c2p:function(t){return e.project(t)[1]}};e.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};f.setConvert(e.mockAxis,r)};T.saveViewInitial=function(e){var t=e.center||{};var r=e.projection;var n=r.rotation||{};this.viewInitial={fitbounds:e.fitbounds,"projection.scale":r.scale};var a;if(e._isScoped){a={"center.lon":t.lon,"center.lat":t.lat}}else if(e._isClipped){a={"projection.rotation.lon":n.lon,"projection.rotation.lat":n.lat}}else{a={"center.lon":t.lon,"center.lat":t.lat,"projection.rotation.lon":n.lon}}i.extendFlat(this.viewInitial,a)};T.render=function(){var e=this.projection;var t=e.getPath();var r;function n(t){var r=e(t.lonlat);return r?o(r[0],r[1]):null}function a(t){return e.isLonLatOverEdges(t.lonlat)?"none":null}for(r in this.basePaths){this.basePaths[r].attr("d",t)}for(r in this.dataPaths){this.dataPaths[r].attr("d",function(e){return t(e.geojson)})}for(r in this.dataPoints){this.dataPoints[r].attr("display",a).attr("transform",n)}};function k(e){var t=e.projection;var r=t.type;var a=n.geo[y.projNames[r]]();var i=e._isClipped?y.lonaxisSpan[r]/2:null;var o=["center","rotate","parallels","clipExtent"];var s=function(e){return e?a:[]};for(var l=0;l<o.length;l++){var u=o[l];if(typeof a[u]!=="function"){a[u]=s}}a.isLonLatOverEdges=function(e){if(a(e)===null){return true}if(i){var t=a.rotate();var r=n.geo.distance(e,[-t[0],-t[1]]);var o=i*Math.PI/180;return r>o}else{return false}};a.getPath=function(){return n.geo.path().projection(a)};a.getBounds=function(e){return a.getPath().bounds(e)};a.fitExtent=function(e,t){var r=e[1][0]-e[0][0];var n=e[1][1]-e[0][1];var i=a.clipExtent&&a.clipExtent();a.scale(150).translate([0,0]);if(i)a.clipExtent(null);var o=a.getBounds(t);var s=Math.min(r/(o[1][0]-o[0][0]),n/(o[1][1]-o[0][1]));var l=+e[0][0]+(r-s*(o[1][0]+o[0][0]))/2;var u=+e[0][1]+(n-s*(o[1][1]+o[0][1]))/2;if(i)a.clipExtent(i);return a.scale(s*150).translate([l,u])};a.precision(y.precision);if(i){a.clipAngle(i-y.clipPad)}return a}function A(e,t,r){var n=1e-6;var a=2.5;var i=t[e];var o=y.scopeDefaults[t.scope];var s;var l;var u;if(e==="lonaxis"){s=o.lonaxisRange;l=o.lataxisRange;u=function(e,t){return[e,t]}}else if(e==="lataxis"){s=o.lataxisRange;l=o.lonaxisRange;u=function(e,t){return[t,e]}}var c={type:"linear",range:[s[0],s[1]-n],tick0:i.tick0,dtick:i.dtick};f.setConvert(c,r);var h=f.calcTicks(c);if(!t.isScoped&&e==="lonaxis"){h.pop()}var p=h.length;var d=new Array(p);for(var v=0;v<p;v++){var m=h[v].x;var g=d[v]=[];for(var x=l[0];x<l[1]+a;x+=a){g.push(u(m,x))}}return{type:"MultiLineString",coordinates:d}}function M(e,t){var r=y.clipPad;var n=e[0]+r;var a=e[1]-r;var i=t[0]+r;var o=t[1]-r;if(n>0&&a<0)a+=360;var s=(a-n)/4;return{type:"Polygon",coordinates:[[[n,i],[n,o],[n+s,o],[n+2*s,o],[n+3*s,o],[a,o],[a,i],[a-s,i],[a-2*s,i],[a-3*s,i],[n,i]]]}}},{"../../components/color":643,"../../components/dragelement":662,"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/topojson_utils":806,"../../registry":911,"../cartesian/autorange":827,"../cartesian/axes":828,"../cartesian/select":847,"../plots":891,"./constants":858,"./projections":863,"./zoom":864,d3:169,"topojson-client":579}],860:[function(e,t,r){"use strict";var n=e("../../plots/get_data").getSubplotCalcData;var a=e("../../lib").counterRegex;var i=e("./geo");var o="geo";var s=a(o);var l={};l[o]={valType:"subplotid",dflt:o,editType:"calc"};function u(e){var t=e._fullLayout;var r=e.calcdata;var a=t._subplots[o];for(var s=0;s<a.length;s++){var l=a[s];var u=n(r,o,l);var c=t[l];var f=c._subplot;if(!f){f=i({id:l,graphDiv:e,container:t._geolayer.node(),topojsonURL:e._context.topojsonURL,staticPlot:e._context.staticPlot});t[l]._subplot=f}f.plot(u,t,e._promises)}}function c(e,t,r,n){var a=n._subplots[o]||[];for(var i=0;i<a.length;i++){var s=a[i];var l=n[s]._subplot;if(!t[s]&&!!l){l.framework.remove();l.clipDef.remove()}}}function f(e){var t=e._fullLayout;var r=t._subplots[o];for(var n=0;n<r.length;n++){var a=t[r[n]];var i=a._subplot;i.updateFx(t,a)}}t.exports={attr:o,name:o,idRoot:o,idRegex:s,attrRegex:s,attributes:l,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:u,updateFx:f,clean:c}},{"../../lib":778,"../../plots/get_data":865,"./geo":859,"./layout_attributes":861,"./layout_defaults":862}],861:[function(e,t,r){"use strict";var n=e("../../components/color/attributes");var a=e("../domain").attributes;var i=e("./constants");var o=e("../../plot_api/edit_types").overrideAll;var s={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:false},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:n.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};var l=t.exports=o({domain:a({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[false,"locations","geojson"],dflt:false,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:true},scope:{valType:"enumerated",values:Object.keys(i.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(i.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:true},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:n.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:false},landcolor:{valType:"color",dflt:i.landColor},showocean:{valType:"boolean",dflt:false},oceancolor:{valType:"color",dflt:i.waterColor},showlakes:{valType:"boolean",dflt:false},lakecolor:{valType:"color",dflt:i.waterColor},showrivers:{valType:"boolean",dflt:false},rivercolor:{valType:"color",dflt:i.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:n.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:n.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:n.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:n.background},lonaxis:s,lataxis:s},"plot","from-root");l.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":642,"../../plot_api/edit_types":810,"../domain":855,"./constants":858}],862:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../subplot_defaults");var i=e("../get_data").getSubplotData;var o=e("./constants");var s=e("./layout_attributes");var l=o.axesNames;t.exports=function e(t,r,n){a(t,r,n,{type:"geo",attributes:s,handleDefaults:u,fullData:n,partition:"y"})};function u(e,t,r,a){var s=i(a.fullData,"geo",a.id);var u=s.map(function(e){return e._expandedIndex});var c=r("resolution");var f=r("scope");var h=o.scopeDefaults[f];var p=r("projection.type",h.projType);var d=t._isAlbersUsa=p==="albers usa";if(d)f=t.scope="usa";var v=t._isScoped=f!=="world";var m=t._isConic=p.indexOf("conic")!==-1;var g=t._isClipped=!!o.lonaxisSpan[p];if(e.visible===false){var y=n.extendDeep({},t._template);y.showcoastlines=false;y.showcountries=false;y.showframe=false;y.showlakes=false;y.showland=false;y.showocean=false;y.showrivers=false;y.showsubunits=false;if(y.lonaxis)y.lonaxis.showgrid=false;if(y.lataxis)y.lataxis.showgrid=false;t._template=y}var x=r("visible");var _;for(var b=0;b<l.length;b++){var w=l[b];var T=[30,10][b];var k;if(v){k=h[w+"Range"]}else{var A=o[w+"Span"];var M=(A[p]||A["*"])/2;var E=r("projection.rotation."+w.substr(0,3),h.projRotate[b]);k=[E-M,E+M]}var S=r(w+".range",k);r(w+".tick0");r(w+".dtick",T);_=r(w+".showgrid",!x?false:undefined);if(_){r(w+".gridcolor");r(w+".gridwidth")}t[w]._ax={type:"linear",_id:w.slice(0,3),_traceIndices:u,setScale:n.identity,c2l:n.identity,r2l:n.identity,autorange:true,range:S.slice(),_m:1,_input:{}}}var C=t.lonaxis.range;var L=t.lataxis.range;var I=C[0];var O=C[1];if(I>0&&O<0)O+=360;var P=(I+O)/2;var D;if(!d){var R=v?h.projRotate:[P,0,0];D=r("projection.rotation.lon",R[0]);r("projection.rotation.lat",R[1]);r("projection.rotation.roll",R[2]);_=r("showcoastlines",!v&&x);if(_){r("coastlinecolor");r("coastlinewidth")}_=r("showocean",!x?false:undefined);if(_)r("oceancolor")}var z;var N;if(d){z=-96.6;N=38.7}else{z=v?P:D;N=(L[0]+L[1])/2}r("center.lon",z);r("center.lat",N);if(m){var F=h.projParallels||[0,60];r("projection.parallels",F)}r("projection.scale");_=r("showland",!x?false:undefined);if(_)r("landcolor");_=r("showlakes",!x?false:undefined);if(_)r("lakecolor");_=r("showrivers",!x?false:undefined);if(_){r("rivercolor");r("riverwidth")}_=r("showcountries",v&&f!=="usa"&&x);if(_){r("countrycolor");r("countrywidth")}if(f==="usa"||f==="north america"&&c===50){r("showsubunits",x);r("subunitcolor");r("subunitwidth")}if(!v){_=r("showframe",x);if(_){r("framecolor");r("framewidth")}}r("bgcolor");var B=r("fitbounds");if(B){delete t.projection.scale;if(v){delete t.center.lon;delete t.center.lat}else if(g){delete t.center.lon;delete t.center.lat;delete t.projection.rotation.lon;delete t.projection.rotation.lat;delete t.lonaxis.range;delete t.lataxis.range}else{delete t.center.lon;delete t.center.lat;delete t.projection.rotation.lon}}}},{"../../lib":778,"../get_data":865,"../subplot_defaults":905,"./constants":858,"./layout_attributes":861}],863:[function(e,t,r){"use strict";function n(e){e.geo.project=function(e,t){var a=t.stream;if(!a)throw new Error("not yet supported");return(e&&n.hasOwnProperty(e.type)?n[e.type]:r)(e,a)};function t(e,t){return{type:"Feature",id:e.id,properties:e.properties,geometry:r(e.geometry,t)}}function r(t,n){if(!t)return null;if(t.type==="GeometryCollection")return{type:"GeometryCollection",geometries:object.geometries.map(function(e){return r(e,n)})};if(!u.hasOwnProperty(t.type))return null;var a=u[t.type];e.geo.stream(t,n(a));return a.result()}var n={Feature:t,FeatureCollection:function(e,r){return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,r)})}}};var a=[],i=[];var o={point:function(e,t){a.push([e,t])},result:function(){var e=!a.length?null:a.length<2?{type:"Point",coordinates:a[0]}:{type:"MultiPoint",coordinates:a};a=[];return e}};var s={lineStart:c,point:function(e,t){a.push([e,t])},lineEnd:function(){if(a.length)i.push(a),a=[]},result:function(){var e=!i.length?null:i.length<2?{type:"LineString",coordinates:i[0]}:{type:"MultiLineString",coordinates:i};i=[];return e}};var l={polygonStart:c,lineStart:c,point:function(e,t){a.push([e,t])},lineEnd:function(){var e=a.length;if(e){do{a.push(a[0].slice())}while(++e<4);i.push(a),a=[]}},polygonEnd:c,result:function(){if(!i.length)return null;var e=[],t=[];i.forEach(function(r){if(f(r))e.push([r]);else t.push(r)});t.forEach(function(t){var r=t[0];e.some(function(e){if(h(e[0],r)){e.push(t);return true}})||e.push([t])});i=[];return!e.length?null:e.length>1?{type:"MultiPolygon",coordinates:e}:{type:"Polygon",coordinates:e[0]}}};var u={Point:o,MultiPoint:o,LineString:s,MultiLineString:s,Polygon:l,MultiPolygon:l,Sphere:l};function c(){}function f(e){if((r=e.length)<4)return false;var t=0,r,n=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];while(++t<r)n+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return n<=0}function h(e,t){var r=t[0],n=t[1],a=false;for(var i=0,o=e.length,s=o-1;i<o;s=i++){var l=e[i],u=l[0],c=l[1],f=e[s],h=f[0],p=f[1];if(c>n^p>n&&r<(h-u)*(n-c)/(p-c)+u)a=!a}return a}var p=1e-6,d=p*p,v=Math.PI,m=v/2,g=Math.sqrt(v),y=v/180,x=180/v;function _(e){return e?e/Math.sin(e):1}function b(e){return e>0?1:e<0?-1:0}function w(e){return e>1?m:e<-1?-m:Math.asin(e)}function T(e){return e>1?0:e<-1?v:Math.acos(e)}function k(e){return e>0?Math.sqrt(e):0}var A=e.geo.projection,M=e.geo.projectionMutator;e.geo.interrupt=function(t){var r=[[[[-v,0],[0,m],[v,0]]],[[[-v,0],[0,-m],[v,0]]]];var n;function a(e,n){var a=n<0?-1:+1,i=r[+(n<0)];for(var o=0,s=i.length-1;o<s&&e>i[o][2][0];++o);var l=t(e-i[o][1][0],n);l[0]+=t(i[o][1][0],a*n>a*i[o][0][1]?i[o][0][1]:n)[0];return l}function i(){n=r.map(function(e){return e.map(function(e){var r=t(e[0][0],e[0][1])[0],n=t(e[2][0],e[2][1])[0],a=t(e[1][0],e[0][1])[1],i=t(e[1][0],e[1][1])[1],o;if(a>i)o=a,a=i,i=o;return[[r,a],[n,i]]})})}if(t.invert)a.invert=function(e,i){var o=n[+(i<0)],s=r[+(i<0)];for(var l=0,u=o.length;l<u;++l){var f=o[l];if(f[0][0]<=e&&e<f[1][0]&&f[0][1]<=i&&i<f[1][1]){var h=t.invert(e-t(s[l][1][0],0)[0],i);h[0]+=s[l][1][0];return c(a(h[0],h[1]),[e,i])?h:null}}};var o=e.geo.projection(a),s=o.stream;o.stream=function(t){var r=o.rotate(),n=s(t),a=(o.rotate([0,0]),s(t));o.rotate(r);n.sphere=function(){e.geo.stream(l(),a)};return n};o.lobes=function(e){if(!arguments.length)return r.map(function(e){return e.map(function(e){return[[e[0][0]*180/v,e[0][1]*180/v],[e[1][0]*180/v,e[1][1]*180/v],[e[2][0]*180/v,e[2][1]*180/v]]})});r=e.map(function(e){return e.map(function(e){return[[e[0][0]*v/180,e[0][1]*v/180],[e[1][0]*v/180,e[1][1]*v/180],[e[2][0]*v/180,e[2][1]*v/180]]})});i();return o};function l(){var t=1e-6,n=[];for(var a=0,i=r[0].length;a<i;++a){var o=r[0][a],s=o[0][0]*180/v,l=o[0][1]*180/v,c=o[1][1]*180/v,f=o[2][0]*180/v,h=o[2][1]*180/v;n.push(u([[s+t,l+t],[s+t,c-t],[f-t,c-t],[f-t,h+t]],30))}for(var a=r[1].length-1;a>=0;--a){var o=r[1][a],s=o[0][0]*180/v,l=o[0][1]*180/v,c=o[1][1]*180/v,f=o[2][0]*180/v,h=o[2][1]*180/v;n.push(u([[f-t,h-t],[f-t,c+t],[s+t,c+t],[s+t,l-t]],30))}return{type:"Polygon",coordinates:[e.merge(n)]}}function u(e,t){var r=-1,n=e.length,a=e[0],i,o,s,l=[];while(++r<n){i=e[r];o=(i[0]-a[0])/t;s=(i[1]-a[1])/t;for(var u=0;u<t;++u)l.push([a[0]+u*o,a[1]+u*s]);a=i}l.push(i);return l}function c(e,t){return Math.abs(e[0]-t[0])<p&&Math.abs(e[1]-t[1])<p}return o};function E(e,t){var r=(2+m)*Math.sin(t);t/=2;for(var n=0,a=Infinity;n<10&&Math.abs(a)>p;n++){var i=Math.cos(t);t-=a=(t+Math.sin(t)*(i+2)-r)/(2*i*(1+i))}return[2/Math.sqrt(v*(4+v))*e*(1+Math.cos(t)),2*Math.sqrt(v/(4+v))*Math.sin(t)]}E.invert=function(e,t){var r=.5*t*Math.sqrt((4+v)/v),n=w(r),a=Math.cos(n);return[e/(2/Math.sqrt(v*(4+v))*(1+a)),w((n+r*(a+2))/(2+m))]};(e.geo.eckert4=function(){return A(E)}).raw=E;var S=e.geo.azimuthalEqualArea.raw;function C(e,t){if(arguments.length<2)t=e;if(t===1)return S;if(t===Infinity)return I;function r(r,n){var a=S(r/t,n);a[0]*=e;return a}r.invert=function(r,n){var a=S.invert(r/e,n);a[0]*=t;return a};return r}function L(){var e=2,t=M(C),r=t(e);r.coefficient=function(r){if(!arguments.length)return e;return t(e=+r)};return r}function I(e,t){return[e*Math.cos(t)/Math.cos(t/=2),2*Math.sin(t)]}I.invert=function(e,t){var r=2*w(t/2);return[e*Math.cos(r/2)/Math.cos(r),r]};(e.geo.hammer=L).raw=C;function O(e,t){return[3*e/(2*v)*Math.sqrt(v*v/3-t*t),t]}O.invert=function(e,t){return[2/3*v*e/Math.sqrt(v*v/3-t*t),t]};(e.geo.kavrayskiy7=function(){return A(O)}).raw=O;function P(e,t){return[e,1.25*Math.log(Math.tan(v/4+.4*t))]}P.invert=function(e,t){return[e,2.5*Math.atan(Math.exp(.8*t))-.625*v]};(e.geo.miller=function(){return A(P)}).raw=P;function D(e){return function(t){var r=e*Math.sin(t),n=30,a;do{t-=a=(t+Math.sin(t)-r)/(1+Math.cos(t))}while(Math.abs(a)>p&&--n>0);return t/2}}function R(e,t,r){var n=D(r);function a(r,a){return[e*r*Math.cos(a=n(a)),t*Math.sin(a)]}a.invert=function(n,a){var i=w(a/t);return[n/(e*Math.cos(i)),w((2*i+Math.sin(2*i))/r)]};return a}var z=D(v),N=R(Math.SQRT2/m,Math.SQRT2,v);(e.geo.mollweide=function(){return A(N)}).raw=N;function F(e,t){var r=t*t,n=r*r;return[e*(.8707-.131979*r+n*(-.013791+n*(.003971*r-.001529*n))),t*(1.007226+r*(.015085+n*(-.044475+.028874*r-.005916*n)))]}F.invert=function(e,t){var r=t,n=25,a;do{var i=r*r,o=i*i;r-=a=(r*(1.007226+i*(.015085+o*(-.044475+.028874*i-.005916*o)))-t)/(1.007226+i*(.015085*3+o*(-.044475*7+.028874*9*i-.005916*11*o)))}while(Math.abs(a)>p&&--n>0);return[e/(.8707+(i=r*r)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),r]};(e.geo.naturalEarth=function(){return A(F)}).raw=F;var B=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];B.forEach(function(e){e[1]*=1.0144});function j(e,t){var r=Math.min(18,Math.abs(t)*36/v),n=Math.floor(r),a=r-n,i=(f=B[n])[0],o=f[1],s=(f=B[++n])[0],l=f[1],u=(f=B[Math.min(19,++n)])[0],c=f[1],f;return[e*(s+a*(u-i)/2+a*a*(u-2*s+i)/2),(t>0?m:-m)*(l+a*(c-o)/2+a*a*(c-2*l+o)/2)]}j.invert=function(e,t){var r=t/m,n=r*90,a=Math.min(18,Math.abs(n/5)),i=Math.max(0,Math.floor(a));do{var o=B[i][1],s=B[i+1][1],l=B[Math.min(19,i+2)][1],u=l-o,c=l-2*s+o,f=2*(Math.abs(r)-s)/u,h=c/u,p=f*(1-h*f*(1-2*h*f));if(p>=0||i===1){n=(t>=0?5:-5)*(p+a);var v=50,g;do{a=Math.min(18,Math.abs(n)/5);i=Math.floor(a);p=a-i;o=B[i][1];s=B[i+1][1];l=B[Math.min(19,i+2)][1];n-=(g=(t>=0?m:-m)*(s+p*(l-o)/2+p*p*(l-2*s+o)/2)-t)*x}while(Math.abs(g)>d&&--v>0);break}}while(--i>=0);var _=B[i][0],b=B[i+1][0],w=B[Math.min(19,i+2)][0];return[e/(b+p*(w-_)/2+p*p*(w-2*b+_)/2),n*y]};(e.geo.robinson=function(){return A(j)}).raw=j;function U(e,t){return[e*Math.cos(t),t]}U.invert=function(e,t){return[e/Math.cos(t),t]};(e.geo.sinusoidal=function(){return A(U)}).raw=U;function H(e,t){var r=Math.cos(t),n=_(T(r*Math.cos(e/=2)));return[2*r*Math.sin(e)*n,Math.sin(t)*n]}H.invert=function(e,t){if(e*e+4*t*t>v*v+p)return;var r=e,n=t,a=25;do{var i=Math.sin(r),o=Math.sin(r/2),s=Math.cos(r/2),l=Math.sin(n),u=Math.cos(n),c=Math.sin(2*n),f=l*l,h=u*u,d=o*o,m=1-h*s*s,g=m?T(u*s)*Math.sqrt(y=1/m):y=0,y,x=2*g*u*o-e,_=g*l-t,b=y*(h*d+g*u*s*f),w=y*(.5*i*c-g*2*l*o),k=y*.25*(c*o-g*l*h*i),A=y*(f*s+g*d*u),M=w*k-A*b;if(!M)break;var E=(_*w-x*A)/M,S=(x*k-_*b)/M;r-=E,n-=S}while((Math.abs(E)>p||Math.abs(S)>p)&&--a>0);return[r,n]};(e.geo.aitoff=function(){return A(H)}).raw=H;function V(e,t){var r=H(e,t);return[(r[0]+e/m)/2,(r[1]+t)/2]}V.invert=function(e,t){var r=e,n=t,a=25;do{var i=Math.cos(n),o=Math.sin(n),s=Math.sin(2*n),l=o*o,u=i*i,c=Math.sin(r),f=Math.cos(r/2),h=Math.sin(r/2),d=h*h,v=1-u*f*f,g=v?T(i*f)*Math.sqrt(y=1/v):y=0,y,x=.5*(2*g*i*h+r/m)-e,_=.5*(g*o+n)-t,b=.5*y*(u*d+g*i*f*l)+.5/m,w=y*(c*s/4-g*o*h),k=.125*y*(s*h-g*o*u*c),A=.5*y*(l*f+g*d*i)+.5,M=w*k-A*b,E=(_*w-x*A)/M,S=(x*k-_*b)/M;r-=E,n-=S}while((Math.abs(E)>p||Math.abs(S)>p)&&--a>0);return[r,n]};(e.geo.winkel3=function(){return A(V)}).raw=V}t.exports=n},{}],864:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../registry");var o=Math.PI/180;var s=180/Math.PI;var l={cursor:"pointer"};var u={cursor:"auto"};function c(e,t){var r=e.projection;var n;if(t._isScoped){n=p}else if(t._isClipped){n=v}else{n=d}return n(e,r)}t.exports=c;function f(e,t){return n.behavior.zoom().translate(t.translate()).scale(t.scale())}function h(e,t,r){var n=e.id;var o=e.graphDiv;var s=o.layout;var l=s[n];var u=o._fullLayout;var c=u[n];var f={};var h={};function p(e,t){f[n+"."+e]=a.nestedProperty(l,e).get();i.call("_storeDirectGUIEdit",s,u._preGUI,f);var r=a.nestedProperty(c,e);if(r.get()!==t){r.set(t);a.nestedProperty(l,e).set(t);h[n+"."+e]=t}}r(p);p("projection.scale",t.scale()/e.fitScale);p("fitbounds",false);o.emit("plotly_relayout",h)}function p(e,t){var r=f(e,t);function a(){n.select(this).style(l)}function i(){t.scale(n.event.scale).translate(n.event.translate);e.render();var r=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":r[0],"geo.center.lat":r[1]})}function o(r){var n=t.invert(e.midPt);r("center.lon",n[0]);r("center.lat",n[1])}function s(){n.select(this).style(u);h(e,t,o)}r.on("zoomstart",a).on("zoom",i).on("zoomend",s);return r}function d(e,t){var r=f(e,t);var a=2;var i,o,s,c,p,d,v,m,g;function y(e){return t.invert(e)}function x(e){var r=y(e);if(!r)return true;var n=t(r);return Math.abs(n[0]-e[0])>a||Math.abs(n[1]-e[1])>a}function _(){n.select(this).style(l);i=n.mouse(this);o=t.rotate();s=t.translate();c=o;p=y(i)}function b(){d=n.mouse(this);if(x(i)){r.scale(t.scale());r.translate(t.translate());return}t.scale(n.event.scale);t.translate([s[0],n.event.translate[1]]);if(!p){i=d;p=y(i)}else if(y(d)){m=y(d);v=[c[0]+(m[0]-p[0]),o[1],o[2]];t.rotate(v);c=v}g=true;e.render();var a=t.rotate();var l=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":l[0],"geo.center.lat":l[1],"geo.projection.rotation.lon":-a[0]})}function w(){n.select(this).style(u);if(g)h(e,t,T)}function T(r){var n=t.rotate();var a=t.invert(e.midPt);r("projection.rotation.lon",-n[0]);r("center.lon",a[0]);r("center.lat",a[1])}r.on("zoomstart",_).on("zoom",b).on("zoomend",w);return r}function v(e,t){var r={r:t.rotate(),k:t.scale()};var a=f(e,t);var i=S(a,"zoomstart","zoom","zoomend");var o=0;var s=a.on;var c;a.on("zoomstart",function(){n.select(this).style(l);var e=n.mouse(this);var o=t.rotate();var u=o;var f=t.translate();var h=g(o);c=m(t,e);s.call(a,"zoom",function(){var a=n.mouse(this);t.scale(r.k=n.event.scale);if(!c){e=a;c=m(t,e)}else if(m(t,a)){t.rotate(o).translate(f);var s=m(t,a);var l=x(c,s);var p=k(y(h,l));var v=r.r=_(p,c,u);if(!isFinite(v[0])||!isFinite(v[1])||!isFinite(v[2])){v=u}t.rotate(v);u=v}d(i.of(this,arguments))});p(i.of(this,arguments))}).on("zoomend",function(){n.select(this).style(u);s.call(a,"zoom",null);v(i.of(this,arguments));h(e,t,b)}).on("zoom.redraw",function(){e.render();var r=t.rotate();e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.projection.rotation.lon":-r[0],"geo.projection.rotation.lat":-r[1]})});function p(e){if(!o++)e({type:"zoomstart"})}function d(e){e({type:"zoom"})}function v(e){if(!--o)e({type:"zoomend"})}function b(e){var r=t.rotate();e("projection.rotation.lon",-r[0]);e("projection.rotation.lat",-r[1])}return n.rebind(a,i,"on")}function m(e,t){var r=e.invert(t);return r&&isFinite(r[0])&&isFinite(r[1])&&A(r)}function g(e){var t=.5*e[0]*o;var r=.5*e[1]*o;var n=.5*e[2]*o;var a=Math.sin(t);var i=Math.cos(t);var s=Math.sin(r);var l=Math.cos(r);var u=Math.sin(n);var c=Math.cos(n);return[i*l*c+a*s*u,a*l*c-i*s*u,i*s*c+a*l*u,i*l*u-a*s*c]}function y(e,t){var r=e[0];var n=e[1];var a=e[2];var i=e[3];var o=t[0];var s=t[1];var l=t[2];var u=t[3];return[r*o-n*s-a*l-i*u,r*s+n*o+a*u-i*l,r*l-n*u+a*o+i*s,r*u+n*l-a*s+i*o]}function x(e,t){if(!e||!t)return;var r=E(e,t);var n=Math.sqrt(M(r,r));var a=.5*Math.acos(Math.max(-1,Math.min(1,M(e,t))));var i=Math.sin(a)/n;return n&&[Math.cos(a),r[2]*i,-r[1]*i,r[0]*i]}function _(e,t,r){var n=T(t,2,e[0]);n=T(n,1,e[1]);n=T(n,0,e[2]-r[2]);var a=t[0];var i=t[1];var o=t[2];var l=n[0];var u=n[1];var c=n[2];var f=Math.atan2(i,a)*s;var h=Math.sqrt(a*a+i*i);var p;var d;if(Math.abs(u)>h){d=(u>0?90:-90)-f;p=0}else{d=Math.asin(u/h)*s-f;p=Math.sqrt(h*h-u*u)}var v=180-d-2*f;var m=(Math.atan2(c,l)-Math.atan2(o,p))*s;var g=(Math.atan2(c,l)-Math.atan2(o,-p))*s;var y=b(r[0],r[1],d,m);var x=b(r[0],r[1],v,g);if(y<=x)return[d,m,r[2]];else return[v,g,r[2]]}function b(e,t,r,n){var a=w(r-e);var i=w(n-t);return Math.sqrt(a*a+i*i)}function w(e){return(e%360+540)%360-180}function T(e,t,r){var n=r*o;var a=e.slice();var i=t===0?1:0;var s=t===2?1:2;var l=Math.cos(n);var u=Math.sin(n);a[i]=e[i]*l-e[s]*u;a[s]=e[s]*l+e[i]*u;return a}function k(e){return[Math.atan2(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2]))*s,Math.asin(Math.max(-1,Math.min(1,2*(e[0]*e[2]-e[3]*e[1]))))*s,Math.atan2(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]))*s]}function A(e){var t=e[0]*o;var r=e[1]*o;var n=Math.cos(r);return[n*Math.cos(t),n*Math.sin(t),Math.sin(r)]}function M(e,t){var r=0;for(var n=0,a=e.length;n<a;++n)r+=e[n]*t[n];return r}function E(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function S(e){var t=0;var r=arguments.length;var a=[];while(++t<r)a.push(arguments[t]);var i=n.dispatch.apply(null,a);i.of=function(t,r){return function(a){var o;try{o=a.sourceEvent=n.event;a.target=e;n.event=a;i[a.type].apply(t,r)}finally{n.event=o}}};return i}},{"../../lib":778,"../../registry":911,d3:169}],865:[function(e,t,r){"use strict";var n=e("../registry");var a=e("./cartesian/constants").SUBPLOT_PATTERN;r.getSubplotCalcData=function(e,t,r){var a=n.subplotsRegistry[t];if(!a)return[];var i=a.attr;var o=[];for(var s=0;s<e.length;s++){var l=e[s];var u=l[0].trace;if(u[i]===r)o.push(l)}return o};r.getModuleCalcData=function(e,t){var r=[];var a=[];var i;if(typeof t==="string"){i=n.getModule(t).plot}else if(typeof t==="function"){i=t}else{i=t.plot}if(!i){return[r,e]}for(var o=0;o<e.length;o++){var s=e[o];var l=s[0].trace;if(l.visible!==true||l._length===0)continue;if(l._module.plot===i){r.push(s)}else{a.push(s)}}return[r,a]};r.getSubplotData=function e(t,r,i){if(!n.subplotsRegistry[r])return[];var o=n.subplotsRegistry[r].attr;var s=[];var l,u,c;if(r==="gl2d"){var f=i.match(a);u="x"+f[1];c="y"+f[2]}for(var h=0;h<t.length;h++){l=t[h];if(r==="gl2d"&&n.traceIs(l,"gl2d")){if(l[o[0]]===u&&l[o[1]]===c){s.push(l)}}else{if(l[o]===i)s.push(l)}}return s}},{"../registry":911,"./cartesian/constants":834}],866:[function(e,t,r){"use strict";var n=e("mouse-change");var a=e("mouse-wheel");var i=e("mouse-event-offset");var o=e("../cartesian/constants");var s=e("has-passive-events");t.exports=u;function l(e,t){this.element=e;this.plot=t;this.mouseListener=null;this.wheelListener=null;this.lastInputTime=Date.now();this.lastPos=[0,0];this.boxEnabled=false;this.boxInited=false;this.boxStart=[0,0];this.boxEnd=[0,0];this.dragStart=[0,0]}function u(e){var t=e.mouseContainer;var r=e.glplot;var u=new l(t,r);function c(){e.xaxis.autorange=false;e.yaxis.autorange=false}function f(){var t=e.graphDiv._fullLayout._axisConstraintGroups;var r=e.xaxis._id;var n=e.yaxis._id;for(var a=0;a<t.length;a++){if(t[a][r]!==-1){if(t[a][n]!==-1)return true;break}}return false}u.mouseListener=n(t,h);t.addEventListener("touchstart",function(e){var r=i(e.changedTouches[0],t);h(0,r[0],r[1]);h(1,r[0],r[1]);e.preventDefault()},s?{passive:false}:false);t.addEventListener("touchmove",function(e){e.preventDefault();var r=i(e.changedTouches[0],t);h(1,r[0],r[1]);e.preventDefault()},s?{passive:false}:false);t.addEventListener("touchend",function(e){h(0,u.lastPos[0],u.lastPos[1]);e.preventDefault()},s?{passive:false}:false);function h(t,n,a){var i=e.calcDataBox();var s=r.viewBox;var l=u.lastPos[0];var h=u.lastPos[1];var p=o.MINDRAG*r.pixelRatio;var d=o.MINZOOM*r.pixelRatio;var v,m;n*=r.pixelRatio;a*=r.pixelRatio;a=s[3]-s[1]-a;function g(t,r,n){var a=Math.min(r,n);var o=Math.max(r,n);if(a!==o){i[t]=a;i[t+2]=o;u.dataBox=i;e.setRanges(i)}else{e.selectBox.selectBox=[0,0,1,1];e.glplot.setDirty()}}switch(e.fullLayout.dragmode){case"zoom":if(t){var y=n/(s[2]-s[0])*(i[2]-i[0])+i[0];var x=a/(s[3]-s[1])*(i[3]-i[1])+i[1];if(!u.boxInited){u.boxStart[0]=y;u.boxStart[1]=x;u.dragStart[0]=n;u.dragStart[1]=a}u.boxEnd[0]=y;u.boxEnd[1]=x;u.boxInited=true;if(!u.boxEnabled&&(u.boxStart[0]!==u.boxEnd[0]||u.boxStart[1]!==u.boxEnd[1])){u.boxEnabled=true}var _=Math.abs(u.dragStart[0]-n)<d;var b=Math.abs(u.dragStart[1]-a)<d;if(f()&&!(_&&b)){v=u.boxEnd[0]-u.boxStart[0];m=u.boxEnd[1]-u.boxStart[1];var w=(i[3]-i[1])/(i[2]-i[0]);if(Math.abs(v*w)>Math.abs(m)){u.boxEnd[1]=u.boxStart[1]+Math.abs(v)*w*(m>=0?1:-1);if(u.boxEnd[1]<i[1]){u.boxEnd[1]=i[1];u.boxEnd[0]=u.boxStart[0]+(i[1]-u.boxStart[1])/Math.abs(w)}else if(u.boxEnd[1]>i[3]){u.boxEnd[1]=i[3];u.boxEnd[0]=u.boxStart[0]+(i[3]-u.boxStart[1])/Math.abs(w)}}else{u.boxEnd[0]=u.boxStart[0]+Math.abs(m)/w*(v>=0?1:-1);if(u.boxEnd[0]<i[0]){u.boxEnd[0]=i[0];u.boxEnd[1]=u.boxStart[1]+(i[0]-u.boxStart[0])*Math.abs(w)}else if(u.boxEnd[0]>i[2]){u.boxEnd[0]=i[2];u.boxEnd[1]=u.boxStart[1]+(i[2]-u.boxStart[0])*Math.abs(w)}}}else{if(_)u.boxEnd[0]=u.boxStart[0];if(b)u.boxEnd[1]=u.boxStart[1]}}else if(u.boxEnabled){v=u.boxStart[0]!==u.boxEnd[0];m=u.boxStart[1]!==u.boxEnd[1];if(v||m){if(v){g(0,u.boxStart[0],u.boxEnd[0]);e.xaxis.autorange=false}if(m){g(1,u.boxStart[1],u.boxEnd[1]);e.yaxis.autorange=false}e.relayoutCallback()}else{e.glplot.setDirty()}u.boxEnabled=false;u.boxInited=false}else if(u.boxInited){u.boxInited=false}break;case"pan":u.boxEnabled=false;u.boxInited=false;if(t){if(!u.panning){u.dragStart[0]=n;u.dragStart[1]=a}if(Math.abs(u.dragStart[0]-n)<p)n=u.dragStart[0];if(Math.abs(u.dragStart[1]-a)<p)a=u.dragStart[1];v=(l-n)*(i[2]-i[0])/(r.viewBox[2]-r.viewBox[0]);m=(h-a)*(i[3]-i[1])/(r.viewBox[3]-r.viewBox[1]);i[0]+=v;i[2]+=v;i[1]+=m;i[3]+=m;e.setRanges(i);u.panning=true;u.lastInputTime=Date.now();c();e.cameraChanged();e.handleAnnotations()}else if(u.panning){u.panning=false;e.relayoutCallback()}break}u.lastPos[0]=n;u.lastPos[1]=a}u.wheelListener=a(t,function(t,n){if(!e.scrollZoom)return false;var a=e.calcDataBox();var i=r.viewBox;var o=u.lastPos[0];var s=u.lastPos[1];var l=Math.exp(5*n/(i[3]-i[1]));var f=o/(i[2]-i[0])*(a[2]-a[0])+a[0];var h=s/(i[3]-i[1])*(a[3]-a[1])+a[1];a[0]=(a[0]-f)*l+f;a[2]=(a[2]-f)*l+f;a[1]=(a[1]-h)*l+h;a[3]=(a[3]-h)*l+h;e.setRanges(a);u.lastInputTime=Date.now();c();e.cameraChanged();e.handleAnnotations();e.relayoutCallback();return true},true);return u}},{"../cartesian/constants":834,"has-passive-events":441,"mouse-change":483,"mouse-event-offset":484,"mouse-wheel":486}],867:[function(e,t,r){"use strict";var n=e("../cartesian/axes");var a=e("../../lib/str2rgbarray");function i(e){this.scene=e;this.gl=e.gl;this.pixelRatio=e.pixelRatio;this.screenBox=[0,0,1,1];this.viewBox=[0,0,1,1];this.dataBox=[-1,-1,1,1];this.borderLineEnable=[false,false,false,false];this.borderLineWidth=[1,1,1,1];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.ticks=[[],[]];this.tickEnable=[true,true,false,false];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labels=["x","y"];this.labelEnable=[true,true,false,false];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelPad=[15,15,15,15];this.labelSize=[12,12];this.labelFont=["sans-serif","sans-serif"];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.title="";this.titleEnable=true;this.titleCenter=[0,0,0,0];this.titleAngle=0;this.titleColor=[0,0,0,1];this.titleFont="sans-serif";this.titleSize=18;this.gridLineEnable=[true,true];this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]];this.gridLineWidth=[1,1];this.zeroLineEnable=[true,true];this.zeroLineWidth=[1,1];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.static=this.scene.staticPlot}var o=i.prototype;var s=["xaxis","yaxis"];o.merge=function(e){this.titleEnable=false;this.backgroundColor=a(e.plot_bgcolor);var t,r,n,i;var o,l,u,c,f;var h,p;for(h=0;h<2;++h){t=s[h];var d=t.charAt(0);r=e[this.scene[t]._name];n=r.title.text===this.scene.fullLayout._dfltTitle[d]?"":r.title.text;for(p=0;p<=2;p+=2){this.labelEnable[h+p]=false;this.labels[h+p]=n;this.labelColor[h+p]=a(r.title.font.color);this.labelFont[h+p]=r.title.font.family;this.labelSize[h+p]=r.title.font.size;this.labelPad[h+p]=this.getLabelPad(t,r);this.tickEnable[h+p]=false;this.tickColor[h+p]=a((r.tickfont||{}).color);this.tickAngle[h+p]=r.tickangle==="auto"?0:Math.PI*-r.tickangle/180;this.tickPad[h+p]=this.getTickPad(r);this.tickMarkLength[h+p]=0;this.tickMarkWidth[h+p]=r.tickwidth||0;this.tickMarkColor[h+p]=a(r.tickcolor);this.borderLineEnable[h+p]=false;this.borderLineColor[h+p]=a(r.linecolor);this.borderLineWidth[h+p]=r.linewidth||0}u=this.hasSharedAxis(r);o=this.hasAxisInDfltPos(t,r)&&!u;l=this.hasAxisInAltrPos(t,r)&&!u;i=r.mirror||false;c=u?String(i).indexOf("all")!==-1:!!i;f=u?i==="allticks":String(i).indexOf("ticks")!==-1;if(o)this.labelEnable[h]=true;else if(l)this.labelEnable[h+2]=true;if(o)this.tickEnable[h]=r.showticklabels;else if(l)this.tickEnable[h+2]=r.showticklabels;if(o||c)this.borderLineEnable[h]=r.showline;if(l||c)this.borderLineEnable[h+2]=r.showline;if(o||f)this.tickMarkLength[h]=this.getTickMarkLength(r);if(l||f)this.tickMarkLength[h+2]=this.getTickMarkLength(r);this.gridLineEnable[h]=r.showgrid;this.gridLineColor[h]=a(r.gridcolor);this.gridLineWidth[h]=r.gridwidth;this.zeroLineEnable[h]=r.zeroline;this.zeroLineColor[h]=a(r.zerolinecolor);this.zeroLineWidth[h]=r.zerolinewidth}};o.hasSharedAxis=function(e){var t=this.scene;var r=t.fullLayout._subplots.gl2d;var a=n.findSubplotsWithAxis(r,e);return a.indexOf(t.id)!==0};o.hasAxisInDfltPos=function(e,t){var r=t.side;if(e==="xaxis")return r==="bottom";else if(e==="yaxis")return r==="left"};o.hasAxisInAltrPos=function(e,t){var r=t.side;if(e==="xaxis")return r==="top";else if(e==="yaxis")return r==="right"};o.getLabelPad=function(e,t){var r=1.5;var n=t.title.font.size;var a=t.showticklabels;if(e==="xaxis"){return t.side==="top"?-10+n*(r+(a?1:0)):-10+n*(r+(a?.5:0))}else if(e==="yaxis"){return t.side==="right"?10+n*(r+(a?1:.5)):10+n*(r+(a?.5:0))}};o.getTickPad=function(e){return e.ticks==="outside"?10+e.ticklen:15};o.getTickMarkLength=function(e){if(!e.ticks)return 0;var t=e.ticklen;return e.ticks==="inside"?-t:t};function l(e){return new i(e)}t.exports=l},{"../../lib/str2rgbarray":802,"../cartesian/axes":828}],868:[function(e,t,r){"use strict";var n=e("../../plot_api/edit_types").overrideAll;var a=e("./scene2d");var i=e("../layout_attributes");var o=e("../../constants/xmlns_namespaces");var s=e("../cartesian/constants");var l=e("../cartesian");var u=e("../../components/fx/layout_attributes");var c=e("../get_data").getSubplotData;r.name="gl2d";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=s.idRegex;r.attrRegex=s.attrRegex;r.attributes=e("../cartesian/attributes");r.supplyLayoutDefaults=function(e,t,r){if(!t._has("cartesian")){l.supplyLayoutDefaults(e,t,r)}};r.layoutAttrOverrides=n(l.layoutAttributes,"plot","from-root");r.baseLayoutAttrOverrides=n({plot_bgcolor:i.plot_bgcolor,hoverlabel:u.hoverlabel},"plot","nested");r.plot=function e(t){var r=t._fullLayout;var n=t._fullData;var i=r._subplots.gl2d;for(var o=0;o<i.length;o++){var s=i[o];var l=r._plots[s];var u=c(n,"gl2d",s);var f=l._scene2d;if(f===undefined){f=new a({id:s,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio},r);l._scene2d=f}f.plot(u,t.calcdata,r,t.layout)}};r.clean=function(e,t,r,n){var a=n._subplots.gl2d||[];for(var i=0;i<a.length;i++){var o=a[i];var s=n._plots[o];if(!s._scene2d)continue;var u=c(e,"gl2d",o);if(u.length===0){s._scene2d.destroy();delete n._plots[o]}}l.clean.apply(this,arguments)};r.drawFramework=function(e){if(!e._context.staticPlot){l.drawFramework(e)}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots.gl2d;for(var n=0;n<r.length;n++){var a=t._plots[r[n]];var i=a._scene2d;var s=i.toImage("png");var l=t._glimages.append("svg:image");l.attr({xmlns:o.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"});i.destroy()}};r.updateFx=function(e){var t=e._fullLayout;var r=t._subplots.gl2d;for(var n=0;n<r.length;n++){var a=t._plots[r[n]]._scene2d;a.updateFx(t.dragmode)}}},{"../../components/fx/layout_attributes":684,"../../constants/xmlns_namespaces":754,"../../plot_api/edit_types":810,"../cartesian":841,"../cartesian/attributes":826,"../cartesian/constants":834,"../get_data":865,"../layout_attributes":882,"./scene2d":869}],869:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../plots/cartesian/axes");var i=e("../../components/fx");var o=e("gl-plot2d");var s=e("gl-spikes2d");var l=e("gl-select-box");var u=e("webgl-context");var c=e("./convert");var f=e("./camera");var h=e("../../lib/show_no_webgl_msg");var p=e("../cartesian/constraints");var d=p.enforce;var v=p.clean;var m=e("../cartesian/autorange").doAutoRange;var g=e("../../components/dragelement/helpers");var y=g.drawMode;var x=g.selectMode;var _=["xaxis","yaxis"];var b,w;var T=e("../cartesian/constants").SUBPLOT_PATTERN;function k(e,t){this.container=e.container;this.graphDiv=e.graphDiv;this.pixelRatio=e.plotGlPixelRatio||window.devicePixelRatio;this.id=e.id;this.staticPlot=!!e.staticPlot;this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian;this.fullData=null;this.updateRefs(t);this.makeFramework();if(this.stopped)return;this.glplotOptions=c(this);this.glplotOptions.merge(t);this.glplot=o(this.glplotOptions);this.camera=f(this);this.traces={};this.spikes=s(this.glplot);this.selectBox=l(this.glplot,{innerFill:false,outerFill:true});this.lastButtonState=0;this.pickResult=null;this.isMouseOver=true;this.stopped=false;this.redraw=this.draw.bind(this);this.redraw()}t.exports=k;var A=k.prototype;A.makeFramework=function(){if(this.staticPlot){if(!w){b=document.createElement("canvas");w=u({canvas:b,preserveDrawingBuffer:false,premultipliedAlpha:true,antialias:true});if(!w){throw new Error("Error creating static canvas/context for image server")}}this.canvas=b;this.gl=w}else{var e=this.container.querySelector(".gl-canvas-focus");var t=u({canvas:e,preserveDrawingBuffer:true,premultipliedAlpha:true});if(!t){h(this);this.stopped=true;return}this.canvas=e;this.gl=t}var r=this.canvas;r.style.width="100%";r.style.height="100%";r.style.position="absolute";r.style.top="0px";r.style.left="0px";r.style["pointer-events"]="none";this.updateSize(r);var n=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.position="absolute";n.style.top=n.style.left="0px";n.style.width=n.style.height="100%";n.style["z-index"]=20;n.style["pointer-events"]="none";var a=this.mouseContainer=document.createElement("div");a.style.position="absolute";a.style["pointer-events"]="auto";this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var i=this.container;i.appendChild(n);i.appendChild(a);var o=this;a.addEventListener("mouseout",function(){o.isMouseOver=false;o.unhover()});a.addEventListener("mouseover",function(){o.isMouseOver=true})};A.toImage=function(e){if(!e)e="png";this.stopped=true;if(this.staticPlot)this.container.appendChild(b);this.updateSize(this.canvas);var t=this.glplot.gl;var r=t.drawingBufferWidth;var n=t.drawingBufferHeight;t.clearColor(1,1,1,0);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);this.glplot.setDirty();this.glplot.draw();t.bindFramebuffer(t.FRAMEBUFFER,null);var a=new Uint8Array(r*n*4);t.readPixels(0,0,r,n,t.RGBA,t.UNSIGNED_BYTE,a);for(var i=0,o=n-1;i<o;++i,--o){for(var s=0;s<r;++s){for(var l=0;l<4;++l){var u=a[4*(r*i+s)+l];a[4*(r*i+s)+l]=a[4*(r*o+s)+l];a[4*(r*o+s)+l]=u}}}var c=document.createElement("canvas");c.width=r;c.height=n;var f=c.getContext("2d");var h=f.createImageData(r,n);h.data.set(a);f.putImageData(h,0,0);var p;switch(e){case"jpeg":p=c.toDataURL("image/jpeg");break;case"webp":p=c.toDataURL("image/webp");break;default:p=c.toDataURL("image/png")}if(this.staticPlot)this.container.removeChild(b);return p};A.updateSize=function(e){if(!e)e=this.canvas;var t=this.pixelRatio;var r=this.fullLayout;var n=r.width;var a=r.height;var i=Math.ceil(t*n)|0;var o=Math.ceil(t*a)|0;if(e.width!==i||e.height!==o){e.width=i;e.height=o}return e};A.computeTickMarks=function(){this.xaxis.setScale();this.yaxis.setScale();var e=[a.calcTicks(this.xaxis),a.calcTicks(this.yaxis)];for(var t=0;t<2;++t){for(var r=0;r<e[t].length;++r){e[t][r].text=e[t][r].text+""}}return e};function M(e,t){for(var r=0;r<2;++r){var n=e[r];var a=t[r];if(n.length!==a.length)return true;for(var i=0;i<n.length;++i){if(n[i].x!==a[i].x)return true}}return false}A.updateRefs=function(e){this.fullLayout=e;var t=this.id.match(T);var r="xaxis"+t[1];var n="yaxis"+t[2];this.xaxis=this.fullLayout[r];this.yaxis=this.fullLayout[n]};A.relayoutCallback=function(){var e=this.graphDiv;var t=this.xaxis;var r=this.yaxis;var a=e.layout;var i={};var o=i[t._name+".range"]=t.range.slice();var s=i[r._name+".range"]=r.range.slice();i[t._name+".autorange"]=t.autorange;i[r._name+".autorange"]=r.autorange;n.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,i);var l=a[t._name];l.range=o;l.autorange=t.autorange;var u=a[r._name];u.range=s;u.autorange=r.autorange;i.lastInputTime=this.camera.lastInputTime;e.emit("plotly_relayout",i)};A.cameraChanged=function(){var e=this.camera;this.glplot.setDataBox(this.calcDataBox());var t=this.computeTickMarks();var r=this.glplotOptions.ticks;if(M(t,r)){this.glplotOptions.ticks=t;this.glplotOptions.dataBox=e.dataBox;this.glplot.update(this.glplotOptions);this.handleAnnotations()}};A.handleAnnotations=function(){var e=this.graphDiv;var t=this.fullLayout.annotations;for(var r=0;r<t.length;r++){var a=t[r];if(a.xref===this.xaxis._id&&a.yref===this.yaxis._id){n.getComponentMethod("annotations","drawOne")(e,r)}}};A.destroy=function(){if(!this.glplot)return;var e=this.traces;if(e){Object.keys(e).map(function(t){e[t].dispose();delete e[t]})}this.glplot.dispose();this.container.removeChild(this.svgContainer);this.container.removeChild(this.mouseContainer);this.fullData=null;this.glplot=null;this.stopped=true;this.camera.mouseListener.enabled=false;this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener);this.camera=null};A.plot=function(e,t,r){var n=this.glplot;this.updateRefs(r);this.xaxis.clearCalc();this.yaxis.clearCalc();this.updateTraces(e,t);this.updateFx(r.dragmode);var a=r.width;var i=r.height;this.updateSize(this.canvas);var o=this.glplotOptions;o.merge(r);o.screenBox=[0,0,a,i];var s={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};v(s,this.xaxis);v(s,this.yaxis);var l=r._size;var u=this.xaxis.domain;var c=this.yaxis.domain;o.viewBox=[l.l+u[0]*l.w,l.b+c[0]*l.h,a-l.r-(1-u[1])*l.w,i-l.t-(1-c[1])*l.h];this.mouseContainer.style.width=l.w*(u[1]-u[0])+"px";this.mouseContainer.style.height=l.h*(c[1]-c[0])+"px";this.mouseContainer.height=l.h*(c[1]-c[0]);this.mouseContainer.style.left=l.l+u[0]*l.w+"px";this.mouseContainer.style.top=l.t+(1-c[1])*l.h+"px";var f,h;for(h=0;h<2;++h){f=this[_[h]];f._length=o.viewBox[h+2]-o.viewBox[h];m(this.graphDiv,f);f.setScale()}d(s);o.ticks=this.computeTickMarks();o.dataBox=this.calcDataBox();o.merge(r);n.update(o);this.glplot.draw()};A.calcDataBox=function(){var e=this.xaxis;var t=this.yaxis;var r=e.range;var n=t.range;var a=e.r2l;var i=t.r2l;return[a(r[0]),i(n[0]),a(r[1]),i(n[1])]};A.setRanges=function(e){var t=this.xaxis;var r=this.yaxis;var n=t.l2r;var a=r.l2r;t.range=[n(e[0]),n(e[2])];r.range=[a(e[1]),a(e[3])]};A.updateTraces=function(e,t){var r=Object.keys(this.traces);var n,a,i;this.fullData=e;e:for(n=0;n<r.length;n++){var o=r[n];var s=this.traces[o];for(a=0;a<e.length;a++){i=e[a];if(i.uid===o&&i.type===s.type){continue e}}s.dispose();delete this.traces[o]}for(n=0;n<e.length;n++){i=e[n];var l=t[n];var u=this.traces[i.uid];if(u)u.update(i,l);else{u=i._module.plot(this,i,l);this.traces[i.uid]=u}}this.glplot.objects.sort(function(e,t){return e._trace.index-t._trace.index})};A.updateFx=function(e){if(x(e)||y(e)){this.pickCanvas.style["pointer-events"]="none";this.mouseContainer.style["pointer-events"]="none"}else{this.pickCanvas.style["pointer-events"]="auto";this.mouseContainer.style["pointer-events"]="auto"}if(e==="pan"){this.mouseContainer.style.cursor="move"}else if(e==="zoom"){this.mouseContainer.style.cursor="crosshair"}else{this.mouseContainer.style.cursor=null}};A.emitPointAction=function(e,t){var r=e.trace.uid;var n=e.pointIndex;var a;for(var o=0;o<this.fullData.length;o++){if(this.fullData[o].uid===r){a=this.fullData[o]}}var s={x:e.traceCoord[0],y:e.traceCoord[1],curveNumber:a.index,pointNumber:n,data:a._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};i.appendArrayPointValue(s,a,n);this.graphDiv.emit(t,{points:[s]})};A.draw=function(){if(this.stopped)return;requestAnimationFrame(this.redraw);var e=this.glplot;var t=this.camera;var r=t.mouseListener;var n=this.lastButtonState===1&&r.buttons===0;var a=this.fullLayout;this.lastButtonState=r.buttons;this.cameraChanged();var o=r.x*e.pixelRatio;var s=this.canvas.height-e.pixelRatio*r.y;var l;if(t.boxEnabled&&a.dragmode==="zoom"){this.selectBox.enabled=true;var u=this.selectBox.selectBox=[Math.min(t.boxStart[0],t.boxEnd[0]),Math.min(t.boxStart[1],t.boxEnd[1]),Math.max(t.boxStart[0],t.boxEnd[0]),Math.max(t.boxStart[1],t.boxEnd[1])];for(var c=0;c<2;c++){if(t.boxStart[c]===t.boxEnd[c]){u[c]=e.dataBox[c];u[c+2]=e.dataBox[c+2]}}e.setDirty()}else if(!t.panning&&this.isMouseOver){this.selectBox.enabled=false;var f=a._size;var h=this.xaxis.domain;var p=this.yaxis.domain;l=e.pick(o/e.pixelRatio+f.l+h[0]*f.w,s/e.pixelRatio-(f.t+(1-p[1])*f.h));var d=l&&l.object._trace.handlePick(l);if(d&&n){this.emitPointAction(d,"plotly_click")}if(l&&l.object._trace.hoverinfo!=="skip"&&a.hovermode){if(d&&(!this.lastPickResult||this.lastPickResult.traceUid!==d.trace.uid||this.lastPickResult.dataCoord[0]!==d.dataCoord[0]||this.lastPickResult.dataCoord[1]!==d.dataCoord[1])){var v=d;this.lastPickResult={traceUid:d.trace?d.trace.uid:null,dataCoord:d.dataCoord.slice()};this.spikes.update({center:l.dataCoord});v.screenCoord=[((e.viewBox[2]-e.viewBox[0])*(l.dataCoord[0]-e.dataBox[0])/(e.dataBox[2]-e.dataBox[0])+e.viewBox[0])/e.pixelRatio,(this.canvas.height-(e.viewBox[3]-e.viewBox[1])*(l.dataCoord[1]-e.dataBox[1])/(e.dataBox[3]-e.dataBox[1])-e.viewBox[1])/e.pixelRatio];this.emitPointAction(d,"plotly_hover");var m=this.fullData[v.trace.index]||{};var g=v.pointIndex;var y=i.castHoverinfo(m,a,g);if(y&&y!=="all"){var x=y.split("+");if(x.indexOf("x")===-1)v.traceCoord[0]=undefined;if(x.indexOf("y")===-1)v.traceCoord[1]=undefined;if(x.indexOf("z")===-1)v.traceCoord[2]=undefined;if(x.indexOf("text")===-1)v.textLabel=undefined;if(x.indexOf("name")===-1)v.name=undefined}i.loneHover({x:v.screenCoord[0],y:v.screenCoord[1],xLabel:this.hoverFormatter("xaxis",v.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",v.traceCoord[1]),zLabel:v.traceCoord[2],text:v.textLabel,name:v.name,color:i.castHoverOption(m,g,"bgcolor")||v.color,borderColor:i.castHoverOption(m,g,"bordercolor"),fontFamily:i.castHoverOption(m,g,"font.family"),fontSize:i.castHoverOption(m,g,"font.size"),fontColor:i.castHoverOption(m,g,"font.color"),nameLength:i.castHoverOption(m,g,"namelength"),textAlign:i.castHoverOption(m,g,"align")},{container:this.svgContainer,gd:this.graphDiv})}}}if(!l){this.unhover()}e.draw()};A.unhover=function(){if(this.lastPickResult){this.spikes.update({});this.lastPickResult=null;this.graphDiv.emit("plotly_unhover");i.loneUnhover(this.svgContainer)}};A.hoverFormatter=function(e,t){if(t===undefined)return undefined;var r=this[e];return a.tickText(r,r.c2l(t),"hover").text}},{"../../components/dragelement/helpers":661,"../../components/fx":683,"../../lib/show_no_webgl_msg":800,"../../plots/cartesian/axes":828,"../../registry":911,"../cartesian/autorange":827,"../cartesian/constants":834,"../cartesian/constraints":835,"./camera":866,"./convert":867,"gl-plot2d":317,"gl-select-box":333,"gl-spikes2d":342,"webgl-context":606}],870:[function(e,t,r){"use strict";var n=e("../../plot_api/edit_types").overrideAll;var a=e("../../components/fx/layout_attributes");var i=e("./scene");var o=e("../get_data").getSubplotData;var s=e("../../lib");var l=e("../../constants/xmlns_namespaces");var u="gl3d";var c="scene";r.name=u;r.attr=c;r.idRoot=c;r.idRegex=r.attrRegex=s.counterRegex("scene");r.attributes=e("./layout/attributes");r.layoutAttributes=e("./layout/layout_attributes");r.baseLayoutAttrOverrides=n({hoverlabel:a.hoverlabel},"plot","nested");r.supplyLayoutDefaults=e("./layout/defaults");r.plot=function e(t){var r=t._fullLayout;var n=t._fullData;var a=r._subplots[u];for(var s=0;s<a.length;s++){var l=a[s];var c=o(n,u,l);var f=r[l];var h=f.camera;var p=f._scene;if(!p){p=new i({id:l,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio,camera:h},r);f._scene=p}if(!p.viewInitial){p.viewInitial={up:{x:h.up.x,y:h.up.y,z:h.up.z},eye:{x:h.eye.x,y:h.eye.y,z:h.eye.z},center:{x:h.center.x,y:h.center.y,z:h.center.z}}}p.plot(c,r,t.layout)}};r.clean=function(e,t,r,n){var a=n._subplots[u]||[];for(var i=0;i<a.length;i++){var o=a[i];if(!t[o]&&!!n[o]._scene){n[o]._scene.destroy();if(n._infolayer){n._infolayer.selectAll(".annotation-"+o).remove()}}}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots[u];var n=t._size;for(var a=0;a<r.length;a++){var i=t[r[a]];var o=i.domain;var s=i._scene;var c=s.toImage("png");var f=t._glimages.append("svg:image");f.attr({xmlns:l.svg,"xlink:href":c,x:n.l+n.w*o.x[0],y:n.t+n.h*(1-o.y[1]),width:n.w*(o.x[1]-o.x[0]),height:n.h*(o.y[1]-o.y[0]),preserveAspectRatio:"none"});s.destroy()}};r.cleanId=function e(t){if(!t.match(/^scene[0-9]*$/))return;var r=t.substr(5);if(r==="1")r="";return c+r};r.updateFx=function(e){var t=e._fullLayout;var r=t._subplots[u];for(var n=0;n<r.length;n++){var a=t[r[n]]._scene;a.updateFx(t.dragmode,t.hovermode)}}},{"../../components/fx/layout_attributes":684,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../plot_api/edit_types":810,"../get_data":865,"./layout/attributes":871,"./layout/defaults":875,"./layout/layout_attributes":876,"./scene":880}],871:[function(e,t,r){"use strict";t.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],872:[function(e,t,r){"use strict";var n=e("../../../components/color");var a=e("../../cartesian/layout_attributes");var i=e("../../../lib/extend").extendFlat;var o=e("../../../plot_api/edit_types").overrideAll;t.exports=o({visible:a.visible,showspikes:{valType:"boolean",dflt:true},spikesides:{valType:"boolean",dflt:true},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:n.defaultLine},showbackground:{valType:"boolean",dflt:false},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:true},color:a.color,categoryorder:a.categoryorder,categoryarray:a.categoryarray,title:{text:a.title.text,font:a.title.font},type:i({},a.type,{values:["-","linear","log","date","category"]}),autotypenumbers:a.autotypenumbers,autorange:a.autorange,rangemode:a.rangemode,range:i({},a.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}}],anim:false}),tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,mirror:a.mirror,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:a.tickfont,tickangle:a.tickangle,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,minexponent:a.minexponent,separatethousands:a.separatethousands,tickformat:a.tickformat,tickformatstops:a.tickformatstops,hoverformat:a.hoverformat,showline:a.showline,linecolor:a.linecolor,linewidth:a.linewidth,showgrid:a.showgrid,gridcolor:i({},a.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:a.gridwidth,zeroline:a.zeroline,zerolinecolor:a.zerolinecolor,zerolinewidth:a.zerolinewidth,_deprecated:{title:a._deprecated.title,titlefont:a._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":643,"../../../lib/extend":768,"../../../plot_api/edit_types":810,"../../cartesian/layout_attributes":842}],873:[function(e,t,r){"use strict";var n=e("tinycolor2").mix;var a=e("../../../lib");var i=e("../../../plot_api/plot_template");var o=e("./axis_attributes");var s=e("../../cartesian/type_defaults");var l=e("../../cartesian/axis_defaults");var u=["xaxis","yaxis","zaxis"];var c=100*(204-68)/(255-68);t.exports=function e(t,r,f){var h,p;function d(e,t){return a.coerce(h,p,o,e,t)}for(var v=0;v<u.length;v++){var m=u[v];h=t[m]||{};p=i.newContainer(r,m);p._id=m[0]+f.scene;p._name=m;s(h,p,d,f);l(h,p,d,{font:f.font,letter:m[0],data:f.data,showGrid:true,noTickson:true,noTicklabelmode:true,noTicklabelposition:true,bgColor:f.bgColor,calendar:f.calendar},f.fullLayout);d("gridcolor",n(p.color,f.bgColor,c).toRgbString());d("title.text",m[0]);p.setScale=a.noop;if(d("showspikes")){d("spikesides");d("spikethickness");d("spikecolor",p.color)}d("showaxeslabels");if(d("showbackground"))d("backgroundcolor")}}},{"../../../lib":778,"../../../plot_api/plot_template":817,"../../cartesian/axis_defaults":830,"../../cartesian/type_defaults":853,"./axis_attributes":872,tinycolor2:576}],874:[function(e,t,r){"use strict";var n=e("../../../lib/str2rgbarray");var a=e("../../../lib");var i=["xaxis","yaxis","zaxis"];function o(){this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[18,18,18];this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont=["Open Sans","Open Sans","Open Sans"];this.labelSize=[20,20,20];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[30,30,30];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[10,10,10];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[true,true,true];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._defaultTickPad=this.tickPad.slice();this._defaultLabelPad=this.labelPad.slice();this._defaultLineTickLength=this.lineTickLength.slice()}var s=o.prototype;s.merge=function(e,t){var r=this;for(var o=0;o<3;++o){var s=t[i[o]];if(!s.visible){r.tickEnable[o]=false;r.labelEnable[o]=false;r.lineEnable[o]=false;r.lineTickEnable[o]=false;r.gridEnable[o]=false;r.zeroEnable[o]=false;r.backgroundEnable[o]=false;continue}r.labels[o]=e._meta?a.templateString(s.title.text,e._meta):s.title.text;if("font"in s.title){if(s.title.font.color)r.labelColor[o]=n(s.title.font.color);if(s.title.font.family)r.labelFont[o]=s.title.font.family;if(s.title.font.size)r.labelSize[o]=s.title.font.size}if("showline"in s)r.lineEnable[o]=s.showline;if("linecolor"in s)r.lineColor[o]=n(s.linecolor);if("linewidth"in s)r.lineWidth[o]=s.linewidth;if("showgrid"in s)r.gridEnable[o]=s.showgrid;if("gridcolor"in s)r.gridColor[o]=n(s.gridcolor);if("gridwidth"in s)r.gridWidth[o]=s.gridwidth;if(s.type==="log")r.zeroEnable[o]=false;else if("zeroline"in s)r.zeroEnable[o]=s.zeroline;if("zerolinecolor"in s)r.zeroLineColor[o]=n(s.zerolinecolor);if("zerolinewidth"in s)r.zeroLineWidth[o]=s.zerolinewidth;if("ticks"in s&&!!s.ticks)r.lineTickEnable[o]=true;else r.lineTickEnable[o]=false;if("ticklen"in s){r.lineTickLength[o]=r._defaultLineTickLength[o]=s.ticklen}if("tickcolor"in s)r.lineTickColor[o]=n(s.tickcolor);if("tickwidth"in s)r.lineTickWidth[o]=s.tickwidth;if("tickangle"in s){r.tickAngle[o]=s.tickangle==="auto"?-3600:Math.PI*-s.tickangle/180}if("showticklabels"in s)r.tickEnable[o]=s.showticklabels;if("tickfont"in s){if(s.tickfont.color)r.tickColor[o]=n(s.tickfont.color);if(s.tickfont.family)r.tickFont[o]=s.tickfont.family;if(s.tickfont.size)r.tickSize[o]=s.tickfont.size}if("mirror"in s){if(["ticks","all","allticks"].indexOf(s.mirror)!==-1){r.lineTickMirror[o]=true;r.lineMirror[o]=true}else if(s.mirror===true){r.lineTickMirror[o]=false;r.lineMirror[o]=true}else{r.lineTickMirror[o]=false;r.lineMirror[o]=false}}else r.lineMirror[o]=false;if("showbackground"in s&&s.showbackground!==false){r.backgroundEnable[o]=true;r.backgroundColor[o]=n(s.backgroundcolor)}else r.backgroundEnable[o]=false}};function l(e,t){var r=new o;r.merge(e,t);return r}t.exports=l},{"../../../lib":778,"../../../lib/str2rgbarray":802}],875:[function(e,t,r){"use strict";var n=e("../../../lib");var a=e("../../../components/color");var i=e("../../../registry");var o=e("../../subplot_defaults");var s=e("./axis_defaults");var l=e("./layout_attributes");var u=e("../../get_data").getSubplotData;var c="gl3d";t.exports=function e(t,r,a){var i=r._basePlotModules.length>1;function s(e){if(i)return;var r=n.validate(t[e],l[e]);if(r)return t[e]}o(t,r,a,{type:c,attributes:l,handleDefaults:f,fullLayout:r,font:r.font,fullData:a,getDfltFromLayout:s,autotypenumbersDflt:r.autotypenumbers,paper_bgcolor:r.paper_bgcolor,calendar:r.calendar})};function f(e,t,r,n){var o=r("bgcolor");var l=a.combine(o,n.paper_bgcolor);var f=["up","center","eye"];for(var h=0;h<f.length;h++){r("camera."+f[h]+".x");r("camera."+f[h]+".y");r("camera."+f[h]+".z")}r("camera.projection.type");var p=!!r("aspectratio.x")&&!!r("aspectratio.y")&&!!r("aspectratio.z");var d=p?"manual":"auto";var v=r("aspectmode",d);if(!p){e.aspectratio=t.aspectratio={x:1,y:1,z:1};if(v==="manual")t.aspectmode="auto";e.aspectmode=t.aspectmode}var m=u(n.fullData,c,n.id);s(e,t,{font:n.font,scene:n.id,data:m,bgColor:l,calendar:n.calendar,autotypenumbersDflt:n.autotypenumbersDflt,fullLayout:n.fullLayout});i.getComponentMethod("annotations3d","handleDefaults")(e,t,n);var g=n.getDfltFromLayout("dragmode");if(g!==false){if(!g){g="orbit";if(e.camera&&e.camera.up){var y=e.camera.up.x;var x=e.camera.up.y;var _=e.camera.up.z;if(_!==0){if(!y||!x||!_){g="turntable"}else if(_/Math.sqrt(y*y+x*x+_*_)>.999){g="turntable"}}}else{g="turntable"}}}r("dragmode",g);r("hovermode",n.getDfltFromLayout("hovermode"))}},{"../../../components/color":643,"../../../lib":778,"../../../registry":911,"../../get_data":865,"../../subplot_defaults":905,"./axis_defaults":873,"./layout_attributes":876}],876:[function(e,t,r){"use strict";var n=e("./axis_attributes");var a=e("../../domain").attributes;var i=e("../../../lib/extend").extendFlat;var o=e("../../../lib").counterRegex;function s(e,t,r){return{x:{valType:"number",dflt:e,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}t.exports={_arrayAttrRegexps:[o("scene",".annotations",true)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:i(s(0,0,1),{}),center:i(s(0,0,0),{}),eye:i(s(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:a({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":undefined,"aspectratio.y":undefined,"aspectratio.z":undefined}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:n,yaxis:n,zaxis:n,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",false],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",false],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":778,"../../../lib/extend":768,"../../domain":855,"./axis_attributes":872}],877:[function(e,t,r){"use strict";var n=e("../../../lib/str2rgbarray");var a=["xaxis","yaxis","zaxis"];function i(){this.enabled=[true,true,true];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.drawSides=[true,true,true];this.lineWidth=[1,1,1]}var o=i.prototype;o.merge=function(e){for(var t=0;t<3;++t){var r=e[a[t]];if(!r.visible){this.enabled[t]=false;this.drawSides[t]=false;continue}this.enabled[t]=r.showspikes;this.colors[t]=n(r.spikecolor);this.drawSides[t]=r.spikesides;this.lineWidth[t]=r.spikethickness}};function s(e){var t=new i;t.merge(e);return t}t.exports=s},{"../../../lib/str2rgbarray":802}],878:[function(e,t,r){"use strict";t.exports=l;var n=e("../../cartesian/axes");var a=e("../../../lib");var i=["xaxis","yaxis","zaxis"];var o=[0,0,0];function s(e){var t=new Array(3);for(var r=0;r<3;++r){var n=e[r];var a=new Array(n.length);for(var i=0;i<n.length;++i){a[i]=n[i].x}t[r]=a}return t}function l(e){var t=e.axesOptions;var r=e.glplot.axesPixels;var l=e.fullSceneLayout;var u=[[],[],[]];for(var c=0;c<3;++c){var f=l[i[c]];f._length=(r[c].hi-r[c].lo)*r[c].pixelsPerDataUnit/e.dataScale[c];if(Math.abs(f._length)===Infinity||isNaN(f._length)){u[c]=[]}else{f._input_range=f.range.slice();f.range[0]=r[c].lo/e.dataScale[c];f.range[1]=r[c].hi/e.dataScale[c];f._m=1/(e.dataScale[c]*r[c].pixelsPerDataUnit);if(f.range[0]===f.range[1]){f.range[0]-=1;f.range[1]+=1}var h=f.tickmode;if(f.tickmode==="auto"){f.tickmode="linear";var p=f.nticks||a.constrain(f._length/40,4,9);n.autoTicks(f,Math.abs(f.range[1]-f.range[0])/p)}var d=n.calcTicks(f,{msUTC:true});for(var v=0;v<d.length;++v){d[v].x=d[v].x*e.dataScale[c];if(f.type==="date"){d[v].text=d[v].text.replace(/\<br\>/g," ")}}u[c]=d;f.tickmode=h}}t.ticks=u;for(var c=0;c<3;++c){o[c]=.5*(e.glplot.bounds[0][c]+e.glplot.bounds[1][c]);for(var v=0;v<2;++v){t.bounds[v][c]=e.glplot.bounds[v][c]}}e.contourLevels=s(u)}},{"../../../lib":778,"../../cartesian/axes":828}],879:[function(e,t,r){"use strict";function n(e,t){var r=[0,0,0,0];var n,a;for(n=0;n<4;++n){for(a=0;a<4;++a){r[a]+=e[4*n+a]*t[n]}}return r}function a(e,t){var r=n(e.projection,n(e.view,n(e.model,[t[0],t[1],t[2],1])));return r}t.exports=a},{}],880:[function(e,t,r){"use strict";var n=e("gl-plot3d");var a=n.createCamera;var i=n.createScene;var o=e("webgl-context");var s=e("has-passive-events");var l=e("../../registry");var u=e("../../lib");var c=u.preserveDrawingBuffer();var f=e("../../plots/cartesian/axes");var h=e("../../components/fx");var p=e("../../lib/str2rgbarray");var d=e("../../lib/show_no_webgl_msg");var v=e("./project");var m=e("./layout/convert");var g=e("./layout/spikes");var y=e("./layout/tick_marks");var x,_;function b(e,t){var r=document.createElement("div");var n=e.container;this.graphDiv=e.graphDiv;var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.position="absolute";a.style.top=a.style.left="0px";a.style.width=a.style.height="100%";a.style["z-index"]=20;a.style["pointer-events"]="none";r.appendChild(a);this.svgContainer=a;r.id=e.id;r.style.position="absolute";r.style.top=r.style.left="0px";r.style.width=r.style.height="100%";n.appendChild(r);this.fullLayout=t;this.id=e.id||"scene";this.fullSceneLayout=t[this.id];this.plotArgs=[[],{},{}];this.axesOptions=m(t,t[this.id]);this.spikeOptions=g(t[this.id]);this.container=r;this.staticMode=!!e.staticPlot;this.pixelRatio=this.pixelRatio||e.plotGlPixelRatio||2;this.dataScale=[1,1,1];this.contourLevels=[[],[],[]];this.convertAnnotations=l.getComponentMethod("annotations3d","convert");this.drawAnnotations=l.getComponentMethod("annotations3d","draw");this.initializeGLPlot()}var w=b.prototype;w.prepareOptions=function(){var e=this;var t={canvas:e.canvas,gl:e.gl,glOptions:{preserveDrawingBuffer:c,premultipliedAlpha:true,antialias:true},container:e.container,axes:e.axesOptions,spikes:e.spikeOptions,pickRadius:10,snapToData:true,autoScale:true,autoBounds:false,cameraObject:e.camera,pixelRatio:e.pixelRatio};if(e.staticMode){if(!_){x=document.createElement("canvas");_=o({canvas:x,preserveDrawingBuffer:true,premultipliedAlpha:true,antialias:true});if(!_){throw new Error("error creating static canvas/context for image server")}}t.gl=_;t.canvas=x}return t};var T=true;w.tryCreatePlot=function(){var e=this;var t=e.prepareOptions();var r=true;try{e.glplot=i(t)}catch(n){if(e.staticMode||!T||c){r=false}else{u.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{c=t.glOptions.preserveDrawingBuffer=true;e.glplot=i(t)}catch(e){c=t.glOptions.preserveDrawingBuffer=false;r=false}}}T=false;return r};w.initializeGLCamera=function(){var e=this;var t=e.fullSceneLayout.camera;var r=t.projection.type==="orthographic";e.camera=a(e.container,{center:[t.center.x,t.center.y,t.center.z],eye:[t.eye.x,t.eye.y,t.eye.z],up:[t.up.x,t.up.y,t.up.z],_ortho:r,zoomMin:.01,zoomMax:100,mode:"orbit"})};w.initializeGLPlot=function(){var e=this;e.initializeGLCamera();var t=e.tryCreatePlot();if(!t)return d(e);e.traces={};e.make4thDimension();var r=e.graphDiv;var n=r.layout;var a=function(){var t={};if(e.isCameraChanged(n)){t[e.id+".camera"]=e.getCamera()}if(e.isAspectChanged(n)){t[e.id+".aspectratio"]=e.glplot.getAspectratio();if(n[e.id].aspectmode!=="manual"){e.fullSceneLayout.aspectmode=n[e.id].aspectmode=t[e.id+".aspectmode"]="manual"}}return t};var i=function(e){if(e.fullSceneLayout.dragmode===false)return;var t=a();e.saveLayout(n);e.graphDiv.emit("plotly_relayout",t)};if(e.glplot.canvas){e.glplot.canvas.addEventListener("mouseup",function(){i(e)});e.glplot.canvas.addEventListener("wheel",function(t){if(r._context._scrollZoom.gl3d){if(e.camera._ortho){var n=t.deltaX>t.deltaY?1.1:1/1.1;var a=e.glplot.getAspectratio();e.glplot.setAspectratio({x:n*a.x,y:n*a.y,z:n*a.z})}i(e)}},s?{passive:false}:false);e.glplot.canvas.addEventListener("mousemove",function(){if(e.fullSceneLayout.dragmode===false)return;if(e.camera.mouseListener.buttons===0)return;var t=a();e.graphDiv.emit("plotly_relayouting",t)});if(!e.staticMode){e.glplot.canvas.addEventListener("webglcontextlost",function(t){if(r&&r.emit){r.emit("plotly_webglcontextlost",{event:t,layer:e.id})}},false)}}e.glplot.oncontextloss=function(){e.recoverContext()};e.glplot.onrender=function(){e.render()};return true};w.render=function(){var e=this;var t=e.graphDiv;var r;var n=e.svgContainer;var a=e.container.getBoundingClientRect();t._fullLayout._calcInverseTransform(t);var i=t._fullLayout._invScaleX;var o=t._fullLayout._invScaleY;var s=a.width*i;var l=a.height*o;n.setAttributeNS(null,"viewBox","0 0 "+s+" "+l);n.setAttributeNS(null,"width",s);n.setAttributeNS(null,"height",l);y(e);e.glplot.axes.update(e.axesOptions);var c=Object.keys(e.traces);var p=null;var d=e.glplot.selection;for(var m=0;m<c.length;++m){r=e.traces[c[m]];if(r.data.hoverinfo!=="skip"&&r.handlePick(d)){p=r}if(r.setContourLevels)r.setContourLevels()}function g(t,r){var n=e.fullSceneLayout[t];return f.tickText(n,n.d2l(r),"hover").text}var x;if(p!==null){var _=v(e.glplot.cameraParams,d.dataCoordinate);r=p.data;var b=t._fullData[r.index];var w=d.index;var T={xLabel:g("xaxis",d.traceCoordinate[0]),yLabel:g("yaxis",d.traceCoordinate[1]),zLabel:g("zaxis",d.traceCoordinate[2])};var k=h.castHoverinfo(b,e.fullLayout,w);var A=(k||"").split("+");var M=k&&k==="all";if(!b.hovertemplate&&!M){if(A.indexOf("x")===-1)T.xLabel=undefined;if(A.indexOf("y")===-1)T.yLabel=undefined;if(A.indexOf("z")===-1)T.zLabel=undefined;if(A.indexOf("text")===-1)d.textLabel=undefined;if(A.indexOf("name")===-1)p.name=undefined}var E;var S=[];if(r.type==="cone"||r.type==="streamtube"){T.uLabel=g("xaxis",d.traceCoordinate[3]);if(M||A.indexOf("u")!==-1){S.push("u: "+T.uLabel)}T.vLabel=g("yaxis",d.traceCoordinate[4]);if(M||A.indexOf("v")!==-1){S.push("v: "+T.vLabel)}T.wLabel=g("zaxis",d.traceCoordinate[5]);if(M||A.indexOf("w")!==-1){S.push("w: "+T.wLabel)}T.normLabel=d.traceCoordinate[6].toPrecision(3);if(M||A.indexOf("norm")!==-1){S.push("norm: "+T.normLabel)}if(r.type==="streamtube"){T.divergenceLabel=d.traceCoordinate[7].toPrecision(3);if(M||A.indexOf("divergence")!==-1){S.push("divergence: "+T.divergenceLabel)}}if(d.textLabel){S.push(d.textLabel)}E=S.join("<br>")}else if(r.type==="isosurface"||r.type==="volume"){T.valueLabel=f.tickText(e._mockAxis,e._mockAxis.d2l(d.traceCoordinate[3]),"hover").text;S.push("value: "+T.valueLabel);if(d.textLabel){S.push(d.textLabel)}E=S.join("<br>")}else{E=d.textLabel}var C={x:d.traceCoordinate[0],y:d.traceCoordinate[1],z:d.traceCoordinate[2],data:b._input,fullData:b,curveNumber:b.index,pointNumber:w};h.appendArrayPointValue(C,b,w);if(r._module.eventData){C=b._module.eventData(C,d,b,{},w)}var L={points:[C]};if(e.fullSceneLayout.hovermode){h.loneHover({trace:b,x:(.5+.5*_[0]/_[3])*s,y:(.5-.5*_[1]/_[3])*l,xLabel:T.xLabel,yLabel:T.yLabel,zLabel:T.zLabel,text:E,name:p.name,color:h.castHoverOption(b,w,"bgcolor")||p.color,borderColor:h.castHoverOption(b,w,"bordercolor"),fontFamily:h.castHoverOption(b,w,"font.family"),fontSize:h.castHoverOption(b,w,"font.size"),fontColor:h.castHoverOption(b,w,"font.color"),nameLength:h.castHoverOption(b,w,"namelength"),textAlign:h.castHoverOption(b,w,"align"),hovertemplate:u.castOption(b,w,"hovertemplate"),hovertemplateLabels:u.extendFlat({},C,T),eventData:[C]},{container:n,gd:t})}if(d.buttons&&d.distance<5){t.emit("plotly_click",L)}else{t.emit("plotly_hover",L)}x=L}else{h.loneUnhover(n);t.emit("plotly_unhover",x)}e.drawAnnotations(e)};w.recoverContext=function(){var e=this;e.glplot.dispose();var t=function(){if(e.glplot.gl.isContextLost()){requestAnimationFrame(t);return}if(!e.initializeGLPlot()){u.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}e.plot.apply(e,e.plotArgs)};requestAnimationFrame(t)};var k=["xaxis","yaxis","zaxis"];function A(e,t,r){var n=e.fullSceneLayout;for(var a=0;a<3;a++){var i=k[a];var o=i.charAt(0);var s=n[i];var l=t[o];var c=t[o+"calendar"];var f=t["_"+o+"length"];if(!u.isArrayOrTypedArray(l)){r[0][a]=Math.min(r[0][a],0);r[1][a]=Math.max(r[1][a],f-1)}else{var h;for(var p=0;p<(f||l.length);p++){if(u.isArrayOrTypedArray(l[p])){for(var d=0;d<l[p].length;++d){h=s.d2l(l[p][d],0,c);if(!isNaN(h)&&isFinite(h)){r[0][a]=Math.min(r[0][a],h);r[1][a]=Math.max(r[1][a],h)}}}else{h=s.d2l(l[p],0,c);if(!isNaN(h)&&isFinite(h)){r[0][a]=Math.min(r[0][a],h);r[1][a]=Math.max(r[1][a],h)}}}}}}function M(e,t){var r=e.fullSceneLayout;var n=r.annotations||[];for(var a=0;a<3;a++){var i=k[a];var o=i.charAt(0);var s=r[i];for(var l=0;l<n.length;l++){var u=n[l];if(u.visible){var c=s.r2l(u[o]);if(!isNaN(c)&&isFinite(c)){t[0][a]=Math.min(t[0][a],c);t[1][a]=Math.max(t[1][a],c)}}}}}w.plot=function(e,t,r){var n=this;n.plotArgs=[e,t,r];if(n.glplot.contextLost)return;var a,i;var o,s,l,u;var c=t[n.id];var f=r[n.id];n.fullLayout=t;n.fullSceneLayout=c;n.axesOptions.merge(t,c);n.spikeOptions.merge(c);n.setViewport(c);n.updateFx(c.dragmode,c.hovermode);n.camera.enableWheel=n.graphDiv._context._scrollZoom.gl3d;n.glplot.setClearColor(p(c.bgcolor));n.setConvert(l);if(!e)e=[];else if(!Array.isArray(e))e=[e];var h=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(o=0;o<e.length;++o){a=e[o];if(a.visible!==true||a._length===0)continue;A(this,a,h)}M(this,h);var d=[1,1,1];for(s=0;s<3;++s){if(h[1][s]===h[0][s]){d[s]=1}else{d[s]=1/(h[1][s]-h[0][s])}}n.dataScale=d;n.convertAnnotations(this);for(o=0;o<e.length;++o){a=e[o];if(a.visible!==true||a._length===0){continue}i=n.traces[a.uid];if(i){if(i.data.type===a.type){i.update(a)}else{i.dispose();i=a._module.plot(this,a);n.traces[a.uid]=i}}else{i=a._module.plot(this,a);n.traces[a.uid]=i}i.name=a.name}var v=Object.keys(n.traces);e:for(o=0;o<v.length;++o){for(s=0;s<e.length;++s){if(e[s].uid===v[o]&&(e[s].visible===true&&e[s]._length!==0)){continue e}}i=n.traces[v[o]];i.dispose();delete n.traces[v[o]]}n.glplot.objects.sort(function(e,t){return e._trace.data.index-t._trace.data.index});var m=[[0,0,0],[0,0,0]];var g=[];var y={};for(o=0;o<3;++o){l=c[k[o]];u=l.type;if(u in y){y[u].acc*=d[o];y[u].count+=1}else{y[u]={acc:d[o],count:1}}if(l.autorange){m[0][o]=Infinity;m[1][o]=-Infinity;var x=n.glplot.objects;var _=n.fullSceneLayout.annotations||[];var b=l._name.charAt(0);for(s=0;s<x.length;s++){var w=x[s];var T=w.bounds;var E=w._trace.data._pad||0;if(w.constructor.name==="ErrorBars"&&l._lowerLogErrorBound){m[0][o]=Math.min(m[0][o],l._lowerLogErrorBound)}else{m[0][o]=Math.min(m[0][o],T[0][o]/d[o]-E)}m[1][o]=Math.max(m[1][o],T[1][o]/d[o]+E)}for(s=0;s<_.length;s++){var S=_[s];if(S.visible){var C=l.r2l(S[b]);m[0][o]=Math.min(m[0][o],C);m[1][o]=Math.max(m[1][o],C)}}if("rangemode"in l&&l.rangemode==="tozero"){m[0][o]=Math.min(m[0][o],0);m[1][o]=Math.max(m[1][o],0)}if(m[0][o]>m[1][o]){m[0][o]=-1;m[1][o]=1}else{var L=m[1][o]-m[0][o];m[0][o]-=L/32;m[1][o]+=L/32}if(l.autorange==="reversed"){var I=m[0][o];m[0][o]=m[1][o];m[1][o]=I}}else{var O=l.range;m[0][o]=l.r2l(O[0]);m[1][o]=l.r2l(O[1])}if(m[0][o]===m[1][o]){m[0][o]-=1;m[1][o]+=1}g[o]=m[1][o]-m[0][o];n.glplot.setBounds(o,{min:m[0][o]*d[o],max:m[1][o]*d[o]})}var P;var D=c.aspectmode;if(D==="cube"){P=[1,1,1]}else if(D==="manual"){var R=c.aspectratio;P=[R.x,R.y,R.z]}else if(D==="auto"||D==="data"){var z=[1,1,1];for(o=0;o<3;++o){l=c[k[o]];u=l.type;var N=y[u];z[o]=Math.pow(N.acc,1/N.count)/d[o]}if(D==="data"){P=z}else{if(Math.max.apply(null,z)/Math.min.apply(null,z)<=4){P=z}else{P=[1,1,1]}}}else{throw new Error("scene.js aspectRatio was not one of the enumerated types")}c.aspectratio.x=f.aspectratio.x=P[0];c.aspectratio.y=f.aspectratio.y=P[1];c.aspectratio.z=f.aspectratio.z=P[2];n.glplot.setAspectratio(c.aspectratio);if(!n.viewInitial.aspectratio){n.viewInitial.aspectratio={x:c.aspectratio.x,y:c.aspectratio.y,z:c.aspectratio.z}}if(!n.viewInitial.aspectmode){n.viewInitial.aspectmode=c.aspectmode}var F=c.domain||null;var B=t._size||null;if(F&&B){var j=n.container.style;j.position="absolute";j.left=B.l+F.x[0]*B.w+"px";j.top=B.t+(1-F.y[1])*B.h+"px";j.width=B.w*(F.x[1]-F.x[0])+"px";j.height=B.h*(F.y[1]-F.y[0])+"px"}n.glplot.redraw()};w.destroy=function(){var e=this;if(!e.glplot)return;e.camera.mouseListener.enabled=false;e.container.removeEventListener("wheel",e.camera.wheelListener);e.camera=null;e.glplot.dispose();e.container.parentNode.removeChild(e.container);e.glplot=null};function E(e){return[[e.eye.x,e.eye.y,e.eye.z],[e.center.x,e.center.y,e.center.z],[e.up.x,e.up.y,e.up.z]]}function S(e){return{up:{x:e.up[0],y:e.up[1],z:e.up[2]},center:{x:e.center[0],y:e.center[1],z:e.center[2]},eye:{x:e.eye[0],y:e.eye[1],z:e.eye[2]},projection:{type:e._ortho===true?"orthographic":"perspective"}}}w.getCamera=function(){var e=this;e.camera.view.recalcMatrix(e.camera.view.lastT());return S(e.camera)};w.setViewport=function(e){var t=this;var r=e.camera;t.camera.lookAt.apply(this,E(r));t.glplot.setAspectratio(e.aspectratio);var n=r.projection.type==="orthographic";var a=t.camera._ortho;if(n!==a){t.glplot.redraw();t.glplot.clearRGBA();t.glplot.dispose();t.initializeGLPlot()}};w.isCameraChanged=function(e){var t=this;var r=t.getCamera();var n=u.nestedProperty(e,t.id+".camera");var a=n.get();function i(e,t,r,n){var a=["up","center","eye"];var i=["x","y","z"];return t[a[r]]&&e[a[r]][i[n]]===t[a[r]][i[n]]}var o=false;if(a===undefined){o=true}else{for(var s=0;s<3;s++){for(var l=0;l<3;l++){if(!i(r,a,s,l)){o=true;break}}}if(!a.projection||r.projection&&r.projection.type!==a.projection.type){o=true}}return o};w.isAspectChanged=function(e){var t=this;var r=t.glplot.getAspectratio();var n=u.nestedProperty(e,t.id+".aspectratio");var a=n.get();return a===undefined||(a.x!==r.x||a.y!==r.y||a.z!==r.z)};w.saveLayout=function(e){var t=this;var r=t.fullLayout;var n;var a;var i;var o;var s;var c;var f=t.isCameraChanged(e);var h=t.isAspectChanged(e);var p=f||h;if(p){var d={};if(f){n=t.getCamera();a=u.nestedProperty(e,t.id+".camera");i=a.get();d[t.id+".camera"]=i}if(h){o=t.glplot.getAspectratio();s=u.nestedProperty(e,t.id+".aspectratio");c=s.get();d[t.id+".aspectratio"]=c}l.call("_storeDirectGUIEdit",e,r._preGUI,d);if(f){a.set(n);var v=u.nestedProperty(r,t.id+".camera");v.set(n)}if(h){s.set(o);var m=u.nestedProperty(r,t.id+".aspectratio");m.set(o);t.glplot.redraw()}}return p};w.updateFx=function(e,t){var r=this;var n=r.camera;if(n){if(e==="orbit"){n.mode="orbit";n.keyBindingMode="rotate"}else if(e==="turntable"){n.up=[0,0,1];n.mode="turntable";n.keyBindingMode="rotate";var a=r.graphDiv;var i=a._fullLayout;var o=r.fullSceneLayout.camera;var s=o.up.x;var c=o.up.y;var f=o.up.z;if(f/Math.sqrt(s*s+c*c+f*f)<.999){var h=r.id+".camera.up";var p={x:0,y:0,z:1};var d={};d[h]=p;var v=a.layout;l.call("_storeDirectGUIEdit",v,i._preGUI,d);o.up=p;u.nestedProperty(v,h).set(p)}}else{n.keyBindingMode=e}}r.fullSceneLayout.hovermode=t};function C(e,t,r){for(var n=0,a=r-1;n<a;++n,--a){for(var i=0;i<t;++i){for(var o=0;o<4;++o){var s=4*(t*n+i)+o;var l=4*(t*a+i)+o;var u=e[s];e[s]=e[l];e[l]=u}}}}function L(e,t,r){for(var n=0;n<r;++n){for(var a=0;a<t;++a){var i=4*(t*n+a);var o=e[i+3];if(o>0){var s=255/o;for(var l=0;l<3;++l){e[i+l]=Math.min(s*e[i+l],255)}}}}}w.toImage=function(e){var t=this;if(!e)e="png";if(t.staticMode)t.container.appendChild(x);t.glplot.redraw();var r=t.glplot.gl;var n=r.drawingBufferWidth;var a=r.drawingBufferHeight;r.bindFramebuffer(r.FRAMEBUFFER,null);var i=new Uint8Array(n*a*4);r.readPixels(0,0,n,a,r.RGBA,r.UNSIGNED_BYTE,i);C(i,n,a);L(i,n,a);var o=document.createElement("canvas");o.width=n;o.height=a;var s=o.getContext("2d");var l=s.createImageData(n,a);l.data.set(i);s.putImageData(l,0,0);var u;switch(e){case"jpeg":u=o.toDataURL("image/jpeg");break;case"webp":u=o.toDataURL("image/webp");break;default:u=o.toDataURL("image/png")}if(t.staticMode)t.container.removeChild(x);return u};w.setConvert=function(){var e=this;for(var t=0;t<3;t++){var r=e.fullSceneLayout[k[t]];f.setConvert(r,e.fullLayout);r.setScale=u.noop}};w.make4thDimension=function(){var e=this;var t=e.graphDiv;var r=t._fullLayout;e._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};f.setConvert(e._mockAxis,r)};t.exports=b},{"../../components/fx":683,"../../lib":778,"../../lib/show_no_webgl_msg":800,"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"../../registry":911,"./layout/convert":874,"./layout/spikes":877,"./layout/tick_marks":878,"./project":879,"gl-plot3d":321,"has-passive-events":441,"webgl-context":606}],881:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a){a=a||t.length;var i=new Array(a);for(var o=0;o<a;o++){i[o]=[t[o],r[o],n[o]]}return i}},{}],882:[function(e,t,r){"use strict";var n=e("./font_attributes");var a=e("./animation_attributes");var i=e("../components/color/attributes");var o=e("../components/shapes/draw_newshape/attributes");var s=e("./pad_attributes");var l=e("../lib/extend").extendFlat;var u=n({editType:"calc"});u.family.dflt='"Open Sans", verdana, arial, sans-serif';u.size.dflt=12;u.color.dflt=i.defaultLine;t.exports={font:u,title:{text:{valType:"string",editType:"layoutstyle"},font:n({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:l(s({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[false,"hide","show"],dflt:false,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:false,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:i.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:i.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:false,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:i.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},newshape:o.newshape,activeshape:o.activeshape,meta:{valType:"any",arrayOk:true,editType:"plot"},transition:l({},a.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:n({editType:"layoutstyle"})}}},{"../components/color/attributes":642,"../components/shapes/draw_newshape/attributes":725,"../lib/extend":768,"./animation_attributes":822,"./font_attributes":856,"./pad_attributes":890}],883:[function(e,t,r){"use strict";var n="1.10.1";var a={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:'<a href="http://www.openstreetmap.org/about/" target="_blank">© OpenStreetMap</a>',tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank">© CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank">© CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}};var i=Object.keys(a);t.exports={requiredVersion:n,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:a,styleValuesNonMapbox:i,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+n+"."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",i.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multiple"+"access tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{}],884:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){var a=t.split(" ");var i=a[0];var o=a[1];var s=n.isArrayOrTypedArray(r)?n.mean(r):r;var l=.5+s/100;var u=1.5+s/100;var c=["",""];var f=[0,0];switch(i){case"top":c[0]="top";f[1]=-u;break;case"bottom":c[0]="bottom";f[1]=u;break}switch(o){case"left":c[1]="right";f[0]=-l;break;case"right":c[1]="left";f[0]=l;break}var h;if(c[0]&&c[1])h=c.join("-");else if(c[0])h=c[0];else if(c[1])h=c[1];else h="center";return{anchor:h,offset:f}}},{"../../lib":778}],885:[function(e,t,r){"use strict";var n=e("mapbox-gl");var a=e("../../lib");var i=a.strTranslate;var o=a.strScale;var s=e("../../plots/get_data").getSubplotCalcData;var l=e("../../constants/xmlns_namespaces");var u=e("d3");var c=e("../../components/drawing");var f=e("../../lib/svg_text_utils");var h=e("./mapbox");var p="mapbox";var d=r.constants=e("./constants");r.name=p;r.attr="subplot";r.idRoot=p;r.idRegex=r.attrRegex=a.counterRegex(p);r.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}};r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.plot=function e(t){var r=t._fullLayout;var i=t.calcdata;var o=r._subplots[p];if(n.version!==d.requiredVersion){throw new Error(d.wrongVersionErrorMsg)}var l=v(t,o);n.accessToken=l;for(var u=0;u<o.length;u++){var c=o[u];var f=s(i,p,c);var m=r[c];var g=m._subplot;if(!g){g=new h(t,c);r[c]._subplot=g}if(!g.viewInitial){g.viewInitial={center:a.extendFlat({},m.center),zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}}g.plot(f,r,t._promises)}};r.clean=function(e,t,r,n){var a=n._subplots[p]||[];for(var i=0;i<a.length;i++){var o=a[i];if(!t[o]&&!!n[o]._subplot){n[o]._subplot.destroy()}}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots[p];var n=t._size;for(var a=0;a<r.length;a++){var s=t[r[a]];var h=s.domain;var v=s._subplot;var m=v.toImage("png");var g=t._glimages.append("svg:image");g.attr({xmlns:l.svg,"xlink:href":m,x:n.l+n.w*h.x[0],y:n.t+n.h*(1-h.y[1]),width:n.w*(h.x[1]-h.x[0]),height:n.h*(h.y[1]-h.y[0]),preserveAspectRatio:"none"});var y=u.select(s._subplot.div);var x=y.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!x){var _=t._glimages.append("g");_.attr("transform",i(n.l+n.w*h.x[0]+10,n.t+n.h*(1-h.y[0])-31));_.append("path").attr("d",d.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"});_.append("path").attr("d",d.mapboxLogo.path1).style("opacity",.35).style("enable-background","new");_.append("path").attr("d",d.mapboxLogo.path2).style("opacity",.35).style("enable-background","new");_.append("polygon").attr("points",d.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var b=y.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map","");var w=t._glimages.append("g");var T=w.append("text");T.text(b).classed("static-attribution",true).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":b});var k=c.bBox(T.node());var A=n.w*(h.x[1]-h.x[0]);if(k.width>A/2){var M=b.split("|").join("<br>");T.text(M).attr("data-unformatted",M).call(f.convertToTspans,e);k=c.bBox(T.node())}T.attr("transform",i(-3,-k.height+8));w.insert("rect",".static-attribution").attr({x:-k.width-6,y:-k.height-3,width:k.width+6,height:k.height+3,fill:"rgba(255, 255, 255, 0.75)"});var E=1;if(k.width+6>A)E=A/(k.width+6);var S=[n.l+n.w*h.x[1],n.t+n.h*(1-h.y[0])];w.attr("transform",i(S[0],S[1])+o(E))}};function v(e,t){var r=e._fullLayout;var n=e._context;if(n.mapboxAccessToken==="")return"";var i=[];var o=[];var s=false;var l=false;for(var u=0;u<t.length;u++){var c=r[t[u]];var f=c.accesstoken;if(m(c.style)){if(f){a.pushUnique(i,f)}else{if(m(c._input.style)){a.error("Uses Mapbox map style, but did not set an access token.");s=true}l=true}}if(f){a.pushUnique(o,f)}}if(l){var h=s?d.noAccessTokenErrorMsg:d.missingStyleErrorMsg;a.error(h);throw new Error(h)}if(i.length){if(i.length>1){a.warn(d.multipleTokensErrorMsg)}return i[0]}else{if(o.length){a.log(["Listed mapbox access token(s)",o.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" "))}return""}}function m(e){return typeof e==="string"&&(d.styleValuesMapbox.indexOf(e)!==-1||e.indexOf("mapbox://")===0)}r.updateFx=function(e){var t=e._fullLayout;var r=t._subplots[p];for(var n=0;n<r.length;n++){var a=t[r[n]]._subplot;a.updateFx(t)}}},{"../../components/drawing":665,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/get_data":865,"./constants":883,"./layout_attributes":887,"./layout_defaults":888,"./mapbox":889,d3:169,"mapbox-gl":473}],886:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../lib/svg_text_utils").sanitizeHTML;var i=e("./convert_text_opts");var o=e("./constants");function s(e,t){this.subplot=e;this.uid=e.uid+"-"+t;this.index=t;this.idSource="source-"+this.uid;this.idLayer=o.layoutLayerPrefix+this.uid;this.sourceType=null;this.source=null;this.layerType=null;this.below=null;this.visible=false}var l=s.prototype;l.update=function e(t){if(!this.visible){this.updateSource(t);this.updateLayer(t)}else if(this.needsNewImage(t)){this.updateImage(t)}else if(this.needsNewSource(t)){this.removeLayer();this.updateSource(t);this.updateLayer(t)}else if(this.needsNewLayer(t)){this.updateLayer(t)}else{this.updateStyle(t)}this.visible=u(t)};l.needsNewImage=function(e){var t=this.subplot.map;return t.getSource(this.idSource)&&this.sourceType==="image"&&e.sourcetype==="image"&&(this.source!==e.source||JSON.stringify(this.coordinates)!==JSON.stringify(e.coordinates))};l.needsNewSource=function(e){return this.sourceType!==e.sourcetype||JSON.stringify(this.source)!==JSON.stringify(e.source)||this.layerType!==e.type};l.needsNewLayer=function(e){return this.layerType!==e.type||this.below!==this.subplot.belowLookup["layout-"+this.index]};l.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]};l.updateImage=function(e){var t=this.subplot.map;t.getSource(this.idSource).updateImage({url:e.source,coordinates:e.coordinates});var r=this.findFollowingMapboxLayerId(this.lookupBelow());if(r!==null){this.subplot.map.moveLayer(this.idLayer,r)}};l.updateSource=function(e){var t=this.subplot.map;if(t.getSource(this.idSource))t.removeSource(this.idSource);this.sourceType=e.sourcetype;this.source=e.source;if(!u(e))return;var r=f(e);t.addSource(this.idSource,r)};l.findFollowingMapboxLayerId=function(e){if(e==="traces"){var t=this.subplot.getMapLayers();for(var r=0;r<t.length;r++){var n=t[r].id;if(typeof n==="string"&&n.indexOf(o.traceLayerPrefix)===0){e=n;break}}}return e};l.updateLayer=function(e){var t=this.subplot;var r=c(e);var n=this.lookupBelow();var a=this.findFollowingMapboxLayerId(n);this.removeLayer();if(u(e)){t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":e.sourcelayer||"",type:e.type,minzoom:e.minzoom,maxzoom:e.maxzoom,layout:r.layout,paint:r.paint},a)}this.layerType=e.type;this.below=n};l.updateStyle=function(e){if(u(e)){var t=c(e);this.subplot.setOptions(this.idLayer,"setLayoutProperty",t.layout);this.subplot.setOptions(this.idLayer,"setPaintProperty",t.paint)}};l.removeLayer=function(){var e=this.subplot.map;if(e.getLayer(this.idLayer)){e.removeLayer(this.idLayer)}};l.dispose=function(){var e=this.subplot.map;if(e.getLayer(this.idLayer))e.removeLayer(this.idLayer);if(e.getSource(this.idSource))e.removeSource(this.idSource)};function u(e){if(!e.visible)return false;var t=e.source;if(Array.isArray(t)&&t.length>0){for(var r=0;r<t.length;r++){if(typeof t[r]!=="string"||t[r].length===0){return false}}return true}return n.isPlainObject(t)||typeof t==="string"&&t.length>0}function c(e){var t={};var r={};switch(e.type){case"circle":n.extendFlat(r,{"circle-radius":e.circle.radius,"circle-color":e.color,"circle-opacity":e.opacity});break;case"line":n.extendFlat(r,{"line-width":e.line.width,"line-color":e.color,"line-opacity":e.opacity,"line-dasharray":e.line.dash});break;case"fill":n.extendFlat(r,{"fill-color":e.color,"fill-outline-color":e.fill.outlinecolor,"fill-opacity":e.opacity});break;case"symbol":var a=e.symbol;var o=i(a.textposition,a.iconsize);n.extendFlat(t,{"icon-image":a.icon+"-15","icon-size":a.iconsize/10,"text-field":a.text,"text-size":a.textfont.size,"text-anchor":o.anchor,"text-offset":o.offset,"symbol-placement":a.placement});n.extendFlat(r,{"icon-color":e.color,"text-color":a.textfont.color,"text-opacity":e.opacity});break;case"raster":n.extendFlat(r,{"raster-fade-duration":0,"raster-opacity":e.opacity});break}return{layout:t,paint:r}}function f(e){var t=e.sourcetype;var r=e.source;var n={type:t};var i;if(t==="geojson"){i="data"}else if(t==="vector"){i=typeof r==="string"?"url":"tiles"}else if(t==="raster"){i="tiles";n.tileSize=256}else if(t==="image"){i="url";n.coordinates=e.coordinates}n[i]=r;if(e.sourceattribution){n.attribution=a(e.sourceattribution)}return n}t.exports=function e(t,r,n){var a=new s(t,r);a.update(n);return a}},{"../../lib":778,"../../lib/svg_text_utils":803,"./constants":883,"./convert_text_opts":884}],887:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color").defaultLine;var i=e("../domain").attributes;var o=e("../font_attributes");var s=e("../../traces/scatter/attributes").textposition;var l=e("../../plot_api/edit_types").overrideAll;var u=e("../../plot_api/plot_template").templatedArray;var c=e("./constants");var f=o({});f.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var h=t.exports=l({_arrayAttrRegexps:[n.counterRegex("mapbox",".layers",true)],domain:i({name:"mapbox"}),accesstoken:{valType:"string",noBlank:true,strict:true},style:{valType:"any",values:c.styleValuesMapbox.concat(c.styleValuesNonMapbox),dflt:c.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:u("layer",{visible:{valType:"boolean",dflt:true},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:a},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:a}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:f,textposition:n.extendFlat({},s,{arrayOk:false})}})},"plot","from-root");h.uirevision={valType:"any",editType:"none"}},{"../../components/color":643,"../../lib":778,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../traces/scatter/attributes":1187,"../domain":855,"../font_attributes":856,"./constants":883}],888:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../subplot_defaults");var i=e("../array_container_defaults");var o=e("./layout_attributes");t.exports=function e(t,r,n){a(t,r,n,{type:"mapbox",attributes:o,handleDefaults:s,partition:"y",accessToken:r._mapboxAccessToken})};function s(e,t,r,n){r("accesstoken",n.accessToken);r("style");r("center.lon");r("center.lat");r("zoom");r("bearing");r("pitch");i(e,t,{name:"layers",handleItemDefaults:l});t._input=e}function l(e,t){function r(r,a){return n.coerce(e,t,o.layers,r,a)}var a=r("visible");if(a){var i=r("sourcetype");var s=i==="raster"||i==="image";r("source");r("sourceattribution");if(i==="vector"){r("sourcelayer")}if(i==="image"){r("coordinates")}var l;if(s)l="raster";var u=r("type",l);if(s&&u!=="raster"){u=t.type="raster";n.log("Source types *raster* and *image* must drawn *raster* layer type.")}r("below");r("color");r("opacity");r("minzoom");r("maxzoom");if(u==="circle"){r("circle.radius")}if(u==="line"){r("line.width");r("line.dash")}if(u==="fill"){r("fill.outlinecolor")}if(u==="symbol"){r("symbol.icon");r("symbol.iconsize");r("symbol.text");n.coerceFont(r,"symbol.textfont");r("symbol.textposition");r("symbol.placement")}}}},{"../../lib":778,"../array_container_defaults":823,"../subplot_defaults":905,"./layout_attributes":887}],889:[function(e,t,r){"use strict";var n=e("mapbox-gl");var a=e("../../lib");var i=e("../../lib/geo_location_utils");var o=e("../../registry");var s=e("../cartesian/axes");var l=e("../../components/dragelement");var u=e("../../components/fx");var c=e("../../components/dragelement/helpers");var f=c.rectMode;var h=c.drawMode;var p=c.selectMode;var d=e("../cartesian/select").prepSelect;var v=e("../cartesian/select").clearSelect;var m=e("../cartesian/select").clearSelectionsCache;var g=e("../cartesian/select").selectOnClick;var y=e("./constants");var x=e("./layers");function _(e,t){this.id=t;this.gd=e;var r=e._fullLayout;var n=e._context;this.container=r._glcontainer.node();this.isStatic=n.staticPlot;this.uid=r._uid+"-"+this.id;this.div=null;this.xaxis=null;this.yaxis=null;this.createFramework(r);this.map=null;this.accessToken=null;this.styleObj=null;this.traceHash={};this.layerList=[];this.belowLookup={};this.dragging=false;this.wheeling=false}var b=_.prototype;b.plot=function(e,t,r){var n=this;var a=t[n.id];if(n.map&&a.accesstoken!==n.accessToken){n.map.remove();n.map=null;n.styleObj=null;n.traceHash={};n.layerList=[]}var i;if(!n.map){i=new Promise(function(r,a){n.createMap(e,t,r,a)})}else{i=new Promise(function(r,a){n.updateMap(e,t,r,a)})}r.push(i)};b.createMap=function(e,t,r,a){var o=this;var s=t[o.id];var l=o.styleObj=T(s.style);o.accessToken=s.accesstoken;var u=o.map=new n.Map({container:o.div,style:l.style,center:A(s.center),zoom:s.zoom,bearing:s.bearing,pitch:s.pitch,interactive:!o.isStatic,preserveDrawingBuffer:o.isStatic,doubleClickZoom:false,boxZoom:false,attributionControl:false}).addControl(new n.AttributionControl({compact:true}));u._canvas.style.left="0px";u._canvas.style.top="0px";o.rejectOnError(a);if(!o.isStatic){o.initFx(e,t)}var c=[];c.push(new Promise(function(e){u.once("load",e)}));c=c.concat(i.fetchTraceGeoData(e));Promise.all(c).then(function(){o.fillBelowLookup(e,t);o.updateData(e);o.updateLayout(t);o.resolveOnRender(r)}).catch(a)};b.updateMap=function(e,t,r,n){var a=this;var o=a.map;var s=t[this.id];a.rejectOnError(n);var l=[];var u=T(s.style);if(JSON.stringify(a.styleObj)!==JSON.stringify(u)){a.styleObj=u;o.setStyle(u.style);a.traceHash={};l.push(new Promise(function(e){o.once("styledata",e)}))}l=l.concat(i.fetchTraceGeoData(e));Promise.all(l).then(function(){a.fillBelowLookup(e,t);a.updateData(e);a.updateLayout(t);a.resolveOnRender(r)}).catch(n)};b.fillBelowLookup=function(e,t){var r=t[this.id];var n=r.layers;var a,i;var o=this.belowLookup={};var s=false;for(a=0;a<e.length;a++){var l=e[a][0].trace;var u=l._module;if(typeof l.below==="string"){i=l.below}else if(u.getBelow){i=u.getBelow(l,this)}if(i===""){s=true}o["trace-"+l.uid]=i||""}for(a=0;a<n.length;a++){var c=n[a];if(typeof c.below==="string"){i=c.below}else if(s){i="traces"}else{i=""}o["layout-"+a]=i}var f={};var h,p;for(h in o){i=o[h];if(f[i]){f[i].push(h)}else{f[i]=[h]}}for(i in f){var d=f[i];if(d.length>1){for(a=0;a<d.length;a++){h=d[a];if(h.indexOf("trace-")===0){p=h.split("trace-")[1];if(this.traceHash[p]){this.traceHash[p].below=null}}else if(h.indexOf("layout-")===0){p=h.split("layout-")[1];if(this.layerList[p]){this.layerList[p].below=null}}}}}};var w={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};b.updateData=function(e){var t=this.traceHash;var r,n,a,i;var o=e.slice().sort(function(e,t){return w[e[0].trace.type]-w[t[0].trace.type]});for(a=0;a<o.length;a++){var s=o[a];n=s[0].trace;r=t[n.uid];var l=false;if(r){if(r.type===n.type){r.update(s);l=true}else{r.dispose()}}if(!l&&n._module){t[n.uid]=n._module.plot(this,s)}}var u=Object.keys(t);e:for(a=0;a<u.length;a++){var c=u[a];for(i=0;i<e.length;i++){n=e[i][0].trace;if(c===n.uid)continue e}r=t[c];r.dispose();delete t[c]}};b.updateLayout=function(e){var t=this.map;var r=e[this.id];if(!this.dragging&&!this.wheeling){t.setCenter(A(r.center));t.setZoom(r.zoom);t.setBearing(r.bearing);t.setPitch(r.pitch)}this.updateLayers(e);this.updateFramework(e);this.updateFx(e);this.map.resize();if(this.gd._context._scrollZoom.mapbox){t.scrollZoom.enable()}else{t.scrollZoom.disable()}};b.resolveOnRender=function(e){var t=this.map;t.on("render",function r(){if(t.loaded()){t.off("render",r);setTimeout(e,10)}})};b.rejectOnError=function(e){var t=this.map;function r(){e(new Error(y.mapOnErrorMsg))}t.once("error",r);t.once("style.error",r);t.once("source.error",r);t.once("tile.error",r);t.once("layer.error",r)};b.createFramework=function(e){var t=this;var r=t.div=document.createElement("div");r.id=t.uid;r.style.position="absolute";t.container.appendChild(r);t.xaxis={_id:"x",c2p:function(e){return t.project(e).x}};t.yaxis={_id:"y",c2p:function(e){return t.project(e).y}};t.updateFramework(e);t.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};s.setConvert(t.mockAxis,e)};b.initFx=function(e,t){var r=this;var n=r.gd;var a=r.map;a.on("moveend",function(e){if(!r.map)return;var t=n._fullLayout;if(e.originalEvent||r.wheeling){var a=t[r.id];o.call("_storeDirectGUIEdit",n.layout,t._preGUI,r.getViewEdits(a));var i=r.getView();a._input.center=a.center=i.center;a._input.zoom=a.zoom=i.zoom;a._input.bearing=a.bearing=i.bearing;a._input.pitch=a.pitch=i.pitch;n.emit("plotly_relayout",r.getViewEditsWithDerived(i))}if(e.originalEvent&&e.originalEvent.type==="mouseup"){r.dragging=false}else if(r.wheeling){r.wheeling=false}if(t._rehover){t._rehover()}});a.on("wheel",function(){r.wheeling=true});a.on("mousemove",function(e){var t=r.div.getBoundingClientRect();var i=[e.originalEvent.offsetX,e.originalEvent.offsetY];e.target.getBoundingClientRect=function(){return t};r.xaxis.p2c=function(){return a.unproject(i).lng};r.yaxis.p2c=function(){return a.unproject(i).lat};n._fullLayout._rehover=function(){if(n._fullLayout._hoversubplot===r.id&&n._fullLayout[r.id]){u.hover(n,e,r.id)}};u.hover(n,e,r.id);n._fullLayout._hoversubplot=r.id});function i(){u.loneUnhover(t._hoverlayer)}a.on("dragstart",function(){r.dragging=true;i()});a.on("zoomstart",i);a.on("mouseout",function(){n._fullLayout._hoversubplot=null});function s(){var e=r.getView();n.emit("plotly_relayouting",r.getViewEditsWithDerived(e))}a.on("drag",s);a.on("zoom",s);a.on("dblclick",function(){var e=n._fullLayout[r.id];o.call("_storeDirectGUIEdit",n.layout,n._fullLayout._preGUI,r.getViewEdits(e));var t=r.viewInitial;a.setCenter(A(t.center));a.setZoom(t.zoom);a.setBearing(t.bearing);a.setPitch(t.pitch);var i=r.getView();e._input.center=e.center=i.center;e._input.zoom=e.zoom=i.zoom;e._input.bearing=e.bearing=i.bearing;e._input.pitch=e.pitch=i.pitch;n.emit("plotly_doubleclick",null);n.emit("plotly_relayout",r.getViewEditsWithDerived(i))});r.clearSelect=function(){m(r.dragOptions);v(r.dragOptions.gd)};r.onClickInPanFn=function(e){return function(t){var a=n._fullLayout.clickmode;if(a.indexOf("select")>-1){g(t.originalEvent,n,[r.xaxis],[r.yaxis],r.id,e)}if(a.indexOf("event")>-1){u.click(n,t.originalEvent)}}}};b.updateFx=function(e){var t=this;var r=t.map;var n=t.gd;if(t.isStatic)return;function i(e){var r=t.map.unproject(e);return[r.lng,r.lat]}var o=e.dragmode;var s;if(f(o)){s=function(e,r){var n=e.range={};n[t.id]=[i([r.xmin,r.ymin]),i([r.xmax,r.ymax])]}}else{s=function(e,r,n){var a=e.lassoPoints={};a[t.id]=n.filtered.map(i)}}var u=t.dragOptions;t.dragOptions=a.extendDeep(u||{},{dragmode:e.dragmode,element:t.div,gd:n,plotinfo:{id:t.id,domain:e[t.id].domain,xaxis:t.xaxis,yaxis:t.yaxis,fillRangeItems:s},xaxes:[t.xaxis],yaxes:[t.yaxis],subplot:t.id});r.off("click",t.onClickInPanHandler);if(p(o)||h(o)){r.dragPan.disable();r.on("zoomstart",t.clearSelect);t.dragOptions.prepFn=function(e,r,n){d(e,r,n,t.dragOptions,o)};l.init(t.dragOptions)}else{r.dragPan.enable();r.off("zoomstart",t.clearSelect);t.div.onmousedown=null;t.onClickInPanHandler=t.onClickInPanFn(t.dragOptions);r.on("click",t.onClickInPanHandler)}};b.updateFramework=function(e){var t=e[this.id].domain;var r=e._size;var n=this.div.style;n.width=r.w*(t.x[1]-t.x[0])+"px";n.height=r.h*(t.y[1]-t.y[0])+"px";n.left=r.l+t.x[0]*r.w+"px";n.top=r.t+(1-t.y[1])*r.h+"px";this.xaxis._offset=r.l+t.x[0]*r.w;this.xaxis._length=r.w*(t.x[1]-t.x[0]);this.yaxis._offset=r.t+(1-t.y[1])*r.h;this.yaxis._length=r.h*(t.y[1]-t.y[0])};b.updateLayers=function(e){var t=e[this.id];var r=t.layers;var n=this.layerList;var a;if(r.length!==n.length){for(a=0;a<n.length;a++){n[a].dispose()}n=this.layerList=[];for(a=0;a<r.length;a++){n.push(x(this,a,r[a]))}}else{for(a=0;a<r.length;a++){n[a].update(r[a])}}};b.destroy=function(){if(this.map){this.map.remove();this.map=null;this.container.removeChild(this.div)}};b.toImage=function(){this.map.stop();return this.map.getCanvas().toDataURL()};b.setOptions=function(e,t,r){for(var n in r){this.map[t](e,n,r[n])}};b.getMapLayers=function(){return this.map.getStyle().layers};b.addLayer=function(e,t){var r=this.map;if(typeof t==="string"){if(t===""){r.addLayer(e,t);return}var n=this.getMapLayers();for(var i=0;i<n.length;i++){if(t===n[i].id){r.addLayer(e,t);return}}a.warn(["Trying to add layer with *below* value",t,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}r.addLayer(e)};b.project=function(e){return this.map.project(new n.LngLat(e[0],e[1]))};b.getView=function(){var e=this.map;var t=e.getCenter();var r={lon:t.lng,lat:t.lat};var n=e.getCanvas();var a=n.width;var i=n.height;return{center:r,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),_derived:{coordinates:[e.unproject([0,0]).toArray(),e.unproject([a,0]).toArray(),e.unproject([a,i]).toArray(),e.unproject([0,i]).toArray()]}}};b.getViewEdits=function(e){var t=this.id;var r=["center","zoom","bearing","pitch"];var n={};for(var a=0;a<r.length;a++){var i=r[a];n[t+"."+i]=e[i]}return n};b.getViewEditsWithDerived=function(e){var t=this.id;var r=this.getViewEdits(e);r[t+"._derived"]=e._derived;return r};function T(e){var t={};if(a.isPlainObject(e)){t.id=e.id;t.style=e}else if(typeof e==="string"){t.id=e;if(y.styleValuesMapbox.indexOf(e)!==-1){t.style=k(e)}else if(y.stylesNonMapbox[e]){t.style=y.stylesNonMapbox[e]}else{t.style=e}}else{t.id=y.styleValueDflt;t.style=k(y.styleValueDflt)}t.transition={duration:0,delay:0};return t}function k(e){return y.styleUrlPrefix+e+"-"+y.styleUrlSuffix}function A(e){return[e.lon,e.lat]}t.exports=_},{"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/fx":683,"../../lib":778,"../../lib/geo_location_utils":771,"../../registry":911,"../cartesian/axes":828,"../cartesian/select":847,"./constants":883,"./layers":886,"mapbox-gl":473}],890:[function(e,t,r){"use strict";t.exports=function(e){var t=e.editType;return{t:{valType:"number",dflt:0,editType:t},r:{valType:"number",dflt:0,editType:t},b:{valType:"number",dflt:0,editType:t},l:{valType:"number",dflt:0,editType:t},editType:t}}},{}],891:[function(e,t,r){"use strict";var n=e("d3");var a=e("d3-time-format").timeFormatLocale;var i=e("fast-isnumeric");var o=e("../registry");var s=e("../plot_api/plot_schema");var l=e("../plot_api/plot_template");var u=e("../lib");var c=e("../components/color");var f=e("../constants/numerical").BADNUM;var h=e("./cartesian/axis_ids");var p=e("./cartesian/handle_outline").clearSelect;var d=e("./animation_attributes");var v=e("./frame_attributes");var m=e("../plots/get_data").getModuleCalcData;var g=u.relinkPrivateKeys;var y=u._;var x=t.exports={};u.extendFlat(x,o);x.attributes=e("./attributes");x.attributes.type.values=x.allTypes;x.fontAttrs=e("./font_attributes");x.layoutAttributes=e("./layout_attributes");x.fontWeight="normal";var _=x.transformsRegistry;var b=e("./command");x.executeAPICommand=b.executeAPICommand;x.computeAPICommandBindings=b.computeAPICommandBindings;x.manageCommandObserver=b.manageCommandObserver;x.hasSimpleAPICommandBindings=b.hasSimpleAPICommandBindings;x.redrawText=function(e){e=u.getGraphDiv(e);var t=e._fullLayout||{};var r=t._has&&t._has("polar");var n=!r&&e.data&&e.data[0]&&e.data[0].r;if(n)return;return new Promise(function(t){setTimeout(function(){o.getComponentMethod("annotations","draw")(e);o.getComponentMethod("legend","draw")(e);o.getComponentMethod("colorbar","draw")(e);t(x.previousPromises(e))},300)})};x.resize=function(e){e=u.getGraphDiv(e);var t;var r=new Promise(function(r,n){if(!e||u.isHidden(e)){n(new Error("Resize must be passed a displayed plot div element."))}if(e._redrawTimer)clearTimeout(e._redrawTimer);if(e._resolveResize)t=e._resolveResize;e._resolveResize=r;e._redrawTimer=setTimeout(function(){if(!e.layout||e.layout.width&&e.layout.height||u.isHidden(e)){r(e);return}delete e.layout.width;delete e.layout.height;var t=e.changed;e.autoplay=true;o.call("relayout",e,{autosize:true}).then(function(){e.changed=t;if(e._resolveResize===r){delete e._resolveResize;r(e)}})},100)});if(t)t(r);return r};x.previousPromises=function(e){if((e._promises||[]).length){return Promise.all(e._promises).then(function(){e._promises=[]})}};x.addLinks=function(e){if(!e._context.showLink&&!e._context.showSources)return;var t=e._fullLayout;var r=u.ensureSingle(t._paper,"text","js-plot-link-container",function(e){e.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:c.defaultLine,"pointer-events":"all"}).each(function(){var e=n.select(this);e.append("tspan").classed("js-link-to-tool",true);e.append("tspan").classed("js-link-spacer",true);e.append("tspan").classed("js-sourcelinks",true)})});var a=r.node();var i={y:t._paper.attr("height")-9};if(document.body.contains(a)&&a.getComputedTextLength()>=t.width-20){i["text-anchor"]="start";i.x=5}else{i["text-anchor"]="end";i.x=t._paper.attr("width")-7}r.attr(i);var o=r.select(".js-link-to-tool");var s=r.select(".js-link-spacer");var l=r.select(".js-sourcelinks");if(e._context.showSources)e._context.showSources(e);if(e._context.showLink)w(e,o);s.text(o.text()&&l.text()?" - ":"")};function w(e,t){t.text("");var r=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+String.fromCharCode(187));if(e._context.sendData){r.on("click",function(){x.sendDataToCloud(e)})}else{var n=window.location.pathname.split("/");var a=window.location.search;r.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+n[2].split(".")[0]+"/"+n[1]+a})}}x.sendDataToCloud=function(e){var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL;if(!t)return;e.emit("plotly_beforeexport");var r=n.select(e).append("div").attr("id","hiddenform").style("display","none");var a=r.append("form").attr({action:t+"/external",method:"post",target:"_blank"});var i=a.append("input").attr({type:"text",name:"data"});i.node().value=x.graphJson(e,false,"keepdata");a.node().submit();r.remove();e.emit("plotly_afterexport");return false};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"];var k=["year","month","dayMonth","dayMonthYear"];x.supplyDefaults=function(e,t){var r=t&&t.skipUpdateCalc;var n=e._fullLayout||{};if(n._skipDefaults){delete n._skipDefaults;return}var a=e._fullLayout={};var i=e.layout||{};var s=e._fullData||[];var l=e._fullData=[];var c=e.data||[];var f=e.calcdata||[];var h=e._context||{};var d;if(!e._transitionData)x.createTransitionData(e);a._dfltTitle={plot:y(e,"Click to enter Plot title"),x:y(e,"Click to enter X axis title"),y:y(e,"Click to enter Y axis title"),colorbar:y(e,"Click to enter Colorscale title"),annotation:y(e,"new text")};a._traceWord=y(e,"trace");var v=E(e,T);a._mapboxAccessToken=h.mapboxAccessToken;if(n._initialAutoSizeIsDone){var m=n.width;var _=n.height;x.supplyLayoutGlobalDefaults(i,a,v);if(!i.width)a.width=m;if(!i.height)a.height=_;x.sanitizeMargins(a)}else{x.supplyLayoutGlobalDefaults(i,a,v);var b=!i.width||!i.height;var w=a.autosize;var L=h.autosizable;var I=b&&(w||L);if(I)x.plotAutoSize(e,i,a);else if(b)x.sanitizeMargins(a);if(!w&&b){i.width=a.width;i.height=a.height}}a._d3locale=S(v,a.separators);a._extraFormat=E(e,k);a._initialAutoSizeIsDone=true;a._dataLength=c.length;a._modules=[];a._visibleModules=[];a._basePlotModules=[];var O=a._subplots=M();var P=a._splomAxes={x:{},y:{}};var R=a._splomSubplots={};a._splomGridDflt={};a._scatterStackOpts={};a._firstScatter={};a._alignmentOpts={};a._colorAxes={};a._requestRangeslider={};a._traceUids=A(s,c);a._globalTransforms=(e._context||{}).globalTransforms;x.supplyDataDefaults(c,l,i,a);var z=Object.keys(P.x);var N=Object.keys(P.y);if(z.length>1&&N.length>1){o.getComponentMethod("grid","sizeDefaults")(i,a);for(d=0;d<z.length;d++){u.pushUnique(O.xaxis,z[d])}for(d=0;d<N.length;d++){u.pushUnique(O.yaxis,N[d])}for(var F in R){u.pushUnique(O.cartesian,F)}}a._has=x._hasPlotType.bind(a);if(s.length===l.length){for(d=0;d<l.length;d++){g(l[d],s[d])}}x.supplyLayoutModuleDefaults(i,a,l,e._transitionData);var B=a._visibleModules;var j=[];for(d=0;d<B.length;d++){var U=B[d].crossTraceDefaults;if(U)u.pushUnique(j,U)}for(d=0;d<j.length;d++){j[d](l,a)}a._hasOnlyLargeSploms=a._basePlotModules.length===1&&a._basePlotModules[0].name==="splom"&&z.length>15&&N.length>15&&a.shapes.length===0&&a.images.length===0;a._hasCartesian=a._has("cartesian");a._hasGeo=a._has("geo");a._hasGL3D=a._has("gl3d");a._hasGL2D=a._has("gl2d");a._hasTernary=a._has("ternary");a._hasPie=a._has("pie");x.linkSubplots(l,a,s,n);x.cleanPlot(l,a,s,n);var H=!!(n._has&&n._has("gl2d"));var V=!!(a._has&&a._has("gl2d"));var G=!!(n._has&&n._has("cartesian"));var q=!!(a._has&&a._has("cartesian"));var Y=G||H;var W=q||V;if(Y&&!W){n._bgLayer.remove()}else if(W&&!Y){a._shouldCreateBgLayer=true}if(n._zoomlayer&&!e._dragging){p({_fullLayout:n})}C(l,a);g(a,n);o.getComponentMethod("colorscale","crossTraceDefaults")(l,a);if(!a._preGUI)a._preGUI={};if(!a._tracePreGUI)a._tracePreGUI={};var X=a._tracePreGUI;var Z={};var K;for(K in X)Z[K]="old";for(d=0;d<l.length;d++){K=l[d]._fullInput.uid;if(!Z[K])X[K]={};Z[K]="new"}for(K in Z){if(Z[K]==="old")delete X[K]}D(a);o.getComponentMethod("rangeslider","makeData")(a);if(!r&&f.length===l.length){x.supplyDefaultsUpdateCalc(f,l)}};x.supplyDefaultsUpdateCalc=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];var a=(e[r]||[])[0];if(a&&a.trace){var i=a.trace;if(i._hasCalcTransform){var o=i._arrayAttrs;var s,l,c;for(s=0;s<o.length;s++){l=o[s];c=u.nestedProperty(i,l).get().slice();u.nestedProperty(n,l).set(c)}}a.trace=n}}};function A(e,t){var r=t.length;var n=[];var a,i;for(a=0;a<e.length;a++){var o=e[a]._fullInput;if(o!==i)n.push(o);i=o}var s=n.length;var l=new Array(r);var c={};function f(e,t){l[t]=e;c[e]=1}function h(e,t){if(e&&typeof e==="string"&&!c[e]){f(e,t);return true}}for(a=0;a<r;a++){var p=t[a].uid;if(typeof p==="number")p=String(p);if(h(p,a))continue;if(a<s&&h(n[a].uid,a))continue;f(u.randstr(c),a)}return l}function M(){var e=o.collectableSubplotTypes;var t={};var r,n;if(!e){e=[];var a=o.subplotsRegistry;for(var i in a){var s=a[i];var l=s.attr;if(l){e.push(i);if(Array.isArray(l)){for(n=0;n<l.length;n++){u.pushUnique(e,l[n])}}}}}for(r=0;r<e.length;r++){t[e[r]]=[]}return t}function E(e,t){var r=e._context.locale;if(!r)r="en-US";var n=false;var a={};function i(e){var r=true;for(var i=0;i<t.length;i++){var o=t[i];if(!a[o]){if(e[o]){a[o]=e[o]}else r=false}}if(r)n=true}for(var s=0;s<2;s++){var l=e._context.locales;for(var u=0;u<2;u++){var c=(l[r]||{}).format;if(c){i(c);if(n)break}l=o.localeRegistry}var f=r.split("-")[0];if(n||f===r)break;r=f}if(!n)i(o.localeRegistry.en.format);return a}function S(e,t){e.decimal=t.charAt(0);e.thousands=t.charAt(1);return{numberFormat:n.locale(e).numberFormat,timeFormat:a(e).utcFormat}}function C(e,t){var r;var n=[];if(t.meta){r=t._meta={meta:t.meta,layout:{meta:t.meta}}}for(var a=0;a<e.length;a++){var i=e[a];if(i.meta){n[i.index]=i._meta={meta:i.meta}}else if(t.meta){i._meta={meta:t.meta}}if(t.meta){i._meta.layout={meta:t.meta}}}if(n.length){if(!r){r=t._meta={}}r.data=n}}x.createTransitionData=function(e){if(!e._transitionData){e._transitionData={}}if(!e._transitionData._frames){e._transitionData._frames=[]}if(!e._transitionData._frameHash){e._transitionData._frameHash={}}if(!e._transitionData._counter){e._transitionData._counter=0}if(!e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks=[]}};x._hasPlotType=function(e){var t;var r=this._basePlotModules||[];for(t=0;t<r.length;t++){if(r[t].name===e)return true}var n=this._modules||[];for(t=0;t<n.length;t++){var a=n[t].name;if(a===e)return true;var i=o.modules[a];if(i&&i.categories[e])return true}return false};x.cleanPlot=function(e,t,r,n){var a,i;var o=n._basePlotModules||[];for(a=0;a<o.length;a++){var s=o[a];if(s.clean){s.clean(e,t,r,n)}}var l=n._has&&n._has("gl");var u=t._has&&t._has("gl");if(l&&!u){if(n._glcontainer!==undefined){n._glcontainer.selectAll(".gl-canvas").remove();n._glcontainer.selectAll(".no-webgl").remove();n._glcanvas=null}}var c=!!n._infolayer;e:for(a=0;a<r.length;a++){var f=r[a];var h=f.uid;for(i=0;i<e.length;i++){var p=e[i];if(h===p.uid)continue e}if(c){n._infolayer.select(".cb"+h).remove()}}};x.linkSubplots=function(e,t,r,n){var a,i;var s=n._plots||{};var l=t._plots={};var c=t._subplots;var f={_fullData:e,_fullLayout:t};var p=c.cartesian.concat(c.gl2d||[]);for(a=0;a<p.length;a++){var d=p[a];var v=s[d];var m=h.getFromId(f,d,"x");var g=h.getFromId(f,d,"y");var y;if(v){y=l[d]=v}else{y=l[d]={};y.id=d}m._counterAxes.push(g._id);g._counterAxes.push(m._id);m._subplotsWith.push(d);g._subplotsWith.push(d);y.xaxis=m;y.yaxis=g;y._hasClipOnAxisFalse=false;for(i=0;i<e.length;i++){var x=e[i];if(x.xaxis===y.xaxis._id&&x.yaxis===y.yaxis._id&&x.cliponaxis===false){y._hasClipOnAxisFalse=true;break}}}var _=h.list(f,null,true);var b;for(a=0;a<_.length;a++){b=_[a];var w=null;if(b.overlaying){w=h.getFromId(f,b.overlaying);if(w&&w.overlaying){b.overlaying=false;w=null}}b._mainAxis=w||b;if(w)b.domain=w.domain.slice();b._anchorAxis=b.anchor==="free"?null:h.getFromId(f,b.anchor)}for(a=0;a<_.length;a++){b=_[a];b._counterAxes.sort(h.idSort);b._subplotsWith.sort(u.subplotSort);b._mainSubplot=L(b,t);if(b._counterAxes.length&&(b.spikemode&&b.spikemode.indexOf("across")!==-1||b.automargin&&b.mirror&&b.anchor!=="free"||o.getComponentMethod("rangeslider","isVisible")(b))){var T=1;var k=0;for(i=0;i<b._counterAxes.length;i++){var A=h.getFromId(f,b._counterAxes[i]);T=Math.min(T,A.domain[0]);k=Math.max(k,A.domain[1])}if(T<k){b._counterDomainMin=T;b._counterDomainMax=k}}}};function L(e,t){var r={_fullLayout:t};var n=e._id.charAt(0)==="x";var a=e._mainAxis._anchorAxis;var i="";var o="";var s="";if(a){s=a._mainAxis._id;i=n?e._id+s:s+e._id}if(!i||!t._plots[i]){i="";var l=e._counterAxes;for(var u=0;u<l.length;u++){var c=l[u];var f=n?e._id+c:c+e._id;if(!o)o=f;var p=h.getFromId(r,c);if(s&&p.overlaying===s){i=f;break}}}return i||o}x.clearExpandedTraceDefaultColors=function(e){var t,r,n;function a(e,n,a,i){r[i]=n;r.length=i+1;if(e.valType==="color"&&e.dflt===undefined){t.push(r.join("."))}}r=[];t=e._module._colorAttrs;if(!t){e._module._colorAttrs=t=[];s.crawl(e._module.attributes,a)}for(n=0;n<t.length;n++){var i=u.nestedProperty(e,"_input."+t[n]);if(!i.get()){u.nestedProperty(e,t[n]).set(null)}}};x.supplyDataDefaults=function(e,t,r,n){var a=n._modules;var i=n._visibleModules;var s=n._basePlotModules;var c=0;var f=0;var h,p,d;n._transformModules=[];function v(e){t.push(e);var r=e._module;if(!r)return;u.pushUnique(a,r);if(e.visible===true)u.pushUnique(i,r);u.pushUnique(s,e._module.basePlotModule);c++;if(e._input.visible!==false)f++}var m={};var y=[];var _=(r.template||{}).data||{};var b=l.traceTemplater(_);for(h=0;h<e.length;h++){d=e[h];p=b.newTrace(d);p.uid=n._traceUids[h];x.supplyTraceDefaults(d,p,f,n,h);p.index=h;p._input=d;p._expandedIndex=c;if(p.transforms&&p.transforms.length){var w=d.visible!==false&&p.visible===false;var T=O(p,t,r,n);for(var k=0;k<T.length;k++){var A=T[k];var M={_template:p._template,type:p.type,uid:p.uid+k};if(w&&A.visible===false){delete A.visible}x.supplyTraceDefaults(A,M,c,n,h);g(M,A);M.index=h;M._input=d;M._fullInput=p;M._expandedIndex=c;M._expandedInput=A;v(M)}}else{p._fullInput=p;p._expandedInput=p;v(p)}if(o.traceIs(p,"carpetAxis")){m[p.carpet]=p}if(o.traceIs(p,"carpetDependent")){y.push(h)}}for(h=0;h<y.length;h++){p=t[y[h]];if(!p.visible)continue;var E=m[p.carpet];p._carpet=E;if(!E||!E.visible){p.visible=false;continue}p.xaxis=E.xaxis;p.yaxis=E.yaxis}};x.supplyAnimationDefaults=function(e){e=e||{};var t;var r={};function n(t,n){return u.coerce(e||{},r,d,t,n)}n("mode");n("direction");n("fromcurrent");if(Array.isArray(e.frame)){r.frame=[];for(t=0;t<e.frame.length;t++){r.frame[t]=x.supplyAnimationFrameDefaults(e.frame[t]||{})}}else{r.frame=x.supplyAnimationFrameDefaults(e.frame||{})}if(Array.isArray(e.transition)){r.transition=[];for(t=0;t<e.transition.length;t++){r.transition[t]=x.supplyAnimationTransitionDefaults(e.transition[t]||{})}}else{r.transition=x.supplyAnimationTransitionDefaults(e.transition||{})}return r};x.supplyAnimationFrameDefaults=function(e){var t={};function r(r,n){return u.coerce(e||{},t,d.frame,r,n)}r("duration");r("redraw");return t};x.supplyAnimationTransitionDefaults=function(e){var t={};function r(r,n){return u.coerce(e||{},t,d.transition,r,n)}r("duration");r("easing");return t};x.supplyFrameDefaults=function(e){var t={};function r(r,n){return u.coerce(e,t,v,r,n)}r("group");r("name");r("traces");r("baseframe");r("data");r("layout");return t};x.supplyTraceDefaults=function(e,t,r,n,a){var i=n.colorway||c.defaults;var s=i[r%i.length];var l;function f(r,n){return u.coerce(e,t,x.attributes,r,n)}var h=f("visible");f("type");f("name",n._traceWord+" "+a);f("uirevision",n.uirevision);var p=x.getModule(t);t._module=p;if(p){var d=p.basePlotModule;var v=d.attr;var m=d.attributes;if(v&&m){var g=n._subplots;var y="";if(h||d.name!=="gl2d"){if(Array.isArray(v)){for(l=0;l<v.length;l++){var _=v[l];var b=u.coerce(e,t,m,_);if(g[_])u.pushUnique(g[_],b);y+=b}}else{y=u.coerce(e,t,m,v)}if(g[d.name]){u.pushUnique(g[d.name],y)}}}}if(h){f("customdata");f("ids");f("meta");if(o.traceIs(t,"showLegend")){u.coerce(e,t,p.attributes.showlegend?p.attributes:x.attributes,"showlegend");f("legendgroup");t._dfltShowLegend=true}else{t._dfltShowLegend=false}if(p){p.supplyDefaults(e,t,s,n)}if(!o.traceIs(t,"noOpacity")){f("opacity")}if(o.traceIs(t,"notLegendIsolatable")){t.visible=!!t.visible}if(!o.traceIs(t,"noHover")){if(!t.hovertemplate)u.coerceHoverinfo(e,t,n);if(t.type!=="parcats"){o.getComponentMethod("fx","supplyDefaults")(e,t,s,n)}}if(p&&p.selectPoints){f("selectedpoints")}x.supplyTransformDefaults(e,t,n)}return t};function I(e){var t=e.transforms;if(Array.isArray(t)&&t.length){for(var r=0;r<t.length;r++){var n=t[r];var a=n._module||_[n.type];if(a&&a.makesData)return true}}return false}x.hasMakesDataTransform=I;x.supplyTransformDefaults=function(e,t,r){if(!(t._length||I(e)))return;var n=r._globalTransforms||[];var a=r._transformModules||[];if(!Array.isArray(e.transforms)&&n.length===0)return;var i=e.transforms||[];var o=n.concat(i);var s=t.transforms=[];for(var l=0;l<o.length;l++){var c=o[l];var f=c.type;var h=_[f];var p;var d=!(c._module&&c._module===h);var v=h&&typeof h.transform==="function";if(!h)u.warn("Unrecognized transform type "+f+".");if(h&&h.supplyDefaults&&(d||v)){p=h.supplyDefaults(c,t,r,e);p.type=f;p._module=h;u.pushUnique(a,h)}else{p=u.extendFlat({},c)}s.push(p)}};function O(e,t,r,n){var a=e.transforms;var i=[e];for(var o=0;o<a.length;o++){var s=a[o];var l=_[s.type];if(l&&l.transform){i=l.transform(i,{transform:s,fullTrace:e,fullData:t,layout:r,fullLayout:n,transformIndex:o})}}return i}x.supplyLayoutGlobalDefaults=function(e,t,r){function n(r,n){return u.coerce(e,t,x.layoutAttributes,r,n)}var a=e.template;if(u.isPlainObject(a)){t.template=a;t._template=a.layout;t._dataTemplate=a.data}n("autotypenumbers");var i=u.coerceFont(n,"font");n("title.text",t._dfltTitle.plot);u.coerceFont(n,"title.font",{family:i.family,size:Math.round(i.size*1.4),color:i.color});n("title.xref");n("title.yref");n("title.x");n("title.y");n("title.xanchor");n("title.yanchor");n("title.pad.t");n("title.pad.r");n("title.pad.b");n("title.pad.l");var s=n("uniformtext.mode");if(s){n("uniformtext.minsize")}n("autosize",!(e.width&&e.height));n("width");n("height");n("margin.l");n("margin.r");n("margin.t");n("margin.b");n("margin.pad");n("margin.autoexpand");if(e.width&&e.height)x.sanitizeMargins(t);o.getComponentMethod("grid","sizeDefaults")(e,t);n("paper_bgcolor");n("separators",r.decimal+r.thousands);n("hidesources");n("colorway");n("datarevision");var l=n("uirevision");n("editrevision",l);n("selectionrevision",l);n("modebar.orientation");n("modebar.bgcolor",c.addOpacity(t.paper_bgcolor,.5));var f=c.contrast(c.rgb(t.modebar.bgcolor));n("modebar.color",c.addOpacity(f,.3));n("modebar.activecolor",c.addOpacity(f,.7));n("modebar.uirevision",l);o.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(e,t,n);n("meta");if(u.isPlainObject(e.transition)){n("transition.duration");n("transition.easing");n("transition.ordering")}o.getComponentMethod("calendars","handleDefaults")(e,t,"calendar");o.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,n)};function P(e){return typeof e==="string"&&e.substr(e.length-2)==="px"&&parseFloat(e)}x.plotAutoSize=function e(t,r,n){var a=t._context||{};var o=a.frameMargins;var s;var l;var c=u.isPlotDiv(t);if(c)t.emit("plotly_autosize");if(a.fillFrame){s=window.innerWidth;l=window.innerHeight;document.body.style.overflow="hidden"}else{var f=c?window.getComputedStyle(t):{};s=P(f.width)||P(f.maxWidth)||n.width;l=P(f.height)||P(f.maxHeight)||n.height;if(i(o)&&o>0){var h=1-2*o;s=Math.round(h*s);l=Math.round(h*l)}}var p=x.layoutAttributes.width.min;var d=x.layoutAttributes.height.min;if(s<p)s=p;if(l<d)l=d;var v=!r.width&&Math.abs(n.width-s)>1;var m=!r.height&&Math.abs(n.height-l)>1;if(m||v){if(v)n.width=s;if(m)n.height=l}if(!t._initialAutoSize){t._initialAutoSize={width:s,height:l}}x.sanitizeMargins(n)};x.supplyLayoutModuleDefaults=function(e,t,r,n){var a=o.componentsRegistry;var i=t._basePlotModules;var s,l,c;var f=o.subplotsRegistry.cartesian;for(s in a){c=a[s];if(c.includeBasePlot){c.includeBasePlot(e,t)}}if(!i.length){i.push(f)}if(t._has("cartesian")){o.getComponentMethod("grid","contentDefaults")(e,t);f.finalizeSubplots(e,t)}for(var h in t._subplots){t._subplots[h].sort(u.subplotSort)}for(l=0;l<i.length;l++){c=i[l];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r)}}var p=t._modules;for(l=0;l<p.length;l++){c=p[l];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r)}}var d=t._transformModules;for(l=0;l<d.length;l++){c=d[l];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r,n)}}for(s in a){c=a[s];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r)}}};x.purge=function(e){var t=e._fullLayout||{};if(t._glcontainer!==undefined){t._glcontainer.selectAll(".gl-canvas").remove();t._glcontainer.remove();t._glcanvas=null}if(t._modeBar)t._modeBar.destroy();if(e._transitionData){if(e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks.length=0}if(e._transitionData._animationRaf){window.cancelAnimationFrame(e._transitionData._animationRaf)}}u.clearThrottle();u.clearResponsive(e);delete e.data;delete e.layout;delete e._fullData;delete e._fullLayout;delete e.calcdata;delete e.framework;delete e.empty;delete e.fid;delete e.undoqueue;delete e.undonum;delete e.autoplay;delete e.changed;delete e._promises;delete e._redrawTimer;delete e._hmlumcount;delete e._hmpixcount;delete e._transitionData;delete e._transitioning;delete e._initialAutoSize;delete e._transitioningWithDuration;delete e._dragging;delete e._dragged;delete e._dragdata;delete e._hoverdata;delete e._snapshotInProgress;delete e._editing;delete e._mouseDownTime;delete e._legendMouseDownTime;if(e.removeAllListeners)e.removeAllListeners()};x.style=function(e){var t=e._fullLayout._visibleModules;var r=[];var n;for(n=0;n<t.length;n++){var a=t[n];if(a.style){u.pushUnique(r,a.style)}}for(n=0;n<r.length;n++){r[n](e)}};x.sanitizeMargins=function(e){if(!e||!e.margin)return;var t=e.width;var r=e.height;var n=e.margin;var a=t-(n.l+n.r);var i=r-(n.t+n.b);var o;if(a<0){o=(t-1)/(n.l+n.r);n.l=Math.floor(o*n.l);n.r=Math.floor(o*n.r)}if(i<0){o=(r-1)/(n.t+n.b);n.t=Math.floor(o*n.t);n.b=Math.floor(o*n.b)}};x.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}};x.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1};function D(e){var t=e.margin;if(!e._size){var r=e._size={l:Math.round(t.l),r:Math.round(t.r),t:Math.round(t.t),b:Math.round(t.b),p:Math.round(t.pad)};r.w=Math.round(e.width)-r.l-r.r;r.h=Math.round(e.height)-r.t-r.b}if(!e._pushmargin)e._pushmargin={};if(!e._pushmarginIds)e._pushmarginIds={}}var R=2;var z=2;var N=64;var F=64;x.autoMargin=function(e,t,r){var n=e._fullLayout;var a=n.width;var i=n.height;var o=n.margin;var s=u.constrain(a-o.l-o.r,R,N);var l=u.constrain(i-o.t-o.b,z,F);var c=Math.max(0,a-s);var f=Math.max(0,i-l);var h=n._pushmargin;var p=n._pushmarginIds;if(o.autoexpand!==false){if(!r){delete h[t];delete p[t]}else{var d=r.pad;if(d===undefined){d=Math.min(12,o.l,o.r,o.t,o.b)}if(c){var v=(r.l+r.r)/c;if(v>1){r.l/=v;r.r/=v}}if(f){var m=(r.t+r.b)/f;if(m>1){r.t/=m;r.b/=m}}var g=r.xl!==undefined?r.xl:r.x;var y=r.xr!==undefined?r.xr:r.x;var _=r.yt!==undefined?r.yt:r.y;var b=r.yb!==undefined?r.yb:r.y;h[t]={l:{val:g,size:r.l+d},r:{val:y,size:r.r+d},b:{val:b,size:r.b+d},t:{val:_,size:r.t+d}};p[t]=1}if(!n._replotting){return x.doAutoMargin(e)}}};x.doAutoMargin=function(e){var t=e._fullLayout;var r=t.width;var n=t.height;if(!t._size)t._size={};D(t);var a=t._size;var s=t.margin;var l=u.extendFlat({},a);var c=s.l;var f=s.r;var h=s.t;var p=s.b;var d=t._pushmargin;var v=t._pushmarginIds;if(t.margin.autoexpand!==false){for(var m in d){if(!v[m])delete d[m]}d.base={l:{val:0,size:c},r:{val:1,size:f},t:{val:1,size:h},b:{val:0,size:p}};for(var g in d){var y=d[g].l||{};var _=d[g].b||{};var b=y.val;var w=y.size;var T=_.val;var k=_.size;for(var A in d){if(i(w)&&d[A].r){var M=d[A].r.val;var E=d[A].r.size;if(M>b){var S=(w*M+(E-r)*b)/(M-b);var C=(E*(1-b)+(w-r)*(1-M))/(M-b);if(S+C>c+f){c=S;f=C}}}if(i(k)&&d[A].t){var L=d[A].t.val;var I=d[A].t.size;if(L>T){var O=(k*L+(I-n)*T)/(L-T);var P=(I*(1-T)+(k-n)*(1-L))/(L-T);if(O+P>p+h){p=O;h=P}}}}}}var j=u.constrain(r-s.l-s.r,R,N);var U=u.constrain(n-s.t-s.b,z,F);var H=Math.max(0,r-j);var V=Math.max(0,n-U);if(H){var G=(c+f)/H;if(G>1){c/=G;f/=G}}if(V){var q=(p+h)/V;if(q>1){p/=q;h/=q}}a.l=Math.round(c);a.r=Math.round(f);a.t=Math.round(h);a.b=Math.round(p);a.p=Math.round(s.pad);a.w=Math.round(r)-a.l-a.r;a.h=Math.round(n)-a.t-a.b;if(!t._replotting&&x.didMarginChange(l,a)){if("_redrawFromAutoMarginCount"in t){t._redrawFromAutoMarginCount++}else{t._redrawFromAutoMarginCount=1}var Y=3*(1+Object.keys(v).length);if(t._redrawFromAutoMarginCount<Y){return o.call("plot",e)}else{t._size=l;u.warn("Too many auto-margin redraws.")}}B(e)};function B(e){var t=h.list(e,"",true);for(var r=0;r<t.length;r++){var n=t[r];var a=n._hideOutOfRangeInsideTickLabels;if(a)a()}}var j=["l","r","t","b","p","w","h"];x.didMarginChange=function(e,t){for(var r=0;r<j.length;r++){var n=j[r];var a=e[n];var o=t[n];if(!i(a)||Math.abs(o-a)>1){return true}}return false};x.graphJson=function(e,t,r,n,a,i){if(a&&t&&!e._fullData||a&&!t&&!e._fullLayout){x.supplyDefaults(e)}var o=a?e._fullData:e.data;var s=a?e._fullLayout:e.layout;var l=(e._transitionData||{})._frames;function c(e,t){if(typeof e==="function"){return t?"_function_":null}if(u.isPlainObject(e)){var n={};var a;Object.keys(e).sort().forEach(function(i){if(["_","["].indexOf(i.charAt(0))!==-1)return;if(typeof e[i]==="function"){if(t)n[i]="_function";return}if(r==="keepdata"){if(i.substr(i.length-3)==="src"){return}}else if(r==="keepstream"){a=e[i+"src"];if(typeof a==="string"&&a.indexOf(":")>0){if(!u.isPlainObject(e.stream)){return}}}else if(r!=="keepall"){a=e[i+"src"];if(typeof a==="string"&&a.indexOf(":")>0){return}}n[i]=c(e[i],t)});return n}if(Array.isArray(e)){return e.map(function(e){return c(e,t)})}if(u.isTypedArray(e)){return u.simpleMap(e,u.identity)}if(u.isJSDate(e))return u.ms2DateTimeLocal(+e);return e}var f={data:(o||[]).map(function(e){var r=c(e);if(t){delete r.fit}return r})};if(!t){f.layout=c(s);if(a){var h=s._size;f.layout.computed={margin:{b:h.b,l:h.l,r:h.r,t:h.t}}}}if(e.framework&&e.framework.isPolar)f=e.framework.getConfig();if(l)f.frames=c(l);if(i)f.config=c(e._context,true);return n==="object"?f:JSON.stringify(f)};x.modifyFrames=function(e,t){var r,n,a;var i=e._transitionData._frames;var o=e._transitionData._frameHash;for(r=0;r<t.length;r++){n=t[r];switch(n.type){case"replace":a=n.value;var s=(i[n.index]||{}).name;var l=a.name;i[n.index]=o[l]=a;if(l!==s){delete o[s];o[l]=a}break;case"insert":a=n.value;o[a.name]=a;i.splice(n.index,0,a);break;case"delete":a=i[n.index];delete o[a.name];i.splice(n.index,1);break}}return Promise.resolve()};x.computeFrame=function(e,t){var r=e._transitionData._frameHash;var n,a,i,o;if(!t){throw new Error("computeFrame must be given a string frame name")}var s=r[t.toString()];if(!s){return false}var l=[s];var u=[s.name];while(s.baseframe&&(s=r[s.baseframe.toString()])){if(u.indexOf(s.name)!==-1)break;l.push(s);u.push(s.name)}var c={};while(s=l.pop()){if(s.layout){c.layout=x.extendLayout(c.layout,s.layout)}if(s.data){if(!c.data){c.data=[]}a=s.traces;if(!a){a=[];for(n=0;n<s.data.length;n++){a[n]=n}}if(!c.traces){c.traces=[]}for(n=0;n<s.data.length;n++){i=a[n];if(i===undefined||i===null){continue}o=c.traces.indexOf(i);if(o===-1){o=c.data.length;c.traces[o]=i}c.data[o]=x.extendTrace(c.data[o],s.data[n])}}}return c};x.recomputeFrameHash=function(e){var t=e._transitionData._frameHash={};var r=e._transitionData._frames;for(var n=0;n<r.length;n++){var a=r[n];if(a&&a.name){t[a.name]=a}}};x.extendObjectWithContainers=function(e,t,r){var n,a,i,o,s,l,c,f;var h=u.extendDeepNoArrays({},t||{});var p=u.expandObjectPaths(h);var d={};if(r&&r.length){for(i=0;i<r.length;i++){n=u.nestedProperty(p,r[i]);a=n.get();if(a===undefined){u.nestedProperty(d,r[i]).set(null)}else{n.set(null);u.nestedProperty(d,r[i]).set(a)}}}e=u.extendDeepNoArrays(e||{},p);if(r&&r.length){for(i=0;i<r.length;i++){s=u.nestedProperty(d,r[i]);c=s.get();if(!c)continue;l=u.nestedProperty(e,r[i]);f=l.get();if(!Array.isArray(f)){f=[];l.set(f)}for(o=0;o<c.length;o++){var v=c[o];if(v===null)f[o]=null;else{f[o]=x.extendObjectWithContainers(f[o],v)}}l.set(f)}}return e};x.dataArrayContainers=["transforms","dimensions"];x.layoutArrayContainers=o.layoutArrayContainers;x.extendTrace=function(e,t){return x.extendObjectWithContainers(e,t,x.dataArrayContainers)};x.extendLayout=function(e,t){return x.extendObjectWithContainers(e,t,x.layoutArrayContainers)};x.transition=function(e,t,r,n,a,i){var o={redraw:a.redraw};var s={};var l=[];o.prepareFn=function(){var a=Array.isArray(t)?t.length:0;var i=n.slice(0,a);for(var o=0;o<i.length;o++){var c=i[o];var f=e._fullData[c];var h=f._module;if(!h)continue;if(h.animatable){var p=h.basePlotModule.name;if(!s[p])s[p]=[];s[p].push(c)}e.data[i[o]]=x.extendTrace(e.data[i[o]],t[o])}var d=u.expandObjectPaths(u.extendDeepNoArrays({},r));var v=/^[xy]axis[0-9]*$/;for(var m in d){if(!v.test(m))continue;delete d[m].range}x.extendLayout(e.layout,d);delete e.calcdata;x.supplyDefaults(e);x.doCalcdata(e);var g=u.expandObjectPaths(r);if(g){var y=e._fullLayout._plots;for(var _ in y){var b=y[_];var w=b.xaxis;var T=b.yaxis;var k=w.range.slice();var A=T.range.slice();var M=null;var E=null;var S=null;var C=null;if(Array.isArray(g[w._name+".range"])){M=g[w._name+".range"].slice()}else if(Array.isArray((g[w._name]||{}).range)){M=g[w._name].range.slice()}if(Array.isArray(g[T._name+".range"])){E=g[T._name+".range"].slice()}else if(Array.isArray((g[T._name]||{}).range)){E=g[T._name].range.slice()}if(k&&M&&(w.r2l(k[0])!==w.r2l(M[0])||w.r2l(k[1])!==w.r2l(M[1]))){S={xr0:k,xr1:M}}if(A&&E&&(T.r2l(A[0])!==T.r2l(E[0])||T.r2l(A[1])!==T.r2l(E[1]))){C={yr0:A,yr1:E}}if(S||C){l.push(u.extendFlat({plotinfo:b},S,C))}}}return Promise.resolve()};o.runFn=function(t){var n;var a=e._fullLayout._basePlotModules;var o=l.length;var c;if(r){for(c=0;c<a.length;c++){if(a[c].transitionAxes){a[c].transitionAxes(e,l,i,t)}}}if(o){n=u.extendFlat({},i);n.duration=0;delete s.cartesian}else{n=i}for(var f in s){var h=s[f];var p=e._fullData[h[0]]._module;p.basePlotModule.plot(e,h,n,t)}};return U(e,i,o)};x.transitionFromReact=function(e,t,r,n){var a=e._fullLayout;var i=a.transition;var o={};var s=[];o.prepareFn=function(){var e=a._plots;o.redraw=false;if(t.anim==="some")o.redraw=true;if(r.anim==="some")o.redraw=true;for(var i in e){var l=e[i];var c=l.xaxis;var f=l.yaxis;var h=n[c._name].range.slice();var p=n[f._name].range.slice();var d=c.range.slice();var v=f.range.slice();c.setScale();f.setScale();var m=null;var g=null;if(c.r2l(h[0])!==c.r2l(d[0])||c.r2l(h[1])!==c.r2l(d[1])){m={xr0:h,xr1:d}}if(f.r2l(p[0])!==f.r2l(v[0])||f.r2l(p[1])!==f.r2l(v[1])){g={yr0:p,yr1:v}}if(m||g){s.push(u.extendFlat({plotinfo:l},m,g))}}return Promise.resolve()};o.runFn=function(r){var n=e._fullData;var a=e._fullLayout;var o=a._basePlotModules;var l;var c;var f;var h=[];for(var p=0;p<n.length;p++){h.push(p)}function d(){for(var t=0;t<o.length;t++){if(o[t].transitionAxes){o[t].transitionAxes(e,s,l,r)}}}function v(){for(var t=0;t<o.length;t++){o[t].plot(e,f,c,r)}}if(s.length&&t.anim){if(i.ordering==="traces first"){l=u.extendFlat({},i,{duration:0});f=h;c=i;setTimeout(d,i.duration);v()}else{l=i;f=null;c=u.extendFlat({},i,{duration:0});setTimeout(v,l.duration);d()}}else if(s.length){l=i;d()}else if(t.anim){f=h;c=i;v()}};return U(e,i,o)};function U(e,t,r){var n=false;function a(e){var t=Promise.resolve();if(!e)return t;while(e.length){t=t.then(e.shift())}return t}function i(e){if(!e)return;while(e.length){e.shift()}}function s(){e.emit("plotly_transitioning",[]);return new Promise(function(a){e._transitioning=true;if(t.duration>0){e._transitioningWithDuration=true}e._transitionData._interruptCallbacks.push(function(){n=true});if(r.redraw){e._transitionData._interruptCallbacks.push(function(){return o.call("redraw",e)})}e._transitionData._interruptCallbacks.push(function(){e.emit("plotly_transitioninterrupted",[])});var i=0;var s=0;function u(){i++;return function(){s++;if(!n&&s===i){l(a)}}}r.runFn(u);setTimeout(u())})}function l(t){if(!e._transitionData)return;i(e._transitionData._interruptCallbacks);return Promise.resolve().then(function(){if(r.redraw){return o.call("redraw",e)}}).then(function(){e._transitioning=false;e._transitioningWithDuration=false;e.emit("plotly_transitioned",[])}).then(t)}function c(){if(!e._transitionData)return;e._transitioning=false;return a(e._transitionData._interruptCallbacks)}var f=[x.previousPromises,c,r.prepareFn,x.rehover,s];var h=u.syncOrAsync(f,e);if(!h||!h.then){h=Promise.resolve()}return h.then(function(){return e})}x.doCalcdata=function(e,t){var r=h.list(e);var n=e._fullData;var a=e._fullLayout;var i,l,u,c;var p=new Array(n.length);var d=(e.calcdata||[]).slice();e.calcdata=p;a._numBoxes=0;a._numViolins=0;a._violinScaleGroupStats={};e._hmpixcount=0;e._hmlumcount=0;a._piecolormap={};a._sunburstcolormap={};a._treemapcolormap={};a._funnelareacolormap={};for(u=0;u<n.length;u++){if(Array.isArray(t)&&t.indexOf(u)===-1){p[u]=d[u];continue}}for(u=0;u<n.length;u++){i=n[u];i._arrayAttrs=s.findArrayAttributes(i);i._extremes={}}var v=a._subplots.polar||[];for(u=0;u<v.length;u++){r.push(a[v[u]].radialaxis,a[v[u]].angularaxis)}for(var m in a._colorAxes){var g=a[m];if(g.cauto!==false){delete g.cmin;delete g.cmax}}var y=false;function x(t){i=n[t];l=i._module;if(i.visible===true&&i.transforms){if(l&&l.calc){var r=l.calc(e,i);if(r[0]&&r[0].t&&r[0].t._scene){delete r[0].t._scene.dirty}}for(c=0;c<i.transforms.length;c++){var a=i.transforms[c];l=_[a.type];if(l&&l.calcTransform){i._hasCalcTransform=true;y=true;l.calcTransform(e,i,a)}}}}function b(t,r){i=n[t];l=i._module;if(!!l.isContainer!==r)return;var a=[];if(i.visible===true&&i._length!==0){delete i._indexToPoints;var o=i.transforms||[];for(c=o.length-1;c>=0;c--){if(o[c].enabled){i._indexToPoints=o[c]._indexToPoints;break}}if(l&&l.calc){a=l.calc(e,i)}}if(!Array.isArray(a)||!a[0]){a=[{x:f,y:f}]}if(!a[0].t)a[0].t={};a[0].trace=i;p[t]=a}G(r,n,a);for(u=0;u<n.length;u++)b(u,true);for(u=0;u<n.length;u++)x(u);if(y)G(r,n,a);for(u=0;u<n.length;u++)b(u,true);for(u=0;u<n.length;u++)b(u,false);q(e);var w=V(r,e);if(w.length){a._numBoxes=0;a._numViolins=0;for(u=0;u<w.length;u++)b(w[u],true);for(u=0;u<w.length;u++)b(w[u],false);q(e)}o.getComponentMethod("fx","calc")(e);o.getComponentMethod("errorbars","calc")(e)};var H=/(total|sum|min|max|mean|median) (ascending|descending)/;function V(e,t){var r=[];var n,a,i,s,l;function c(e,r,n){var a=r._id.charAt(0);if(e==="histogram2dcontour"){var i=r._counterAxes[0];var o=h.getFromId(t,i);var s=a==="x"||i==="x"&&o.type==="category";var l=a==="y"||i==="y"&&o.type==="category";return function(e,t){if(e===0||t===0)return-1;if(s&&e===n[t].length-1)return-1;if(l&&t===n.length-1)return-1;return(a==="y"?t:e)-1}}else{return function(e,t){return a==="y"?t:e}}}var f={min:function(e){return u.aggNums(Math.min,null,e)},max:function(e){return u.aggNums(Math.max,null,e)},sum:function(e){return u.aggNums(function(e,t){return e+t},null,e)},total:function(e){return u.aggNums(function(e,t){return e+t},null,e)},mean:function(e){return u.mean(e)},median:function(e){return u.median(e)}};for(n=0;n<e.length;n++){var p=e[n];if(p.type!=="category")continue;var d=p.categoryorder.match(H);if(d){var v=d[1];var m=d[2];var g=p._id.charAt(0);var y=g==="x";var x=[];for(a=0;a<p._categories.length;a++){x.push([p._categories[a],[]])}for(a=0;a<p._traceIndices.length;a++){var _=p._traceIndices[a];var b=t._fullData[_];if(b.visible!==true)continue;var w=b.type;if(o.traceIs(b,"histogram")){delete b._xautoBinFinished;delete b._yautoBinFinished}var T=w==="splom";var k=w==="scattergl";var A=t.calcdata[_];for(i=0;i<A.length;i++){var M=A[i];var E,S;if(T){var C=b._axesDim[p._id];if(!y){var L=b._diag[C][0];if(L)p=t._fullLayout[h.id2name(L)]}var I=M.trace.dimensions[C].values;for(s=0;s<I.length;s++){E=p._categoriesMap[I[s]];for(l=0;l<M.trace.dimensions.length;l++){if(l===C)continue;var O=M.trace.dimensions[l];x[E][1].push(O.values[s])}}}else if(k){for(s=0;s<M.t.x.length;s++){if(y){E=M.t.x[s];S=M.t.y[s]}else{E=M.t.y[s];S=M.t.x[s]}x[E][1].push(S)}if(M.t&&M.t._scene){delete M.t._scene.dirty}}else if(M.hasOwnProperty("z")){S=M.z;var P=c(b.type,p,S);for(s=0;s<S.length;s++){for(l=0;l<S[s].length;l++){E=P(l,s);if(E+1)x[E][1].push(S[s][l])}}}else{E=M.p;if(E===undefined)E=M[g];S=M.s;if(S===undefined)S=M.v;if(S===undefined)S=y?M.y:M.x;if(!Array.isArray(S)){if(S===undefined)S=[];else S=[S]}for(s=0;s<S.length;s++){x[E][1].push(S[s])}}}}p._categoriesValue=x;var D=[];for(a=0;a<x.length;a++){D.push([x[a][0],f[v](x[a][1])])}D.sort(function(e,t){return e[1]-t[1]});p._categoriesAggregatedValue=D;p._initialCategories=D.map(function(e){return e[0]});if(m==="descending"){p._initialCategories.reverse()}r=r.concat(p.sortByInitialCategories())}}return r}function G(e,t,r){var n={};function a(e){e.clearCalc();if(e.type==="multicategory"){e.setupMultiCategory(t)}n[e._id]=1}u.simpleMap(e,a);var i=r._axisMatchGroups||[];for(var o=0;o<i.length;o++){for(var s in i[o]){if(!n[s]){a(r[h.id2name(s)])}}}}function q(e){var t=e._fullLayout;var r=t._visibleModules;var n={};var a,i,o;for(i=0;i<r.length;i++){var s=r[i];var l=s.crossTraceCalc;if(l){var c=s.basePlotModule.name;if(n[c]){u.pushUnique(n[c],l)}else{n[c]=[l]}}}for(o in n){var f=n[o];var h=t._subplots[o];if(Array.isArray(h)){for(a=0;a<h.length;a++){var p=h[a];var d=o==="cartesian"?t._plots[p]:t[p];for(i=0;i<f.length;i++){f[i](e,d,p)}}}else{for(i=0;i<f.length;i++){f[i](e)}}}}x.rehover=function(e){if(e._fullLayout._rehover){e._fullLayout._rehover()}};x.redrag=function(e){if(e._fullLayout._redrag){e._fullLayout._redrag()}};x.generalUpdatePerTraceModule=function(e,t,r,n){var a=t.traceHash;var i={};var o;for(o=0;o<r.length;o++){var s=r[o];var l=s[0].trace;if(l.visible){i[l.type]=i[l.type]||[];i[l.type].push(s)}}for(var c in a){if(!i[c]){var f=a[c][0];var h=f[0].trace;h.visible=false;i[c]=[f]}}for(var p in i){var d=i[p];var v=d[0][0].trace._module;v.plot(e,t,u.filterVisible(d),n)}t.traceHash=i};x.plotBasePlot=function(e,t,r,n,a){var i=o.getModule(e);var s=m(t.calcdata,i)[0];i.plot(t,s,n,a)};x.cleanBasePlot=function(e,t,r,n,a){var i=a._has&&a._has(e);var o=r._has&&r._has(e);if(i&&!o){a["_"+e+"layer"].selectAll("g.trace").remove()}}},{"../components/color":643,"../constants/numerical":753,"../lib":778,"../plot_api/plot_schema":816,"../plot_api/plot_template":817,"../plots/get_data":865,"../registry":911,"./animation_attributes":822,"./attributes":824,"./cartesian/axis_ids":831,"./cartesian/handle_outline":838,"./command":854,"./font_attributes":856,"./frame_attributes":857,"./layout_attributes":882,d3:169,"d3-time-format":166,"fast-isnumeric":241}],892:[function(e,t,r){"use strict";t.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],893:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../lib/polygon").tester;var i=n.findIndexOfMin;var o=n.isAngleInsideSector;var s=n.angleDelta;var l=n.angleDist;function u(e,t,r,n,i){if(!o(t,n))return false;var s,l;if(r[0]<r[1]){s=r[0];l=r[1]}else{s=r[1];l=r[0]}var u=a(d(s,n[0],n[1],i));var c=a(d(l,n[0],n[1],i));var f=[e*Math.cos(t),e*Math.sin(t)];return c.contains(f)&&!u.contains(f)}function c(e,t,r,n){var a,i;var o=n[0];var s=n[1];var l=g(Math.sin(t)-Math.sin(e));var u=g(Math.cos(t)-Math.cos(e));var c=Math.tan(r);var f=g(1/c);var h=l/u;var p=s-h*o;if(f){if(l&&u){a=p/(c-h);i=c*a}else if(u){a=s*f;i=s}else{a=o;i=o*c}}else{if(l&&u){a=0;i=p}else if(u){a=0;i=s}else{a=i=NaN}}return[a,i]}function f(e,t,r,n){var a=-t*r;var i=t*t+1;var o=2*(t*a-r);var s=a*a+r*r-e*e;var l=Math.sqrt(o*o-4*i*s);var u=(-o+l)/(2*i);var c=(-o-l)/(2*i);return[[u,t*u+a+n],[c,t*c+a+n]]}function h(e,t){var r=t.length;var n=new Array(r+1);var a;for(a=0;a<r;a++){var i=t[a];n[a]=[e*Math.cos(i),e*Math.sin(i)]}n[a]=n[0].slice();return n}function p(e,t,r,a){var s=a.length;var u=[];var f,h;function p(t){return[e*Math.cos(t),e*Math.sin(t)]}function d(e,t,r){return c(e,t,r,p(e))}function v(e){return n.mod(e,s)}function m(e){return o(e,[t,r])}var g=i(a,function(e){return m(e)?l(e,t):Infinity});var y=d(a[g],a[v(g-1)],t);u.push(y);for(f=g,h=0;h<s;f++,h++){var x=a[v(f)];if(!m(x))break;u.push(p(x))}var _=i(a,function(e){return m(e)?l(e,r):Infinity});var b=d(a[_],a[v(_+1)],r);u.push(b);u.push([0,0]);u.push(u[0].slice());return u}function d(e,t,r,a){return n.isFullCircle([t,r])?h(e,a):p(e,t,r,a)}function v(e,t,r,n){var a=Infinity;var i=Infinity;var o=d(e,t,r,n);for(var s=0;s<o.length;s++){var l=o[s];a=Math.min(a,l[0]);i=Math.min(i,-l[1])}return[a,i]}function m(e,t){var r=function(t){var r=s(t,e);return r>0?r:Infinity};var a=i(t,r);var o=n.mod(a+1,t.length);return[t[a],t[o]]}function g(e){return Math.abs(e)>1e-10?e:0}function y(e,t,r){t=t||0;r=r||0;var n=e.length;var a=new Array(n);for(var i=0;i<n;i++){var o=e[i];a[i]=[t+o[0],r-o[1]]}return a}function x(e,t,r,n,a,i){var o=d(e,t,r,n);return"M"+y(o,a,i).join("L")}function _(e,t,r,n,a,i,o){var s,l;if(e<t){s=e;l=t}else{s=t;l=e}var u=y(d(s,r,n,a),i,o);var c=y(d(l,r,n,a),i,o);return"M"+c.reverse().join("L")+"M"+u.join("L")}t.exports={isPtInsidePolygon:u,findPolygonOffset:v,findEnclosingVertexAngles:m,findIntersectionXY:c,findXYatLength:f,clampTiny:g,pathPolygon:x,pathPolygonAnnulus:_}},{"../../lib":778,"../../lib/polygon":790}],894:[function(e,t,r){"use strict";var n=e("../get_data").getSubplotCalcData;var a=e("../../lib").counterRegex;var i=e("./polar");var o=e("./constants");var s=o.attr;var l=o.name;var u=a(l);var c={};c[s]={valType:"subplotid",dflt:l,editType:"calc"};function f(e){var t=e._fullLayout;var r=e.calcdata;var a=t._subplots[l];for(var o=0;o<a.length;o++){var s=a[o];var u=n(r,l,s);var c=t[s]._subplot;if(!c){c=i(e,s);t[s]._subplot=c}c.plot(u,t,e._promises)}}function h(e,t,r,n){var a=n._subplots[l]||[];var i=n._has&&n._has("gl");var o=t._has&&t._has("gl");var s=i&&!o;for(var u=0;u<a.length;u++){var c=a[u];var f=n[c]._subplot;if(!t[c]&&!!f){f.framework.remove();f.layers["radial-axis-title"].remove();for(var h in f.clipPaths){f.clipPaths[h].remove()}}if(s&&f._scene){f._scene.destroy();f._scene=null}}}t.exports={attr:s,name:l,idRoot:l,idRegex:u,attrRegex:u,attributes:c,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:f,clean:h,toSVG:e("../cartesian").toSVG}},{"../../lib":778,"../cartesian":841,"../get_data":865,"./constants":892,"./layout_attributes":895,"./layout_defaults":896,"./polar":903}],895:[function(e,t,r){"use strict";var n=e("../../components/color/attributes");var a=e("../cartesian/layout_attributes");var i=e("../domain").attributes;var o=e("../../lib").extendFlat;var s=e("../../plot_api/edit_types").overrideAll;var l=s({color:a.color,showline:o({},a.showline,{dflt:true}),linecolor:a.linecolor,linewidth:a.linewidth,showgrid:o({},a.showgrid,{dflt:true}),gridcolor:a.gridcolor,gridwidth:a.gridwidth},"plot","from-root");var u=s({tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,showtickprefix:a.showtickprefix,tickprefix:a.tickprefix,showticksuffix:a.showticksuffix,ticksuffix:a.ticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,minexponent:a.minexponent,separatethousands:a.separatethousands,tickfont:a.tickfont,tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,layer:a.layer},"plot","from-root");var c={visible:o({},a.visible,{dflt:true}),type:o({},a.type,{values:["-","linear","log","date","category"]}),autotypenumbers:a.autotypenumbers,autorange:o({},a.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:o({},a.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}}],editType:"plot"}),categoryorder:a.categoryorder,categoryarray:a.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:o({},a.title.text,{editType:"plot",dflt:""}),font:o({},a.title.font,{editType:"plot"}),editType:"plot"},hoverformat:a.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:a._deprecated.title,titlefont:a._deprecated.titlefont}};o(c,l,u);var f={visible:o({},a.visible,{dflt:true}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:true},autotypenumbers:a.autotypenumbers,categoryorder:a.categoryorder,categoryarray:a.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:a.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};o(f,l,u);t.exports={domain:i({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:n.background},radialaxis:c,angularaxis:f,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":642,"../../lib":778,"../../plot_api/edit_types":810,"../cartesian/layout_attributes":842,"../domain":855}],896:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../../plot_api/plot_template");var o=e("../subplot_defaults");var s=e("../get_data").getSubplotData;var l=e("../cartesian/tick_value_defaults");var u=e("../cartesian/tick_mark_defaults");var c=e("../cartesian/tick_label_defaults");var f=e("../cartesian/category_order_defaults");var h=e("../cartesian/line_grid_defaults");var p=e("../cartesian/axis_autotype");var d=e("./layout_attributes");var v=e("./set_convert");var m=e("./constants");var g=m.axisNames;function y(e,t,r,o){var p=r("bgcolor");o.bgColor=a.combine(p,o.paper_bgcolor);var y=r("sector");r("hole");var _=s(o.fullData,m.name,o.id);var b=o.layoutOut;var w;function T(e,t){return r(w+"."+e,t)}for(var k=0;k<g.length;k++){w=g[k];if(!n.isPlainObject(e[w])){e[w]={}}var A=e[w];var M=i.newContainer(t,w);M._id=M._name=w;M._attr=o.id+"."+w;M._traceIndices=_.map(function(e){return e._expandedIndex});var E=m.axisName2dataArray[w];var S=x(A,M,T,_,E,o);f(A,M,T,{axData:_,dataAttr:E});var C=T("visible");v(M,t,b);T("uirevision",t.uirevision);var L;var I;if(C){L=T("color");I=L===A.color?L:o.font.color}M._m=1;switch(w){case"radialaxis":var O=T("autorange",!M.isValidRange(A.range));A.autorange=O;if(O&&(S==="linear"||S==="-"))T("rangemode");if(O==="reversed")M._m=-1;T("range");M.cleanRange("range",{dfltRange:[0,1]});if(C){T("side");T("angle",y[0]);T("title.text");n.coerceFont(T,"title.font",{family:o.font.family,size:Math.round(o.font.size*1.2),color:I})}break;case"angularaxis":if(S==="date"){n.log("Polar plots do not support date angular axes yet.");for(var P=0;P<_.length;P++){_[P].visible=false}S=A.type=M.type="linear"}if(S==="linear"){T("thetaunit")}else{T("period")}var D=T("direction");T("rotation",{counterclockwise:0,clockwise:90}[D]);break}if(C){l(A,M,T,M.type);c(A,M,T,M.type,{tickSuffixDflt:M.thetaunit==="degrees"?"°":undefined});u(A,M,T,{outerTicks:true});var R=T("showticklabels");if(R){n.coerceFont(T,"tickfont",{family:o.font.family,size:o.font.size,color:I});T("tickangle");T("tickformat")}h(A,M,T,{dfltColor:L,bgColor:o.bgColor,blend:60,showLine:true,showGrid:true,noZeroLine:true,attributes:d[w]});T("layer")}if(S!=="category")T("hoverformat");M._input=A}if(t.angularaxis.type==="category"){r("gridshape")}}function x(e,t,r,n,a,i){var o=r("autotypenumbers",i.autotypenumbersDflt);var s=r("type");if(s==="-"){var l;for(var u=0;u<n.length;u++){if(n[u].visible){l=n[u];break}}if(l&&l[a]){t.type=p(l[a],"gregorian",{noMultiCategory:true,autotypenumbers:o})}if(t.type==="-"){t.type="linear"}else{e.type=t.type}}return t.type}t.exports=function e(t,r,n){o(t,r,n,{type:m.name,attributes:d,handleDefaults:y,font:r.font,autotypenumbersDflt:r.autotypenumbers,paper_bgcolor:r.paper_bgcolor,fullData:n,layoutOut:r})}},{"../../components/color":643,"../../lib":778,"../../plot_api/plot_template":817,"../cartesian/axis_autotype":829,"../cartesian/category_order_defaults":832,"../cartesian/line_grid_defaults":844,"../cartesian/tick_label_defaults":849,"../cartesian/tick_mark_defaults":850,"../cartesian/tick_value_defaults":851,"../get_data":865,"../subplot_defaults":905,"./constants":892,"./layout_attributes":895,"./set_convert":904}],897:[function(e,t,r){"use strict";var n=e("../../../traces/scatter/attributes");var a=n.marker;var i=e("../../../lib/extend").extendFlat;var o=["Area traces are deprecated!","Please switch to the *barpolar* trace type."].join(" ");t.exports={r:i({},n.r,{}),t:i({},n.t,{}),marker:{color:i({},a.color,{}),size:i({},a.size,{}),symbol:i({},a.symbol,{}),opacity:i({},a.opacity,{}),editType:"calc"}}},{"../../../lib/extend":768,"../../../traces/scatter/attributes":1187}],898:[function(e,t,r){"use strict";var n=e("../../cartesian/layout_attributes");var a=e("../../../lib/extend").extendFlat;var i=e("../../../plot_api/edit_types").overrideAll;var o=["Legacy polar charts are deprecated!","Please switch to *polar* subplots."].join(" ");var s=a({},n.domain,{});function l(e,t){var r={showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:o},visible:{valType:"boolean"}};return a({},t,r)}t.exports=i({radialaxis:l("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:s,orientation:{valType:"number"}}),angularaxis:l("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:s}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":768,"../../../plot_api/edit_types":810,"../../cartesian/layout_attributes":842}],899:[function(e,t,r){"use strict";var n=t.exports=e("./micropolar");n.manager=e("./micropolar_manager")},{"./micropolar":900,"./micropolar_manager":901}],900:[function(e,t,r){var n=e("d3");var a=e("../../../lib");var i=a.extendDeepAll;var o=e("../../../constants/alignment").MID_SHIFT;var s=t.exports={version:"0.2.2"};s.Axis=function e(){var t={data:[],layout:{}},r={},a={};var l,u,c=n.dispatch("hover"),f,h;var p={};function d(e){u=e||u;var r=t.data;var c=t.layout;if(typeof u=="string"||u.nodeName)u=n.select(u);u.datum(r).each(function(e,t){var r=e.slice();a={data:s.util.cloneJson(r),layout:s.util.cloneJson(c)};var u=0;r.forEach(function(e,t){if(!e.color){e.color=c.defaultColorRange[u];u=(u+1)%c.defaultColorRange.length}if(!e.strokeColor){e.strokeColor=e.geometry==="LinePlot"?e.color:n.rgb(e.color).darker().toString()}a.data[t].color=e.color;a.data[t].strokeColor=e.strokeColor;a.data[t].strokeDash=e.strokeDash;a.data[t].strokeSize=e.strokeSize});var p=r.filter(function(e,t){var r=e.visible;return typeof r==="undefined"||r===true});var d=false;var v=p.map(function(e,t){d=d||typeof e.groupId!=="undefined";return e});if(d){var m=n.nest().key(function(e,t){return typeof e.groupId!="undefined"?e.groupId:"unstacked"}).entries(v);var g=[];var y=m.map(function(e,t){if(e.key==="unstacked")return e.values;else{var r=e.values[0].r.map(function(e,t){return 0});e.values.forEach(function(e,t,n){e.yStack=[r];g.push(r);r=s.util.sumArrays(e.r,r)});return e.values}});p=n.merge(y)}p.forEach(function(e,t){e.t=Array.isArray(e.t[0])?e.t:[e.t];e.r=Array.isArray(e.r[0])?e.r:[e.r]});var x=Math.min(c.width-c.margin.left-c.margin.right,c.height-c.margin.top-c.margin.bottom)/2;x=Math.max(10,x);var _=[c.margin.left+x,c.margin.top+x];var b;if(d){var w=n.max(s.util.sumArrays(s.util.arrayLast(p).r[0],s.util.arrayLast(g)));b=[0,w]}else b=n.extent(s.util.flattenArray(p.map(function(e,t){return e.r})));if(c.radialAxis.domain!=s.DATAEXTENT)b[0]=0;f=n.scale.linear().domain(c.radialAxis.domain!=s.DATAEXTENT&&c.radialAxis.domain?c.radialAxis.domain:b).range([0,x]);a.layout.radialAxis.domain=f.domain();var T=s.util.flattenArray(p.map(function(e,t){return e.t}));var k=typeof T[0]==="string";var A;if(k){T=s.util.deduplicate(T);A=T.slice();T=n.range(T.length);p=p.map(function(e,t){var r=e;e.t=[T];if(d)r.yStack=e.yStack;return r})}var M=p.filter(function(e,t){return e.geometry==="LinePlot"||e.geometry==="DotPlot"}).length===p.length;var E=c.needsEndSpacing===null?k||!M:c.needsEndSpacing;var S=c.angularAxis.domain&&c.angularAxis.domain!=s.DATAEXTENT&&!k&&c.angularAxis.domain[0]>=0;var C=S?c.angularAxis.domain:n.extent(T);var L=Math.abs(T[1]-T[0]);if(M&&!k)L=0;var I=C.slice();if(E&&k)I[1]+=L;var O=c.angularAxis.ticksCount||4;if(O>8)O=O/(O/8)+O%8;if(c.angularAxis.ticksStep){O=(I[1]-I[0])/O}var P=c.angularAxis.ticksStep||(I[1]-I[0])/(O*(c.minorTicks+1));if(A)P=Math.max(Math.round(P),1);if(!I[2])I[2]=P;var D=n.range.apply(this,I);D=D.map(function(e,t){return parseFloat(e.toPrecision(12))});h=n.scale.linear().domain(I.slice(0,2)).range(c.direction==="clockwise"?[0,360]:[360,0]);a.layout.angularAxis.domain=h.domain();a.layout.angularAxis.endPadding=E?L:0;l=n.select(this).select("svg.chart-root");if(typeof l==="undefined"||l.empty()){var R="<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>";var z=(new DOMParser).parseFromString(R,"application/xml");var N=this.appendChild(this.ownerDocument.importNode(z.documentElement,true));l=n.select(N)}l.select(".guides-group").style({"pointer-events":"none"});l.select(".angular.axis-group").style({"pointer-events":"none"});l.select(".radial.axis-group").style({"pointer-events":"none"});var F=l.select(".chart-group");var B={fill:"none",stroke:c.tickColor};var j={"font-size":c.font.size,"font-family":c.font.family,fill:c.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e,t){return" "+e+" 0 "+c.font.outlineColor}).join(",")};var U;if(c.showLegend){U=l.select(".legend-group").attr({transform:"translate("+[x,c.margin.top]+")"}).style({display:"block"});var H=p.map(function(e,t){var r=s.util.cloneJson(e);r.symbol=e.geometry==="DotPlot"?e.dotType||"circle":e.geometry!="LinePlot"?"square":"line";r.visibleInLegend=typeof e.visibleInLegend==="undefined"||e.visibleInLegend;r.color=e.geometry==="LinePlot"?e.strokeColor:e.color;return r});s.Legend().config({data:p.map(function(e,t){return e.name||"Element"+t}),legendConfig:i({},s.Legend.defaultConfig().legendConfig,{container:U,elements:H,reverseOrder:c.legend.reverseOrder})})();var V=U.node().getBBox();x=Math.min(c.width-V.width-c.margin.left-c.margin.right,c.height-c.margin.top-c.margin.bottom)/2;x=Math.max(10,x);_=[c.margin.left+x,c.margin.top+x];f.range([0,x]);a.layout.radialAxis.domain=f.domain();U.attr("transform","translate("+[_[0]+x,_[1]-x]+")")}else{U=l.select(".legend-group").style({display:"none"})}l.attr({width:c.width,height:c.height}).style({opacity:c.opacity});F.attr("transform","translate("+_+")").style({cursor:"crosshair"});var G=[(c.width-(c.margin.left+c.margin.right+x*2+(V?V.width:0)))/2,(c.height-(c.margin.top+c.margin.bottom+x*2))/2];G[0]=Math.max(0,G[0]);G[1]=Math.max(0,G[1]);l.select(".outer-group").attr("transform","translate("+G+")");if(c.title&&c.title.text){var q=l.select("g.title-group text").style(j).text(c.title.text);var Y=q.node().getBBox();q.attr({x:_[0]-Y.width/2,y:_[1]-x-20})}var W=l.select(".radial.axis-group");if(c.radialAxis.gridLinesVisible){var X=W.selectAll("circle.grid-circle").data(f.ticks(5));X.enter().append("circle").attr({class:"grid-circle"}).style(B);X.attr("r",f);X.exit().remove()}W.select("circle.outside-circle").attr({r:x}).style(B);var Z=l.select("circle.background-circle").attr({r:x}).style({fill:c.backgroundColor,stroke:c.stroke});function K(e,t){return h(e)%360+c.orientation}if(c.radialAxis.visible){var J=n.svg.axis().scale(f).ticks(5).tickSize(5);W.call(J).attr({transform:"rotate("+c.radialAxis.orientation+")"});W.selectAll(".domain").style(B);W.selectAll("g>text").text(function(e,t){return this.textContent+c.radialAxis.ticksSuffix}).style(j).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(e,t){if(c.radialAxis.tickOrientation==="horizontal"){return"rotate("+-c.radialAxis.orientation+") translate("+[0,j["font-size"]]+")"}else return"translate("+[0,j["font-size"]]+")"}});W.selectAll("g>line").style({stroke:"black"})}var Q=l.select(".angular.axis-group").selectAll("g.angular-tick").data(D);var $=Q.enter().append("g").classed("angular-tick",true);Q.attr({transform:function(e,t){return"rotate("+K(e,t)+")"}}).style({display:c.angularAxis.visible?"block":"none"});Q.exit().remove();$.append("line").classed("grid-line",true).classed("major",function(e,t){return t%(c.minorTicks+1)==0}).classed("minor",function(e,t){return!(t%(c.minorTicks+1)==0)}).style(B);$.selectAll(".minor").style({stroke:c.minorTickColor});Q.select("line.grid-line").attr({x1:c.tickLength?x-c.tickLength:0,x2:x}).style({display:c.angularAxis.gridLinesVisible?"block":"none"});$.append("text").classed("axis-text",true).style(j);var ee=Q.select("text.axis-text").attr({x:x+c.labelOffset,dy:o+"em",transform:function(e,t){var r=K(e,t);var n=x+c.labelOffset;var a=c.angularAxis.tickOrientation;if(a=="horizontal")return"rotate("+-r+" "+n+" 0)";else if(a=="radial")return r<270&&r>90?"rotate(180 "+n+" 0)":null;else return"rotate("+(r<=180&&r>0?-90:90)+" "+n+" 0)"}}).style({"text-anchor":"middle",display:c.angularAxis.labelsVisible?"block":"none"}).text(function(e,t){if(t%(c.minorTicks+1)!=0)return"";if(A){return A[e]+c.angularAxis.ticksSuffix}else return e+c.angularAxis.ticksSuffix}).style(j);if(c.angularAxis.rewriteTicks)ee.text(function(e,t){if(t%(c.minorTicks+1)!=0)return"";return c.angularAxis.rewriteTicks(this.textContent,t)});var te=n.max(F.selectAll(".angular-tick text")[0].map(function(e,t){return e.getCTM().e+e.getBBox().width}));U.attr({transform:"translate("+[x+te,c.margin.top]+")"});var re=l.select("g.geometry-group").selectAll("g").size()>0;var ne=l.select("g.geometry-group").selectAll("g.geometry").data(p);ne.enter().append("g").attr({class:function(e,t){return"geometry geometry"+t}});ne.exit().remove();if(p[0]||re){var ae=[];p.forEach(function(e,t){var r={};r.radialScale=f;r.angularScale=h;r.container=ne.filter(function(e,r){return r==t});r.geometry=e.geometry;r.orientation=c.orientation;r.direction=c.direction;r.index=t;ae.push({data:e,geometryConfig:r})});var ie=n.nest().key(function(e,t){return typeof e.data.groupId!="undefined"||"unstacked"}).entries(ae);var oe=[];ie.forEach(function(e,t){if(e.key==="unstacked")oe=oe.concat(e.values.map(function(e,t){return[e]}));else oe.push(e.values)});oe.forEach(function(e,t){var r;if(Array.isArray(e))r=e[0].geometryConfig.geometry;else r=e.geometryConfig.geometry;var n=e.map(function(e,t){return i(s[r].defaultConfig(),e)});s[r]().config(n)()})}var se=l.select(".guides-group");var le=l.select(".tooltips-group");var ue=s.tooltipPanel().config({container:le,fontSize:8})();var ce=s.tooltipPanel().config({container:le,fontSize:8})();var fe=s.tooltipPanel().config({container:le,hasTick:true})();var he,pe;if(!k){var de=se.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});F.on("mousemove.angular-guide",function(e,t){var r=s.util.getMousePos(Z).angle;de.attr({x2:-x,transform:"rotate("+r+")"}).style({opacity:.5});var n=(r+180+360-c.orientation)%360;he=h.invert(n);var a=s.util.convertToCartesian(x+12,r+180);ue.text(s.util.round(he)).move([a[0]+_[0],a[1]+_[1]])}).on("mouseout.angular-guide",function(e,t){se.select("line").style({opacity:0})})}var ve=se.select("circle").style({stroke:"grey",fill:"none"});F.on("mousemove.radial-guide",function(e,t){var r=s.util.getMousePos(Z).radius;ve.attr({r:r}).style({opacity:.5});pe=f.invert(s.util.getMousePos(Z).radius);var n=s.util.convertToCartesian(r,c.radialAxis.orientation);ce.text(s.util.round(pe)).move([n[0]+_[0],n[1]+_[1]])}).on("mouseout.radial-guide",function(e,t){ve.style({opacity:0});fe.hide();ue.hide();ce.hide()});l.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(e,t){var r=n.select(this);var a=this.style.fill;var i="black";var o=this.style.opacity||1;r.attr({"data-opacity":o});if(a&&a!=="none"){r.attr({"data-fill":a});i=n.hsl(a).darker().toString();r.style({fill:i,opacity:1});var u={t:s.util.round(e[0]),r:s.util.round(e[1])};if(k)u.t=A[e[0]];var c="t: "+u.t+", r: "+u.r;var f=this.getBoundingClientRect();var h=l.node().getBoundingClientRect();var p=[f.left+f.width/2-G[0]-h.left,f.top+f.height/2-G[1]-h.top];fe.config({color:i}).text(c);fe.move(p)}else{a=this.style.stroke||"black";r.attr({"data-stroke":a});i=n.hsl(a).darker().toString();r.style({stroke:i,opacity:1})}}).on("mousemove.tooltip",function(e,t){if(n.event.which!=0)return false;if(n.select(this).attr("data-fill"))fe.show()}).on("mouseout.tooltip",function(e,t){fe.hide();var r=n.select(this);var a=r.attr("data-fill");if(a)r.style({fill:a,opacity:r.attr("data-opacity")});else r.style({stroke:r.attr("data-stroke"),opacity:r.attr("data-opacity")})})});return p}p.render=function(e){d(e);return this};p.config=function(e){if(!arguments.length)return t;var r=s.util.cloneJson(e);r.data.forEach(function(e,r){if(!t.data[r])t.data[r]={};i(t.data[r],s.Axis.defaultConfig().data[0]);i(t.data[r],e)});i(t.layout,s.Axis.defaultConfig().layout);i(t.layout,r.layout);return this};p.getLiveConfig=function(){return a};p.getinputConfig=function(){return r};p.radialScale=function(e){return f};p.angularScale=function(e){return h};p.svg=function(){return l};n.rebind(p,c,"on");return p};s.Axis.defaultConfig=function(e,t){var r={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:true,opacity:1}],layout:{defaultColorRange:n.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:true,gridLinesVisible:true,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:true,gridLinesVisible:true,labelsVisible:true,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:true,legend:{reverseOrder:false},opacity:1}};return r};s.util={};s.DATAEXTENT="dataExtent";s.AREA="AreaChart";s.LINE="LinePlot";s.DOT="DotPlot";s.BAR="BarChart";s.util._override=function(e,t){for(var r in e)if(r in t)t[r]=e[r]};s.util._extend=function(e,t){for(var r in e)t[r]=e[r]};s.util._rndSnd=function(){return Math.random()*2-1+(Math.random()*2-1)+(Math.random()*2-1)};s.util.dataFromEquation2=function(e,t){var r=t||6;var a=n.range(0,360+r,r).map(function(t,r){var n=t*Math.PI/180;var a=e(n);return[t,a]});return a};s.util.dataFromEquation=function(e,t,r){var a=t||6;var i=[],o=[];n.range(0,360+a,a).forEach(function(t,r){var n=t*Math.PI/180;var a=e(n);i.push(t);o.push(a)});var s={t:i,r:o};if(r)s.name=r;return s};s.util.ensureArray=function(e,t){if(typeof e==="undefined")return null;var r=[].concat(e);return n.range(t).map(function(e,t){return r[t]||r[0]})};s.util.fillArrays=function(e,t,r){t.forEach(function(t,n){e[t]=s.util.ensureArray(e[t],r)});return e};s.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))};s.util.validateKeys=function(e,t){if(typeof t==="string")t=t.split(".");var r=t.shift();return e[r]&&(!t.length||objHasKeys(e[r],t))};s.util.sumArrays=function(e,t){return n.zip(e,t).map(function(e,t){return n.sum(e)})};s.util.arrayLast=function(e){return e[e.length-1]};s.util.arrayEqual=function(e,t){var r=Math.max(e.length,t.length,1);while(r-- >=0&&e[r]===t[r]);return r===-2};s.util.flattenArray=function(e){var t=[];while(!s.util.arrayEqual(t,e)){t=e;e=[].concat.apply([],e)}return e};s.util.deduplicate=function(e){return e.filter(function(e,t,r){return r.indexOf(e)==t})};s.util.convertToCartesian=function(e,t){var r=t*Math.PI/180;var n=e*Math.cos(r);var a=e*Math.sin(r);return[n,a]};s.util.round=function(e,t){var r=t||2;var n=Math.pow(10,r);return Math.round(e*n)/n};s.util.getMousePos=function(e){var t=n.mouse(e.node());var r=t[0];var a=t[1];var i={};i.x=r;i.y=a;i.pos=t;i.angle=(Math.atan2(a,r)+Math.PI)*180/Math.PI;i.radius=Math.sqrt(r*r+a*a);return i};s.util.duplicatesCount=function(e){var t={},r;var n={};for(var a=0,i=e.length;a<i;a++){r=e[a];if(r in t){t[r]++;n[r]=t[r]}else{t[r]=1}}return n};s.util.duplicates=function(e){return Object.keys(s.util.duplicatesCount(e))};s.util.translator=function(e,t,r,n){if(n){var a=r.slice();r=t;t=a}var i=t.reduce(function(e,t){if(typeof e!="undefined")return e[t]},e);if(typeof i==="undefined")return;t.reduce(function(e,r,n){if(typeof e=="undefined")return;if(n===t.length-1)delete e[r];return e[r]},e);r.reduce(function(e,t,n){if(typeof e[t]==="undefined")e[t]={};if(n===r.length-1)e[t]=i;return e[t]},e)};s.PolyChart=function e(){var t=[s.PolyChart.defaultConfig()];var r=n.dispatch("hover");var a={solid:"none",dash:[5,2],dot:[2,5]};var o;function l(){var e=t[0].geometryConfig;var r=e.container;if(typeof r=="string")r=n.select(r);r.datum(t).each(function(t,r){var i=!!t[0].data.yStack;var o=t.map(function(e,t){if(i)return n.zip(e.data.t[0],e.data.r[0],e.data.yStack[0]);else return n.zip(e.data.t[0],e.data.r[0])});var s=e.angularScale;var l=e.radialScale.domain()[0];var u={};u.bar=function(r,a,i){var o=t[i].data;var l=e.radialScale(r[1])-e.radialScale(0);var u=e.radialScale(r[2]||0);var c=o.barWidth;n.select(this).attr({class:"mark bar",d:"M"+[[l+u,-c/2],[l+u,c/2],[u,c/2],[u,-c/2]].join("L")+"Z",transform:function(t,r){return"rotate("+(e.orientation+s(t[0]))+")"}})};u.dot=function(e,r,a){var i=e[2]?[e[0],e[1]+e[2]]:e;var o=n.svg.symbol().size(t[a].data.dotSize).type(t[a].data.dotType)(e,r);n.select(this).attr({class:"mark dot",d:o,transform:function(e,t){var r=y(g(i));return"translate("+[r.x,r.y]+")"}})};var c=n.svg.line.radial().interpolate(t[0].data.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*Math.PI/180});u.line=function(r,a,i){var s=r[2]?o[i].map(function(e,t){return[e[0],e[1]+e[2]]}):o[i];n.select(this).each(u["dot"]).style({opacity:function(e,r){return+t[i].data.dotVisible},fill:d.stroke(r,a,i)}).attr({class:"mark dot"});if(a>0)return;var l=n.select(this.parentNode).selectAll("path.line").data([0]);l.enter().insert("path");l.attr({class:"line",d:c(s),transform:function(t,r){return"rotate("+(e.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(e,t){return d.fill(r,a,i)},"fill-opacity":0,stroke:function(e,t){return d.stroke(r,a,i)},"stroke-width":function(e,t){return d["stroke-width"](r,a,i)},"stroke-dasharray":function(e,t){return d["stroke-dasharray"](r,a,i)},opacity:function(e,t){return d.opacity(r,a,i)},display:function(e,t){return d.display(r,a,i)}})};var f=e.angularScale.range();var h=Math.abs(f[1]-f[0])/o[0].length*Math.PI/180;var p=n.svg.arc().startAngle(function(e){return-h/2}).endAngle(function(e){return h/2}).innerRadius(function(t){return e.radialScale(l+(t[2]||0))}).outerRadius(function(t){return e.radialScale(l+(t[2]||0))+e.radialScale(t[1])});u.arc=function(t,r,a){n.select(this).attr({class:"mark arc",d:p,transform:function(t,r){return"rotate("+(e.orientation+s(t[0])+90)+")"}})};var d={fill:function(e,r,n){return t[n].data.color},stroke:function(e,r,n){return t[n].data.strokeColor},"stroke-width":function(e,r,n){return t[n].data.strokeSize+"px"},"stroke-dasharray":function(e,r,n){return a[t[n].data.strokeDash]},opacity:function(e,r,n){return t[n].data.opacity},display:function(e,r,n){return typeof t[n].data.visible==="undefined"||t[n].data.visible?"block":"none"}};var v=n.select(this).selectAll("g.layer").data(o);v.enter().append("g").attr({class:"layer"});var m=v.selectAll("path.mark").data(function(e,t){return e});m.enter().append("path").attr({class:"mark"});m.style(d).each(u[e.geometryType]);m.exit().remove();v.exit().remove();function g(t,r){var n=e.radialScale(t[1]);var a=(e.angularScale(t[0])+e.orientation)*Math.PI/180;return{r:n,t:a}}function y(e){var t=e.r*Math.cos(e.t);var r=e.r*Math.sin(e.t);return{x:t,y:r}}})}l.config=function(e){if(!arguments.length)return t;e.forEach(function(e,r){if(!t[r])t[r]={};i(t[r],s.PolyChart.defaultConfig());i(t[r],e)});return this};l.getColorScale=function(){return o};n.rebind(l,r,"on");return l};s.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:false,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:true,visibleInLegend:true},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:n.scale.category20()}};return e};s.BarChart=function e(){return s.PolyChart()};s.BarChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"bar"}};return e};s.AreaChart=function e(){return s.PolyChart()};s.AreaChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"arc"}};return e};s.DotPlot=function e(){return s.PolyChart()};s.DotPlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"dot",dotType:"circle"}};return e};s.LinePlot=function e(){return s.PolyChart()};s.LinePlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"line"}};return e};s.Legend=function e(){var t=s.Legend.defaultConfig();var r=n.dispatch("hover");function a(){var e=t.legendConfig;var r=t.data.map(function(t,r){return[].concat(t).map(function(t,n){var a=i({},e.elements[r]);a.name=t;a.color=[].concat(e.elements[r].color)[n];return a})});var o=n.merge(r);o=o.filter(function(t,r){return e.elements[r]&&(e.elements[r].visibleInLegend||typeof e.elements[r].visibleInLegend==="undefined")});if(e.reverseOrder)o=o.reverse();var s=e.container;if(typeof s=="string"||s.nodeName)s=n.select(s);var l=o.map(function(e,t){return e.color});var u=e.fontSize;var c=e.isContinuous==null?typeof o[0]==="number":e.isContinuous;var f=c?e.height:u*o.length;var h=s.classed("legend-group",true);var p=h.selectAll("svg").data([0]);var d=p.enter().append("svg").attr({width:300,height:f+u,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});d.append("g").classed("legend-axis",true);d.append("g").classed("legend-marks",true);var v=n.range(o.length);var m=n.scale[c?"linear":"ordinal"]().domain(v).range(l);var g=n.scale[c?"linear":"ordinal"]().domain(v)[c?"range":"rangePoints"]([0,f]);var y=function(e,t){var r=t*3;if(e==="line"){return"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z"}else if(n.svg.symbolTypes.indexOf(e)!=-1)return n.svg.symbol().type(e).size(r)();else return n.svg.symbol().type("square").size(r)()};if(c){var x=p.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(l);x.enter().append("stop");x.attr({offset:function(e,t){return t/(l.length-1)*100+"%"}}).style({"stop-color":function(e,t){return e}});p.append("rect").classed("legend-mark",true).attr({height:e.height,width:e.colorBandWidth,fill:"url(#grad1)"})}else{var _=p.select(".legend-marks").selectAll("path.legend-mark").data(o);_.enter().append("path").classed("legend-mark",true);_.attr({transform:function(e,t){return"translate("+[u/2,g(t)+u/2]+")"},d:function(e,t){var r=e.symbol;return y(r,u)},fill:function(e,t){return m(t)}});_.exit().remove()}var b=n.svg.axis().scale(g).orient("right");var w=p.select("g.legend-axis").attr({transform:"translate("+[c?e.colorBandWidth:u,u/2]+")"}).call(b);w.selectAll(".domain").style({fill:"none",stroke:"none"});w.selectAll("line").style({fill:"none",stroke:c?e.textColor:"none"});w.selectAll("text").style({fill:e.textColor,"font-size":e.fontSize}).text(function(e,t){return o[t].name});return a}a.config=function(e){if(!arguments.length)return t;i(t,e);return this};n.rebind(a,r,"on");return a};s.Legend.defaultConfig=function(e,t){var r={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:false}};return r};s.tooltipPanel=function(){var e,t,r;var a={container:null,hasTick:false,fontSize:12,color:"white",padding:5};var o="tooltip-"+s.tooltipPanel.uid++;var l=10;var u=function(){e=a.container.selectAll("g."+o).data([0]);var n=e.enter().append("g").classed(o,true).style({"pointer-events":"none",display:"none"});r=n.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"});t=n.append("text").attr({dx:a.padding+l,dy:+a.fontSize*.3});return u};u.text=function(i){var o=n.hsl(a.color).l;var s=o>=.5?"#aaa":"white";var c=o>=.5?"black":"white";var f=i||"";t.style({fill:c,"font-size":a.fontSize+"px"}).text(f);var h=a.padding;var p=t.node().getBBox();var d={fill:a.color,stroke:s,"stroke-width":"2px"};var v=p.width+h*2+l;var m=p.height+h*2;r.attr({d:"M"+[[l,-m/2],[l,-m/4],[a.hasTick?0:l,0],[l,m/4],[l,m/2],[v,m/2],[v,-m/2]].join("L")+"Z"}).style(d);e.attr({transform:"translate("+[l,-m/2+h*2]+")"});e.style({display:"block"});return u};u.move=function(t){if(!e)return;e.attr({transform:"translate("+[t[0],t[1]]+")"}).style({display:"block"});return u};u.hide=function(){if(!e)return;e.style({display:"none"});return u};u.show=function(){if(!e)return;e.style({display:"block"});return u};u.config=function(e){i(a,e);return u};return u};s.tooltipPanel.uid=1;s.adapter={};s.adapter.plotly=function e(){var t={};t.convert=function(e,t){var r={};if(e.data){r.data=e.data.map(function(e,r){var n=i({},e);var a=[[n,["marker","color"],["color"]],[n,["marker","opacity"],["opacity"]],[n,["marker","line","color"],["strokeColor"]],[n,["marker","line","dash"],["strokeDash"]],[n,["marker","line","width"],["strokeSize"]],[n,["marker","symbol"],["dotType"]],[n,["marker","size"],["dotSize"]],[n,["marker","barWidth"],["barWidth"]],[n,["line","interpolation"],["lineInterpolation"]],[n,["showlegend"],["visibleInLegend"]]];a.forEach(function(e,r){s.util.translator.apply(null,e.concat(t))});if(!t)delete n.marker;if(t)delete n.groupId;if(!t){if(n.type==="scatter"){if(n.mode==="lines")n.geometry="LinePlot";else if(n.mode==="markers")n.geometry="DotPlot";else if(n.mode==="lines+markers"){n.geometry="LinePlot";n.dotVisible=true}}else if(n.type==="area")n.geometry="AreaChart";else if(n.type==="bar")n.geometry="BarChart";delete n.mode;delete n.type}else{if(n.geometry==="LinePlot"){n.type="scatter";if(n.dotVisible===true){delete n.dotVisible;n.mode="lines+markers"}else n.mode="lines"}else if(n.geometry==="DotPlot"){n.type="scatter";n.mode="markers"}else if(n.geometry==="AreaChart")n.type="area";else if(n.geometry==="BarChart")n.type="bar";delete n.geometry}return n});if(!t&&e.layout&&e.layout.barmode==="stack"){var a=s.util.duplicates(r.data.map(function(e,t){return e.geometry}));r.data.forEach(function(e,t){var n=a.indexOf(e.geometry);if(n!=-1)r.data[t].groupId=n})}}if(e.layout){var o=i({},e.layout);var l=[[o,["plot_bgcolor"],["backgroundColor"]],[o,["showlegend"],["showLegend"]],[o,["radialaxis"],["radialAxis"]],[o,["angularaxis"],["angularAxis"]],[o.angularaxis,["showline"],["gridLinesVisible"]],[o.angularaxis,["showticklabels"],["labelsVisible"]],[o.angularaxis,["nticks"],["ticksCount"]],[o.angularaxis,["tickorientation"],["tickOrientation"]],[o.angularaxis,["ticksuffix"],["ticksSuffix"]],[o.angularaxis,["range"],["domain"]],[o.angularaxis,["endpadding"],["endPadding"]],[o.radialaxis,["showline"],["gridLinesVisible"]],[o.radialaxis,["tickorientation"],["tickOrientation"]],[o.radialaxis,["ticksuffix"],["ticksSuffix"]],[o.radialaxis,["range"],["domain"]],[o.angularAxis,["showline"],["gridLinesVisible"]],[o.angularAxis,["showticklabels"],["labelsVisible"]],[o.angularAxis,["nticks"],["ticksCount"]],[o.angularAxis,["tickorientation"],["tickOrientation"]],[o.angularAxis,["ticksuffix"],["ticksSuffix"]],[o.angularAxis,["range"],["domain"]],[o.angularAxis,["endpadding"],["endPadding"]],[o.radialAxis,["showline"],["gridLinesVisible"]],[o.radialAxis,["tickorientation"],["tickOrientation"]],[o.radialAxis,["ticksuffix"],["ticksSuffix"]],[o.radialAxis,["range"],["domain"]],[o.font,["outlinecolor"],["outlineColor"]],[o.legend,["traceorder"],["reverseOrder"]],[o,["labeloffset"],["labelOffset"]],[o,["defaultcolorrange"],["defaultColorRange"]]];l.forEach(function(e,r){s.util.translator.apply(null,e.concat(t))});if(!t){if(o.angularAxis&&typeof o.angularAxis.ticklen!=="undefined")o.tickLength=o.angularAxis.ticklen;if(o.angularAxis&&typeof o.angularAxis.tickcolor!=="undefined")o.tickColor=o.angularAxis.tickcolor}else{if(typeof o.tickLength!=="undefined"){o.angularaxis.ticklen=o.tickLength;delete o.tickLength}if(o.tickColor){o.angularaxis.tickcolor=o.tickColor;delete o.tickColor}}if(o.legend&&typeof o.legend.reverseOrder!="boolean"){o.legend.reverseOrder=o.legend.reverseOrder!="normal"}if(o.legend&&typeof o.legend.traceorder=="boolean"){o.legend.traceorder=o.legend.traceorder?"reversed":"normal";delete o.legend.reverseOrder}if(o.margin&&typeof o.margin.t!="undefined"){var u=["t","r","b","l","pad"];var c=["top","right","bottom","left","pad"];var f={};n.entries(o.margin).forEach(function(e,t){f[c[u.indexOf(e.key)]]=e.value});o.margin=f}if(t){delete o.needsEndSpacing;delete o.minorTickColor;delete o.minorTicks;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksStep;delete o.angularaxis.rewriteTicks;delete o.angularaxis.nticks;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksStep;delete o.radialaxis.rewriteTicks;delete o.radialaxis.nticks}r.layout=o}return r};return t}},{"../../../constants/alignment":745,"../../../lib":778,d3:169}],901:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../../lib");var i=e("../../../components/color");var o=e("./micropolar");var s=e("./undo_manager");var l=a.extendDeepAll;var u=t.exports={};u.framework=function(e){var t,r,a,i,c;var f=new s;function h(r,s){if(s)c=s;n.select(n.select(c).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove();t=!t?r:l(t,r);if(!a)a=o.Axis();i=o.adapter.plotly().convert(t);a.config(i).render(c);e.data=t.data;e.layout=t.layout;u.fillLayout(e);return t}h.isPolar=true;h.svg=function(){return a.svg()};h.getConfig=function(){return t};h.getLiveConfig=function(){return o.adapter.plotly().convert(a.getLiveConfig(),true)};h.getLiveScales=function(){return{t:a.angularScale(),r:a.radialScale()}};h.setUndoPoint=function(){var e=this;var n=o.util.cloneJson(t);(function(t,r){f.add({undo:function(){if(r)e(r)},redo:function(){e(t)}})})(n,r);r=o.util.cloneJson(n)};h.undo=function(){f.undo()};h.redo=function(){f.redo()};return h};u.fillLayout=function(e){var t=n.select(e).selectAll(".plot-container");var r=t.selectAll(".svg-container");var a=e.framework&&e.framework.svg&&e.framework.svg();var o={width:800,height:600,paper_bgcolor:i.background,_container:t,_paperdiv:r,_paper:a};e._fullLayout=l(o,e.layout)}},{"../../../components/color":643,"../../../lib":778,"./micropolar":900,"./undo_manager":902,d3:169}],902:[function(e,t,r){"use strict";t.exports=function e(){var t=[];var r=-1;var n=false;var a;function i(e,t){if(!e)return this;n=true;e[t]();n=false;return this}return{add:function(e){if(n)return this;t.splice(r+1,t.length-r);t.push(e);r=t.length-1;return this},setCallback:function(e){a=e},undo:function(){var e=t[r];if(!e)return this;i(e,"undo");r-=1;if(a)a(e.undo);return this},redo:function(){var e=t[r+1];if(!e)return this;i(e,"redo");r+=1;if(a)a(e.redo);return this},clear:function(){t=[];r=-1},hasUndo:function(){return r!==-1},hasRedo:function(){return r<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[r-1]},getIndex:function(){return r}}}},{}],903:[function(e,t,r){"use strict";var n=e("d3");var a=e("tinycolor2");var i=e("../../registry");var o=e("../../lib");var s=o.strRotate;var l=o.strTranslate;var u=e("../../components/color");var c=e("../../components/drawing");var f=e("../plots");var h=e("../../plots/cartesian/axes");var p=e("../cartesian/set_convert");var d=e("./set_convert");var v=e("../cartesian/autorange").doAutoRange;var m=e("../cartesian/dragbox");var g=e("../../components/dragelement");var y=e("../../components/fx");var x=e("../../components/titles");var _=e("../cartesian/select").prepSelect;var b=e("../cartesian/select").selectOnClick;var w=e("../cartesian/select").clearSelect;var T=e("../../lib/setcursor");var k=e("../../lib/clear_gl_canvases");var A=e("../../plot_api/subroutines").redrawReglTraces;var M=e("../../constants/alignment").MID_SHIFT;var E=e("./constants");var S=e("./helpers");var C=o._;var L=o.mod;var I=o.deg2rad;var O=o.rad2deg;function P(e,t){this.id=t;this.gd=e;this._hasClipOnAxisFalse=null;this.vangles=null;this.radialAxisAngle=null;this.traceHash={};this.layers={};this.clipPaths={};this.clipIds={};this.viewInitial={};var r=e._fullLayout;var n="clip"+r._uid+t;this.clipIds.forTraces=n+"-for-traces";this.clipPaths.forTraces=r._clips.append("clipPath").attr("id",this.clipIds.forTraces);this.clipPaths.forTraces.append("path");this.framework=r._polarlayer.append("g").attr("class",t);this.radialTickLayout=null;this.angularTickLayout=null}var D=P.prototype;t.exports=function e(t,r){return new P(t,r)};D.plot=function(e,t){var r=this;var n=t[r.id];r._hasClipOnAxisFalse=false;for(var a=0;a<e.length;a++){var i=e[a][0].trace;if(i.cliponaxis===false){r._hasClipOnAxisFalse=true;break}}r.updateLayers(t,n);r.updateLayout(t,n);f.generalUpdatePerTraceModule(r.gd,r,e,n);r.updateFx(t,n)};D.updateLayers=function(e,t){var r=this;var a=r.layers;var i=t.radialaxis;var o=t.angularaxis;var s=E.layerNames;var l=s.indexOf("frontplot");var u=s.slice(0,l);var c=o.layer==="below traces";var f=i.layer==="below traces";if(c)u.push("angular-line");if(f)u.push("radial-line");if(c)u.push("angular-axis");if(f)u.push("radial-axis");u.push("frontplot");if(!c)u.push("angular-line");if(!f)u.push("radial-line");if(!c)u.push("angular-axis");if(!f)u.push("radial-axis");var h=r.framework.selectAll(".polarsublayer").data(u,String);h.enter().append("g").attr("class",function(e){return"polarsublayer "+e}).each(function(e){var t=a[e]=n.select(this);switch(e){case"frontplot":t.append("g").classed("barlayer",true);t.append("g").classed("scatterlayer",true);break;case"backplot":t.append("g").classed("maplayer",true);break;case"plotbg":a.bg=t.append("path");break;case"radial-grid":t.style("fill","none");break;case"angular-grid":t.style("fill","none");break;case"radial-line":t.append("line").style("fill","none");break;case"angular-line":t.append("path").style("fill","none");break}});h.order()};D.updateLayout=function(e,t){var r=this;var n=r.layers;var a=e._size;var i=t.radialaxis;var o=t.angularaxis;var s=t.domain.x;var f=t.domain.y;r.xOffset=a.l+a.w*s[0];r.yOffset=a.t+a.h*(1-f[1]);var h=r.xLength=a.w*(s[1]-s[0]);var p=r.yLength=a.h*(f[1]-f[0]);var d=t.sector;r.sectorInRad=d.map(I);var v=r.sectorBBox=z(d);var m=v[2]-v[0];var g=v[3]-v[1];var y=p/h;var x=Math.abs(g/m);var _,b;var w,T;var k;if(y>x){_=h;b=h*x;k=(p-b)/a.h/2;w=[s[0],s[1]];T=[f[0]+k,f[1]-k]}else{_=p/x;b=p;k=(h-_)/a.w/2;w=[s[0]+k,s[1]-k];T=[f[0],f[1]]}r.xLength2=_;r.yLength2=b;r.xDomain2=w;r.yDomain2=T;var A=r.xOffset2=a.l+a.w*w[0];var M=r.yOffset2=a.t+a.h*(1-T[1]);var E=r.radius=_/m;var S=r.innerRadius=t.hole*E;var C=r.cx=A-E*v[0];var L=r.cy=M+E*v[3];var O=r.cxx=C-A;var P=r.cyy=L-M;r.radialAxis=r.mockAxis(e,t,i,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[i.side],_realSide:i.side,domain:[S/a.w,E/a.w]});r.angularAxis=r.mockAxis(e,t,o,{side:"right",domain:[0,Math.PI],autorange:false});r.doAutoRange(e,t);r.updateAngularAxis(e,t);r.updateRadialAxis(e,t);r.updateRadialAxisTitle(e,t);r.xaxis=r.mockCartesianAxis(e,t,{_id:"x",domain:w});r.yaxis=r.mockCartesianAxis(e,t,{_id:"y",domain:T});var D=r.pathSubplot();r.clipPaths.forTraces.select("path").attr("d",D).attr("transform",l(O,P));n.frontplot.attr("transform",l(A,M)).call(c.setClipUrl,r._hasClipOnAxisFalse?null:r.clipIds.forTraces,r.gd);n.bg.attr("d",D).attr("transform",l(C,L)).call(u.fill,t.bgcolor)};D.mockAxis=function(e,t,r,n){var a=o.extendFlat({},r,n);d(a,t,e);return a};D.mockCartesianAxis=function(e,t,r){var n=this;var a=r._id;var i=o.extendFlat({type:"linear"},r);p(i,e);var s={x:[0,2],y:[1,3]};i.setRange=function(){var e=n.sectorBBox;var r=s[a];var o=n.radialAxis._rl;var l=(o[1]-o[0])/(1-t.hole);i.range=[e[r[0]]*l,e[r[1]]*l]};i.isPtWithinRange=a==="x"?function(e){return n.isPtInside(e)}:function(){return true};i.setRange();i.setScale();return i};D.doAutoRange=function(e,t){var r=this.gd;var n=this.radialAxis;var a=t.radialaxis;n.setScale();v(r,n);var i=n.range;a.range=i.slice();a._input.range=i.slice();n._rl=[n.r2l(i[0],null,"gregorian"),n.r2l(i[1],null,"gregorian")]};D.updateRadialAxis=function(e,t){var r=this;var n=r.gd;var a=r.layers;var i=r.radius;var c=r.innerRadius;var f=r.cx;var p=r.cy;var d=t.radialaxis;var v=L(t.sector[0],360);var m=r.radialAxis;var g=c<i;r.fillViewInitialKey("radialaxis.angle",d.angle);r.fillViewInitialKey("radialaxis.range",m.range.slice());m.setGeometry();if(m.tickangle==="auto"&&(v>90&&v<=270)){m.tickangle=180}var y=function(e){return l(m.l2p(e.x)+c,0)};var x=function(e){return r.pathArc(m.r2p(e.x)+c)};var _=R(d);if(r.radialTickLayout!==_){a["radial-axis"].selectAll(".xtick").remove();r.radialTickLayout=_}if(g){m.setScale();var b=h.calcTicks(m);var w=h.clipEnds(m,b);var T=h.getTickSigns(m)[2];h.drawTicks(n,m,{vals:b,layer:a["radial-axis"],path:h.makeTickPath(m,0,T),transFn:y,crisp:false});h.drawGrid(n,m,{vals:w,layer:a["radial-grid"],path:x,transFn:o.noop,crisp:false});h.drawLabels(n,m,{vals:b,layer:a["radial-axis"],transFn:y,labelFns:h.makeLabelFns(m,0)})}var k=r.radialAxisAngle=r.vangles?O(N(I(d.angle),r.vangles)):d.angle;var A=l(f,p);var M=A+s(-k);F(a["radial-axis"],g&&(d.showticklabels||d.ticks),{transform:M});F(a["radial-grid"],g&&d.showgrid,{transform:A});F(a["radial-line"].select("line"),g&&d.showline,{x1:c,y1:0,x2:i,y2:0,transform:M}).attr("stroke-width",d.linewidth).call(u.stroke,d.linecolor)};D.updateRadialAxisTitle=function(e,t,r){var n=this;var a=n.gd;var i=n.radius;var o=n.cx;var s=n.cy;var l=t.radialaxis;var u=n.id+"title";var f=r!==undefined?r:n.radialAxisAngle;var h=I(f);var p=Math.cos(h);var d=Math.sin(h);var v=0;if(l.title){var m=c.bBox(n.layers["radial-axis"].node()).height;var g=l.title.font.size;v=l.side==="counterclockwise"?-m-g*.4:m+g*.8}n.layers["radial-axis-title"]=x.draw(a,u,{propContainer:l,propName:n.id+".radialaxis.title",placeholder:C(a,"Click to enter radial axis title"),attributes:{x:o+i/2*p+v*d,y:s-i/2*d+v*p,"text-anchor":"middle"},transform:{rotate:-f}})};D.updateAngularAxis=function(e,t){var r=this;var n=r.gd;var a=r.layers;var i=r.radius;var c=r.innerRadius;var f=r.cx;var p=r.cy;var d=t.angularaxis;var v=r.angularAxis;r.fillViewInitialKey("angularaxis.rotation",d.rotation);v.setGeometry();v.setScale();var m=function(e){return v.t2g(e.x)};if(v.type==="linear"&&v.thetaunit==="radians"){v.tick0=O(v.tick0);v.dtick=O(v.dtick)}var g=function(e){return l(f+i*Math.cos(e),p-i*Math.sin(e))};var y=function(e){return g(m(e))};var x=function(e){var t=m(e);return g(t)+s(-O(t))};var _=function(e){var t=m(e);var r=Math.cos(t);var n=Math.sin(t);return"M"+[f+c*r,p-c*n]+"L"+[f+i*r,p-i*n]};var b=h.makeLabelFns(v,0);var w=b.labelStandoff;var T={};T.xFn=function(e){var t=m(e);return Math.cos(t)*w};T.yFn=function(e){var t=m(e);var r=Math.sin(t)>0?.2:1;return-Math.sin(t)*(w+e.fontSize*r)+Math.abs(Math.cos(t))*(e.fontSize*M)};T.anchorFn=function(e){var t=m(e);var r=Math.cos(t);return Math.abs(r)<.1?"middle":r>0?"start":"end"};T.heightFn=function(e,t,r){var n=m(e);return-.5*(1+Math.sin(n))*r};var k=R(d);if(r.angularTickLayout!==k){a["angular-axis"].selectAll("."+v._id+"tick").remove();r.angularTickLayout=k}var A=h.calcTicks(v);var E;if(t.gridshape==="linear"){E=A.map(m);if(o.angleDelta(E[0],E[1])<0){E=E.slice().reverse()}}else{E=null}r.vangles=E;if(v.type==="category"){A=A.filter(function(e){return o.isAngleInsideSector(m(e),r.sectorInRad)})}if(v.visible){var S=v.ticks==="inside"?-1:1;var C=(v.linewidth||1)/2;h.drawTicks(n,v,{vals:A,layer:a["angular-axis"],path:"M"+S*C+",0h"+S*v.ticklen,transFn:x,crisp:false});h.drawGrid(n,v,{vals:A,layer:a["angular-grid"],path:_,transFn:o.noop,crisp:false});h.drawLabels(n,v,{vals:A,layer:a["angular-axis"],repositionOnUpdate:true,transFn:y,labelFns:T})}F(a["angular-line"].select("path"),d.showline,{d:r.pathSubplot(),transform:l(f,p)}).attr("stroke-width",d.linewidth).call(u.stroke,d.linecolor)};D.updateFx=function(e,t){if(!this.gd._context.staticPlot){this.updateAngularDrag(e);this.updateRadialDrag(e,t,0);this.updateRadialDrag(e,t,1);this.updateMainDrag(e)}};D.updateMainDrag=function(e){var t=this;var r=t.gd;var s=t.layers;var u=e._zoomlayer;var c=E.MINZOOM;var f=E.OFFEDGE;var h=t.radius;var p=t.innerRadius;var d=t.cx;var v=t.cy;var x=t.cxx;var T=t.cyy;var k=t.sectorInRad;var A=t.vangles;var M=t.radialAxis;var C=S.clampTiny;var L=S.findXYatLength;var I=S.findEnclosingVertexAngles;var O=E.cornerHalfWidth;var P=E.cornerLen/2;var D;var R;var z=m.makeDragger(s,"path","maindrag","crosshair");n.select(z).attr("d",t.pathSubplot()).attr("transform",l(d,v));var N={element:z,gd:r,subplot:t.id,plotinfo:{id:t.id,xaxis:t.xaxis,yaxis:t.yaxis},xaxes:[t.xaxis],yaxes:[t.yaxis]};var F,B;var j,U;var H,V,G;var q,Y;function W(e,t){return Math.sqrt(e*e+t*t)}function X(e,t){return W(e-x,t-T)}function Z(e,t){return Math.atan2(T-t,e-x)}function K(e,t){return[e*Math.cos(t),e*Math.sin(-t)]}function J(e,r){if(e===0)return t.pathSector(2*O);var n=P/e;var a=r-n;var i=r+n;var o=Math.max(0,Math.min(e,h));var s=o-O;var l=o+O;return"M"+K(s,a)+"A"+[s,s]+" 0,0,0 "+K(s,i)+"L"+K(l,i)+"A"+[l,l]+" 0,0,1 "+K(l,a)+"Z"}function Q(e,r,n){if(e===0)return t.pathSector(2*O);var a=K(e,r);var i=K(e,n);var o=C((a[0]+i[0])/2);var s=C((a[1]+i[1])/2);var l,u;if(o&&s){var c=s/o;var f=-1/c;var h=L(O,c,o,s);l=L(P,f,h[0][0],h[0][1]);u=L(P,f,h[1][0],h[1][1])}else{var p,d;if(s){p=P;d=O}else{p=O;d=P}l=[[o-p,s-d],[o+p,s-d]];u=[[o-p,s+d],[o+p,s+d]]}return"M"+l.join("L")+"L"+u.reverse().join("L")+"Z"}function $(){j=null;U=null;H=t.pathSubplot();V=false;var e=r._fullLayout[t.id];G=a(e.bgcolor).getLuminance();q=m.makeZoombox(u,G,d,v,H);q.attr("fill-rule","evenodd");Y=m.makeCorners(u,d,v);w(r)}function ee(e,t){t=Math.max(Math.min(t,h),p);if(e<f)e=0;else if(h-e<f)e=h;else if(t<f)t=0;else if(h-t<f)t=h;if(Math.abs(t-e)>c){if(e<t){j=e;U=t}else{j=t;U=e}return true}else{j=null;U=null;return false}}function te(e,t){e=e||H;t=t||"M0,0Z";q.attr("d",e);Y.attr("d",t);m.transitionZoombox(q,Y,V,G);V=true;var n={};oe(n);r.emit("plotly_relayouting",n)}function re(e,r){e=e*D;r=r*R;var n=F+e;var a=B+r;var i=X(F,B);var o=Math.min(X(n,a),h);var s=Z(F,B);var l;var u;if(ee(i,o)){l=H+t.pathSector(U);if(j)l+=t.pathSector(j);u=J(j,s)+J(U,s)}te(l,u)}function ne(e,t,r,n){var a=S.findIntersectionXY(r,n,r,[e-x,T-t]);return W(a[0],a[1])}function ae(e,r){var n=F+e;var a=B+r;var i=Z(F,B);var o=Z(n,a);var s=I(i,A);var l=I(o,A);var u=ne(F,B,s[0],s[1]);var c=Math.min(ne(n,a,l[0],l[1]),h);var f;var p;if(ee(u,c)){f=H+t.pathSector(U);if(j)f+=t.pathSector(j);p=[Q(j,s[0],s[1]),Q(U,s[0],s[1])].join(" ")}te(f,p)}function ie(){m.removeZoombox(r);if(j===null||U===null)return;var e={};oe(e);m.showDoubleClickNotifier(r);i.call("_guiRelayout",r,e)}function oe(e){var r=M._rl;var n=(r[1]-r[0])/(1-p/h)/h;var a=[r[0]+(j-p)*n,r[0]+(U-p)*n];e[t.id+".radialaxis.range"]=a}function se(e,n){var a=r._fullLayout.clickmode;m.removeZoombox(r);if(e===2){var o={};for(var s in t.viewInitial){o[t.id+"."+s]=t.viewInitial[s]}r.emit("plotly_doubleclick",null);i.call("_guiRelayout",r,o)}if(a.indexOf("select")>-1&&e===1){b(n,r,[t.xaxis],[t.yaxis],t.id,N)}if(a.indexOf("event")>-1){y.click(r,n,t.id)}}N.prepFn=function(e,t,n){var a=r._fullLayout.dragmode;var i=z.getBoundingClientRect();r._fullLayout._calcInverseTransform(r);var s=r._fullLayout._invTransform;D=r._fullLayout._invScaleX;R=r._fullLayout._invScaleY;var l=o.apply3DTransform(s)(t-i.left,n-i.top);F=l[0];B=l[1];if(A){var u=S.findPolygonOffset(h,k[0],k[1],A);F+=x+u[0];B+=T+u[1]}switch(a){case"zoom":if(A){N.moveFn=ae}else{N.moveFn=re}N.clickFn=se;N.doneFn=ie;$(e,t,n);break;case"select":case"lasso":_(e,t,n,N,a);break}};z.onmousemove=function(e){y.hover(r,e,t.id);r._fullLayout._lasthover=z;r._fullLayout._hoversubplot=t.id};z.onmouseout=function(e){if(r._dragging)return;g.unhover(r,e)};g.init(N)};D.updateRadialDrag=function(e,t,r){var a=this;var u=a.gd;var c=a.layers;var f=a.radius;var h=a.innerRadius;var p=a.cx;var d=a.cy;var v=a.radialAxis;var y=E.radialDragBoxSize;var x=y/2;if(!v.visible)return;var _=I(a.radialAxisAngle);var b=v._rl;var T=b[0];var M=b[1];var S=b[r];var C=.75*(b[1]-b[0])/(1-t.hole)/f;var L,P,D;if(r){L=p+(f+x)*Math.cos(_);P=d-(f+x)*Math.sin(_);D="radialdrag"}else{L=p+(h-x)*Math.cos(_);P=d-(h-x)*Math.sin(_);D="radialdrag-inner"}var R=m.makeRectDragger(c,D,"crosshair",-x,-x,y,y);var z={element:R,gd:u};F(n.select(R),v.visible&&h<f,{transform:l(L,P)});var B;var j;var U;function H(e,t){if(B){B(e,t)}else{var r=[e,-t];var n=[Math.cos(_),Math.sin(_)];var a=Math.abs(o.dot(r,n)/Math.sqrt(o.dot(r,r)));if(!isNaN(a)){B=a<.5?q:Y}}var i={};V(i);u.emit("plotly_relayouting",i)}function V(e){if(j!==null){e[a.id+".radialaxis.angle"]=j}else if(U!==null){e[a.id+".radialaxis.range["+r+"]"]=U}}function G(){if(j!==null){i.call("_guiRelayout",u,a.id+".radialaxis.angle",j)}else if(U!==null){i.call("_guiRelayout",u,a.id+".radialaxis.range["+r+"]",U)}}function q(e,t){if(r===0)return;var n=L+e;var i=P+t;j=Math.atan2(d-i,n-p);if(a.vangles)j=N(j,a.vangles);j=O(j);var o=l(p,d)+s(-j);c["radial-axis"].attr("transform",o);c["radial-line"].select("line").attr("transform",o);var u=a.gd._fullLayout;var f=u[a.id];a.updateRadialAxisTitle(u,f,j)}function Y(e,t){var n=o.dot([e,-t],[Math.cos(_),Math.sin(_)]);U=S-C*n;if(C>0!==(r?U>T:U<M)){U=null;return}var s=u._fullLayout;var l=s[a.id];v.range[r]=U;v._rl[r]=U;a.updateRadialAxis(s,l);a.xaxis.setRange();a.xaxis.setScale();a.yaxis.setRange();a.yaxis.setScale();var c=false;for(var f in a.traceHash){var h=a.traceHash[f];var p=o.filterVisible(h);var d=h[0][0].trace._module;d.plot(u,a,p,l);if(i.traceIs(f,"gl")&&p.length)c=true}if(c){k(u);A(u)}}z.prepFn=function(){B=null;j=null;U=null;z.moveFn=H;z.doneFn=G;w(u)};z.clampFn=function(e,t){if(Math.sqrt(e*e+t*t)<E.MINDRAG){e=0;t=0}return[e,t]};g.init(z)};D.updateAngularDrag=function(e){var t=this;var r=t.gd;var a=t.layers;var u=t.radius;var f=t.angularAxis;var h=t.cx;var p=t.cy;var d=t.cxx;var v=t.cyy;var y=E.angularDragBoxSize;var x=m.makeDragger(a,"path","angulardrag","move");var _={element:x,gd:r};n.select(x).attr("d",t.pathAnnulus(u,u+y)).attr("transform",l(h,p)).call(T,"move");function b(e,t){return Math.atan2(v+y-t,e-d-y)}var M=a.frontplot.select(".scatterlayer").selectAll(".trace");var S=M.selectAll(".point");var C=M.selectAll(".textpoint");var L,I;var P,D;var R;var z;function N(u,m){var g=t.gd._fullLayout;var y=g[t.id];var x=L+u*e._invScaleX;var _=I+m*e._invScaleY;var w=b(x,_);var T=O(w-z);D=P+T;a.frontplot.attr("transform",l(t.xOffset2,t.yOffset2)+s([-T,d,v]));if(t.vangles){R=t.radialAxisAngle+T;var E=l(h,p)+s(-T);var N=l(h,p)+s(-R);a.bg.attr("transform",E);a["radial-grid"].attr("transform",E);a["radial-axis"].attr("transform",N);a["radial-line"].select("line").attr("transform",N);t.updateRadialAxisTitle(g,y,R)}else{t.clipPaths.forTraces.select("path").attr("transform",l(d,v)+s(T))}S.each(function(){var e=n.select(this);var t=c.getTranslate(e);e.attr("transform",l(t.x,t.y)+s([T]))});C.each(function(){var e=n.select(this);var t=e.select("text");var r=c.getTranslate(e);e.attr("transform",s([T,t.attr("x"),t.attr("y")])+l(r.x,r.y))});f.rotation=o.modHalf(D,360);t.updateAngularAxis(g,y);if(t._hasClipOnAxisFalse&&!o.isFullCircle(t.sectorInRad)){M.call(c.hideOutsideRangePoints,t)}var B=false;for(var j in t.traceHash){if(i.traceIs(j,"gl")){var U=t.traceHash[j];var H=o.filterVisible(U);var V=U[0][0].trace._module;V.plot(r,t,H,y);if(H.length)B=true}}if(B){k(r);A(r)}var G={};F(G);r.emit("plotly_relayouting",G)}function F(e){e[t.id+".angularaxis.rotation"]=D;if(t.vangles){e[t.id+".radialaxis.angle"]=R}}function B(){C.select("text").attr("transform",null);var e={};F(e);i.call("_guiRelayout",r,e)}_.prepFn=function(n,a,i){var s=e[t.id];P=s.angularaxis.rotation;var l=x.getBoundingClientRect();L=a-l.left;I=i-l.top;r._fullLayout._calcInverseTransform(r);var u=o.apply3DTransform(e._invTransform)(L,I);L=u[0];I=u[1];z=b(L,I);_.moveFn=N;_.doneFn=B;w(r)};if(t.vangles&&!o.isFullCircle(t.sectorInRad)){_.prepFn=o.noop;T(n.select(x),null)}g.init(_)};D.isPtInside=function(e){var t=this.sectorInRad;var r=this.vangles;var n=this.angularAxis.c2g(e.theta);var a=this.radialAxis;var i=a.c2l(e.r);var s=a._rl;var l=r?S.isPtInsidePolygon:o.isPtInsideSector;return l(i,n,s,t,r)};D.pathArc=function(e){var t=this.sectorInRad;var r=this.vangles;var n=r?S.pathPolygon:o.pathArc;return n(e,t[0],t[1],r)};D.pathSector=function(e){var t=this.sectorInRad;var r=this.vangles;var n=r?S.pathPolygon:o.pathSector;return n(e,t[0],t[1],r)};D.pathAnnulus=function(e,t){var r=this.sectorInRad;var n=this.vangles;var a=n?S.pathPolygonAnnulus:o.pathAnnulus;return a(e,t,r[0],r[1],n)};D.pathSubplot=function(){var e=this.innerRadius;var t=this.radius;return e?this.pathAnnulus(e,t):this.pathSector(t)};D.fillViewInitialKey=function(e,t){if(!(e in this.viewInitial)){this.viewInitial[e]=t}};function R(e){var t=e.ticks+String(e.ticklen)+String(e.showticklabels);if("side"in e)t+=e.side;return t}function z(e){var t=e[0];var r=e[1];var n=r-t;var a=L(t,360);var i=a+n;var o=Math.cos(I(a));var s=Math.sin(I(a));var l=Math.cos(I(i));var u=Math.sin(I(i));var c,f,h,p;if(a<=90&&i>=90||a>90&&i>=450){p=1}else if(s<=0&&u<=0){p=0}else{p=Math.max(s,u)}if(a<=180&&i>=180||a>180&&i>=540){c=-1}else if(o>=0&&l>=0){c=0}else{c=Math.min(o,l)}if(a<=270&&i>=270||a>270&&i>=630){f=-1}else if(s>=0&&u>=0){f=0}else{f=Math.min(s,u)}if(i>=360){h=1}else if(o<=0&&l<=0){h=0}else{h=Math.max(o,l)}return[c,f,h,p]}function N(e,t){var r=function(t){return o.angleDist(e,t)};var n=o.findIndexOfMin(t,r);return t[n]}function F(e,t,r){if(t){e.attr("display",null);e.attr(r)}else if(e){e.attr("display","none")}return e}},{"../../components/color":643,"../../components/dragelement":662,"../../components/drawing":665,"../../components/fx":683,"../../components/titles":738,"../../constants/alignment":745,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/setcursor":799,"../../plot_api/subroutines":818,"../../plots/cartesian/axes":828,"../../registry":911,"../cartesian/autorange":827,"../cartesian/dragbox":836,"../cartesian/select":847,"../cartesian/set_convert":848,"../plots":891,"./constants":892,"./helpers":893,"./set_convert":904,d3:169,tinycolor2:576}],904:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../cartesian/set_convert");var i=n.deg2rad;var o=n.rad2deg;t.exports=function e(t,r,n){a(t,n);switch(t._id){case"x":case"radialaxis":s(t,r);break;case"angularaxis":c(t,r);break}};function s(e,t){var r=t._subplot;e.setGeometry=function(){var t=e._rl[0];var n=e._rl[1];var a=r.innerRadius;var i=(r.radius-a)/(n-t);var o=a/i;var s=t>n?function(e){return e<=0}:function(e){return e>=0};e.c2g=function(r){var n=e.c2l(r)-t;return(s(n)?n:0)+o};e.g2c=function(r){return e.l2c(r+t-o)};e.g2p=function(e){return e*i};e.c2p=function(t){return e.g2p(e.c2g(t))}}}function l(e,t){return t==="degrees"?i(e):e}function u(e,t){return t==="degrees"?o(e):e}function c(e,t){var r=e.type;if(r==="linear"){var a=e.d2c;var s=e.c2d;e.d2c=function(e,t){return l(a(e),t)};e.c2d=function(e,t){return s(u(e,t))}}e.makeCalcdata=function(t,a){var i=t[a];var o=t._length;var s,l;var u=function(r){return e.d2c(r,t.thetaunit)};if(i){if(n.isTypedArray(i)&&r==="linear"){if(o===i.length){return i}else if(i.subarray){return i.subarray(0,o)}}s=new Array(o);for(l=0;l<o;l++){s[l]=u(i[l])}}else{var c=a+"0";var f="d"+a;var h=c in t?u(t[c]):0;var p=t[f]?u(t[f]):(e.period||2*Math.PI)/o;s=new Array(o);for(l=0;l<o;l++){s[l]=h+l*p}}return s};e.setGeometry=function(){var a=t.sector;var s=a.map(i);var l={clockwise:-1,counterclockwise:1}[e.direction];var u=i(e.rotation);var c=function(e){return l*e+u};var f=function(e){return(e-u)/l};var h,p;var d,v;switch(r){case"linear":p=h=n.identity;v=i;d=o;e.range=n.isFullCircle(s)?[a[0],a[0]+360]:s.map(f).map(o);break;case"category":var m=e._categories.length;var g=e.period?Math.max(e.period,m):m;if(g===0)g=1;p=v=function(e){return e*2*Math.PI/g};h=d=function(e){return e*g/Math.PI/2};e.range=[0,g];break}e.c2g=function(e){return c(p(e))};e.g2c=function(e){return h(f(e))};e.t2g=function(e){return c(v(e))};e.g2t=function(e){return d(f(e))}}}},{"../../lib":778,"../cartesian/set_convert":848}],905:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plot_api/plot_template");var i=e("./domain").defaults;t.exports=function e(t,r,o,s){var l=s.type;var u=s.attributes;var c=s.handleDefaults;var f=s.partition||"x";var h=r._subplots[l];var p=h.length;var d=p&&h[0].replace(/\d+$/,"");var v,m;function g(e,t){return n.coerce(v,m,u,e,t)}for(var y=0;y<p;y++){var x=h[y];if(t[x])v=t[x];else v=t[x]={};m=a.newContainer(r,x,d);g("uirevision",r.uirevision);var _={};_[f]=[y/p,(y+1)/p];i(m,r,g,_);s.id=x;c(v,m,g,s)}}},{"../lib":778,"../plot_api/plot_template":817,"./domain":855}],906:[function(e,t,r){"use strict";var n=e("../constants/docs").FORMAT_LINK;var a=e("../constants/docs").DATE_FORMAT_LINK;var i=['Variables are inserted using %{variable}, for example "y: %{y}".','Numbers are formatted using d3-format\'s syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".',n,"for details on the formatting syntax.",'Dates are formatted using d3-time-format\'s syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".',a,"for details on the date formatting syntax."].join(" ");function o(e){var t=e.description?" "+e.description:"";var r=e.keys||[];if(r.length>0){var n=[];for(var a=0;a<r.length;a++){n[a]="`"+r[a]+"`"}t=t+"Finally, the template string has access to ";if(r.length===1){t="variable "+n[0]}else{t="variables "+n.slice(0,-1).join(", ")+" and "+n.slice(-1)+"."}}return t}r.hovertemplateAttrs=function(e,t){e=e||{};t=t||{};var r=o(t);var n={valType:"string",dflt:"",editType:e.editType||"none"};if(e.arrayOk!==false){n.arrayOk=true}return n};r.texttemplateAttrs=function(e,t){e=e||{};t=t||{};var r=o(t);var n={valType:"string",dflt:"",editType:e.editType||"calc"};if(e.arrayOk!==false){n.arrayOk=true}return n}},{"../constants/docs":748}],907:[function(e,t,r){"use strict";var n=e("./ternary");var a=e("../../plots/get_data").getSubplotCalcData;var i=e("../../lib").counterRegex;var o="ternary";r.name=o;var s=r.attr="subplot";r.idRoot=o;r.idRegex=r.attrRegex=i(o);var l=r.attributes={};l[s]={valType:"subplotid",dflt:"ternary",editType:"calc"};r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.plot=function e(t){var r=t._fullLayout;var i=t.calcdata;var s=r._subplots[o];for(var l=0;l<s.length;l++){var u=s[l];var c=a(i,o,u);var f=r[u]._subplot;if(!f){f=new n({id:u,graphDiv:t,container:r._ternarylayer.node()},r);r[u]._subplot=f}f.plot(c,r,t._promises)}};r.clean=function(e,t,r,n){var a=n._subplots[o]||[];for(var i=0;i<a.length;i++){var s=a[i];var l=n[s]._subplot;if(!t[s]&&!!l){l.plotContainer.remove();l.clipDef.remove();l.clipDefRelative.remove();l.layers["a-title"].remove();l.layers["b-title"].remove();l.layers["c-title"].remove()}}}},{"../../lib":778,"../../plots/get_data":865,"./layout_attributes":908,"./layout_defaults":909,"./ternary":910}],908:[function(e,t,r){"use strict";var n=e("../../components/color/attributes");var a=e("../domain").attributes;var i=e("../cartesian/layout_attributes");var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../lib/extend").extendFlat;var l={title:{text:i.title.text,font:i.title.font},color:i.color,tickmode:i.tickmode,nticks:s({},i.nticks,{dflt:6,min:1}),tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:i.ticks,ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,showticklabels:i.showticklabels,showtickprefix:i.showtickprefix,tickprefix:i.tickprefix,showticksuffix:i.showticksuffix,ticksuffix:i.ticksuffix,showexponent:i.showexponent,exponentformat:i.exponentformat,minexponent:i.minexponent,separatethousands:i.separatethousands,tickfont:i.tickfont,tickangle:i.tickangle,tickformat:i.tickformat,tickformatstops:i.tickformatstops,hoverformat:i.hoverformat,showline:s({},i.showline,{dflt:true}),linecolor:i.linecolor,linewidth:i.linewidth,showgrid:s({},i.showgrid,{dflt:true}),gridcolor:i.gridcolor,gridwidth:i.gridwidth,layer:i.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:i._deprecated.title,titlefont:i._deprecated.titlefont}};var u=t.exports=o({domain:a({name:"ternary"}),bgcolor:{valType:"color",dflt:n.background},sum:{valType:"number",dflt:1,min:0},aaxis:l,baxis:l,caxis:l},"plot","from-root");u.uirevision={valType:"any",editType:"none"};u.aaxis.uirevision=u.baxis.uirevision=u.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plot_api/edit_types":810,"../cartesian/layout_attributes":842,"../domain":855}],909:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("../../plot_api/plot_template");var i=e("../../lib");var o=e("../subplot_defaults");var s=e("../cartesian/tick_label_defaults");var l=e("../cartesian/tick_mark_defaults");var u=e("../cartesian/tick_value_defaults");var c=e("../cartesian/line_grid_defaults");var f=e("./layout_attributes");var h=["aaxis","baxis","caxis"];t.exports=function e(t,r,n){o(t,r,n,{type:"ternary",attributes:f,handleDefaults:p,font:r.font,paper_bgcolor:r.paper_bgcolor})};function p(e,t,r,i){var o=r("bgcolor");var s=r("sum");i.bgColor=n.combine(o,i.paper_bgcolor);var l,u,c;for(var f=0;f<h.length;f++){l=h[f];u=e[l]||{};c=a.newContainer(t,l);c._name=l;d(u,c,i,t)}var p=t.aaxis;var v=t.baxis;var m=t.caxis;if(p.min+v.min+m.min>=s){p.min=0;v.min=0;m.min=0;if(e.aaxis)delete e.aaxis.min;if(e.baxis)delete e.baxis.min;if(e.caxis)delete e.caxis.min}}function d(e,t,r,n){var a=f[t._name];function o(r,n){return i.coerce(e,t,a,r,n)}o("uirevision",n.uirevision);t.type="linear";var h=o("color");var p=h!==a.color.dflt?h:r.font.color;var d=t._name;var v=d.charAt(0).toUpperCase();var m="Component "+v;var g=o("title.text",m);t._hovertitle=g===m?g:v;i.coerceFont(o,"title.font",{family:r.font.family,size:Math.round(r.font.size*1.2),color:p});o("min");u(e,t,o,"linear");s(e,t,o,"linear",{});l(e,t,o,{outerTicks:true});var y=o("showticklabels");if(y){i.coerceFont(o,"tickfont",{family:r.font.family,size:r.font.size,color:p});o("tickangle");o("tickformat")}c(e,t,o,{dfltColor:h,bgColor:r.bgColor,blend:60,showLine:true,showGrid:true,noZeroLine:true,attributes:a});o("hoverformat");o("layer")}},{"../../components/color":643,"../../lib":778,"../../plot_api/plot_template":817,"../cartesian/line_grid_defaults":844,"../cartesian/tick_label_defaults":849,"../cartesian/tick_mark_defaults":850,"../cartesian/tick_value_defaults":851,"../subplot_defaults":905,"./layout_attributes":908}],910:[function(e,t,r){"use strict";var n=e("d3");var a=e("tinycolor2");var i=e("../../registry");var o=e("../../lib");var s=o.strTranslate;var l=o._;var u=e("../../components/color");var c=e("../../components/drawing");var f=e("../cartesian/set_convert");var h=e("../../lib/extend").extendFlat;var p=e("../plots");var d=e("../cartesian/axes");var v=e("../../components/dragelement");var m=e("../../components/fx");var g=e("../../components/dragelement/helpers");var y=g.freeMode;var x=g.rectMode;var _=e("../../components/titles");var b=e("../cartesian/select").prepSelect;var w=e("../cartesian/select").selectOnClick;var T=e("../cartesian/select").clearSelect;var k=e("../cartesian/select").clearSelectionsCache;var A=e("../cartesian/constants");function M(e,t){this.id=e.id;this.graphDiv=e.graphDiv;this.init(t);this.makeFramework(t);this.aTickLayout=null;this.bTickLayout=null;this.cTickLayout=null}t.exports=M;var E=M.prototype;E.init=function(e){this.container=e._ternarylayer;this.defs=e._defs;this.layoutId=e._uid;this.traceHash={};this.layers={}};E.plot=function(e,t){var r=this;var n=t[r.id];var a=t._size;r._hasClipOnAxisFalse=false;for(var i=0;i<e.length;i++){var o=e[i][0].trace;if(o.cliponaxis===false){r._hasClipOnAxisFalse=true;break}}r.updateLayers(n);r.adjustLayout(n,a);p.generalUpdatePerTraceModule(r.graphDiv,r,e,n);r.layers.plotbg.select("path").call(u.fill,n.bgcolor)};E.makeFramework=function(e){var t=this;var r=t.graphDiv;var n=e[t.id];var a=t.clipId="clip"+t.layoutId+t.id;var i=t.clipIdRelative="clip-relative"+t.layoutId+t.id;t.clipDef=o.ensureSingleById(e._clips,"clipPath",a,function(e){e.append("path").attr("d","M0,0Z")});t.clipDefRelative=o.ensureSingleById(e._clips,"clipPath",i,function(e){e.append("path").attr("d","M0,0Z")});t.plotContainer=o.ensureSingle(t.container,"g",t.id);t.updateLayers(n);c.setClipUrl(t.layers.backplot,a,r);c.setClipUrl(t.layers.grids,a,r)};E.updateLayers=function(e){var t=this;var r=t.layers;var a=["draglayer","plotbg","backplot","grids"];if(e.aaxis.layer==="below traces"){a.push("aaxis","aline")}if(e.baxis.layer==="below traces"){a.push("baxis","bline")}if(e.caxis.layer==="below traces"){a.push("caxis","cline")}a.push("frontplot");if(e.aaxis.layer==="above traces"){a.push("aaxis","aline")}if(e.baxis.layer==="above traces"){a.push("baxis","bline")}if(e.caxis.layer==="above traces"){a.push("caxis","cline")}var i=t.plotContainer.selectAll("g.toplevel").data(a,String);var o=["agrid","bgrid","cgrid"];i.enter().append("g").attr("class",function(e){return"toplevel "+e}).each(function(e){var t=n.select(this);r[e]=t;if(e==="frontplot"){t.append("g").classed("scatterlayer",true)}else if(e==="backplot"){t.append("g").classed("maplayer",true)}else if(e==="plotbg"){t.append("path").attr("d","M0,0Z")}else if(e==="aline"||e==="bline"||e==="cline"){t.append("path")}else if(e==="grids"){o.forEach(function(e){r[e]=t.append("g").classed("grid "+e,true)})}});i.order()};var S=Math.sqrt(4/3);E.adjustLayout=function(e,t){var r=this;var n=e.domain;var a=(n.x[0]+n.x[1])/2;var i=(n.y[0]+n.y[1])/2;var o=n.x[1]-n.x[0];var l=n.y[1]-n.y[0];var p=o*t.w;var d=l*t.h;var v=e.sum;var m=e.aaxis.min;var g=e.baxis.min;var y=e.caxis.min;var x,_,b,w,T,k;if(p>S*d){w=d;b=w*S}else{b=p;w=b/S}T=o*b/p;k=l*w/d;x=t.l+t.w*a-b/2;_=t.t+t.h*(1-i)-w/2;r.x0=x;r.y0=_;r.w=b;r.h=w;r.sum=v;r.xaxis={type:"linear",range:[m+2*y-v,v-m-2*g],domain:[a-T/2,a+T/2],_id:"x"};f(r.xaxis,r.graphDiv._fullLayout);r.xaxis.setScale();r.xaxis.isPtWithinRange=function(e){return e.a>=r.aaxis.range[0]&&e.a<=r.aaxis.range[1]&&e.b>=r.baxis.range[1]&&e.b<=r.baxis.range[0]&&e.c>=r.caxis.range[1]&&e.c<=r.caxis.range[0]};r.yaxis={type:"linear",range:[m,v-g-y],domain:[i-k/2,i+k/2],_id:"y"};f(r.yaxis,r.graphDiv._fullLayout);r.yaxis.setScale();r.yaxis.isPtWithinRange=function(){return true};var A=r.yaxis.domain[0];var M=r.aaxis=h({},e.aaxis,{range:[m,v-g-y],side:"left",tickangle:(+e.aaxis.tickangle||0)-30,domain:[A,A+k*S],anchor:"free",position:0,_id:"y",_length:b});f(M,r.graphDiv._fullLayout);M.setScale();var E=r.baxis=h({},e.baxis,{range:[v-m-y,g],side:"bottom",domain:r.xaxis.domain,anchor:"free",position:0,_id:"x",_length:b});f(E,r.graphDiv._fullLayout);E.setScale();var C=r.caxis=h({},e.caxis,{range:[v-m-g,y],side:"right",tickangle:(+e.caxis.tickangle||0)+30,domain:[A,A+k*S],anchor:"free",position:0,_id:"y",_length:b});f(C,r.graphDiv._fullLayout);C.setScale();var L="M"+x+","+(_+w)+"h"+b+"l-"+b/2+",-"+w+"Z";r.clipDef.select("path").attr("d",L);r.layers.plotbg.select("path").attr("d",L);var I="M0,"+w+"h"+b+"l-"+b/2+",-"+w+"Z";r.clipDefRelative.select("path").attr("d",I);var O=s(x,_);r.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",O);r.clipDefRelative.select("path").attr("transform",null);var P=s(x-E._offset,_+w);r.layers.baxis.attr("transform",P);r.layers.bgrid.attr("transform",P);var D=s(x+b/2,_)+"rotate(30)"+s(0,-M._offset);r.layers.aaxis.attr("transform",D);r.layers.agrid.attr("transform",D);var R=s(x+b/2,_)+"rotate(-30)"+s(0,-C._offset);r.layers.caxis.attr("transform",R);r.layers.cgrid.attr("transform",R);r.drawAxes(true);r.layers.aline.select("path").attr("d",M.showline?"M"+x+","+(_+w)+"l"+b/2+",-"+w:"M0,0").call(u.stroke,M.linecolor||"#000").style("stroke-width",(M.linewidth||0)+"px");r.layers.bline.select("path").attr("d",E.showline?"M"+x+","+(_+w)+"h"+b:"M0,0").call(u.stroke,E.linecolor||"#000").style("stroke-width",(E.linewidth||0)+"px");r.layers.cline.select("path").attr("d",C.showline?"M"+(x+b/2)+","+_+"l"+b/2+","+w:"M0,0").call(u.stroke,C.linecolor||"#000").style("stroke-width",(C.linewidth||0)+"px");if(!r.graphDiv._context.staticPlot){r.initInteractions()}c.setClipUrl(r.layers.frontplot,r._hasClipOnAxisFalse?null:r.clipId,r.graphDiv)};E.drawAxes=function(e){var t=this;var r=t.graphDiv;var n=t.id.substr(7)+"title";var a=t.layers;var i=t.aaxis;var o=t.baxis;var s=t.caxis;t.drawAx(i);t.drawAx(o);t.drawAx(s);if(e){var u=Math.max(i.showticklabels?i.tickfont.size/2:0,(s.showticklabels?s.tickfont.size*.75:0)+(s.ticks==="outside"?s.ticklen*.87:0));var c=(o.showticklabels?o.tickfont.size:0)+(o.ticks==="outside"?o.ticklen:0)+3;a["a-title"]=_.draw(r,"a"+n,{propContainer:i,propName:t.id+".aaxis.title",placeholder:l(r,"Click to enter Component A title"),attributes:{x:t.x0+t.w/2,y:t.y0-i.title.font.size/3-u,"text-anchor":"middle"}});a["b-title"]=_.draw(r,"b"+n,{propContainer:o,propName:t.id+".baxis.title",placeholder:l(r,"Click to enter Component B title"),attributes:{x:t.x0-c,y:t.y0+t.h+o.title.font.size*.83+c,"text-anchor":"middle"}});a["c-title"]=_.draw(r,"c"+n,{propContainer:s,propName:t.id+".caxis.title",placeholder:l(r,"Click to enter Component C title"),attributes:{x:t.x0+t.w+c,y:t.y0+t.h+s.title.font.size*.83+c,"text-anchor":"middle"}})}};E.drawAx=function(e){var t=this;var r=t.graphDiv;var n=e._name;var a=n.charAt(0);var i=e._id;var s=t.layers[n];var l=30;var u=a+"tickLayout";var c=C(e);if(t[u]!==c){s.selectAll("."+i+"tick").remove();t[u]=c}e.setScale();var f=d.calcTicks(e);var h=d.clipEnds(e,f);var p=d.makeTransTickFn(e);var v=d.getTickSigns(e)[2];var m=o.deg2rad(l);var g=v*(e.linewidth||1)/2;var y=v*e.ticklen;var x=t.w;var _=t.h;var b=a==="b"?"M0,"+g+"l"+Math.sin(m)*y+","+Math.cos(m)*y:"M"+g+",0l"+Math.cos(m)*y+","+-Math.sin(m)*y;var w={a:"M0,0l"+_+",-"+x/2,b:"M0,0l-"+x/2+",-"+_,c:"M0,0l-"+_+","+x/2}[a];d.drawTicks(r,e,{vals:e.ticks==="inside"?h:f,layer:s,path:b,transFn:p,crisp:false});d.drawGrid(r,e,{vals:h,layer:t.layers[a+"grid"],path:w,transFn:p,crisp:false});d.drawLabels(r,e,{vals:f,layer:s,transFn:p,labelFns:d.makeLabelFns(e,0,l)})};function C(e){return e.ticks+String(e.ticklen)+String(e.showticklabels)}var L=A.MINZOOM/2+.87;var I="m-0.87,.5h"+L+"v3h-"+(L+5.2)+"l"+(L/2+2.6)+",-"+(L*.87+4.5)+"l2.6,1.5l-"+L/2+","+L*.87+"Z";var O="m0.87,.5h-"+L+"v3h"+(L+5.2)+"l-"+(L/2+2.6)+",-"+(L*.87+4.5)+"l-2.6,1.5l"+L/2+","+L*.87+"Z";var P="m0,1l"+L/2+","+L*.87+"l2.6,-1.5l-"+(L/2+2.6)+",-"+(L*.87+4.5)+"l-"+(L/2+2.6)+","+(L*.87+4.5)+"l2.6,1.5l"+L/2+",-"+L*.87+"Z";var D="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z";var R=true;E.clearSelect=function(){k(this.dragOptions);T(this.dragOptions.gd)};E.initInteractions=function(){var e=this;var t=e.layers.plotbg.select("path").node();var r=e.graphDiv;var n=r._fullLayout._zoomlayer;var f;var h;this.dragOptions={element:t,gd:r,plotinfo:{id:e.id,domain:r._fullLayout[e.id].domain,xaxis:e.xaxis,yaxis:e.yaxis},subplot:e.id,prepFn:function(t,n,a){e.dragOptions.xaxes=[e.xaxis];e.dragOptions.yaxes=[e.yaxis];f=r._fullLayout._invScaleX;h=r._fullLayout._invScaleY;var i=e.dragOptions.dragmode=r._fullLayout.dragmode;if(y(i))e.dragOptions.minDrag=1;else e.dragOptions.minDrag=undefined;if(i==="zoom"){e.dragOptions.moveFn=V;e.dragOptions.clickFn=F;e.dragOptions.doneFn=G;B(t,n,a)}else if(i==="pan"){e.dragOptions.moveFn=Y;e.dragOptions.clickFn=F;e.dragOptions.doneFn=W;q();e.clearSelect(r)}else if(x(i)||y(i)){b(t,n,a,e.dragOptions,i)}}};var p,d,g,_,T,k,M,E,C,L;function N(t){var r={};r[e.id+".aaxis.min"]=t.a;r[e.id+".baxis.min"]=t.b;r[e.id+".caxis.min"]=t.c;return r}function F(t,n){var a=r._fullLayout.clickmode;z(r);if(t===2){r.emit("plotly_doubleclick",null);i.call("_guiRelayout",r,N({a:0,b:0,c:0}))}if(a.indexOf("select")>-1&&t===1){w(n,r,[e.xaxis],[e.yaxis],e.id,e.dragOptions)}if(a.indexOf("event")>-1){m.click(r,n,e.id)}}function B(i,l,c){var f=t.getBoundingClientRect();p=l-f.left;d=c-f.top;r._fullLayout._calcInverseTransform(r);var h=r._fullLayout._invTransform;var v=o.apply3DTransform(h)(p,d);p=v[0];d=v[1];g={a:e.aaxis.range[0],b:e.baxis.range[1],c:e.caxis.range[1]};T=g;_=e.aaxis.range[1]-g.a;k=a(e.graphDiv._fullLayout[e.id].bgcolor).getLuminance();M="M0,"+e.h+"L"+e.w/2+", 0L"+e.w+","+e.h+"Z";E=false;C=n.append("path").attr("class","zoombox").attr("transform",s(e.x0,e.y0)).style({fill:k>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",M);L=n.append("path").attr("class","zoombox-corners").attr("transform",s(e.x0,e.y0)).style({fill:u.background,stroke:u.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z");e.clearSelect(r)}function j(t,r){return 1-r/e.h}function U(t,r){return 1-(t+(e.h-r)/Math.sqrt(3))/e.w}function H(t,r){return(t-(e.h-r)/Math.sqrt(3))/e.w}function V(t,n){var a=p+t*f;var i=d+n*h;var o=Math.max(0,Math.min(1,j(p,d),j(a,i)));var s=Math.max(0,Math.min(1,U(p,d),U(a,i)));var l=Math.max(0,Math.min(1,H(p,d),H(a,i)));var u=(o/2+l)*e.w;var c=(1-o/2-s)*e.w;var v=(u+c)/2;var m=c-u;var y=(1-o)*e.h;var x=y-m/S;if(m<A.MINZOOM){T=g;C.attr("d",M);L.attr("d","M0,0Z")}else{T={a:g.a+o*_,b:g.b+s*_,c:g.c+l*_};C.attr("d",M+"M"+u+","+y+"H"+c+"L"+v+","+x+"L"+u+","+y+"Z");L.attr("d","M"+p+","+d+D+"M"+u+","+y+I+"M"+c+","+y+O+"M"+v+","+x+P)}if(!E){C.transition().style("fill",k>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);L.transition().style("opacity",1).duration(200);E=true}r.emit("plotly_relayouting",N(T))}function G(){z(r);if(T===g)return;i.call("_guiRelayout",r,N(T));if(R&&r.data&&r._context.showTips){o.notifier(l(r,"Double-click to zoom back out"),"long");R=false}}function q(){g={a:e.aaxis.range[0],b:e.baxis.range[1],c:e.caxis.range[1]};T=g}function Y(t,n){var a=t/e.xaxis._m;var i=n/e.yaxis._m;T={a:g.a-i,b:g.b+(a+i)/2,c:g.c-(a-i)/2};var l=[T.a,T.b,T.c].sort(o.sorterAsc);var u={a:l.indexOf(T.a),b:l.indexOf(T.b),c:l.indexOf(T.c)};if(l[0]<0){if(l[1]+l[0]/2<0){l[2]+=l[0]+l[1];l[0]=l[1]=0}else{l[2]+=l[0]/2;l[1]+=l[0]/2;l[0]=0}T={a:l[u.a],b:l[u.b],c:l[u.c]};n=(g.a-T.a)*e.yaxis._m;t=(g.c-T.c-g.b+T.b)*e.xaxis._m}var f=s(e.x0+t,e.y0+n);e.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",f);var h=s(-t,-n);e.clipDefRelative.select("path").attr("transform",h);e.aaxis.range=[T.a,e.sum-T.b-T.c];e.baxis.range=[e.sum-T.a-T.c,T.b];e.caxis.range=[e.sum-T.a-T.b,T.c];e.drawAxes(false);if(e._hasClipOnAxisFalse){e.plotContainer.select(".scatterlayer").selectAll(".trace").call(c.hideOutsideRangePoints,e)}r.emit("plotly_relayouting",N(T))}function W(){i.call("_guiRelayout",r,N(T))}t.onmousemove=function(n){m.hover(r,n,e.id);r._fullLayout._lasthover=t;r._fullLayout._hoversubplot=e.id};t.onmouseout=function(e){if(r._dragging)return;v.unhover(r,e)};v.init(this.dragOptions)};function z(e){n.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":643,"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../components/titles":738,"../../lib":778,"../../lib/extend":768,"../../registry":911,"../cartesian/axes":828,"../cartesian/constants":834,"../cartesian/select":847,"../cartesian/set_convert":848,"../plots":891,d3:169,tinycolor2:576}],911:[function(e,t,r){"use strict";var n=e("./lib/loggers");var a=e("./lib/noop");var i=e("./lib/push_unique");var o=e("./lib/is_plain_object");var s=e("./lib/dom").addStyleRule;var l=e("./lib/extend");var u=e("./plots/attributes");var c=e("./plots/layout_attributes");var f=l.extendFlat;var h=l.extendDeepAll;r.modules={};r.allCategories={};r.allTypes=[];r.subplotsRegistry={};r.transformsRegistry={};r.componentsRegistry={};r.layoutArrayContainers=[];r.layoutArrayRegexes=[];r.traceLayoutAttributes={};r.localeRegistry={};r.apiMethodRegistry={};r.collectableSubplotTypes=null;r.register=function e(t){r.collectableSubplotTypes=null;if(!t){throw new Error("No argument passed to Plotly.register.")}else if(t&&!Array.isArray(t)){t=[t]}for(var n=0;n<t.length;n++){var a=t[n];if(!a){throw new Error("Invalid module was attempted to be registered!")}switch(a.moduleType){case"trace":p(a);break;case"transform":m(a);break;case"component":v(a);break;case"locale":g(a);break;case"apiMethod":var i=a.name;r.apiMethodRegistry[i]=a.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}};r.getModule=function(e){var t=r.modules[w(e)];if(!t)return false;return t._module};r.traceIs=function(e,t){e=w(e);if(e==="various")return false;var a=r.modules[e];if(!a){if(e&&e!=="area"){n.log("Unrecognized trace type "+e+".")}a=r.modules[u.type.dflt]}return!!a.categories[t]};r.getTransformIndices=function(e,t){var r=[];var n=e.transforms||[];for(var a=0;a<n.length;a++){if(n[a].type===t){r.push(a)}}return r};r.hasTransform=function(e,t){var r=e.transforms||[];for(var n=0;n<r.length;n++){if(r[n].type===t){return true}}return false};r.getComponentMethod=function(e,t){var n=r.componentsRegistry[e];if(!n)return a;return n[t]||a};r.call=function(){var e=arguments[0];var t=[].slice.call(arguments,1);return r.apiMethodRegistry[e].apply(null,t)};function p(e){var t=e.name;var a=e.categories;var i=e.meta;if(r.modules[t]){n.log("Type "+t+" already registered");return}if(!r.subplotsRegistry[e.basePlotModule.name]){d(e.basePlotModule)}var o={};for(var l=0;l<a.length;l++){o[a[l]]=true;r.allCategories[a[l]]=true}r.modules[t]={_module:e,categories:o};if(i&&Object.keys(i).length){r.modules[t].meta=i}r.allTypes.push(t);for(var u in r.componentsRegistry){x(u,t)}if(e.layoutAttributes){f(r.traceLayoutAttributes,e.layoutAttributes)}var c=e.basePlotModule;var h=c.name;if(h==="mapbox"){var p=c.constants.styleRules;for(var v in p){s(".js-plotly-plot .plotly .mapboxgl-"+v,p[v])}}if((h==="geo"||h==="mapbox")&&(typeof window!==undefined&&window.PlotlyGeoAssets===undefined)){window.PlotlyGeoAssets={topojson:{}}}}function d(e){var t=e.name;if(r.subplotsRegistry[t]){n.log("Plot type "+t+" already registered.");return}y(e);r.subplotsRegistry[t]=e;for(var a in r.componentsRegistry){b(a,e.name)}}function v(e){if(typeof e.name!=="string"){throw new Error("Component module *name* must be a string.")}var t=e.name;r.componentsRegistry[t]=e;if(e.layoutAttributes){if(e.layoutAttributes._isLinkedToArray){i(r.layoutArrayContainers,t)}y(e)}for(var n in r.modules){x(t,n)}for(var a in r.subplotsRegistry){b(t,a)}for(var o in r.transformsRegistry){_(t,o)}if(e.schema&&e.schema.layout){h(c,e.schema.layout)}}function m(e){if(typeof e.name!=="string"){throw new Error("Transform module *name* must be a string.")}var t="Transform module "+e.name;var a=typeof e.transform==="function";var i=typeof e.calcTransform==="function";if(!a&&!i){throw new Error(t+" is missing a *transform* or *calcTransform* method.")}if(a&&i){n.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" "))}if(!o(e.attributes)){n.log(t+" registered without an *attributes* object.")}if(typeof e.supplyDefaults!=="function"){n.log(t+" registered without a *supplyDefaults* method.")}r.transformsRegistry[e.name]=e;for(var s in r.componentsRegistry){_(s,e.name)}}function g(e){var t=e.name;var n=t.split("-")[0];var a=e.dictionary;var i=e.format;var o=a&&Object.keys(a).length;var s=i&&Object.keys(i).length;var l=r.localeRegistry;var u=l[t];if(!u)l[t]=u={};if(n!==t){var c=l[n];if(!c)l[n]=c={};if(o&&c.dictionary===u.dictionary){c.dictionary=a}if(s&&c.format===u.format){c.format=i}}if(o)u.dictionary=a;if(s)u.format=i}function y(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t){for(var n=0;n<t.length;n++){i(r.layoutArrayRegexes,t[n])}}}}function x(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.traces)return;var a=n.traces[t];if(a){h(r.modules[t]._module.attributes,a)}}function _(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.transforms)return;var a=n.transforms[t];if(a){h(r.transformsRegistry[t].attributes,a)}}function b(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.subplots)return;var a=r.subplotsRegistry[t];var i=a.layoutAttributes;var o=a.attr==="subplot"?a.name:a.attr;if(Array.isArray(o))o=o[0];var s=n.subplots[o];if(i&&s){h(i,s)}}function w(e){if(typeof e==="object")e=e.type;return e}},{"./lib/dom":766,"./lib/extend":768,"./lib/is_plain_object":779,"./lib/loggers":782,"./lib/noop":787,"./lib/push_unique":793,"./plots/attributes":824,"./plots/layout_attributes":882}],912:[function(e,t,r){"use strict";var n=e("../registry");var a=e("../lib");var i=a.extendFlat;var o=a.extendDeep;function s(e){var t;switch(e){case"themes__thumb":t={autosize:true,width:150,height:150,title:{text:""},showlegend:false,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:{text:""},hidesources:true,showlegend:false,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}function l(e){var t=["xaxis","yaxis","zaxis"];return t.indexOf(e.slice(0,5))>-1}t.exports=function e(t,r){if(t.framework&&t.framework.isPolar){t=t.framework.getConfig()}var a;var u=t.data;var c=t.layout;var f=o([],u);var h=o({},c,s(r.tileClass));var p=t._context||{};if(r.width)h.width=r.width;if(r.height)h.height=r.height;if(r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){h.annotations=[];var d=Object.keys(h);for(a=0;a<d.length;a++){if(l(d[a])){h[d[a]].title={text:""}}}for(a=0;a<f.length;a++){var v=f[a];v.showscale=false;if(v.marker)v.marker.showscale=false;if(n.traceIs(v,"pie-like"))v.textposition="none"}}if(Array.isArray(r.annotations)){for(a=0;a<r.annotations.length;a++){h.annotations.push(r.annotations[a])}}var m=Object.keys(h).filter(function(e){return e.match(/^scene\d*$/)});if(m.length){var g={};if(r.tileClass==="thumbnail"){g={title:{text:""},showaxeslabels:false,showticklabels:false,linetickenable:false}}for(a=0;a<m.length;a++){var y=h[m[a]];if(!y.xaxis){y.xaxis={}}if(!y.yaxis){y.yaxis={}}if(!y.zaxis){y.zaxis={}}i(y.xaxis,g);i(y.yaxis,g);i(y.zaxis,g);y._scene=null}}var x=document.createElement("div");if(r.tileClass)x.className=r.tileClass;var _={gd:x,td:x,layout:h,data:f,config:{staticPlot:r.staticPlot===undefined?true:r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===undefined?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||false,showLink:r.showLink||false,showTips:r.showTips||false,mapboxAccessToken:p.mapboxAccessToken}};if(r.setBackground!=="transparent"){_.config.setBackground=r.setBackground||"opaque"}_.gd.defaultLayout=s(r.tileClass);return _}},{"../lib":778,"../registry":911}],913:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plot_api/to_image");var i=e("./filesaver");var o=e("./helpers");function s(e,t){var r;if(!n.isPlainObject(e))r=n.getGraphDiv(e);t=t||{};t.format=t.format||"png";t.width=t.width||null;t.height=t.height||null;t.imageDataOnly=true;return new Promise(function(s,l){if(r&&r._snapshotInProgress){l(new Error("Snapshotting already in progress."))}if(n.isIE()&&t.format!=="svg"){l(new Error(o.MSG_IE_BAD_FORMAT))}if(r)r._snapshotInProgress=true;var u=a(e,t);var c=t.filename||e.fn||"newplot";c+="."+t.format.replace("-",".");u.then(function(e){if(r)r._snapshotInProgress=false;return i(e,c,t.format)}).then(function(e){s(e)}).catch(function(e){if(r)r._snapshotInProgress=false;l(e)})})}t.exports=s},{"../lib":778,"../plot_api/to_image":820,"./filesaver":914,"./helpers":915}],914:[function(e,t,r){"use strict";var n=e("../lib");var a=e("./helpers");function i(e,t,r){var i=document.createElement("a");var o="download"in i;var s=new Promise(function(s,l){var u;var c;if(n.isIE9orBelow()){l(new Error("IE < 10 unsupported"))}if(n.isSafari()){var f=r==="svg"?",":";base64,";a.octetStream(f+encodeURIComponent(e));return s(t)}if(n.isIE()){u=a.createBlob(e,"svg");window.navigator.msSaveBlob(u,t);u=null;return s(t)}if(o){u=a.createBlob(e,r);c=a.createObjectURL(u);i.href=c;i.download=t;document.body.appendChild(i);i.click();document.body.removeChild(i);a.revokeObjectURL(c);u=null;return s(t)}l(new Error("download error"))});return s}t.exports=i},{"../lib":778,"./helpers":915}],915:[function(e,t,r){"use strict";var n=e("../registry");r.getDelay=function(e){if(!e._has)return 0;return e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0};r.getRedrawFunc=function(e){return function(){var t=e._fullLayout||{};var r=t._has&&t._has("polar");var a=!r&&e.data&&e.data[0]&&e.data[0].r;if(!a){n.getComponentMethod("colorbar","draw")(e)}}};r.encodeSVG=function(e){return"data:image/svg+xml,"+encodeURIComponent(e)};r.encodeJSON=function(e){return"data:application/json,"+encodeURIComponent(e)};var a=window.URL||window.webkitURL;r.createObjectURL=function(e){return a.createObjectURL(e)};r.revokeObjectURL=function(e){return a.revokeObjectURL(e)};r.createBlob=function(e,t){if(t==="svg"){return new window.Blob([e],{type:"image/svg+xml;charset=utf-8"})}else if(t==="full-json"){return new window.Blob([e],{type:"application/json;charset=utf-8"})}else{var r=i(window.atob(e));return new window.Blob([r],{type:"image/"+t})}};r.octetStream=function(e){document.location.href="data:application/octet-stream"+e};function i(e){var t=e.length;var r=new ArrayBuffer(t);var n=new Uint8Array(r);for(var a=0;a<t;a++){n[a]=e.charCodeAt(a)}return r}r.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/;r.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":911}],916:[function(e,t,r){"use strict";var n=e("./helpers");var a={getDelay:n.getDelay,getRedrawFunc:n.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=a},{"./cloneplot":912,"./download":913,"./helpers":915,"./svgtoimg":917,"./toimage":918,"./tosvg":919}],917:[function(e,t,r){"use strict";var n=e("../lib");var a=e("events").EventEmitter;var i=e("./helpers");function o(e){var t=e.emitter||new a;var r=new Promise(function(a,o){var s=window.Image;var l=e.svg;var u=e.format||"png";if(n.isIE()&&u!=="svg"){var c=new Error(i.MSG_IE_BAD_FORMAT);o(c);if(!e.promise){return t.emit("error",c)}else{return r}}var f=e.canvas;var h=e.scale||1;var p=e.width||300;var d=e.height||150;var v=h*p;var m=h*d;var g=f.getContext("2d");var y=new s;var x,_;if(u==="svg"||n.isIE9orBelow()||n.isSafari()){_=i.encodeSVG(l)}else{x=i.createBlob(l,"svg");_=i.createObjectURL(x)}f.width=v;f.height=m;y.onload=function(){var r;x=null;i.revokeObjectURL(_);if(u!=="svg"){g.drawImage(y,0,0,v,m)}switch(u){case"jpeg":r=f.toDataURL("image/jpeg");break;case"png":r=f.toDataURL("image/png");break;case"webp":r=f.toDataURL("image/webp");break;case"svg":r=_;break;default:var n="Image format is not jpeg, png, svg or webp.";o(new Error(n));if(!e.promise){return t.emit("error",n)}}a(r);if(!e.promise){t.emit("success",r)}};y.onerror=function(r){x=null;i.revokeObjectURL(_);o(r);if(!e.promise){return t.emit("error",r)}};y.src=_});if(e.promise){return r}return t}t.exports=o},{"../lib":778,"./helpers":915,events:110}],918:[function(e,t,r){"use strict";var n=e("events").EventEmitter;var a=e("../registry");var i=e("../lib");var o=e("./helpers");var s=e("./cloneplot");var l=e("./tosvg");var u=e("./svgtoimg");function c(e,t){var r=new n;var c=s(e,{format:"png"});var f=c.gd;f.style.position="absolute";f.style.left="-5000px";document.body.appendChild(f);function h(){var e=o.getDelay(f._fullLayout);setTimeout(function(){var e=l(f);var n=document.createElement("canvas");n.id=i.randstr();r=u({format:t.format,width:f._fullLayout.width,height:f._fullLayout.height,canvas:n,emitter:r,svg:e});r.clean=function(){if(f)document.body.removeChild(f)}},e)}var p=o.getRedrawFunc(f);a.call("plot",f,c.data,c.layout,c.config).then(p).then(h).catch(function(e){r.emit("error",e)});return r}t.exports=c},{"../lib":778,"../registry":911,"./cloneplot":912,"./helpers":915,"./svgtoimg":917,"./tosvg":919,events:110}],919:[function(e,t,r){"use strict";var n=e("d3");var a=e("../lib");var i=e("../components/drawing");var o=e("../components/color");var s=e("../constants/xmlns_namespaces");var l=/"/g;var u="TOBESTRIPPED";var c=new RegExp('("'+u+")|("+u+'")',"g");function f(e){var t=n.select("body").append("div").style({display:"none"}).html("");var r=e.replace(/(&[^;]*;)/gi,function(e){if(e==="&lt;"){return"&#60;"}if(e==="&rt;"){return"&#62;"}if(e.indexOf("<")!==-1||e.indexOf(">")!==-1){return""}return t.html(e).text()});t.remove();return r}function h(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}t.exports=function e(t,r,p){var d=t._fullLayout;var v=d._paper;var m=d._toppaper;var g=d.width;var y=d.height;var x;v.insert("rect",":first-child").call(i.setRect,0,0,g,y).call(o.fill,d.paper_bgcolor);var _=d._basePlotModules||[];for(x=0;x<_.length;x++){var b=_[x];if(b.toSVG)b.toSVG(t)}if(m){var w=m.node().childNodes;var T=Array.prototype.slice.call(w);for(x=0;x<T.length;x++){var k=T[x];if(k.childNodes.length)v.node().appendChild(k)}}if(d._draggers){d._draggers.remove()}v.node().style.background="";v.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var e=n.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){e.remove();return}else{e.style({visibility:null,display:null})}var t=this.style.fontFamily;if(t&&t.indexOf('"')!==-1){e.style("font-family",t.replace(l,u))}});if(d._gradientUrlQueryParts){var A=[];for(var M in d._gradientUrlQueryParts)A.push(M);if(A.length){v.selectAll(A.join(",")).each(function(){var e=n.select(this);var t=this.style.fill;if(t&&t.indexOf("url(")!==-1){e.style("fill",t.replace(l,u))}var r=this.style.stroke;if(r&&r.indexOf("url(")!==-1){e.style("stroke",r.replace(l,u))}})}}if(r==="pdf"||r==="eps"){v.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0)}v.node().setAttributeNS(s.xmlns,"xmlns",s.svg);v.node().setAttributeNS(s.xmlns,"xmlns:xlink",s.xlink);if(r==="svg"&&p){v.attr("width",p*g);v.attr("height",p*y);v.attr("viewBox","0 0 "+g+" "+y)}var E=(new window.XMLSerializer).serializeToString(v.node());E=f(E);E=h(E);E=E.replace(c,"'");if(a.isIE()){E=E.replace(/"/gi,"'");E=E.replace(/(\('#)([^']*)('\))/gi,'("#$2")');E=E.replace(/(\\')/gi,'"')}return E}},{"../components/color":643,"../components/drawing":665,"../constants/xmlns_namespaces":754,"../lib":778,d3:169}],920:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){for(var a=0;a<t.length;a++)t[a].i=a;n.mergeArray(r.text,t,"tx");n.mergeArray(r.hovertext,t,"htx");var i=r.marker;if(i){n.mergeArray(i.opacity,t,"mo",true);n.mergeArray(i.color,t,"mc");var o=i.line;if(o){n.mergeArray(o.color,t,"mlc");n.mergeArrayCastPositive(o.width,t,"mlw")}}}},{"../../lib":778}],921:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../plots/template_attributes").texttemplateAttrs;var o=e("../../components/colorscale/attributes");var s=e("../../plots/font_attributes");var l=e("./constants");var u=e("../../lib/extend").extendFlat;var c=s({editType:"calc",arrayOk:true,colorEditType:"style"});var f=n.marker;var h=f.line;var p=u({},h.width,{dflt:0});var d=u({width:p,editType:"calc"},o("marker.line"));var v=u({line:d,editType:"calc"},o("marker"),{opacity:{valType:"number",arrayOk:true,dflt:1,min:0,max:1,editType:"style"}});t.exports={x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,text:n.text,texttemplate:i({editType:"plot"},{keys:l.eventDataKeys}),hovertext:n.hovertext,hovertemplate:a({},{keys:l.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:true,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:u({},c,{}),insidetextfont:u({},c,{}),outsidetextfont:u({},c,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:u({},n.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:true,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:true,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:true,editType:"calc"},marker:v,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:n.selected.marker.opacity,color:n.selected.marker.color,editType:"style"},textfont:n.selected.textfont,editType:"style"},unselected:{marker:{opacity:n.unselected.marker.opacity,color:n.unselected.marker.color,editType:"style"},textfont:n.unselected.textfont,editType:"style"},r:n.r,t:n.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/font_attributes":856,"../../plots/template_attributes":906,"../scatter/attributes":1187,"./constants":923}],922:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../plots/cartesian/align_period");var i=e("../../components/colorscale/helpers").hasColorscale;var o=e("../../components/colorscale/calc");var s=e("./arrays_to_calcdata");var l=e("../scatter/calc_selection");t.exports=function e(t,r){var u=n.getFromId(t,r.xaxis||"x");var c=n.getFromId(t,r.yaxis||"y");var f,h,p;var d={msUTC:!!(r.base||r.base===0)};var v;if(r.orientation==="h"){f=u.makeCalcdata(r,"x",d);p=c.makeCalcdata(r,"y");h=a(r,c,"y",p);v=!!r.yperiodalignment}else{f=c.makeCalcdata(r,"y",d);p=u.makeCalcdata(r,"x");h=a(r,u,"x",p);v=!!r.xperiodalignment}var m=Math.min(h.length,f.length);var g=new Array(m);for(var y=0;y<m;y++){g[y]={p:h[y],s:f[y]};if(v){g[y].orig_p=p[y]}if(r.ids){g[y].id=String(r.ids[y])}}if(i(r,"marker")){o(t,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"})}if(i(r,"marker.line")){o(t,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"})}s(g,r);l(g,r);return g}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189,"./arrays_to_calcdata":920}],923:[function(e,t,r){"use strict";t.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],924:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib").isArrayOrTypedArray;var i=e("../../constants/numerical").BADNUM;var o=e("../../registry");var s=e("../../plots/cartesian/axes");var l=e("../../plots/cartesian/constraints").getAxisGroup;var u=e("./sieve.js");function c(e,t){var r=t.xaxis;var n=t.yaxis;var a=e._fullLayout;var i=e._fullData;var s=e.calcdata;var l=[];var u=[];for(var c=0;c<i.length;c++){var h=i[c];if(h.visible===true&&o.traceIs(h,"bar")&&h.xaxis===r._id&&h.yaxis===n._id){if(h.orientation==="h"){l.push(s[c])}else{u.push(s[c])}if(h._computePh){var p=e.calcdata[c];for(var d=0;d<p.length;d++){if(typeof p[d].ph0==="function")p[d].ph0=p[d].ph0();if(typeof p[d].ph1==="function")p[d].ph1=p[d].ph1()}}}}var v={xCat:r.type==="category"||r.type==="multicategory",yCat:n.type==="category"||n.type==="multicategory",mode:a.barmode,norm:a.barnorm,gap:a.bargap,groupgap:a.bargroupgap};f(e,r,n,u,v);f(e,n,r,l,v)}function f(e,t,r,n,a){if(!n.length)return;var i;var o;var s,l,u;h(r,n);switch(a.mode){case"overlay":p(t,r,n,a);break;case"group":i=[];o=[];for(s=0;s<n.length;s++){l=n[s];u=l[0].trace;if(u.offset===undefined)o.push(l);else i.push(l)}if(o.length){d(e,t,r,o,a)}if(i.length){p(t,r,i,a)}break;case"stack":case"relative":i=[];o=[];for(s=0;s<n.length;s++){l=n[s];u=l[0].trace;if(u.base===undefined)o.push(l);else i.push(l)}if(o.length){v(e,t,r,o,a)}if(i.length){p(t,r,i,a)}break}M(n,t)}function h(e,t){var r,i;for(r=0;r<t.length;r++){var o=t[r];var s=o[0].trace;var l=s.type==="funnel"?s._base:s.base;var u;var c=s.orientation==="h"?s.xcalendar:s.ycalendar;var f=e.type==="category"||e.type==="multicategory"?function(){return null}:e.d2c;if(a(l)){for(i=0;i<Math.min(l.length,o.length);i++){u=f(l[i],0,c);if(n(u)){o[i].b=+u;o[i].hasB=1}else o[i].b=0}for(;i<o.length;i++){o[i].b=0}}else{u=f(l,0,c);var h=n(u);u=h?u:0;for(i=0;i<o.length;i++){o[i].b=u;if(h)o[i].hasB=1}}}}function p(e,t,r,n){for(var a=0;a<r.length;a++){var i=r[a];var o=new u([i],{unitMinDiff:n.xCat||n.yCat,sepNegVal:false,overlapNoMerge:!n.norm});m(e,o,n);if(n.norm){T(o);A(t,o,n)}else{b(t,o)}}}function d(e,t,r,n,a){var i=new u(n,{sepNegVal:false,overlapNoMerge:!a.norm});g(e,t,i,a);k(i);if(a.norm){T(i);A(r,i,a)}else{b(r,i)}}function v(e,t,r,n,a){var o=new u(n,{sepNegVal:a.mode==="relative",overlapNoMerge:!(a.norm||a.mode==="stack"||a.mode==="relative")});m(t,o,a);w(r,o,a);for(var s=0;s<n.length;s++){var l=n[s];for(var c=0;c<l.length;c++){var f=l[c];if(f.s!==i){var h=f.b+f.s===o.get(f.p,f.s);if(h)f._outmost=true}}}if(a.norm)A(r,o,a)}function m(e,t,r){var n=t.minDiff;var a=t.traces;var i=n*(1-r.gap);var o=i;var s=o*(1-(r.groupgap||0));var l=-s/2;for(var u=0;u<a.length;u++){var c=a[u];var f=c[0].t;f.barwidth=s;f.poffset=l;f.bargroupwidth=i;f.bardelta=n}t.binWidth=a[0][0].t.barwidth/100;y(t);x(e,t);_(e,t)}function g(e,t,r,n){var a=e._fullLayout;var i=r.positions;var o=r.distinctPositions;var s=r.minDiff;var u=r.traces;var c=u.length;var f=i.length!==o.length;var h=s*(1-n.gap);var p=l(a,t._id)+u[0][0].trace.orientation;var d=a._alignmentOpts[p]||{};for(var v=0;v<c;v++){var m=u[v];var g=m[0].trace;var b=d[g.alignmentgroup]||{};var w=Object.keys(b.offsetGroups||{}).length;var T;if(w){T=h/w}else{T=f?h/c:h}var k=T*(1-(n.groupgap||0));var A;if(w){A=((2*g._offsetIndex+1-w)*T-k)/2}else{A=f?((2*v+1-c)*T-k)/2:-k/2}var M=m[0].t;M.barwidth=k;M.poffset=A;M.bargroupwidth=h;M.bardelta=s}r.binWidth=u[0][0].t.barwidth/100;y(r);x(t,r);_(t,r,f)}function y(e){var t=e.traces;var r,i;for(r=0;r<t.length;r++){var o=t[r];var s=o[0];var l=s.trace;var u=s.t;var c=l._offset||l.offset;var f=u.poffset;var h;if(a(c)){h=Array.prototype.slice.call(c,0,o.length);for(i=0;i<h.length;i++){if(!n(h[i])){h[i]=f}}for(i=h.length;i<o.length;i++){h.push(f)}u.poffset=h}else if(c!==undefined){u.poffset=c}var p=l._width||l.width;var d=u.barwidth;if(a(p)){var v=Array.prototype.slice.call(p,0,o.length);for(i=0;i<v.length;i++){if(!n(v[i]))v[i]=d}for(i=v.length;i<o.length;i++){v.push(d)}u.barwidth=v;if(c===undefined){h=[];for(i=0;i<o.length;i++){h.push(f+(d-v[i])/2)}u.poffset=h}}else if(p!==undefined){u.barwidth=p;if(c===undefined){u.poffset=f+(d-p)/2}}}}function x(e,t){var r=t.traces;var n=E(e);for(var a=0;a<r.length;a++){var i=r[a];var o=i[0].t;var s=o.poffset;var l=Array.isArray(s);var u=o.barwidth;var c=Array.isArray(u);for(var f=0;f<i.length;f++){var h=i[f];var p=h.w=c?u[f]:u;h[n]=h.p+(l?s[f]:s)+p/2}}}function _(e,t,r){var n=t.traces;var a=t.minDiff;var i=a/2;s.minDtick(e,t.minDiff,t.distinctPositions[0],r);for(var o=0;o<n.length;o++){var l=n[o];var u=l[0];var c=u.trace;var f=[];var h,p,d,v;for(v=0;v<l.length;v++){h=l[v];p=h.p-i;d=h.p+i;f.push(p,d)}if(c.width||c.offset){var m=u.t;var g=m.poffset;var y=m.barwidth;var x=Array.isArray(g);var _=Array.isArray(y);for(v=0;v<l.length;v++){h=l[v];var b=x?g[v]:g;var w=_?y[v]:y;p=h.p+b;d=p+w;f.push(p,d)}}c._extremes[e._id]=s.findExtremes(e,f,{padded:false})}}function b(e,t){var r=t.traces;var n=E(e);for(var a=0;a<r.length;a++){var i=r[a];var o=i[0].trace;var l=[];var u=false;for(var c=0;c<i.length;c++){var f=i[c];var h=f.b;var p=h+f.s;f[n]=p;l.push(p);if(f.hasB)l.push(h);if(!f.hasB||!f.b){u=true}}o._extremes[e._id]=s.findExtremes(e,l,{tozero:u,padded:true})}}function w(e,t,r){var n=E(e);var a=t.traces;var o;var l;var u;var c,f;var h;for(c=0;c<a.length;c++){o=a[c];l=o[0].trace;if(l.type==="funnel"){for(f=0;f<o.length;f++){h=o[f];if(h.s!==i){t.put(h.p,-.5*h.s)}}}}for(c=0;c<a.length;c++){o=a[c];l=o[0].trace;u=l.type==="funnel";var p=[];for(f=0;f<o.length;f++){h=o[f];if(h.s!==i){var d;if(u){d=h.s}else{d=h.s+h.b}var v=t.put(h.p,d);var m=v+d;h.b=v;h[n]=m;if(!r.norm){p.push(m);if(h.hasB){p.push(v)}}}}if(!r.norm){l._extremes[e._id]=s.findExtremes(e,p,{tozero:true,padded:true})}}}function T(e){var t=e.traces;for(var r=0;r<t.length;r++){var n=t[r];for(var a=0;a<n.length;a++){var o=n[a];if(o.s!==i){e.put(o.p,o.b+o.s)}}}}function k(e){var t=e.traces;for(var r=0;r<t.length;r++){var n=t[r];var a=n[0].trace;if(a.base===undefined){var o=new u([n],{sepNegVal:true,overlapNoMerge:true});for(var s=0;s<n.length;s++){var l=n[s];if(l.p!==i){var c=o.put(l.p,l.b+l.s);if(c)l.b=c}}}}}function A(e,t,r){var a=t.traces;var o=E(e);var l=r.norm==="fraction"?1:100;var u=l/1e9;var c=e.l2c(e.c2l(0));var f=r.mode==="stack"?l:c;function h(t){return n(e.c2l(t))&&(t<c-u||t>f+u||!n(c))}for(var p=0;p<a.length;p++){var d=a[p];var v=d[0].trace;var m=[];var g=false;var y=false;for(var x=0;x<d.length;x++){var _=d[x];if(_.s!==i){var b=Math.abs(l/t.get(_.p,_.s));_.b*=b;_.s*=b;var w=_.b;var T=w+_.s;_[o]=T;m.push(T);y=y||h(T);if(_.hasB){m.push(w);y=y||h(w)}if(!_.hasB||!_.b){g=true}}}v._extremes[e._id]=s.findExtremes(e,m,{tozero:g,padded:y})}}function M(e,t){var r=E(t);var a={};var i,o,s;var l=Infinity;var u=-Infinity;for(i=0;i<e.length;i++){s=e[i];for(o=0;o<s.length;o++){var c=s[o].p;if(n(c)){l=Math.min(l,c);u=Math.max(u,c)}}}var f=1e4/(u-l);var h=a.round=function(e){return String(Math.round(f*(e-l)))};for(i=0;i<e.length;i++){s=e[i];s[0].t.extents=a;var p=s[0].t.poffset;var d=Array.isArray(p);for(o=0;o<s.length;o++){var v=s[o];var m=v[r]-v.w/2;if(n(m)){var g=v[r]+v.w/2;var y=h(v.p);if(a[y]){a[y]=[Math.min(m,a[y][0]),Math.max(g,a[y][1])]}else{a[y]=[m,g]}}v.p0=v.p+(d?p[o]:p);v.p1=v.p0+v.w;v.s0=v.b;v.s1=v.s0+v.s}}}function E(e){return e._id.charAt(0)}t.exports={crossTraceCalc:c,setGroupPositions:f}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../../plots/cartesian/constraints":835,"../../registry":911,"./sieve.js":934,"fast-isnumeric":241}],925:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../../registry");var o=e("../scatter/xy_defaults");var s=e("../scatter/period_defaults");var l=e("./style_defaults");var u=e("../../plots/cartesian/constraints").getAxisGroup;var c=e("./attributes");var f=n.coerceFont;function h(e,t,r,u){function f(r,a){return n.coerce(e,t,c,r,a)}var h=o(e,t,u,f);if(!h){t.visible=false;return}s(e,t,u,f);f("orientation",t.x&&!t.y?"h":"v");f("base");f("offset");f("width");f("text");f("hovertext");f("hovertemplate");var p=f("textposition");v(e,t,u,f,p,{moduleHasSelected:true,moduleHasUnselected:true,moduleHasConstrain:true,moduleHasCliponaxis:true,moduleHasTextangle:true,moduleHasInsideanchor:true});l(e,t,f,r,u);var d=(t.marker.line||{}).color;var m=i.getComponentMethod("errorbars","supplyDefaults");m(e,t,d||a.defaultLine,{axis:"y"});m(e,t,d||a.defaultLine,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(t,f)}function p(e,t,r,n){var a=t.orientation;var i=t[{v:"x",h:"y"}[a]+"axis"];var o=u(r,i)+a;var s=r._alignmentOpts||{};var l=n("alignmentgroup");var c=s[o];if(!c)c=s[o]={};var f=c[l];if(f){f.traces.push(t)}else{f=c[l]={traces:[t],alignmentIndex:Object.keys(c).length,offsetGroups:{}}}var h=n("offsetgroup");var p=f.offsetGroups;var d=p[h];if(h){if(!d){d=p[h]={offsetIndex:Object.keys(p).length}}t._offsetIndex=d.offsetIndex}}function d(e,t){var r,a;function i(e){return n.coerce(a._input,a,c,e)}if(t.barmode==="group"){for(var o=0;o<e.length;o++){a=e[o];if(a.type==="bar"){r=a._input;p(r,a,t,i)}}}}function v(e,t,r,a,i,o){o=o||{};var s=!(o.moduleHasSelected===false);var l=!(o.moduleHasUnselected===false);var u=!(o.moduleHasConstrain===false);var c=!(o.moduleHasCliponaxis===false);var h=!(o.moduleHasTextangle===false);var p=!(o.moduleHasInsideanchor===false);var d=!!o.hasPathbar;var v=Array.isArray(i)||i==="auto";var m=v||i==="inside";var g=v||i==="outside";if(m||g){var y=f(a,"textfont",r.font);var x=n.extendFlat({},y);var _=e.textfont&&e.textfont.color;var b=!_;if(b){delete x.color}f(a,"insidetextfont",x);if(d){var w=n.extendFlat({},y);if(b){delete w.color}f(a,"pathbar.textfont",w)}if(g)f(a,"outsidetextfont",y);if(s)a("selected.textfont.color");if(l)a("unselected.textfont.color");if(u)a("constraintext");if(c)a("cliponaxis");if(h)a("textangle");a("texttemplate")}if(m){if(p)a("insidetextanchor")}}t.exports={supplyDefaults:h,crossTraceDefaults:d,handleGroupingDefaults:p,handleText:v}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/constraints":835,"../../registry":911,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":921,"./style_defaults":936}],926:[function(e,t,r){"use strict";t.exports=function e(t,r,n){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;if(n.orientation==="h"){t.label=t.y;t.value=t.x}else{t.label=t.x;t.value=t.y}return t}},{}],927:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("tinycolor2");var i=e("../../lib").isArrayOrTypedArray;r.coerceString=function(e,t,r){if(typeof t==="string"){if(t||!e.noBlank)return t}else if(typeof t==="number"||t===true){if(!e.strict)return String(t)}return r!==undefined?r:e.dflt};r.coerceNumber=function(e,t,r){if(n(t)){t=+t;var a=e.min;var i=e.max;var o=a!==undefined&&t<a||i!==undefined&&t>i;if(!o)return t}return r!==undefined?r:e.dflt};r.coerceColor=function(e,t,r){if(a(t).isValid())return t;return r!==undefined?r:e.dflt};r.coerceEnumerated=function(e,t,r){if(e.coerceNumber)t=+t;if(e.values.indexOf(t)!==-1)return t;return r!==undefined?r:e.dflt};r.getValue=function(e,t){var r;if(!Array.isArray(e))r=e;else if(t<e.length)r=e[t];return r};r.getLineWidth=function(e,t){var r=0<t.mlw?t.mlw:!i(e.marker.line.width)?e.marker.line.width:0;return r}},{"../../lib":778,"fast-isnumeric":241,tinycolor2:576}],928:[function(e,t,r){"use strict";var n=e("../../components/fx");var a=e("../../registry");var i=e("../../components/color");var o=e("../../lib").fillText;var s=e("./helpers").getLineWidth;var l=e("../../plots/cartesian/axes").hoverLabelText;var u=e("../../constants/numerical").BADNUM;function c(e,t,r,n){var i=f(e,t,r,n);if(i){var o=i.cd;var s=o[0].trace;var l=o[i.index];i.color=h(s,l);a.getComponentMethod("errorbars","hoverInfo")(l,s,i);return[i]}}function f(e,t,r,a){var i=e.cd;var s=i[0].trace;var c=i[0].t;var f=a==="closest";var h=s.type==="waterfall";var p=e.maxHoverDistance;var d,v,m,g,y,x,_;function b(e){return e[m]-e.w/2}function w(e){return e[m]+e.w/2}var T=f?b:function(e){return Math.min(b(e),e.p-c.bardelta/2)};var k=f?w:function(e){return Math.max(w(e),e.p+c.bardelta/2)};function A(e,t){return n.inbox(e-d,t-d,p+Math.min(1,Math.abs(t-e)/_)-1)}function M(e){return A(T(e),k(e))}function E(e){return A(b(e),w(e))}function S(e){var t=v;var r=e.b;var a=e[g];if(h){var i=Math.abs(e.rawS)||0;if(t>0){a+=i}else if(t<0){a-=i}}return n.inbox(r-t,a-t,p+(a-t)/(a-r)-1)}if(s.orientation==="h"){d=r;v=t;m="y";g="x";y=S;x=M}else{d=t;v=r;m="x";g="y";x=S;y=M}var C=e[m+"a"];var L=e[g+"a"];_=Math.abs(C.r2c(C.range[1])-C.r2c(C.range[0]));function I(e){return(y(e)+x(e))/2}var O=n.getDistanceFunction(a,y,x,I);n.getClosest(i,O,e);if(e.index===false)return;if(i[e.index].p===u)return;if(!f){T=function(e){return Math.min(b(e),e.p-c.bargroupwidth/2)};k=function(e){return Math.max(w(e),e.p+c.bargroupwidth/2)}}var P=e.index;var D=i[P];var R=s.base?D.b+D.s:D.s;e[g+"0"]=e[g+"1"]=L.c2p(D[g],true);e[g+"LabelVal"]=R;var z=c.extents[c.extents.round(D.p)];e[m+"0"]=C.c2p(f?T(D):z[0],true);e[m+"1"]=C.c2p(f?k(D):z[1],true);var N=D.orig_p!==undefined;e[m+"LabelVal"]=N?D.orig_p:D.p;e.labelLabel=l(C,e[m+"LabelVal"]);e.valueLabel=l(L,e[g+"LabelVal"]);e.baseLabel=l(L,D.b);e.spikeDistance=(S(D)+E(D))/2-p;e[m+"Spike"]=C.c2p(D.p,true);o(D,s,e);e.hovertemplate=s.hovertemplate;return e}function h(e,t){var r=t.mcc||e.marker.color;var n=t.mlcc||e.marker.line.color;var a=s(e,t);if(i.opacity(r))return r;else if(i.opacity(n)&&a)return n}t.exports={hoverPoints:c,hoverOnBars:f,getTraceColor:h}},{"../../components/color":643,"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./helpers":927}],929:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,colorbar:e("../scatter/marker_colorbar"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"bar",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:true,meta:{}}},{"../../plots/cartesian":841,"../scatter/marker_colorbar":1205,"./arrays_to_calcdata":920,"./attributes":921,"./calc":922,"./cross_trace_calc":924,"./defaults":925,"./event_data":926,"./hover":928,"./layout_attributes":930,"./layout_defaults":931,"./plot":932,"./select":933,"./style":935}],930:[function(e,t,r){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],931:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../plots/cartesian/axes");var i=e("../../lib");var o=e("./layout_attributes");t.exports=function(e,t,r){function s(r,n){return i.coerce(e,t,o,r,n)}var l=false;var u=false;var c=false;var f={};var h=s("barmode");for(var p=0;p<r.length;p++){var d=r[p];if(n.traceIs(d,"bar")&&d.visible)l=true;else continue;if(h==="group"){var v=d.xaxis+d.yaxis;if(f[v])c=true;f[v]=true}if(d.visible&&d.type==="histogram"){var m=a.getFromId({_fullLayout:t},d[d.orientation==="v"?"xaxis":"yaxis"]);if(m.type!=="category")u=true}}if(!l){delete t.barmode;return}if(h!=="overlay")s("barnorm");s("bargap",u&&!c?0:.2);s("bargroupgap")}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./layout_attributes":930}],932:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("../../lib");var o=e("../../lib/svg_text_utils");var s=e("../../components/color");var l=e("../../components/drawing");var u=e("../../registry");var c=e("../../plots/cartesian/axes").tickText;var f=e("./uniform_text");var h=f.recordMinTextSize;var p=f.clearMinTextSize;var d=e("./style");var v=e("./helpers");var m=e("./constants");var g=e("./attributes");var y=g.text;var x=g.textposition;var _=e("../../components/fx/helpers").appendArrayPointValue;var b=m.TEXTPAD;function w(e){return e.id}function T(e){if(e.ids){return w}}function k(e,t){return e<t?1:-1}function A(e,t,r,n){var a=[];var i=[];var o=n?t:r;var s=n?r:t;a[0]=o.c2p(e.s0,true);i[0]=s.c2p(e.p0,true);a[1]=o.c2p(e.s1,true);i[1]=s.c2p(e.p1,true);return n?[a,i]:[i,a]}function M(e,t,r,n){if(!t.uniformtext.mode&&E(r)){var a;if(n){a=n()}return e.transition().duration(r.duration).ease(r.easing).each("end",function(){a&&a()}).each("interrupt",function(){a&&a()})}else{return e}}function E(e){return e&&e.duration>0}function S(e,t,r,o,c,f){var h=t.xaxis;var d=t.yaxis;var m=e._fullLayout;if(!c){c={mode:m.barmode,norm:m.barmode,gap:m.bargap,groupgap:m.bargroupgap};p("bar",m)}var g=i.makeTraceGroups(o,r,"trace bars").each(function(r){var o=n.select(this);var u=r[0].trace;var p=u.type==="waterfall";var g=u.type==="funnel";var y=u.type==="bar";var x=y||g;var _=0;if(p&&u.connector.visible&&u.connector.mode==="between"){_=u.connector.line.width/2}var b=u.orientation==="h";var w=E(c);var S=i.ensureSingle(o,"g","points");var L=T(u);var I=S.selectAll("g.point").data(i.identity,L);I.enter().append("g").classed("point",true);I.exit().remove();I.each(function(o,p){var g=n.select(this);var y=A(o,h,d,b);var T=y[0][0];var E=y[0][1];var S=y[1][0];var L=y[1][1];var I=(b?E-T:L-S)===0;if(I&&x&&v.getLineWidth(u,o)){I=false}if(!I){I=!a(T)||!a(E)||!a(S)||!a(L)}o.isBlank=I;if(I){if(b){E=T}else{L=S}}if(_&&!I){if(b){T-=k(T,E)*_;E+=k(T,E)*_}else{S-=k(S,L)*_;L+=k(S,L)*_}}var O;var P;if(u.type==="waterfall"){if(!I){var D=u[o.dir].marker;O=D.line.width;P=D.color}}else{O=v.getLineWidth(u,o);P=o.mc||u.marker.color}function R(e){var t=n.round(O/2%1,2);return c.gap===0&&c.groupgap===0?n.round(Math.round(e)-t,2):e}function z(e,t,r){if(r&&e===t){return e}return Math.abs(e-t)>=2?R(e):e>t?Math.ceil(e):Math.floor(e)}if(!e._context.staticPlot){var N=s.opacity(P);var F=N<1||O>.01?R:z;T=F(T,E,b);E=F(E,T,b);S=F(S,L,!b);L=F(L,S,!b)}var B=M(i.ensureSingle(g,"path"),m,c,f);B.style("vector-effect","non-scaling-stroke").attr("d",isNaN((E-T)*(L-S))||I&&e._context.staticPlot?"M0,0Z":"M"+T+","+S+"V"+L+"H"+E+"V"+S+"Z").call(l.setClipUrl,t.layerClipId,e);if(!m.uniformtext.mode&&w){var j=l.makePointStyleFns(u);l.singlePointStyle(o,B,u,j,e)}C(e,t,g,r,p,T,E,S,L,c,f);if(t.layerClipId){l.hideOutsideRangePoint(o,g.select("text"),h,d,u.xcalendar,u.ycalendar)}});var O=u.cliponaxis===false;l.setClipUrl(o,O?null:t.layerClipId,e)});u.getComponentMethod("errorbars","plot")(e,g,t,c)}function C(e,t,r,n,a,s,u,c,f,p,v){var m=t.xaxis;var g=t.yaxis;var y=e._fullLayout;var x;function _(t,r,n){var a=i.ensureSingle(t,"text").text(r).attr({class:"bartext bartext-"+x,"text-anchor":"middle","data-notex":1}).call(l.font,n).call(o.convertToTspans,e);return a}var w=n[0].trace;var T=w.orientation==="h";var k=D(y,n,a,m,g);x=R(w,a);var A=p.mode==="stack"||p.mode==="relative";var E=n[a];var S=!A||E._outmost;if(!k||x==="none"||(E.isBlank||s===u||c===f)&&(x==="auto"||x==="inside")){r.select("text").remove();return}var C=y.font;var L=d.getBarColor(n[a],w);var I=d.getInsideTextFont(w,a,C,L);var z=d.getOutsideTextFont(w,a,C);var N=r.datum();if(T){if(m.type==="log"&&N.s0<=0){if(m.range[0]<m.range[1]){s=0}else{s=m._length}}}else{if(g.type==="log"&&N.s0<=0){if(g.range[0]<g.range[1]){c=g._length}else{c=0}}}var F=Math.abs(u-s)-2*b;var B=Math.abs(f-c)-2*b;var j;var U;var H;var V;var G;if(x==="outside"){if(!S&&!E.hasB)x="inside"}if(x==="auto"){if(S){x="inside";G=i.ensureUniformFontSize(e,I);j=_(r,k,G);U=l.bBox(j.node()),H=U.width,V=U.height;var q=H>0&&V>0;var Y=H<=F&&V<=B;var W=H<=B&&V<=F;var X=T?F>=H*(B/V):B>=V*(F/H);if(q&&(Y||W||X)){x="inside"}else{x="outside";j.remove();j=null}}else{x="inside"}}if(!j){G=i.ensureUniformFontSize(e,x==="outside"?z:I);j=_(r,k,G);var Z=j.attr("transform");j.attr("transform","");U=l.bBox(j.node()),H=U.width,V=U.height;j.attr("transform",Z);if(H<=0||V<=0){j.remove();return}}var K=w.textangle;var J,Q;if(x==="outside"){Q=w.constraintext==="both"||w.constraintext==="outside";J=P(s,u,c,f,U,{isHorizontal:T,constrained:Q,angle:K})}else{Q=w.constraintext==="both"||w.constraintext==="inside";J=O(s,u,c,f,U,{isHorizontal:T,constrained:Q,angle:K,anchor:w.insidetextanchor})}J.fontSize=G.size;h(w.type,J,y);E.transform=J;M(j,y,p,v).attr("transform",i.getTextTransform(J))}function L(e){return e==="auto"?0:e}function I(e,t){var r=Math.PI/180*t;var n=Math.abs(Math.sin(r));var a=Math.abs(Math.cos(r));return{x:e.width*a+e.height*n,y:e.width*n+e.height*a}}function O(e,t,r,n,a,i){var o=!!i.isHorizontal;var s=!!i.constrained;var l=i.angle||0;var u=i.anchor||"end";var c=u==="end";var f=u==="start";var h=i.leftToRight||0;var p=(h+1)/2;var d=1-p;var v=a.width;var m=a.height;var g=Math.abs(t-e);var y=Math.abs(n-r);var x=g>2*b&&y>2*b?b:0;g-=2*x;y-=2*x;var _=L(l);if(l==="auto"&&!(v<=g&&m<=y)&&(v>g||m>y)&&(!(v>y||m>g)||v<m!==g<y)){_+=90}var w=I(a,_);var T=1;if(s){T=Math.min(1,g/w.x,y/w.y)}var A=a.left*d+a.right*p;var M=(a.top+a.bottom)/2;var E=(e+b)*d+(t-b)*p;var S=(r+n)/2;var C=0;var O=0;if(f||c){var P=(o?w.x:w.y)/2;var D=o?k(e,t):k(r,n);if(o){if(f){E=e+D*x;C=-D*P}else{E=t-D*x;C=D*P}}else{if(f){S=r+D*x;O=-D*P}else{S=n-D*x;O=D*P}}}return{textX:A,textY:M,targetX:E,targetY:S,anchorX:C,anchorY:O,scale:T,rotate:_}}function P(e,t,r,n,a,i){var o=!!i.isHorizontal;var s=!!i.constrained;var l=i.angle||0;var u=a.width;var c=a.height;var f=Math.abs(t-e);var h=Math.abs(n-r);var p;if(o){p=h>2*b?b:0}else{p=f>2*b?b:0}var d=1;if(s){d=o?Math.min(1,h/c):Math.min(1,f/u)}var v=L(l);var m=I(a,v);var g=(o?m.x:m.y)/2;var y=(a.left+a.right)/2;var x=(a.top+a.bottom)/2;var _=(e+t)/2;var w=(r+n)/2;var T=0;var A=0;var M=o?k(t,e):k(r,n);if(o){_=t-M*p;T=M*g}else{w=n+M*p;A=-M*g}return{textX:y,textY:x,targetX:_,targetY:w,anchorX:T,anchorY:A,scale:d,rotate:v}}function D(e,t,r,n,a){var i=t[0].trace;var o=i.texttemplate;var s;if(o){s=z(e,t,r,n,a)}else if(i.textinfo){s=N(t,r,n,a)}else{s=v.getValue(i.text,r)}return v.coerceString(y,s)}function R(e,t){var r=v.getValue(e.textposition,t);return v.coerceEnumerated(x,r)}function z(e,t,r,n,a){var o=t[0].trace;var s=i.castOption(o,r,"texttemplate");if(!s)return"";var l=o.type==="waterfall";var u=o.type==="funnel";var f,h;var p,d;if(o.orientation==="h"){f="y";h=a;p="x";d=n}else{f="x";h=n;p="y";d=a}function v(e){return c(h,e,true).text}function m(e){return c(d,+e,true).text}var g=t[r];var y={};y.label=g.p;y.labelLabel=y[f+"Label"]=v(g.p);var x=i.castOption(o,g.i,"text");if(x===0||x)y.text=x;y.value=g.s;y.valueLabel=y[p+"Label"]=m(g.s);var b={};_(b,o,g.i);if(l){y.delta=+g.rawS||g.s;y.deltaLabel=m(y.delta);y.final=g.v;y.finalLabel=m(y.final);y.initial=y.final-y.delta;y.initialLabel=m(y.initial)}if(u){y.value=g.s;y.valueLabel=m(y.value);y.percentInitial=g.begR;y.percentInitialLabel=i.formatPercent(g.begR);y.percentPrevious=g.difR;y.percentPreviousLabel=i.formatPercent(g.difR);y.percentTotal=g.sumR;y.percenTotalLabel=i.formatPercent(g.sumR)}var w=i.castOption(o,g.i,"customdata");if(w)y.customdata=w;return i.texttemplateString(s,y,e._d3locale,b,y,o._meta||{})}function N(e,t,r,n){var a=e[0].trace;var o=a.orientation==="h";var s=a.type==="waterfall";var l=a.type==="funnel";function u(e){var t=o?n:r;return c(t,e,true).text}function f(e){var t=o?r:n;return c(t,+e,true).text}var h=a.textinfo;var p=e[t];var d=h.split("+");var v=[];var m;var g=function(e){return d.indexOf(e)!==-1};if(g("label")){v.push(u(e[t].p))}if(g("text")){m=i.castOption(a,p.i,"text");if(m===0||m)v.push(m)}if(s){var y=+p.rawS||p.s;var x=p.v;var _=x-y;if(g("initial"))v.push(f(_));if(g("delta"))v.push(f(y));if(g("final"))v.push(f(x))}if(l){if(g("value"))v.push(f(p.s));var b=0;if(g("percent initial"))b++;if(g("percent previous"))b++;if(g("percent total"))b++;var w=b>1;if(g("percent initial")){m=i.formatPercent(p.begR);if(w)m+=" of initial";v.push(m)}if(g("percent previous")){m=i.formatPercent(p.difR);if(w)m+=" of previous";v.push(m)}if(g("percent total")){m=i.formatPercent(p.sumR);if(w)m+=" of total";v.push(m)}}return v.join("<br>")}t.exports={plot:S,toMoveInsideBar:O}},{"../../components/color":643,"../../components/drawing":665,"../../components/fx/helpers":679,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../registry":911,"./attributes":921,"./constants":923,"./helpers":927,"./style":935,"./uniform_text":937,d3:169,"fast-isnumeric":241}],933:[function(e,t,r){"use strict";t.exports=function e(t,r){var a=t.cd;var i=t.xaxis;var o=t.yaxis;var s=a[0].trace;var l=s.type==="funnel";var u=s.orientation==="h";var c=[];var f;if(r===false){for(f=0;f<a.length;f++){a[f].selected=0}}else{for(f=0;f<a.length;f++){var h=a[f];var p="ct"in h?h.ct:n(h,i,o,u,l);if(r.contains(p,false,f,t)){c.push({pointNumber:f,x:i.c2d(h.x),y:o.c2d(h.y)});h.selected=1}else{h.selected=0}}}return c};function n(e,t,r,n,a){var i=t.c2p(n?e.s0:e.p0,true);var o=t.c2p(n?e.s1:e.p1,true);var s=r.c2p(n?e.p0:e.s0,true);var l=r.c2p(n?e.p1:e.s1,true);if(a){return[(i+o)/2,(s+l)/2]}else{if(n){return[o,(s+l)/2]}else{return[(i+o)/2,l]}}}},{}],934:[function(e,t,r){"use strict";t.exports=i;var n=e("../../lib").distinctVals;var a=e("../../constants/numerical").BADNUM;function i(e,t){this.traces=e;this.sepNegVal=t.sepNegVal;this.overlapNoMerge=t.overlapNoMerge;var r=Infinity;var i=[];for(var o=0;o<e.length;o++){var s=e[o];for(var l=0;l<s.length;l++){var u=s[l];if(u.p!==a)i.push(u.p)}if(s[0]&&s[0].width1){r=Math.min(s[0].width1,r)}}this.positions=i;var c=n(i,{unitMinDiff:t.unitMinDiff});this.distinctPositions=c.vals;if(c.vals.length===1&&r!==Infinity)this.minDiff=r;else this.minDiff=Math.min(c.minDiff,r);this.binWidth=this.minDiff;this.bins={}}i.prototype.put=function e(t,r){var n=this.getLabel(t,r);var a=this.bins[n]||0;this.bins[n]=a+r;return a};i.prototype.get=function e(t,r){var n=this.getLabel(t,r);return this.bins[n]||0};i.prototype.getLabel=function e(t,r){var n=r<0&&this.sepNegVal?"v":"^";var a=this.overlapNoMerge?t:Math.round(t/this.binWidth);return n+a}},{"../../constants/numerical":753,"../../lib":778}],935:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/color");var i=e("../../components/drawing");var o=e("../../lib");var s=e("../../registry");var l=e("./uniform_text").resizeText;var u=e("./attributes");var c=u.textfont;var f=u.insidetextfont;var h=u.outsidetextfont;var p=e("./helpers");function d(e){var t=n.select(e).selectAll("g.barlayer").selectAll("g.trace");l(e,t,"bar");var r=t.size();var a=e._fullLayout;t.style("opacity",function(e){return e[0].trace.opacity}).each(function(e){if(a.barmode==="stack"&&r>1||a.bargap===0&&a.bargroupgap===0&&!e[0].trace.marker.line.width){n.select(this).attr("shape-rendering","crispEdges")}});t.selectAll("g.points").each(function(t){var r=n.select(this);var a=t[0].trace;v(r,a,e)});s.getComponentMethod("errorbars","style")(t)}function v(e,t,r){i.pointStyle(e.selectAll("path"),t,r);m(e,t,r)}function m(e,t,r){e.selectAll("text").each(function(e){var a=n.select(this);var s=o.ensureUniformFontSize(r,_(a,e,t,r));i.font(a,s)})}function g(e,t,r){var n=t[0].trace;if(n.selectedpoints){y(r,n,e)}else{v(r,n,e);s.getComponentMethod("errorbars","style")(r)}}function y(e,t,r){i.selectedPointStyle(e.selectAll("path"),t);x(e.selectAll("text"),t,r)}function x(e,t,r){e.each(function(e){var a=n.select(this);var s;if(e.selected){s=o.ensureUniformFontSize(r,_(a,e,t,r));var l=t.selected.textfont&&t.selected.textfont.color;if(l){s.color=l}i.font(a,s)}else{i.selectedTextStyle(a,t)}})}function _(e,t,r,n){var a=n._fullLayout.font;var i=r.textfont;if(e.classed("bartext-inside")){var o=A(t,r);i=w(r,t.i,a,o)}else if(e.classed("bartext-outside")){i=T(r,t.i,a)}return i}function b(e,t,r){return k(c,e.textfont,t,r)}function w(e,t,r,n){var i=b(e,t,r);var o=e._input.textfont===undefined||e._input.textfont.color===undefined||Array.isArray(e.textfont.color)&&e.textfont.color[t]===undefined;if(o){i={color:a.contrast(n),family:i.family,size:i.size}}return k(f,e.insidetextfont,t,i)}function T(e,t,r){var n=b(e,t,r);return k(h,e.outsidetextfont,t,n)}function k(e,t,r,n){t=t||{};var a=p.getValue(t.family,r);var i=p.getValue(t.size,r);var o=p.getValue(t.color,r);return{family:p.coerceString(e.family,a,n.family),size:p.coerceNumber(e.size,i,n.size),color:p.coerceColor(e.color,o,n.color)}}function A(e,t){if(t.type==="waterfall"){return t[e.dir].marker.color}return e.mc||t.marker.color}t.exports={style:d,styleTextPoints:m,styleOnSelect:g,getInsideTextFont:w,getOutsideTextFont:T,getBarColor:A,resizeText:l}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../registry":911,"./attributes":921,"./helpers":927,"./uniform_text":937,d3:169}],936:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");t.exports=function e(t,r,o,s,l){o("marker.color",s);if(a(t,"marker")){i(t,r,l,o,{prefix:"marker.",cLetter:"c"})}o("marker.line.color",n.defaultLine);if(a(t,"marker.line")){i(t,r,l,o,{prefix:"marker.line.",cLetter:"c"})}o("marker.line.width");o("marker.opacity");o("selected.marker.color");o("unselected.marker.color")}},{"../../components/color":643,"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654}],937:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");function i(e,t,r){var i=e._fullLayout;var o=i["_"+r+"Text_minsize"];if(o){var s=i.uniformtext.mode==="hide";var l;switch(r){case"funnelarea":case"pie":case"sunburst":l="g.slice";break;case"treemap":l="g.slice, g.pathbar";break;default:l="g.points > g.point"}t.selectAll(l).each(function(e){var t=e.transform;if(t){t.scale=s&&t.hide?0:o/t.fontSize;var r=n.select(this).select("text");r.attr("transform",a.getTextTransform(t))}})}}function o(e,t,r){if(r.uniformtext.mode){var n=l(e);var a=r.uniformtext.minsize;var i=t.scale*t.fontSize;t.hide=i<a;r[n]=r[n]||Infinity;if(!t.hide){r[n]=Math.min(r[n],Math.max(i,a))}}}function s(e,t){var r=l(e);t[r]=undefined}function l(e){return"_"+e+"Text_minsize"}t.exports={recordMinTextSize:o,clearMinTextSize:s,resizeText:i}},{"../../lib":778,d3:169}],938:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../../lib/extend").extendFlat;var i=e("../scatterpolar/attributes");var o=e("../bar/attributes");t.exports={r:i.r,theta:i.theta,r0:i.r0,dr:i.dr,theta0:i.theta0,dtheta:i.dtheta,thetaunit:i.thetaunit,base:a({},o.base,{}),offset:a({},o.offset,{}),width:a({},o.width,{}),text:a({},o.text,{}),hovertext:a({},o.hovertext,{}),marker:o.marker,hoverinfo:i.hoverinfo,hovertemplate:n(),selected:o.selected,unselected:o.unselected}},{"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatterpolar/attributes":1261}],939:[function(e,t,r){"use strict";var n=e("../../components/colorscale/helpers").hasColorscale;var a=e("../../components/colorscale/calc");var i=e("../bar/arrays_to_calcdata");var o=e("../bar/cross_trace_calc").setGroupPositions;var s=e("../scatter/calc_selection");var l=e("../../registry").traceIs;var u=e("../../lib").extendFlat;function c(e,t){var r=e._fullLayout;var o=t.subplot;var l=r[o].radialaxis;var u=r[o].angularaxis;var c=l.makeCalcdata(t,"r");var f=u.makeCalcdata(t,"theta");var h=t._length;var p=new Array(h);var d=c;var v=f;for(var m=0;m<h;m++){p[m]={p:v[m],s:d[m]}}function g(e){var r=t[e];if(r!==undefined){t["_"+e]=Array.isArray(r)?u.makeCalcdata(t,e):u.d2c(r,t.thetaunit)}}if(u.type==="linear"){g("width");g("offset")}if(n(t,"marker")){a(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"})}if(n(t,"marker.line")){a(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"})}i(p,t);s(p,t);return p}function f(e,t,r){var n=e.calcdata;var a=[];for(var i=0;i<n.length;i++){var s=n[i];var c=s[0].trace;if(c.visible===true&&l(c,"bar")&&c.subplot===r){a.push(s)}}var f=u({},t.radialaxis,{_id:"x"});var h=t.angularaxis;o(e,h,f,a,{mode:t.barmode,norm:t.barnorm,gap:t.bargap,groupgap:t.bargroupgap})}t.exports={calc:c,crossTraceCalc:f}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../lib":778,"../../registry":911,"../bar/arrays_to_calcdata":920,"../bar/cross_trace_calc":924,"../scatter/calc_selection":1189}],940:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatterpolar/defaults").handleRThetaDefaults;var i=e("../bar/style_defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,a){return n.coerce(t,r,o,e,a)}var c=a(t,r,l,u);if(!c){r.visible=false;return}u("thetaunit");u("base");u("offset");u("width");u("text");u("hovertext");u("hovertemplate");i(t,r,u,s,l);n.coerceSelectionMarkerOpacity(r,u)}},{"../../lib":778,"../bar/style_defaults":936,"../scatterpolar/defaults":1263,"./attributes":938}],941:[function(e,t,r){"use strict";var n=e("../../components/fx");var a=e("../../lib");var i=e("../bar/hover").getTraceColor;var o=a.fillText;var s=e("../scatterpolar/hover").makeHoverPointText;var l=e("../../plots/polar/helpers").isPtInsidePolygon;t.exports=function e(t,r,u){var c=t.cd;var f=c[0].trace;var h=t.subplot;var p=h.radialAxis;var d=h.angularAxis;var v=h.vangles;var m=v?l:a.isPtInsideSector;var g=t.maxHoverDistance;var y=d._period||2*Math.PI;var x=Math.abs(p.g2p(Math.sqrt(r*r+u*u)));var _=Math.atan2(u,r);if(p.range[0]>p.range[1]){_+=Math.PI}var b=function(e){if(m(x,_,[e.rp0,e.rp1],[e.thetag0,e.thetag1],v)){return g+Math.min(1,Math.abs(e.thetag1-e.thetag0)/y)-1+(e.rp1-x)/(e.rp1-e.rp0)-1}else{return Infinity}};n.getClosest(c,b,t);if(t.index===false)return;var w=t.index;var T=c[w];t.x0=t.x1=T.ct[0];t.y0=t.y1=T.ct[1];var k=a.extendFlat({},T,{r:T.s,theta:T.p});o(T,f,t);s(k,f,h,t);t.hovertemplate=f.hovertemplate;t.color=i(f,T);t.xLabelVal=t.yLabelVal=undefined;if(T.s<0){t.idealAlign="left"}return[t]}},{"../../components/fx":683,"../../lib":778,"../../plots/polar/helpers":893,"../bar/hover":928,"../scatterpolar/hover":1265}],942:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"barpolar",basePlotModule:e("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("../scatterpolar/format_labels"),style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../bar/select"),meta:{}}},{"../../plots/polar":894,"../bar/select":933,"../bar/style":935,"../scatter/marker_colorbar":1205,"../scatterpolar/format_labels":1264,"./attributes":938,"./calc":939,"./defaults":940,"./hover":941,"./layout_attributes":943,"./layout_defaults":944,"./plot":945}],943:[function(e,t,r){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],944:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function(e,t,r){var i={};var o;function s(r,i){return n.coerce(e[o]||{},t[o],a,r,i)}for(var l=0;l<r.length;l++){var u=r[l];if(u.type==="barpolar"&&u.visible===true){o=u.subplot;if(!i[o]){s("barmode");s("bargap");i[o]=1}}}}},{"../../lib":778,"./layout_attributes":943}],945:[function(e,t,r){"use strict";var n=e("d3");var a=e("fast-isnumeric");var i=e("../../lib");var o=e("../../components/drawing");var s=e("../../plots/polar/helpers");t.exports=function e(t,r,s){var u=r.xaxis;var c=r.yaxis;var f=r.radialAxis;var h=r.angularAxis;var p=l(r);var d=r.layers.frontplot.select("g.barlayer");i.makeTraceGroups(d,s,"trace bars").each(function(){var e=n.select(this);var s=i.ensureSingle(e,"g","points");var l=s.selectAll("g.point").data(i.identity);l.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",true);l.exit().remove();l.each(function(e){var t=n.select(this);var r=e.rp0=f.c2p(e.s0);var o=e.rp1=f.c2p(e.s1);var s=e.thetag0=h.c2g(e.p0);var l=e.thetag1=h.c2g(e.p1);var d;if(!a(r)||!a(o)||!a(s)||!a(l)||r===o||s===l){d="M0,0Z"}else{var v=f.c2g(e.s1);var m=(s+l)/2;e.ct=[u.c2p(v*Math.cos(m)),c.c2p(v*Math.sin(m))];d=p(r,o,s,l)}i.ensureSingle(t,"path").attr("d",d)});o.setClipUrl(e,r._hasClipOnAxisFalse?r.clipIds.forTraces:null,t)})};function l(e){var t=e.cxx;var r=e.cyy;if(e.vangles){return function(n,a,o,l){var u,c;if(i.angleDelta(o,l)>0){u=o;c=l}else{u=l;c=o}var f=s.findEnclosingVertexAngles(u,e.vangles)[0];var h=s.findEnclosingVertexAngles(c,e.vangles)[1];var p=[f,(u+c)/2,h];return s.pathPolygonAnnulus(n,a,u,c,p,t,r)}}return function(e,n,a,o){return i.pathAnnulus(e,n,a,o,t,r)}}},{"../../components/drawing":665,"../../lib":778,"../../plots/polar/helpers":893,d3:169,"fast-isnumeric":241}],946:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var a=e("../bar/attributes");var i=e("../../components/color/attributes");var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../lib/extend").extendFlat;var l=n.marker;var u=l.line;t.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",false],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[true,"sd",false],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:s({},l.symbol,{arrayOk:false,editType:"plot"}),opacity:s({},l.opacity,{arrayOk:false,dflt:1,editType:"style"}),size:s({},l.size,{arrayOk:false,editType:"calc"}),color:s({},l.color,{arrayOk:false,editType:"style"}),line:{color:s({},u.color,{arrayOk:false,dflt:i.defaultLine,editType:"style"}),width:s({},u.width,{arrayOk:false,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:n.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:{marker:n.selected.marker,editType:"style"},unselected:{marker:n.unselected.marker,editType:"style"},text:s({},n.text,{}),hovertext:s({},n.hovertext,{}),hovertemplate:o({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187}],947:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../plots/cartesian/axes");var i=e("../../plots/cartesian/align_period");var o=e("../../lib");var s=e("../../constants/numerical").BADNUM;var l=o._;t.exports=function e(t,r){var i=t._fullLayout;var h=a.getFromId(t,r.xaxis||"x");var w=a.getFromId(t,r.yaxis||"y");var T=[];var k=r.type==="violin"?"_numViolins":"_numBoxes";var A,M;var E,S;var C,L;var I;if(r.orientation==="h"){E=h;S="x";C=w;L="y";I=!!r.yperiodalignment}else{E=w;S="y";C=h;L="x";I=!!r.xperiodalignment}var O=u(r,L,C,i[k]);var P=O[0];var D=O[1];var R=o.distinctVals(P);var z=R.vals;var N=R.minDiff/2;var F;var B;var j;var U;var H;var V;var G=(r.boxpoints||r.points)==="all"?o.identity:function(e){return e.v<F.lf||e.v>F.uf};if(r._hasPreCompStats){var q=r[S];var Y=function(e){return E.d2c((r[e]||[])[A])};var W=Infinity;var X=-Infinity;for(A=0;A<r._length;A++){var Z=P[A];if(!n(Z))continue;F={};F.pos=F[L]=Z;if(I&&D){F.orig_p=D[A]}F.q1=Y("q1");F.med=Y("median");F.q3=Y("q3");B=[];if(q&&o.isArrayOrTypedArray(q[A])){for(M=0;M<q[A].length;M++){V=E.d2c(q[A][M]);if(V!==s){H={v:V,i:[A,M]};p(H,r,[A,M]);B.push(H)}}}F.pts=B.sort(v);j=F[S]=B.map(m);U=j.length;if(F.med!==s&&F.q1!==s&&F.q3!==s&&F.med>=F.q1&&F.q3>=F.med){var K=Y("lowerfence");F.lf=K!==s&&K<=F.q1?K:g(F,j,U);var J=Y("upperfence");F.uf=J!==s&&J>=F.q3?J:y(F,j,U);var Q=Y("mean");F.mean=Q!==s?Q:U?o.mean(j,U):(F.q1+F.q3)/2;var $=Y("sd");F.sd=Q!==s&&$>=0?$:U?o.stdev(j,U,F.mean):F.q3-F.q1;F.lo=x(F);F.uo=_(F);var ee=Y("notchspan");ee=ee!==s&&ee>0?ee:b(F,U);F.ln=F.med-ee;F.un=F.med+ee;var te=F.lf;var re=F.uf;if(r.boxpoints&&j.length){te=Math.min(te,j[0]);re=Math.max(re,j[U-1])}if(r.notched){te=Math.min(te,F.ln);re=Math.max(re,F.un)}F.min=te;F.max=re}else{o.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+F.q1,"median = "+F.med,"q3 = "+F.q3].join("\n"));var ne;if(F.med!==s){ne=F.med}else if(F.q1!==s){if(F.q3!==s)ne=(F.q1+F.q3)/2;else ne=F.q1}else if(F.q3!==s){ne=F.q3}else{ne=0}F.med=ne;F.q1=F.q3=ne;F.lf=F.uf=ne;F.mean=F.sd=ne;F.ln=F.un=ne;F.min=F.max=ne}W=Math.min(W,F.min);X=Math.max(X,F.max);F.pts2=B.filter(G);T.push(F)}r._extremes[E._id]=a.findExtremes(E,[W,X],{padded:true})}else{var ae=E.makeCalcdata(r,S);var ie=c(z,N);var oe=z.length;var se=f(oe);for(A=0;A<r._length;A++){V=ae[A];if(!n(V))continue;var le=o.findBin(P[A],ie);if(le>=0&&le<oe){H={v:V,i:A};p(H,r,A);se[le].push(H)}}var ue=Infinity;var ce=-Infinity;var fe=r.quartilemethod;var he=fe==="exclusive";var pe=fe==="inclusive";for(A=0;A<oe;A++){if(se[A].length>0){F={};F.pos=F[L]=z[A];B=F.pts=se[A].sort(v);j=F[S]=B.map(m);U=j.length;F.min=j[0];F.max=j[U-1];F.mean=o.mean(j,U);F.sd=o.stdev(j,U,F.mean);F.med=o.interp(j,.5);if(U%2&&(he||pe)){var de;var ve;if(he){de=j.slice(0,U/2);ve=j.slice(U/2+1)}else if(pe){de=j.slice(0,U/2+1);ve=j.slice(U/2)}F.q1=o.interp(de,.5);F.q3=o.interp(ve,.5)}else{F.q1=o.interp(j,.25);F.q3=o.interp(j,.75)}F.lf=g(F,j,U);F.uf=y(F,j,U);F.lo=x(F);F.uo=_(F);var me=b(F,U);F.ln=F.med-me;F.un=F.med+me;ue=Math.min(ue,F.ln);ce=Math.max(ce,F.un);F.pts2=B.filter(G);T.push(F)}}r._extremes[E._id]=a.findExtremes(E,r.notched?ae.concat([ue,ce]):ae,{padded:true})}d(T,r);if(T.length>0){T[0].t={num:i[k],dPos:N,posLetter:L,valLetter:S,labels:{med:l(t,"median:"),min:l(t,"min:"),q1:l(t,"q1:"),q3:l(t,"q3:"),max:l(t,"max:"),mean:r.boxmean==="sd"?l(t,"mean ± σ:"):l(t,"mean:"),lf:l(t,"lower fence:"),uf:l(t,"upper fence:")}};i[k]++;return T}else{return[{t:{empty:true}}]}};function u(e,t,r,a){var s=t in e;var l=t+"0"in e;var u="d"+t in e;if(s||l&&u){var c=r.makeCalcdata(e,t);var f=i(e,r,t,c);return[f,c]}var h;if(l){h=e[t+"0"]}else if("name"in e&&(r.type==="category"||n(e.name)&&["linear","log"].indexOf(r.type)!==-1||o.isDateTime(e.name)&&r.type==="date")){h=e.name}else{h=a}var p=r.type==="multicategory"?r.r2c_just_indices(h):r.d2c(h,0,e[t+"calendar"]);var d=e._length;var v=new Array(d);for(var m=0;m<d;m++)v[m]=p;return[v]}function c(e,t){var r=e.length;var n=new Array(r+1);for(var a=0;a<r;a++){n[a]=e[a]-t}n[r]=e[r-1]+t;return n}function f(e){var t=new Array(e);for(var r=0;r<e;r++){t[r]=[]}return t}var h={text:"tx",hovertext:"htx"};function p(e,t,r){for(var n in h){if(o.isArrayOrTypedArray(t[n])){if(Array.isArray(r)){if(o.isArrayOrTypedArray(t[n][r[0]])){e[h[n]]=t[n][r[0]][r[1]]}}else{e[h[n]]=t[n][r]}}}}function d(e,t){if(o.isArrayOrTypedArray(t.selectedpoints)){for(var r=0;r<e.length;r++){var n=e[r].pts||[];var a={};for(var i=0;i<n.length;i++){a[n[i].i]=i}o.tagSelected(n,t,a)}}}function v(e,t){return e.v-t.v}function m(e){return e.v}function g(e,t,r){if(r===0)return e.q1;return Math.min(e.q1,t[Math.min(o.findBin(2.5*e.q1-1.5*e.q3,t,true)+1,r-1)])}function y(e,t,r){if(r===0)return e.q3;return Math.max(e.q3,t[Math.max(o.findBin(2.5*e.q3-1.5*e.q1,t),0)])}function x(e){return 4*e.q1-3*e.q3}function _(e){return 4*e.q3-3*e.q1}function b(e,t){if(t===0)return 0;return 1.57*(e.q3-e.q1)/Math.sqrt(t)}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"fast-isnumeric":241}],948:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib");var i=e("../../plots/cartesian/constraints").getAxisGroup;var o=["v","h"];function s(e,t){var r=e.calcdata;var n=t.xaxis;var a=t.yaxis;for(var i=0;i<o.length;i++){var s=o[i];var u=s==="h"?a:n;var c=[];for(var f=0;f<r.length;f++){var h=r[f];var p=h[0].t;var d=h[0].trace;if(d.visible===true&&(d.type==="box"||d.type==="candlestick")&&!p.empty&&(d.orientation||"v")===s&&d.xaxis===n._id&&d.yaxis===a._id){c.push(f)}}l("box",e,c,u)}}function l(e,t,r,o){var s=t.calcdata;var l=t._fullLayout;var u=o._id;var c=u.charAt(0);var f,h,p;var d=[];var v=0;for(f=0;f<r.length;f++){p=s[r[f]];for(h=0;h<p.length;h++){d.push(o.c2l(p[h].pos,true));v+=(p[h].pts2||[]).length}}if(!d.length)return;var m=a.distinctVals(d,{unitMinDiff:o.type==="category"||o.type==="multicategory"});var g=m.minDiff/2;n.minDtick(o,m.minDiff,m.vals[0],true);var y=e==="violin"?"_numViolins":"_numBoxes";var x=l[y];var _=l[e+"mode"]==="group"&&x>1;var b=1-l[e+"gap"];var w=1-l[e+"groupgap"];for(f=0;f<r.length;f++){p=s[r[f]];var T=p[0].trace;var k=p[0].t;var A=T.width;var M=T.side;var E;var S;var C;var L;if(A){E=S=L=A/2;C=0}else{E=g;if(_){var I=i(l,o._id)+T.orientation;var O=l._alignmentOpts[I]||{};var P=O[T.alignmentgroup]||{};var D=Object.keys(P.offsetGroups||{}).length;var R=D||x;var z=D?T._offsetIndex:k.num;S=E*b*w/R;C=2*E*(-.5+(z+.5)/R)*b;L=E*b/R}else{S=E*b*w;C=0;L=E}}k.dPos=E;k.bPos=C;k.bdPos=S;k.wHover=L;var N;var F;var B=C+S;var j;var U;var H;var V;var G;var q;var Y=Boolean(A);var W=(T.boxpoints||T.points)&&v>0;if(M==="positive"){N=E*(A?1:.5);j=B;F=j=C}else if(M==="negative"){N=j=C;F=E*(A?1:.5);U=B}else{N=F=E;j=U=B}if(W){var X=T.pointpos;var Z=T.jitter;var K=T.marker.size/2;var J=0;if(X+Z>=0){J=B*(X+Z);if(J>N){Y=true;G=K;H=J}else if(J>j){G=K;H=N}}if(J<=N){H=N}var Q=0;if(X-Z<=0){Q=-B*(X-Z);if(Q>F){Y=true;q=K;V=Q}else if(Q>U){q=K;V=F}}if(Q<=F){V=F}}else{H=N;V=F}var $=new Array(p.length);for(h=0;h<p.length;h++){$[h]=p[h].pos}T._extremes[u]=n.findExtremes(o,$,{padded:Y,vpadminus:V,vpadplus:H,vpadLinearized:true,ppadminus:{x:q,y:G}[c],ppadplus:{x:G,y:q}[c]})}}t.exports={crossTraceCalc:s,setPositionOffset:l}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../plots/cartesian/constraints":835}],949:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");var i=e("../../components/color");var o=e("../scatter/period_defaults");var s=e("../bar/defaults").handleGroupingDefaults;var l=e("../../plots/cartesian/axis_autotype");var u=e("./attributes");function c(e,t,r,a){function s(r,a){return n.coerce(e,t,u,r,a)}f(e,t,s,a);if(t.visible===false)return;o(e,t,a,s);var l=t._hasPreCompStats;if(l){s("lowerfence");s("upperfence")}s("line.color",(e.marker||{}).color||r);s("line.width");s("fillcolor",i.addOpacity(t.line.color,.5));var c=false;if(l){var p=s("mean");var d=s("sd");if(p&&p.length){c=true;if(d&&d.length)c="sd"}}s("boxmean",c);s("whiskerwidth");s("width");s("quartilemethod");var v=false;if(l){var m=s("notchspan");if(m&&m.length){v=true}}else if(n.validate(e.notchwidth,u.notchwidth)){v=true}var g=s("notched",v);if(g)s("notchwidth");h(e,t,s,{prefix:"box"})}function f(e,t,r,i){function o(e){var t=0;if(e&&e.length){t+=1;if(n.isArrayOrTypedArray(e[0])&&e[0].length){t+=1}}return t}function s(t){return n.validate(e[t],u[t])}var c=r("y");var f=r("x");var h;if(t.type==="box"){var p=r("q1");var d=r("median");var v=r("q3");t._hasPreCompStats=p&&p.length&&d&&d.length&&v&&v.length;h=Math.min(n.minRowLength(p),n.minRowLength(d),n.minRowLength(v))}var m=o(c);var g=o(f);var y=m&&n.minRowLength(c);var x=g&&n.minRowLength(f);var _=i.calendar;var b={autotypenumbers:i.autotypenumbers};var w,T;if(t._hasPreCompStats){switch(String(g)+String(m)){case"00":var k=s("x0")||s("dx");var A=s("y0")||s("dy");if(A&&!k){w="h"}else{w="v"}T=h;break;case"10":w="v";T=Math.min(h,x);break;case"20":w="h";T=Math.min(h,f.length);break;case"01":w="h";T=Math.min(h,y);break;case"02":w="v";T=Math.min(h,c.length);break;case"12":w="v";T=Math.min(h,x,c.length);break;case"21":w="h";T=Math.min(h,f.length,y);break;case"11":T=0;break;case"22":var M=false;var E;for(E=0;E<f.length;E++){if(l(f[E],_,b)==="category"){M=true;break}}if(M){w="v";T=Math.min(h,x,c.length)}else{for(E=0;E<c.length;E++){if(l(c[E],_,b)==="category"){M=true;break}}if(M){w="h";T=Math.min(h,f.length,y)}else{w="v";T=Math.min(h,x,c.length)}}break}}else if(m>0){w="v";if(g>0){T=Math.min(x,y)}else{T=Math.min(y)}}else if(g>0){w="h";T=Math.min(x)}else{T=0}if(!T){t.visible=false;return}t._length=T;var S=r("orientation",w);if(t._hasPreCompStats){if(S==="v"&&g===0){r("x0",0);r("dx",1)}else if(S==="h"&&m===0){r("y0",0);r("dy",1)}}else{if(S==="v"&&g===0){r("x0")}else if(S==="h"&&m===0){r("y0")}}var C=a.getComponentMethod("calendars","handleTraceDefaults");C(e,t,["x","y"],i)}function h(e,t,r,a){var i=a.prefix;var o=n.coerce2(e,t,u,"marker.outliercolor");var s=r("marker.line.outliercolor");var l="outliers";if(t._hasPreCompStats){l="all"}else if(o||s){l="suspectedoutliers"}var c=r(i+"points",l);if(c){r("jitter",c==="all"?.3:0);r("pointpos",c==="all"?-1.5:0);r("marker.symbol");r("marker.opacity");r("marker.size");r("marker.color",t.line.color);r("marker.line.color");r("marker.line.width");if(c==="suspectedoutliers"){r("marker.line.outliercolor",t.marker.color);r("marker.line.outlierwidth")}r("selected.marker.color");r("unselected.marker.color");r("selected.marker.size");r("unselected.marker.size");r("text");r("hovertext")}else{delete t.marker}var f=r("hoveron");if(f==="all"||f.indexOf("points")!==-1){r("hovertemplate")}n.coerceSelectionMarkerOpacity(t,r)}function p(e,t){var r,a;function i(e){return n.coerce(a._input,a,u,e)}for(var o=0;o<e.length;o++){a=e[o];var l=a.type;if(l==="box"||l==="violin"){r=a._input;if(t[l+"mode"]==="group"){s(r,a,t,i)}}}}t.exports={supplyDefaults:c,crossTraceDefaults:p,handleSampleDefaults:f,handlePointsDefaults:h}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/axis_autotype":829,"../../registry":911,"../bar/defaults":925,"../scatter/period_defaults":1207,"./attributes":946}],950:[function(e,t,r){"use strict";t.exports=function e(t,r){if(r.hoverOnBox)t.hoverOnBox=r.hoverOnBox;if("xVal"in r)t.x=r.xVal;if("yVal"in r)t.y=r.yVal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;return t}},{}],951:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib");var i=e("../../components/fx");var o=e("../../components/color");var s=a.fillText;function l(e,t,r,n){var a=e.cd;var i=a[0].trace;var o=i.hoveron;var s=[];var l;if(o.indexOf("boxes")!==-1){s=s.concat(u(e,t,r,n))}if(o.indexOf("points")!==-1){l=c(e,t,r)}if(n==="closest"){if(l)return[l];return s}if(l){s.push(l);return s}return s}function u(e,t,r,s){var l=e.cd;var u=e.xa;var c=e.ya;var f=l[0].trace;var h=l[0].t;var p=f.type==="violin";var d=[];var v,m,g,y,x,_,b,w,T,k,A;var M=h.bdPos;var E,S;var C=h.wHover;var L=function(e){return g.c2l(e.pos)+h.bPos-g.c2l(_)};if(p&&f.side!=="both"){if(f.side==="positive"){T=function(e){var t=L(e);return i.inbox(t,t+C,k)};E=M;S=0}if(f.side==="negative"){T=function(e){var t=L(e);return i.inbox(t-C,t,k)};E=0;S=M}}else{T=function(e){var t=L(e);return i.inbox(t-C,t+C,k)};E=S=M}var I;if(p){I=function(e){return i.inbox(e.span[0]-x,e.span[1]-x,k)}}else{I=function(e){return i.inbox(e.min-x,e.max-x,k)}}if(f.orientation==="h"){x=t;_=r;b=I;w=T;v="y";g=c;m="x";y=u}else{x=r;_=t;b=T;w=I;v="x";g=u;m="y";y=c}var O=Math.min(1,M/Math.abs(g.r2c(g.range[1])-g.r2c(g.range[0])));k=e.maxHoverDistance-O;A=e.maxSpikeDistance-O;function P(e){return(b(e)+w(e))/2}var D=i.getDistanceFunction(s,b,w,P);i.getClosest(l,D,e);if(e.index===false)return[];var R=l[e.index];var z=f.line.color;var N=(f.marker||{}).color;if(o.opacity(z)&&f.line.width)e.color=z;else if(o.opacity(N)&&f.boxpoints)e.color=N;else e.color=f.fillcolor;e[v+"0"]=g.c2p(R.pos+h.bPos-S,true);e[v+"1"]=g.c2p(R.pos+h.bPos+E,true);e[v+"LabelVal"]=R.orig_p!==undefined?R.orig_p:R.pos;var F=v+"Spike";e.spikeDistance=P(R)*A/k;e[F]=g.c2p(R.pos,true);var B={};var j=["med","q1","q3","min","max"];if(f.boxmean||(f.meanline||{}).visible){j.push("mean")}if(f.boxpoints||f.points){j.push("lf","uf")}for(var U=0;U<j.length;U++){var H=j[U];if(!(H in R)||R[H]in B)continue;B[R[H]]=true;var V=R[H];var G=y.c2p(V,true);var q=a.extendFlat({},e);q.attr=H;q[m+"0"]=q[m+"1"]=G;q[m+"LabelVal"]=V;q[m+"Label"]=(h.labels?h.labels[H]+" ":"")+n.hoverLabelText(y,V);q.hoverOnBox=true;if(H==="mean"&&"sd"in R&&f.boxmean==="sd"){q[m+"err"]=R.sd}e.name="";e.spikeDistance=undefined;e[F]=undefined;q.hovertemplate=false;d.push(q)}return d}function c(e,t,r){var n=e.cd;var o=e.xa;var l=e.ya;var u=n[0].trace;var c=o.c2p(t);var f=l.c2p(r);var h;var p=function(e){var t=Math.max(3,e.mrc||0);return Math.max(Math.abs(o.c2p(e.x)-c)-t,1-3/t)};var d=function(e){var t=Math.max(3,e.mrc||0);return Math.max(Math.abs(l.c2p(e.y)-f)-t,1-3/t)};var v=i.quadrature(p,d);var m=false;var g,y;for(var x=0;x<n.length;x++){g=n[x];for(var _=0;_<(g.pts||[]).length;_++){y=g.pts[_];var b=v(y);if(b<=e.distance){e.distance=b;m=[x,_]}}}if(!m)return false;g=n[m[0]];y=g.pts[m[1]];var w=o.c2p(y.x,true);var T=l.c2p(y.y,true);var k=y.mrc||1;h=a.extendFlat({},e,{index:y.i,color:(u.marker||{}).color,name:u.name,x0:w-k,x1:w+k,y0:T-k,y1:T+k,spikeDistance:e.distance,hovertemplate:u.hovertemplate});var A=g.orig_p;var M=A!==undefined?A:g.pos;var E;if(u.orientation==="h"){E=l;h.xLabelVal=y.x;h.yLabelVal=M}else{E=o;h.xLabelVal=M;h.yLabelVal=y.y}var S=E._id.charAt(0);h[S+"Spike"]=E.c2p(g.pos,true);s(y,u,h);return h}t.exports={hoverPoints:l,hoverOnBoxes:u,hoverOnPoints:c}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"../../plots/cartesian/axes":828}],952:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults").supplyLayoutDefaults,calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"box",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"./attributes":946,"./calc":947,"./cross_trace_calc":948,"./defaults":949,"./event_data":950,"./hover":951,"./layout_attributes":953,"./layout_defaults":954,"./plot":955,"./select":956,"./style":957}],953:[function(e,t,r){"use strict";t.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],954:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("./layout_attributes");function o(e,t,r,a,i){var o=i+"Layout";var s=false;for(var l=0;l<r.length;l++){var u=r[l];if(n.traceIs(u,o)){s=true;break}}if(!s)return;a(i+"mode");a(i+"gap");a(i+"groupgap")}function s(e,t,r){function n(r,n){return a.coerce(e,t,i,r,n)}o(e,t,r,n,"box")}t.exports={supplyLayoutDefaults:s,_supply:o}},{"../../lib":778,"../../registry":911,"./layout_attributes":953}],955:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=5;var s=.01;function l(e,t,r,i){var o=t.xaxis;var s=t.yaxis;a.makeTraceGroups(i,r,"trace boxes").each(function(e){var t=n.select(this);var r=e[0];var a=r.t;var i=r.trace;a.wdPos=a.bdPos*i.whiskerwidth;if(i.visible!==true||a.empty){t.remove();return}var l,h;if(i.orientation==="h"){l=s;h=o}else{l=o;h=s}u(t,{pos:l,val:h},i,a);c(t,{x:o,y:s},i,a);f(t,{pos:l,val:h},i,a)})}function u(e,t,r,i){var o=r.orientation==="h";var s=t.val;var l=t.pos;var u=!!l.rangebreaks;var c=i.bPos;var f=i.wdPos||0;var h=i.bPosPxOffset||0;var p=r.whiskerwidth||0;var d=r.notched||false;var v=d?1-2*r.notchwidth:1;var m;var g;if(Array.isArray(i.bdPos)){m=i.bdPos[0];g=i.bdPos[1]}else{m=i.bdPos;g=i.bdPos}var y=e.selectAll("path.box").data(r.type!=="violin"||r.box.visible?a.identity:[]);y.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box");y.exit().remove();y.each(function(e){if(e.empty)return"M0,0Z";var t=l.c2l(e.pos+c,true);var i=l.l2p(t-m)+h;var y=l.l2p(t+g)+h;var x=u?(i+y)/2:l.l2p(t)+h;var _=r.whiskerwidth;var b=u?i*_+(1-_)*x:l.l2p(t-f)+h;var w=u?y*_+(1-_)*x:l.l2p(t+f)+h;var T=l.l2p(t-m*v)+h;var k=l.l2p(t+g*v)+h;var A=s.c2p(e.q1,true);var M=s.c2p(e.q3,true);var E=a.constrain(s.c2p(e.med,true),Math.min(A,M)+1,Math.max(A,M)-1);var S=e.lf===undefined||r.boxpoints===false;var C=s.c2p(S?e.min:e.lf,true);var L=s.c2p(S?e.max:e.uf,true);var I=s.c2p(e.ln,true);var O=s.c2p(e.un,true);if(o){n.select(this).attr("d","M"+E+","+T+"V"+k+"M"+A+","+i+"V"+y+(d?"H"+I+"L"+E+","+k+"L"+O+","+y:"")+"H"+M+"V"+i+(d?"H"+O+"L"+E+","+T+"L"+I+","+i:"")+"Z"+"M"+A+","+x+"H"+C+"M"+M+","+x+"H"+L+(p===0?"":"M"+C+","+b+"V"+w+"M"+L+","+b+"V"+w))}else{n.select(this).attr("d","M"+T+","+E+"H"+k+"M"+i+","+A+"H"+y+(d?"V"+I+"L"+k+","+E+"L"+y+","+O:"")+"V"+M+"H"+i+(d?"V"+O+"L"+T+","+E+"L"+i+","+I:"")+"Z"+"M"+x+","+A+"V"+C+"M"+x+","+M+"V"+L+(p===0?"":"M"+b+","+C+"H"+w+"M"+b+","+L+"H"+w))}})}function c(e,t,r,n){var l=t.x;var u=t.y;var c=n.bdPos;var f=n.bPos;var h=r.boxpoints||r.points;a.seedPseudoRandom();var p=function(e){e.forEach(function(e){e.t=n;e.trace=r});return e};var d=e.selectAll("g.points").data(h?p:[]);d.enter().append("g").attr("class","points");d.exit().remove();var v=d.selectAll("path").data(function(e){var t;var n=e.pts2;var i=Math.max((e.max-e.min)/10,e.q3-e.q1);var l=i*1e-9;var u=i*s;var p=[];var d=0;var v;if(r.jitter){if(i===0){d=1;p=new Array(n.length);for(t=0;t<n.length;t++){p[t]=1}}else{for(t=0;t<n.length;t++){var m=Math.max(0,t-o);var g=n[m].v;var y=Math.min(n.length-1,t+o);var x=n[y].v;if(h!=="all"){if(n[t].v<e.lf)x=Math.min(x,e.lf);else g=Math.max(g,e.uf)}var _=Math.sqrt(u*(y-m)/(x-g+l))||0;_=a.constrain(Math.abs(_),0,1);p.push(_);d=Math.max(_,d)}}v=r.jitter*2/(d||1)}for(t=0;t<n.length;t++){var b=n[t];var w=b.v;var T=r.jitter?v*p[t]*(a.pseudoRandom()-.5):0;var k=e.pos+f+c*(r.pointpos+T);if(r.orientation==="h"){b.y=k;b.x=w}else{b.x=k;b.y=w}if(h==="suspectedoutliers"&&w<e.uo&&w>e.lo){b.so=true}}return n});v.enter().append("path").classed("point",true);v.exit().remove();v.call(i.translatePoints,l,u)}function f(e,t,r,i){var o=t.val;var s=t.pos;var l=!!s.rangebreaks;var u=i.bPos;var c=i.bPosPxOffset||0;var f=r.boxmean||(r.meanline||{}).visible;var h;var p;if(Array.isArray(i.bdPos)){h=i.bdPos[0];p=i.bdPos[1]}else{h=i.bdPos;p=i.bdPos}var d=e.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box.visible&&r.meanline.visible?a.identity:[]);d.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"});d.exit().remove();d.each(function(e){var t=s.c2l(e.pos+u,true);var a=s.l2p(t-h)+c;var i=s.l2p(t+p)+c;var d=l?(a+i)/2:s.l2p(t)+c;var v=o.c2p(e.mean,true);var m=o.c2p(e.mean-e.sd,true);var g=o.c2p(e.mean+e.sd,true);if(r.orientation==="h"){n.select(this).attr("d","M"+v+","+a+"V"+i+(f==="sd"?"m0,0L"+m+","+d+"L"+v+","+a+"L"+g+","+d+"Z":""))}else{n.select(this).attr("d","M"+a+","+v+"H"+i+(f==="sd"?"m0,0L"+d+","+m+"L"+a+","+v+"L"+d+","+g+"Z":""))}})}t.exports={plot:l,plotBoxAndWhiskers:u,plotPoints:c,plotBoxMean:f}},{"../../components/drawing":665,"../../lib":778,d3:169}],956:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t.cd;var a=t.xaxis;var i=t.yaxis;var o=[];var s,l;if(r===false){for(s=0;s<n.length;s++){for(l=0;l<(n[s].pts||[]).length;l++){n[s].pts[l].selected=0}}}else{for(s=0;s<n.length;s++){for(l=0;l<(n[s].pts||[]).length;l++){var u=n[s].pts[l];var c=a.c2p(u.x);var f=i.c2p(u.y);if(r.contains([c,f],null,u.i,t)){o.push({pointNumber:u.i,x:a.c2d(u.x),y:i.c2d(u.y)});u.selected=1}else{u.selected=0}}}}return o}},{}],957:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/color");var i=e("../../components/drawing");function o(e,t,r){var o=r?r:n.select(e).selectAll("g.trace.boxes");o.style("opacity",function(e){return e[0].trace.opacity});o.each(function(t){var r=n.select(this);var o=t[0].trace;var s=o.line.width;function l(e,t,r,n){e.style("stroke-width",t+"px").call(a.stroke,r).call(a.fill,n)}var u=r.selectAll("path.box");if(o.type==="candlestick"){u.each(function(e){if(e.empty)return;var t=n.select(this);var r=o[e.dir];l(t,r.line.width,r.line.color,r.fillcolor);t.style("opacity",o.selectedpoints&&!e.selected?.3:1)})}else{l(u,s,o.line.color,o.fillcolor);r.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(a.stroke,o.line.color);var c=r.selectAll("path.point");i.pointStyle(c,o,e)}})}function s(e,t,r){var n=t[0].trace;var a=r.selectAll("path.point");if(n.selectedpoints){i.selectedPointStyle(a,n)}else{i.pointStyle(a,n,e)}}t.exports={style:o,styleOnSelect:s}},{"../../components/color":643,"../../components/drawing":665,d3:169}],958:[function(e,t,r){"use strict";var n=e("../../lib").extendFlat;var a=e("../ohlc/attributes");var i=e("../box/attributes");function o(e){return{line:{color:n({},i.line.color,{dflt:e}),width:i.line.width,editType:"style"},fillcolor:i.fillcolor,editType:"style"}}t.exports={xperiod:a.xperiod,xperiod0:a.xperiod0,xperiodalignment:a.xperiodalignment,x:a.x,open:a.open,high:a.high,low:a.low,close:a.close,line:{width:n({},i.line.width,{}),editType:"style"},increasing:o(a.increasing.line.color.dflt),decreasing:o(a.decreasing.line.color.dflt),text:a.text,hovertext:a.hovertext,whiskerwidth:n({},i.whiskerwidth,{dflt:0}),hoverlabel:a.hoverlabel}},{"../../lib":778,"../box/attributes":946,"../ohlc/attributes":1133}],959:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../../plots/cartesian/align_period");var o=e("../ohlc/calc").calcCommon;t.exports=function(e,t){var r=e._fullLayout;var l=a.getFromId(e,t.xaxis);var u=a.getFromId(e,t.yaxis);var c=l.makeCalcdata(t,"x");var f=i(t,l,"x",c);var h=o(e,t,c,f,u,s);if(h.length){n.extendFlat(h[0].t,{num:r._numBoxes,dPos:n.distinctVals(f).minDiff/2,posLetter:"x",valLetter:"y"});r._numBoxes++;return h}else{return[{t:{empty:true}}]}};function s(e,t,r,n){return{min:r,q1:Math.min(e,n),med:n,q3:Math.max(e,n),max:t}}},{"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../ohlc/calc":1134}],960:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../ohlc/ohlc_defaults");var o=e("../scatter/period_defaults");var s=e("./attributes");t.exports=function e(t,r,a,u){function c(e,a){return n.coerce(t,r,s,e,a)}var f=i(t,r,c,u);if(!f){r.visible=false;return}o(t,r,u,c,{x:true});c("line.width");l(t,r,c,"increasing");l(t,r,c,"decreasing");c("text");c("hovertext");c("whiskerwidth");u._requestRangeslider[r.xaxis]=true};function l(e,t,r,n){var i=r(n+".line.color");r(n+".line.width",t.line.width);r(n+".fillcolor",a.addOpacity(i,.5))}},{"../../components/color":643,"../../lib":778,"../ohlc/ohlc_defaults":1138,"../scatter/period_defaults":1207,"./attributes":958}],961:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"candlestick",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:e("./attributes"),layoutAttributes:e("../box/layout_attributes"),supplyLayoutDefaults:e("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:e("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("../box/plot").plot,layerName:"boxlayer",style:e("../box/style").style,hoverPoints:e("../ohlc/hover").hoverPoints,selectPoints:e("../ohlc/select")}},{"../../plots/cartesian":841,"../box/cross_trace_calc":948,"../box/layout_attributes":953,"../box/layout_defaults":954,"../box/plot":955,"../box/style":957,"../ohlc/hover":1136,"../ohlc/select":1140,"./attributes":958,"./calc":959,"./defaults":960}],962:[function(e,t,r){"use strict";var n=e("./axis_defaults");var a=e("../../plot_api/plot_template");t.exports=function e(t,r,n,a,o){var s=a("a");if(!s){a("da");a("a0")}var l=a("b");if(!l){a("db");a("b0")}i(t,r,n,o)};function i(e,t,r,i){var o=["aaxis","baxis"];o.forEach(function(o){var s=o.charAt(0);var l=e[o]||{};var u=a.newContainer(t,o);var c={tickfont:"x",id:s+"axis",letter:s,font:t.font,name:o,data:e[s],calendar:t.calendar,dfltColor:i,bgColor:r.paper_bgcolor,autotypenumbersDflt:r.autotypenumbers,fullLayout:r};n(l,u,c);u._categories=u._categories||[];if(!e[o]&&l.type!=="-"){e[o]={type:l.type}}})}},{"../../plot_api/plot_template":817,"./axis_defaults":967}],963:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;t.exports=function(e){return a(e,0)};function a(e,t){if(!n(e)||t>=10){return null}var r=Infinity;var i=-Infinity;var o=e.length;for(var s=0;s<o;s++){var l=e[s];if(n(l)){var u=a(l,t+1);if(u){r=Math.min(u[0],r);i=Math.max(u[1],i)}}else{r=Math.min(l,r);i=Math.max(l,i)}}return[r,i]}},{"../../lib":778}],964:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("./axis_attributes");var i=e("../../components/color/attributes");var o=n({editType:"calc"});o.family.dflt='"Open Sans", verdana, arial, sans-serif';o.size.dflt=12;o.color.dflt=i.defaultLine;t.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:a,baxis:a,font:o,color:{valType:"color",dflt:i.defaultLine,editType:"plot"},transforms:undefined}},{"../../components/color/attributes":642,"../../plots/font_attributes":856,"./axis_attributes":966}],965:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,a){var i,o,s,l,u,c;var f,h,p,d,v,m,g;var y=n(r)?"a":"b";var x=y==="a"?e.aaxis:e.baxis;var _=x.smoothing;var b=y==="a"?e.a2i:e.b2j;var w=y==="a"?r:a;var T=y==="a"?a:r;var k=y==="a"?t.a.length:t.b.length;var A=y==="a"?t.b.length:t.a.length;var M=Math.floor(y==="a"?e.b2j(T):e.a2i(T));var E=y==="a"?function(t){return e.evalxy([],t,M)}:function(t){return e.evalxy([],M,t)};if(_){s=Math.max(0,Math.min(A-2,M));l=M-s;o=y==="a"?function(t,r){return e.dxydi([],t,s,r,l)}:function(t,r){return e.dxydj([],s,t,l,r)}}var S=b(w[0]);var C=b(w[1]);var L=S<C?1:-1;var I=(C-S)*1e-8;var O=L>0?Math.floor:Math.ceil;var P=L>0?Math.ceil:Math.floor;var D=L>0?Math.min:Math.max;var R=L>0?Math.max:Math.min;var z=O(S+I);var N=P(C-I);f=E(S);var F=[[f]];for(i=z;i*L<N*L;i+=L){u=[];v=R(S,i);m=D(C,i+L);g=m-v;c=Math.max(0,Math.min(k-2,Math.floor(.5*(v+m))));h=E(m);if(_){p=o(c,v-c);d=o(c,m-c);u.push([f[0]+p[0]/3*g,f[1]+p[1]/3*g]);u.push([h[0]-d[0]/3*g,h[1]-d[1]/3*g])}u.push(h);F.push(u);f=h}return F}},{"../../lib":778}],966:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("../../components/color/attributes");var i=e("../../plots/cartesian/layout_attributes");var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../constants/docs").FORMAT_LINK;var l=e("../../constants/docs").TIME_FORMAT_LINK;t.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:n({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:i.autotypenumbers,autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:n({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:false,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:o(i.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:false,editType:"calc"},linecolor:{valType:"color",dflt:a.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:true,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:a.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:n({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":642,"../../constants/docs":748,"../../plot_api/edit_types":810,"../../plots/cartesian/layout_attributes":842,"../../plots/font_attributes":856}],967:[function(e,t,r){"use strict";var n=e("./attributes");var a=e("../../components/color").addOpacity;var i=e("../../registry");var o=e("../../lib");var s=e("../../plots/cartesian/tick_value_defaults");var l=e("../../plots/cartesian/tick_label_defaults");var u=e("../../plots/cartesian/category_order_defaults");var c=e("../../plots/cartesian/set_convert");var f=e("../../plots/cartesian/axis_autotype");t.exports=function e(t,r,f){var p=f.letter;var d=f.font||{};var v=n[p+"axis"];function m(e,n){return o.coerce(t,r,v,e,n)}function g(e,n){return o.coerce2(t,r,v,e,n)}if(f.name){r._name=f.name;r._id=f.name}m("autotypenumbers",f.autotypenumbersDflt);var y=m("type");if(y==="-"){if(f.data)h(r,f.data);if(r.type==="-"){r.type="linear"}else{y=t.type=r.type}}m("smoothing");m("cheatertype");m("showticklabels");m("labelprefix",p+" = ");m("labelsuffix");m("showtickprefix");m("showticksuffix");m("separatethousands");m("tickformat");m("exponentformat");m("minexponent");m("showexponent");m("categoryorder");m("tickmode");m("tickvals");m("ticktext");m("tick0");m("dtick");if(r.tickmode==="array"){m("arraytick0");m("arraydtick")}m("labelpadding");r._hovertitle=p;if(y==="date"){var x=i.getComponentMethod("calendars","handleDefaults");x(t,r,"calendar",f.calendar)}c(r,f.fullLayout);r.c2p=o.identity;var _=m("color",f.dfltColor);var b=_===t.color?_:d.color;var w=m("title.text");if(w){o.coerceFont(m,"title.font",{family:d.family,size:Math.round(d.size*1.2),color:b});m("title.offset")}m("tickangle");var T=m("autorange",!r.isValidRange(t.range));if(T)m("rangemode");m("range");r.cleanRange();m("fixedrange");s(t,r,m,y);l(t,r,m,y,f);u(t,r,m,{data:f.data,dataAttr:p});var k=g("gridcolor",a(_,.3));var A=g("gridwidth");var M=m("showgrid");if(!M){delete r.gridcolor;delete r.gridwidth}var E=g("startlinecolor",_);var S=g("startlinewidth",A);var C=m("startline",r.showgrid||!!E||!!S);if(!C){delete r.startlinecolor;delete r.startlinewidth}var L=g("endlinecolor",_);var I=g("endlinewidth",A);var O=m("endline",r.showgrid||!!L||!!I);if(!O){delete r.endlinecolor;delete r.endlinewidth}if(!M){delete r.gridcolor;delete r.gridWidth}else{m("minorgridcount");m("minorgridwidth",A);m("minorgridcolor",a(k,.06));if(!r.minorgridcount){delete r.minorgridwidth;delete r.minorgridcolor}}if(r.showticklabels==="none"){delete r.tickfont;delete r.tickangle;delete r.showexponent;delete r.exponentformat;delete r.minexponent;delete r.tickformat;delete r.showticksuffix;delete r.showtickprefix}if(!r.showticksuffix){delete r.ticksuffix}if(!r.showtickprefix){delete r.tickprefix}m("tickmode");return r};function h(e,t){if(e.type!=="-")return;var r=e._id;var n=r.charAt(0);var a=n+"calendar";var i=e[a];e.type=f(t,i,{autotypenumbers:e.autotypenumbers})}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/axis_autotype":829,"../../plots/cartesian/category_order_defaults":832,"../../plots/cartesian/set_convert":848,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_value_defaults":851,"../../registry":911,"./attributes":964}],968:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib").isArray1D;var i=e("./cheater_basis");var o=e("./array_minmax");var s=e("./calc_gridlines");var l=e("./calc_labels");var u=e("./calc_clippath");var c=e("../heatmap/clean_2d_array");var f=e("./smooth_fill_2d_array");var h=e("../heatmap/convert_column_xyz");var p=e("./set_convert");t.exports=function e(t,r){var d=n.getFromId(t,r.xaxis);var v=n.getFromId(t,r.yaxis);var m=r.aaxis;var g=r.baxis;var y=r.x;var x=r.y;var _=[];if(y&&a(y))_.push("x");if(x&&a(x))_.push("y");if(_.length){h(r,m,g,"a","b",_)}var b=r._a=r._a||r.a;var w=r._b=r._b||r.b;y=r._x||r.x;x=r._y||r.y;var T={};if(r._cheater){var k=m.cheatertype==="index"?b.length:b;var A=g.cheatertype==="index"?w.length:w;y=i(k,A,r.cheaterslope)}r._x=y=c(y);r._y=x=c(x);f(y,b,w);f(x,b,w);p(r);r.setScale();var M=o(y);var E=o(x);var S=.5*(M[1]-M[0]);var C=.5*(M[1]+M[0]);var L=.5*(E[1]-E[0]);var I=.5*(E[1]+E[0]);var O=1.3;M=[C-S*O,C+S*O];E=[I-L*O,I+L*O];r._extremes[d._id]=n.findExtremes(d,M,{padded:true});r._extremes[v._id]=n.findExtremes(v,E,{padded:true});s(r,"a","b");s(r,"b","a");l(r,m);l(r,g);T.clipsegments=u(r._xctrl,r._yctrl,m,g);T.x=y;T.y=x;T.a=b;T.b=w;return[T]}},{"../../lib":778,"../../plots/cartesian/axes":828,"../heatmap/clean_2d_array":1067,"../heatmap/convert_column_xyz":1069,"./array_minmax":963,"./calc_clippath":969,"./calc_gridlines":970,"./calc_labels":971,"./cheater_basis":973,"./set_convert":986,"./smooth_fill_2d_array":987}],969:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a){var i,o,s;var l=[];var u=!!n.smoothing;var c=!!a.smoothing;var f=t[0].length-1;var h=t.length-1;for(i=0,o=[],s=[];i<=f;i++){o[i]=t[0][i];s[i]=r[0][i]}l.push({x:o,y:s,bicubic:u});for(i=0,o=[],s=[];i<=h;i++){o[i]=t[i][f];s[i]=r[i][f]}l.push({x:o,y:s,bicubic:c});for(i=f,o=[],s=[];i>=0;i--){o[f-i]=t[h][i];s[f-i]=r[h][i]}l.push({x:o,y:s,bicubic:u});for(i=h,o=[],s=[];i>=0;i--){o[h-i]=t[i][0];s[h-i]=r[i][0]}l.push({x:o,y:s,bicubic:c});return l}},{}],970:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib/extend").extendFlat;t.exports=function e(t,r,i){var o,s,l;var u,c,f,h,p,d,v;var m,g,y,x;var _=t["_"+r];var b=t[r+"axis"];var w=b._gridlines=[];var T=b._minorgridlines=[];var k=b._boundarylines=[];var A=t["_"+i];var M=t[i+"axis"];if(b.tickmode==="array"){b.tickvals=_.slice()}var E=t._xctrl;var S=t._yctrl;var C=E[0].length;var L=E.length;var I=t._a.length;var O=t._b.length;n.prepTicks(b);if(b.tickmode==="array")delete b.tickvals;var P=b.smoothing?3:1;function D(e){var n,a,o,s,l,u,c,f,h,d,v,m;var g=[];var y=[];var x={};if(r==="b"){a=t.b2j(e);o=Math.floor(Math.max(0,Math.min(O-2,a)));s=a-o;x.length=O;x.crossLength=I;x.xy=function(e){return t.evalxy([],e,a)};x.dxy=function(e,r){return t.dxydi([],e,o,r,s)};for(n=0;n<I;n++){u=Math.min(I-2,n);c=n-u;f=t.evalxy([],n,a);if(M.smoothing&&n>0){h=t.dxydi([],n-1,o,0,s);g.push(l[0]+h[0]/3);y.push(l[1]+h[1]/3);d=t.dxydi([],n-1,o,1,s);g.push(f[0]-d[0]/3);y.push(f[1]-d[1]/3)}g.push(f[0]);y.push(f[1]);l=f}}else{n=t.a2i(e);u=Math.floor(Math.max(0,Math.min(I-2,n)));c=n-u;x.length=I;x.crossLength=O;x.xy=function(e){return t.evalxy([],n,e)};x.dxy=function(e,r){return t.dxydj([],u,e,c,r)};for(a=0;a<O;a++){o=Math.min(O-2,a);s=a-o;f=t.evalxy([],n,a);if(M.smoothing&&a>0){v=t.dxydj([],u,a-1,c,0);g.push(l[0]+v[0]/3);y.push(l[1]+v[1]/3);m=t.dxydj([],u,a-1,c,1);g.push(f[0]-m[0]/3);y.push(f[1]-m[1]/3)}g.push(f[0]);y.push(f[1]);l=f}}x.axisLetter=r;x.axis=b;x.crossAxis=M;x.value=e;x.constvar=i;x.index=p;x.x=g;x.y=y;x.smoothing=M.smoothing;return x}function R(e){var n,a,o,s,l;var u=[];var c=[];var f={};f.length=_.length;f.crossLength=A.length;if(r==="b"){o=Math.max(0,Math.min(O-2,e));l=Math.min(1,Math.max(0,e-o));f.xy=function(r){return t.evalxy([],r,e)};f.dxy=function(e,r){return t.dxydi([],e,o,r,l)};for(n=0;n<C;n++){u[n]=E[e*P][n];c[n]=S[e*P][n]}}else{a=Math.max(0,Math.min(I-2,e));s=Math.min(1,Math.max(0,e-a));f.xy=function(r){return t.evalxy([],e,r)};f.dxy=function(e,r){return t.dxydj([],a,e,s,r)};for(n=0;n<L;n++){u[n]=E[n][e*P];c[n]=S[n][e*P]}}f.axisLetter=r;f.axis=b;f.crossAxis=M;f.value=_[e];f.constvar=i;f.index=e;f.x=u;f.y=c;f.smoothing=M.smoothing;return f}if(b.tickmode==="array"){u=5e-15;c=[Math.floor((_.length-1-b.arraytick0)/b.arraydtick*(1+u)),Math.ceil(-b.arraytick0/b.arraydtick/(1+u))].sort(function(e,t){return e-t});f=c[0]-1;h=c[1]+1;for(p=f;p<h;p++){s=b.arraytick0+b.arraydtick*p;if(s<0||s>_.length-1)continue;w.push(a(R(s),{color:b.gridcolor,width:b.gridwidth}))}for(p=f;p<h;p++){l=b.arraytick0+b.arraydtick*p;m=Math.min(l+b.arraydtick,_.length-1);if(l<0||l>_.length-1)continue;if(m<0||m>_.length-1)continue;g=_[l];y=_[m];for(o=0;o<b.minorgridcount;o++){x=m-l;if(x<=0)continue;v=g+(y-g)*(o+1)/(b.minorgridcount+1)*(b.arraydtick/x);if(v<_[0]||v>_[_.length-1])continue;T.push(a(D(v),{color:b.minorgridcolor,width:b.minorgridwidth}))}}if(b.startline){k.push(a(R(0),{color:b.startlinecolor,width:b.startlinewidth}))}if(b.endline){k.push(a(R(_.length-1),{color:b.endlinecolor,width:b.endlinewidth}))}}else{u=5e-15;c=[Math.floor((_[_.length-1]-b.tick0)/b.dtick*(1+u)),Math.ceil((_[0]-b.tick0)/b.dtick/(1+u))].sort(function(e,t){return e-t});f=c[0];h=c[1];for(p=f;p<=h;p++){d=b.tick0+b.dtick*p;w.push(a(D(d),{color:b.gridcolor,width:b.gridwidth}))}for(p=f-1;p<h+1;p++){d=b.tick0+b.dtick*p;for(o=0;o<b.minorgridcount;o++){v=d+b.dtick*(o+1)/(b.minorgridcount+1);if(v<_[0]||v>_[_.length-1])continue;T.push(a(D(v),{color:b.minorgridcolor,width:b.minorgridwidth}))}}if(b.startline){k.push(a(D(_[0]),{color:b.startlinecolor,width:b.startlinewidth}))}if(b.endline){k.push(a(D(_[_.length-1]),{color:b.endlinecolor,width:b.endlinewidth}))}}}},{"../../lib/extend":768,"../../plots/cartesian/axes":828}],971:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib/extend").extendFlat;t.exports=function e(t,r){var i,o,s,l,u;var c=r._labels=[];var f=r._gridlines;for(i=0;i<f.length;i++){u=f[i];if(["start","both"].indexOf(r.showticklabels)!==-1){o=n.tickText(r,u.value);a(o,{prefix:s,suffix:l,endAnchor:true,xy:u.xy(0),dxy:u.dxy(0,0),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:i===0,isLast:i===f.length-1});c.push(o)}if(["end","both"].indexOf(r.showticklabels)!==-1){o=n.tickText(r,u.value);a(o,{endAnchor:false,xy:u.xy(u.crossLength-1),dxy:u.dxy(u.crossLength-2,1),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:i===0,isLast:i===f.length-1});c.push(o)}}}},{"../../lib/extend":768,"../../plots/cartesian/axes":828}],972:[function(e,t,r){"use strict";var n=.5;t.exports=function e(t,r,a,i){var o=t[0]-r[0];var s=t[1]-r[1];var l=a[0]-r[0];var u=a[1]-r[1];var c=Math.pow(o*o+s*s,n/2);var f=Math.pow(l*l+u*u,n/2);var h=(f*f*o-c*c*l)*i;var p=(f*f*s-c*c*u)*i;var d=f*(c+f)*3;var v=c*(c+f)*3;return[[r[0]+(d&&h/d),r[1]+(d&&p/d)],[r[0]-(v&&h/v),r[1]-(v&&p/v)]]}},{}],973:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r){var a,i,o,s,l,u;var c=[];var f=n(e)?e.length:e;var h=n(t)?t.length:t;var p=n(e)?e:null;var d=n(t)?t:null;if(p){o=(p.length-1)/(p[p.length-1]-p[0])/(f-1)}if(d){s=(d.length-1)/(d[d.length-1]-d[0])/(h-1)}var v;var m=Infinity;var g=-Infinity;for(i=0;i<h;i++){c[i]=[];u=d?(d[i]-d[0])*s:i/(h-1);for(a=0;a<f;a++){l=p?(p[a]-p[0])*o:a/(f-1);v=l-u*r;m=Math.min(v,m);g=Math.max(v,g);c[i][a]=v}}var y=1/(g-m);var x=-m*y;for(i=0;i<h;i++){for(a=0;a<f;a++){c[i][a]=y*c[i][a]+x}}return c}},{"../../lib":778}],974:[function(e,t,r){"use strict";var n=e("./catmull_rom");var a=e("../../lib").ensureArray;function i(e,t,r){var n=-.5*r[0]+1.5*t[0];var a=-.5*r[1]+1.5*t[1];return[(2*n+e[0])/3,(2*a+e[1])/3]}t.exports=function e(t,r,o,s,l,u){var c,f,h,p,d,v,m,g,y,x;var _=o[0].length;var b=o.length;var w=l?3*_-2:_;var T=u?3*b-2:b;t=a(t,T);r=a(r,T);for(h=0;h<T;h++){t[h]=a(t[h],w);r[h]=a(r[h],w)}for(f=0,p=0;f<b;f++,p+=u?3:1){d=t[p];v=r[p];m=o[f];g=s[f];for(c=0,h=0;c<_;c++,h+=l?3:1){d[h]=m[c];v[h]=g[c]}}if(l){for(f=0,p=0;f<b;f++,p+=u?3:1){for(c=1,h=3;c<_-1;c++,h+=3){y=n([o[f][c-1],s[f][c-1]],[o[f][c],s[f][c]],[o[f][c+1],s[f][c+1]],l);t[p][h-1]=y[0][0];r[p][h-1]=y[0][1];t[p][h+1]=y[1][0];r[p][h+1]=y[1][1]}x=i([t[p][0],r[p][0]],[t[p][2],r[p][2]],[t[p][3],r[p][3]]);t[p][1]=x[0];r[p][1]=x[1];x=i([t[p][w-1],r[p][w-1]],[t[p][w-3],r[p][w-3]],[t[p][w-4],r[p][w-4]]);t[p][w-2]=x[0];r[p][w-2]=x[1]}}if(u){for(h=0;h<w;h++){for(p=3;p<T-3;p+=3){y=n([t[p-3][h],r[p-3][h]],[t[p][h],r[p][h]],[t[p+3][h],r[p+3][h]],u);t[p-1][h]=y[0][0];r[p-1][h]=y[0][1];t[p+1][h]=y[1][0];r[p+1][h]=y[1][1]}x=i([t[0][h],r[0][h]],[t[2][h],r[2][h]],[t[3][h],r[3][h]]);t[1][h]=x[0];r[1][h]=x[1];x=i([t[T-1][h],r[T-1][h]],[t[T-3][h],r[T-3][h]],[t[T-4][h],r[T-4][h]]);t[T-2][h]=x[0];r[T-2][h]=x[1]}}if(l&&u){for(p=1;p<T;p+=(p+1)%3===0?2:1){for(h=3;h<w-3;h+=3){y=n([t[p][h-3],r[p][h-3]],[t[p][h],r[p][h]],[t[p][h+3],r[p][h+3]],l);t[p][h-1]=.5*(t[p][h-1]+y[0][0]);r[p][h-1]=.5*(r[p][h-1]+y[0][1]);t[p][h+1]=.5*(t[p][h+1]+y[1][0]);r[p][h+1]=.5*(r[p][h+1]+y[1][1])}x=i([t[p][0],r[p][0]],[t[p][2],r[p][2]],[t[p][3],r[p][3]]);t[p][1]=.5*(t[p][1]+x[0]);r[p][1]=.5*(r[p][1]+x[1]);x=i([t[p][w-1],r[p][w-1]],[t[p][w-3],r[p][w-3]],[t[p][w-4],r[p][w-4]]);t[p][w-2]=.5*(t[p][w-2]+x[0]);r[p][w-2]=.5*(r[p][w-2]+x[1])}}return[t,r]}},{"../../lib":778,"./catmull_rom":972}],975:[function(e,t,r){"use strict";t.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],976:[function(e,t,r){"use strict";t.exports=function(e,t,r){if(t&&r){return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u,c,f;r*=3;n*=3;var h=a*a;var p=1-a;var d=p*p;var v=p*a*2;var m=-3*d;var g=3*(d-v);var y=3*(v-h);var x=3*h;var _=i*i;var b=_*i;var w=1-i;var T=w*w;var k=T*w;for(f=0;f<e.length;f++){c=e[f];o=m*c[n][r]+g*c[n][r+1]+y*c[n][r+2]+x*c[n][r+3];s=m*c[n+1][r]+g*c[n+1][r+1]+y*c[n+1][r+2]+x*c[n+1][r+3];l=m*c[n+2][r]+g*c[n+2][r+1]+y*c[n+2][r+2]+x*c[n+2][r+3];u=m*c[n+3][r]+g*c[n+3][r+1]+y*c[n+3][r+2]+x*c[n+3][r+3];t[f]=k*o+3*(T*i*s+w*_*l)+b*u}return t}}else if(t){return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u;r*=3;var c=a*a;var f=1-a;var h=f*f;var p=f*a*2;var d=-3*h;var v=3*(h-p);var m=3*(p-c);var g=3*c;var y=1-i;for(l=0;l<e.length;l++){u=e[l];o=d*u[n][r]+v*u[n][r+1]+m*u[n][r+2]+g*u[n][r+3];s=d*u[n+1][r]+v*u[n+1][r+1]+m*u[n+1][r+2]+g*u[n+1][r+3];t[l]=y*o+i*s}return t}}else if(r){return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u,c,f;n*=3;var h=i*i;var p=h*i;var d=1-i;var v=d*d;var m=v*d;for(c=0;c<e.length;c++){f=e[c];o=f[n][r+1]-f[n][r];s=f[n+1][r+1]-f[n+1][r];l=f[n+2][r+1]-f[n+2][r];u=f[n+3][r+1]-f[n+3][r];t[c]=m*o+3*(v*i*s+d*h*l)+p*u}return t}}else{return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u;var c=1-i;for(l=0;l<e.length;l++){u=e[l];o=u[n][r+1]-u[n][r];s=u[n+1][r+1]-u[n+1][r];t[l]=c*o+i*s}return t}}}},{}],977:[function(e,t,r){"use strict";t.exports=function(e,t,r){if(t&&r){return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u,c,f;r*=3;n*=3;var h=a*a;var p=h*a;var d=1-a;var v=d*d;var m=v*d;var g=i*i;var y=1-i;var x=y*y;var _=y*i*2;var b=-3*x;var w=3*(x-_);var T=3*(_-g);var k=3*g;for(f=0;f<e.length;f++){c=e[f];o=b*c[n][r]+w*c[n+1][r]+T*c[n+2][r]+k*c[n+3][r];s=b*c[n][r+1]+w*c[n+1][r+1]+T*c[n+2][r+1]+k*c[n+3][r+1];l=b*c[n][r+2]+w*c[n+1][r+2]+T*c[n+2][r+2]+k*c[n+3][r+2];u=b*c[n][r+3]+w*c[n+1][r+3]+T*c[n+2][r+3]+k*c[n+3][r+3];t[f]=m*o+3*(v*a*s+d*h*l)+p*u}return t}}else if(t){return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u,c,f;r*=3;var h=i*i;var p=h*i;var d=1-i;var v=d*d;var m=v*d;for(c=0;c<e.length;c++){f=e[c];o=f[n+1][r]-f[n][r];s=f[n+1][r+1]-f[n][r+1];l=f[n+1][r+2]-f[n][r+2];u=f[n+1][r+3]-f[n][r+3];t[c]=m*o+3*(v*i*s+d*h*l)+p*u}return t}}else if(r){return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u;n*=3;var c=1-a;var f=i*i;var h=1-i;var p=h*h;var d=h*i*2;var v=-3*p;var m=3*(p-d);var g=3*(d-f);var y=3*f;for(l=0;l<e.length;l++){u=e[l];o=v*u[n][r]+m*u[n+1][r]+g*u[n+2][r]+y*u[n+3][r];s=v*u[n][r+1]+m*u[n+1][r+1]+g*u[n+2][r+1]+y*u[n+3][r+1];t[l]=c*o+a*s}return t}}else{return function(t,r,n,a,i){if(!t)t=[];var o,s,l,u;var c=1-a;for(l=0;l<e.length;l++){u=e[l];o=u[n+1][r]-u[n][r];s=u[n+1][r+1]-u[n][r+1];t[l]=c*o+a*s}return t}}}},{}],978:[function(e,t,r){"use strict";t.exports=function(e,t,r,n,a){var i=t-2;var o=r-2;if(n&&a){return function(t,r,n){if(!t)t=[];var a,s,l,u,c,f;var h=Math.max(0,Math.min(Math.floor(r),i));var p=Math.max(0,Math.min(Math.floor(n),o));var d=Math.max(0,Math.min(1,r-h));var v=Math.max(0,Math.min(1,n-p));h*=3;p*=3;var m=d*d;var g=m*d;var y=1-d;var x=y*y;var _=x*y;var b=v*v;var w=b*v;var T=1-v;var k=T*T;var A=k*T;for(f=0;f<e.length;f++){c=e[f];a=_*c[p][h]+3*(x*d*c[p][h+1]+y*m*c[p][h+2])+g*c[p][h+3];s=_*c[p+1][h]+3*(x*d*c[p+1][h+1]+y*m*c[p+1][h+2])+g*c[p+1][h+3];l=_*c[p+2][h]+3*(x*d*c[p+2][h+1]+y*m*c[p+2][h+2])+g*c[p+2][h+3];u=_*c[p+3][h]+3*(x*d*c[p+3][h+1]+y*m*c[p+3][h+2])+g*c[p+3][h+3];t[f]=A*a+3*(k*v*s+T*b*l)+w*u}return t}}else if(n){return function(t,r,n){if(!t)t=[];var a=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(n),o));var l=Math.max(0,Math.min(1,r-a));var u=Math.max(0,Math.min(1,n-s));var c,f,h,p,d,v;a*=3;var m=l*l;var g=m*l;var y=1-l;var x=y*y;var _=x*y;var b=1-u;for(d=0;d<e.length;d++){v=e[d];c=b*v[s][a]+u*v[s+1][a];f=b*v[s][a+1]+u*v[s+1][a+1];h=b*v[s][a+2]+u*v[s+1][a+1];p=b*v[s][a+3]+u*v[s+1][a+1];t[d]=_*c+3*(x*l*f+y*m*h)+g*p}return t}}else if(a){return function(t,r,n){if(!t)t=[];var a=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(n),o));var l=Math.max(0,Math.min(1,r-a));var u=Math.max(0,Math.min(1,n-s));var c,f,h,p,d,v;s*=3;var m=u*u;var g=m*u;var y=1-u;var x=y*y;var _=x*y;var b=1-l;for(d=0;d<e.length;d++){v=e[d];c=b*v[s][a]+l*v[s][a+1];f=b*v[s+1][a]+l*v[s+1][a+1];h=b*v[s+2][a]+l*v[s+2][a+1];p=b*v[s+3][a]+l*v[s+3][a+1];t[d]=_*c+3*(x*u*f+y*m*h)+g*p}return t}}else{return function(t,r,n){if(!t)t=[];var a=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(n),o));var l=Math.max(0,Math.min(1,r-a));var u=Math.max(0,Math.min(1,n-s));var c,f,h,p;var d=1-u;var v=1-l;for(h=0;h<e.length;h++){p=e[h];c=v*p[s][a]+l*p[s][a+1];f=v*p[s+1][a]+l*p[s+1][a+1];t[h]=d*c+u*f}return t}}}},{}],979:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./xy_defaults");var i=e("./ab_defaults");var o=e("./attributes");var s=e("../../components/color/attributes");t.exports=function e(t,r,l,u){function c(e,a){return n.coerce(t,r,o,e,a)}r._clipPathId="clip"+r.uid+"carpet";var f=c("color",s.defaultLine);n.coerceFont(c,"font");c("carpet");i(t,r,u,c,f);if(!r.a||!r.b){r.visible=false;return}if(r.a.length<3){r.aaxis.smoothing=0}if(r.b.length<3){r.baxis.smoothing=0}var h=a(t,r,c);if(!h){r.visible=false}if(r._cheater){c("cheaterslope")}}},{"../../components/color/attributes":642,"../../lib":778,"./ab_defaults":962,"./attributes":964,"./xy_defaults":988}],980:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),plot:e("./plot"),calc:e("./calc"),animatable:true,isContainer:true,moduleType:"trace",name:"carpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":841,"./attributes":964,"./calc":968,"./defaults":979,"./plot":985}],981:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e._fullData.length;var n;for(var a=0;a<r;a++){var i=e._fullData[a];if(i.index===t.index)continue;if(i.type==="carpet"){if(!n){n=i}if(i.carpet===t.carpet){return i}}}return n}},{}],982:[function(e,t,r){"use strict";t.exports=function e(t,r,n){if(t.length===0)return"";var a;var i=[];var o=n?3:1;for(a=0;a<t.length;a+=o){i.push(t[a]+","+r[a]);if(n&&a<t.length-o){i.push("C");i.push([t[a+1]+","+r[a+1],t[a+2]+","+r[a+2]+" "].join(" "))}}return i.join(n?"":"L")}},{}],983:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,a){var i;if(!n(t)){t=[]}else if(t.length>r.length){t=t.slice(0,r.length)}for(i=0;i<r.length;i++){t[i]=a(r[i])}return t}},{"../../lib":778}],984:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i,o){var s=i[0]*t.dpdx(r);var l=i[1]*t.dpdy(n);var u=1;var c=1;if(o){var f=Math.sqrt(i[0]*i[0]+i[1]*i[1]);var h=Math.sqrt(o[0]*o[0]+o[1]*o[1]);var p=(i[0]*o[0]+i[1]*o[1])/f/h;c=Math.max(0,p)}var d=Math.atan2(l,s)*180/Math.PI;if(d<-90){d+=180;u=-u}else if(d>90){d-=180;u=-u}return{angle:d,flip:u,p:t.c2p(a,r,n),offsetMultplier:c}}},{}],985:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("./map_1d_array");var o=e("./makepath");var s=e("./orient_text");var l=e("../../lib/svg_text_utils");var u=e("../../lib");var c=u.strRotate;var f=u.strTranslate;var h=e("../../constants/alignment");t.exports=function e(t,r,a,i){var o=r.xaxis;var s=r.yaxis;var l=t._fullLayout;var c=l._clips;u.makeTraceGroups(i,a,"trace").each(function(e){var r=n.select(this);var a=e[0];var i=a.trace;var l=i.aaxis;var f=i.baxis;var h=u.ensureSingle(r,"g","minorlayer");var g=u.ensureSingle(r,"g","majorlayer");var y=u.ensureSingle(r,"g","boundarylayer");var x=u.ensureSingle(r,"g","labellayer");r.style("opacity",i.opacity);d(o,s,g,l,"a",l._gridlines,true);d(o,s,g,f,"b",f._gridlines,true);d(o,s,h,l,"a",l._minorgridlines,true);d(o,s,h,f,"b",f._minorgridlines,true);d(o,s,y,l,"a-boundary",l._boundarylines);d(o,s,y,f,"b-boundary",f._boundarylines);var _=v(t,o,s,i,a,x,l._labels,"a-label");var b=v(t,o,s,i,a,x,f._labels,"b-label");m(t,x,i,a,o,s,_,b);p(i,a,c,o,s)})};function p(e,t,r,n,a){var s,l,c,f;var h=r.select("#"+e._clipPathId);if(!h.size()){h=r.append("clipPath").classed("carpetclip",true)}var p=u.ensureSingle(h,"path","carpetboundary");var d=t.clipsegments;var v=[];for(f=0;f<d.length;f++){s=d[f];l=i([],s.x,n.c2p);c=i([],s.y,a.c2p);v.push(o(l,c,s.bicubic))}var m="M"+v.join("L")+"Z";h.attr("id",e._clipPathId);p.attr("d",m)}function d(e,t,r,a,s,l){var u="const-"+s+"-lines";var c=r.selectAll("."+u).data(l);c.enter().append("path").classed(u,true).style("vector-effect","non-scaling-stroke");c.each(function(r){var a=r;var s=a.x;var l=a.y;var u=i([],s,e.c2p);var c=i([],l,t.c2p);var f="M"+o(u,c,a.smoothing);var h=n.select(this);h.attr("d",f).style("stroke-width",a.width).style("stroke",a.color).style("fill","none")});c.exit().remove()}function v(e,t,r,i,o,u,h,p){var d=u.selectAll("text."+p).data(h);d.enter().append("text").classed(p,true);var v=0;var m={};d.each(function(o,u){var h;if(o.axis.tickangle==="auto"){h=s(i,t,r,o.xy,o.dxy)}else{var p=(o.axis.tickangle+180)*Math.PI/180;h=s(i,t,r,o.xy,[Math.cos(p),Math.sin(p)])}if(!u){m={angle:h.angle,flip:h.flip}}var d=(o.endAnchor?-1:1)*h.flip;var g=n.select(this).attr({"text-anchor":d>0?"start":"end","data-notex":1}).call(a.font,o.font).text(o.text).call(l.convertToTspans,e);var y=a.bBox(this);g.attr("transform",f(h.p[0],h.p[1])+c(h.angle)+f(o.axis.labelpadding*d,y.height*.3));v=Math.max(v,y.width+o.axis.labelpadding)});d.exit().remove();m.maxExtent=v;return m}function m(e,t,r,n,a,i,o,l){var c,f,h,p;var d=u.aggNums(Math.min,null,r.a);var v=u.aggNums(Math.max,null,r.a);var m=u.aggNums(Math.min,null,r.b);var g=u.aggNums(Math.max,null,r.b);c=.5*(d+v);f=m;h=r.ab2xy(c,f,true);p=r.dxyda_rough(c,f);if(o.angle===undefined){u.extendFlat(o,s(r,a,i,h,r.dxydb_rough(c,f)))}x(e,t,r,n,h,p,r.aaxis,a,i,o,"a-title");c=d;f=.5*(m+g);h=r.ab2xy(c,f,true);p=r.dxydb_rough(c,f);if(l.angle===undefined){u.extendFlat(l,s(r,a,i,h,r.dxyda_rough(c,f)))}x(e,t,r,n,h,p,r.baxis,a,i,l,"b-title")}var g=h.LINE_SPACING;var y=(1-h.MID_SHIFT)/g+1;function x(e,t,r,i,o,u,h,p,d,v,m){var x=[];if(h.title.text)x.push(h.title.text);var _=t.selectAll("text."+m).data(x);var b=v.maxExtent;_.enter().append("text").classed(m,true);_.each(function(){var t=s(r,p,d,o,u);if(["start","both"].indexOf(h.showticklabels)===-1){b=0}var i=h.title.font.size;b+=i+h.title.offset;var m=v.angle+(v.flip<0?180:0);var x=(m-t.angle+450)%360;var _=x>90&&x<270;var w=n.select(this);w.text(h.title.text).call(l.convertToTspans,e);if(_){b=(-l.lineCount(w)+y)*g*i-b}w.attr("transform",f(t.p[0],t.p[1])+c(t.angle)+f(0,b)).attr("text-anchor","middle").call(a.font,h.title.font)});_.exit().remove()}},{"../../components/drawing":665,"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"./makepath":982,"./map_1d_array":983,"./orient_text":984,d3:169}],986:[function(e,t,r){"use strict";var n=e("./constants");var a=e("../../lib/search").findBin;var i=e("./compute_control_points");var o=e("./create_spline_evaluator");var s=e("./create_i_derivative_evaluator");var l=e("./create_j_derivative_evaluator");t.exports=function e(t){var r=t._a;var u=t._b;var c=r.length;var f=u.length;var h=t.aaxis;var p=t.baxis;var d=r[0];var v=r[c-1];var m=u[0];var g=u[f-1];var y=r[r.length-1]-r[0];var x=u[u.length-1]-u[0];var _=y*n.RELATIVE_CULL_TOLERANCE;var b=x*n.RELATIVE_CULL_TOLERANCE;d-=_;v+=_;m-=b;g+=b;t.isVisible=function(e,t){return e>d&&e<v&&t>m&&t<g};t.isOccluded=function(e,t){return e<d||e>v||t<m||t>g};t.setScale=function(){var e=t._x;var r=t._y;var n=i(t._xctrl,t._yctrl,e,r,h.smoothing,p.smoothing);t._xctrl=n[0];t._yctrl=n[1];t.evalxy=o([t._xctrl,t._yctrl],c,f,h.smoothing,p.smoothing);t.dxydi=s([t._xctrl,t._yctrl],h.smoothing,p.smoothing);t.dxydj=l([t._xctrl,t._yctrl],h.smoothing,p.smoothing)};t.i2a=function(e){var t=Math.max(0,Math.floor(e[0]),c-2);var n=e[0]-t;return(1-n)*r[t]+n*r[t+1]};t.j2b=function(e){var t=Math.max(0,Math.floor(e[1]),c-2);var r=e[1]-t;return(1-r)*u[t]+r*u[t+1]};t.ij2ab=function(e){return[t.i2a(e[0]),t.j2b(e[1])]};t.a2i=function(e){var t=Math.max(0,Math.min(a(e,r),c-2));var n=r[t];var i=r[t+1];return Math.max(0,Math.min(c-1,t+(e-n)/(i-n)))};t.b2j=function(e){var t=Math.max(0,Math.min(a(e,u),f-2));var r=u[t];var n=u[t+1];return Math.max(0,Math.min(f-1,t+(e-r)/(n-r)))};t.ab2ij=function(e){return[t.a2i(e[0]),t.b2j(e[1])]};t.i2c=function(e,r){return t.evalxy([],e,r)};t.ab2xy=function(e,n,a){if(!a&&(e<r[0]||e>r[c-1]|n<u[0]||n>u[f-1])){return[false,false]}var i=t.a2i(e);var o=t.b2j(n);var s=t.evalxy([],i,o);if(a){var l=0;var h=0;var p=[];var d,v,m,g;if(e<r[0]){d=0;v=0;l=(e-r[0])/(r[1]-r[0])}else if(e>r[c-1]){d=c-2;v=1;l=(e-r[c-1])/(r[c-1]-r[c-2])}else{d=Math.max(0,Math.min(c-2,Math.floor(i)));v=i-d}if(n<u[0]){m=0;g=0;h=(n-u[0])/(u[1]-u[0])}else if(n>u[f-1]){m=f-2;g=1;h=(n-u[f-1])/(u[f-1]-u[f-2])}else{m=Math.max(0,Math.min(f-2,Math.floor(o)));g=o-m}if(l){t.dxydi(p,d,m,v,g);s[0]+=p[0]*l;s[1]+=p[1]*l}if(h){t.dxydj(p,d,m,v,g);s[0]+=p[0]*h;s[1]+=p[1]*h}}return s};t.c2p=function(e,t,r){return[t.c2p(e[0]),r.c2p(e[1])]};t.p2x=function(e,t,r){return[t.p2c(e[0]),r.p2c(e[1])]};t.dadi=function(e){var t=Math.max(0,Math.min(r.length-2,e));return r[t+1]-r[t]};t.dbdj=function(e){var t=Math.max(0,Math.min(u.length-2,e));return u[t+1]-u[t]};t.dxyda=function(e,r,n,a){var i=t.dxydi(null,e,r,n,a);var o=t.dadi(e,n);return[i[0]/o,i[1]/o]};t.dxydb=function(e,r,n,a){var i=t.dxydj(null,e,r,n,a);var o=t.dbdj(r,a);return[i[0]/o,i[1]/o]};t.dxyda_rough=function(e,r,n){var a=y*(n||.1);var i=t.ab2xy(e+a,r,true);var o=t.ab2xy(e-a,r,true);return[(i[0]-o[0])*.5/a,(i[1]-o[1])*.5/a]};t.dxydb_rough=function(e,r,n){var a=x*(n||.1);var i=t.ab2xy(e,r+a,true);var o=t.ab2xy(e,r-a,true);return[(i[0]-o[0])*.5/a,(i[1]-o[1])*.5/a]};t.dpdx=function(e){return e._m};t.dpdy=function(e){return e._m}}},{"../../lib/search":798,"./compute_control_points":974,"./constants":975,"./create_i_derivative_evaluator":976,"./create_j_derivative_evaluator":977,"./create_spline_evaluator":978}],987:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r,a){var i,o,s;var l=[];var u=[];var c=t[0].length;var f=t.length;function h(e,r){var n=0;var a;var i=0;if(e>0&&(a=t[r][e-1])!==undefined){i++;n+=a}if(e<c-1&&(a=t[r][e+1])!==undefined){i++;n+=a}if(r>0&&(a=t[r-1][e])!==undefined){i++;n+=a}if(r<f-1&&(a=t[r+1][e])!==undefined){i++;n+=a}return n/Math.max(1,i)}var p=0;for(i=0;i<c;i++){for(o=0;o<f;o++){if(t[o][i]===undefined){l.push(i);u.push(o);t[o][i]=h(i,o)}p=Math.max(p,Math.abs(t[o][i]))}}if(!l.length)return t;var d,v,m,g,y,x,_,b,w,T,k;var A=1e-5;var M=0;var E=100;var S=0;var C=l.length;do{M=0;for(s=0;s<C;s++){i=l[s];o=u[s];var L=0;var I=0;var O,P,D,R,z,N;if(i===0){z=Math.min(c-1,2);D=r[z];R=r[1];O=t[o][z];P=t[o][1];I+=P+(P-O)*(r[0]-R)/(R-D);L++}else if(i===c-1){z=Math.max(0,c-3);D=r[z];R=r[c-2];O=t[o][z];P=t[o][c-2];I+=P+(P-O)*(r[c-1]-R)/(R-D);L++}if((i===0||i===c-1)&&(o>0&&o<f-1)){d=a[o+1]-a[o];v=a[o]-a[o-1];I+=(v*t[o+1][i]+d*t[o-1][i])/(v+d);L++}if(o===0){N=Math.min(f-1,2);D=a[N];R=a[1];O=t[N][i];P=t[1][i];I+=P+(P-O)*(a[0]-R)/(R-D);L++}else if(o===f-1){N=Math.max(0,f-3);D=a[N];R=a[f-2];O=t[N][i];P=t[f-2][i];I+=P+(P-O)*(a[f-1]-R)/(R-D);L++}if((o===0||o===f-1)&&(i>0&&i<c-1)){d=r[i+1]-r[i];v=r[i]-r[i-1];I+=(v*t[o][i+1]+d*t[o][i-1])/(v+d);L++}if(!L){m=r[i+1]-r[i];g=r[i]-r[i-1];y=a[o+1]-a[o];x=a[o]-a[o-1];_=m*g*(m+g);b=y*x*(y+x);I=(_*(x*t[o+1][i]+y*t[o-1][i])+b*(g*t[o][i+1]+m*t[o][i-1]))/(b*(g+m)+_*(x+y))}else{I/=L}w=I-t[o][i];T=w/p;M+=T*T;k=L?0:.85;t[o][i]+=w*(1+k)}M=Math.sqrt(M)}while(S++<E&&M>A);n.log("Smoother converged to",M,"after",S,"iterations");return t}},{"../../lib":778}],988:[function(e,t,r){"use strict";var n=e("../../lib").isArray1D;t.exports=function e(t,r,a){var i=a("x");var o=i&&i.length;var s=a("y");var l=s&&s.length;if(!o&&!l)return false;r._cheater=!i;if((!o||n(i))&&(!l||n(s))){var u=o?i.length:Infinity;if(l)u=Math.min(u,s.length);if(r.a&&r.a.length)u=Math.min(u,r.a.length);if(r.b&&r.b.length)u=Math.min(u,r.b.length);r._length=u}else r._length=null;return true}},{"../../lib":778}],989:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../scattergeo/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../plots/attributes");var s=e("../../components/color/attributes").defaultLine;var l=e("../../lib/extend").extendFlat;var u=a.marker.line;t.exports=l({locations:{valType:"data_array",editType:"calc"},locationmode:a.locationmode,z:{valType:"data_array",editType:"calc"},geojson:l({},a.geojson,{}),featureidkey:a.featureidkey,text:l({},a.text,{}),hovertext:l({},a.hovertext,{}),marker:{line:{color:l({},u.color,{dflt:s}),width:l({},u.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:true,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:a.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:l({},o.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:n(),showlegend:l({},o.showlegend,{dflt:false})},i("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":642,"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scattergeo/attributes":1229}],990:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../constants/numerical").BADNUM;var i=e("../../components/colorscale/calc");var o=e("../scatter/arrays_to_calcdata");var s=e("../scatter/calc_selection");function l(e){return e&&typeof e==="string"}t.exports=function e(t,r){var u=r._length;var c=new Array(u);var f;if(r.geojson){f=function(e){return l(e)||n(e)}}else{f=l}for(var h=0;h<u;h++){var p=c[h]={};var d=r.locations[h];var v=r.z[h];if(f(d)&&n(v)){p.loc=d;p.z=v}else{p.loc=null;p.z=a}p.index=h}o(c,r);i(t,r,{vals:r.z,containerStr:"",cLetter:"z"});s(c,r);return c}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../scatter/arrays_to_calcdata":1186,"../scatter/calc_selection":1189,"fast-isnumeric":241}],991:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}var u=l("locations");var c=l("z");if(!(u&&u.length&&n.isArrayOrTypedArray(c)&&c.length)){r.visible=false;return}r._length=Math.min(u.length,c.length);var f=l("geojson");var h;if(typeof f==="string"&&f!==""||n.isPlainObject(f)){h="geojson-id"}var p=l("locationmode",h);if(p==="geojson-id"){l("featureidkey")}l("text");l("hovertext");l("hovertemplate");var d=l("marker.line.width");if(d)l("marker.line.color");l("marker.opacity");a(t,r,s,l,{prefix:"",cLetter:"z"});n.coerceSelectionMarkerOpacity(r,l)}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":989}],992:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i){t.location=r.location;t.z=r.z;var o=a[i];if(o.fIn&&o.fIn.properties){t.properties=o.fIn.properties}t.ct=o.ct;return t}},{}],993:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("./attributes");var i=e("../../lib").fillText;t.exports=function e(t,r,a){var i=t.cd;var s=i[0].trace;var l=t.subplot;var u,c,f,h;var p=[r,a];var d=[r+360,a];for(c=0;c<i.length;c++){u=i[c];h=false;if(u._polygons){for(f=0;f<u._polygons.length;f++){if(u._polygons[f].contains(p)){h=!h}if(u._polygons[f].contains(d)){h=!h}}if(h)break}}if(!h||!u)return;t.x0=t.x1=t.xa.c2p(u.ct);t.y0=t.y1=t.ya.c2p(u.ct);t.index=u.index;t.location=u.loc;t.z=u.z;t.zLabel=n.tickText(l.mockAxis,l.mockAxis.c2l(u.z),"hover").text;t.hovertemplate=u.hovertemplate;o(t,s,u);return[t]};function o(e,t,r){if(t.hovertemplate)return;var n=r.hi||t.hoverinfo;var o=String(r.loc);var s=n==="all"?a.hoverinfo.flags:n.split("+");var l=s.indexOf("name")!==-1;var u=s.indexOf("location")!==-1;var c=s.indexOf("z")!==-1;var f=s.indexOf("text")!==-1;var h=!l&&u;var p=[];if(h){e.nameOverride=o}else{if(l)e.nameOverride=t.name;if(u)p.push(o)}if(c){p.push(e.zLabel)}if(f){i(r,t,p)}e.extraText=p.join("<br>")}},{"../../lib":778,"../../plots/cartesian/axes":828,"./attributes":989}],994:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("./calc"),calcGeoJSON:e("./plot").calcGeoJSON,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"choropleth",basePlotModule:e("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":860,"../heatmap/colorbar":1068,"./attributes":989,"./calc":990,"./defaults":991,"./event_data":992,"./hover":993,"./plot":995,"./select":996,"./style":997}],995:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../lib/geo_location_utils");var o=e("../../lib/topojson_utils").getTopojsonFeatures;var s=e("../../plots/cartesian/autorange").findExtremes;var l=e("./style").style;function u(e,t,r){var i=t.layers.backplot.select(".choroplethlayer");a.makeTraceGroups(i,r,"trace choropleth").each(function(t){var r=n.select(this);var i=r.selectAll("path.choroplethlocation").data(a.identity);i.enter().append("path").classed("choroplethlocation",true);i.exit().remove();l(e,t)})}function c(e,t){var r=e[0].trace;var n=t[r.geo];var a=n._subplot;var l=r.locationmode;var u=r._length;var c=l==="geojson-id"?i.extractTraceFeature(e):o(r,a.topojson);var f=[];var h=[];for(var p=0;p<u;p++){var d=e[p];var v=l==="geojson-id"?d.fOut:i.locationToFeature(l,d.loc,c);if(v){d.geojson=v;d.ct=v.properties.ct;d._polygons=i.feature2polygons(v);var m=i.computeBbox(v);f.push(m[0],m[2]);h.push(m[1],m[3])}else{d.geojson=null}}if(n.fitbounds==="geojson"&&l==="geojson-id"){var g=i.computeBbox(i.getTraceGeojson(r));f=[g[0],g[2]];h=[g[1],g[3]]}var y={padded:true};r._extremes.lon=s(n.lonaxis._ax,f,y);r._extremes.lat=s(n.lataxis._ax,h,y)}t.exports={calcGeoJSON:c,plot:u}},{"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/topojson_utils":806,"../../plots/cartesian/autorange":827,"./style":997,d3:169}],996:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t.cd;var a=t.xaxis;var i=t.yaxis;var o=[];var s,l,u,c,f;if(r===false){for(s=0;s<n.length;s++){n[s].selected=0}}else{for(s=0;s<n.length;s++){l=n[s];u=l.ct;if(!u)continue;c=a.c2p(u);f=i.c2p(u);if(r.contains([c,f],null,s,t)){o.push({pointNumber:s,lon:u[0],lat:u[1]});l.selected=1}else{l.selected=0}}}return o}},{}],997:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/color");var i=e("../../components/drawing");var o=e("../../components/colorscale");function s(e,t){if(t)l(e,t)}function l(e,t){var r=t[0].trace;var s=t[0].node3;var l=s.selectAll(".choroplethlocation");var u=r.marker||{};var c=u.line||{};var f=o.makeColorScaleFuncFromTrace(r);l.each(function(e){n.select(this).attr("fill",f(e.z)).call(a.stroke,e.mlc||c.color).call(i.dashLine,"",e.mlw||c.width||0).style("opacity",u.opacity)});i.selectedPointStyle(l,r,e)}function u(e,t){var r=t[0].node3;var n=t[0].trace;if(n.selectedpoints){i.selectedPointStyle(r.selectAll(".choroplethlocation"),n,e)}else{l(e,t)}}t.exports={style:s,styleOnSelect:u}},{"../../components/color":643,"../../components/colorscale":655,"../../components/drawing":665,d3:169}],998:[function(e,t,r){"use strict";var n=e("../choropleth/attributes");var a=e("../../components/colorscale/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;t.exports=s({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:s({},n.featureidkey,{}),below:{valType:"string",editType:"plot"},text:n.text,hovertext:n.hovertext,marker:{line:{color:s({},n.marker.line.color,{editType:"plot"}),width:s({},n.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:s({},n.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:s({},n.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:s({},n.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:n.hoverinfo,hovertemplate:i({},{keys:["properties"]}),showlegend:s({},o.showlegend,{dflt:false})},a("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../choropleth/attributes":989}],999:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../components/colorscale");var o=e("../../components/drawing");var s=e("../../lib/geojson_utils").makeBlank;var l=e("../../lib/geo_location_utils");function u(e){var t=e[0].trace;var r=t.visible===true&&t._length!==0;var o={layout:{visibility:"none"},paint:{}};var u={layout:{visibility:"none"},paint:{}};var f=t._opts={fill:o,line:u,geojson:s()};if(!r)return f;var h=l.extractTraceFeature(e);if(!h)return f;var p=i.makeColorScaleFuncFromTrace(t);var d=t.marker;var v=d.line||{};var m;if(a.isArrayOrTypedArray(d.opacity)){m=function(e){var t=e.mo;return n(t)?+a.constrain(t,0,1):0}}var g;if(a.isArrayOrTypedArray(v.color)){g=function(e){return e.mlc}}var y;if(a.isArrayOrTypedArray(v.width)){y=function(e){return e.mlw}}for(var x=0;x<e.length;x++){var _=e[x];var b=_.fOut;if(b){var w=b.properties;w.fc=p(_.z);if(m)w.mo=m(_);if(g)w.mlc=g(_);if(y)w.mlw=y(_);_.ct=w.ct;_._polygons=l.feature2polygons(b)}}var T=m?{type:"identity",property:"mo"}:d.opacity;a.extendFlat(o.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":T});a.extendFlat(u.paint,{"line-color":g?{type:"identity",property:"mlc"}:v.color,"line-width":y?{type:"identity",property:"mlw"}:v.width,"line-opacity":T});o.layout.visibility="visible";u.layout.visibility="visible";f.geojson={type:"FeatureCollection",features:h};c(e);return f}function c(e){var t=e[0].trace;var r=t._opts;var n;if(t.selectedpoints){var i=o.makeSelectedPointStyleFns(t);for(var s=0;s<e.length;s++){var l=e[s];if(l.fOut){l.fOut.properties.mo2=i.selectedOpacityFn(l)}}n={type:"identity",property:"mo2"}}else{n=a.isArrayOrTypedArray(t.marker.opacity)?{type:"identity",property:"mo"}:t.marker.opacity}a.extendFlat(r.fill.paint,{"fill-opacity":n});a.extendFlat(r.line.paint,{"line-opacity":n});return r}t.exports={convert:u,convertOnSelect:c}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/geojson_utils":772,"fast-isnumeric":241}],1000:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}var u=l("locations");var c=l("z");var f=l("geojson");if(!n.isArrayOrTypedArray(u)||!u.length||!n.isArrayOrTypedArray(c)||!c.length||!(typeof f==="string"&&f!==""||n.isPlainObject(f))){r.visible=false;return}l("featureidkey");r._length=Math.min(u.length,c.length);l("below");l("text");l("hovertext");l("hovertemplate");var h=l("marker.line.width");if(h)l("marker.line.color");l("marker.opacity");a(t,r,s,l,{prefix:"",cLetter:"z"});n.coerceSelectionMarkerOpacity(r,l)}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":998}],1001:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../choropleth/calc"),plot:e("./plot"),hoverPoints:e("../choropleth/hover"),eventData:e("../choropleth/event_data"),selectPoints:e("../choropleth/select"),styleOnSelect:function(e,t){if(t){var r=t[0].trace;r._glTrace.updateOnSelect(t)}},getBelow:function(e,t){var r=t.getMapLayers();for(var n=r.length-2;n>=0;n--){var a=r[n].id;if(typeof a==="string"&&a.indexOf("water")===0){for(var i=n+1;i<r.length;i++){a=r[i].id;if(typeof a==="string"&&a.indexOf("plotly-")===-1){return a}}}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":885,"../choropleth/calc":990,"../choropleth/event_data":992,"../choropleth/hover":993,"../choropleth/select":996,"../heatmap/colorbar":1068,"./attributes":998,"./defaults":1e3,"./plot":1002}],1002:[function(e,t,r){"use strict";var n=e("./convert").convert;var a=e("./convert").convertOnSelect;var i=e("../../plots/mapbox/constants").traceLayerPrefix;function o(e,t){this.type="choroplethmapbox";this.subplot=e;this.uid=t;this.sourceId="source-"+t;this.layerList=[["fill",i+t+"-fill"],["line",i+t+"-line"]];this.below=null}var s=o.prototype;s.update=function(e){this._update(n(e))};s.updateOnSelect=function(e){this._update(a(e))};s._update=function(e){var t=this.subplot;var r=this.layerList;var n=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(e.geojson);if(n!==this.below){this._removeLayers();this._addLayers(e,n);this.below=n}for(var a=0;a<r.length;a++){var i=r[a];var o=i[0];var s=i[1];var l=e[o];t.setOptions(s,"setLayoutProperty",l.layout);if(l.layout.visibility==="visible"){t.setOptions(s,"setPaintProperty",l.paint)}}};s._addLayers=function(e,t){var r=this.subplot;var n=this.layerList;var a=this.sourceId;for(var i=0;i<n.length;i++){var o=n[i];var s=o[0];var l=e[s];r.addLayer({type:s,id:o[1],source:a,layout:l.layout,paint:l.paint},t)}};s._removeLayers=function(){var e=this.subplot.map;var t=this.layerList;for(var r=t.length-1;r>=0;r--){e.removeLayer(t[r][1])}};s.dispose=function(){var e=this.subplot.map;this._removeLayers();e.removeSource(this.sourceId)};t.exports=function e(t,r){var a=r[0].trace;var i=new o(t,a.uid);var s=i.sourceId;var l=n(r);var u=i.below=t.belowLookup["trace-"+a.uid];t.map.addSource(s,{type:"geojson",data:l.geojson});i._addLayers(l,u);r[0].trace._glTrace=i;return i}},{"../../plots/mapbox/constants":883,"./convert":999}],1003:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../mesh3d/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertemplate:a({editType:"calc"},{keys:["norm"]}),showlegend:s({},o.showlegend,{dflt:false})};s(l,n("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}));var u=["opacity","lightposition","lighting"];u.forEach(function(e){l[e]=i[e]});l.hoverinfo=s({},o.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"});l.transforms=undefined;t.exports=l},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1004:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){var a=r.u;var i=r.v;var o=r.w;var s=Math.min(r.x.length,r.y.length,r.z.length,a.length,i.length,o.length);var l=-Infinity;var u=Infinity;for(var c=0;c<s;c++){var f=a[c];var h=i[c];var p=o[c];var d=Math.sqrt(f*f+h*h+p*p);l=Math.max(l,d);u=Math.min(u,d)}r._len=s;r._normMax=l;n(t,r,{vals:[u,l],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1005:[function(e,t,r){"use strict";var n=e("gl-cone3d");var a=e("gl-cone3d").createConeMesh;var i=e("../../lib").simpleMap;var o=e("../../lib/gl_format_color").parseColorScale;var s=e("../../components/colorscale").extractOpts;var l=e("../../plots/gl3d/zip3");function u(e,t){this.scene=e;this.uid=t;this.mesh=null;this.data=null}var c=u.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;var r=this.data.x[t];var n=this.data.y[t];var a=this.data.z[t];var i=this.data.u[t];var o=this.data.v[t];var s=this.data.w[t];e.traceCoordinate=[r,n,a,i,o,s,Math.sqrt(i*i+o*o+s*s)];var l=this.data.hovertext||this.data.text;if(Array.isArray(l)&&l[t]!==undefined){e.textLabel=l[t]}else if(l){e.textLabel=l}return true}};var f={xaxis:0,yaxis:1,zaxis:2};var h={tip:1,tail:0,cm:.25,center:.5};var p={tip:1,tail:1,cm:.75,center:.5};function d(e,t){var r=e.fullSceneLayout;var a=e.dataScale;var u={};function c(e,t){var n=r[t];var o=a[f[t]];return i(e,function(e){return n.d2l(e)*o})}u.vectors=l(c(t.u,"xaxis"),c(t.v,"yaxis"),c(t.w,"zaxis"),t._len);u.positions=l(c(t.x,"xaxis"),c(t.y,"yaxis"),c(t.z,"zaxis"),t._len);var d=s(t);u.colormap=o(t);u.vertexIntensityBounds=[d.min/t._normMax,d.max/t._normMax];u.coneOffset=h[t.anchor];if(t.sizemode==="scaled"){u.coneSize=t.sizeref||.5}else{u.coneSize=t.sizeref&&t._normMax?t.sizeref/t._normMax:.5}var v=n(u);var m=t.lightposition;v.lightPosition=[m.x,m.y,m.z];v.ambient=t.lighting.ambient;v.diffuse=t.lighting.diffuse;v.specular=t.lighting.specular;v.roughness=t.lighting.roughness;v.fresnel=t.lighting.fresnel;v.opacity=t.opacity;t._pad=p[t.anchor]*v.vectorScale*v.coneScale*t._normMax;return v}c.update=function(e){this.data=e;var t=d(this.scene,e);this.mesh.update(t)};c.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function v(e,t){var r=e.glplot.gl;var n=d(e,t);var i=a(r,n);var o=new u(e,t.uid);o.mesh=i;o.data=t;i._trace=o;e.glplot.add(i);return o}t.exports=v},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/gl3d/zip3":881,"gl-cone3d":260}],1006:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}var u=l("u");var c=l("v");var f=l("w");var h=l("x");var p=l("y");var d=l("z");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length||!p||!p.length||!d||!d.length){r.visible=false;return}l("sizeref");l("sizemode");l("anchor");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");a(t,r,s,l,{prefix:"",cLetter:"c"});l("text");l("hovertext");l("hovertemplate");r._length=null}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1003}],1007:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"cone",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){e.norm=t.traceCoordinate[6];return e},meta:{}}},{"../../plots/gl3d":870,"./attributes":1003,"./calc":1004,"./convert":1005,"./defaults":1006}],1008:[function(e,t,r){"use strict";var n=e("../heatmap/attributes");var a=e("../scatter/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../components/drawing/attributes").dash;var s=e("../../plots/font_attributes");var l=e("../../lib/extend").extendFlat;var u=e("../../constants/filter_ops");var c=u.COMPARISON_OPS2;var f=u.INTERVAL_OPS;var h=e("../../constants/docs").FORMAT_LINK;var p=a.line;t.exports=l({z:n.z,x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,text:n.text,hovertext:n.hovertext,transpose:n.transpose,xtype:n.xtype,ytype:n.ytype,zhoverformat:n.zhoverformat,hovertemplate:n.hovertemplate,hoverongaps:n.hoverongaps,connectgaps:l({},n.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"contours.start":undefined,"contours.end":undefined,"contours.size":undefined}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":false}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":false}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":false}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:true,editType:"plot"},showlabels:{valType:"boolean",dflt:false,editType:"plot"},labelfont:s({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(c).concat(f),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:false}},line:{color:l({},p.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:o,smoothing:l({},p.smoothing,{}),editType:"plot"}},i("",{cLetter:"z",autoColorDflt:false,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../constants/docs":748,"../../constants/filter_ops":749,"../../lib/extend":768,"../../plots/font_attributes":856,"../heatmap/attributes":1065,"../scatter/attributes":1187}],1009:[function(e,t,r){"use strict";var n=e("../../components/colorscale");var a=e("../heatmap/calc");var i=e("./set_contours");var o=e("./end_plus");t.exports=function e(t,r){var s=a(t,r);var l=s[0].z;i(r,l);var u=r.contours;var c=n.extractOpts(r);var f;if(u.coloring==="heatmap"&&c.auto&&r.autocontour===false){var h=u.start;var p=o(u);var d=u.size||1;var v=Math.floor((p-h)/d)+1;if(!isFinite(d)){d=1;v=1}var m=h-d/2;var g=m+v*d;f=[m,g]}else{f=l}n.calc(t,r,{vals:f,cLetter:"z"});return s}},{"../../components/colorscale":655,"../heatmap/calc":1066,"./end_plus":1019,"./set_contours":1027}],1010:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e[0];var n=r.z;var a;switch(t.type){case"levels":var i=Math.min(n[0][0],n[0][1]);for(a=0;a<e.length;a++){var o=e[a];o.prefixBoundary=!o.edgepaths.length&&(i>o.level||o.starts.length&&i===o.level)}break;case"constraint":r.prefixBoundary=false;if(r.edgepaths.length)return;var s=r.x.length;var l=r.y.length;var u=-Infinity;var c=Infinity;for(a=0;a<l;a++){c=Math.min(c,n[a][0]);c=Math.min(c,n[a][s-1]);u=Math.max(u,n[a][0]);u=Math.max(u,n[a][s-1])}for(a=1;a<s-1;a++){c=Math.min(c,n[0][a]);c=Math.min(c,n[l-1][a]);u=Math.max(u,n[0][a]);u=Math.max(u,n[l-1][a])}var f=t.value;var h,p;switch(t._operation){case">":if(f>u){r.prefixBoundary=true}break;case"<":if(f<c||r.starts.length&&f===c){r.prefixBoundary=true}break;case"[]":h=Math.min(f[0],f[1]);p=Math.max(f[0],f[1]);if(p<c||h>u||r.starts.length&&p===c){r.prefixBoundary=true}break;case"][":h=Math.min(f[0],f[1]);p=Math.max(f[0],f[1]);if(h<c&&p>u){r.prefixBoundary=true}break}break}}},{}],1011:[function(e,t,r){"use strict";var n=e("../../components/colorscale");var a=e("./make_color_map");var i=e("./end_plus");function o(e,t,r){var o=t.contours;var s=t.line;var l=o.size||1;var u=o.coloring;var c=a(t,{isColorbar:true});if(u==="heatmap"){var f=n.extractOpts(t);r._fillgradient=f.reversescale?n.flipScale(f.colorscale):f.colorscale;r._zrange=[f.min,f.max]}else if(u==="fill"){r._fillcolor=c}r._line={color:u==="lines"?c:s.color,width:o.showlines!==false?s.width:0,dash:s.dash};r._levels={start:o.start,end:i(o),size:l}}t.exports={min:"zmin",max:"zmax",calc:o}},{"../../components/colorscale":655,"./end_plus":1019,"./make_color_map":1024}],1012:[function(e,t,r){"use strict";t.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1013:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("./label_defaults");var i=e("../../components/color");var o=i.addOpacity;var s=i.opacity;var l=e("../../constants/filter_ops");var u=l.CONSTRAINT_REDUCTION;var c=l.COMPARISON_OPS2;t.exports=function e(t,r,n,i,l,c){var h=r.contours;var p,d,v;var m=n("contours.operation");h._operation=u[m];f(n,h);if(m==="="){p=h.showlines=true}else{p=n("contours.showlines");v=n("fillcolor",o((t.line||{}).color||l,.5))}if(p){var g=v&&s(v)?o(r.fillcolor,1):l;d=n("line.color",g);n("line.width",2);n("line.dash")}n("line.smoothing");a(n,i,d,c)};function f(e,t){var r;if(c.indexOf(t.operation)===-1){e("contours.value",[0,1]);if(!Array.isArray(t.value)){if(n(t.value)){r=parseFloat(t.value);t.value=[r,r+1]}}else if(t.value.length>2){t.value=t.value.slice(2)}else if(t.length===0){t.value=[0,1]}else if(t.length<2){r=parseFloat(t.value[0]);t.value=[r,r+1]}else{t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]}}else{e("contours.value",0);if(!n(t.value)){if(Array.isArray(t.value)){t.value=parseFloat(t.value[0])}else{t.value=0}}}}},{"../../components/color":643,"../../constants/filter_ops":749,"./label_defaults":1023,"fast-isnumeric":241}],1014:[function(e,t,r){"use strict";var n=e("../../constants/filter_ops");var a=e("fast-isnumeric");t.exports={"[]":o("[]"),"][":o("]["),">":s(">"),"<":s("<"),"=":s("=")};function i(e,t){var r=Array.isArray(t);var i;function o(e){return a(e)?+e:null}if(n.COMPARISON_OPS2.indexOf(e)!==-1){i=r?o(t[0]):o(t)}else if(n.INTERVAL_OPS.indexOf(e)!==-1){i=r?[o(t[0]),o(t[1])]:[o(t),o(t)]}else if(n.SET_OPS.indexOf(e)!==-1){i=r?t.map(o):[o(t)]}return i}function o(e){return function(t){t=i(e,t);var r=Math.min(t[0],t[1]);var n=Math.max(t[0],t[1]);return{start:r,end:n,size:n-r}}}function s(e){return function(t){t=i(e,t);return{start:t,end:Infinity,size:Infinity}}}},{"../../constants/filter_ops":749,"fast-isnumeric":241}],1015:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a){var i=a("contours.start");var o=a("contours.end");var s=i===false||o===false;var l=n("contours.size");var u;if(s)u=r.autocontour=true;else u=n("autocontour",false);if(u||!l)n("ncontours")}},{}],1016:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function(e,t){var r,i,o;var s=function(e){return e.reverse()};var l=function(e){return e};switch(t){case"=":case"<":return e;case">":if(e.length!==1){n.warn("Contour data invalid for the specified inequality operation.")}i=e[0];for(r=0;r<i.edgepaths.length;r++){i.edgepaths[r]=s(i.edgepaths[r])}for(r=0;r<i.paths.length;r++){i.paths[r]=s(i.paths[r])}for(r=0;r<i.starts.length;r++){i.starts[r]=s(i.starts[r])}return e;case"][":var u=s;s=l;l=u;case"[]":if(e.length!==2){n.warn("Contour data invalid for the specified inequality range operation.")}i=a(e[0]);o=a(e[1]);for(r=0;r<i.edgepaths.length;r++){i.edgepaths[r]=s(i.edgepaths[r])}for(r=0;r<i.paths.length;r++){i.paths[r]=s(i.paths[r])}for(r=0;r<i.starts.length;r++){i.starts[r]=s(i.starts[r])}while(o.edgepaths.length){i.edgepaths.push(l(o.edgepaths.shift()))}while(o.paths.length){i.paths.push(l(o.paths.shift()))}while(o.starts.length){i.starts.push(l(o.starts.shift()))}return[i]}};function a(e){return n.extendFlat({},e,{edgepaths:n.extendDeep([],e.edgepaths),paths:n.extendDeep([],e.paths),starts:n.extendDeep([],e.starts)})}},{"../../lib":778}],1017:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../heatmap/xyz_defaults");var i=e("../scatter/period_defaults");var o=e("./constraint_defaults");var s=e("./contours_defaults");var l=e("./style_defaults");var u=e("./attributes");t.exports=function e(t,r,c,f){function h(e,a){return n.coerce(t,r,u,e,a)}function p(e){return n.coerce2(t,r,u,e)}var d=a(t,r,h,f);if(!d){r.visible=false;return}i(t,r,f,h);h("text");h("hovertext");h("hovertemplate");h("hoverongaps");var v=h("contours.type")==="constraint";h("connectgaps",n.isArray1D(r.z));if(v){o(t,r,h,f,c)}else{s(t,r,h,p);l(t,r,h,f)}}},{"../../lib":778,"../heatmap/xyz_defaults":1079,"../scatter/period_defaults":1207,"./attributes":1008,"./constraint_defaults":1013,"./contours_defaults":1015,"./style_defaults":1029}],1018:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./constraint_mapping");var i=e("./end_plus");t.exports=function e(t,r,o){var s=t.type==="constraint"?a[t._operation](t.value):t;var l=s.size;var u=[];var c=i(s);var f=o.trace._carpetTrace;var h=f?{xaxis:f.aaxis,yaxis:f.baxis,x:o.a,y:o.b}:{xaxis:r.xaxis,yaxis:r.yaxis,x:o.x,y:o.y};for(var p=s.start;p<c;p+=l){u.push(n.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:o.z,smoothing:o.trace.line.smoothing},h));if(u.length>1e3){n.warn("Too many contours, clipping at 1000",t);break}}return u}},{"../../lib":778,"./constraint_mapping":1014,"./end_plus":1019}],1019:[function(e,t,r){"use strict";t.exports=function e(t){return t.end+t.size/1e6}},{}],1020:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./constants");t.exports=function e(t,r,a){var i,o,l,u,c;r=r||.01;a=a||.01;for(l=0;l<t.length;l++){u=t[l];for(c=0;c<u.starts.length;c++){o=u.starts[c];s(u,o,"edge",r,a)}i=0;while(Object.keys(u.crossings).length&&i<1e4){i++;o=Object.keys(u.crossings)[0].split(",").map(Number);s(u,o,undefined,r,a)}if(i===1e4)n.log("Infinite loop in contour?")}};function i(e,t,r,n){return Math.abs(e[0]-t[0])<r&&Math.abs(e[1]-t[1])<n}function o(e,t){var r=e[2]-t[2];var n=e[3]-t[3];return Math.sqrt(r*r+n*n)}function s(e,t,r,s,c){var f=t.join(",");var h=e.crossings[f];var p=l(h,r,t);var d=[u(e,t,[-p[0],-p[1]])];var v=e.z.length;var m=e.z[0].length;var g=t.slice();var y=p.slice();var x;for(x=0;x<1e4;x++){if(h>20){h=a.CHOOSESADDLE[h][(p[0]||p[1])<0?0:1];e.crossings[f]=a.SADDLEREMAINDER[h]}else{delete e.crossings[f]}p=a.NEWDELTA[h];if(!p){n.log("Found bad marching index:",h,t,e.level);break}d.push(u(e,t,p));t[0]+=p[0];t[1]+=p[1];f=t.join(",");if(i(d[d.length-1],d[d.length-2],s,c))d.pop();var _=p[0]&&(t[0]<0||t[0]>m-2)||p[1]&&(t[1]<0||t[1]>v-2);var b=t[0]===g[0]&&t[1]===g[1]&&p[0]===y[0]&&p[1]===y[1];if(b||r&&_)break;h=e.crossings[f]}if(x===1e4){n.log("Infinite loop in contour?")}var w=i(d[0],d[d.length-1],s,c);var T=0;var k=.2*e.smoothing;var A=[];var M=0;var E,S,C,L,I,O,P,D,R,z,N;for(x=1;x<d.length;x++){P=o(d[x],d[x-1]);T+=P;A.push(P)}var F=T/A.length*k;function B(e){return d[e%d.length]}for(x=d.length-2;x>=M;x--){E=A[x];if(E<F){C=0;for(S=x-1;S>=M;S--){if(E+A[S]<F){E+=A[S]}else break}if(w&&x===d.length-2){for(C=0;C<S;C++){if(E+A[C]<F){E+=A[C]}else break}}I=x-S+C+1;O=Math.floor((x+S+C+2)/2);if(!w&&x===d.length-2)L=d[d.length-1];else if(!w&&S===-1)L=d[0];else if(I%2)L=B(O);else{L=[(B(O)[0]+B(O+1)[0])/2,(B(O)[1]+B(O+1)[1])/2]}d.splice(S+1,x-S+1,L);x=S+1;if(C)M=C;if(w){if(x===d.length-2)d[C]=d[d.length-1];else if(x===0)d[d.length-1]=d[0]}}}d.splice(0,M);for(x=0;x<d.length;x++)d[x].length=2;if(d.length<2)return;else if(w){d.pop();e.paths.push(d)}else{if(!r){n.log("Unclosed interior contour?",e.level,g.join(","),d.join("L"))}var j=false;for(D=0;D<e.edgepaths.length;D++){z=e.edgepaths[D];if(!j&&i(z[0],d[d.length-1],s,c)){d.pop();j=true;var U=false;for(R=0;R<e.edgepaths.length;R++){N=e.edgepaths[R];if(i(N[N.length-1],d[0],s,c)){U=true;d.shift();e.edgepaths.splice(D,1);if(R===D){e.paths.push(d.concat(N))}else{if(R>D)R--;e.edgepaths[R]=N.concat(d,z)}break}}if(!U){e.edgepaths[D]=d.concat(z)}}}for(D=0;D<e.edgepaths.length;D++){if(j)break;z=e.edgepaths[D];if(i(z[z.length-1],d[0],s,c)){d.shift();e.edgepaths[D]=z.concat(d);j=true}}if(!j)e.edgepaths.push(d)}}function l(e,t,r){var n=0;var i=0;if(e>20&&t){if(e===208||e===1114){n=r[0]===0?1:-1}else{i=r[1]===0?1:-1}}else if(a.BOTTOMSTART.indexOf(e)!==-1)i=1;else if(a.LEFTSTART.indexOf(e)!==-1)n=1;else if(a.TOPSTART.indexOf(e)!==-1)i=-1;else n=-1;return[n,i]}function u(e,t,r){var n=t[0]+Math.max(r[0],0);var a=t[1]+Math.max(r[1],0);var i=e.z[a][n];var o=e.xaxis;var s=e.yaxis;if(r[1]){var l=(e.level-i)/(e.z[a][n+1]-i);return[o.c2p((1-l)*e.x[n]+l*e.x[n+1],true),s.c2p(e.y[a],true),n+l,a]}else{var u=(e.level-i)/(e.z[a+1][n]-i);return[o.c2p(e.x[n],true),s.c2p((1-u)*e.y[a]+u*e.y[a+1],true),n,a+u]}}},{"../../lib":778,"./constants":1012}],1021:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("../heatmap/hover");t.exports=function e(t,r,i,o,s){var l=a(t,r,i,o,s,true);if(l){l.forEach(function(e){var t=e.trace;if(t.contours.type==="constraint"){if(t.fillcolor&&n.opacity(t.fillcolor)){e.color=n.addOpacity(t.fillcolor,1)}else if(t.contours.showlines&&n.opacity(t.line.color)){e.color=n.addOpacity(t.line.color,1)}}})}return l}},{"../../components/color":643,"../heatmap/hover":1072}],1022:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot").plot,style:e("./style"),colorbar:e("./colorbar"),hoverPoints:e("./hover"),moduleType:"trace",name:"contour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":841,"./attributes":1008,"./calc":1009,"./colorbar":1011,"./defaults":1017,"./hover":1021,"./plot":1026,"./style":1028}],1023:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r,a,i){if(!i)i={};var o=t("contours.showlabels");if(o){var s=r.font;n.coerceFont(t,"contours.labelfont",{family:s.family,size:s.size,color:a});t("contours.labelformat")}if(i.hasHover!==false)t("zhoverformat")}},{"../../lib":778}],1024:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/colorscale");var i=e("./end_plus");t.exports=function e(t){var r=t.contours;var o=r.start;var s=i(r);var l=r.size||1;var u=Math.floor((s-o)/l)+1;var c=r.coloring==="lines"?0:1;var f=a.extractOpts(t);if(!isFinite(l)){l=1;u=1}var h=f.reversescale?a.flipScale(f.colorscale):f.colorscale;var p=h.length;var d=new Array(p);var v=new Array(p);var m,g;if(r.coloring==="heatmap"){var y=f.min;var x=f.max;for(g=0;g<p;g++){m=h[g];d[g]=m[0]*(x-y)+y;v[g]=m[1]}var _=n.extent([y,x,r.start,r.start+l*(u-1)]);var b=_[y<x?0:1];var w=_[y<x?1:0];if(b!==y){d.splice(0,0,b);v.splice(0,0,v[0])}if(w!==x){d.push(w);v.push(v[v.length-1])}}else{for(g=0;g<p;g++){m=h[g];d[g]=(m[0]*(u+c-1)-c/2)*l+o;v[g]=m[1]}}return a.makeColorScaleFunc({domain:d,range:v},{noNumericCheck:true})}},{"../../components/colorscale":655,"./end_plus":1019,d3:169}],1025:[function(e,t,r){"use strict";var n=e("./constants");t.exports=function e(t){var r=t[0].z;var i=r.length;var o=r[0].length;var s=i===2||o===2;var l;var u;var c;var f;var h;var p;var d;var v;var m;for(u=0;u<i-1;u++){f=[];if(u===0)f=f.concat(n.BOTTOMSTART);if(u===i-2)f=f.concat(n.TOPSTART);for(l=0;l<o-1;l++){c=f.slice();if(l===0)c=c.concat(n.LEFTSTART);if(l===o-2)c=c.concat(n.RIGHTSTART);h=l+","+u;p=[[r[u][l],r[u][l+1]],[r[u+1][l],r[u+1][l+1]]];for(m=0;m<t.length;m++){v=t[m];d=a(v.level,p);if(!d)continue;v.crossings[h]=d;if(c.indexOf(d)!==-1){v.starts.push([l,u]);if(s&&c.indexOf(d,c.indexOf(d)+1)!==-1){v.starts.push([l,u])}}}}}};function a(e,t){var r=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);if(r===5||r===10){var n=(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4;if(e>n)return r===5?713:1114;return r===5?104:208}return r===15?0:r}},{"./constants":1012}],1026:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=e("../../components/colorscale");var s=e("../../lib/svg_text_utils");var l=e("../../plots/cartesian/axes");var u=e("../../plots/cartesian/set_convert");var c=e("../heatmap/plot");var f=e("./make_crossings");var h=e("./find_all_paths");var p=e("./empty_pathinfo");var d=e("./convert_to_constraints");var v=e("./close_boundaries");var m=e("./constants");var g=m.LABELOPTIMIZER;r.plot=function e(t,r,i,o){var s=r.xaxis;var l=r.yaxis;a.makeTraceGroups(o,i,"contour").each(function(e){var i=n.select(this);var o=e[0];var u=o.trace;var v=o.x;var m=o.y;var g=u.contours;var _=p(g,r,o);var w=a.ensureSingle(i,"g","heatmapcoloring");var k=[];if(g.coloring==="heatmap"){k=[e]}c(t,r,k,w);f(_);h(_);var A=s.c2p(v[0],true);var M=s.c2p(v[v.length-1],true);var E=l.c2p(m[0],true);var S=l.c2p(m[m.length-1],true);var C=[[A,S],[M,S],[M,E],[A,E]];var L=_;if(g.type==="constraint"){L=d(_,g._operation)}y(i,C,g);x(i,L,C,g);b(i,_,t,o,g);T(i,r,t,o,C)})};function y(e,t,r){var n=a.ensureSingle(e,"g","contourbg");var i=n.selectAll("path").data(r.coloring==="fill"?[0]:[]);i.enter().append("path");i.exit().remove();i.attr("d","M"+t.join("L")+"Z").style("stroke","none")}function x(e,t,r,i){var o=i.coloring==="fill"||i.type==="constraint"&&i._operation!=="=";var s="M"+r.join("L")+"Z";if(o){v(t,i)}var l=a.ensureSingle(e,"g","contourfill");var u=l.selectAll("path").data(o?t:[]);u.enter().append("path");u.exit().remove();u.each(function(e){var t=(e.prefixBoundary?s:"")+_(e,r);if(!t){n.select(this).remove()}else{n.select(this).attr("d",t).style("stroke","none")}})}function _(e,t){var r="";var n=0;var o=e.edgepaths.map(function(e,t){return t});var s=true;var l;var u;var c;var f;var h;var p;function d(e){return Math.abs(e[1]-t[0][1])<.01}function v(e){return Math.abs(e[1]-t[2][1])<.01}function m(e){return Math.abs(e[0]-t[0][0])<.01}function g(e){return Math.abs(e[0]-t[2][0])<.01}while(o.length){p=i.smoothopen(e.edgepaths[n],e.smoothing);r+=s?p:p.replace(/^M/,"L");o.splice(o.indexOf(n),1);l=e.edgepaths[n][e.edgepaths[n].length-1];f=-1;for(c=0;c<4;c++){if(!l){a.log("Missing end?",n,e);break}if(d(l)&&!g(l))u=t[1];else if(m(l))u=t[0];else if(v(l))u=t[3];else if(g(l))u=t[2];for(h=0;h<e.edgepaths.length;h++){var y=e.edgepaths[h][0];if(Math.abs(l[0]-u[0])<.01){if(Math.abs(l[0]-y[0])<.01&&(y[1]-l[1])*(u[1]-y[1])>=0){u=y;f=h}}else if(Math.abs(l[1]-u[1])<.01){if(Math.abs(l[1]-y[1])<.01&&(y[0]-l[0])*(u[0]-y[0])>=0){u=y;f=h}}else{a.log("endpt to newendpt is not vert. or horz.",l,u,y)}}l=u;if(f>=0)break;r+="L"+u}if(f===e.edgepaths.length){a.log("unclosed perimeter path");break}n=f;s=o.indexOf(n)===-1;if(s){n=o[0];r+="Z"}}for(n=0;n<e.paths.length;n++){r+=i.smoothclosed(e.paths[n],e.smoothing)}return r}function b(e,t,o,s,l){var u=a.ensureSingle(e,"g","contourlines");var c=l.showlines!==false;var f=l.showlabels;var h=c&&f;var p=r.createLines(u,c||f,t);var d=r.createLineClip(u,h,o,s.trace.uid);var v=e.selectAll("g.contourlabels").data(f?[0]:[]);v.exit().remove();v.enter().append("g").classed("contourlabels",true);if(f){var g=[];var y=[];a.clearLocationCache();var x=r.labelFormatter(o,s);var _=i.tester.append("text").attr("data-notex",1).call(i.font,l.labelfont);var b=t[0].xaxis;var w=t[0].yaxis;var T=b._length;var k=w._length;var A=b.range;var M=w.range;var E=a.aggNums(Math.min,null,s.x);var S=a.aggNums(Math.max,null,s.x);var C=a.aggNums(Math.min,null,s.y);var L=a.aggNums(Math.max,null,s.y);var I=Math.max(b.c2p(E,true),0);var O=Math.min(b.c2p(S,true),T);var P=Math.max(w.c2p(L,true),0);var D=Math.min(w.c2p(C,true),k);var R={};if(A[0]<A[1]){R.left=I;R.right=O}else{R.left=O;R.right=I}if(M[0]<M[1]){R.top=P;R.bottom=D}else{R.top=D;R.bottom=P}R.middle=(R.top+R.bottom)/2;R.center=(R.left+R.right)/2;g.push([[R.left,R.top],[R.right,R.top],[R.right,R.bottom],[R.left,R.bottom]]);var z=Math.sqrt(T*T+k*k);var N=m.LABELDISTANCE*z/Math.max(1,t.length/m.LABELINCREASE);p.each(function(e){var t=r.calcTextOpts(e.level,x,_,o);n.select(this).selectAll("path").each(function(){var e=this;var n=a.getVisibleSegment(e,R,t.height/2);if(!n)return;if(n.len<(t.width+t.height)*m.LABELMIN)return;var i=Math.min(Math.ceil(n.len/N),m.LABELMAX);for(var o=0;o<i;o++){var s=r.findBestTextLocation(e,n,t,y,R);if(!s)break;r.addLabelData(s,t,y,g)}})});_.remove();r.drawLabels(v,y,o,d,h?g:null)}if(f&&!c)p.remove()}r.createLines=function(e,t,r){var n=r[0].smoothing;var a=e.selectAll("g.contourlevel").data(t?r:[]);a.exit().remove();a.enter().append("g").classed("contourlevel",true);if(t){var o=a.selectAll("path.openline").data(function(e){return e.pedgepaths||e.edgepaths});o.exit().remove();o.enter().append("path").classed("openline",true);o.attr("d",function(e){return i.smoothopen(e,n)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var s=a.selectAll("path.closedline").data(function(e){return e.ppaths||e.paths});s.exit().remove();s.enter().append("path").classed("closedline",true);s.attr("d",function(e){return i.smoothclosed(e,n)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return a};r.createLineClip=function(e,t,r,n){var a=r._fullLayout._clips;var o=t?"clipline"+n:null;var s=a.selectAll("#"+o).data(t?[0]:[]);s.exit().remove();s.enter().append("clipPath").classed("contourlineclip",true).attr("id",o);i.setClipUrl(e,o,r);return s};r.labelFormatter=function(e,t){var r=e._fullLayout;var n=t.trace;var a=n.contours;var i={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(a.labelformat){i.tickformat=a.labelformat;u(i,r)}else{var s=o.extractOpts(n);if(s&&s.colorbar&&s.colorbar._axis){i=s.colorbar._axis}else{if(a.type==="constraint"){var c=a.value;if(Array.isArray(c)){i.range=[c[0],c[c.length-1]]}else i.range=[c,c]}else{i.range=[a.start,a.end];i.nticks=(a.end-a.start)/a.size}if(i.range[0]===i.range[1]){i.range[1]+=i.range[0]||1}if(!i.nticks)i.nticks=1e3;u(i,r);l.prepTicks(i);i._tmin=null;i._tmax=null}}return function(e){return l.tickText(i,e).text}};r.calcTextOpts=function(e,t,r,n){var a=t(e);r.text(a).call(s.convertToTspans,n);var o=r.node();var l=i.bBox(o,true);return{text:a,width:l.width,height:l.height,fontSize:+o.style["font-size"].replace("px",""),level:e,dy:(l.top+l.bottom)/2}};r.findBestTextLocation=function(e,t,r,n,i){var o=r.width;var s,l,u,c,f;if(t.isClosed){l=t.len/g.INITIALSEARCHPOINTS;s=t.min+l/2;u=t.max}else{l=(t.len-o)/(g.INITIALSEARCHPOINTS+1);s=t.min+l+o/2;u=t.max-(l+o)/2}var h=Infinity;for(var p=0;p<g.ITERATIONS;p++){for(var d=s;d<u;d+=l){var v=a.getTextLocation(e,t.total,d,o);var m=w(v,r,n,i);if(m<h){h=m;f=v;c=d}}if(h>g.MAXCOST*2)break;if(p)l/=2;s=c-l/2;u=s+l*1.5}if(h<=g.MAXCOST)return f};function w(e,t,r,n){var i=t.width/2;var o=t.height/2;var s=e.x;var l=e.y;var u=e.theta;var c=Math.cos(u)*i;var f=Math.sin(u)*i;var h=(s>n.center?n.right-s:s-n.left)/(c+Math.abs(Math.sin(u)*o));var p=(l>n.middle?n.bottom-l:l-n.top)/(Math.abs(f)+Math.cos(u)*o);if(h<1||p<1)return Infinity;var d=g.EDGECOST*(1/(h-1)+1/(p-1));d+=g.ANGLECOST*u*u;var v=s-c;var m=l-f;var y=s+c;var x=l+f;for(var _=0;_<r.length;_++){var b=r[_];var w=Math.cos(b.theta)*b.width/2;var T=Math.sin(b.theta)*b.width/2;var k=a.segmentDistance(v,m,y,x,b.x-w,b.y-T,b.x+w,b.y+T)*2/(t.height+b.height);var A=b.level===t.level;var M=A?g.SAMELEVELDISTANCE:1;if(k<=M)return Infinity;var E=g.NEIGHBORCOST*(A?g.SAMELEVELFACTOR:1);d+=E/(k-M)}return d}r.addLabelData=function(e,t,r,n){var a=t.fontSize;var i=t.width+a/3;var o=Math.max(0,t.height-a/3);var s=e.x;var l=e.y;var u=e.theta;var c=Math.sin(u);var f=Math.cos(u);var h=function(e,t){return[s+e*f-t*c,l+e*c+t*f]};var p=[h(-i/2,-o/2),h(-i/2,o/2),h(i/2,o/2),h(i/2,-o/2)];r.push({text:t.text,x:s,y:l,dy:t.dy,theta:u,level:t.level,width:i,height:o});n.push(p)};r.drawLabels=function(e,t,r,i,o){var l=e.selectAll("text").data(t,function(e){return e.text+","+e.x+","+e.y+","+e.theta});l.exit().remove();l.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(e){var t=e.x+Math.sin(e.theta)*e.dy;var a=e.y-Math.cos(e.theta)*e.dy;n.select(this).text(e.text).attr({x:t,y:a,transform:"rotate("+180*e.theta/Math.PI+" "+t+" "+a+")"}).call(s.convertToTspans,r)});if(o){var u="";for(var c=0;c<o.length;c++){u+="M"+o[c].join("L")+"Z"}var f=a.ensureSingle(i,"path","");f.attr("d",u)}};function T(e,t,r,n,o){var s=n.trace;var l=r._fullLayout._clips;var u="clip"+s.uid;var c=l.selectAll("#"+u).data(s.connectgaps?[]:[0]);c.enter().append("clipPath").classed("contourclip",true).attr("id",u);c.exit().remove();if(s.connectgaps===false){var p={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:n.x,y:n.y,z:k(n),smoothing:0};f([p]);h([p]);v([p],{type:"levels"});var d=a.ensureSingle(c,"path","");d.attr("d",(p.prefixBoundary?"M"+o.join("L")+"Z":"")+_(p,o))}else u=null;i.setClipUrl(e,u,r)}function k(e){var t=e.trace._emptypoints;var r=[];var n=e.z.length;var a=e.z[0].length;var i;var o=[];var s;for(i=0;i<a;i++)o.push(1);for(i=0;i<n;i++)r.push(o.slice());for(i=0;i<t.length;i++){s=t[i];r[s[0]][s[1]]=0}e.zmask=r;return r}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/set_convert":848,"../heatmap/plot":1076,"./close_boundaries":1010,"./constants":1012,"./convert_to_constraints":1016,"./empty_pathinfo":1018,"./find_all_paths":1020,"./make_crossings":1025,d3:169}],1027:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib");t.exports=function e(t,r){var o=t.contours;if(t.autocontour){var s=t.zmin;var l=t.zmax;if(t.zauto||s===undefined){s=a.aggNums(Math.min,null,r)}if(t.zauto||l===undefined){l=a.aggNums(Math.max,null,r)}var u=i(s,l,t.ncontours);o.size=u.dtick;o.start=n.tickFirst(u);u.range.reverse();o.end=n.tickFirst(u);if(o.start===s)o.start+=o.size;if(o.end===l)o.end-=o.size;if(o.start>o.end){o.start=o.end=(o.start+o.end)/2}if(!t._input.contours)t._input.contours={};a.extendFlat(t._input.contours,{start:o.start,end:o.end,size:o.size});t._input.autocontour=true}else if(o.type!=="constraint"){var c=o.start;var f=o.end;var h=t._input.contours;if(c>f){o.start=h.start=f;f=o.end=h.end=c;c=o.start}if(!(o.size>0)){var p;if(c===f)p=1;else p=i(c,f,t.ncontours).dtick;h.size=o.size=p}}};function i(e,t,r){var a={type:"linear",range:[e,t]};n.autoTicks(a,(t-e)/(r||15));return a}},{"../../lib":778,"../../plots/cartesian/axes":828}],1028:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../heatmap/style");var o=e("./make_color_map");t.exports=function e(t){var r=n.select(t).selectAll("g.contour");r.style("opacity",function(e){return e[0].trace.opacity});r.each(function(e){var t=n.select(this);var r=e[0].trace;var i=r.contours;var s=r.line;var l=i.size||1;var u=i.start;var c=i.type==="constraint";var f=!c&&i.coloring==="lines";var h=!c&&i.coloring==="fill";var p=f||h?o(r):null;t.selectAll("g.contourlevel").each(function(e){n.select(this).selectAll("path").call(a.lineGroupStyle,s.width,f?p(e.level):s.color,s.dash)});var d=i.labelfont;t.selectAll("g.contourlabels text").each(function(e){a.font(n.select(this),{family:d.family,size:d.size,color:d.color||(f?p(e.level):s.color)})});if(c){t.selectAll("g.contourfill path").style("fill",r.fillcolor)}else if(h){var v;t.selectAll("g.contourfill path").style("fill",function(e){if(v===undefined)v=e.level;return p(e.level+.5*l)});if(v===undefined)v=u;t.selectAll("g.contourbg path").style("fill",p(v-.5*l))}});i(t)}},{"../../components/drawing":665,"../heatmap/style":1077,"./make_color_map":1024,d3:169}],1029:[function(e,t,r){"use strict";var n=e("../../components/colorscale/defaults");var a=e("./label_defaults");t.exports=function e(t,r,i,o,s){var l=i("contours.coloring");var u;var c="";if(l==="fill")u=i("contours.showlines");if(u!==false){if(l!=="lines")c=i("line.color","#000");i("line.width",.5);i("line.dash")}if(l!=="none"){if(t.showlegend!==true)r.showlegend=false;r._dfltShowLegend=false;n(t,r,o,i,{prefix:"",cLetter:"z"})}i("line.smoothing");a(i,o,c,s)}},{"../../components/colorscale/defaults":653,"./label_defaults":1023}],1030:[function(e,t,r){"use strict";var n=e("../heatmap/attributes");var a=e("../contour/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../lib/extend").extendFlat;var s=a.contours;t.exports=o({carpet:{valType:"string",editType:"calc"},z:n.z,a:n.x,a0:n.x0,da:n.dx,b:n.y,b0:n.y0,db:n.dy,text:n.text,hovertext:n.hovertext,transpose:n.transpose,atype:n.xtype,btype:n.ytype,fillcolor:a.fillcolor,autocontour:a.autocontour,ncontours:a.ncontours,contours:{type:s.type,start:s.start,end:s.end,size:s.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:s.showlines,showlabels:s.showlabels,labelfont:s.labelfont,labelformat:s.labelformat,operation:s.operation,value:s.value,editType:"calc",impliedEdits:{autocontour:false}},line:{color:a.line.color,width:a.line.width,dash:a.line.dash,smoothing:a.line.smoothing,editType:"plot"},transforms:undefined},i("",{cLetter:"z",autoColorDflt:false}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../contour/attributes":1008,"../heatmap/attributes":1065}],1031:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");var a=e("../../lib");var i=e("../heatmap/convert_column_xyz");var o=e("../heatmap/clean_2d_array");var s=e("../heatmap/interp2d");var l=e("../heatmap/find_empties");var u=e("../heatmap/make_bound_array");var c=e("./defaults");var f=e("../carpet/lookup_carpetid");var h=e("../contour/set_contours");t.exports=function e(t,r){var n=r._carpetTrace=f(t,r);if(!n||!n.visible||n.visible==="legendonly")return;if(!r.a||!r.b){var a=t.data[n.index];var i=t.data[r.index];if(!i.a)i.a=a.a;if(!i.b)i.b=a.b;c(i,r,r._defaultColor,t._fullLayout)}var o=p(t,r);h(r,r._z);return o};function p(e,t){var r=t._carpetTrace;var c=r.aaxis;var f=r.baxis;var h,p,d,v,m,g,y;c._minDtick=0;f._minDtick=0;if(a.isArray1D(t.z))i(t,c,f,"a","b",["z"]);h=t._a=t._a||t.a;v=t._b=t._b||t.b;h=h?c.makeCalcdata(t,"_a"):[];v=v?f.makeCalcdata(t,"_b"):[];p=t.a0||0;d=t.da||1;m=t.b0||0;g=t.db||1;y=t._z=o(t._z||t.z,t.transpose);t._emptypoints=l(y);s(y,t._emptypoints);var x=a.maxRowLength(y);var _=t.xtype==="scaled"?"":h;var b=u(t,_,p,d,x,c);var w=t.ytype==="scaled"?"":v;var T=u(t,w,m,g,y.length,f);var k={a:b,b:T,z:y};if(t.contours.type==="levels"&&t.contours.coloring!=="none"){n(e,t,{vals:y,containerStr:"",cLetter:"z"})}return[k]}},{"../../components/colorscale/calc":651,"../../lib":778,"../carpet/lookup_carpetid":981,"../contour/set_contours":1027,"../heatmap/clean_2d_array":1067,"../heatmap/convert_column_xyz":1069,"../heatmap/find_empties":1071,"../heatmap/interp2d":1074,"../heatmap/make_bound_array":1075,"./defaults":1032}],1032:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../heatmap/xyz_defaults");var i=e("./attributes");var o=e("../contour/constraint_defaults");var s=e("../contour/contours_defaults");var l=e("../contour/style_defaults");t.exports=function e(t,r,u,c){function f(e,a){return n.coerce(t,r,i,e,a)}function h(e){return n.coerce2(t,r,i,e)}f("carpet");if(t.a&&t.b){var p=a(t,r,f,c,"a","b");if(!p){r.visible=false;return}f("text");var d=f("contours.type")==="constraint";if(d){o(t,r,f,c,u,{hasHover:false})}else{s(t,r,f,h);l(t,r,f,c,{hasHover:false})}}else{r._defaultColor=u;r._length=null}}},{"../../lib":778,"../contour/constraint_defaults":1013,"../contour/contours_defaults":1015,"../contour/style_defaults":1029,"../heatmap/xyz_defaults":1079,"./attributes":1030}],1033:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../contour/colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":841,"../contour/colorbar":1011,"../contour/style":1028,"./attributes":1030,"./calc":1031,"./defaults":1032,"./plot":1034}],1034:[function(e,t,r){"use strict";var n=e("d3");var a=e("../carpet/map_1d_array");var i=e("../carpet/makepath");var o=e("../../components/drawing");var s=e("../../lib");var l=e("../contour/make_crossings");var u=e("../contour/find_all_paths");var c=e("../contour/plot");var f=e("../contour/constants");var h=e("../contour/convert_to_constraints");var p=e("../contour/empty_pathinfo");var d=e("../contour/close_boundaries");var v=e("../carpet/lookup_carpetid");var m=e("../carpet/axis_aligned_line");t.exports=function e(t,r,c,f){var d=r.xaxis;var m=r.yaxis;s.makeTraceGroups(f,c,"contour").each(function(e){var s=n.select(this);var c=e[0];var f=c.trace;var x=f._carpetTrace=v(t,f);var _=t.calcdata[x.index][0];if(!x.visible||x.visible==="legendonly")return;var b=c.a;var w=c.b;var A=f.contours;var M=p(A,r,c);var E=A.type==="constraint";var S=A._operation;var C=E?S==="="?"lines":"fill":A.coloring;function L(e){var t=x.ab2xy(e[0],e[1],true);return[d.c2p(t[0]),m.c2p(t[1])]}var I=[[b[0],w[w.length-1]],[b[b.length-1],w[w.length-1]],[b[b.length-1],w[0]],[b[0],w[0]]];l(M);var O=(b[b.length-1]-b[0])*1e-8;var P=(w[w.length-1]-w[0])*1e-8;u(M,O,P);var D=M;if(A.type==="constraint"){D=h(M,S)}g(M,L);var R,z,N,F;var B=[];for(F=_.clipsegments.length-1;F>=0;F--){R=_.clipsegments[F];z=a([],R.x,d.c2p);N=a([],R.y,m.c2p);z.reverse();N.reverse();B.push(i(z,N,R.bicubic))}var j="M"+B.join("L")+"Z";T(s,_.clipsegments,d,m,E,C);k(f,s,d,m,D,I,L,x,_,C,j);y(s,M,t,c,A,r,x);o.setClipUrl(s,x._clipPathId,t)})};function g(e,t){var r,n,a,i,o,s,l,u,c;for(r=0;r<e.length;r++){i=e[r];o=i.pedgepaths=[];s=i.ppaths=[];for(n=0;n<i.edgepaths.length;n++){c=i.edgepaths[n];l=[];for(a=0;a<c.length;a++){l[a]=t(c[a])}o.push(l)}for(n=0;n<i.paths.length;n++){c=i.paths[n];u=[];for(a=0;a<c.length;a++){u[a]=t(c[a])}s.push(u)}}}function y(e,t,r,a,i,l,u){var h=s.ensureSingle(e,"g","contourlines");var p=i.showlines!==false;var d=i.showlabels;var v=p&&d;var m=c.createLines(h,p||d,t);var g=c.createLineClip(h,v,r,a.trace.uid);var y=e.selectAll("g.contourlabels").data(d?[0]:[]);y.exit().remove();y.enter().append("g").classed("contourlabels",true);if(d){var _=l.xaxis;var b=l.yaxis;var w=_._length;var T=b._length;var k=[[[0,0],[w,0],[w,T],[0,T]]];var A=[];s.clearLocationCache();var M=c.labelFormatter(r,a);var E=o.tester.append("text").attr("data-notex",1).call(o.font,i.labelfont);var S={left:0,right:w,center:w/2,top:0,bottom:T,middle:T/2};var C=Math.sqrt(w*w+T*T);var L=f.LABELDISTANCE*C/Math.max(1,t.length/f.LABELINCREASE);m.each(function(e){var t=c.calcTextOpts(e.level,M,E,r);n.select(this).selectAll("path").each(function(r){var n=this;var a=s.getVisibleSegment(n,S,t.height/2);if(!a)return;x(n,r,e,a,u,t.height);if(a.len<(t.width+t.height)*f.LABELMIN)return;var i=Math.min(Math.ceil(a.len/L),f.LABELMAX);for(var o=0;o<i;o++){var l=c.findBestTextLocation(n,a,t,A,S);if(!l)break;c.addLabelData(l,t,A,k)}})});E.remove();c.drawLabels(y,A,r,g,v?k:null)}if(d&&!p)m.remove()}function x(e,t,r,n,a,i){var o;for(var s=0;s<r.pedgepaths.length;s++){if(t===r.pedgepaths[s]){o=r.edgepaths[s]}}if(!o)return;var l=a.a[0];var u=a.a[a.a.length-1];var c=a.b[0];var f=a.b[a.b.length-1];function h(e,t){var r=0;var n;var o=.1;if(Math.abs(e[0]-l)<o||Math.abs(e[0]-u)<o){n=b(a.dxydb_rough(e[0],e[1],o));r=Math.max(r,i*w(t,n)/2)}if(Math.abs(e[1]-c)<o||Math.abs(e[1]-f)<o){n=b(a.dxyda_rough(e[0],e[1],o));r=Math.max(r,i*w(t,n)/2)}return r}var p=_(e,0,1);var d=_(e,n.total,n.total-1);var v=h(o[0],p);var m=n.total-h(o[o.length-1],d);if(n.min<v)n.min=v;if(n.max>m)n.max=m;n.len=n.max-n.min}function _(e,t,r){var n=e.getPointAtLength(t);var a=e.getPointAtLength(r);var i=a.x-n.x;var o=a.y-n.y;var s=Math.sqrt(i*i+o*o);return[i/s,o/s]}function b(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function w(e,t){var r=Math.abs(e[0]*t[0]+e[1]*t[1]);var n=Math.sqrt(1-r*r);return n/r}function T(e,t,r,n,o,l){var u,c,f,h;var p=s.ensureSingle(e,"g","contourbg");var d=p.selectAll("path").data(l==="fill"&&!o?[0]:[]);d.enter().append("path");d.exit().remove();var v=[];for(h=0;h<t.length;h++){u=t[h];c=a([],u.x,r.c2p);f=a([],u.y,n.c2p);v.push(i(c,f,u.bicubic))}d.attr("d","M"+v.join("L")+"Z").style("stroke","none")}function k(e,t,r,a,i,o,l,u,c,f,h){var p=f==="fill";if(p){d(i,e.contours)}var v=s.ensureSingle(t,"g","contourfill");var m=v.selectAll("path").data(p?i:[]);m.enter().append("path");m.exit().remove();m.each(function(t){var i=(t.prefixBoundary?h:"")+A(e,t,o,l,u,c,r,a);if(!i){n.select(this).remove()}else{n.select(this).attr("d",i).style("stroke","none")}})}function A(e,t,r,n,a,i,l,u){var c;var f="";var h=t.edgepaths.map(function(e,t){return t});var p=true;var d,v,g,y,x,_;var b=Math.abs(r[0][0]-r[2][0])*1e-4;var w=Math.abs(r[0][1]-r[2][1])*1e-4;function T(e){return Math.abs(e[1]-r[0][1])<w}function k(e){return Math.abs(e[1]-r[2][1])<w}function A(e){return Math.abs(e[0]-r[0][0])<b}function M(e){return Math.abs(e[0]-r[2][0])<b}function E(e,t){var r,n,o,s;var c="";if(T(e)&&!M(e)||k(e)&&!A(e)){s=a.aaxis;o=m(a,i,[e[0],t[0]],.5*(e[1]+t[1]))}else{s=a.baxis;o=m(a,i,.5*(e[0]+t[0]),[e[1],t[1]])}for(r=1;r<o.length;r++){c+=s.smoothing?"C":"L";for(n=0;n<o[r].length;n++){var f=o[r][n];c+=[l.c2p(f[0]),u.c2p(f[1])]+" "}}return c}c=0;d=null;while(h.length){var S=t.edgepaths[c][0];if(d){f+=E(d,S)}_=o.smoothopen(t.edgepaths[c].map(n),t.smoothing);f+=p?_:_.replace(/^M/,"L");h.splice(h.indexOf(c),1);d=t.edgepaths[c][t.edgepaths[c].length-1];y=-1;for(g=0;g<4;g++){if(!d){s.log("Missing end?",c,t);break}if(T(d)&&!M(d)){v=r[1]}else if(A(d)){v=r[0]}else if(k(d)){v=r[3]}else if(M(d)){v=r[2]}for(x=0;x<t.edgepaths.length;x++){var C=t.edgepaths[x][0];if(Math.abs(d[0]-v[0])<b){if(Math.abs(d[0]-C[0])<b&&(C[1]-d[1])*(v[1]-C[1])>=0){v=C;y=x}}else if(Math.abs(d[1]-v[1])<w){if(Math.abs(d[1]-C[1])<w&&(C[0]-d[0])*(v[0]-C[0])>=0){v=C;y=x}}else{s.log("endpt to newendpt is not vert. or horz.",d,v,C)}}if(y>=0)break;f+=E(d,v);d=v}if(y===t.edgepaths.length){s.log("unclosed perimeter path");break}c=y;p=h.indexOf(c)===-1;if(p){c=h[0];f+=E(d,v)+"Z";d=null}}for(c=0;c<t.paths.length;c++){f+=o.smoothclosed(t.paths[c].map(n),t.smoothing)}return f}},{"../../components/drawing":665,"../../lib":778,"../carpet/axis_aligned_line":965,"../carpet/lookup_carpetid":981,"../carpet/makepath":982,"../carpet/map_1d_array":983,"../contour/close_boundaries":1010,"../contour/constants":1012,"../contour/convert_to_constraints":1016,"../contour/empty_pathinfo":1018,"../contour/find_all_paths":1020,"../contour/make_crossings":1025,"../contour/plot":1026,d3:169}],1035:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../plots/attributes");var o=e("../scattermapbox/attributes");var s=e("../../lib/extend").extendFlat;t.exports=s({lon:o.lon,lat:o.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:true,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:o.text,hovertext:o.hovertext,hoverinfo:s({},i.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:a(),showlegend:s({},i.showlegend,{dflt:false})},n("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scattermapbox/attributes":1252}],1036:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib").isArrayOrTypedArray;var i=e("../../constants/numerical").BADNUM;var o=e("../../components/colorscale/calc");var s=e("../../lib")._;t.exports=function e(t,r){var l=r._length;var u=new Array(l);var c=r.z;var f=a(c)&&c.length;for(var h=0;h<l;h++){var p=u[h]={};var d=r.lon[h];var v=r.lat[h];p.lonlat=n(d)&&n(v)?[+d,+v]:[i,i];if(f){var m=c[h];p.z=n(m)?m:i}}o(t,r,{vals:f?c:[0,1],containerStr:"",cLetter:"z"});if(l){u[0].t={labels:{lat:s(t,"lat:")+" ",lon:s(t,"lon:")+" "}}}return u}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],1037:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../components/color");var o=e("../../components/colorscale");var s=e("../../constants/numerical").BADNUM;var l=e("../../lib/geojson_utils").makeBlank;t.exports=function e(t){var r=t[0].trace;var u=r.visible===true&&r._length!==0;var c={layout:{visibility:"none"},paint:{}};var f=r._opts={heatmap:c,geojson:l()};if(!u)return f;var h=[];var p;var d=r.z;var v=r.radius;var m=a.isArrayOrTypedArray(d)&&d.length;var g=a.isArrayOrTypedArray(v);for(p=0;p<t.length;p++){var y=t[p];var x=y.lonlat;if(x[0]!==s){var _={};if(m){var b=y.z;_.z=b!==s?b:0}if(g){_.r=n(v[p])&&v[p]>0?+v[p]:0}h.push({type:"Feature",geometry:{type:"Point",coordinates:x},properties:_})}}var w=o.extractOpts(r);var T=w.reversescale?o.flipScale(w.colorscale):w.colorscale;var k=T[0][1];var A=i.opacity(k)<1?k:i.addOpacity(k,0);var M=["interpolate",["linear"],["heatmap-density"],0,A];for(p=1;p<T.length;p++){M.push(T[p][0],T[p][1])}var E=["interpolate",["linear"],["get","z"],w.min,0,w.max,1];a.extendFlat(f.heatmap.paint,{"heatmap-weight":m?E:1/(w.max-w.min),"heatmap-color":M,"heatmap-radius":g?{type:"identity",property:"r"}:r.radius,"heatmap-opacity":r.opacity});f.geojson={type:"FeatureCollection",features:h};f.heatmap.layout.visibility="visible";return f}},{"../../components/color":643,"../../components/colorscale":655,"../../constants/numerical":753,"../../lib":778,"../../lib/geojson_utils":772,"fast-isnumeric":241}],1038:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}var u=l("lon")||[];var c=l("lat")||[];var f=Math.min(u.length,c.length);if(!f){r.visible=false;return}r._length=f;l("z");l("radius");l("below");l("text");l("hovertext");l("hovertemplate");a(t,r,s,l,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1035}],1039:[function(e,t,r){"use strict";t.exports=function e(t,r){t.lon=r.lon;t.lat=r.lat;t.z=r.z;return t}},{}],1040:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../scattermapbox/hover");t.exports=function e(t,r,n){var s=i(t,r,n);if(!s)return;var l=s[0];var u=l.cd;var c=u[0].trace;var f=u[l.index];delete l.color;if("z"in f){var h=l.subplot.mockAxis;l.z=f.z;l.zLabel=a.tickText(h,h.c2l(f.z),"hover").text}l.extraText=o(c,f,u[0].t.labels);return[l]};function o(e,t,r){if(e.hovertemplate)return;var a=t.hi||e.hoverinfo;var i=a.split("+");var o=i.indexOf("all")!==-1;var s=i.indexOf("lon")!==-1;var l=i.indexOf("lat")!==-1;var u=t.lonlat;var c=[];function f(e){return e+"°"}if(o||s&&l){c.push("("+f(u[0])+", "+f(u[1])+")")}else if(s){c.push(r.lon+f(u[0]))}else if(l){c.push(r.lat+f(u[1]))}if(o||i.indexOf("text")!==-1){n.fillText(t,e,c)}return c.join("<br>")}},{"../../lib":778,"../../plots/cartesian/axes":828,"../scattermapbox/hover":1257}],1041:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),formatLabels:e("../scattermapbox/format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),getBelow:function(e,t){var r=t.getMapLayers();for(var n=0;n<r.length;n++){var a=r[n];var i=a.id;if(a.type==="symbol"&&typeof i==="string"&&i.indexOf("plotly-")===-1){return i}}},moduleType:"trace",name:"densitymapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":885,"../heatmap/colorbar":1068,"../scattermapbox/format_labels":1256,"./attributes":1035,"./calc":1036,"./defaults":1038,"./event_data":1039,"./hover":1040,"./plot":1042}],1042:[function(e,t,r){"use strict";var n=e("./convert");var a=e("../../plots/mapbox/constants").traceLayerPrefix;function i(e,t){this.type="densitymapbox";this.subplot=e;this.uid=t;this.sourceId="source-"+t;this.layerList=[["heatmap",a+t+"-heatmap"]];this.below=null}var o=i.prototype;o.update=function(e){var t=this.subplot;var r=this.layerList;var a=n(e);var i=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(a.geojson);if(i!==this.below){this._removeLayers();this._addLayers(a,i);this.below=i}for(var o=0;o<r.length;o++){var s=r[o];var l=s[0];var u=s[1];var c=a[l];t.setOptions(u,"setLayoutProperty",c.layout);if(c.layout.visibility==="visible"){t.setOptions(u,"setPaintProperty",c.paint)}}};o._addLayers=function(e,t){var r=this.subplot;var n=this.layerList;var a=this.sourceId;for(var i=0;i<n.length;i++){var o=n[i];var s=o[0];var l=e[s];r.addLayer({type:s,id:o[1],source:a,layout:l.layout,paint:l.paint},t)}};o._removeLayers=function(){var e=this.subplot.map;var t=this.layerList;for(var r=t.length-1;r>=0;r--){e.removeLayer(t[r][1])}};o.dispose=function(){var e=this.subplot.map;this._removeLayers();e.removeSource(this.sourceId)};t.exports=function e(t,r){var a=r[0].trace;var o=new i(t,a.uid);var s=o.sourceId;var l=n(r);var u=o.below=t.belowLookup["trace-"+a.uid];t.map.addSource(s,{type:"geojson",data:l.geojson});o._addLayers(l,u);return o}},{"../../plots/mapbox/constants":883,"./convert":1037}],1043:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){for(var a=0;a<t.length;a++)t[a].i=a;n.mergeArray(r.text,t,"tx");n.mergeArray(r.hovertext,t,"htx");var i=r.marker;if(i){n.mergeArray(i.opacity,t,"mo");n.mergeArray(i.color,t,"mc");var o=i.line;if(o){n.mergeArray(o.color,t,"mlc");n.mergeArrayCastPositive(o.width,t,"mlw")}}}},{"../../lib":778}],1044:[function(e,t,r){"use strict";var n=e("../bar/attributes");var a=e("../scatter/attributes").line;var i=e("../../plots/attributes");var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../plots/template_attributes").texttemplateAttrs;var l=e("./constants");var u=e("../../lib/extend").extendFlat;var c=e("../../components/color");t.exports={x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,hovertext:n.hovertext,hovertemplate:o({},{keys:l.eventDataKeys}),hoverinfo:u({},i.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:false},texttemplate:s({editType:"plot"},{keys:l.eventDataKeys.concat(["label","value"])}),text:n.text,textposition:u({},n.textposition,{dflt:"auto"}),insidetextanchor:u({},n.insidetextanchor,{dflt:"middle"}),textangle:u({},n.textangle,{dflt:0}),textfont:n.textfont,insidetextfont:n.insidetextfont,outsidetextfont:n.outsidetextfont,constraintext:n.constraintext,cliponaxis:n.cliponaxis,orientation:u({},n.orientation,{}),offset:u({},n.offset,{arrayOk:false}),width:u({},n.width,{arrayOk:false}),marker:n.marker,connector:{fillcolor:{valType:"color",editType:"style"},line:{color:u({},a.color,{dflt:c.defaultLine}),width:u({},a.width,{dflt:0,editType:"plot"}),dash:a.dash,editType:"style"},visible:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},offsetgroup:n.offsetgroup,alignmentgroup:n.alignmentgroup}},{"../../components/color":643,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187,"./constants":1046}],1045:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../plots/cartesian/align_period");var i=e("./arrays_to_calcdata");var o=e("../scatter/calc_selection");var s=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var u=n.getFromId(t,r.xaxis||"x");var c=n.getFromId(t,r.yaxis||"y");var f,h,p,d,v;var m;if(r.orientation==="h"){f=u.makeCalcdata(r,"x");p=c.makeCalcdata(r,"y");h=a(r,c,"y",p);m=!!r.yperiodalignment}else{f=c.makeCalcdata(r,"y");p=u.makeCalcdata(r,"x");h=a(r,u,"x",p);m=!!r.xperiodalignment}var g=Math.min(h.length,f.length);var y=new Array(g);r._base=[];for(d=0;d<g;d++){if(f[d]<0)f[d]=s;var x=false;if(f[d]!==s){if(d+1<g&&f[d+1]!==s){x=true}}v=y[d]={p:h[d],s:f[d],cNext:x};r._base[d]=-.5*v.s;if(m){y[d].orig_p=p[d]}if(r.ids){v.id=String(r.ids[d])}if(d===0)y[0].vTotal=0;y[0].vTotal+=l(v.s);v.begR=l(v.s)/l(y[0].s)}var _;for(d=0;d<g;d++){v=y[d];if(v.s===s)continue;v.sumR=v.s/y[0].vTotal;v.difR=_!==undefined?v.s/_:1;_=v.s}i(y,r);o(y,r);return y};function l(e){return e===s?0:e}},{"../../constants/numerical":753,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189,"./arrays_to_calcdata":1043}],1046:[function(e,t,r){"use strict";t.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1047:[function(e,t,r){"use strict";var n=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function e(t,r){var a=t._fullLayout;var i=t._fullData;var o=t.calcdata;var s=r.xaxis;var l=r.yaxis;var u=[];var c=[];var f=[];var h,p;for(p=0;p<i.length;p++){var d=i[p];var v=d.orientation==="h";if(d.visible===true&&d.xaxis===s._id&&d.yaxis===l._id&&d.type==="funnel"){h=o[p];if(v){f.push(h)}else{c.push(h)}u.push(h)}}var m={mode:a.funnelmode,norm:a.funnelnorm,gap:a.funnelgap,groupgap:a.funnelgroupgap};n(t,s,l,c,m);n(t,l,s,f,m);for(p=0;p<u.length;p++){h=u[p];for(var g=0;g<h.length;g++){if(g+1<h.length){h[g].nextP0=h[g+1].p0;h[g].nextS0=h[g+1].s0;h[g].nextP1=h[g+1].p1;h[g].nextS1=h[g+1].s1}}}}},{"../bar/cross_trace_calc":924}],1048:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../bar/defaults").handleGroupingDefaults;var i=e("../bar/defaults").handleText;var o=e("../scatter/xy_defaults");var s=e("../scatter/period_defaults");var l=e("./attributes");var u=e("../../components/color");function c(e,t,r,a){function c(r,a){return n.coerce(e,t,l,r,a)}var h=o(e,t,a,c);if(!h){t.visible=false;return}s(e,t,a,c);c("orientation",t.y&&!t.x?"v":"h");c("offset");c("width");var p=c("text");c("hovertext");c("hovertemplate");var d=c("textposition");i(e,t,a,c,d,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:true,moduleHasCliponaxis:true,moduleHasTextangle:true,moduleHasInsideanchor:true});if(t.textposition!=="none"&&!t.texttemplate){c("textinfo",Array.isArray(p)?"text+value":"value")}var v=c("marker.color",r);c("marker.line.color",u.defaultLine);c("marker.line.width");var m=c("connector.visible");if(m){c("connector.fillcolor",f(v));var g=c("connector.line.width");if(g){c("connector.line.color");c("connector.line.dash")}}}function f(e){var t=n.isArrayOrTypedArray(e)?"#000":e;return u.addOpacity(t,.5*u.opacity(t))}function h(e,t){var r,i;function o(e){return n.coerce(i._input,i,l,e)}if(t.funnelmode==="group"){for(var s=0;s<e.length;s++){i=e[s];r=i._input;a(r,i,t,o)}}}t.exports={supplyDefaults:c,crossTraceDefaults:h}},{"../../components/color":643,"../../lib":778,"../bar/defaults":925,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":1044}],1049:[function(e,t,r){"use strict";t.exports=function e(t,r){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if("percentInitial"in r)t.percentInitial=r.percentInitial;if("percentPrevious"in r)t.percentPrevious=r.percentPrevious;if("percentTotal"in r)t.percentTotal=r.percentTotal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;return t}},{}],1050:[function(e,t,r){"use strict";var n=e("../../components/color").opacity;var a=e("../bar/hover").hoverOnBars;var i=e("../../lib").formatPercent;t.exports=function e(t,r,n,s){var l=a(t,r,n,s);if(!l)return;var u=l.cd;var c=u[0].trace;var f=c.orientation==="h";var h=l.index;var p=u[h];var d=f?"x":"y";l[d+"LabelVal"]=p.s;l.percentInitial=p.begR;l.percentInitialLabel=i(p.begR,1);l.percentPrevious=p.difR;l.percentPreviousLabel=i(p.difR,1);l.percentTotal=p.sumR;l.percentTotalLabel=i(p.sumR,1);var v=p.hi||c.hoverinfo;var m=[];if(v&&v!=="none"&&v!=="skip"){var g=v==="all";var y=v.split("+");var x=function(e){return g||y.indexOf(e)!==-1};if(x("percent initial")){m.push(l.percentInitialLabel+" of initial")}if(x("percent previous")){m.push(l.percentPreviousLabel+" of previous")}if(x("percent total")){m.push(l.percentTotalLabel+" of total")}}l.extraText=m.join("<br>");l.color=o(c,p);return[l]};function o(e,t){var r=e.marker;var a=t.mc||r.color;var i=t.mlc||r.line.color;var o=t.mlw||r.line.width;if(n(a))return a;else if(n(i)&&o)return i}},{"../../components/color":643,"../../lib":778,"../bar/hover":928}],1051:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../bar/select":933,"./attributes":1044,"./calc":1045,"./cross_trace_calc":1047,"./defaults":1048,"./event_data":1049,"./hover":1050,"./layout_attributes":1052,"./layout_defaults":1053,"./plot":1054,"./style":1055}],1052:[function(e,t,r){"use strict";t.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1053:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function(e,t,r){var i=false;function o(r,i){return n.coerce(e,t,a,r,i)}for(var s=0;s<r.length;s++){var l=r[s];if(l.visible&&l.type==="funnel"){i=true;break}}if(i){o("funnelmode");o("funnelgap",.2);o("funnelgroupgap")}}},{"../../lib":778,"./layout_attributes":1052}],1054:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=e("../../constants/numerical").BADNUM;var s=e("../bar/plot");var l=e("../bar/uniform_text").clearMinTextSize;t.exports=function e(t,r,n,a){var i=t._fullLayout;l("funnel",i);u(t,r,n,a);c(t,r,n,a);s.plot(t,r,n,a,{mode:i.funnelmode,norm:i.funnelmode,gap:i.funnelgap,groupgap:i.funnelgroupgap})};function u(e,t,r,s){var l=t.xaxis;var u=t.yaxis;a.makeTraceGroups(s,r,"trace bars").each(function(r){var s=n.select(this);var c=r[0].trace;var h=a.ensureSingle(s,"g","regions");if(!c.connector||!c.connector.visible){h.remove();return}var p=c.orientation==="h";var d=h.selectAll("g.region").data(a.identity);d.enter().append("g").classed("region",true);d.exit().remove();var v=d.size();d.each(function(r,s){if(s!==v-1&&!r.cNext)return;var c=f(r,l,u,p);var h=c[0];var d=c[1];var m="";if(h[0]!==o&&d[0]!==o&&h[1]!==o&&d[1]!==o&&h[2]!==o&&d[2]!==o&&h[3]!==o&&d[3]!==o){if(p){m+="M"+h[0]+","+d[1]+"L"+h[2]+","+d[2]+"H"+h[3]+"L"+h[1]+","+d[1]+"Z"}else{m+="M"+h[1]+","+d[1]+"L"+h[2]+","+d[3]+"V"+d[2]+"L"+h[1]+","+d[0]+"Z"}}if(m==="")m="M0,0Z";a.ensureSingle(n.select(this),"path").attr("d",m).call(i.setClipUrl,t.layerClipId,e)})})}function c(e,t,r,o){var s=t.xaxis;var l=t.yaxis;a.makeTraceGroups(o,r,"trace bars").each(function(r){var o=n.select(this);var u=r[0].trace;var c=a.ensureSingle(o,"g","lines");if(!u.connector||!u.connector.visible||!u.connector.line.width){c.remove();return}var h=u.orientation==="h";var p=c.selectAll("g.line").data(a.identity);p.enter().append("g").classed("line",true);p.exit().remove();var d=p.size();p.each(function(r,o){if(o!==d-1&&!r.cNext)return;var u=f(r,s,l,h);var c=u[0];var p=u[1];var v="";if(c[3]!==undefined&&p[3]!==undefined){if(h){v+="M"+c[0]+","+p[1]+"L"+c[2]+","+p[2];v+="M"+c[1]+","+p[1]+"L"+c[3]+","+p[2]}else{v+="M"+c[1]+","+p[1]+"L"+c[2]+","+p[3];v+="M"+c[1]+","+p[0]+"L"+c[2]+","+p[2]}}if(v==="")v="M0,0Z";a.ensureSingle(n.select(this),"path").attr("d",v).call(i.setClipUrl,t.layerClipId,e)})})}function f(e,t,r,n){var a=[];var i=[];var o=n?t:r;var s=n?r:t;a[0]=o.c2p(e.s0,true);i[0]=s.c2p(e.p0,true);a[1]=o.c2p(e.s1,true);i[1]=s.c2p(e.p1,true);a[2]=o.c2p(e.nextS0,true);i[2]=s.c2p(e.nextP0,true);a[3]=o.c2p(e.nextS1,true);i[3]=s.c2p(e.nextP1,true);return n?[a,i]:[i,a]}},{"../../components/drawing":665,"../../constants/numerical":753,"../../lib":778,"../bar/plot":932,"../bar/uniform_text":937,d3:169}],1055:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../../components/color");var o=e("../../constants/interactions").DESELECTDIM;var s=e("../bar/style");var l=e("../bar/uniform_text").resizeText;var u=s.styleTextPoints;function c(e,t,r){var s=r?r:n.select(e).selectAll("g.funnellayer").selectAll("g.trace");l(e,s,"funnel");s.style("opacity",function(e){return e[0].trace.opacity});s.each(function(t){var r=n.select(this);var s=t[0].trace;r.selectAll(".point > path").each(function(e){if(!e.isBlank){var t=s.marker;n.select(this).call(i.fill,e.mc||t.color).call(i.stroke,e.mlc||t.line.color).call(a.dashLine,t.line.dash,e.mlw||t.line.width).style("opacity",s.selectedpoints&&!e.selected?o:1)}});u(r,s,e);r.selectAll(".regions").each(function(){n.select(this).selectAll("path").style("stroke-width",0).call(i.fill,s.connector.fillcolor)});r.selectAll(".lines").each(function(){var e=s.connector.line;a.lineGroupStyle(n.select(this).selectAll("path"),e.width,e.color,e.dash)})})}t.exports={style:c}},{"../../components/color":643,"../../components/drawing":665,"../../constants/interactions":752,"../bar/style":935,"../bar/uniform_text":937,d3:169}],1056:[function(e,t,r){"use strict";var n=e("../pie/attributes");var a=e("../../plots/attributes");var i=e("../../plots/domain").attributes;var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../plots/template_attributes").texttemplateAttrs;var l=e("../../lib/extend").extendFlat;t.exports={labels:n.labels,label0:n.label0,dlabel:n.dlabel,values:n.values,marker:{colors:n.marker.colors,line:{color:l({},n.marker.line.color,{dflt:null}),width:l({},n.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:n.text,hovertext:n.hovertext,scalegroup:l({},n.scalegroup,{}),textinfo:l({},n.textinfo,{flags:["label","text","value","percent"]}),texttemplate:s({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:l({},a.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:o({},{keys:["label","color","value","text","percent"]}),textposition:l({},n.textposition,{values:["inside","none"],dflt:"inside"}),textfont:n.textfont,insidetextfont:n.insidetextfont,title:{text:n.title.text,font:n.title.font,position:l({},n.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:i({name:"funnelarea",trace:true,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161}],1057:[function(e,t,r){"use strict";var n=e("../../plots/plots");r.name="funnelarea";r.plot=function(e,t,a,i){n.plotBasePlot(r.name,e,t,a,i)};r.clean=function(e,t,a,i){n.cleanBasePlot(r.name,e,t,a,i)}},{"../../plots/plots":891}],1058:[function(e,t,r){"use strict";var n=e("../pie/calc");function a(e,t){return n.calc(e,t)}function i(e){n.crossTraceCalc(e,{type:"funnelarea"})}t.exports={calc:a,crossTraceCalc:i}},{"../pie/calc":1163}],1059:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../../plots/domain").defaults;var o=e("../bar/defaults").handleText;var s=e("../pie/defaults").handleLabelsAndValues;t.exports=function e(t,r,l,u){function c(e,i){return n.coerce(t,r,a,e,i)}var f=c("labels");var h=c("values");var p=s(f,h);var d=p.len;r._hasLabels=p.hasLabels;r._hasValues=p.hasValues;if(!r._hasLabels&&r._hasValues){c("label0");c("dlabel")}if(!d){r.visible=false;return}r._length=d;var v=c("marker.line.width");if(v)c("marker.line.color",u.paper_bgcolor);c("marker.colors");c("scalegroup");var m=c("text");var g=c("texttemplate");var y;if(!g)y=c("textinfo",Array.isArray(m)?"text+percent":"percent");c("hovertext");c("hovertemplate");if(g||y&&y!=="none"){var x=c("textposition");o(t,r,u,c,x,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false})}i(r,u,c);var _=c("title.text");if(_){c("title.position");n.coerceFont(c,"title.font",u.font)}c("aspectratio");c("baseratio")}},{"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"../pie/defaults":1164,"./attributes":1056}],1060:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"funnelarea",basePlotModule:e("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style"),styleOne:e("../pie/style_one"),meta:{}}},{"../pie/style_one":1172,"./attributes":1056,"./base_plot":1057,"./calc":1058,"./defaults":1059,"./layout_attributes":1061,"./layout_defaults":1062,"./plot":1063,"./style":1064}],1061:[function(e,t,r){"use strict";var n=e("../pie/layout_attributes").hiddenlabels;t.exports={hiddenlabels:n,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:true,editType:"calc"}}},{"../pie/layout_attributes":1168}],1062:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return n.coerce(t,r,a,e,i)}i("hiddenlabels");i("funnelareacolorway",r.colorway);i("extendfunnelareacolors")}},{"../../lib":778,"./layout_attributes":1061}],1063:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../../lib");var o=i.strScale;var s=i.strTranslate;var l=e("../../lib/svg_text_utils");var u=e("../bar/plot");var c=u.toMoveInsideBar;var f=e("../bar/uniform_text");var h=f.recordMinTextSize;var p=f.clearMinTextSize;var d=e("../pie/helpers");var v=e("../pie/plot");var m=v.attachFxHandlers;var g=v.determineInsideTextFont;var y=v.layoutAreas;var x=v.prerenderTitles;var _=v.positionTitleOutside;var b=v.formatSliceLabel;t.exports=function e(t,r){var u=t._fullLayout;p("funnelarea",u);x(r,t);y(r,u._size);i.makeTraceGroups(u._funnelarealayer,r,"trace").each(function(e){var r=n.select(this);var f=e[0];var p=f.trace;k(e);r.each(function(){var r=n.select(this).selectAll("g.slice").data(e);r.enter().append("g").classed("slice",true);r.exit().remove();r.each(function(r,o){if(r.hidden){n.select(this).selectAll("path,g").remove();return}r.pointNumber=r.i;r.curveNumber=p.index;var s=f.cx;var v=f.cy;var y=n.select(this);var x=y.selectAll("path.surface").data([r]);x.enter().append("path").classed("surface",true).style({"pointer-events":"all"});y.call(m,t,e);var _="M"+(s+r.TR[0])+","+(v+r.TR[1])+w(r.TR,r.BR)+w(r.BR,r.BL)+w(r.BL,r.TL)+"Z";x.attr("d",_);b(t,r,f);var T=d.castOption(p.textposition,r.pts);var k=y.selectAll("g.slicetext").data(r.text&&T!=="none"?[0]:[]);k.enter().append("g").classed("slicetext",true);k.exit().remove();k.each(function(){var f=i.ensureSingle(n.select(this),"text","",function(e){e.attr("data-notex",1)});var d=i.ensureUniformFontSize(t,g(p,r,u.font));f.text(r.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(a.font,d).call(l.convertToTspans,t);var m=a.bBox(f.node());var y;var x,_;var b=Math.min(r.BL[1],r.BR[1])+v;var w=Math.max(r.TL[1],r.TR[1])+v;x=Math.max(r.TL[0],r.BL[0])+s;_=Math.min(r.TR[0],r.BR[0])+s;y=c(x,_,b,w,m,{isHorizontal:true,constrained:true,angle:0,anchor:"middle"});y.fontSize=d.size;h(p.type,y,u);e[o].transform=y;f.attr("transform",i.getTextTransform(y))})});var v=n.select(this).selectAll("g.titletext").data(p.title.text?[0]:[]);v.enter().append("g").classed("titletext",true);v.exit().remove();v.each(function(){var e=i.ensureSingle(n.select(this),"text","",function(e){e.attr("data-notex",1)});var r=p.title.text;if(p._meta){r=i.templateString(r,p._meta)}e.text(r).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(a.font,p.title.font).call(l.convertToTspans,t);var c=_(f,u._size);e.attr("transform",s(c.x,c.y)+o(Math.min(1,c.scale))+s(c.tx,c.ty))})})})};function w(e,t){var r=t[0]-e[0];var n=t[1]-e[1];return"l"+r+","+n}function T(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}function k(e){if(!e.length)return;var t=e[0];var r=t.trace;var n=r.aspectratio;var a=r.baseratio;if(a>.999)a=.999;var i=Math.pow(a,2);var o=t.vTotal;var s=o*i/(1-i);var l=o;var u=s/o;function c(){var e=Math.sqrt(u);return{x:e,y:-e}}function f(){var e=c();return[e.x,e.y]}var h;var p=[];p.push(f());var d,v;for(d=e.length-1;d>-1;d--){v=e[d];if(v.hidden)continue;var m=v.v/l;u+=m;p.push(f())}var g=Infinity;var y=-Infinity;for(d=0;d<p.length;d++){h=p[d];g=Math.min(g,h[1]);y=Math.max(y,h[1])}for(d=0;d<p.length;d++){p[d][1]-=(y+g)/2}var x=p[p.length-1][0];var _=t.r;var b=(y-g)/2;var w=_/x;var k=_/b*n;t.r=k*b;for(d=0;d<p.length;d++){p[d][0]*=w;p[d][1]*=k}h=p[0];var A=[-h[0],h[1]];var M=[h[0],h[1]];var E=0;for(d=e.length-1;d>-1;d--){v=e[d];if(v.hidden)continue;E+=1;var S=p[E][0];var C=p[E][1];v.TL=[-S,C];v.TR=[S,C];v.BL=A;v.BR=M;v.pxmid=T(v.TR,v.BR);A=v.TL;M=v.TR}}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../bar/plot":932,"../bar/uniform_text":937,"../pie/helpers":1166,"../pie/plot":1170,d3:169}],1064:[function(e,t,r){"use strict";var n=e("d3");var a=e("../pie/style_one");var i=e("../bar/uniform_text").resizeText;t.exports=function e(t){var r=t._fullLayout._funnelarealayer.selectAll(".trace");i(t,r,"funnelarea");r.each(function(e){var t=e[0];var r=t.trace;var i=n.select(this);i.style({opacity:r.opacity});i.selectAll("path.surface").each(function(e){n.select(this).call(a,e,r)})})}},{"../bar/uniform_text":937,"../pie/style_one":1172,d3:169}],1065:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var a=e("../../plots/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../components/colorscale/attributes");var s=e("../../constants/docs").FORMAT_LINK;var l=e("../../lib/extend").extendFlat;t.exports=l({z:{valType:"data_array",editType:"calc"},x:l({},n.x,{impliedEdits:{xtype:"array"}}),x0:l({},n.x0,{impliedEdits:{xtype:"scaled"}}),dx:l({},n.dx,{impliedEdits:{xtype:"scaled"}}),y:l({},n.y,{impliedEdits:{ytype:"array"}}),y0:l({},n.y0,{impliedEdits:{ytype:"scaled"}}),dy:l({},n.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:l({},n.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:l({},n.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:l({},n.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:l({},n.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:l({},n.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:l({},n.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:false,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",false],dflt:false,editType:"calc"},hoverongaps:{valType:"boolean",dflt:true,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},hovertemplate:i(),showlegend:l({},a.showlegend,{dflt:false})},{transforms:undefined},o("",{cLetter:"z",autoColorDflt:false}))},{"../../components/colorscale/attributes":650,"../../constants/docs":748,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1066:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/align_period");var s=e("../histogram2d/calc");var l=e("../../components/colorscale/calc");var u=e("./convert_column_xyz");var c=e("./clean_2d_array");var f=e("./interp2d");var h=e("./find_empties");var p=e("./make_bound_array");var d=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var d=i.getFromId(t,r.xaxis||"x");var g=i.getFromId(t,r.yaxis||"y");var y=n.traceIs(r,"contour");var x=n.traceIs(r,"histogram");var _=n.traceIs(r,"gl2d");var b=y?"best":r.zsmooth;var w,T,k,A;var M,E,S,C;var L,I,O;d._minDtick=0;g._minDtick=0;if(x){O=s(t,r);A=O.orig_x;w=O.x;T=O.x0;k=O.dx;C=O.orig_y;M=O.y;E=O.y0;S=O.dy;L=O.z}else{var P=r.z;if(a.isArray1D(P)){u(r,d,g,"x","y",["z"]);w=r._x;M=r._y;P=r._z}else{A=r.x?d.makeCalcdata(r,"x"):[];C=r.y?g.makeCalcdata(r,"y"):[];w=o(r,d,"x",A);M=o(r,g,"y",C);r._x=w;r._y=M}T=r.x0;k=r.dx;E=r.y0;S=r.dy;L=c(P,r,d,g)}if(d.rangebreaks||g.rangebreaks){L=m(w,M,L);if(!x){w=v(w);M=v(M);r._x=w;r._y=M}}if(!x&&(y||r.connectgaps)){r._emptypoints=h(L);f(L,r._emptypoints)}function D(e){b=r._input.zsmooth=r.zsmooth=false;a.warn('cannot use zsmooth: "fast": '+e)}if(b==="fast"){if(d.type==="log"||g.type==="log"){D("log axis found")}else if(!x){if(w.length){var R=(w[w.length-1]-w[0])/(w.length-1);var z=Math.abs(R/100);for(I=0;I<w.length-1;I++){if(Math.abs(w[I+1]-w[I]-R)>z){D("x scale is not linear");break}}}if(M.length&&b==="fast"){var N=(M[M.length-1]-M[0])/(M.length-1);var F=Math.abs(N/100);for(I=0;I<M.length-1;I++){if(Math.abs(M[I+1]-M[I]-N)>F){D("y scale is not linear");break}}}}}var B=a.maxRowLength(L);var j=r.xtype==="scaled"?"":w;var U=p(r,j,T,k,B,d);var H=r.ytype==="scaled"?"":M;var V=p(r,H,E,S,L.length,g);if(!_){r._extremes[d._id]=i.findExtremes(d,U);r._extremes[g._id]=i.findExtremes(g,V)}var G={x:U,y:V,z:L,text:r._text||r.text,hovertext:r._hovertext||r.hovertext};if(r.xperiodalignment&&A){G.orig_x=A}if(r.yperiodalignment&&C){G.orig_y=C}if(j&&j.length===U.length-1)G.xCenter=j;if(H&&H.length===V.length-1)G.yCenter=H;if(x){G.xRanges=O.xRanges;G.yRanges=O.yRanges;G.pts=O.pts}if(!y){l(t,r,{vals:L,cLetter:"z"})}if(y&&r.contours&&r.contours.coloring==="heatmap"){var q={type:r.type==="contour"?"heatmap":"histogram2d",xcalendar:r.xcalendar,ycalendar:r.ycalendar};G.xfill=p(q,j,T,k,B,d);G.yfill=p(q,H,E,S,L.length,g)}return[G]};function v(e){var t=[];var r=e.length;for(var n=0;n<r;n++){var a=e[n];if(a!==d)t.push(a)}return t}function m(e,t,r){var n=[];var a=-1;for(var i=0;i<r.length;i++){if(t[i]===d)continue;a++;n[a]=[];for(var o=0;o<r[i].length;o++){if(e[o]===d)continue;n[a].push(r[i][o])}}return n}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../../registry":911,"../histogram2d/calc":1098,"./clean_2d_array":1067,"./convert_column_xyz":1069,"./find_empties":1071,"./interp2d":1074,"./make_bound_array":1075}],1067:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../constants/numerical").BADNUM;t.exports=function e(t,r,o,s){var l,u,c,f,h,p;function d(e){if(!n(e))return undefined;return+e}if(r&&r.transpose){l=0;for(h=0;h<t.length;h++)l=Math.max(l,t[h].length);if(l===0)return false;c=function(e){return e.length};f=function(e,t,r){return(e[r]||[])[t]}}else{l=t.length;c=function(e,t){return e[t].length};f=function(e,t,r){return(e[t]||[])[r]}}var v=function(e,t,r){if(t===i||r===i)return i;return f(e,t,r)};function m(e){if(r&&r.type!=="carpet"&&r.type!=="contourcarpet"&&e&&e.type==="category"&&r["_"+e._id.charAt(0)].length){var t=e._id.charAt(0);var n={};var o=r["_"+t+"CategoryMap"]||r[t];for(h=0;h<o.length;h++){n[o[h]]=h}return function(t){var r=n[e._categories[t]];return r+1?r:i}}else{return a.identity}}var g=m(o);var y=m(s);if(s&&s.type==="category")l=s._categories.length;var x=new Array(l);for(h=0;h<l;h++){if(o&&o.type==="category"){u=o._categories.length}else{u=c(t,h)}x[h]=new Array(u);for(p=0;p<u;p++)x[h][p]=d(v(t,y(h),g(p)))}return x}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],1068:[function(e,t,r){"use strict";t.exports={min:"zmin",max:"zmax"}},{}],1069:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../constants/numerical").BADNUM;var i=e("../../plots/cartesian/align_period");t.exports=function e(t,r,o,s,l,u){var c=t._length;var f=r.makeCalcdata(t,s);var h=o.makeCalcdata(t,l);f=i(t,r,s,f);h=i(t,o,l,h);var p=t.text;var d=p!==undefined&&n.isArray1D(p);var v=t.hovertext;var m=v!==undefined&&n.isArray1D(v);var g,y;var x=n.distinctVals(f);var _=x.vals;var b=n.distinctVals(h);var w=b.vals;var T=[];var k;var A;var M=w.length;var E=_.length;for(g=0;g<u.length;g++){T[g]=n.init2dArray(M,E)}if(d){k=n.init2dArray(M,E)}if(m){A=n.init2dArray(M,E)}var S=n.init2dArray(M,E);for(g=0;g<c;g++){if(f[g]!==a&&h[g]!==a){var C=n.findBin(f[g]+x.minDiff/2,_);var L=n.findBin(h[g]+b.minDiff/2,w);for(y=0;y<u.length;y++){var I=u[y];var O=t[I];var P=T[y];P[L][C]=O[g];S[L][C]=g}if(d)k[L][C]=p[g];if(m)A[L][C]=v[g]}}t["_"+s]=_;t["_"+l]=w;for(y=0;y<u.length;y++){t["_"+u[y]]=T[y]}if(d)t._text=k;if(m)t._hovertext=A;if(r&&r.type==="category"){t["_"+s+"CategoryMap"]=_.map(function(e){return r._categories[e]})}if(o&&o.type==="category"){t["_"+l+"CategoryMap"]=w.map(function(e){return o._categories[e]})}t._after2before=S}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825}],1070:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./xyz_defaults");var i=e("../scatter/period_defaults");var o=e("./style_defaults");var s=e("../../components/colorscale/defaults");var l=e("./attributes");t.exports=function e(t,r,u,c){function f(e,a){return n.coerce(t,r,l,e,a)}var h=a(t,r,f,c);if(!h){r.visible=false;return}i(t,r,c,f);f("text");f("hovertext");f("hovertemplate");o(t,r,f,c);f("hoverongaps");f("connectgaps",n.isArray1D(r.z)&&r.zsmooth!==false);s(t,r,c,f,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":653,"../../lib":778,"../scatter/period_defaults":1207,"./attributes":1065,"./style_defaults":1078,"./xyz_defaults":1079}],1071:[function(e,t,r){"use strict";var n=e("../../lib").maxRowLength;t.exports=function e(t){var r=[];var a={};var i=[];var o=t[0];var s=[];var l=[0,0,0];var u=n(t);var c;var f;var h;var p;var d;var v;var m;var g;for(f=0;f<t.length;f++){c=s;s=o;o=t[f+1]||[];for(h=0;h<u;h++){if(s[h]===undefined){v=(s[h-1]!==undefined?1:0)+(s[h+1]!==undefined?1:0)+(c[h]!==undefined?1:0)+(o[h]!==undefined?1:0);if(v){if(f===0)v++;if(h===0)v++;if(f===t.length-1)v++;if(h===s.length-1)v++;if(v<4){a[[f,h]]=[f,h,v]}r.push([f,h,v])}else i.push([f,h])}}}while(i.length){m={};g=false;for(d=i.length-1;d>=0;d--){p=i[d];f=p[0];h=p[1];v=((a[[f-1,h]]||l)[2]+(a[[f+1,h]]||l)[2]+(a[[f,h-1]]||l)[2]+(a[[f,h+1]]||l)[2])/20;if(v){m[p]=[f,h,v];i.splice(d,1);g=true}}if(!g){throw"findEmpties iterated with no new neighbors"}for(p in m){a[p]=m[p];r.push(m[p])}}return r.sort(function(e,t){return t[2]-e[2]})}},{"../../lib":778}],1072:[function(e,t,r){"use strict";var n=e("../../components/fx");var a=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("../../components/colorscale").extractOpts;t.exports=function e(t,r,s,l,u,c){var f=t.cd[0];var h=f.trace;var p=t.xa;var d=t.ya;var v=f.x;var m=f.y;var g=f.z;var y=f.xCenter;var x=f.yCenter;var _=f.zmask;var b=h.zhoverformat;var w=v;var T=m;var k,A,M,E;if(t.index!==false){try{M=Math.round(t.index[1]);E=Math.round(t.index[0])}catch(e){a.error("Error hovering on heatmap, "+"pointNumber must be [row,col], found:",t.index);return}if(M<0||M>=g[0].length||E<0||E>g.length){return}}else if(n.inbox(r-v[0],r-v[v.length-1],0)>0||n.inbox(s-m[0],s-m[m.length-1],0)>0){return}else{if(c){var S;w=[2*v[0]-v[1]];for(S=1;S<v.length;S++){w.push((v[S]+v[S-1])/2)}w.push([2*v[v.length-1]-v[v.length-2]]);T=[2*m[0]-m[1]];for(S=1;S<m.length;S++){T.push((m[S]+m[S-1])/2)}T.push([2*m[m.length-1]-m[m.length-2]])}M=Math.max(0,Math.min(w.length-2,a.findBin(r,w)));E=Math.max(0,Math.min(T.length-2,a.findBin(s,T)))}var C=p.c2p(v[M]);var L=p.c2p(v[M+1]);var I=d.c2p(m[E]);var O=d.c2p(m[E+1]);var P,D;if(c){P=f.orig_x||v;D=f.orig_y||m;L=C;k=P[M];O=I;A=D[E]}else{P=f.orig_x||y||v;D=f.orig_y||x||m;k=y?P[M]:(P[M]+P[M+1])/2;A=x?D[E]:(D[E]+D[E+1])/2;if(p&&p.type==="category")k=v[M];if(d&&d.type==="category")A=m[E];if(h.zsmooth){C=L=p.c2p(k);I=O=d.c2p(A)}}var R=g[E][M];if(_&&!_[E][M])R=undefined;if(R===undefined&&!h.hoverongaps)return;var z;if(Array.isArray(f.hovertext)&&Array.isArray(f.hovertext[E])){z=f.hovertext[E][M]}else if(Array.isArray(f.text)&&Array.isArray(f.text[E])){z=f.text[E][M]}var N=o(h);var F={type:"linear",range:[N.min,N.max],hoverformat:b,_separators:p._separators,_numFormat:p._numFormat};var B=i.tickText(F,R,"hover").text;return[a.extendFlat(t,{index:h._after2before?h._after2before[E][M]:[E,M],distance:t.maxHoverDistance,spikeDistance:t.maxSpikeDistance,x0:C,x1:L,y0:I,y1:O,xLabelVal:k,yLabelVal:A,zLabelVal:R,zLabel:B,text:z})]}},{"../../components/colorscale":655,"../../components/fx":683,"../../lib":778,"../../plots/cartesian/axes":828}],1073:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:e("./colorbar"),style:e("./style"),hoverPoints:e("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":841,"./attributes":1065,"./calc":1066,"./colorbar":1068,"./defaults":1070,"./hover":1072,"./plot":1076,"./style":1077}],1074:[function(e,t,r){"use strict";var n=e("../../lib");var a=.01;var i=[[-1,0],[1,0],[0,-1],[0,1]];function o(e){return.5-.25*Math.min(1,e*.5)}t.exports=function e(t,r){var i=1;var l;s(t,r);for(l=0;l<r.length;l++){if(r[l][2]<4)break}r=r.slice(l);for(l=0;l<100&&i>a;l++){i=s(t,r,o(i))}if(i>a){n.log("interp2d didn't converge quickly",i)}return t};function s(e,t,r){var n=0;var a;var o;var s;var l;var u;var c;var f;var h;var p;var d;var v;var m;var g;for(l=0;l<t.length;l++){a=t[l];o=a[0];s=a[1];v=e[o][s];d=0;p=0;for(u=0;u<4;u++){c=i[u];f=e[o+c[0]];if(!f)continue;h=f[s+c[1]];if(h!==undefined){if(d===0){m=g=h}else{m=Math.min(m,h);g=Math.max(g,h)}p++;d+=h}}if(p===0){throw"iterateInterp2d order is wrong: no defined neighbors"}e[o][s]=d/p;if(v===undefined){if(p<4)n=1}else{e[o][s]=(1+r)*e[o][s]-r*v;if(g>m){n=Math.max(n,Math.abs(e[o][s]-v)/(g-m))}}}return n}},{"../../lib":778}],1075:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,i,o,s,l){var u=[];var c=n.traceIs(t,"contour");var f=n.traceIs(t,"histogram");var h=n.traceIs(t,"gl2d");var p;var d;var v;var m=a(r)&&r.length>1;if(m&&!f&&l.type!=="category"){var g=r.length;if(g<=s){if(c||h)u=r.slice(0,s);else if(s===1){u=[r[0]-.5,r[0]+.5]}else{u=[1.5*r[0]-.5*r[1]];for(v=1;v<g;v++){u.push((r[v-1]+r[v])*.5)}u.push(1.5*r[g-1]-.5*r[g-2])}if(g<s){var y=u[u.length-1];var x=y-u[u.length-2];for(v=g;v<s;v++){y+=x;u.push(y)}}}else{return c?r.slice(0,s):r.slice(0,s+1)}}else{var _=t[l._id.charAt(0)+"calendar"];if(f){p=l.r2c(i,0,_)}else{if(a(r)&&r.length===1){p=r[0]}else if(i===undefined){p=0}else{var b=l.type==="log"?l.d2c:l.r2c;p=b(i,0,_)}}d=o||1;for(v=c||h?0:-.5;v<s;v++){u.push(p+d*v)}}return u}},{"../../lib":778,"../../registry":911}],1076:[function(e,t,r){"use strict";var n=e("d3");var a=e("tinycolor2");var i=e("../../registry");var o=e("../../lib");var s=e("../../components/colorscale").makeColorScaleFuncFromTrace;var l=e("../../constants/xmlns_namespaces");t.exports=function(e,t,r,h){var p=t.xaxis;var d=t.yaxis;o.makeTraceGroups(h,r,"hm").each(function(t){var r=n.select(this);var h=t[0];var v=h.trace;var m=h.z;var g=h.x;var y=h.y;var x=h.xCenter;var _=h.yCenter;var b=i.traceIs(v,"contour");var w=b?"best":v.zsmooth;var T=m.length;var k=o.maxRowLength(m);var A=false;var M=false;var E,S,C,L,I,O;O=0;while(E===undefined&&O<g.length-1){E=p.c2p(g[O]);O++}O=g.length-1;while(S===undefined&&O>0){S=p.c2p(g[O]);O--}if(S<E){C=S;S=E;E=C;A=true}O=0;while(L===undefined&&O<y.length-1){L=d.c2p(y[O]);O++}O=y.length-1;while(I===undefined&&O>0){I=d.c2p(y[O]);O--}if(I<L){C=L;L=I;I=C;M=true}if(b){x=g;_=y;g=h.xfill;y=h.yfill}if(w!=="fast"){var P=w==="best"?0:.5;E=Math.max(-P*p._length,E);S=Math.min((1+P)*p._length,S);L=Math.max(-P*d._length,L);I=Math.min((1+P)*d._length,I)}var D=Math.round(S-E);var R=Math.round(I-L);var z=D<=0||R<=0;if(z){var N=r.selectAll("image").data([]);N.exit().remove();return}var F,B;if(w==="fast"){F=k;B=T}else{F=D;B=R}var j=document.createElement("canvas");j.width=F;j.height=B;var U=j.getContext("2d");var H=s(v,{noNumericCheck:true,returnArray:true});var V,G;if(w==="fast"){V=A?function(e){return k-1-e}:o.identity;G=M?function(e){return T-1-e}:o.identity}else{V=function(e){return o.constrain(Math.round(p.c2p(g[e])-E),0,D)};G=function(e){return o.constrain(Math.round(d.c2p(y[e])-L),0,R)}}var q=G(0);var Y=[q,q];var W=A?0:1;var X=M?0:1;var Z=0;var K=0;var J=0;var Q=0;var $,ee,te,re,ne,ae;function ie(e,t){if(e!==undefined){var r=H(e);r[0]=Math.round(r[0]);r[1]=Math.round(r[1]);r[2]=Math.round(r[2]);Z+=t;K+=r[0]*t;J+=r[1]*t;Q+=r[2]*t;return r}return[0,0,0,0]}function oe(e,t,r,n){var a=e[r.bin0];if(a===undefined)return ie(undefined,1);var i=e[r.bin1];var o=t[r.bin0];var s=t[r.bin1];var l=i-a||0;var u=o-a||0;var c;if(i===undefined){if(s===undefined)c=0;else if(o===undefined)c=2*(s-a);else c=(2*s-o-a)*2/3}else if(s===undefined){if(o===undefined)c=0;else c=(2*a-i-o)*2/3}else if(o===undefined)c=(2*s-i-a)*2/3;else c=s+a-i-o;return ie(a+r.frac*l+n.frac*(u+r.frac*c))}if(w){var se=0;var le;try{le=new Uint8Array(D*R*4)}catch(e){le=new Array(D*R*4)}if(w==="best"){var ue=x||g;var ce=_||y;var fe=new Array(ue.length);var he=new Array(ce.length);var pe=new Array(D);var de=x?c:u;var ve=_?c:u;var me,ge,ye;for(O=0;O<ue.length;O++)fe[O]=Math.round(p.c2p(ue[O])-E);for(O=0;O<ce.length;O++)he[O]=Math.round(d.c2p(ce[O])-L);for(O=0;O<D;O++)pe[O]=de(O,fe);for(ee=0;ee<R;ee++){me=ve(ee,he);ge=m[me.bin0];ye=m[me.bin1];for(O=0;O<D;O++,se+=4){ae=oe(ge,ye,pe[O],me);f(le,se,ae)}}}else{for(ee=0;ee<T;ee++){ne=m[ee];Y=G(ee);for(O=0;O<D;O++){ae=ie(ne[O],1);se=(Y*D+V(O))*4;f(le,se,ae)}}}var xe=U.createImageData(D,R);try{xe.data.set(le)}catch(e){var _e=xe.data;var be=_e.length;for(ee=0;ee<be;ee++){_e[ee]=le[ee]}}U.putImageData(xe,0,0)}else{var we=v.xgap;var Te=v.ygap;var ke=Math.floor(we/2);var Ae=Math.floor(Te/2);for(ee=0;ee<T;ee++){ne=m[ee];Y.reverse();Y[X]=G(ee+1);if(Y[0]===Y[1]||Y[0]===undefined||Y[1]===undefined){continue}te=V(0);$=[te,te];for(O=0;O<k;O++){$.reverse();$[W]=V(O+1);if($[0]===$[1]||$[0]===undefined||$[1]===undefined){continue}re=ne[O];ae=ie(re,($[1]-$[0])*(Y[1]-Y[0]));U.fillStyle="rgba("+ae.join(",")+")";U.fillRect($[0]+ke,Y[0]+Ae,$[1]-$[0]-we,Y[1]-Y[0]-Te)}}}K=Math.round(K/Z);J=Math.round(J/Z);Q=Math.round(Q/Z);var Me=a("rgb("+K+","+J+","+Q+")");e._hmpixcount=(e._hmpixcount||0)+Z;e._hmlumcount=(e._hmlumcount||0)+Z*Me.getLuminance();var Ee=r.selectAll("image").data(t);Ee.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"});Ee.attr({height:R,width:D,x:E,y:L,"xlink:href":j.toDataURL("image/png")})})};function u(e,t){var r=t.length-2;var n=o.constrain(o.findBin(e,t),0,r);var a=t[n];var i=t[n+1];var s=o.constrain(n+(e-a)/(i-a)-.5,0,r);var l=Math.round(s);var u=Math.abs(s-l);if(!s||s===r||!u){return{bin0:l,bin1:l,frac:0}}return{bin0:l,frac:u,bin1:Math.round(l+u/(s-l))}}function c(e,t){var r=t.length-1;var n=o.constrain(o.findBin(e,t),0,r);var a=t[n];var i=t[n+1];var s=(e-a)/(i-a)||0;if(s<=0){return{bin0:n,bin1:n,frac:0}}if(s<.5){return{bin0:n,bin1:n+1,frac:s}}return{bin0:n+1,bin1:n,frac:1-s}}function f(e,t,r){e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=Math.round(r[3]*255)}},{"../../components/colorscale":655,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../registry":911,d3:169,tinycolor2:576}],1077:[function(e,t,r){"use strict";var n=e("d3");t.exports=function e(t){n.select(t).selectAll(".hm image").style("opacity",function(e){return e.trace.opacity})}},{d3:169}],1078:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var a=n("zsmooth");if(a===false){n("xgap");n("ygap")}n("zhoverformat")}},{}],1079:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../registry");t.exports=function e(t,r,n,l,u,c){var f=n("z");u=u||"x";c=c||"y";var h,p;if(f===undefined||!f.length)return 0;if(a.isArray1D(t.z)){h=n(u);p=n(c);var d=a.minRowLength(h);var v=a.minRowLength(p);if(d===0||v===0)return 0;r._length=Math.min(d,v,f.length)}else{h=o(u,n);p=o(c,n);if(!s(f))return 0;n("transpose");r._length=null}if(t.type==="heatmapgl"||t.type==="contourgl")return true;var m=i.getComponentMethod("calendars","handleTraceDefaults");m(t,r,[u,c],l);return true};function o(e,t){var r=t(e);var n=r?t(e+"type","array"):"scaled";if(n==="scaled"){t(e+"0");t("d"+e)}return r}function s(e){var t=true;var r=false;var i=false;var o;for(var s=0;s<e.length;s++){o=e[s];if(!a.isArrayOrTypedArray(o)){t=false;break}if(o.length>0)r=true;for(var l=0;l<o.length;l++){if(n(o[l])){i=true;break}}}return t&&r&&i}},{"../../lib":778,"../../registry":911,"fast-isnumeric":241}],1080:[function(e,t,r){"use strict";var n=e("../heatmap/attributes");var a=e("../../components/colorscale/attributes");var i=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;var s=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"];var l={};for(var u=0;u<s.length;u++){var c=s[u];l[c]=n[c]}l.zsmooth={valType:"enumerated",values:["fast",false],dflt:"fast",editType:"calc"};i(l,a("",{cLetter:"z",autoColorDflt:false}));t.exports=o(l,"calc","nested")},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../heatmap/attributes":1065}],1081:[function(e,t,r){"use strict";var n=e("gl-heatmap2d");var a=e("../../plots/cartesian/axes");var i=e("../../lib/str2rgbarray");function o(e,t){this.scene=e;this.uid=t;this.type="heatmapgl";this.name="";this.hoverinfo="all";this.xData=[];this.yData=[];this.zData=[];this.textLabels=[];this.idToIndex=[];this.bounds=[0,0,0,0];this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]};this.heatmap=n(e.glplot,this.options);this.heatmap._trace=this}var s=o.prototype;s.handlePick=function(e){var t=this.options;var r=t.shape;var n=e.pointId;var a=n%r[0];var i=Math.floor(n/r[0]);var o=n;return{trace:this,dataCoord:e.dataCoord,traceCoord:[t.x[a],t.y[i],t.z[o]],textLabel:this.textLabels[n],name:this.name,pointIndex:[i,a],hoverinfo:this.hoverinfo}};s.update=function(e,t){var r=t[0];this.index=e.index;this.name=e.name;this.hoverinfo=e.hoverinfo;var n=r.z;this.options.z=[].concat.apply([],n);var i=n[0].length;var o=n.length;this.options.shape=[i,o];this.options.x=r.x;this.options.y=r.y;this.options.zsmooth=e.zsmooth;var s=l(e);this.options.colorLevels=s.colorLevels;this.options.colorValues=s.colorValues;this.textLabels=[].concat.apply([],e.text);this.heatmap.update(this.options);var u=this.scene.xaxis;var c=this.scene.yaxis;var f,h;if(e.zsmooth===false){f={ppad:r.x[1]-r.x[0]};h={ppad:r.y[1]-r.y[0]}}e._extremes[u._id]=a.findExtremes(u,r.x,f);e._extremes[c._id]=a.findExtremes(c,r.y,h)};s.dispose=function(){this.heatmap.dispose()};function l(e){var t=e.colorscale;var r=e.zmin;var n=e.zmax;var a=t.length;var o=new Array(a);var s=new Array(4*a);for(var l=0;l<a;l++){var u=t[l];var c=i(u[1]);o[l]=r+u[0]*(n-r);for(var f=0;f<4;f++){s[4*l+f]=c[f]}}return{colorLevels:o,colorValues:s}}function u(e,t,r){var n=new o(e,t.uid);n.update(t,r);return n}t.exports=u},{"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"gl-heatmap2d":271}],1082:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../heatmap/xyz_defaults");var i=e("../../components/colorscale/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,a){return n.coerce(t,r,o,e,a)}var c=a(t,r,u,l);if(!c){r.visible=false;return}u("text");u("zsmooth");i(t,r,l,u,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":653,"../../lib":778,"../heatmap/xyz_defaults":1079,"./attributes":1080}],1083:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../heatmap/calc"),plot:e("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":868,"../heatmap/calc":1066,"../heatmap/colorbar":1068,"./attributes":1080,"./convert":1081,"./defaults":1082}],1084:[function(e,t,r){"use strict";var n=e("../bar/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("./bin_attributes");var o=e("./constants");var s=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:s({},n.text,{}),hovertext:s({},n.hovertext,{}),orientation:n.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:false,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:i("x",true),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:i("y",true),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:a({},{keys:o.eventDataKeys}),marker:n.marker,offsetgroup:n.offsetgroup,alignmentgroup:n.alignmentgroup,selected:n.selected,unselected:n.unselected,_deprecated:{bardir:n._deprecated.bardir}}},{"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"./bin_attributes":1086,"./constants":1090}],1085:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t.length;var a=0;for(var i=0;i<n;i++){if(r[i]){t[i]/=r[i];a+=t[i]}else t[i]=null}return a}},{}],1086:[function(e,t,r){"use strict";t.exports=function e(t,r){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1087:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports={count:function(e,t,r){r[e]++;return 1},sum:function(e,t,r,a){var i=a[t];if(n(i)){i=Number(i);r[e]+=i;return i}return 0},avg:function(e,t,r,a,i){var o=a[t];if(n(o)){o=Number(o);r[e]+=o;i[e]++}return 0},min:function(e,t,r,a){var i=a[t];if(n(i)){i=Number(i);if(!n(r[e])){r[e]=i;return i}else if(r[e]>i){var o=i-r[e];r[e]=i;return o}}return 0},max:function(e,t,r,a){var i=a[t];if(n(i)){i=Number(i);if(!n(r[e])){r[e]=i;return i}else if(r[e]<i){var o=i-r[e];r[e]=i;return o}}return 0}}},{"fast-isnumeric":241}],1088:[function(e,t,r){"use strict";var n=e("../../constants/numerical");var a=n.ONEAVGYEAR;var i=n.ONEAVGMONTH;var o=n.ONEDAY;var s=n.ONEHOUR;var l=n.ONEMIN;var u=n.ONESEC;var c=e("../../plots/cartesian/axes").tickIncrement;t.exports=function e(t,r,n,i,s){var l=-1.1*r;var u=-.1*r;var h=t-u;var p=n[0];var d=n[1];var v=Math.min(f(p+u,p+h,i,s),f(d+u,d+h,i,s));var m=Math.min(f(p+l,p+u,i,s),f(d+l,d+u,i,s));var g,y;if(v>m&&m<Math.abs(d-p)/4e3){g=v;y=false}else{g=Math.min(v,m);y=true}if(i.type==="date"&&g>o){var x=g===a?1:6;var _=g===a?"M12":"M1";return function(e,r){var n=i.c2d(e,a,s);var o=n.indexOf("-",x);if(o>0)n=n.substr(0,o);var l=i.d2c(n,0,s);if(l<e){var u=c(l,_,false,s);if((l+u)/2<e+t)l=u}if(r&&y){return c(l,_,true,s)}return l}}return function(e,r){var n=g*Math.round(e/g);if(n+g/10<e&&n+g*.9<e+t){n+=g}if(r&&y){n-=g}return n}};function f(e,t,r,n){if(e*t<=0)return Infinity;var a=Math.abs(t-e);var i=r.type==="date";var o=h(a,i);for(var s=0;s<10;s++){var l=h(o*80,i);if(o===l)break;if(p(l,e,t,i,r,n))o=l;else break}return o}function h(e,t){if(t&&e>u){if(e>o){if(e>a*1.1)return a;if(e>i*1.1)return i;return o}if(e>s)return s;if(e>l)return l;return u}return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))}function p(e,t,r,n,i,s){if(n&&e>o){var l=d(t,i,s);var u=d(r,i,s);var c=e===a?0:1;return l[c]!==u[c]}return Math.floor(r/e)-Math.floor(t/e)>.1}function d(e,t,r){var n=t.c2d(e,a,r).split("-");if(n[0]===""){n.unshift();n[0]="-"+n[0]}return n}},{"../../constants/numerical":753,"../../plots/cartesian/axes":828}],1089:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../registry");var o=e("../../plots/cartesian/axes");var s=e("../bar/arrays_to_calcdata");var l=e("./bin_functions");var u=e("./norm_functions");var c=e("./average");var f=e("./bin_label_vals");function h(e,t){var r=[];var i=[];var h=o.getFromId(e,t.orientation==="h"?t.yaxis:t.xaxis);var d=t.orientation==="h"?"y":"x";var v={x:"y",y:"x"}[d];var g=t[d+"calendar"];var y=t.cumulative;var x;var _=p(e,t,h,d);var b=_[0];var w=_[1];var T=typeof b.size==="string";var k=[];var A=T?k:b;var M=[];var E=[];var S=[];var C=0;var L=t.histnorm;var I=t.histfunc;var O=L.indexOf("density")!==-1;var P,D,R;if(y.enabled&&O){L=L.replace(/ ?density$/,"");O=false}var z=I==="max"||I==="min";var N=z?null:0;var F=l.count;var B=u[L];var j=false;var U=function(e){return h.r2c(e,0,g)};var H;if(a.isArrayOrTypedArray(t[v])&&I!=="count"){H=t[v];j=I==="avg";F=l[I]}x=U(b.start);D=U(b.end)+(x-o.tickIncrement(x,b.size,false,g))/1e6;while(x<D&&r.length<1e6){P=o.tickIncrement(x,b.size,false,g);r.push((x+P)/2);i.push(N);S.push([]);k.push(x);if(O)M.push(1/(P-x));if(j)E.push(0);if(P<=x)break;x=P}k.push(x);if(!T&&h.type==="date"){A={start:U(A.start),end:U(A.end),size:A.size}}if(!e._fullLayout._roundFnOpts)e._fullLayout._roundFnOpts={};var V=t["_"+d+"bingroup"];var G={leftGap:Infinity,rightGap:Infinity};if(V){if(!e._fullLayout._roundFnOpts[V])e._fullLayout._roundFnOpts[V]=G;G=e._fullLayout._roundFnOpts[V]}var q=i.length;var Y=true;var W=G.leftGap;var X=G.rightGap;var Z={};for(x=0;x<w.length;x++){var K=w[x];R=a.findBin(K,A);if(R>=0&&R<q){C+=F(R,x,i,H,E);if(Y&&S[R].length&&K!==w[S[R][0]]){Y=false}S[R].push(x);Z[x]=R;W=Math.min(W,K-k[R]);X=Math.min(X,k[R+1]-K)}}G.leftGap=W;G.rightGap=X;var J;if(!Y){J=function(t,r){return function(){var n=e._fullLayout._roundFnOpts[V];return f(n.leftGap,n.rightGap,k,h,g)(t,r)}}}if(j)C=c(i,E);if(B)B(i,C,M);if(y.enabled)m(i,y.direction,y.currentbin);var Q=Math.min(r.length,i.length);var $=[];var ee=0;var te=Q-1;for(x=0;x<Q;x++){if(i[x]){ee=x;break}}for(x=Q-1;x>=ee;x--){if(i[x]){te=x;break}}for(x=ee;x<=te;x++){if(n(r[x])&&n(i[x])){var re={p:r[x],s:i[x],b:0};if(!y.enabled){re.pts=S[x];if(Y){re.ph0=re.ph1=S[x].length?w[S[x][0]]:r[x]}else{t._computePh=true;re.ph0=J(k[x]);re.ph1=J(k[x+1],true)}}$.push(re)}}if($.length===1){$[0].width1=o.tickIncrement($[0].p,b.size,false,g)-$[0].p}s($,t);if(a.isArrayOrTypedArray(t.selectedpoints)){a.tagSelected($,t,Z)}return $}function p(e,t,r,s,l){var u=s+"bins";var c=e._fullLayout;var f=t["_"+s+"bingroup"];var h=c._histogramBinOpts[f];var p=c.barmode==="overlay";var v,m,g,y,x,_,b;var w=function(e){return r.r2c(e,0,y)};var T=function(e){return r.c2r(e,0,y)};var k=r.type==="date"?function(e){return e||e===0?a.cleanDate(e,null,y):null}:function(e){return n(e)?Number(e):null};function A(e,t,r){if(t[e+"Found"]){t[e]=k(t[e]);if(t[e]===null)t[e]=r[e]}else{_[e]=t[e]=r[e];a.nestedProperty(m[0],u+"."+e).set(r[e])}}if(t["_"+s+"autoBinFinished"]){delete t["_"+s+"autoBinFinished"]}else{m=h.traces;var M=[];var E=true;var S=false;var C=false;for(v=0;v<m.length;v++){g=m[v];if(g.visible){var L=h.dirs[v];x=g["_"+L+"pos0"]=r.makeCalcdata(g,L);M=a.concat(M,x);delete g["_"+s+"autoBinFinished"];if(t.visible===true){if(E){E=false}else{delete g._autoBin;g["_"+s+"autoBinFinished"]=1}if(i.traceIs(g,"2dMap")){S=true}if(g.type==="histogram2dcontour"){C=true}}}}y=m[0][s+"calendar"];var I=o.autoBin(M,r,h.nbins,S,y,h.sizeFound&&h.size);var O=m[0]._autoBin={};_=O[h.dirs[0]]={};if(C){if(!h.size){I.start=T(o.tickIncrement(w(I.start),I.size,true,y))}if(h.end===undefined){I.end=T(o.tickIncrement(w(I.end),I.size,false,y))}}if(p&&!i.traceIs(t,"2dMap")&&I._dataSpan===0&&r.type!=="category"&&r.type!=="multicategory"){if(l)return[I,x,true];I=d(e,t,r,s,u)}b=g.cumulative||{};if(b.enabled&&b.currentbin!=="include"){if(b.direction==="decreasing"){I.start=T(o.tickIncrement(w(I.start),I.size,true,y))}else{I.end=T(o.tickIncrement(w(I.end),I.size,false,y))}}h.size=I.size;if(!h.sizeFound){_.size=I.size;a.nestedProperty(m[0],u+".size").set(I.size)}A("start",h,I);A("end",h,I)}x=t["_"+s+"pos0"];delete t["_"+s+"pos0"];var P=t._input[u]||{};var D=a.extendFlat({},h);var R=h.start;var z=r.r2l(P.start);var N=z!==undefined;if((h.startFound||N)&&z!==r.r2l(R)){var F=N?z:a.aggNums(Math.min,null,x);var B={type:r.type==="category"||r.type==="multicategory"?"linear":r.type,r2l:r.r2l,dtick:h.size,tick0:R,calendar:y,range:[F,o.tickIncrement(F,h.size,false,y)].map(r.l2r)};var j=o.tickFirst(B);if(j>r.r2l(F)){j=o.tickIncrement(j,h.size,true,y)}D.start=r.l2r(j);if(!N)a.nestedProperty(t,u+".start").set(D.start)}var U=h.end;var H=r.r2l(P.end);var V=H!==undefined;if((h.endFound||V)&&H!==r.r2l(U)){var G=V?H:a.aggNums(Math.max,null,x);D.end=r.l2r(G);if(!V)a.nestedProperty(t,u+".start").set(D.end)}var q="autobin"+s;if(t._input[q]===false){t._input[u]=a.extendFlat({},t[u]||{});delete t._input[q];delete t[q]}return[D,x]}function d(e,t,r,n,i){var o=e._fullLayout;var s=v(e,t);var l=false;var u=Infinity;var c=[t];var f,h,d;for(f=0;f<s.length;f++){h=s[f];if(h===t){l=true}else if(!l){d=o._histogramBinOpts[h["_"+n+"bingroup"]];u=Math.min(u,d.size||h[i].size)}else{var m=p(e,h,r,n,true);var g=m[0];var y=m[2];h["_"+n+"autoBinFinished"]=1;h["_"+n+"pos0"]=m[1];if(y){c.push(h)}else{u=Math.min(u,g.size)}}}var x=new Array(c.length);for(f=0;f<c.length;f++){var _=c[f]["_"+n+"pos0"];for(var b=0;b<_.length;b++){if(_[b]!==undefined){x[f]=_[b];break}}}if(!isFinite(u)){u=a.distinctVals(x).minDiff}for(f=0;f<c.length;f++){h=c[f];var w=h[n+"calendar"];var T={start:r.c2r(x[f]-u/2,0,w),end:r.c2r(x[f]+u/2,0,w),size:u};h._input[i]=h[i]=T;d=o._histogramBinOpts[h["_"+n+"bingroup"]];if(d)a.extendFlat(d,T)}return t[i]}function v(e,t){var r=t.xaxis;var n=t.yaxis;var a=t.orientation;var i=[];var o=e._fullData;for(var s=0;s<o.length;s++){var l=o[s];if(l.type==="histogram"&&l.visible===true&&l.orientation===a&&l.xaxis===r&&l.yaxis===n){i.push(l)}}return i}function m(e,t,r){var n,a,i;function o(t){i=e[t];e[t]/=2}function s(t){a=e[t];e[t]=i+a/2;i+=a}if(r==="half"){if(t==="increasing"){o(0);for(n=1;n<e.length;n++){s(n)}}else{o(e.length-1);for(n=e.length-2;n>=0;n--){s(n)}}}else if(t==="increasing"){for(n=1;n<e.length;n++){e[n]+=e[n-1]}if(r==="exclude"){e.unshift(0);e.pop()}}else{for(n=e.length-2;n>=0;n--){e[n]+=e[n+1]}if(r==="exclude"){e.push(0);e.shift()}}}t.exports={calc:h,calcAllAutoBins:p}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"../bar/arrays_to_calcdata":920,"./average":1085,"./bin_functions":1087,"./bin_label_vals":1088,"./norm_functions":1096,"fast-isnumeric":241}],1090:[function(e,t,r){"use strict";t.exports={eventDataKeys:["binNumber"]}},{}],1091:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axis_ids");var i=e("../../registry").traceIs;var o=e("../bar/defaults").handleGroupingDefaults;var s=n.nestedProperty;var l=e("../../plots/cartesian/constraints").getAxisGroup;var u=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}];var c=["x","y"];t.exports=function e(t,r){var f=r._histogramBinOpts={};var h=[];var p={};var d=[];var v,m,g,y;var x,_,b;function w(e,t){return n.coerce(v._input,v,v._module.attributes,e,t)}function T(e){return e.orientation==="v"?"x":"y"}function k(e,t){var n=a.getFromTrace({_fullLayout:r},e,t);return n.type}function A(e,t,r){var a=e.uid+"__"+r;if(!t)t=a;var i=k(e,r);var o=e[r+"calendar"]||"";var s=f[t];var l=true;if(s){if(i===s.axType&&o===s.calendar){l=false;s.traces.push(e);s.dirs.push(r)}else{t=a;if(i!==s.axType){n.warn(["Attempted to group the bins of trace",e.index,"set on a","type:"+i,"axis","with bins on","type:"+s.axType,"axis."].join(" "))}if(o!==s.calendar){n.warn(["Attempted to group the bins of trace",e.index,"set with a",o,"calendar","with bins",s.calendar?"on a "+s.calendar+" calendar":"w/o a set calendar"].join(" "))}}}if(l){f[t]={traces:[e],dirs:[r],axType:i,calendar:e[r+"calendar"]||""}}e["_"+r+"bingroup"]=t}for(x=0;x<t.length;x++){v=t[x];if(i(v,"histogram")){h.push(v);delete v._xautoBinFinished;delete v._yautoBinFinished;if(!i(v,"2dMap")){o(v._input,v,r,w)}}}var M=r._alignmentOpts||{};for(x=0;x<h.length;x++){v=h[x];g="";if(!i(v,"2dMap")){y=T(v);if(r.barmode==="group"&&v.alignmentgroup){var E=v[y+"axis"];var S=l(r,E)+v.orientation;if((M[S]||{})[v.alignmentgroup]){g=S}}if(!g&&r.barmode!=="overlay"){g=l(r,v.xaxis)+l(r,v.yaxis)+T(v)}}if(g){if(!p[g]){p[g]=[]}p[g].push(v)}else{d.push(v)}}for(g in p){m=p[g];if(m.length===1){d.push(m[0]);continue}var C=false;if(m.length){v=m[0];C=w("bingroup")}g=C||g;for(x=0;x<m.length;x++){v=m[x];var L=v._input.bingroup;if(L&&L!==g){n.warn(["Trace",v.index,"must match","within bingroup",g+".","Ignoring its bingroup:",L,"setting."].join(" "))}v.bingroup=g;A(v,g,T(v))}}for(x=0;x<d.length;x++){v=d[x];var I=w("bingroup");if(i(v,"2dMap")){for(b=0;b<2;b++){y=c[b];var O=w(y+"bingroup",I?I+"__"+y:null);A(v,O,y)}}else{A(v,I,T(v))}}for(g in f){var P=f[g];m=P.traces;for(_=0;_<u.length;_++){var D=u[_];var R=D.name;var z;var N;if(R==="nbins"&&P.sizeFound)continue;for(x=0;x<m.length;x++){v=m[x];y=P.dirs[x];z=D.aStr[y];if(s(v._input,z).get()!==undefined){P[R]=w(z);P[R+"Found"]=true;break}N=(v._autoBin||{})[y]||{};if(N[R]){s(v,z).set(N[R])}}if(R==="start"||R==="end"){for(;x<m.length;x++){v=m[x];if(v["_"+y+"bingroup"]){N=(v._autoBin||{})[y]||{};w(z,N[R])}}}if(R==="nbins"&&!P.sizeFound&&!P.nbinsFound){v=m[0];P[R]=w(z)}}}}},{"../../lib":778,"../../plots/cartesian/axis_ids":831,"../../plots/cartesian/constraints":835,"../../registry":911,"../bar/defaults":925}],1092:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../../components/color");var o=e("../bar/style_defaults");var s=e("./attributes");t.exports=function e(t,r,l,u){function c(e,n){return a.coerce(t,r,s,e,n)}var f=c("x");var h=c("y");var p=c("cumulative.enabled");if(p){c("cumulative.direction");c("cumulative.currentbin")}c("text");c("hovertext");c("hovertemplate");var d=c("orientation",h&&!f?"h":"v");var v=d==="v"?"x":"y";var m=d==="v"?"y":"x";var g=f&&h?Math.min(a.minRowLength(f)&&a.minRowLength(h)):a.minRowLength(r[v]||[]);if(!g){r.visible=false;return}r._length=g;var y=n.getComponentMethod("calendars","handleTraceDefaults");y(t,r,["x","y"],u);var x=r[m];if(x)c("histfunc");c("histnorm");c("autobin"+v);o(t,r,c,l,u);a.coerceSelectionMarkerOpacity(r,c);var _=(r.marker.line||{}).color;var b=n.getComponentMethod("errorbars","supplyDefaults");b(t,r,_||i.defaultLine,{axis:"y"});b(t,r,_||i.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":643,"../../lib":778,"../../registry":911,"../bar/style_defaults":936,"./attributes":1084}],1093:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if("zLabelVal"in r)t.z=r.zLabelVal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;if(!(n.cumulative||{}).enabled){var o=Array.isArray(i)?a[0].pts[i[0]][i[1]]:a[i].pts;t.pointNumbers=o;t.binNumber=t.pointNumber;delete t.pointNumber;delete t.pointIndex;var s;if(n._indexToPoints){s=[];for(var l=0;l<o.length;l++){s=s.concat(n._indexToPoints[o[l]])}}else{s=o}t.pointIndices=s}return t}},{}],1094:[function(e,t,r){"use strict";var n=e("../bar/hover").hoverPoints;var a=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function e(t,r,i,o){var s=n(t,r,i,o);if(!s)return;t=s[0];var l=t.cd[t.index];var u=t.cd[0].trace;if(!u.cumulative.enabled){var c=u.orientation==="h"?"y":"x";t[c+"Label"]=a(t[c+"a"],l.ph0,l.ph1)}return s}},{"../../plots/cartesian/axes":828,"../bar/hover":928}],1095:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("../bar/layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),supplyLayoutDefaults:e("../bar/layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("../bar/cross_trace_calc").crossTraceCalc,plot:e("../bar/plot").plot,layerName:"barlayer",style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,colorbar:e("../scatter/marker_colorbar"),hoverPoints:e("./hover"),selectPoints:e("../bar/select"),eventData:e("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../bar/cross_trace_calc":924,"../bar/layout_attributes":930,"../bar/layout_defaults":931,"../bar/plot":932,"../bar/select":933,"../bar/style":935,"../scatter/marker_colorbar":1205,"./attributes":1084,"./calc":1089,"./cross_trace_defaults":1091,"./defaults":1092,"./event_data":1093,"./hover":1094}],1096:[function(e,t,r){"use strict";t.exports={percent:function(e,t){var r=e.length;var n=100/t;for(var a=0;a<r;a++)e[a]*=n},probability:function(e,t){var r=e.length;for(var n=0;n<r;n++)e[n]/=t},density:function(e,t,r,n){var a=e.length;n=n||1;for(var i=0;i<a;i++)e[i]*=r[i]*n},"probability density":function(e,t,r,n){var a=e.length;if(n)t/=n;for(var i=0;i<a;i++)e[i]*=r[i]/t}}},{}],1097:[function(e,t,r){"use strict";var n=e("../histogram/attributes");var a=e("../histogram/bin_attributes");var i=e("../heatmap/attributes");var o=e("../../plots/attributes");var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../components/colorscale/attributes");var u=e("../../lib/extend").extendFlat;t.exports=u({x:n.x,y:n.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:n.histnorm,histfunc:n.histfunc,nbinsx:n.nbinsx,xbins:a("x"),nbinsy:n.nbinsy,ybins:a("y"),autobinx:n.autobinx,autobiny:n.autobiny,bingroup:u({},n.bingroup,{}),xbingroup:u({},n.bingroup,{}),ybingroup:u({},n.bingroup,{}),xgap:i.xgap,ygap:i.ygap,zsmooth:i.zsmooth,zhoverformat:i.zhoverformat,hovertemplate:s({},{keys:"z"}),showlegend:u({},o.showlegend,{dflt:false})},l("",{cLetter:"z",autoColorDflt:false}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../heatmap/attributes":1065,"../histogram/attributes":1084,"../histogram/bin_attributes":1086}],1098:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../histogram/bin_functions");var o=e("../histogram/norm_functions");var s=e("../histogram/average");var l=e("../histogram/bin_label_vals");var u=e("../histogram/calc").calcAllAutoBins;t.exports=function e(t,r){var l=a.getFromId(t,r.xaxis);var p=a.getFromId(t,r.yaxis);var d=r.xcalendar;var v=r.ycalendar;var m=function(e){return l.r2c(e,0,d)};var g=function(e){return p.r2c(e,0,v)};var y=function(e){return l.c2r(e,0,d)};var x=function(e){return p.c2r(e,0,v)};var _,b,w,T;var k=u(t,r,l,"x");var A=k[0];var M=k[1];var E=u(t,r,p,"y");var S=E[0];var C=E[1];var L=r._length;if(M.length>L)M.splice(L,M.length-L);if(C.length>L)C.splice(L,C.length-L);var I=[];var O=[];var P=[];var D=typeof A.size==="string";var R=typeof S.size==="string";var z=[];var N=[];var F=D?z:A;var B=R?N:S;var j=0;var U=[];var H=[];var V=r.histnorm;var G=r.histfunc;var q=V.indexOf("density")!==-1;var Y=G==="max"||G==="min";var W=Y?null:0;var X=i.count;var Z=o[V];var K=false;var J=[];var Q=[];var $="z"in r?r.z:"marker"in r&&Array.isArray(r.marker.color)?r.marker.color:"";if($&&G!=="count"){K=G==="avg";X=i[G]}var ee=A.size;var te=m(A.start);var re=m(A.end)+(te-a.tickIncrement(te,ee,false,d))/1e6;for(_=te;_<re;_=a.tickIncrement(_,ee,false,d)){O.push(W);z.push(_);if(K)P.push(0)}z.push(_);var ne=O.length;var ae=(_-te)/ne;var ie=y(te+ae/2);var oe=S.size;var se=g(S.start);var le=g(S.end)+(se-a.tickIncrement(se,oe,false,v))/1e6;for(_=se;_<le;_=a.tickIncrement(_,oe,false,v)){I.push(O.slice());N.push(_);var ue=new Array(ne);for(b=0;b<ne;b++)ue[b]=[];H.push(ue);if(K)U.push(P.slice())}N.push(_);var ce=I.length;var fe=(_-se)/ce;var he=x(se+fe/2);if(q){J=c(O.length,F,ae,D);Q=c(I.length,B,fe,R)}if(!D&&l.type==="date")F=f(m,F);if(!R&&p.type==="date")B=f(g,B);var pe=true;var de=true;var ve=new Array(ne);var me=new Array(ce);var ge=Infinity;var ye=Infinity;var xe=Infinity;var _e=Infinity;for(_=0;_<L;_++){var be=M[_];var we=C[_];w=n.findBin(be,F);T=n.findBin(we,B);if(w>=0&&w<ne&&T>=0&&T<ce){j+=X(w,_,I[T],$,U[T]);H[T][w].push(_);if(pe){if(ve[w]===undefined)ve[w]=be;else if(ve[w]!==be)pe=false}if(de){if(me[T]===undefined)me[T]=we;else if(me[T]!==we)de=false}ge=Math.min(ge,be-z[w]);ye=Math.min(ye,z[w+1]-be);xe=Math.min(xe,we-N[T]);_e=Math.min(_e,N[T+1]-we)}}if(K){for(T=0;T<ce;T++)j+=s(I[T],U[T])}if(Z){for(T=0;T<ce;T++)Z(I[T],j,J,Q[T])}return{x:M,xRanges:h(z,pe&&ve,ge,ye,l,d),x0:ie,dx:ae,y:C,yRanges:h(N,de&&me,xe,_e,p,v),y0:he,dy:fe,z:I,pts:H}};function c(e,t,r,n){var a=new Array(e);var i;if(n){for(i=0;i<e;i++)a[i]=1/(t[i+1]-t[i])}else{var o=1/r;for(i=0;i<e;i++)a[i]=o}return a}function f(e,t){return{start:e(t.start),end:e(t.end),size:t.size}}function h(e,t,r,n,a,i){var o;var s=e.length-1;var u=new Array(s);var c=l(r,n,e,a,i);for(o=0;o<s;o++){var f=(t||[])[o];u[o]=f===undefined?[c(e[o]),c(e[o+1],true)]:[f,f]}return u}},{"../../lib":778,"../../plots/cartesian/axes":828,"../histogram/average":1085,"../histogram/bin_functions":1087,"../histogram/bin_label_vals":1088,"../histogram/calc":1089,"../histogram/norm_functions":1096}],1099:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./sample_defaults");var i=e("../heatmap/style_defaults");var o=e("../../components/colorscale/defaults");var s=e("./attributes");t.exports=function e(t,r,l,u){function c(e,a){return n.coerce(t,r,s,e,a)}a(t,r,c,u);if(r.visible===false)return;i(t,r,c,u);o(t,r,u,c,{prefix:"",cLetter:"z"});c("hovertemplate")}},{"../../components/colorscale/defaults":653,"../../lib":778,"../heatmap/style_defaults":1078,"./attributes":1097,"./sample_defaults":1102}],1100:[function(e,t,r){"use strict";var n=e("../heatmap/hover");var a=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function e(t,r,i,o,s,l){var u=n(t,r,i,o,s,l);if(!u)return;t=u[0];var c=t.index;var f=c[0];var h=c[1];var p=t.cd[0];var d=p.xRanges[h];var v=p.yRanges[f];t.xLabel=a(t.xa,d[0],d[1]);t.yLabel=a(t.ya,v[0],v[1]);return u}},{"../../plots/cartesian/axes":828,"../heatmap/hover":1072}],1101:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../heatmap/calc"),plot:e("../heatmap/plot"),layerName:"heatmaplayer",colorbar:e("../heatmap/colorbar"),style:e("../heatmap/style"),hoverPoints:e("./hover"),eventData:e("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../heatmap/calc":1066,"../heatmap/colorbar":1068,"../heatmap/plot":1076,"../heatmap/style":1077,"../histogram/cross_trace_defaults":1091,"../histogram/event_data":1093,"./attributes":1097,"./defaults":1099,"./hover":1100}],1102:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");t.exports=function e(t,r,i,o){var s=i("x");var l=i("y");var u=a.minRowLength(s);var c=a.minRowLength(l);if(!u||!c){r.visible=false;return}r._length=Math.min(u,c);var f=n.getComponentMethod("calendars","handleTraceDefaults");f(t,r,["x","y"],o);var h=i("z")||i("marker.color");if(h)i("histfunc");i("histnorm");i("autobinx");i("autobiny")}},{"../../lib":778,"../../registry":911}],1103:[function(e,t,r){"use strict";var n=e("../histogram2d/attributes");var a=e("../contour/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../lib/extend").extendFlat;t.exports=o({x:n.x,y:n.y,z:n.z,marker:n.marker,histnorm:n.histnorm,histfunc:n.histfunc,nbinsx:n.nbinsx,xbins:n.xbins,nbinsy:n.nbinsy,ybins:n.ybins,autobinx:n.autobinx,autobiny:n.autobiny,bingroup:n.bingroup,xbingroup:n.xbingroup,ybingroup:n.ybingroup,autocontour:a.autocontour,ncontours:a.ncontours,contours:a.contours,line:{color:a.line.color,width:o({},a.line.width,{dflt:.5}),dash:a.line.dash,smoothing:a.line.smoothing,editType:"plot"},zhoverformat:n.zhoverformat,hovertemplate:n.hovertemplate},i("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../contour/attributes":1008,"../histogram2d/attributes":1097}],1104:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../histogram2d/sample_defaults");var i=e("../contour/contours_defaults");var o=e("../contour/style_defaults");var s=e("./attributes");t.exports=function e(t,r,l,u){function c(e,a){return n.coerce(t,r,s,e,a)}function f(e){return n.coerce2(t,r,s,e)}a(t,r,c,u);if(r.visible===false)return;i(t,r,c,f);o(t,r,c,u);c("hovertemplate")}},{"../../lib":778,"../contour/contours_defaults":1015,"../contour/style_defaults":1029,"../histogram2d/sample_defaults":1102,"./attributes":1103}],1105:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../contour/calc"),plot:e("../contour/plot").plot,layerName:"contourlayer",style:e("../contour/style"),colorbar:e("../contour/colorbar"),hoverPoints:e("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../contour/calc":1009,"../contour/colorbar":1011,"../contour/hover":1021,"../contour/plot":1026,"../contour/style":1028,"../histogram/cross_trace_defaults":1091,"./attributes":1103,"./defaults":1104}],1106:[function(e,t,r){"use strict";var n=e("../../plots/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../lib/extend").extendFlat;var o=e("./constants").colormodel;var s=["rgb","rgba","rgba256","hsl","hsla"];var l=[];var u=[];for(var c=0;c<s.length;c++){var f=o[s[c]];l.push("For the `"+s[c]+"` colormodel, it is ["+(f.zminDflt||f.min).join(", ")+"].");u.push("For the `"+s[c]+"` colormodel, it is ["+(f.zmaxDflt||f.max).join(", ")+"].")}t.exports=i({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:s,editType:"calc"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:i({},n.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:a({},{keys:["z","color","colormodel"]}),transforms:undefined})},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"./constants":1108}],1107:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./constants");var i=e("fast-isnumeric");var o=e("../../plots/cartesian/axes");var s=e("../../lib").maxRowLength;var l=e("./helpers").getImageSize;t.exports=function e(t,r){var n;var a;if(r._hasZ){n=r.z.length;a=s(r.z)}else if(r._hasSource){var i=l(r.source);n=i.height;a=i.width}var u=o.getFromId(t,r.xaxis||"x");var c=o.getFromId(t,r.yaxis||"y");var h=u.d2c(r.x0)-r.dx/2;var p=c.d2c(r.y0)-r.dy/2;var d;var v=[h,h+a*r.dx];var m=[p,p+n*r.dy];if(u&&u.type==="log")for(d=0;d<a;d++)v.push(h+d*r.dx);if(c&&c.type==="log")for(d=0;d<n;d++)m.push(p+d*r.dy);r._extremes[u._id]=o.findExtremes(u,v);r._extremes[c._id]=o.findExtremes(c,m);r._scaler=f(r);var g={x0:h,y0:p,z:r.z,w:a,h:n};return[g]};function u(e,t,r,a){return function(i){return n.constrain((i-e)*t,r,a)}}function c(e,t){return function(r){return n.constrain(r,e,t)}}function f(e){var t=a.colormodel[e.colormodel];var r=t.colormodel||e.colormodel;var n=r.length;e._sArray=[];for(var o=0;o<n;o++){if(t.min[o]!==e.zmin[o]||t.max[o]!==e.zmax[o]){e._sArray.push(u(e.zmin[o],(t.max[o]-t.min[o])/(e.zmax[o]-e.zmin[o]),t.min[o],t.max[o]))}else{e._sArray.push(c(t.min[o],t.max[o]))}}return function(t){var r=t.slice(0,n);for(var a=0;a<n;a++){var o=r[a];if(!i(o))return false;r[a]=e._sArray[a](o)}return r}}},{"../../lib":778,"../../plots/cartesian/axes":828,"./constants":1108,"./helpers":1111,"fast-isnumeric":241}],1108:[function(e,t,r){"use strict";t.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(e){return e.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(e){return e.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(e){return e.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(e){var t=e.slice(0,3);t[1]=t[1]+"%";t[2]=t[2]+"%";return t},suffix:["°","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(e){var t=e.slice(0,4);t[1]=t[1]+"%";t[2]=t[2]+"%";return t},suffix:["°","%","%",""]}}}},{}],1109:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("./constants");var o=e("../../snapshot/helpers").IMAGE_URL_PREFIX;t.exports=function e(t,r){function s(e,i){return n.coerce(t,r,a,e,i)}s("source");if(r.source&&!r.source.match(o))delete r.source;r._hasSource=!!r.source;var l=s("z");r._hasZ=!(l===undefined||!l.length||!l[0]||!l[0].length);if(!r._hasZ&&!r._hasSource){r.visible=false;return}s("x0");s("y0");s("dx");s("dy");var u;if(r._hasZ){s("colormodel","rgb");u=i.colormodel[r.colormodel];s("zmin",u.zminDflt||u.min);s("zmax",u.zmaxDflt||u.max)}else if(r._hasSource){r.colormodel="rgba256";u=i.colormodel[r.colormodel];r.zmin=u.zminDflt;r.zmax=u.zmaxDflt}s("text");s("hovertext");s("hovertemplate");r._length=null}},{"../../lib":778,"../../snapshot/helpers":915,"./attributes":1106,"./constants":1108}],1110:[function(e,t,r){"use strict";t.exports=function e(t,r){if("xVal"in r)t.x=r.xVal;if("yVal"in r)t.y=r.yVal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;t.color=r.color;t.colormodel=r.trace.colormodel;if(!t.z)t.z=r.color;return t}},{}],1111:[function(e,t,r){"use strict";var n=e("image-size");var a=e("../../snapshot/helpers").IMAGE_URL_PREFIX;var i=e("buffer/").Buffer;r.getImageSize=function(e){var t=e.replace(a,"");var r=new i(t,"base64");return n(r)}},{"../../snapshot/helpers":915,"buffer/":111,"image-size":444}],1112:[function(e,t,r){"use strict";var n=e("../../components/fx");var a=e("../../lib");var i=e("./constants");t.exports=function e(t,r,o){var s=t.cd[0];var l=s.trace;var u=t.xa;var c=t.ya;if(n.inbox(r-s.x0,r-(s.x0+s.w*l.dx),0)>0||n.inbox(o-s.y0,o-(s.y0+s.h*l.dy),0)>0){return}var f=Math.floor((r-s.x0)/l.dx);var h=Math.floor(Math.abs(o-s.y0)/l.dy);var p;if(l._hasZ){p=s.z[h][f]}else if(l._hasSource){p=l._canvas.el.getContext("2d").getImageData(f,h,1,1).data}if(!p)return;var d=s.hi||l.hoverinfo;var v;if(d){var m=d.split("+");if(m.indexOf("all")!==-1)m=["color"];if(m.indexOf("color")!==-1)v=true}var g=i.colormodel[l.colormodel];var y=g.colormodel||l.colormodel;var x=y.length;var _=l._scaler(p);var b=g.suffix;var w=[];if(l.hovertemplate||v){w.push("["+[_[0]+b[0],_[1]+b[1],_[2]+b[2]].join(", "));if(x===4)w.push(", "+_[3]+b[3]);w.push("]");w=w.join("");t.extraText=y.toUpperCase()+": "+w}var T;if(Array.isArray(l.hovertext)&&Array.isArray(l.hovertext[h])){T=l.hovertext[h][f]}else if(Array.isArray(l.text)&&Array.isArray(l.text[h])){T=l.text[h][f]}var k=c.c2p(s.y0+(h+.5)*l.dy);var A=s.x0+(f+.5)*l.dx;var M=s.y0+(h+.5)*l.dy;var E="["+p.slice(0,l.colormodel.length).join(", ")+"]";return[a.extendFlat(t,{index:[h,f],x0:u.c2p(s.x0+f*l.dx),x1:u.c2p(s.x0+(f+1)*l.dx),y0:k,y1:k,color:_,xVal:A,xLabelVal:A,yVal:M,yLabelVal:M,zLabelVal:E,text:T,hovertemplateLabels:{zLabel:E,colorLabel:w,"color[0]Label":_[0]+b[0],"color[1]Label":_[1]+b[1],"color[2]Label":_[2]+b[2],"color[3]Label":_[3]+b[3]}})]}},{"../../components/fx":683,"../../lib":778,"./constants":1108}],1113:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover"),eventData:e("./event_data"),moduleType:"trace",name:"image",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:false,meta:{}}},{"../../plots/cartesian":841,"./attributes":1106,"./calc":1107,"./defaults":1109,"./event_data":1110,"./hover":1112,"./plot":1114,"./style":1115}],1114:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=a.strTranslate;var o=e("../../constants/xmlns_namespaces");var s=e("./constants");var l=a.isIOS()||a.isSafari()||a.isIE();t.exports=function e(t,r,u,c){var f=r.xaxis;var h=r.yaxis;var p=!(l||t._context._exportedPlot);a.makeTraceGroups(c,u,"im").each(function(e){var r=n.select(this);var l=e[0];var u=l.trace;var c=p&&!u._hasZ&&u._hasSource&&f.type==="linear"&&h.type==="linear";u._fastImage=c;var d=l.z;var v=l.x0;var m=l.y0;var g=l.w;var y=l.h;var x=u.dx;var _=u.dy;var b,w,T,k,A,M;M=0;while(b===undefined&&M<g){b=f.c2p(v+M*x);M++}M=g;while(w===undefined&&M>0){w=f.c2p(v+M*x);M--}M=0;while(k===undefined&&M<y){k=h.c2p(m+M*_);M++}M=y;while(A===undefined&&M>0){A=h.c2p(m+M*_);M--}if(w<b){T=w;w=b;b=T}if(A<k){T=k;k=A;A=T}if(!c){var E=.5;b=Math.max(-E*f._length,b);w=Math.min((1+E)*f._length,w);k=Math.max(-E*h._length,k);A=Math.min((1+E)*h._length,A)}var S=Math.round(w-b);var C=Math.round(A-k);var L=S<=0||C<=0;if(L){var I=r.selectAll("image").data([]);I.exit().remove();return}function O(e){var t=document.createElement("canvas");t.width=S;t.height=C;var r=t.getContext("2d");var n=function(e){return a.constrain(Math.round(f.c2p(v+e*x)-b),0,S)};var i=function(e){return a.constrain(Math.round(h.c2p(m+e*_)-k),0,C)};var o=s.colormodel[u.colormodel];var c=o.colormodel||u.colormodel;var p=o.fmt;var d;for(M=0;M<l.w;M++){var g=n(M);var y=n(M+1);if(y===g||isNaN(y)||isNaN(g))continue;for(var w=0;w<l.h;w++){var T=i(w);var A=i(w+1);if(A===T||isNaN(A)||isNaN(T)||!e(M,w))continue;d=u._scaler(e(M,w));if(d){r.fillStyle=c+"("+p(d).join(",")+")"}else{r.fillStyle="rgba(0,0,0,0)"}r.fillRect(g,T,y-g,A-T)}}return t}var P=r.selectAll("image").data([e]);P.enter().append("svg:image").attr({xmlns:o.svg,preserveAspectRatio:"none"});P.exit().remove();var D="image-rendering: optimizeSpeed; image-rendering: -moz-crisp-edges; image-rendering: -o-crisp-edges; image-rendering: -webkit-optimize-contrast; image-rendering: optimize-contrast; image-rendering: crisp-edges; image-rendering: pixelated;";if(c){var R=a.simpleMap(f.range,f.r2l);var z=a.simpleMap(h.range,h.r2l);var N=R[1]<R[0];var F=z[1]>z[0];if(N||F){var B=b+S/2;var j=k+C/2;D+="transform:"+i(B+"px",j+"px")+"scale("+(N?-1:1)+","+(F?-1:1)+")"+i(-B+"px",-j+"px")+";"}}P.attr("style",D);var U=new Promise(function(e){if(u._hasZ){e()}else if(u._hasSource){if(u._canvas&&u._canvas.el.width===g&&u._canvas.el.height===y&&u._canvas.source===u.source){e()}else{var t=document.createElement("canvas");t.width=g;t.height=y;var r=t.getContext("2d");u._image=u._image||new Image;var n=u._image;n.onload=function(){r.drawImage(n,0,0);u._canvas={el:t,source:u.source};e()};n.setAttribute("src",u.source)}}}).then(function(){var e,t;if(u._hasZ){t=O(function(e,t){return d[t][e]});e=t.toDataURL("image/png")}else if(u._hasSource){if(c){e=u.source}else{var r=u._canvas.el.getContext("2d");var n=r.getImageData(0,0,g,y).data;t=O(function(e,t){var r=4*(t*g+e);return[n[r],n[r+1],n[r+2],n[r+3]]});e=t.toDataURL("image/png")}}P.attr({"xlink:href":e,height:C,width:S,x:b,y:k})});t._promises.push(U)})}},{"../../constants/xmlns_namespaces":754,"../../lib":778,"./constants":1108,d3:169}],1115:[function(e,t,r){"use strict";var n=e("d3");t.exports=function e(t){n.select(t).selectAll(".im image").style("opacity",function(e){return e[0].trace.opacity})}},{d3:169}],1116:[function(e,t,r){"use strict";var n=e("../../lib/extend").extendFlat;var a=e("../../lib/extend").extendDeep;var i=e("../../plot_api/edit_types").overrideAll;var o=e("../../plots/font_attributes");var s=e("../../components/color/attributes");var l=e("../../plots/domain").attributes;var u=e("../../plots/cartesian/layout_attributes");var c=e("../../plot_api/plot_template").templatedArray;var f=e("../../constants/delta.js");var h=e("../../constants/docs").FORMAT_LINK;var p=o({editType:"plot",colorEditType:"plot"});var d={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:s.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"};var v={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"};var m=c("step",a({},d,{range:v}));t.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:true},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:l({name:"indicator",trace:true,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:n({},p,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot"},font:n({},p,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:false},valueformat:{valType:"string",editType:"plot"},increasing:{symbol:{valType:"string",dflt:f.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:f.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:f.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:f.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:n({},p,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:a({},d,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:s.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:i({range:v,visible:n({},u.visible,{dflt:true}),tickmode:u.tickmode,nticks:u.nticks,tick0:u.tick0,dtick:u.dtick,tickvals:u.tickvals,ticktext:u.ticktext,ticks:n({},u.ticks,{dflt:"outside"}),ticklen:u.ticklen,tickwidth:u.tickwidth,tickcolor:u.tickcolor,showticklabels:u.showticklabels,tickfont:o({}),tickangle:u.tickangle,tickformat:u.tickformat,tickformatstops:u.tickformatstops,tickprefix:u.tickprefix,showtickprefix:u.showtickprefix,ticksuffix:u.ticksuffix,showticksuffix:u.showticksuffix,separatethousands:u.separatethousands,exponentformat:u.exponentformat,minexponent:u.minexponent,showexponent:u.showexponent,editType:"plot"},"plot"),steps:m,threshold:{line:{color:n({},d.line.color,{}),width:n({},d.line.width,{dflt:1}),editType:"plot"},thickness:n({},d.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:false},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":642,"../../constants/delta.js":747,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/cartesian/layout_attributes":842,"../../plots/domain":855,"../../plots/font_attributes":856}],1117:[function(e,t,r){"use strict";var n=e("../../plots/plots");r.name="indicator";r.plot=function(e,t,a,i){n.plotBasePlot(r.name,e,t,a,i)};r.clean=function(e,t,a,i){n.cleanBasePlot(r.name,e,t,a,i)}},{"../../plots/plots":891}],1118:[function(e,t,r){"use strict";function n(e,t){var r=[];var n=t.value;if(!(typeof t._lastValue==="number"))t._lastValue=t.value;var a=t._lastValue;var i=a;if(t._hasDelta&&typeof t.delta.reference==="number"){i=t.delta.reference}r[0]={y:n,lastY:a,delta:n-i,relativeDelta:(n-i)/i};return r}t.exports={calc:n}},{}],1119:[function(e,t,r){"use strict";t.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1120:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../../plots/domain").defaults;var o=e("../../plot_api/plot_template");var s=e("../../plots/array_container_defaults");var l=e("./constants.js");var u=e("../../plots/cartesian/tick_value_defaults");var c=e("../../plots/cartesian/tick_mark_defaults");var f=e("../../plots/cartesian/tick_label_defaults");function h(e,t,r,h){function d(r,i){return n.coerce(e,t,a,r,i)}i(t,h,d);d("mode");t._hasNumber=t.mode.indexOf("number")!==-1;t._hasDelta=t.mode.indexOf("delta")!==-1;t._hasGauge=t.mode.indexOf("gauge")!==-1;var v=d("value");t._range=[0,typeof v==="number"?1.5*v:1];var m=new Array(2);var g;if(t._hasNumber){d("number.valueformat");d("number.font.color",h.font.color);d("number.font.family",h.font.family);d("number.font.size");if(t.number.font.size===undefined){t.number.font.size=l.defaultNumberFontSize;m[0]=true}d("number.prefix");d("number.suffix");g=t.number.font.size}var y;if(t._hasDelta){d("delta.font.color",h.font.color);d("delta.font.family",h.font.family);d("delta.font.size");if(t.delta.font.size===undefined){t.delta.font.size=(t._hasNumber?.5:1)*(g||l.defaultNumberFontSize);m[1]=true}d("delta.reference",t.value);d("delta.relative");d("delta.valueformat",t.delta.relative?"2%":"");d("delta.increasing.symbol");d("delta.increasing.color");d("delta.decreasing.symbol");d("delta.decreasing.color");d("delta.position");y=t.delta.font.size}t._scaleNumbers=(!t._hasNumber||m[0])&&(!t._hasDelta||m[1])||false;d("title.font.color",h.font.color);d("title.font.family",h.font.family);d("title.font.size",.25*(g||y||l.defaultNumberFontSize));d("title.text");var x,_,b,w;function T(e,t){return n.coerce(x,_,a.gauge,e,t)}function k(e,t){return n.coerce(b,w,a.gauge.axis,e,t)}if(t._hasGauge){x=e.gauge;if(!x)x={};_=o.newContainer(t,"gauge");T("shape");var A=t._isBullet=t.gauge.shape==="bullet";if(!A){d("title.align","center")}var M=t._isAngular=t.gauge.shape==="angular";if(!M){d("align","center")}T("bgcolor",h.paper_bgcolor);T("borderwidth");T("bordercolor");T("bar.color");T("bar.line.color");T("bar.line.width");var E=l.valueThickness*(t.gauge.shape==="bullet"?.5:1);T("bar.thickness",E);s(x,_,{name:"steps",handleItemDefaults:p});T("threshold.value");T("threshold.thickness");T("threshold.line.width");T("threshold.line.color");b={};if(x)b=x.axis||{};w=o.newContainer(_,"axis");k("visible");t._range=k("range",t._range);var S={outerTicks:true};u(b,w,k,"linear");f(b,w,k,"linear",S);c(b,w,k,S)}else{d("title.align","center");d("align","center");t._isAngular=t._isBullet=false}t._length=null}function p(e,t){function r(r,i){return n.coerce(e,t,a.gauge.steps,r,i)}r("color");r("line.color");r("line.width");r("range");r("thickness")}t.exports={supplyDefaults:h}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_mark_defaults":850,"../../plots/cartesian/tick_value_defaults":851,"../../plots/domain":855,"./attributes":1116,"./constants.js":1119}],1121:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"indicator",basePlotModule:e("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:true,attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc").calc,plot:e("./plot"),meta:{}}},{"./attributes":1116,"./base_plot":1117,"./calc":1118,"./defaults":1120,"./plot":1122}],1122:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=a.strScale;var o=a.strTranslate;var s=a.rad2deg;var l=e("../../constants/alignment").MID_SHIFT;var u=e("../../components/drawing");var c=e("./constants");var f=e("../../lib/svg_text_utils");var h=e("../../plots/cartesian/axes");var p=e("../../plots/cartesian/axis_defaults");var d=e("../../plots/cartesian/position_defaults");var v=e("../../plots/cartesian/layout_attributes");var m=e("../../components/color");var g={left:"start",center:"middle",right:"end"};var y={left:0,center:.5,right:1};var x=/[yzafpnµmkMGTPEZY]/;function _(e){return e&&e.duration>0}t.exports=function e(t,r,i,s){var l=t._fullLayout;var h;if(_(i)){if(s){h=s()}}a.makeTraceGroups(l._indicatorlayer,r,"trace").each(function(e){var r=e[0];var a=r.trace;var s=n.select(this);var p=a._hasGauge;var d=a._isAngular;var v=a._isBullet;var m=a.domain;var x={w:l._size.w*(m.x[1]-m.x[0]),h:l._size.h*(m.y[1]-m.y[0]),l:l._size.l+l._size.w*m.x[0],r:l._size.r+l._size.w*(1-m.x[1]),t:l._size.t+l._size.h*(1-m.y[1]),b:l._size.b+l._size.h*m.y[0]};var _=x.l+x.w/2;var k=x.t+x.h/2;var A=Math.min(x.w/2,x.h);var M=c.innerRadius*A;var C,L,I;var O=a.align||"center";L=k;if(!p){C=x.l+y[O]*x.w;I=function(e){return E(e,x.w,x.h)}}else{if(d){C=_;L=k+A/2;I=function(e){return S(e,.9*M)}}if(v){var P=c.bulletPadding;var D=1-c.bulletNumberDomainSize+P;C=x.l+(D+(1-D)*y[O])*x.w;I=function(e){return E(e,(c.bulletNumberDomainSize-P)*x.w,x.h)}}}T(t,s,e,{numbersX:C,numbersY:L,numbersScaler:I,transitionOpts:i,onComplete:h});var R,z;if(p){R={range:a.gauge.axis.range,color:a.gauge.bgcolor,line:{color:a.gauge.bordercolor,width:0},thickness:1};z={range:a.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:a.gauge.bordercolor,width:a.gauge.borderwidth},thickness:1}}var N=s.selectAll("g.angular").data(d?e:[]);N.exit().remove();var F=s.selectAll("g.angularaxis").data(d?e:[]);F.exit().remove();if(d){w(t,s,e,{radius:A,innerRadius:M,gauge:N,layer:F,size:x,gaugeBg:R,gaugeOutline:z,transitionOpts:i,onComplete:h})}var B=s.selectAll("g.bullet").data(v?e:[]);B.exit().remove();var j=s.selectAll("g.bulletaxis").data(v?e:[]);j.exit().remove();if(v){b(t,s,e,{gauge:B,layer:j,size:x,gaugeBg:R,gaugeOutline:z,transitionOpts:i,onComplete:h})}var U=s.selectAll("text.title").data(e);U.exit().remove();U.enter().append("text").classed("title",true);U.attr("text-anchor",function(){return v?g.right:g[a.title.align]}).text(a.title.text).call(u.font,a.title.font).call(f.convertToTspans,t);U.attr("transform",function(){var e=x.l+x.w*y[a.title.align];var t;var r=c.titlePadding;var n=u.bBox(U.node());if(p){if(d){if(a.gauge.axis.visible){var i=u.bBox(F.node());t=i.top-r-n.bottom}else{t=x.t+x.h/2-A/2-n.bottom-r}}if(v){t=L-(n.top+n.bottom)/2;e=x.l-c.bulletPadding*x.w}}else{t=a._numbersTop-r-n.bottom}return o(e,t)})})};function b(e,t,r,n){var a=r[0].trace;var i=n.gauge;var s=n.layer;var l=n.gaugeBg;var u=n.gaugeOutline;var f=n.size;var p=a.domain;var d=n.transitionOpts;var v=n.onComplete;var g,y,x,b,w;i.enter().append("g").classed("bullet",true);i.attr("transform",o(f.l,f.t));s.enter().append("g").classed("bulletaxis",true).classed("crisp",true);s.selectAll("g."+"xbulletaxis"+"tick,path,text").remove();var T=f.h;var A=a.gauge.bar.thickness*T;var E=p.x[0];var S=p.x[0]+(p.x[1]-p.x[0])*(a._hasNumber||a._hasDelta?1-c.bulletNumberDomainSize:1);g=M(e,a.gauge.axis);g._id="xbulletaxis";g.domain=[E,S];g.setScale();y=h.calcTicks(g);x=h.makeTransTickFn(g);b=h.getTickSigns(g)[2];w=f.t+f.h;if(g.visible){h.drawTicks(e,g,{vals:g.ticks==="inside"?h.clipEnds(g,y):y,layer:s,path:h.makeTickPath(g,w,b),transFn:x});h.drawLabels(e,g,{vals:y,layer:s,transFn:x,labelFns:h.makeLabelFns(g,w)})}function C(e){e.attr("width",function(e){return Math.max(0,g.c2p(e.range[1])-g.c2p(e.range[0]))}).attr("x",function(e){return g.c2p(e.range[0])}).attr("y",function(e){return.5*(1-e.thickness)*T}).attr("height",function(e){return e.thickness*T})}var L=[l].concat(a.gauge.steps);var I=i.selectAll("g.bg-bullet").data(L);I.enter().append("g").classed("bg-bullet",true).append("rect");I.select("rect").call(C).call(k);I.exit().remove();var O=i.selectAll("g.value-bullet").data([a.gauge.bar]);O.enter().append("g").classed("value-bullet",true).append("rect");O.select("rect").attr("height",A).attr("y",(T-A)/2).call(k);if(_(d)){O.select("rect").transition().duration(d.duration).ease(d.easing).each("end",function(){v&&v()}).each("interrupt",function(){v&&v()}).attr("width",Math.max(0,g.c2p(Math.min(a.gauge.axis.range[1],r[0].y))))}else{O.select("rect").attr("width",typeof r[0].y==="number"?Math.max(0,g.c2p(Math.min(a.gauge.axis.range[1],r[0].y))):0)}O.exit().remove();var P=r.filter(function(){return a.gauge.threshold.value});var D=i.selectAll("g.threshold-bullet").data(P);D.enter().append("g").classed("threshold-bullet",true).append("line");D.select("line").attr("x1",g.c2p(a.gauge.threshold.value)).attr("x2",g.c2p(a.gauge.threshold.value)).attr("y1",(1-a.gauge.threshold.thickness)/2*T).attr("y2",(1-(1-a.gauge.threshold.thickness)/2)*T).call(m.stroke,a.gauge.threshold.line.color).style("stroke-width",a.gauge.threshold.line.width);D.exit().remove();var R=i.selectAll("g.gauge-outline").data([u]);R.enter().append("g").classed("gauge-outline",true).append("rect");R.select("rect").call(C).call(k);R.exit().remove()}function w(e,t,r,a){var i=r[0].trace;var u=a.size;var c=a.radius;var f=a.innerRadius;var p=a.gaugeBg;var d=a.gaugeOutline;var v=[u.l+u.w/2,u.t+u.h/2+c/2];var m=a.gauge;var g=a.layer;var y=a.transitionOpts;var x=a.onComplete;var b=Math.PI/2;function w(e){var t=i.gauge.axis.range[0];var r=i.gauge.axis.range[1];var n=(e-t)/(r-t)*Math.PI-b;if(n<-b)return-b;if(n>b)return b;return n}function T(e){return n.svg.arc().innerRadius((f+c)/2-e/2*(c-f)).outerRadius((f+c)/2+e/2*(c-f)).startAngle(-b)}function E(e){e.attr("d",function(e){return T(e.thickness).startAngle(w(e.range[0])).endAngle(w(e.range[1]))()})}var S,C,L,I;m.enter().append("g").classed("angular",true);m.attr("transform",o(v[0],v[1]));g.enter().append("g").classed("angularaxis",true).classed("crisp",true);g.selectAll("g."+"xangularaxis"+"tick,path,text").remove();S=M(e,i.gauge.axis);S.type="linear";S.range=i.gauge.axis.range;S._id="xangularaxis";S.setScale();var O=function(e){return(S.range[0]-e.x)/(S.range[1]-S.range[0])*Math.PI+Math.PI};var P={};var D=h.makeLabelFns(S,0);var R=D.labelStandoff;P.xFn=function(e){var t=O(e);return Math.cos(t)*R};P.yFn=function(e){var t=O(e);var r=Math.sin(t)>0?.2:1;return-Math.sin(t)*(R+e.fontSize*r)+Math.abs(Math.cos(t))*(e.fontSize*l)};P.anchorFn=function(e){var t=O(e);var r=Math.cos(t);return Math.abs(r)<.1?"middle":r>0?"start":"end"};P.heightFn=function(e,t,r){var n=O(e);return-.5*(1+Math.sin(n))*r};var z=function(e){return o(v[0]+c*Math.cos(e),v[1]-c*Math.sin(e))};L=function(e){return z(O(e))};var N=function(e){var t=O(e);return z(t)+"rotate("+-s(t)+")"};C=h.calcTicks(S);I=h.getTickSigns(S)[2];if(S.visible){I=S.ticks==="inside"?-1:1;var F=(S.linewidth||1)/2;h.drawTicks(e,S,{vals:C,layer:g,path:"M"+I*F+",0h"+I*S.ticklen,transFn:N});h.drawLabels(e,S,{vals:C,layer:g,transFn:L,labelFns:P})}var B=[p].concat(i.gauge.steps);var j=m.selectAll("g.bg-arc").data(B);j.enter().append("g").classed("bg-arc",true).append("path");j.select("path").call(E).call(k);j.exit().remove();var U=T(i.gauge.bar.thickness);var H=m.selectAll("g.value-arc").data([i.gauge.bar]);H.enter().append("g").classed("value-arc",true).append("path");var V=H.select("path");if(_(y)){V.transition().duration(y.duration).ease(y.easing).each("end",function(){x&&x()}).each("interrupt",function(){x&&x()}).attrTween("d",A(U,w(r[0].lastY),w(r[0].y)));i._lastValue=r[0].y}else{V.attr("d",typeof r[0].y==="number"?U.endAngle(w(r[0].y)):"M0,0Z")}V.call(k);H.exit().remove();B=[];var G=i.gauge.threshold.value;if(G){B.push({range:[G,G],color:i.gauge.threshold.color,line:{color:i.gauge.threshold.line.color,width:i.gauge.threshold.line.width},thickness:i.gauge.threshold.thickness})}var q=m.selectAll("g.threshold-arc").data(B);q.enter().append("g").classed("threshold-arc",true).append("path");q.select("path").call(E).call(k);q.exit().remove();var Y=m.selectAll("g.gauge-outline").data([d]);Y.enter().append("g").classed("gauge-outline",true).append("path");Y.select("path").call(E).call(k);Y.exit().remove()}function T(e,t,r,s){var l=r[0].trace;var c=s.numbersX;var p=s.numbersY;var d=l.align||"center";var v=g[d];var b=s.transitionOpts;var w=s.onComplete;var T=a.ensureSingle(t,"g","numbers");var k,A;var E;var S=[];if(l._hasNumber)S.push("number");if(l._hasDelta){S.push("delta");if(l.delta.position==="left")S.reverse()}var I=T.selectAll("text").data(S);I.enter().append("text");I.attr("text-anchor",function(){return v}).attr("class",function(e){return e}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null);I.exit().remove();function O(t,r,n,a){if(t.match("s")&&n>=0!==a>=0&&(!r(n).slice(-1).match(x)&&!r(a).slice(-1).match(x))){var i=t.slice().replace("s","f").replace(/\d+/,function(e){return parseInt(e)-1});var o=M(e,{tickformat:i});return function(e){if(Math.abs(e)<1)return h.tickText(o,e).text;return r(e)}}else{return r}}function P(){var t=M(e,{tickformat:l.number.valueformat},l._range);t.setScale();h.prepTicks(t);var a=function(e){return h.tickText(t,e).text};var i=l.number.suffix;var o=l.number.prefix;var s=T.select("text.number");function c(){var t=typeof r[0].y==="number"?o+a(r[0].y)+i:"-";s.text(t).call(u.font,l.number.font).call(f.convertToTspans,e)}if(_(b)){s.transition().duration(b.duration).ease(b.easing).each("end",function(){c();w&&w()}).each("interrupt",function(){c();w&&w()}).attrTween("text",function(){var e=n.select(this);var t=n.interpolateNumber(r[0].lastY,r[0].y);l._lastValue=r[0].y;var s=O(l.number.valueformat,a,r[0].lastY,r[0].y);return function(r){e.text(o+s(t(r))+i)}})}else{c()}k=C(o+a(r[0].y)+i,l.number.font,v,e);return s}function D(){var t=M(e,{tickformat:l.delta.valueformat},l._range);t.setScale();h.prepTicks(t);var a=function(e){return h.tickText(t,e).text};var i=function(e){var t=l.delta.relative?e.relativeDelta:e.delta;return t};var o=function(e,t){if(e===0||typeof e!=="number"||isNaN(e))return"-";return(e>0?l.delta.increasing.symbol:l.delta.decreasing.symbol)+t(e)};var s=function(e){return e.delta>=0?l.delta.increasing.color:l.delta.decreasing.color};if(l._deltaLastValue===undefined){l._deltaLastValue=i(r[0])}var c=T.select("text.delta");c.call(u.font,l.delta.font).call(m.fill,s({delta:l._deltaLastValue}));function p(){c.text(o(i(r[0]),a)).call(m.fill,s(r[0])).call(f.convertToTspans,e)}if(_(b)){c.transition().duration(b.duration).ease(b.easing).tween("text",function(){var e=n.select(this);var t=i(r[0]);var u=l._deltaLastValue;var c=O(l.delta.valueformat,a,u,t);var f=n.interpolateNumber(u,t);l._deltaLastValue=t;return function(t){e.text(o(f(t),c));e.call(m.fill,s({delta:f(t)}))}}).each("end",function(){p();w&&w()}).each("interrupt",function(){p();w&&w()})}else{p()}A=C(o(i(r[0]),a),l.delta.font,v,e);return c}var R=l.mode+l.align;var z;if(l._hasDelta){z=D();R+=l.delta.position+l.delta.font.size+l.delta.font.family+l.delta.valueformat;R+=l.delta.increasing.symbol+l.delta.decreasing.symbol;E=A}if(l._hasNumber){P();R+=l.number.font.size+l.number.font.family+l.number.valueformat+l.number.suffix+l.number.prefix;E=k}if(l._hasDelta&&l._hasNumber){var N=[(k.left+k.right)/2,(k.top+k.bottom)/2];var F=[(A.left+A.right)/2,(A.top+A.bottom)/2];var B,j;var U=.75*l.delta.font.size;if(l.delta.position==="left"){B=L(l,"deltaPos",0,-1*(k.width*y[l.align]+A.width*(1-y[l.align])+U),R,Math.min);j=N[1]-F[1];E={width:k.width+A.width+U,height:Math.max(k.height,A.height),left:A.left+B,right:k.right,top:Math.min(k.top,A.top+j),bottom:Math.max(k.bottom,A.bottom+j)}}if(l.delta.position==="right"){B=L(l,"deltaPos",0,k.width*(1-y[l.align])+A.width*y[l.align]+U,R,Math.max);j=N[1]-F[1];E={width:k.width+A.width+U,height:Math.max(k.height,A.height),left:k.left,right:A.right+B,top:Math.min(k.top,A.top+j),bottom:Math.max(k.bottom,A.bottom+j)}}if(l.delta.position==="bottom"){B=null;j=A.height;E={width:Math.max(k.width,A.width),height:k.height+A.height,left:Math.min(k.left,A.left),right:Math.max(k.right,A.right),top:k.bottom-k.height,bottom:k.bottom+A.height}}if(l.delta.position==="top"){B=null;j=k.top;E={width:Math.max(k.width,A.width),height:k.height+A.height,left:Math.min(k.left,A.left),right:Math.max(k.right,A.right),top:k.bottom-k.height-A.height,bottom:k.bottom}}z.attr({dx:B,dy:j})}if(l._hasNumber||l._hasDelta){T.attr("transform",function(){var e=s.numbersScaler(E);R+=e[2];var t=L(l,"numbersScale",1,e[0],R,Math.min);var r;if(!l._scaleNumbers)t=1;if(l._isAngular){r=p-t*E.bottom}else{r=p-t*(E.top+E.bottom)/2}l._numbersTop=t*E.top+r;var n=E[d];if(d==="center")n=(E.left+E.right)/2;var a=c-t*n;a=L(l,"numbersTranslate",0,a,R,Math.max);return o(a,r)+i(t)})}}function k(e){e.each(function(e){m.stroke(n.select(this),e.line.color)}).each(function(e){m.fill(n.select(this),e.color)}).style("stroke-width",function(e){return e.line.width})}function A(e,t,r){return function(){var a=n.interpolate(t,r);return function(t){return e.endAngle(a(t))()}}}function M(e,t,r){var n=e._fullLayout;var i=a.extendFlat({type:"linear",ticks:"outside",range:r,showline:true},t);var o={type:"linear",_id:"x"+t._id};var s={letter:"x",font:n.font,noHover:true,noTickson:true};function l(e,t){return a.coerce(i,o,v,e,t)}p(i,o,l,s,n);d(i,o,l,s);return o}function E(e,t,r){var n=Math.min(t/e.width,r/e.height);return[n,e,t+"x"+r]}function S(e,t){var r=Math.sqrt(e.width/2*(e.width/2)+e.height*e.height);var n=t/r;return[n,e,t]}function C(e,t,r,a){var i=document.createElementNS("http://www.w3.org/2000/svg","text");var o=n.select(i);o.text(e).attr("x",0).attr("y",0).attr("text-anchor",r).attr("data-unformatted",e).call(f.convertToTspans,a).call(u.font,t);return u.bBox(o.node())}function L(e,t,r,n,i,o){var s="_cache"+t;if(!(e[s]&&e[s].key===i)){e[s]={key:i,value:r}}var l=a.aggNums(o,null,[e[s].value,n],2);e[s].value=l;return l}},{"../../components/color":643,"../../components/drawing":665,"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_defaults":830,"../../plots/cartesian/layout_attributes":842,"../../plots/cartesian/position_defaults":845,"./constants":1119,d3:169}],1123:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../mesh3d/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/edit_types").overrideAll;function u(e){return{show:{valType:"boolean",dflt:false},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function c(e){return{show:{valType:"boolean",dflt:true},fill:{valType:"number",min:0,max:1,dflt:1}}}var f=t.exports=l(s({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:true},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:false},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:u("x"),y:u("y"),z:u("z")},caps:{x:c("x"),y:c("y"),z:c("z")},text:{valType:"string",dflt:"",arrayOk:true},hovertext:{valType:"string",dflt:"",arrayOk:true},hovertemplate:a(),showlegend:s({},o.showlegend,{dflt:false})},n("",{colorAttr:"`value`",showScaleDflt:true,editTypeOverride:"calc"}),{opacity:i.opacity,lightposition:i.lightposition,lighting:i.lighting,flatshading:i.flatshading,contour:i.contour,hoverinfo:s({},o.hoverinfo)}),"calc","nested");f.flatshading.dflt=true;f.lighting.facenormalsepsilon.dflt=0;f.x.editType=f.y.editType=f.z.editType=f.value.editType="calc+clearAxisTypes";f.transforms=undefined},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1124:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");var a=e("../streamtube/calc").processGrid;var i=e("../streamtube/calc").filter;t.exports=function e(t,r){r._len=Math.min(r.x.length,r.y.length,r.z.length,r.value.length);r._x=i(r.x,r._len);r._y=i(r.y,r._len);r._z=i(r.z,r._len);r._value=i(r.value,r._len);var o=a(r);r._gridFill=o.fill;r._Xs=o.Xs;r._Ys=o.Ys;r._Zs=o.Zs;r._len=o.len;var s=Infinity;var l=-Infinity;for(var u=0;u<r._len;u++){var c=r._value[u];s=Math.min(s,c);l=Math.max(l,c)}r._minValues=s;r._maxValues=l;r._vMin=r.isomin===undefined||r.isomin===null?s:r.isomin;r._vMax=r.isomax===undefined||r.isomin===null?l:r.isomax;n(t,r,{vals:[r._vMin,r._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651,"../streamtube/calc":1295}],1125:[function(e,t,r){"use strict";var n=e("gl-mesh3d");var a=e("../../lib/gl_format_color").parseColorScale;var i=e("../../lib/str2rgbarray");var o=e("../../components/colorscale").extractOpts;var s=e("../../plots/gl3d/zip3");var l=function(e,t){for(var r=t.length-1;r>0;r--){var n=Math.min(t[r],t[r-1]);var a=Math.max(t[r],t[r-1]);if(a>n&&n<e&&e<=a){return{id:r,distRatio:(a-e)/(a-n)}}}return{id:0,distRatio:0}};function u(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.data=null;this.showContour=false}var c=u.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index;var r=this.data._meshX[t];var n=this.data._meshY[t];var a=this.data._meshZ[t];var i=this.data._Ys.length;var o=this.data._Zs.length;var s=l(r,this.data._Xs).id;var u=l(n,this.data._Ys).id;var c=l(a,this.data._Zs).id;var f=e.index=c+o*u+o*i*s;e.traceCoordinate=[this.data._meshX[f],this.data._meshY[f],this.data._meshZ[f],this.data._value[f]];var h=this.data.hovertext||this.data.text;if(Array.isArray(h)&&h[f]!==undefined){e.textLabel=h[f]}else if(h){e.textLabel=h}return true}};c.update=function(e){var t=this.scene;var r=t.fullSceneLayout;this.data=h(e);function n(e,t,r,n){return t.map(function(t){return e.d2l(t,0,n)*r})}var l=s(n(r.xaxis,e._meshX,t.dataScale[0],e.xcalendar),n(r.yaxis,e._meshY,t.dataScale[1],e.ycalendar),n(r.zaxis,e._meshZ,t.dataScale[2],e.zcalendar));var u=s(e._meshI,e._meshJ,e._meshK);var c={positions:l,cells:u,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:i(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};var f=o(e);c.vertexIntensity=e._meshIntensity;c.vertexIntensityBounds=[f.min,f.max];c.colormap=a(e);this.mesh.update(c)};c.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};var f=["xyz","xzy","yxz","yzx","zxy","zyx"];function h(e){e._meshI=[];e._meshJ=[];e._meshK=[];var t=e.surface.show;var r=e.spaceframe.show;var n=e.surface.fill;var a=e.spaceframe.fill;var i=false;var o=false;var s=0;var u;var c;var h=e._Xs;var p=e._Ys;var d=e._Zs;var v=h.length;var m=p.length;var g=d.length;var y=f.indexOf(e._gridFill.replace(/-/g,"").replace(/\+/g,""));var x=function(e,t,r){switch(y){case 5:return r+g*t+g*m*e;case 4:return r+g*e+g*v*t;case 3:return t+m*r+m*g*e;case 2:return t+m*e+m*v*r;case 1:return e+v*r+v*g*t;default:return e+v*t+v*m*r}};var _=e._minValues;var b=e._maxValues;var w=e._vMin;var T=e._vMax;var k;var A;var M;var E;function S(e,t,r){var n=E.length;for(var a=c;a<n;a++){if(e===k[a]&&t===A[a]&&r===M[a]){return a}}return-1}function C(){c=u}function L(){k=[];A=[];M=[];E=[];u=0;C()}function I(e,t,r,n){k.push(e);A.push(t);M.push(r);E.push(n);u++;return u-1}function O(t,r,n){e._meshI.push(t);e._meshJ.push(r);e._meshK.push(n);s++;return s-1}function P(e,t,r){var n=[];for(var a=0;a<e.length;a++){n[a]=(e[a]+t[a]+r[a])/3}return n}function D(e,t,r){var n=[];for(var a=0;a<e.length;a++){n[a]=e[a]*(1-r)+r*t[a]}return n}var R;function z(e){R=e}function N(e,t){var r=e[0];var n=e[1];var a=e[2];var i=P(r,n,a);var o=Math.sqrt(1-R);var s=D(i,r,o);var l=D(i,n,o);var u=D(i,a,o);var c=t[0];var f=t[1];var h=t[2];return{xyzv:[[r,n,l],[l,s,r],[n,a,u],[u,l,n],[a,r,s],[s,u,a]],abc:[[c,f,-1],[-1,-1,c],[f,h,-1],[-1,-1,f],[h,c,-1],[-1,-1,h]]}}function F(e,t){if(e==="all"||e===null)return true;return e.indexOf(t)>-1}function B(e,t){if(e===null)return t;return e}function j(e,t,r){C();var n=[t];var a=[r];if(R>=1){n=[t];a=[r]}else if(R>0){var i=N(t,r);n=i.xyzv;a=i.abc}for(var o=0;o<n.length;o++){t=n[o];r=a[o];var s=[];for(var l=0;l<3;l++){var u=t[l][0];var c=t[l][1];var f=t[l][2];var h=t[l][3];var p=r[l]>-1?r[l]:S(u,c,f);if(p>-1){s[l]=p}else{s[l]=I(u,c,f,B(e,h))}}O(s[0],s[1],s[2])}}function U(e,t,r){var n=function(n,a,i){j(e,[t[n],t[a],t[i]],[r[n],r[a],r[i]])};n(0,1,2);n(2,3,0)}function H(e,t,r){var n=function(n,a,i){j(e,[t[n],t[a],t[i]],[r[n],r[a],r[i]])};n(0,1,2);n(3,0,1);n(2,3,0);n(1,2,3)}function V(e,t,r,n){var a=e[3];if(a<r)a=r;if(a>n)a=n;var i=(e[3]-a)/(e[3]-t[3]+1e-9);var o=[];for(var s=0;s<4;s++){o[s]=(1-i)*e[s]+i*t[s]}return o}function G(e,t,r){return e>=t&&e<=r}function q(e){var t=.001*(T-w);return e>=w-t&&e<=T+t}function Y(t){var r=[];for(var n=0;n<4;n++){var a=t[n];r.push([e._x[a],e._y[a],e._z[a],e._value[a]])}return r}var W=3;function X(e,t,r,n,a,i){if(!i)i=1;r=[-1,-1,-1];var o=false;var s=[G(t[0][3],n,a),G(t[1][3],n,a),G(t[2][3],n,a)];if(!s[0]&&!s[1]&&!s[2]){return false}var l=function(e,t,r){if(q(t[0][3])&&q(t[1][3])&&q(t[2][3])){j(e,t,r);return true}else if(i<W){return X(e,t,r,w,T,++i)}return false};if(s[0]&&s[1]&&s[2]){return l(e,t,r)||o}var u=false;[[0,1,2],[2,0,1],[1,2,0]].forEach(function(i){if(s[i[0]]&&s[i[1]]&&!s[i[2]]){var c=t[i[0]];var f=t[i[1]];var h=t[i[2]];var p=V(h,c,n,a);var d=V(h,f,n,a);o=l(e,[d,p,c],[-1,-1,r[i[0]]])||o;o=l(e,[c,f,d],[r[i[0]],r[i[1]],-1])||o;u=true}});if(u)return o;[[0,1,2],[1,2,0],[2,0,1]].forEach(function(i){if(s[i[0]]&&!s[i[1]]&&!s[i[2]]){var c=t[i[0]];var f=t[i[1]];var h=t[i[2]];var p=V(f,c,n,a);var d=V(h,c,n,a);o=l(e,[d,p,c],[-1,-1,r[i[0]]])||o;u=true}});return o}function Z(e,t,r,n){var a=false;var i=Y(t);var s=[G(i[0][3],r,n),G(i[1][3],r,n),G(i[2][3],r,n),G(i[3][3],r,n)];if(!s[0]&&!s[1]&&!s[2]&&!s[3]){return a}if(s[0]&&s[1]&&s[2]&&s[3]){if(o){a=H(e,i,t)||a}return a}var l=false;[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(u){if(s[u[0]]&&s[u[1]]&&s[u[2]]&&!s[u[3]]){var c=i[u[0]];var f=i[u[1]];var h=i[u[2]];var p=i[u[3]];if(o){a=j(e,[c,f,h],[t[u[0]],t[u[1]],t[u[2]]])||a}else{var d=V(p,c,r,n);var v=V(p,f,r,n);var m=V(p,h,r,n);a=j(null,[d,v,m],[-1,-1,-1])||a}l=true}});if(l)return a;[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(u){if(s[u[0]]&&s[u[1]]&&!s[u[2]]&&!s[u[3]]){var c=i[u[0]];var f=i[u[1]];var h=i[u[2]];var p=i[u[3]];var d=V(h,c,r,n);var v=V(h,f,r,n);var m=V(p,f,r,n);var g=V(p,c,r,n);if(o){a=j(e,[c,g,d],[t[u[0]],-1,-1])||a;a=j(e,[f,v,m],[t[u[1]],-1,-1])||a}else{a=U(null,[d,v,m,g],[-1,-1,-1,-1])||a}l=true}});if(l)return a;[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(u){if(s[u[0]]&&!s[u[1]]&&!s[u[2]]&&!s[u[3]]){var c=i[u[0]];var f=i[u[1]];var h=i[u[2]];var p=i[u[3]];var d=V(f,c,r,n);var v=V(h,c,r,n);var m=V(p,c,r,n);if(o){a=j(e,[c,d,v],[t[u[0]],-1,-1])||a;a=j(e,[c,v,m],[t[u[0]],-1,-1])||a;a=j(e,[c,m,d],[t[u[0]],-1,-1])||a}else{a=j(null,[d,v,m],[-1,-1,-1])||a}l=true}});return a}function K(e,t,r,n,a,s,l,u,c,f,h){var p=false;if(i){if(F(e,"A")){p=Z(null,[t,r,n,s],f,h)||p}if(F(e,"B")){p=Z(null,[r,n,a,c],f,h)||p}if(F(e,"C")){p=Z(null,[r,s,l,c],f,h)||p}if(F(e,"D")){p=Z(null,[n,s,u,c],f,h)||p}if(F(e,"E")){p=Z(null,[r,n,s,c],f,h)||p}}if(o){p=Z(e,[r,n,s,c],f,h)||p}return p}function J(e,t,r,n,a,i,o,s){return[s[0]===true?true:X(e,Y([t,r,n]),[t,r,n],i,o),s[1]===true?true:X(e,Y([n,a,t]),[n,a,t],i,o)]}function Q(e,t,r,n,a,i,o,s,l){if(s){return J(e,t,r,a,n,i,o,l)}else{return J(e,r,a,n,t,i,o,l)}}function $(e,t,r,n,a,i,o){var s=false;var l,u,c,f;var h=function(){s=X(e,[l,u,c],[-1,-1,-1],a,i)||s;s=X(e,[c,f,l],[-1,-1,-1],a,i)||s};var p=o[0];var d=o[1];var v=o[2];if(p){l=D(Y([x(t,r-0,n-0)])[0],Y([x(t-1,r-0,n-0)])[0],p);u=D(Y([x(t,r-0,n-1)])[0],Y([x(t-1,r-0,n-1)])[0],p);c=D(Y([x(t,r-1,n-1)])[0],Y([x(t-1,r-1,n-1)])[0],p);f=D(Y([x(t,r-1,n-0)])[0],Y([x(t-1,r-1,n-0)])[0],p);h()}if(d){l=D(Y([x(t-0,r,n-0)])[0],Y([x(t-0,r-1,n-0)])[0],d);u=D(Y([x(t-0,r,n-1)])[0],Y([x(t-0,r-1,n-1)])[0],d);c=D(Y([x(t-1,r,n-1)])[0],Y([x(t-1,r-1,n-1)])[0],d);f=D(Y([x(t-1,r,n-0)])[0],Y([x(t-1,r-1,n-0)])[0],d);h()}if(v){l=D(Y([x(t-0,r-0,n)])[0],Y([x(t-0,r-0,n-1)])[0],v);u=D(Y([x(t-0,r-1,n)])[0],Y([x(t-0,r-1,n-1)])[0],v);c=D(Y([x(t-1,r-1,n)])[0],Y([x(t-1,r-1,n-1)])[0],v);f=D(Y([x(t-1,r-0,n)])[0],Y([x(t-1,r-0,n-1)])[0],v);h()}return s}function ee(e,t,r,n,a,o,s,l,u,c,f,h){var p=e;if(h){if(i&&e==="even")p=null;return K(p,t,r,n,a,o,s,l,u,c,f)}else{if(i&&e==="odd")p=null;return K(p,u,l,s,o,a,n,r,t,c,f)}}function te(e,t,r,n,a){var i=[];var o=0;for(var s=0;s<t.length;s++){var l=t[s];for(var u=1;u<g;u++){for(var c=1;c<m;c++){i.push(Q(e,x(l,c-1,u-1),x(l,c-1,u),x(l,c,u-1),x(l,c,u),r,n,(l+c+u)%2,a&&a[o]?a[o]:[]));o++}}}return i}function re(e,t,r,n,a){var i=[];var o=0;for(var s=0;s<t.length;s++){var l=t[s];for(var u=1;u<v;u++){for(var c=1;c<g;c++){i.push(Q(e,x(u-1,l,c-1),x(u,l,c-1),x(u-1,l,c),x(u,l,c),r,n,(u+l+c)%2,a&&a[o]?a[o]:[]));o++}}}return i}function ne(e,t,r,n,a){var i=[];var o=0;for(var s=0;s<t.length;s++){var l=t[s];for(var u=1;u<m;u++){for(var c=1;c<v;c++){i.push(Q(e,x(c-1,u-1,l),x(c-1,u,l),x(c,u-1,l),x(c,u,l),r,n,(c+u+l)%2,a&&a[o]?a[o]:[]));o++}}}return i}function ae(e,t,r){for(var n=1;n<g;n++){for(var a=1;a<m;a++){for(var i=1;i<v;i++){ee(e,x(i-1,a-1,n-1),x(i-1,a-1,n),x(i-1,a,n-1),x(i-1,a,n),x(i,a-1,n-1),x(i,a-1,n),x(i,a,n-1),x(i,a,n),t,r,(i+a+n)%2)}}}}function ie(e,t,r){o=true;ae(e,t,r);o=false}function oe(e,t,r){i=true;ae(e,t,r);i=false}function se(e,t,r,n,a,i){var o=[];var s=0;for(var l=0;l<t.length;l++){var u=t[l];for(var c=1;c<g;c++){for(var f=1;f<m;f++){o.push($(e,u,f,c,r,n,a[l],i&&i[s]?i[s]:[]));s++}}}return o}function le(e,t,r,n,a,i){var o=[];var s=0;for(var l=0;l<t.length;l++){var u=t[l];for(var c=1;c<v;c++){for(var f=1;f<g;f++){o.push($(e,c,u,f,r,n,a[l],i&&i[s]?i[s]:[]));s++}}}return o}function ue(e,t,r,n,a,i){var o=[];var s=0;for(var l=0;l<t.length;l++){var u=t[l];for(var c=1;c<m;c++){for(var f=1;f<v;f++){o.push($(e,f,c,u,r,n,a[l],i&&i[s]?i[s]:[]));s++}}}return o}function ce(e,t){var r=[];for(var n=e;n<t;n++){r.push(n)}return r}function fe(){for(var t=0;t<v;t++){for(var r=0;r<m;r++){for(var n=0;n<g;n++){var a=x(t,r,n);I(e._x[a],e._y[a],e._z[a],e._value[a])}}}}function he(){L();fe();var i=null;if(r&&a){z(a);ie(i,w,T)}if(t&&n){z(n);var o=e.surface.pattern;var u=e.surface.count;for(var c=0;c<u;c++){var f=u===1?.5:c/(u-1);var y=(1-f)*w+f*T;var x=Math.abs(y-_);var S=Math.abs(y-b);var C=x>S?[_,y]:[y,b];oe(o,C[0],C[1])}}var I=[[Math.min(w,b),Math.max(w,b)],[Math.min(_,T),Math.max(_,T)]];["x","y","z"].forEach(function(t){var r=[];for(var n=0;n<I.length;n++){var a=0;var o=I[n][0];var s=I[n][1];var u=e.slices[t];if(u.show&&u.fill){z(u.fill);var c=[];var f=[];var y=[];if(u.locations.length){for(var x=0;x<u.locations.length;x++){var _=l(u.locations[x],t==="x"?h:t==="y"?p:d);if(_.distRatio===0){c.push(_.id)}else if(_.id>0){f.push(_.id);if(t==="x"){y.push([_.distRatio,0,0])}else if(t==="y"){y.push([0,_.distRatio,0])}else{y.push([0,0,_.distRatio])}}}}else{if(t==="x"){c=ce(1,v-1)}else if(t==="y"){c=ce(1,m-1)}else{c=ce(1,g-1)}}if(f.length>0){if(t==="x"){r[a]=se(i,f,o,s,y,r[a])}else if(t==="y"){r[a]=le(i,f,o,s,y,r[a])}else{r[a]=ue(i,f,o,s,y,r[a])}a++}if(c.length>0){if(t==="x"){r[a]=te(i,c,o,s,r[a])}else if(t==="y"){r[a]=re(i,c,o,s,r[a])}else{r[a]=ne(i,c,o,s,r[a])}a++}}var b=e.caps[t];if(b.show&&b.fill){z(b.fill);if(t==="x"){r[a]=te(i,[0,v-1],o,s,r[a])}else if(t==="y"){r[a]=re(i,[0,m-1],o,s,r[a])}else{r[a]=ne(i,[0,g-1],o,s,r[a])}a++}}});if(s===0){L()}e._meshX=k;e._meshY=A;e._meshZ=M;e._meshIntensity=E;e._Xs=h;e._Ys=p;e._Zs=d}he();return e}function p(e,t){var r=e.glplot.gl;var a=n({gl:r});var i=new u(e,a,t.uid);a._trace=i;i.update(t);e.glplot.add(a);return i}t.exports={findNearestOnAxis:l,generateIsoMeshes:h,createIsosurfaceTrace:p}},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"gl-mesh3d":309}],1126:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");var i=e("./attributes");var o=e("../../components/colorscale/defaults");function s(e,t,r,a){function o(r,a){return n.coerce(e,t,i,r,a)}l(e,t,r,a,o)}function l(e,t,r,n,i){var s=i("isomin");var l=i("isomax");if(l!==undefined&&l!==null&&s!==undefined&&s!==null&&s>l){t.isomin=null;t.isomax=null}var u=i("x");var c=i("y");var f=i("z");var h=i("value");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length){t.visible=false;return}var p=a.getComponentMethod("calendars","handleTraceDefaults");p(e,t,["x","y","z"],n);["x","y","z"].forEach(function(e){var t="caps."+e;var r=i(t+".show");if(r){i(t+".fill")}var n="slices."+e;var a=i(n+".show");if(a){i(n+".fill");i(n+".locations")}});var d=i("spaceframe.show");if(d){i("spaceframe.fill")}var v=i("surface.show");if(v){i("surface.count");i("surface.fill");i("surface.pattern")}var m=i("contour.show");if(m){i("contour.color");i("contour.width")}["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(e){i(e)});o(e,t,n,i,{prefix:"",cLetter:"c"});t._length=null}t.exports={supplyDefaults:s,supplyIsoDefaults:l}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1123}],1127:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1123,"./calc":1124,"./convert":1125,"./defaults":1126}],1128:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../surface/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;t.exports=s({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertemplate:a({editType:"calc"}),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:undefined},n("",{colorAttr:"`intensity`",showScaleDflt:true,editTypeOverride:"calc"}),{opacity:i.opacity,flatshading:{valType:"boolean",dflt:false,editType:"calc"},contour:{show:s({},i.contours.x.show,{}),color:i.contours.x.color,width:i.contours.x.width,editType:"calc"},lightposition:{x:s({},i.lightposition.x,{dflt:1e5}),y:s({},i.lightposition.y,{dflt:1e5}),z:s({},i.lightposition.z,{dflt:0}),editType:"calc"},lighting:s({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},i.lighting),hoverinfo:s({},o.hoverinfo,{editType:"calc"}),showlegend:s({},o.showlegend,{dflt:false})})},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../surface/attributes":1311}],1129:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){if(r.intensity){n(t,r,{vals:r.intensity,containerStr:"",cLetter:"c"})}}},{"../../components/colorscale/calc":651}],1130:[function(e,t,r){"use strict";var n=e("gl-mesh3d");var a=e("delaunay-triangulate");var i=e("alpha-shape");var o=e("convex-hull");var s=e("../../lib/gl_format_color").parseColorScale;var l=e("../../lib/str2rgbarray");var u=e("../../components/colorscale").extractOpts;var c=e("../../plots/gl3d/zip3");function f(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.color="#fff";this.data=null;this.showContour=false}var h=f.prototype;h.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;if(e.data._cellCenter){e.traceCoordinate=e.data.dataCoordinate}else{e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]]}var r=this.data.hovertext||this.data.text;if(Array.isArray(r)&&r[t]!==undefined){e.textLabel=r[t]}else if(r){e.textLabel=r}return true}};function p(e){var t=[];var r=e.length;for(var n=0;n<r;n++){t[n]=l(e[n])}return t}function d(e,t,r,n){var a=[];var i=t.length;for(var o=0;o<i;o++){a[o]=e.d2l(t[o],0,n)*r}return a}function v(e){var t=[];var r=e.length;for(var n=0;n<r;n++){t[n]=Math.round(e[n])}return t}function m(e,t){var r=["x","y","z"].indexOf(e);var n=[];var i=t.length;for(var o=0;o<i;o++){n[o]=[t[o][(r+1)%3],t[o][(r+2)%3]]}return a(n)}function g(e,t){var r=e.length;for(var n=0;n<r;n++){if(e[n]<=-.5||e[n]>=t-.5){return false}}return true}h.update=function(e){var t=this.scene;var r=t.fullSceneLayout;this.data=e;var n=e.x.length;var a=c(d(r.xaxis,e.x,t.dataScale[0],e.xcalendar),d(r.yaxis,e.y,t.dataScale[1],e.ycalendar),d(r.zaxis,e.z,t.dataScale[2],e.zcalendar));var f;if(e.i&&e.j&&e.k){if(e.i.length!==e.j.length||e.j.length!==e.k.length||!g(e.i,n)||!g(e.j,n)||!g(e.k,n)){return}f=c(v(e.i),v(e.j),v(e.k))}else if(e.alphahull===0){f=o(a)}else if(e.alphahull>0){f=i(e.alphahull,a)}else{f=m(e.delaunayaxis,a)}var h={positions:a,cells:f,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:l(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};if(e.intensity){var y=u(e);this.color="#fff";var x=e.intensitymode;h[x+"Intensity"]=e.intensity;h[x+"IntensityBounds"]=[y.min,y.max];h.colormap=s(e)}else if(e.vertexcolor){this.color=e.vertexcolor[0];h.vertexColors=p(e.vertexcolor)}else if(e.facecolor){this.color=e.facecolor[0];h.cellColors=p(e.facecolor)}else{this.color=e.color;h.meshColor=l(e.color)}this.mesh.update(h)};h.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function y(e,t){var r=e.glplot.gl;var a=n({gl:r});var i=new f(e,a,t.uid);a._trace=i;i.update(t);e.glplot.add(a);return i}t.exports=y},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"alpha-shape":69,"convex-hull":135,"delaunay-triangulate":171,"gl-mesh3d":309}],1131:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../../components/colorscale/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,n){return a.coerce(t,r,o,e,n)}function c(e){var t=e.map(function(e){var t=u(e);if(t&&a.isArrayOrTypedArray(t))return t;return null});return t.every(function(e){return e&&e.length===t[0].length})&&t}var f=c(["x","y","z"]);if(!f){r.visible=false;return}c(["i","j","k"]);if(r.i&&(!r.j||!r.k)||r.j&&(!r.k||!r.i)||r.k&&(!r.i||!r.j)){r.visible=false;return}var h=n.getComponentMethod("calendars","handleTraceDefaults");h(t,r,["x","y","z"],l);["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(e){u(e)});var p=u("contour.show");if(p){u("contour.color");u("contour.width")}if("intensity"in t){u("intensity");u("intensitymode");i(t,r,l,u,{prefix:"",cLetter:"c"})}else{r.showscale=false;if("facecolor"in t)u("facecolor");else if("vertexcolor"in t)u("vertexcolor");else u("color",s)}u("text");u("hovertext");u("hovertemplate");r._length=null}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1128}],1132:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1128,"./calc":1129,"./convert":1130,"./defaults":1131}],1133:[function(e,t,r){"use strict";var n=e("../../lib").extendFlat;var a=e("../scatter/attributes");var i=e("../../components/drawing/attributes").dash;var o=e("../../components/fx/attributes");var s=e("../../constants/delta.js");var l=s.INCREASING.COLOR;var u=s.DECREASING.COLOR;var c=a.line;function f(e){return{line:{color:n({},c.color,{dflt:e}),width:c.width,dash:i,editType:"style"},editType:"style"}}t.exports={xperiod:a.xperiod,xperiod0:a.xperiod0,xperiodalignment:a.xperiodalignment,x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:n({},c.width,{}),dash:n({},i,{}),editType:"style"},increasing:f(l),decreasing:f(u),text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:n({},o.hoverlabel,{split:{valType:"boolean",dflt:false,editType:"style"}})}},{"../../components/drawing/attributes":664,"../../components/fx/attributes":674,"../../constants/delta.js":747,"../../lib":778,"../scatter/attributes":1187}],1134:[function(e,t,r){"use strict";var n=e("../../lib");var a=n._;var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/align_period");var s=e("../../constants/numerical").BADNUM;function l(e,t){var r=i.getFromId(e,t.xaxis);var a=i.getFromId(e,t.yaxis);var o=f(e,r,t);var s=t._minDiff;t._minDiff=null;var l=t._origX;t._origX=null;var h=t._xcalc;t._xcalc=null;var p=c(e,t,l,h,a,u);t._extremes[r._id]=i.findExtremes(r,h,{vpad:s/2});if(p.length){n.extendFlat(p[0].t,{wHover:s/2,tickLen:o});return p}else{return[{t:{empty:true}}]}}function u(e,t,r,n){return{o:e,h:t,l:r,c:n}}function c(e,t,r,o,l,u){var c=l.makeCalcdata(t,"open");var f=l.makeCalcdata(t,"high");var h=l.makeCalcdata(t,"low");var p=l.makeCalcdata(t,"close");var d=Array.isArray(t.text);var v=Array.isArray(t.hovertext);var m=true;var g=null;var y=!!t.xperiodalignment;var x=[];for(var _=0;_<o.length;_++){var b=o[_];var w=c[_];var T=f[_];var k=h[_];var A=p[_];if(b!==s&&w!==s&&T!==s&&k!==s&&A!==s){if(A===w){if(g!==null&&A!==g)m=A>g}else m=A>w;g=A;var M=u(w,T,k,A);M.pos=b;M.yc=(w+A)/2;M.i=_;M.dir=m?"increasing":"decreasing";M.x=M.pos;M.y=[k,T];if(y)M.orig_p=r[_];if(d)M.tx=t.text[_];if(v)M.htx=t.hovertext[_];x.push(M)}else{x.push({pos:b,empty:true})}}t._extremes[l._id]=i.findExtremes(l,n.concat(h,f),{padded:true});if(x.length){x[0].t={labels:{open:a(e,"open:")+" ",high:a(e,"high:")+" ",low:a(e,"low:")+" ",close:a(e,"close:")+" "}}}return x}function f(e,t,r){var a=r._minDiff;if(!a){var i=e._fullData;var s=[];a=Infinity;var l;for(l=0;l<i.length;l++){var u=i[l];if(u.type==="ohlc"&&u.visible===true&&u.xaxis===t._id){s.push(u);var c=t.makeCalcdata(u,"x");u._origX=c;var f=o(r,t,"x",c);u._xcalc=f;var h=n.distinctVals(f).minDiff;if(h&&isFinite(h)){a=Math.min(a,h)}}}if(a===Infinity)a=1;for(l=0;l<s.length;l++){s[l]._minDiff=a}}return a*r.tickwidth}t.exports={calc:l,calcCommon:c}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828}],1135:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./ohlc_defaults");var i=e("../scatter/period_defaults");var o=e("./attributes");t.exports=function e(t,r,l,u){function c(e,a){return n.coerce(t,r,o,e,a)}var f=a(t,r,c,u);if(!f){r.visible=false;return}i(t,r,u,c,{x:true});c("line.width");c("line.dash");s(t,r,c,"increasing");s(t,r,c,"decreasing");c("text");c("hovertext");c("tickwidth");u._requestRangeslider[r.xaxis]=true};function s(e,t,r,n){r(n+".line.color");r(n+".line.width",t.line.width);r(n+".line.dash",t.line.dash)}},{"../../lib":778,"../scatter/period_defaults":1207,"./attributes":1133,"./ohlc_defaults":1138}],1136:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../lib");var i=e("../../components/fx");var o=e("../../components/color");var s=e("../../lib").fillText;var l=e("../../constants/delta.js");var u={increasing:l.INCREASING.SYMBOL,decreasing:l.DECREASING.SYMBOL};function c(e,t,r,n){var a=e.cd;var i=a[0].trace;if(i.hoverlabel.split){return h(e,t,r,n)}return p(e,t,r,n)}function f(e,t,r,n){var a=e.cd;var s=e.xa;var l=a[0].trace;var u=a[0].t;var c=l.type;var f=c==="ohlc"?"l":"min";var h=c==="ohlc"?"h":"max";var p,d;var v=u.bPos||0;var m=function(e){return e.pos+v-t};var g=u.bdPos||u.tickLen;var y=u.wHover;var x=Math.min(1,g/Math.abs(s.r2c(s.range[1])-s.r2c(s.range[0])));p=e.maxHoverDistance-x;d=e.maxSpikeDistance-x;function _(e){var t=m(e);return i.inbox(t-y,t+y,p)}function b(e){var t=e[f];var n=e[h];return t===n||i.inbox(t-r,n-r,p)}function w(e){return(_(e)+b(e))/2}var T=i.getDistanceFunction(n,_,b,w);i.getClosest(a,T,e);if(e.index===false)return null;var k=a[e.index];if(k.empty)return null;var A=k.dir;var M=l[A];var E=M.line.color;if(o.opacity(E)&&M.line.width)e.color=E;else e.color=M.fillcolor;e.x0=s.c2p(k.pos+v-g,true);e.x1=s.c2p(k.pos+v+g,true);e.xLabelVal=k.orig_p!==undefined?k.orig_p:k.pos;e.spikeDistance=w(k)*d/p;e.xSpike=s.c2p(k.pos,true);return e}function h(e,t,r,i){var o=e.cd;var s=e.ya;var l=o[0].trace;var u=o[0].t;var c=[];var h=f(e,t,r,i);if(!h)return[];var p=h.index;var d=o[p];var v=d.hi||l.hoverinfo;var m=v.split("+");var g=v==="all";var y=g||m.indexOf("y")!==-1;if(!y)return[];var x=["high","open","close","low"];var _={};for(var b=0;b<x.length;b++){var w=x[b];var T=l[w][h.index];var k=s.c2p(T,true);var A;if(T in _){A=_[T];A.yLabel+="<br>"+u.labels[w]+n.hoverLabelText(s,T)}else{A=a.extendFlat({},h);A.y0=A.y1=k;A.yLabelVal=T;A.yLabel=u.labels[w]+n.hoverLabelText(s,T);A.name="";c.push(A);_[T]=A}}return c}function p(e,t,r,a){var i=e.cd;var o=e.ya;var l=i[0].trace;var c=i[0].t;var h=f(e,t,r,a);if(!h)return[];var p=h.index;var d=i[p];var v=h.index=d.i;var m=d.dir;function g(e){return c.labels[e]+n.hoverLabelText(o,l[e][v])}var y=d.hi||l.hoverinfo;var x=y.split("+");var _=y==="all";var b=_||x.indexOf("y")!==-1;var w=_||x.indexOf("text")!==-1;var T=b?[g("open"),g("high"),g("low"),g("close")+"  "+u[m]]:[];if(w)s(d,l,T);h.extraText=T.join("<br>");h.y0=h.y1=o.c2p(d.yc,true);return[h]}t.exports={hoverPoints:c,hoverSplit:h,hoverOnPoints:p}},{"../../components/color":643,"../../components/fx":683,"../../constants/delta.js":747,"../../lib":778,"../../plots/cartesian/axes":828}],1137:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"ohlc",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc").calc,plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select")}},{"../../plots/cartesian":841,"./attributes":1133,"./calc":1134,"./defaults":1135,"./hover":1136,"./plot":1139,"./select":1140,"./style":1141}],1138:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");t.exports=function e(t,r,i,o){var s=i("x");var l=i("open");var u=i("high");var c=i("low");var f=i("close");i("hoverlabel.split");var h=n.getComponentMethod("calendars","handleTraceDefaults");h(t,r,["x"],o);if(!(l&&u&&c&&f))return;var p=Math.min(l.length,u.length,c.length,f.length);if(s)p=Math.min(p,a.minRowLength(s));r._length=p;return p}},{"../../lib":778,"../../registry":911}],1139:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");t.exports=function e(t,r,i,o){var s=r.yaxis;var l=r.xaxis;var u=!!l.rangebreaks;a.makeTraceGroups(o,i,"trace ohlc").each(function(e){var t=n.select(this);var r=e[0];var i=r.t;var o=r.trace;if(o.visible!==true||i.empty){t.remove();return}var c=i.tickLen;var f=t.selectAll("path").data(a.identity);f.enter().append("path");f.exit().remove();f.attr("d",function(e){if(e.empty)return"M0,0Z";var t=l.c2p(e.pos-c,true);var r=l.c2p(e.pos+c,true);var n=u?(t+r)/2:l.c2p(e.pos,true);var a=s.c2p(e.o,true);var i=s.c2p(e.h,true);var o=s.c2p(e.l,true);var f=s.c2p(e.c,true);return"M"+t+","+a+"H"+n+"M"+n+","+i+"V"+o+"M"+r+","+f+"H"+n})})}},{"../../lib":778,d3:169}],1140:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t.cd;var a=t.xaxis;var i=t.yaxis;var o=[];var s;var l=n[0].t.bPos||0;if(r===false){for(s=0;s<n.length;s++){n[s].selected=0}}else{for(s=0;s<n.length;s++){var u=n[s];if(r.contains([a.c2p(u.pos+l),i.c2p(u.yc)],null,u.i,t)){o.push({pointNumber:u.i,x:a.c2d(u.pos),y:i.c2d(u.yc)});u.selected=1}else{u.selected=0}}}return o}},{}],1141:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../../components/color");t.exports=function e(t,r,o){var s=o?o:n.select(t).selectAll("g.ohlclayer").selectAll("g.trace");s.style("opacity",function(e){return e[0].trace.opacity});s.each(function(e){var t=e[0].trace;n.select(this).selectAll("path").each(function(e){if(e.empty)return;var r=t[e.dir].line;n.select(this).style("fill","none").call(i.stroke,r.color).call(a.dashLine,r.dash,r.width).style("opacity",t.selectedpoints&&!e.selected?.3:1)})})}},{"../../components/color":643,"../../components/drawing":665,d3:169}],1142:[function(e,t,r){"use strict";var n=e("../../lib/extend").extendFlat;var a=e("../../plots/attributes");var i=e("../../plots/font_attributes");var o=e("../../components/colorscale/attributes");var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../plots/domain").attributes;var u=n({editType:"calc"},o("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:s({editType:"plot",arrayOk:false},{keys:["count","probability"]})});t.exports={domain:l({name:"parcats",trace:true,editType:"calc"}),hoverinfo:n({},a.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:false}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:s({editType:"plot",arrayOk:false},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:true,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:i({editType:"calc"}),tickfont:i({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:true,editType:"calc"}},line:u,counts:{valType:"number",min:0,dflt:1,arrayOk:true,editType:"calc"},customdata:undefined,hoverlabel:undefined,ids:undefined,legendgroup:undefined,opacity:undefined,selectedpoints:undefined,showlegend:undefined}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1143:[function(e,t,r){"use strict";var n=e("../../plots/get_data").getModuleCalcData;var a=e("./plot");var i="parcats";r.name=i;r.plot=function(e,t,r,o){var s=n(e.calcdata,i);if(s.length){var l=s[0];a(e,l,r,o)}};r.clean=function(e,t,r,n){var a=n._has&&n._has("parcats");var i=t._has&&t._has("parcats");if(a&&!i){n._paperdiv.selectAll(".parcats").remove()}}},{"../../plots/get_data":865,"./plot":1148}],1144:[function(e,t,r){"use strict";var n=e("../../lib/gup").wrap;var a=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/calc");var o=e("../../lib/filter_unique.js");var s=e("../../components/drawing");var l=e("../../lib");var u=e("fast-isnumeric");t.exports=function e(t,r){var x=l.filterVisible(r.dimensions);if(x.length===0)return[];var _=x.map(function(e){var t;if(e.categoryorder==="trace"){t=null}else if(e.categoryorder==="array"){t=e.categoryarray}else{t=o(e.values);var r=true;for(var n=0;n<t.length;n++){if(!u(t[n])){r=false;break}}t.sort(r?l.sorterAsc:undefined);if(e.categoryorder==="category descending"){t=t.reverse()}}return m(e.values,t)});var b,w,T;if(l.isArrayOrTypedArray(r.counts)){b=r.counts}else{b=[r.counts]}g(x);x.forEach(function(e,t){y(e,_[t])});var k=r.line;var A;if(k){if(a(r,"line")){i(t,r,{vals:r.line.color,containerStr:"line",cLetter:"c"})}A=s.tryColorscale(k)}else{A=l.identity}function M(e){var t,r;if(l.isArrayOrTypedArray(k.color)){t=k.color[e%k.color.length];r=t}else{t=k.color}return{color:A(t),rawColor:r}}var E=x[0].values.length;var S={};var C=_.map(function(e){return e.inds});T=0;var L;var I;for(L=0;L<E;L++){var O=[];for(I=0;I<C.length;I++){O.push(C[I][L])}w=b[L%b.length];T+=w;var P=M(L);var D=O+"-"+P.rawColor;if(S[D]===undefined){S[D]=d(O,P.color,P.rawColor)}v(S[D],L,w)}var R=x.map(function(e,t){return f(t,e._index,e._displayindex,e.label,T)});for(L=0;L<E;L++){w=b[L%b.length];for(I=0;I<R.length;I++){var z=R[I].containerInd;var N=_[I].inds[L];var F=R[I].categories;if(F[N]===undefined){var B=r.dimensions[z]._categoryarray[N];var j=r.dimensions[z]._ticktext[N];F[N]=h(I,N,B,j)}p(F[N],L,w)}}return n(c(R,S,T))};function c(e,t,r){var n=e.map(function(e){return e.categories.length}).reduce(function(e,t){return Math.max(e,t)});return{dimensions:e,paths:t,trace:undefined,maxCats:n,count:r}}function f(e,t,r,n,a){return{dimensionInd:e,containerInd:t,displayInd:r,dimensionLabel:n,count:a,categories:[],dragX:null}}function h(e,t,r,n){return{dimensionInd:e,categoryInd:t,categoryValue:r,displayInd:t,categoryLabel:n,valueInds:[],count:0,dragY:null}}function p(e,t,r){e.valueInds.push(t);e.count+=r}function d(e,t,r){return{categoryInds:e,color:t,rawColor:r,valueInds:[],count:0}}function v(e,t,r){e.valueInds.push(t);e.count+=r}function m(e,t){if(t===undefined||t===null){t=[]}else{t=t.map(function(e){return e})}var r={};var n={};var a=[];t.forEach(function(e,t){r[e]=0;n[e]=t});for(var i=0;i<e.length;i++){var o=e[i];var s;if(r[o]===undefined){r[o]=1;s=t.push(o)-1;n[o]=s}else{r[o]++;s=n[o]}a.push(s)}var l=t.map(function(e){return r[e]});return{uniqueValues:t,uniqueCounts:l,inds:a}}function g(e){var t=e.map(function(e){return e.displayindex});var r;if(x(t)){for(r=0;r<e.length;r++){e[r]._displayindex=e[r].displayindex}}else{for(r=0;r<e.length;r++){e[r]._displayindex=r}}}function y(e,t){e._categoryarray=t.uniqueValues;if(e.ticktext===null||e.ticktext===undefined){e._ticktext=[]}else{e._ticktext=e.ticktext.slice()}for(var r=e._ticktext.length;r<t.uniqueValues.length;r++){e._ticktext.push(t.uniqueValues[r])}}function x(e){var t=new Array(e.length);for(var r=0;r<e.length;r++){if(e[r]<0||e[r]>=e.length){return false}if(t[e[r]]!==undefined){return false}t[e[r]]=true}return true}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../components/drawing":665,"../../lib":778,"../../lib/filter_unique.js":769,"../../lib/gup":775,"fast-isnumeric":241}],1145:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("../../plots/domain").defaults;var s=e("../../plots/array_container_defaults");var l=e("./attributes");var u=e("../parcoords/merge_length");function c(e,t,r,o,s){s("line.shape");s("line.hovertemplate");var l=s("line.color",o.colorway[0]);if(a(e,"line")&&n.isArrayOrTypedArray(l)){if(l.length){s("line.colorscale");i(e,t,o,s,{prefix:"line.",cLetter:"c"});return l.length}else{t.line.color=r}}return Infinity}function f(e,t){function r(r,a){return n.coerce(e,t,l.dimensions,r,a)}var a=r("values");var i=r("visible");if(!(a&&a.length)){i=t.visible=false}if(i){r("label");r("displayindex",t._index);var o=e.categoryarray;var s=Array.isArray(o)&&o.length>0;var u;if(s)u="array";var c=r("categoryorder",u);if(c==="array"){r("categoryarray");r("ticktext")}else{delete e.categoryarray;delete e.ticktext}if(!s&&c==="array"){t.categoryorder="trace"}}}t.exports=function e(t,r,a,i){function h(e,a){return n.coerce(t,r,l,e,a)}var p=s(t,r,{name:"dimensions",handleItemDefaults:f});var d=c(t,r,a,i,h);o(r,i,h);if(!Array.isArray(p)||!p.length){r.visible=false}u(r,p,"values",d);h("hoveron");h("hovertemplate");h("arrangement");h("bundlecolors");h("sortpaths");h("counts");var v={family:i.font.family,size:Math.round(i.font.size),color:i.font.color};n.coerceFont(h,"labelfont",v);var m={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};n.coerceFont(h,"tickfont",m)}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/domain":855,"../parcoords/merge_length":1158,"./attributes":1142}],1146:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1142,"./base_plot":1143,"./calc":1144,"./defaults":1145,"./plot":1148}],1147:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../plot_api/plot_api");var i=e("../../components/fx");var o=e("../../lib");var s=o.strTranslate;var l=e("../../components/drawing");var u=e("tinycolor2");var c=e("../../lib/svg_text_utils");function f(e,t,r,a){var i=e.map(H.bind(0,t,r));var u=a.selectAll("g.parcatslayer").data([null]);u.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var f=u.selectAll("g.trace.parcats").data(i,h);var g=f.enter().append("g").attr("class","trace parcats");f.attr("transform",function(e){return s(e.x,e.y)});g.append("g").attr("class","paths");var y=f.select("g.paths");var b=y.selectAll("path.path").data(function(e){return e.paths},h);b.attr("fill",function(e){return e.model.color});var w=b.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(e){return e.model.color}).attr("fill-opacity",0);_(w);b.attr("d",function(e){return e.svgD});if(!w.empty()){b.sort(d)}b.exit().remove();b.on("mouseover",v).on("mouseout",m).on("click",x);g.append("g").attr("class","dimensions");var k=f.select("g.dimensions");var M=k.selectAll("g.dimension").data(function(e){return e.dimensions},h);M.enter().append("g").attr("class","dimension");M.attr("transform",function(e){return s(e.x,0)});M.exit().remove();var E=M.selectAll("g.category").data(function(e){return e.categories},h);var S=E.enter().append("g").attr("class","category");E.attr("transform",function(e){return s(0,e.y)});S.append("rect").attr("class","catrect").attr("pointer-events","none");E.select("rect.catrect").attr("fill","none").attr("width",function(e){return e.width}).attr("height",function(e){return e.height});T(S);var C=E.selectAll("rect.bandrect").data(function(e){return e.bands},h);C.each(function(){o.raiseToTop(this)});C.attr("fill",function(e){return e.color});var L=C.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);C.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}).attr("cursor",function(e){if(e.parcatsViewModel.arrangement==="fixed"){return"default"}else if(e.parcatsViewModel.arrangement==="perpendicular"){return"ns-resize"}else{return"move"}});A(L);C.exit().remove();S.append("text").attr("class","catlabel").attr("pointer-events","none");var I=t._fullLayout.paper_bgcolor;E.select("text.catlabel").attr("text-anchor",function(e){if(p(e)){return"start"}else{return"end"}}).attr("alignment-baseline","middle").style("text-shadow",I+" -1px  1px 2px, "+I+" 1px  1px 2px, "+I+"  1px -1px 2px, "+I+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",function(e){if(p(e)){return e.width+5}else{return-5}}).attr("y",function(e){return e.height/2}).text(function(e){return e.model.categoryLabel}).each(function(e){l.font(n.select(this),e.parcatsViewModel.categorylabelfont);c.convertToTspans(n.select(this),t)});S.append("text").attr("class","dimlabel");E.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(e){if(e.parcatsViewModel.arrangement==="fixed"){return"default"}else{return"ew-resize"}}).attr("x",function(e){return e.width/2}).attr("y",-5).text(function(e,t){if(t===0){return e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel}else{return null}}).each(function(e){l.font(n.select(this),e.parcatsViewModel.labelfont)});E.selectAll("rect.bandrect").on("mouseover",D).on("mouseout",R);E.exit().remove();M.call(n.behavior.drag().origin(function(e){return{x:e.x,y:0}}).on("dragstart",z).on("drag",N).on("dragend",F));f.each(function(e){e.traceSelection=n.select(this);e.pathSelection=n.select(this).selectAll("g.paths").selectAll("path.path");e.dimensionSelection=n.select(this).selectAll("g.dimensions").selectAll("g.dimension")});f.exit().remove()}t.exports=function(e,t,r,n){f(r,e,n,t)};function h(e){return e.key}function p(e){var t=e.parcatsViewModel.dimensions.length;var r=e.parcatsViewModel.dimensions[t-1].model.dimensionInd;return e.model.dimensionInd===r}function d(e,t){if(e.model.rawColor>t.model.rawColor){return 1}else if(e.model.rawColor<t.model.rawColor){return-1}else{return 0}}function v(e){if(!e.parcatsViewModel.dragDimension){if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){o.raiseToTop(this);b(n.select(this));var t=g(e);var r=y(e);e.parcatsViewModel.graphDiv.emit("plotly_hover",{points:t,event:n.event,constraints:r});if(e.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var a=n.mouse(this)[0];var s=e.parcatsViewModel.graphDiv;var l=e.parcatsViewModel.trace;var c=s._fullLayout;var f=c._paperdiv.node().getBoundingClientRect();var h=e.parcatsViewModel.graphDiv.getBoundingClientRect();var p,d,v;for(v=0;v<e.leftXs.length-1;v++){if(e.leftXs[v]+e.dimWidths[v]-2<=a&&a<=e.leftXs[v+1]+2){var m=e.parcatsViewModel.dimensions[v];var x=e.parcatsViewModel.dimensions[v+1];p=(m.x+m.width+x.x)/2;d=(e.topYs[v]+e.topYs[v+1]+e.height)/2;break}}var _=e.parcatsViewModel.x+p;var w=e.parcatsViewModel.y+d;var T=u.mostReadable(e.model.color,["black","white"]);var k=e.model.count;var A=k/e.parcatsViewModel.model.count;var M={countLabel:k,probabilityLabel:A.toFixed(3)};var E=[];if(e.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1){E.push(["Count:",M.countLabel].join(" "))}if(e.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1){E.push(["P:",M.probabilityLabel].join(" "))}var S=E.join("<br>");var C=n.mouse(s)[0];i.loneHover({trace:l,x:_-f.left+h.left,y:w-f.top+h.top,text:S,color:e.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:T,idealAlign:C<_?"right":"left",hovertemplate:(l.line||{}).hovertemplate,hovertemplateLabels:M,eventData:[{data:l._input,fullData:l,count:k,probability:A}]},{container:c._hoverlayer.node(),outerContainer:c._paper.node(),gd:s})}}}}function m(e){if(!e.parcatsViewModel.dragDimension){_(n.select(this));i.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node());e.parcatsViewModel.pathSelection.sort(d);if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var t=g(e);var r=y(e);e.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:t,event:n.event,constraints:r})}}}function g(e){var t=[];var r=B(e.parcatsViewModel);for(var n=0;n<e.model.valueInds.length;n++){var a=e.model.valueInds[n];t.push({curveNumber:r,pointNumber:a})}return t}function y(e){var t={};var r=e.parcatsViewModel.model.dimensions;for(var n=0;n<r.length;n++){var a=r[n];var i=a.categories[e.model.categoryInds[n]];t[a.containerInd]=i.categoryValue}if(e.model.rawColor!==undefined){t.color=e.model.rawColor}return t}function x(e){if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var t=g(e);var r=y(e);e.parcatsViewModel.graphDiv.emit("plotly_click",{points:t,event:n.event,constraints:r})}}function _(e){e.attr("fill",function(e){return e.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function b(e){e.attr("fill-opacity",.8).attr("stroke",function(e){return u.mostReadable(e.model.color,["black","white"])}).attr("stroke-width",.3)}function w(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function T(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function k(e){e.attr("stroke","black").attr("stroke-width",1.5)}function A(e){e.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function M(e){var t=e.parcatsViewModel.pathSelection;var r=e.categoryViewModel.model.dimensionInd;var n=e.categoryViewModel.model.categoryInd;return t.filter(function(t){return t.model.categoryInds[r]===n&&t.model.color===e.color})}function E(e){var t=n.select(e.parentNode).selectAll("rect.bandrect");t.each(function(e){var t=M(e);b(t);t.each(function(){o.raiseToTop(this)})});w(n.select(e.parentNode))}function S(e){var t=n.select(e).datum();var r=M(t);b(r);r.each(function(){o.raiseToTop(this)});n.select(e.parentNode).selectAll("rect.bandrect").filter(function(e){return e.color===t.color}).each(function(){o.raiseToTop(this);k(n.select(this))})}function C(e,t,r){var a=n.select(e).datum();var i=a.categoryViewModel.model;var o=a.parcatsViewModel.graphDiv;var s=n.select(e.parentNode).selectAll("rect.bandrect");var l=[];s.each(function(e){var t=M(e);t.each(function(e){Array.prototype.push.apply(l,g(e))})});var u={};u[i.dimensionInd]=i.categoryValue;o.emit(t,{points:l,event:r,constraints:u})}function L(e,t,r){var a=n.select(e).datum();var i=a.categoryViewModel.model;var o=a.parcatsViewModel.graphDiv;var s=M(a);var l=[];s.each(function(e){Array.prototype.push.apply(l,g(e))});var u={};u[i.dimensionInd]=i.categoryValue;if(a.rawColor!==undefined){u.color=a.rawColor}o.emit(t,{points:l,event:r,constraints:u})}function I(e,t,r){e._fullLayout._calcInverseTransform(e);var a=e._fullLayout._invScaleX;var i=e._fullLayout._invScaleY;var o=n.select(r.parentNode).select("rect.catrect");var s=o.node().getBoundingClientRect();var l=o.datum();var u=l.parcatsViewModel;var c=u.model.dimensions[l.model.dimensionInd];var f=u.trace;var h=s.top+s.height/2;var p,d;if(u.dimensions.length>1&&c.displayInd===u.dimensions.length-1){p=s.left;d="left"}else{p=s.left+s.width;d="right"}var v=l.model.count;var m=l.model.categoryLabel;var g=v/l.parcatsViewModel.model.count;var y={countLabel:v,categoryLabel:m,probabilityLabel:g.toFixed(3)};var x=[];if(l.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1){x.push(["Count:",y.countLabel].join(" "))}if(l.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1){x.push(["P("+y.categoryLabel+"):",y.probabilityLabel].join(" "))}var _=x.join("<br>");return{trace:f,x:a*(p-t.left),y:i*(h-t.top),text:_,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:d,hovertemplate:f.hovertemplate,hovertemplateLabels:y,eventData:[{data:f._input,fullData:f,count:v,category:m,probability:g}]}}function O(e,t,r){var a=[];n.select(r.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var r=this;a.push(I(e,t,r))});return a}function P(e,t,r){e._fullLayout._calcInverseTransform(e);var a=e._fullLayout._invScaleX;var i=e._fullLayout._invScaleY;var o=r.getBoundingClientRect();var s=n.select(r).datum();var l=s.categoryViewModel;var c=l.parcatsViewModel;var f=c.model.dimensions[l.model.dimensionInd];var h=c.trace;var p=o.y+o.height/2;var d,v;if(c.dimensions.length>1&&f.displayInd===c.dimensions.length-1){d=o.left;v="left"}else{d=o.left+o.width;v="right"}var m=l.model.categoryLabel;var g=s.parcatsViewModel.model.count;var y=0;s.categoryViewModel.bands.forEach(function(e){if(e.color===s.color){y+=e.count}});var x=l.model.count;var _=0;c.pathSelection.each(function(e){if(e.model.color===s.color){_+=e.model.count}});var b=y/g;var w=y/_;var T=y/x;var k={countLabel:g,categoryLabel:m,probabilityLabel:b.toFixed(3)};var A=[];if(l.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1){A.push(["Count:",k.countLabel].join(" "))}if(l.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1){A.push("P(color ∩ "+m+"): "+k.probabilityLabel);A.push("P("+m+" | color): "+w.toFixed(3));A.push("P(color | "+m+"): "+T.toFixed(3))}var M=A.join("<br>");var E=u.mostReadable(s.color,["black","white"]);return{trace:h,x:a*(d-t.left),y:i*(p-t.top),text:M,color:s.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:E,fontSize:10,idealAlign:v,hovertemplate:h.hovertemplate,hovertemplateLabels:k,eventData:[{data:h._input,fullData:h,category:m,count:g,probability:b,categorycount:x,colorcount:_,bandcolorcount:y}]}}function D(e){if(!e.parcatsViewModel.dragDimension){if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var t=n.mouse(this)[1];if(t<-1){return}var r=e.parcatsViewModel.graphDiv;var a=r._fullLayout;var o=a._paperdiv.node().getBoundingClientRect();var s=e.parcatsViewModel.hoveron;var l=this;if(s==="color"){S(l);L(l,"plotly_hover",n.event)}else{E(l);C(l,"plotly_hover",n.event)}if(e.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var u;if(s==="category"){u=I(r,o,l)}else if(s==="color"){u=P(r,o,l)}else if(s==="dimension"){u=O(r,o,l)}if(u){i.loneHover(u,{container:a._hoverlayer.node(),outerContainer:a._paper.node(),gd:r})}}}}}function R(e){var t=e.parcatsViewModel;if(!t.dragDimension){_(t.pathSelection);T(t.dimensionSelection.selectAll("g.category"));A(t.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect"));i.loneUnhover(t.graphDiv._fullLayout._hoverlayer.node());t.pathSelection.sort(d);if(t.hoverinfoItems.indexOf("skip")===-1){var r=e.parcatsViewModel.hoveron;var a=this;if(r==="color"){L(a,"plotly_unhover",n.event)}else{C(a,"plotly_unhover",n.event)}}}}function z(e){if(e.parcatsViewModel.arrangement==="fixed"){return}e.dragDimensionDisplayInd=e.model.displayInd;e.initialDragDimensionDisplayInds=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd});e.dragHasMoved=false;e.dragCategoryDisplayInd=null;n.select(this).selectAll("g.category").select("rect.catrect").each(function(t){var r=n.mouse(this)[0];var a=n.mouse(this)[1];if(-2<=r&&r<=t.width+2&&-2<=a&&a<=t.height+2){e.dragCategoryDisplayInd=t.model.displayInd;e.initialDragCategoryDisplayInds=e.model.categories.map(function(e){return e.displayInd});t.model.dragY=t.y;o.raiseToTop(this.parentNode);n.select(this.parentNode).selectAll("rect.bandrect").each(function(t){if(t.y<a&&a<=t.y+t.height){e.potentialClickBand=this}})}});e.parcatsViewModel.dragDimension=e;i.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node())}function N(e){if(e.parcatsViewModel.arrangement==="fixed"){return}e.dragHasMoved=true;if(e.dragDimensionDisplayInd===null){return}var t=e.dragDimensionDisplayInd;var r=t-1;var a=t+1;var i=e.parcatsViewModel.dimensions[t];if(e.dragCategoryDisplayInd!==null){var o=i.categories[e.dragCategoryDisplayInd];o.model.dragY+=n.event.dy;var s=o.model.dragY;var l=o.model.displayInd;var u=i.categories;var c=u[l-1];var f=u[l+1];if(c!==undefined){if(s<c.y+c.height/2){o.model.displayInd=c.model.displayInd;c.model.displayInd=l}}if(f!==undefined){if(s+o.height>f.y+f.height/2){o.model.displayInd=f.model.displayInd;f.model.displayInd=l}}e.dragCategoryDisplayInd=o.model.displayInd}if(e.dragCategoryDisplayInd===null||e.parcatsViewModel.arrangement==="freeform"){i.model.dragX=n.event.x;var h=e.parcatsViewModel.dimensions[r];var p=e.parcatsViewModel.dimensions[a];if(h!==undefined){if(i.model.dragX<h.x+h.width){i.model.displayInd=h.model.displayInd;h.model.displayInd=t}}if(p!==undefined){if(i.model.dragX+i.width>p.x){i.model.displayInd=p.model.displayInd;p.model.displayInd=e.dragDimensionDisplayInd}}e.dragDimensionDisplayInd=i.model.displayInd}q(e.parcatsViewModel);G(e.parcatsViewModel);U(e.parcatsViewModel);j(e.parcatsViewModel)}function F(e){if(e.parcatsViewModel.arrangement==="fixed"){return}if(e.dragDimensionDisplayInd===null){return}n.select(this).selectAll("text").attr("font-weight","normal");var t={};var r=B(e.parcatsViewModel);var i=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd});var o=e.initialDragDimensionDisplayInds.some(function(e,t){return e!==i[t]});if(o){i.forEach(function(r,n){var a=e.parcatsViewModel.model.dimensions[n].containerInd;t["dimensions["+a+"].displayindex"]=r})}var s=false;if(e.dragCategoryDisplayInd!==null){var l=e.model.categories.map(function(e){return e.displayInd});s=e.initialDragCategoryDisplayInds.some(function(e,t){return e!==l[t]});if(s){var u=e.model.categories.slice().sort(function(e,t){return e.displayInd-t.displayInd});var c=u.map(function(e){return e.categoryValue});var f=u.map(function(e){return e.categoryLabel});t["dimensions["+e.model.containerInd+"].categoryarray"]=[c];t["dimensions["+e.model.containerInd+"].ticktext"]=[f];t["dimensions["+e.model.containerInd+"].categoryorder"]="array"}}if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(!e.dragHasMoved&&e.potentialClickBand){if(e.parcatsViewModel.hoveron==="color"){L(e.potentialClickBand,"plotly_click",n.event.sourceEvent)}else{C(e.potentialClickBand,"plotly_click",n.event.sourceEvent)}}}e.model.dragX=null;if(e.dragCategoryDisplayInd!==null){var h=e.parcatsViewModel.dimensions[e.dragDimensionDisplayInd].categories[e.dragCategoryDisplayInd];h.model.dragY=null;e.dragCategoryDisplayInd=null}e.dragDimensionDisplayInd=null;e.parcatsViewModel.dragDimension=null;e.dragHasMoved=null;e.potentialClickBand=null;q(e.parcatsViewModel);G(e.parcatsViewModel);var p=n.transition().duration(300).ease("cubic-in-out");p.each(function(){U(e.parcatsViewModel,true);j(e.parcatsViewModel,true)}).each("end",function(){if(o||s){a.restyle(e.parcatsViewModel.graphDiv,t,[r])}})}function B(e){var t;var r=e.graphDiv._fullData;for(var n=0;n<r.length;n++){if(e.key===r[n].uid){t=n;break}}return t}function j(e,t){if(t===undefined){t=false}function r(e){return t?e.transition():e}e.pathSelection.data(function(e){return e.paths},h);r(e.pathSelection).attr("d",function(e){return e.svgD})}function U(e,t){if(t===undefined){t=false}function r(e){return t?e.transition():e}e.dimensionSelection.data(function(e){return e.dimensions},h);var a=e.dimensionSelection.selectAll("g.category").data(function(e){return e.categories},h);r(e.dimensionSelection).attr("transform",function(e){return s(e.x,0)});r(a).attr("transform",function(e){return s(0,e.y)});var i=a.select(".dimlabel");i.text(function(e,t){if(t===0){return e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel}else{return null}});var l=a.select(".catlabel");l.attr("text-anchor",function(e){if(p(e)){return"start"}else{return"end"}}).attr("x",function(e){if(p(e)){return e.width+5}else{return-5}}).each(function(e){var t;var r;if(p(e)){t=e.width+5;r="start"}else{t=-5;r="end"}n.select(this).selectAll("tspan").attr("x",t).attr("text-anchor",r)});var u=a.selectAll("rect.bandrect").data(function(e){return e.bands},h);var c=u.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);u.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y});A(c);u.each(function(){o.raiseToTop(this)});u.exit().remove()}function H(e,t,r){var n=r[0];var a=t.margin||{l:80,r:80,t:100,b:80};var i=n.trace;var o=i.domain;var s=t.width;var l=t.height;var u=Math.floor(s*(o.x[1]-o.x[0]));var c=Math.floor(l*(o.y[1]-o.y[0]));var f=o.x[0]*s+a.l;var h=t.height-o.y[1]*t.height+a.t;var p=i.line.shape;var d;if(i.hoverinfo==="all"){d=["count","probability"]}else{d=(i.hoverinfo||"").split("+")}var v={trace:i,key:i.uid,model:n,x:f,y:h,width:u,height:c,hoveron:i.hoveron,hoverinfoItems:d,arrangement:i.arrangement,bundlecolors:i.bundlecolors,sortpaths:i.sortpaths,labelfont:i.labelfont,categorylabelfont:i.tickfont,pathShape:p,dragDimension:null,margin:a,paths:[],dimensions:[],graphDiv:e,traceSelection:null,pathSelection:null,dimensionSelection:null};if(n.dimensions){q(v);G(v)}return v}function V(e,t,r,a,i){var o=[];var s=[];var l;var u;for(u=0;u<r.length-1;u++){l=n.interpolateNumber(r[u]+e[u],e[u+1]);o.push(l(i));s.push(l(1-i))}var c="M "+e[0]+","+t[0];c+="l"+r[0]+",0 ";for(u=1;u<r.length;u++){c+="C"+o[u-1]+","+t[u-1]+" "+s[u-1]+","+t[u]+" "+e[u]+","+t[u];c+="l"+r[u]+",0 "}c+="l"+"0,"+a+" ";c+="l -"+r[r.length-1]+",0 ";for(u=r.length-2;u>=0;u--){c+="C"+s[u]+","+(t[u+1]+a)+" "+o[u]+","+(t[u]+a)+" "+(e[u]+r[u])+","+(t[u]+a);c+="l-"+r[u]+",0 "}c+="Z";return c}function G(e){var t=e.dimensions;var r=e.model;var n=t.map(function(e){return e.categories.map(function(e){return e.y})});var a=e.model.dimensions.map(function(e){return e.categories.map(function(e){return e.displayInd})});var i=e.model.dimensions.map(function(e){return e.displayInd});var o=e.dimensions.map(function(e){return e.model.dimensionInd});var s=t.map(function(e){return e.x});var l=t.map(function(e){return e.width});var u=[];for(var c in r.paths){if(r.paths.hasOwnProperty(c)){u.push(r.paths[c])}}function f(e){var t=e.categoryInds.map(function(e,t){return a[t][e]});var r=o.map(function(e){return t[e]});return r}u.sort(function(t,r){var n=f(t);var a=f(r);if(e.sortpaths==="backward"){n.reverse();a.reverse()}n.push(t.valueInds[0]);a.push(r.valueInds[0]);if(e.bundlecolors){n.unshift(t.rawColor);a.unshift(r.rawColor)}if(n<a){return-1}if(n>a){return 1}return 0});var h=new Array(u.length);var p=t[0].model.count;var d=t[0].categories.map(function(e){return e.height}).reduce(function(e,t){return e+t});for(var v=0;v<u.length;v++){var m=u[v];var g;if(p>0){g=d*(m.count/p)}else{g=0}var y=new Array(n.length);for(var x=0;x<m.categoryInds.length;x++){var _=m.categoryInds[x];var b=a[x][_];var w=i[x];y[w]=n[w][b];n[w][b]+=g;var T=e.dimensions[w].categories[b];var k=T.bands.length;var A=T.bands[k-1];if(A===undefined||m.rawColor!==A.rawColor){var M=A===undefined?0:A.y+A.height;T.bands.push({key:M,color:m.color,rawColor:m.rawColor,height:g,width:T.width,count:m.count,y:M,categoryViewModel:T,parcatsViewModel:e})}else{var E=T.bands[k-1];E.height+=g;E.count+=m.count}}var S;if(e.pathShape==="hspline"){S=V(s,y,l,g,.5)}else{S=V(s,y,l,g,0)}h[v]={key:m.valueInds[0],model:m,height:g,leftXs:s,topYs:y,dimWidths:l,svgD:S,parcatsViewModel:e}}e.paths=h}function q(e){var t=e.model.dimensions.map(function(e){return{displayInd:e.displayInd,dimensionInd:e.dimensionInd}});t.sort(function(e,t){return e.displayInd-t.displayInd});var r=[];for(var n in t){var a=t[n].dimensionInd;var i=e.model.dimensions[a];r.push(Y(e,i))}e.dimensions=r}function Y(e,t){var r=40;var n=16;var a=e.model.dimensions.length;var i=t.displayInd;var o;var s;var l;if(a>1){o=(e.width-2*r-n)/(a-1)}else{o=0}s=r;l=s+o*i;var u=[];var c=e.model.maxCats;var f=t.categories.length;var h=8;var p=t.count;var d=e.height-h*(c-1);var v;var m;var g;var y;var x;var _=(c-f)*h/2;var b=t.categories.map(function(e){return{displayInd:e.displayInd,categoryInd:e.categoryInd}});b.sort(function(e,t){return e.displayInd-t.displayInd});for(x=0;x<f;x++){y=b[x].categoryInd;m=t.categories[y];if(p>0){v=m.count/p*d}else{v=0}g={key:m.valueInds[0],model:m,width:n,height:v,y:m.dragY!==null?m.dragY:_,bands:[],parcatsViewModel:e};_=_+v+h;u.push(g)}return{key:t.dimensionInd,x:t.dragX!==null?t.dragX:l,y:0,width:n,model:t,categories:u,parcatsViewModel:e,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_api":814,d3:169,tinycolor2:576}],1148:[function(e,t,r){"use strict";var n=e("./parcats");t.exports=function e(t,r,a,i){var o=t._fullLayout;var s=o._paper;var l=o._size;n(t,s,r,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},a,i)}},{"./parcats":1147}],1149:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../../plots/cartesian/layout_attributes");var i=e("../../plots/font_attributes");var o=e("../../plots/domain").attributes;var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/plot_template").templatedArray;t.exports={domain:o({name:"parcoords",trace:true,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:i({editType:"plot"}),tickfont:i({editType:"plot"}),rangefont:i({editType:"plot"}),dimensions:l("dimension",{label:{valType:"string",editType:"plot"},tickvals:s({},a.tickvals,{editType:"plot"}),ticktext:s({},a.ticktext,{editType:"plot"}),tickformat:s({},a.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:true,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:true,dimensions:"1-2",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:true,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:s({editType:"calc"},n("line",{colorscaleDflt:"Viridis",autoColorDflt:false,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../plots/cartesian/layout_attributes":842,"../../plots/domain":855,"../../plots/font_attributes":856}],1150:[function(e,t,r){"use strict";var n=e("./constants");var a=e("d3");var i=e("../../lib/gup").keyFun;var o=e("../../lib/gup").repeat;var s=e("../../lib").sorterAsc;var l=e("../../lib").strTranslate;var u=n.bar.snapRatio;function c(e,t){return e*(1-u)+t*u}var f=n.bar.snapClose;function h(e,t){return e*(1-f)+t*f}function p(e,t,r,n){if(d(r,n))return r;var a=e?-1:1;var i=0;var o=t.length-1;if(a<0){var s=i;i=o;o=s}var l=t[i];var u=l;for(var f=i;a*f<a*o;f+=a){var p=f+a;var v=t[p];if(a*r<a*h(l,v))return c(l,u);if(a*r<a*v||p===o)return c(v,l);u=l;l=v}}function d(e,t){for(var r=0;r<t.length;r++){if(e>=t[r][0]&&e<=t[r][1])return true}return false}function v(e){e.attr("x",-n.bar.captureWidth/2).attr("width",n.bar.captureWidth)}function m(e){e.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function g(e){if(!e.brush.filterSpecified){return"0,"+e.height}var t=y(e.brush.filter.getConsolidated(),e.height);var r=[0];var n,a,i;var o=t.length?t[0][0]:null;for(var s=0;s<t.length;s++){n=t[s];a=n[1]-n[0];r.push(o);r.push(a);i=s+1;if(i<t.length){o=t[i][0]-n[1]}}r.push(e.height);return r}function y(e,t){return e.map(function(e){return e.map(function(e){return Math.max(0,e*t)}).sort(s)})}function x(e,t){var r=n.bar.handleHeight;if(t>e[1]+r||t<e[0]-r)return;if(t>=.9*e[1]+.1*e[0])return"n";if(t<=.9*e[0]+.1*e[1])return"s";return"ns"}function _(){a.select(document.body).style("cursor",null)}function b(e){e.attr("stroke-dasharray",g)}function w(e,t){var r=a.select(e).selectAll(".highlight, .highlight-shadow");var i=t?r.transition().duration(n.bar.snapDuration).each("end",t):r;b(i)}function T(e,t){var r=e.brush;var n=r.filterSpecified;var a=NaN;var i={};var o;if(n){var s=e.height;var l=r.filter.getConsolidated();var u=y(l,s);var c=NaN;var f=NaN;var h=NaN;for(o=0;o<=u.length;o++){var p=u[o];if(p&&p[0]<=t&&t<=p[1]){c=o;break}else{f=o?o-1:NaN;if(p&&p[0]>t){h=o;break}}}a=c;if(isNaN(a)){if(isNaN(f)||isNaN(h)){a=isNaN(f)?h:f}else{a=t-u[f][1]<u[h][0]-t?f:h}}if(!isNaN(a)){var d=u[a];var v=x(d,t);if(v){i.interval=l[a];i.intervalPix=d;i.region=v}}}if(e.ordinal&&!i.region){var m=e.unitTickvals;var g=e.unitToPaddedPx.invert(t);for(o=0;o<m.length;o++){var _=[m[Math.max(o-1,0)]*.25+m[o]*.75,m[Math.min(o+1,m.length-1)]*.25+m[o]*.75];if(g>=_[0]&&g<=_[1]){i.clickableOrdinalRange=_;break}}}return i}function k(e,t){a.event.sourceEvent.stopPropagation();var r=t.height-a.mouse(e)[1]-2*n.verticalPadding;var i=t.unitToPaddedPx.invert(r);var o=t.brush;var s=T(t,r);var l=s.interval;var u=o.svgBrush;u.wasDragged=false;u.grabbingBar=s.region==="ns";if(u.grabbingBar){var c=l.map(t.unitToPaddedPx);u.grabPoint=r-c[0]-n.verticalPadding;u.barLength=c[1]-c[0]}u.clickableOrdinalRange=s.clickableOrdinalRange;u.stayingIntervals=t.multiselect&&o.filterSpecified?o.filter.getConsolidated():[];if(l){u.stayingIntervals=u.stayingIntervals.filter(function(e){return e[0]!==l[0]&&e[1]!==l[1]})}u.startExtent=s.region?l[s.region==="s"?1:0]:i;t.parent.inBrushDrag=true;u.brushStartCallback()}function A(e,t){a.event.sourceEvent.stopPropagation();var r=t.height-a.mouse(e)[1]-2*n.verticalPadding;var i=t.brush.svgBrush;i.wasDragged=true;i._dragging=true;if(i.grabbingBar){i.newExtent=[r-i.grabPoint,r+i.barLength-i.grabPoint].map(t.unitToPaddedPx.invert)}else{i.newExtent=[i.startExtent,t.unitToPaddedPx.invert(r)].sort(s)}t.brush.filterSpecified=true;i.extent=i.stayingIntervals.concat([i.newExtent]);i.brushCallback(t);w(e.parentNode)}function M(e,t){var r=t.brush;var n=r.filter;var i=r.svgBrush;if(!i._dragging){E(e,t);A(e,t);t.brush.svgBrush.wasDragged=false}i._dragging=false;var o=a.event;o.sourceEvent.stopPropagation();var s=i.grabbingBar;i.grabbingBar=false;i.grabLocation=undefined;t.parent.inBrushDrag=false;_();if(!i.wasDragged){i.wasDragged=undefined;if(i.clickableOrdinalRange){if(r.filterSpecified&&t.multiselect){i.extent.push(i.clickableOrdinalRange)}else{i.extent=[i.clickableOrdinalRange];r.filterSpecified=true}}else if(s){i.extent=i.stayingIntervals;if(i.extent.length===0){P(r)}}else{P(r)}i.brushCallback(t);w(e.parentNode);i.brushEndCallback(r.filterSpecified?n.getConsolidated():[]);return}var l=function(){n.set(n.getConsolidated())};if(t.ordinal){var u=t.unitTickvals;if(u[u.length-1]<u[0])u.reverse();i.newExtent=[p(0,u,i.newExtent[0],i.stayingIntervals),p(1,u,i.newExtent[1],i.stayingIntervals)];var c=i.newExtent[1]>i.newExtent[0];i.extent=i.stayingIntervals.concat(c?[i.newExtent]:[]);if(!i.extent.length){P(r)}i.brushCallback(t);if(c){w(e.parentNode,l)}else{l();w(e.parentNode)}}else{l()}i.brushEndCallback(r.filterSpecified?n.getConsolidated():[])}function E(e,t){var r=t.height-a.mouse(e)[1]-2*n.verticalPadding;var i=T(t,r);var o="crosshair";if(i.clickableOrdinalRange)o="pointer";else if(i.region)o=i.region+"-resize";a.select(document.body).style("cursor",o)}function S(e){e.on("mousemove",function(e){a.event.preventDefault();if(!e.parent.inBrushDrag)E(this,e)}).on("mouseleave",function(e){if(!e.parent.inBrushDrag)_()}).call(a.behavior.drag().on("dragstart",function(e){k(this,e)}).on("drag",function(e){A(this,e)}).on("dragend",function(e){M(this,e)}))}function C(e,t){return e[0]-t[0]}function L(e){var t=e.selectAll(".background").data(o);t.enter().append("rect").classed("background",true).call(v).call(m).style("pointer-events","auto").attr("transform",l(0,n.verticalPadding));t.call(S).attr("height",function(e){return e.height-n.verticalPadding});var r=e.selectAll(".highlight-shadow").data(o);r.enter().append("line").classed("highlight-shadow",true).attr("x",-n.bar.width/2).attr("stroke-width",n.bar.width+n.bar.strokeWidth).attr("stroke",n.bar.strokeColor).attr("opacity",n.bar.strokeOpacity).attr("stroke-linecap","butt");r.attr("y1",function(e){return e.height}).call(b);var a=e.selectAll(".highlight").data(o);a.enter().append("line").classed("highlight",true).attr("x",-n.bar.width/2).attr("stroke-width",n.bar.width-n.bar.strokeWidth).attr("stroke",n.bar.fillColor).attr("opacity",n.bar.fillOpacity).attr("stroke-linecap","butt");a.attr("y1",function(e){return e.height}).call(b)}function I(e){var t=e.selectAll("."+n.cn.axisBrush).data(o,i);t.enter().append("g").classed(n.cn.axisBrush,true);L(t)}function O(e){return e.svgBrush.extent.map(function(e){return e.slice()})}function P(e){e.filterSpecified=false;e.svgBrush.extent=[[-Infinity,Infinity]]}function D(e){return function t(r){var n=r.brush;var a=O(n);var i=a.slice();n.filter.set(i);e()}}function R(e){var t=e.slice();var r=[];var n;var a=t.shift();while(a){n=a.slice();while((a=t.shift())&&a[0]<=n[1]){n[1]=Math.max(n[1],a[1])}r.push(n)}if(r.length===1&&r[0][0]>r[0][1]){r=[]}return r}function z(){var e=[];var t;var r;return{set:function(n){e=n.map(function(e){return e.slice().sort(s)}).sort(C);if(e.length===1&&e[0][0]===-Infinity&&e[0][1]===Infinity){e=[[0,-1]]}t=R(e);r=e.reduce(function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]},[Infinity,-Infinity])},get:function(){return e.slice()},getConsolidated:function(){return t},getBounds:function(){return r}}}function N(e,t,r,n,a,i){var o=z();o.set(r);return{filter:o,filterSpecified:t,svgBrush:{extent:[],brushStartCallback:n,brushCallback:D(a),brushEndCallback:i}}}function F(e,t){if(Array.isArray(e[0])){e=e.map(function(e){return e.sort(s)});if(!t.multiselect)e=[e[0]];else e=R(e.sort(C))}else e=[e.sort(s)];if(t.tickvals){var r=t.tickvals.slice().sort(s);e=e.map(function(e){var t=[p(0,r,e[0],[]),p(1,r,e[1],[])];if(t[1]>t[0])return t}).filter(function(e){return e});if(!e.length)return}return e.length>1?e:e[0]}t.exports={makeBrush:N,ensureAxisBrush:I,cleanRanges:F}},{"../../lib":778,"../../lib/gup":775,"./constants":1153,d3:169}],1151:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../plots/get_data").getModuleCalcData;var i=e("./plot");var o=e("../../constants/xmlns_namespaces");r.name="parcoords";r.plot=function(e){var t=a(e.calcdata,"parcoords")[0];if(t.length)i(e,t)};r.clean=function(e,t,r,n){var a=n._has&&n._has("parcoords");var i=t._has&&t._has("parcoords");if(a&&!i){n._paperdiv.selectAll(".parcoords").remove();n._glimages.selectAll("*").remove()}};r.toSVG=function(e){var t=e._fullLayout._glimages;var r=n.select(e).selectAll(".svg-container");var a=r.filter(function(e,t){return t===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function i(){var e=this;var r=e.toDataURL("image/png");var n=t.append("svg:image");n.attr({xmlns:o.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}a.each(i);window.setTimeout(function(){n.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":754,"../../plots/get_data":865,"./plot":1160,d3:169}],1152:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;var a=e("../../components/colorscale");var i=e("../../lib/gup").wrap;t.exports=function e(t,r){var s;var l;if(a.hasColorscale(r,"line")&&n(r.line.color)){s=r.line.color;l=a.extractOpts(r.line).colorscale;a.calc(t,r,{vals:s,containerStr:"line",cLetter:"c"})}else{s=o(r._length);l=[[0,r.line.color],[1,r.line.color]]}return i({lineColor:s,cscale:l})};function o(e){var t=new Array(e);for(var r=0;r<e;r++){t[r]=.5}return t}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gup":775}],1153:[function(e,t,r){"use strict";t.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1154:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("../../plots/domain").defaults;var s=e("../../plots/array_container_defaults");var l=e("../../plots/cartesian/axes");var u=e("./attributes");var c=e("./axisbrush");var f=e("./constants").maxDimensionCount;var h=e("./merge_length");function p(e,t,r,o,s){var l=s("line.color",r);if(a(e,"line")&&n.isArrayOrTypedArray(l)){if(l.length){s("line.colorscale");i(e,t,o,s,{prefix:"line.",cLetter:"c"});return l.length}else{t.line.color=r}}return Infinity}function d(e,t,r,a){function i(r,a){return n.coerce(e,t,u.dimensions,r,a)}var o=i("values");var s=i("visible");if(!(o&&o.length)){s=t.visible=false}if(s){i("label");i("tickvals");i("ticktext");i("tickformat");var f=i("range");t._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:f};l.setConvert(t._ax,a.layout);i("multiselect");var h=i("constraintrange");if(h){t.constraintrange=c.cleanRanges(h,t)}}}t.exports=function e(t,r,a,i){function l(e,a){return n.coerce(t,r,u,e,a)}var c=t.dimensions;if(Array.isArray(c)&&c.length>f){n.log("parcoords traces support up to "+f+" dimensions at the moment");c.splice(f)}var v=s(t,r,{name:"dimensions",layout:i,handleItemDefaults:d});var m=p(t,r,a,i,l);o(r,i,l);if(!Array.isArray(v)||!v.length){r.visible=false}h(r,v,"values",m);var g={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};n.coerceFont(l,"labelfont",g);n.coerceFont(l,"tickfont",g);n.coerceFont(l,"rangefont",g);l("labelangle");l("labelside")}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"../../plots/domain":855,"./attributes":1149,"./axisbrush":1150,"./constants":1153,"./merge_length":1158}],1155:[function(e,t,r){"use strict";var n=e("../../lib").isTypedArray;r.convertTypedArray=function(e){return n(e)?Array.prototype.slice.call(e):e};r.isOrdinal=function(e){return!!e.tickvals};r.isVisible=function(e){return e.visible||!("visible"in e)}},{"../../lib":778}],1156:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:e("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1149,"./base_plot":1151,"./calc":1152,"./defaults":1154,"./plot":1160}],1157:[function(e,t,r){"use strict";var n=e("glslify");var a=n(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform sampler2D mask, palette;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(mask,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]);var i=n(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]);var o=e("./constants").maxDimensionCount;var s=e("../../lib");var l=1e-6;var u=2048;var c=new Uint8Array(4);var f=new Uint8Array(4);var h={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function p(e){e.read({x:0,y:0,width:1,height:1,data:c})}function d(e,t,r,n,a){var i=e._gl;i.enable(i.SCISSOR_TEST);i.scissor(t,r,n,a);e.clear({color:[0,0,0,0],depth:1})}function v(e,t,r,n,a,i){var o=i.key;function s(l){var u=Math.min(n,a-l*n);if(l===0){window.cancelAnimationFrame(r.currentRafs[o]);delete r.currentRafs[o];d(e,i.scissorX,i.scissorY,i.scissorWidth,i.viewBoxSize[1])}if(r.clearOnly){return}i.count=2*u;i.offset=2*l*n;t(i);if(l*n+u<a){r.currentRafs[o]=window.requestAnimationFrame(function(){s(l+1)})}r.drawCompleted=false}if(!r.drawCompleted){p(e);r.drawCompleted=true}s(0)}function m(e){return Math.max(l,Math.min(1-l,e))}function g(e,t){var r=new Array(256);for(var n=0;n<256;n++){r[n]=e(n/255).concat(t)}return r}function y(e,t){return(e>>>8*t)%256/255}function x(e,t,r){var n=new Array(e*(o+4));var a=0;for(var i=0;i<e;i++){for(var s=0;s<o;s++){n[a++]=s<t.length?t[s].paddedUnitValues[i]:.5}n[a++]=y(i,2);n[a++]=y(i,1);n[a++]=y(i,0);n[a++]=m(r[i])}return n}function _(e,t,r){var n=new Array(t*8);var a=0;for(var i=0;i<t;i++){for(var o=0;o<2;o++){for(var s=0;s<4;s++){var l=e*4+s;var u=r[i*64+l];if(l===63&&o===0){u*=-1}n[a++]=u}}}return n}function b(e){var t="0"+e;return t.substr(t.length-2)}function w(e){return e<o?"p"+b(e+1)+"_"+b(e+4):"colors"}function T(e,t,r){for(var n=0;n<=o;n+=4){e[w(n)](_(n/4,t,r))}}function k(e){var t={};for(var r=0;r<=o;r+=4){t[w(r)]=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)})}return t}function A(e,t,r,n,a,i,o,l,u,c,f,h,p){var d=[[],[]];for(var v=0;v<64;v++){d[0][v]=v===a?1:0;d[1][v]=v===i?1:0}var m=e.lines.canvasOverdrag;var g=e.domain;var y=e.canvasWidth;var x=e.canvasHeight;var _=e.deselectedLines.color;var b=s.extendFlat({key:f,resolution:[y,x],viewBoxPos:[o+m,l],viewBoxSize:[u,c],i0:a,i1:i,dim0A:d[0].slice(0,16),dim0B:d[0].slice(16,32),dim0C:d[0].slice(32,48),dim0D:d[0].slice(48,64),dim1A:d[1].slice(0,16),dim1B:d[1].slice(16,32),dim1C:d[1].slice(32,48),dim1D:d[1].slice(48,64),drwLayer:h,contextColor:[_[0]/255,_[1]/255,_[2]/255,_[3]<1?_[3]:Math.max(1/255,Math.pow(1/e.lines.color.length,1/3))],scissorX:(n===t?0:o+m)+(e.pad.l-m)+e.layoutWidth*g.x[0],scissorWidth:(n===r?y-o+m:u+.5)+(n===t?o+m:0),scissorY:l+e.pad.b+e.layoutHeight*g.y[0],scissorHeight:c,viewportX:e.pad.l-m+e.layoutWidth*g.x[0],viewportY:e.pad.b+e.layoutHeight*g.y[0],viewportWidth:y,viewportHeight:x},p);return b}function M(e){var t=u-1;var r=Math.max(0,Math.floor(e[0]*t),0);var n=Math.min(t,Math.ceil(e[1]*t),t);return[Math.min(r,n),Math.max(r,n)]}t.exports=function(e,t){var r=t.context;var n=t.pick;var o=t.regl;var l={currentRafs:{},drawCompleted:true,clearOnly:false};var c;var p;var m;var y;var _=k(o);var b;var w=o.texture(h);var E=[];C(t);var S=o({profile:false,blend:{enable:r,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!r,mask:true,func:"less",range:[0,1]},cull:{enable:true,face:"back"},scissor:{enable:true,box:{x:o.prop("scissorX"),y:o.prop("scissorY"),width:o.prop("scissorWidth"),height:o.prop("scissorHeight")}},viewport:{x:o.prop("viewportX"),y:o.prop("viewportY"),width:o.prop("viewportWidth"),height:o.prop("viewportHeight")},dither:false,vert:a,frag:i,primitive:"lines",lineWidth:1,attributes:_,uniforms:{resolution:o.prop("resolution"),viewBoxPos:o.prop("viewBoxPos"),viewBoxSize:o.prop("viewBoxSize"),dim0A:o.prop("dim0A"),dim1A:o.prop("dim1A"),dim0B:o.prop("dim0B"),dim1B:o.prop("dim1B"),dim0C:o.prop("dim0C"),dim1C:o.prop("dim1C"),dim0D:o.prop("dim0D"),dim1D:o.prop("dim1D"),loA:o.prop("loA"),hiA:o.prop("hiA"),loB:o.prop("loB"),hiB:o.prop("hiB"),loC:o.prop("loC"),hiC:o.prop("hiC"),loD:o.prop("loD"),hiD:o.prop("hiD"),palette:w,contextColor:o.prop("contextColor"),mask:o.prop("maskTexture"),drwLayer:o.prop("drwLayer"),maskHeight:o.prop("maskHeight")},offset:o.prop("offset"),count:o.prop("count")});function C(e){c=e.model;p=e.viewModel;m=p.dimensions.slice();y=m[0]?m[0].values.length:0;var t=c.lines;var a=n?t.color.map(function(e,r){return r/t.color.length}):t.color;var i=x(y,m,a);T(_,y,i);if(!r&&!n){w=o.texture(s.extendFlat({data:g(c.unitToColor,255)},h))}}function L(e){var t,r,n;var a=[[],[]];for(n=0;n<64;n++){var i=!e&&n<m.length?m[n].brush.filter.getBounds():[-Infinity,Infinity];a[0][n]=i[0];a[1][n]=i[1]}var s=u*8;var l=new Array(s);for(t=0;t<s;t++){l[t]=255}if(!e){for(t=0;t<m.length;t++){var c=t%8;var f=(t-c)/8;var h=Math.pow(2,c);var p=m[t];var d=p.brush.filter.get();if(d.length<2)continue;var v=M(d[0])[1];for(r=1;r<d.length;r++){var g=M(d[r]);for(n=v+1;n<g[0];n++){l[n*8+f]&=~h}v=Math.max(v,g[1])}}}var y={shape:[8,u],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:l};if(b)b(y);else b=o.texture(y);return{maskTexture:b,maskHeight:u,loA:a[0].slice(0,16),loB:a[0].slice(16,32),loC:a[0].slice(32,48),loD:a[0].slice(48,64),hiA:a[1].slice(0,16),hiB:a[1].slice(16,32),hiC:a[1].slice(32,48),hiD:a[1].slice(48,64)}}function I(e,t,a){var i=e.length;var s;var u;var f;var h=Infinity;var p=-Infinity;for(s=0;s<i;s++){if(e[s].dim0.canvasX<h){h=e[s].dim0.canvasX;u=s}if(e[s].dim1.canvasX>p){p=e[s].dim1.canvasX;f=s}}if(i===0){d(o,0,0,c.canvasWidth,c.canvasHeight)}var m=L(r);for(s=0;s<i;s++){var g=e[s];var x=g.dim0.crossfilterDimensionIndex;var _=g.dim1.crossfilterDimensionIndex;var b=g.canvasX;var w=g.canvasY;var T=b+g.panelSizeX;if(t||!E[x]||E[x][0]!==b||E[x][1]!==T){E[x]=[b,T];var k=A(c,u,f,s,x,_,b,w,g.panelSizeX,g.panelSizeY,g.dim0.crossfilterDimensionIndex,r?0:n?2:1,m);l.clearOnly=a;var M=t?c.lines.blockLineCount:y;v(o,S,l,M,y,k)}}}function O(e,t){o.read({x:e,y:t,width:1,height:1,data:f});return f}function P(e,t,r,n){var a=new Uint8Array(4*r*n);o.read({x:e,y:t,width:r,height:n,data:a});return a}function D(){e.style["pointer-events"]="none";w.destroy();if(b)b.destroy();for(var t in _)_[t].destroy()}return{render:I,readPixel:O,readPixels:P,destroy:D,update:C}}},{"../../lib":778,"./constants":1153,glslify:439}],1158:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){if(!n)n=Infinity;var a,i;for(a=0;a<t.length;a++){i=t[a];if(i.visible)n=Math.min(n,i[r].length)}if(n===Infinity)n=0;e._length=n;for(a=0;a<t.length;a++){i=t[a];if(i.visible)i._length=n}return n}},{}],1159:[function(e,t,r){"use strict";var n=e("d3");var a=e("color-rgba");var i=e("../../plots/cartesian/axes");var o=e("../../lib");var s=o.strRotate;var l=o.strTranslate;var u=e("../../lib/svg_text_utils");var c=e("../../components/drawing");var f=e("../../components/colorscale");var h=e("../../lib/gup");var p=h.keyFun;var d=h.repeat;var v=h.unwrap;var m=e("./helpers");var g=e("./constants");var y=e("./axisbrush");var x=e("./lines");function _(e,t,r){return o.aggNums(e,null,t,r)}function b(e,t){return T(_(Math.min,e,t),_(Math.max,e,t))}function w(e){var t=e.range;return t?T(t[0],t[1]):b(e.values,e._length)}function T(e,t){if(isNaN(e)||!isFinite(e)){e=0}if(isNaN(t)||!isFinite(t)){t=0}if(e===t){if(e===0){e-=1;t+=1}else{e*=.9;t*=1.1}}return[e,t]}function k(e,t){if(t){return function(r,n){var a=t[n];if(a===null||a===undefined)return e(r);return a}}return e}function A(e,t,r,a,i){var o=w(r);if(a){return n.scale.ordinal().domain(a.map(k(n.format(r.tickformat),i))).range(a.map(function(r){var n=(r-o[0])/(o[1]-o[0]);return e-t+n*(2*t-e)}))}return n.scale.linear().domain(o).range([e-t,t])}function M(e,t){return n.scale.linear().range([t,e-t])}function E(e,t){return n.scale.linear().domain(w(e)).range([t,1-t])}function S(e){if(!e.tickvals)return;var t=w(e);return n.scale.ordinal().domain(e.tickvals).range(e.tickvals.map(function(e){return(e-t[0])/(t[1]-t[0])}))}function C(e){var t=e.map(function(e){return e[0]});var r=e.map(function(e){var t=a(e[1]);return n.rgb("rgb("+t[0]+","+t[1]+","+t[2]+")")});var i=function(e){return function(t){return t[e]}};var o="rgb".split("").map(function(e){return n.scale.linear().clamp(true).domain(t).range(r.map(i(e)))});return function(e){return o.map(function(t){return t(e)})}}function L(e){return e.dimensions.some(function(e){return e.brush.filterSpecified})}function I(e,t,r){var i=v(t);var s=i.trace;var l=m.convertTypedArray(i.lineColor);var u=s.line;var c={color:a(g.deselectedLineColor)};var h=f.extractOpts(u);var p=h.reversescale?f.flipScale(i.cscale):i.cscale;var d=s.domain;var y=s.dimensions;var x=e.width;var _=s.labelangle;var b=s.labelside;var T=s.labelfont;var k=s.tickfont;var A=s.rangefont;var M=o.extendDeepNoArrays({},u,{color:l.map(n.scale.linear().domain(w({values:l,range:[h.min,h.max],_length:s._length}))),blockLineCount:g.blockLineCount,canvasOverdrag:g.overdrag*g.canvasPixelRatio});var E=Math.floor(x*(d.x[1]-d.x[0]));var S=Math.floor(e.height*(d.y[1]-d.y[0]));var L=e.margin||{l:80,r:80,t:100,b:80};var I=E;var O=S;return{key:r,colCount:y.filter(m.isVisible).length,dimensions:y,tickDistance:g.tickDistance,unitToColor:C(p),lines:M,deselectedLines:c,labelAngle:_,labelSide:b,labelFont:T,tickFont:k,rangeFont:A,layoutWidth:x,layoutHeight:e.height,domain:d,translateX:d.x[0]*x,translateY:e.height-d.y[1]*e.height,pad:L,canvasWidth:I*g.canvasPixelRatio+2*M.canvasOverdrag,canvasHeight:O*g.canvasPixelRatio,width:I,height:O,canvasPixelRatio:g.canvasPixelRatio}}function O(e,t,r){var a=r.width;var i=r.height;var s=r.dimensions;var l=r.canvasPixelRatio;var u=function(e){return a*e/Math.max(1,r.colCount-1)};var c=g.verticalPadding/i;var f=M(i,g.verticalPadding);var h={key:r.key,xScale:u,model:r,inBrushDrag:false};var p={};h.dimensions=s.filter(m.isVisible).map(function(a,s){var d=E(a,c);var v=p[a.label];p[a.label]=(v||0)+1;var x=a.label+(v?"__"+v:"");var _=a.constraintrange;var b=_&&_.length;if(b&&!Array.isArray(_[0])){_=[_]}var w=b?_.map(function(e){return e.map(d)}):[[-Infinity,Infinity]];var T=function(){var t=h;t.focusLayer&&t.focusLayer.render(t.panels,true);var r=L(t);if(!e.contextShown()&&r){t.contextLayer&&t.contextLayer.render(t.panels,true);e.contextShown(true)}else if(e.contextShown()&&!r){t.contextLayer&&t.contextLayer.render(t.panels,true,true);e.contextShown(false)}};var k=a.values;if(k.length>a._length){k=k.slice(0,a._length)}var M=a.tickvals;var C;function I(e,t){return{val:e,text:C[t]}}function O(e,t){return e.val-t.val}if(Array.isArray(M)&&M.length){C=a.ticktext;if(!Array.isArray(C)||!C.length){C=M.map(n.format(a.tickformat))}else if(C.length>M.length){C=C.slice(0,M.length)}else if(M.length>C.length){M=M.slice(0,C.length)}for(var P=1;P<M.length;P++){if(M[P]<M[P-1]){var D=M.map(I).sort(O);for(var R=0;R<M.length;R++){M[R]=D[R].val;C[R]=D[R].text}break}}}else M=undefined;k=m.convertTypedArray(k);return{key:x,label:a.label,tickFormat:a.tickformat,tickvals:M,ticktext:C,ordinal:m.isOrdinal(a),multiselect:a.multiselect,xIndex:s,crossfilterDimensionIndex:s,visibleIndex:a._index,height:i,values:k,paddedUnitValues:k.map(d),unitTickvals:M&&M.map(d),xScale:u,x:u(s),canvasX:u(s)*l,unitToPaddedPx:f,domainScale:A(i,g.verticalPadding,a,M,C),ordinalScale:S(a),parent:h,model:r,brush:y.makeBrush(e,b,w,function(){e.linePickActive(false)},T,function(r){h.focusLayer.render(h.panels,true);h.pickLayer&&h.pickLayer.render(h.panels,true);e.linePickActive(true);if(t&&t.filterChanged){var n=d.invert;var i=r.map(function(e){return e.map(n).sort(o.sorterAsc)}).sort(function(e,t){return e[0]-t[0]});t.filterChanged(h.key,a._index,i)}})}});return h}function P(e){e.classed(g.cn.axisExtentText,true).attr("text-anchor","middle").style("cursor","default")}function D(){var e=true;var t=false;return{linePickActive:function(t){return arguments.length?e=!!t:e},contextShown:function(e){return arguments.length?t=!!e:t}}}function R(e,t){var r=t==="top"?1:-1;var n=e*Math.PI/180;var a=Math.sin(n);var i=Math.cos(n);return{dir:r,dx:a,dy:i,degrees:e}}function z(e,t){var r=t.panels||(t.panels=[]);var n=e.data();for(var a=0;a<n.length-1;a++){var i=r[a]||(r[a]={});var o=n[a];var s=n[a+1];i.dim0=o;i.dim1=s;i.canvasX=o.canvasX;i.panelSizeX=s.canvasX-o.canvasX;i.panelSizeY=t.model.canvasHeight;i.y=0;i.canvasY=0}}function N(e){for(var t=0;t<e.length;t++){for(var r=0;r<e[t].length;r++){var n=e[t][r].trace;var a=n.dimensions;for(var o=0;o<a.length;o++){var s=a[o].values;var l=a[o]._ax;if(l){if(!l.range){l.range=b(s,n._length)}else{l.range=T(l.range[0],l.range[1])}if(!l.dtick){l.dtick=.01*(Math.abs(l.range[1]-l.range[0])||1)}l.tickformat=a[o].tickformat;i.calcTicks(l);l.cleanRange()}}}}}function F(e,t){return i.tickText(e._ax,t,false).text}function B(e,t){if(e.ordinal)return"";var r=e.domainScale.domain();var n=r[t?r.length-1:0];return F(e.model.dimensions[e.visibleIndex],n)}t.exports=function e(t,r,a,i){var f=t._fullLayout;var h=f._toppaper;var _=f._glcontainer;N(r);var b=D();var w=r.filter(function(e){return v(e).trace.visible}).map(I.bind(0,a)).map(O.bind(0,b,i));_.each(function(e,t){return o.extendFlat(e,w[t])});var T=_.selectAll(".gl-canvas").each(function(e){e.viewModel=w[0];e.model=e.viewModel?e.viewModel.model:null});var k=null;var A=T.filter(function(e){return e.pick});A.style("pointer-events","auto").on("mousemove",function(e){if(b.linePickActive()&&e.lineLayer&&i&&i.hover){var t=n.event;var r=this.width;var a=this.height;var o=n.mouse(this);var s=o[0];var l=o[1];if(s<0||l<0||s>=r||l>=a){return}var u=e.lineLayer.readPixel(s,a-1-l);var c=u[3]!==0;var f=c?u[2]+256*(u[1]+256*u[0]):null;var h={x:s,y:l,clientX:t.clientX,clientY:t.clientY,dataIndex:e.model.key,curveNumber:f};if(f!==k){if(c){i.hover(h)}else if(i.unhover){i.unhover(h)}k=f}}});T.style("opacity",function(e){return e.pick?0:1});h.style("background","rgba(255, 255, 255, 0)");var M=h.selectAll("."+g.cn.parcoords).data(w,p);M.exit().remove();M.enter().append("g").classed(g.cn.parcoords,true).style("shape-rendering","crispEdges").style("pointer-events","none");M.attr("transform",function(e){return l(e.model.translateX,e.model.translateY)});var E=M.selectAll("."+g.cn.parcoordsControlView).data(d,p);E.enter().append("g").classed(g.cn.parcoordsControlView,true);E.attr("transform",function(e){return l(e.model.pad.l,e.model.pad.t)});var S=E.selectAll("."+g.cn.yAxis).data(function(e){return e.dimensions},p);S.enter().append("g").classed(g.cn.yAxis,true);E.each(function(e){z(S,e)});T.each(function(e){if(e.viewModel){if(!e.lineLayer||i){e.lineLayer=x(this,e)}else e.lineLayer.update(e);if(e.key||e.key===0)e.viewModel[e.key]=e.lineLayer;var t=!e.context||i;e.lineLayer.render(e.viewModel.panels,t)}});S.attr("transform",function(e){return l(e.xScale(e.xIndex),0)});S.call(n.behavior.drag().origin(function(e){return e}).on("drag",function(e){var t=e.parent;b.linePickActive(false);e.x=Math.max(-g.overdrag,Math.min(e.model.width+g.overdrag,n.event.x));e.canvasX=e.x*e.model.canvasPixelRatio;S.sort(function(e,t){return e.x-t.x}).each(function(t,r){t.xIndex=r;t.x=e===t?t.x:t.xScale(t.xIndex);t.canvasX=t.x*t.model.canvasPixelRatio});z(S,t);S.filter(function(t){return Math.abs(e.xIndex-t.xIndex)!==0}).attr("transform",function(e){return l(e.xScale(e.xIndex),0)});n.select(this).attr("transform",l(e.x,0));S.each(function(r,n,a){if(a===e.parent.key)t.dimensions[n]=r});t.contextLayer&&t.contextLayer.render(t.panels,false,!L(t));t.focusLayer.render&&t.focusLayer.render(t.panels)}).on("dragend",function(e){var t=e.parent;e.x=e.xScale(e.xIndex);e.canvasX=e.x*e.model.canvasPixelRatio;z(S,t);n.select(this).attr("transform",function(e){return l(e.x,0)});t.contextLayer&&t.contextLayer.render(t.panels,false,!L(t));t.focusLayer&&t.focusLayer.render(t.panels);t.pickLayer&&t.pickLayer.render(t.panels,true);b.linePickActive(true);if(i&&i.axesMoved){i.axesMoved(t.key,t.dimensions.map(function(e){return e.crossfilterDimensionIndex}))}}));S.exit().remove();var C=S.selectAll("."+g.cn.axisOverlays).data(d,p);C.enter().append("g").classed(g.cn.axisOverlays,true);C.selectAll("."+g.cn.axis).remove();var j=C.selectAll("."+g.cn.axis).data(d,p);j.enter().append("g").classed(g.cn.axis,true);j.each(function(e){var t=e.model.height/e.model.tickDistance;var r=e.domainScale;var a=r.domain();n.select(this).call(n.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(t,e.tickFormat).tickValues(e.ordinal?a:null).tickFormat(function(t){return m.isOrdinal(e)?t:F(e.model.dimensions[e.visibleIndex],t)}).scale(r));c.font(j.selectAll("text"),e.model.tickFont)});j.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px");j.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default");var U=C.selectAll("."+g.cn.axisHeading).data(d,p);U.enter().append("g").classed(g.cn.axisHeading,true);var H=U.selectAll("."+g.cn.axisTitle).data(d,p);H.enter().append("text").classed(g.cn.axisTitle,true).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto");H.text(function(e){return e.label}).each(function(e){var r=n.select(this);c.font(r,e.model.labelFont);u.convertToTspans(r,t)}).attr("transform",function(e){var t=R(e.model.labelAngle,e.model.labelSide);var r=g.axisTitleOffset;return(t.dir>0?"":l(0,2*r+e.model.height))+s(t.degrees)+l(-r*t.dx,-r*t.dy)}).attr("text-anchor",function(e){var t=R(e.model.labelAngle,e.model.labelSide);var r=Math.abs(t.dx);var n=Math.abs(t.dy);if(2*r>n){return t.dir*t.dx<0?"start":"end"}else{return"middle"}});var V=C.selectAll("."+g.cn.axisExtent).data(d,p);V.enter().append("g").classed(g.cn.axisExtent,true);var G=V.selectAll("."+g.cn.axisExtentTop).data(d,p);G.enter().append("g").classed(g.cn.axisExtentTop,true);G.attr("transform",l(0,-g.axisExtentOffset));var q=G.selectAll("."+g.cn.axisExtentTopText).data(d,p);q.enter().append("text").classed(g.cn.axisExtentTopText,true).call(P);q.text(function(e){return B(e,true)}).each(function(e){c.font(n.select(this),e.model.rangeFont)});var Y=V.selectAll("."+g.cn.axisExtentBottom).data(d,p);Y.enter().append("g").classed(g.cn.axisExtentBottom,true);Y.attr("transform",function(e){return l(0,e.model.height+g.axisExtentOffset)});var W=Y.selectAll("."+g.cn.axisExtentBottomText).data(d,p);W.enter().append("text").classed(g.cn.axisExtentBottomText,true).attr("dy","0.75em").call(P);W.text(function(e){return B(e,false)}).each(function(e){c.font(n.select(this),e.model.rangeFont)});y.ensureAxisBrush(C)}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"./axisbrush":1150,"./constants":1153,"./helpers":1155,"./lines":1157,"color-rgba":127,d3:169}],1160:[function(e,t,r){"use strict";var n=e("./parcoords");var a=e("../../lib/prepare_regl");var i=e("./helpers").isVisible;function o(e,t,r){var n=t.indexOf(r);var a=e.indexOf(n);if(a===-1){a+=t.length}return a}function s(e,t){return function r(n,a){return o(e,t,n)-o(e,t,a)}}t.exports=function e(t,r){var o=t._fullLayout;var l=a(t);if(!l)return;var u={};var c={};var f={};var h={};var p=o._size;r.forEach(function(e,r){var n=e[0].trace;f[r]=n.index;var a=h[r]=n._fullInput.index;u[r]=t.data[a].dimensions;c[r]=t.data[a].dimensions.slice()});var d=function(e,r,n){var a=c[e][r];var i=n.map(function(e){return e.slice()});var s="dimensions["+r+"].constraintrange";var l=o._tracePreGUI[t._fullData[f[e]]._fullInput.uid];if(l[s]===undefined){var u=a.constraintrange;l[s]=u||null}var p=t._fullData[f[e]].dimensions[r];if(!i.length){delete a.constraintrange;delete p.constraintrange;i=null}else{if(i.length===1)i=i[0];a.constraintrange=i;p.constraintrange=i.slice();i=[i]}var d={};d[s]=i;t.emit("plotly_restyle",[d,[h[e]]])};var v=function(e){t.emit("plotly_hover",e)};var m=function(e){t.emit("plotly_unhover",e)};var g=function(e,r){var n=s(r,c[e].filter(i));u[e].sort(n);c[e].filter(function(e){return!i(e)}).sort(function(t){return c[e].indexOf(t)}).forEach(function(t){u[e].splice(u[e].indexOf(t),1);u[e].splice(c[e].indexOf(t),0,t)});t.emit("plotly_restyle",[{dimensions:[u[e]]},[h[e]]])};n(t,r,{width:p.w,height:p.h,margin:{t:p.t,r:p.r,b:p.b,l:p.l}},{filterChanged:d,hover:v,unhover:m,axesMoved:g})}},{"../../lib/prepare_regl":791,"./helpers":1155,"./parcoords":1159}],1161:[function(e,t,r){"use strict";var n=e("../../plots/attributes");var a=e("../../plots/domain").attributes;var i=e("../../plots/font_attributes");var o=e("../../components/color/attributes");var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../plots/template_attributes").texttemplateAttrs;var u=e("../../lib/extend").extendFlat;var c=i({editType:"plot",arrayOk:true,colorEditType:"plot"});t.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:o.defaultLine,arrayOk:true,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:true,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:u({},n.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:s({},{keys:["label","color","value","percent","text"]}),texttemplate:l({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:true,editType:"plot"},textfont:u({},c,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:u({},c,{}),outsidetextfont:u({},c,{}),automargin:{valType:"boolean",dflt:false,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:u({},c,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:a({name:"pie",trace:true,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:true,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:true,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:u({},c,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1162:[function(e,t,r){"use strict";var n=e("../../plots/plots");r.name="pie";r.plot=function(e,t,a,i){n.plotBasePlot(r.name,e,t,a,i)};r.clean=function(e,t,a,i){n.cleanBasePlot(r.name,e,t,a,i)}},{"../../plots/plots":891}],1163:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("tinycolor2");var i=e("../../components/color");var o={};function s(e,t){var r=[];var a=e._fullLayout;var i=a.hiddenlabels||[];var o=t.labels;var s=t.marker.colors||[];var u=t.values;var c=t._length;var f=t._hasValues&&c;var h,p;if(t.dlabel){o=new Array(c);for(h=0;h<c;h++){o[h]=String(t.label0+h*t.dlabel)}}var d={};var v=l(a["_"+t.type+"colormap"]);var m=0;var g=false;for(h=0;h<c;h++){var y,x,_;if(f){y=u[h];if(!n(y))continue;y=+y;if(y<0)continue}else y=1;x=o[h];if(x===undefined||x==="")x=h;x=String(x);var b=d[x];if(b===undefined){d[x]=r.length;_=i.indexOf(x)!==-1;if(!_)m+=y;r.push({v:y,label:x,color:v(s[h],x),i:h,pts:[h],hidden:_})}else{g=true;p=r[b];p.v+=y;p.pts.push(h);if(!p.hidden)m+=y;if(p.color===false&&s[h]){p.color=v(s[h],x)}}}var w=t.type==="funnelarea"?g:t.sort;if(w)r.sort(function(e,t){return t.v-e.v});if(r[0])r[0].vTotal=m;return r}function l(e){return function t(r,n){if(!r)return false;r=a(r);if(!r.isValid())return false;r=i.addOpacity(r,r.getAlpha());if(!e[n])e[n]=r;return r}}function u(e,t){var r=(t||{}).type;if(!r)r="pie";var n=e._fullLayout;var a=e.calcdata;var i=n[r+"colorway"];var s=n["_"+r+"colormap"];if(n["extend"+r+"colors"]){i=c(i,o)}var l=0;for(var u=0;u<a.length;u++){var f=a[u];var h=f[0].trace.type;if(h!==r)continue;for(var p=0;p<f.length;p++){var d=f[p];if(d.color===false){if(s[d.label]){d.color=s[d.label]}else{s[d.label]=d.color=i[l%i.length];l++}}}}}function c(e,t){var r;var n=JSON.stringify(e);var i=t[n];if(!i){i=e.slice();for(r=0;r<e.length;r++){i.push(a(e[r]).lighten(20).toHexString())}for(r=0;r<e.length;r++){i.push(a(e[r]).darken(20).toHexString())}t[n]=i}return i}t.exports={calc:s,crossTraceCalc:u,makePullColorFn:l,generateExtendedColors:c}},{"../../components/color":643,"fast-isnumeric":241,tinycolor2:576}],1164:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("./attributes");var o=e("../../plots/domain").defaults;var s=e("../bar/defaults").handleText;function l(e,t){var r=Array.isArray(e);var i=a.isArrayOrTypedArray(t);var o=Math.min(r?e.length:Infinity,i?t.length:Infinity);if(!isFinite(o))o=0;if(o&&i){var s;for(var l=0;l<o;l++){var u=t[l];if(n(u)&&u>0){s=true;break}}if(!s)o=0}return{hasLabels:r,hasValues:i,len:o}}function u(e,t,r,n){function u(r,n){return a.coerce(e,t,i,r,n)}var c=u("labels");var f=u("values");var h=l(c,f);var p=h.len;t._hasLabels=h.hasLabels;t._hasValues=h.hasValues;if(!t._hasLabels&&t._hasValues){u("label0");u("dlabel")}if(!p){t.visible=false;return}t._length=p;var d=u("marker.line.width");if(d)u("marker.line.color");u("marker.colors");u("scalegroup");var v=u("text");var m=u("texttemplate");var g;if(!m)g=u("textinfo",Array.isArray(v)?"text+percent":"percent");u("hovertext");u("hovertemplate");if(m||g&&g!=="none"){var y=u("textposition");s(e,t,n,u,y,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});var x=Array.isArray(y)||y==="auto";var _=x||y==="outside";if(_){u("automargin")}if(y==="inside"||y==="auto"||Array.isArray(y)){u("insidetextorientation")}}o(t,n,u);var b=u("hole");var w=u("title.text");if(w){var T=u("title.position",b?"middle center":"top center");if(!b&&T==="middle center")t.title.position="top center";a.coerceFont(u,"title.font",n.font)}u("sort");u("direction");u("rotation");u("pull")}t.exports={handleLabelsAndValues:l,supplyDefaults:u}},{"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"./attributes":1161,"fast-isnumeric":241}],1165:[function(e,t,r){"use strict";var n=e("../../components/fx/helpers").appendArrayMultiPointValues;t.exports=function e(t,r){var a={curveNumber:r.index,pointNumbers:t.pts,data:r._input,fullData:r,label:t.label,color:t.color,value:t.v,percent:t.percent,text:t.text,v:t.v};if(t.pts.length===1)a.pointNumber=a.i=t.pts[0];n(a,r,t.pts);if(r.type==="funnelarea"){delete a.v;delete a.i}return a}},{"../../components/fx/helpers":679}],1166:[function(e,t,r){"use strict";var n=e("../../lib");function a(e){return e.indexOf("e")!==-1?e.replace(/[.]?0+e/,"e"):e.indexOf(".")!==-1?e.replace(/[.]?0+$/,""):e}r.formatPiePercent=function e(t,r){var i=a((t*100).toPrecision(3));return n.numSeparate(i,r)+"%"};r.formatPieValue=function e(t,r){var i=a(t.toPrecision(10));return n.numSeparate(i,r)};r.getFirstFilled=function e(t,r){if(!Array.isArray(t))return;for(var n=0;n<r.length;n++){var a=t[r[n]];if(a||a===0||a==="")return a}};r.castOption=function e(t,n){if(Array.isArray(t))return r.getFirstFilled(t,n);else if(t)return t};r.getRotationAngle=function(e){return(e==="auto"?0:e)*Math.PI/180}},{"../../lib":778}],1167:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,supplyLayoutDefaults:e("./layout_defaults"),layoutAttributes:e("./layout_attributes"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style"),styleOne:e("./style_one"),moduleType:"trace",name:"pie",basePlotModule:e("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1161,"./base_plot":1162,"./calc":1163,"./defaults":1164,"./layout_attributes":1168,"./layout_defaults":1169,"./plot":1170,"./style":1171,"./style_one":1172}],1168:[function(e,t,r){"use strict";t.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1169:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return n.coerce(t,r,a,e,i)}i("hiddenlabels");i("piecolorway",r.colorway);i("extendpiecolors")}},{"../../lib":778,"./layout_attributes":1168}],1170:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../plots/plots");var i=e("../../components/fx");var o=e("../../components/color");var s=e("../../components/drawing");var l=e("../../lib");var u=l.strScale;var c=l.strTranslate;var f=e("../../lib/svg_text_utils");var h=e("../bar/uniform_text");var p=h.recordMinTextSize;var d=h.clearMinTextSize;var v=e("../bar/constants").TEXTPAD;var m=e("./helpers");var g=e("./event_data");var y=e("../../lib").isValidTextValue;function x(e,t){var r=e._fullLayout;var i=r._size;d("pie",r);k(t,e);j(t,i);var o=l.makeTraceGroups(r._pielayer,t,"trace").each(function(t){var o=n.select(this);var h=t[0];var d=h.trace;H(t);o.attr("stroke-linejoin","round");o.each(function(){var v=n.select(this).selectAll("g.slice").data(t);v.enter().append("g").classed("slice",true);v.exit().remove();var g=[[[],[]],[[],[]]];var y=false;v.each(function(a,i){if(a.hidden){n.select(this).selectAll("path,g").remove();return}a.pointNumber=a.i;a.curveNumber=d.index;g[a.pxmid[1]<0?0:1][a.pxmid[0]<0?0:1].push(a);var o=h.cx;var u=h.cy;var c=n.select(this);var v=c.selectAll("path.surface").data([a]);v.enter().append("path").classed("surface",true).style({"pointer-events":"all"});c.call(b,e,t);if(d.pull){var x=+m.castOption(d.pull,a.pts)||0;if(x>0){o+=x*a.pxmid[0];u+=x*a.pxmid[1]}}a.cxFinal=o;a.cyFinal=u;function _(e,t,r,n){var i=n*(t[0]-e[0]);var o=n*(t[1]-e[1]);return"a"+n*h.r+","+n*h.r+" 0 "+a.largeArc+(r?" 1 ":" 0 ")+i+","+o}var k=d.hole;if(a.v===h.vTotal){var M="M"+(o+a.px0[0])+","+(u+a.px0[1])+_(a.px0,a.pxmid,true,1)+_(a.pxmid,a.px0,true,1)+"Z";if(k){v.attr("d","M"+(o+k*a.px0[0])+","+(u+k*a.px0[1])+_(a.px0,a.pxmid,false,k)+_(a.pxmid,a.px0,false,k)+"Z"+M)}else v.attr("d",M)}else{var E=_(a.px0,a.px1,true,1);if(k){var S=1-k;v.attr("d","M"+(o+k*a.px1[0])+","+(u+k*a.px1[1])+_(a.px1,a.px0,false,k)+"l"+S*a.px0[0]+","+S*a.px0[1]+E+"Z")}else{v.attr("d","M"+o+","+u+"l"+a.px0[0]+","+a.px0[1]+E+"Z")}}G(e,a,h);var C=m.castOption(d.textposition,a.pts);var L=c.selectAll("g.slicetext").data(a.text&&C!=="none"?[0]:[]);L.enter().append("g").classed("slicetext",true);L.exit().remove();L.each(function(){var c=l.ensureSingle(n.select(this),"text","",function(e){e.attr("data-notex",1)});var v=l.ensureUniformFontSize(e,C==="outside"?w(d,a,r.font):T(d,a,r.font));c.text(a.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(s.font,v).call(f.convertToTspans,e);var m=s.bBox(c.node());var g;if(C==="outside"){g=P(m,a)}else{g=A(m,a,h);if(C==="auto"&&g.scale<1){var x=l.ensureUniformFontSize(e,d.outsidetextfont);c.call(s.font,x);m=s.bBox(c.node());g=P(m,a)}}var _=g.textPosAngle;var b=_===undefined?a.pxmid:V(h.r,_);g.targetX=o+b[0]*g.rCenter+(g.x||0);g.targetY=u+b[1]*g.rCenter+(g.y||0);q(g,m);if(g.outside){var k=g.targetY;a.yLabelMin=k-m.height/2;a.yLabelMid=k;a.yLabelMax=k+m.height/2;a.labelExtraX=0;a.labelExtraY=0;y=true}g.fontSize=v.size;p(d.type,g,r);t[i].transform=g;c.attr("transform",l.getTextTransform(g))})});var x=n.select(this).selectAll("g.titletext").data(d.title.text?[0]:[]);x.enter().append("g").classed("titletext",true);x.exit().remove();x.each(function(){var t=l.ensureSingle(n.select(this),"text","",function(e){e.attr("data-notex",1)});var r=d.title.text;if(d._meta){r=l.templateString(r,d._meta)}t.text(r).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(s.font,d.title.font).call(f.convertToTspans,e);var a;if(d.title.position==="middle center"){a=D(h)}else{a=R(h,i)}t.attr("transform",c(a.x,a.y)+u(Math.min(1,a.scale))+c(a.tx,a.ty))});if(y)B(g,d);_(v,d);if(y&&d.automargin){var k=s.bBox(o.node());var M=d.domain;var E=i.w*(M.x[1]-M.x[0]);var S=i.h*(M.y[1]-M.y[0]);var C=(.5*E-h.r)/i.w;var L=(.5*S-h.r)/i.h;a.autoMargin(e,"pie."+d.uid+".automargin",{xl:M.x[0]-C,xr:M.x[1]+C,yb:M.y[0]-L,yt:M.y[1]+L,l:Math.max(h.cx-h.r-k.left,0),r:Math.max(k.right-(h.cx+h.r),0),b:Math.max(k.bottom-(h.cy+h.r),0),t:Math.max(h.cy-h.r-k.top,0),pad:5})}})});setTimeout(function(){o.selectAll("tspan").each(function(){var e=n.select(this);if(e.attr("dy"))e.attr("dy",e.attr("dy"))})},0)}function _(e,t){e.each(function(e){var r=n.select(this);if(!e.labelExtraX&&!e.labelExtraY){r.select("path.textline").remove();return}var a=r.select("g.slicetext text");e.transform.targetX+=e.labelExtraX;e.transform.targetY+=e.labelExtraY;a.attr("transform",l.getTextTransform(e.transform));var i=e.cxFinal+e.pxmid[0];var s=e.cyFinal+e.pxmid[1];var u="M"+i+","+s;var c=(e.yLabelMax-e.yLabelMin)*(e.pxmid[0]<0?-1:1)/4;if(e.labelExtraX){var f=e.labelExtraX*e.pxmid[1]/e.pxmid[0];var h=e.yLabelMid+e.labelExtraY-(e.cyFinal+e.pxmid[1]);if(Math.abs(f)>Math.abs(h)){u+="l"+h*e.pxmid[0]/e.pxmid[1]+","+h+"H"+(i+e.labelExtraX+c)}else{u+="l"+e.labelExtraX+","+f+"v"+(h-f)+"h"+c}}else{u+="V"+(e.yLabelMid+e.labelExtraY)+"h"+c}l.ensureSingle(r,"path","textline").call(o.stroke,t.outsidetextfont.color).attr({"stroke-width":Math.min(2,t.outsidetextfont.size/8),d:u,fill:"none"})})}function b(e,t,r){var a=r[0];var o=a.trace;var s=a.cx;var u=a.cy;if(!("_hasHoverLabel"in o))o._hasHoverLabel=false;if(!("_hasHoverEvent"in o))o._hasHoverEvent=false;e.on("mouseover",function(e){var r=t._fullLayout;var c=t._fullData[o.index];if(t._dragging||r.hovermode===false)return;var f=c.hoverinfo;if(Array.isArray(f)){f=i.castHoverinfo({hoverinfo:[m.castOption(f,e.pts)],_module:o._module},r,0)}if(f==="all")f="label+text+value+percent+name";if(c.hovertemplate||f!=="none"&&f!=="skip"&&f){var h=e.rInscribed||0;var p=s+e.pxmid[0]*(1-h);var d=u+e.pxmid[1]*(1-h);var v=r.separators;var y=[];if(f&&f.indexOf("label")!==-1)y.push(e.label);e.text=m.castOption(c.hovertext||c.text,e.pts);if(f&&f.indexOf("text")!==-1){var x=e.text;if(l.isValidTextValue(x))y.push(x)}e.value=e.v;e.valueLabel=m.formatPieValue(e.v,v);if(f&&f.indexOf("value")!==-1)y.push(e.valueLabel);e.percent=e.v/a.vTotal;e.percentLabel=m.formatPiePercent(e.percent,v);if(f&&f.indexOf("percent")!==-1)y.push(e.percentLabel);var _=c.hoverlabel;var b=_.font;i.loneHover({trace:o,x0:p-h*a.r,x1:p+h*a.r,y:d,text:y.join("<br>"),name:c.hovertemplate||f.indexOf("name")!==-1?c.name:undefined,idealAlign:e.pxmid[0]<0?"left":"right",color:m.castOption(_.bgcolor,e.pts)||e.color,borderColor:m.castOption(_.bordercolor,e.pts),fontFamily:m.castOption(b.family,e.pts),fontSize:m.castOption(b.size,e.pts),fontColor:m.castOption(b.color,e.pts),nameLength:m.castOption(_.namelength,e.pts),textAlign:m.castOption(_.align,e.pts),hovertemplate:m.castOption(c.hovertemplate,e.pts),hovertemplateLabels:e,eventData:[g(e,c)]},{container:r._hoverlayer.node(),outerContainer:r._paper.node(),gd:t});o._hasHoverLabel=true}o._hasHoverEvent=true;t.emit("plotly_hover",{points:[g(e,c)],event:n.event})});e.on("mouseout",function(e){var r=t._fullLayout;var a=t._fullData[o.index];var s=n.select(this).datum();if(o._hasHoverEvent){e.originalEvent=n.event;t.emit("plotly_unhover",{points:[g(s,a)],event:n.event});o._hasHoverEvent=false}if(o._hasHoverLabel){i.loneUnhover(r._hoverlayer.node());o._hasHoverLabel=false}});e.on("click",function(e){var r=t._fullLayout;var a=t._fullData[o.index];if(t._dragging||r.hovermode===false)return;t._hoverdata=[g(e,a)];i.click(t,n.event)})}function w(e,t,r){var n=m.castOption(e.outsidetextfont.color,t.pts)||m.castOption(e.textfont.color,t.pts)||r.color;var a=m.castOption(e.outsidetextfont.family,t.pts)||m.castOption(e.textfont.family,t.pts)||r.family;var i=m.castOption(e.outsidetextfont.size,t.pts)||m.castOption(e.textfont.size,t.pts)||r.size;return{color:n,family:a,size:i}}function T(e,t,r){var n=m.castOption(e.insidetextfont.color,t.pts);if(!n&&e._input.textfont){n=m.castOption(e._input.textfont.color,t.pts)}var a=m.castOption(e.insidetextfont.family,t.pts)||m.castOption(e.textfont.family,t.pts)||r.family;var i=m.castOption(e.insidetextfont.size,t.pts)||m.castOption(e.textfont.size,t.pts)||r.size;return{color:n||o.contrast(t.color),family:a,size:i}}function k(e,t){var r,n;for(var a=0;a<e.length;a++){r=e[a][0];n=r.trace;if(n.title.text){var i=n.title.text;if(n._meta){i=l.templateString(i,n._meta)}var o=s.tester.append("text").attr("data-notex",1).text(i).call(s.font,n.title.font).call(f.convertToTspans,t);var u=s.bBox(o.node(),true);r.titleBox={width:u.width,height:u.height};o.remove()}}}function A(e,t,r){var n=r.r||t.rpx1;var a=t.rInscribed;var i=t.startangle===t.stopangle;if(i){return{rCenter:1-a,scale:0,rotate:0,textPosAngle:0}}var o=t.ring;var s=o===1&&Math.abs(t.startangle-t.stopangle)===Math.PI*2;var l=t.halfangle;var u=t.midangle;var c=r.trace.insidetextorientation;var f=c==="horizontal";var h=c==="tangential";var p=c==="radial";var d=c==="auto";var v=[];var m;if(!d){var g=function(r,a){if(M(t,r)){var i=Math.abs(r-t.startangle);var s=Math.abs(r-t.stopangle);var l=i<s?i:s;if(a==="tan"){m=S(e,n,o,l,0)}else{m=E(e,n,o,l,Math.PI/2)}m.textPosAngle=r;v.push(m)}};var y;if(f||h){for(y=4;y>=-4;y-=2)g(Math.PI*y,"tan");for(y=4;y>=-4;y-=2)g(Math.PI*(y+1),"tan")}if(f||p){for(y=4;y>=-4;y-=2)g(Math.PI*(y+1.5),"rad");for(y=4;y>=-4;y-=2)g(Math.PI*(y+.5),"rad")}}if(s||d||f){var x=Math.sqrt(e.width*e.width+e.height*e.height);m={scale:a*n*2/x,rCenter:1-a,rotate:0};m.textPosAngle=(t.startangle+t.stopangle)/2;if(m.scale>=1)return m;v.push(m)}if(d||p){m=E(e,n,o,l,u);m.textPosAngle=(t.startangle+t.stopangle)/2;v.push(m)}if(d||h){m=S(e,n,o,l,u);m.textPosAngle=(t.startangle+t.stopangle)/2;v.push(m)}var _=0;var b=0;for(var w=0;w<v.length;w++){var T=v[w].scale;if(b<T){b=T;_=w}if(!d&&b>=1){break}}return v[_]}function M(e,t){var r=e.startangle;var n=e.stopangle;return r>t&&t>n||r<t&&t<n}function E(e,t,r,n,a){t=Math.max(0,t-2*v);var i=e.width/e.height;var o=I(i,n,t,r);return{scale:o*2/e.height,rCenter:C(i,o/t),rotate:L(a)}}function S(e,t,r,n,a){t=Math.max(0,t-2*v);var i=e.height/e.width;var o=I(i,n,t,r);return{scale:o*2/e.width,rCenter:C(i,o/t),rotate:L(a+Math.PI/2)}}function C(e,t){return Math.cos(t)-e*t}function L(e){return(180/Math.PI*e+720)%180-90}function I(e,t,r,n){var a=e+1/(2*Math.tan(t));return r*Math.min(1/(Math.sqrt(a*a+.5)+a),n/(Math.sqrt(e*e+n/2)+e))}function O(e,t){if(e.v===t.vTotal&&!t.trace.hole)return 1;return Math.min(1/(1+1/Math.sin(e.halfangle)),e.ring/2)}function P(e,t){var r=t.pxmid[0];var n=t.pxmid[1];var a=e.width/2;var i=e.height/2;if(r<0)a*=-1;if(n<0)i*=-1;return{scale:1,rCenter:1,rotate:0,x:a+Math.abs(i)*(a>0?1:-1)/2,y:i/(1+r*r/(n*n)),outside:true}}function D(e){var t=Math.sqrt(e.titleBox.width*e.titleBox.width+e.titleBox.height*e.titleBox.height);return{x:e.cx,y:e.cy,scale:e.trace.hole*e.r*2/t,tx:0,ty:-e.titleBox.height/2+e.trace.title.font.size}}function R(e,t){var r=1;var n=1;var a;var i=e.trace;var o={x:e.cx,y:e.cy};var s={tx:0,ty:0};s.ty+=i.title.font.size;a=F(i);if(i.title.position.indexOf("top")!==-1){o.y-=(1+a)*e.r;s.ty-=e.titleBox.height}else if(i.title.position.indexOf("bottom")!==-1){o.y+=(1+a)*e.r}var l=z(e.r,e.trace.aspectratio);var u=t.w*(i.domain.x[1]-i.domain.x[0])/2;if(i.title.position.indexOf("left")!==-1){u=u+l;o.x-=(1+a)*l;s.tx+=e.titleBox.width/2}else if(i.title.position.indexOf("center")!==-1){u*=2}else if(i.title.position.indexOf("right")!==-1){u=u+l;o.x+=(1+a)*l;s.tx-=e.titleBox.width/2}r=u/e.titleBox.width;n=N(e,t)/e.titleBox.height;return{x:o.x,y:o.y,scale:Math.min(r,n),tx:s.tx,ty:s.ty}}function z(e,t){return e/(t===undefined?1:t)}function N(e,t){var r=e.trace;var n=t.h*(r.domain.y[1]-r.domain.y[0]);return Math.min(e.titleBox.height,n/2)}function F(e){var t=e.pull;if(!t)return 0;var r;if(Array.isArray(t)){t=0;for(r=0;r<e.pull.length;r++){if(e.pull[r]>t)t=e.pull[r]}}return t}function B(e,t){var r,n,a,i,o,s,l,u,c,f,h,p,d;function v(e,t){return e.pxmid[1]-t.pxmid[1]}function g(e,t){return t.pxmid[1]-e.pxmid[1]}function y(e,r){if(!r)r={};var a=r.labelExtraY+(n?r.yLabelMax:r.yLabelMin);var u=n?e.yLabelMin:e.yLabelMax;var c=n?e.yLabelMax:e.yLabelMin;var h=e.cyFinal+o(e.px0[1],e.px1[1]);var p=a-u;var d,v,g,y,x,_;if(p*l>0)e.labelExtraY=p;if(!Array.isArray(t.pull))return;for(v=0;v<f.length;v++){g=f[v];if(g===e||(m.castOption(t.pull,e.pts)||0)>=(m.castOption(t.pull,g.pts)||0)){continue}if((e.pxmid[1]-g.pxmid[1])*l>0){y=g.cyFinal+o(g.px0[1],g.px1[1]);p=y-u-e.labelExtraY;if(p*l>0)e.labelExtraY+=p}else if((c+e.labelExtraY-h)*l>0){d=3*s*Math.abs(v-f.indexOf(e));x=g.cxFinal+i(g.px0[0],g.px1[0]);_=x+d-(e.cxFinal+e.pxmid[0])-e.labelExtraX;if(_*s>0)e.labelExtraX+=_}}}for(n=0;n<2;n++){a=n?v:g;o=n?Math.max:Math.min;l=n?1:-1;for(r=0;r<2;r++){i=r?Math.max:Math.min;s=r?1:-1;u=e[n][r];u.sort(a);c=e[1-n][r];f=c.concat(u);p=[];for(h=0;h<u.length;h++){if(u[h].yLabelMid!==undefined)p.push(u[h])}d=false;for(h=0;n&&h<c.length;h++){if(c[h].yLabelMid!==undefined){d=c[h];break}}for(h=0;h<p.length;h++){var x=h&&p[h-1];if(d&&!h)x=d;y(p[h],x)}}}}function j(e,t){var r=[];for(var n=0;n<e.length;n++){var a=e[n][0];var i=a.trace;var o=i.domain;var s=t.w*(o.x[1]-o.x[0]);var l=t.h*(o.y[1]-o.y[0]);if(i.title.text&&i.title.position!=="middle center"){l-=N(a,t)}var u=s/2;var c=l/2;if(i.type==="funnelarea"&&!i.scalegroup){c/=i.aspectratio}a.r=Math.min(u,c)/(1+F(i));a.cx=t.l+t.w*(i.domain.x[1]+i.domain.x[0])/2;a.cy=t.t+t.h*(1-i.domain.y[0])-l/2;if(i.title.text&&i.title.position.indexOf("bottom")!==-1){a.cy-=N(a,t)}if(i.scalegroup&&r.indexOf(i.scalegroup)===-1){r.push(i.scalegroup)}}U(e,r)}function U(e,t){var r,n,a;for(var i=0;i<t.length;i++){var o=Infinity;var s=t[i];for(n=0;n<e.length;n++){r=e[n][0];a=r.trace;if(a.scalegroup===s){var l;if(a.type==="pie"){l=r.r*r.r}else if(a.type==="funnelarea"){var u,c;if(a.aspectratio>1){u=r.r;c=u/a.aspectratio}else{c=r.r;u=c*a.aspectratio}u*=(1+a.baseratio)/2;l=u*c}o=Math.min(o,l/r.vTotal)}}for(n=0;n<e.length;n++){r=e[n][0];a=r.trace;if(a.scalegroup===s){var f=o*r.vTotal;if(a.type==="funnelarea"){f/=(1+a.baseratio)/2;f/=a.aspectratio}r.r=Math.sqrt(f)}}}}function H(e){var t=e[0];var r=t.r;var n=t.trace;var a=m.getRotationAngle(n.rotation);var i=2*Math.PI/t.vTotal;var o="px0";var s="px1";var l,u,c;if(n.direction==="counterclockwise"){for(l=0;l<e.length;l++){if(!e[l].hidden)break}if(l===e.length)return;a+=i*e[l].v;i*=-1;o="px1";s="px0"}c=V(r,a);for(l=0;l<e.length;l++){u=e[l];if(u.hidden)continue;u[o]=c;u.startangle=a;a+=i*u.v/2;u.pxmid=V(r,a);u.midangle=a;a+=i*u.v/2;c=V(r,a);u.stopangle=a;u[s]=c;u.largeArc=u.v>t.vTotal/2?1:0;u.halfangle=Math.PI*Math.min(u.v/t.vTotal,.5);u.ring=1-n.hole;u.rInscribed=O(u,t)}}function V(e,t){return[e*Math.sin(t),-e*Math.cos(t)]}function G(e,t,r){var n=e._fullLayout;var a=r.trace;var i=a.texttemplate;var o=a.textinfo;if(!i&&o&&o!=="none"){var s=o.split("+");var u=function(e){return s.indexOf(e)!==-1};var c=u("label");var f=u("text");var h=u("value");var p=u("percent");var d=n.separators;var v;v=c?[t.label]:[];if(f){var g=m.getFirstFilled(a.text,t.pts);if(y(g))v.push(g)}if(h)v.push(m.formatPieValue(t.v,d));if(p)v.push(m.formatPiePercent(t.v/r.vTotal,d));t.text=v.join("<br>")}function x(e){return{label:e.label,value:e.v,valueLabel:m.formatPieValue(e.v,n.separators),percent:e.v/r.vTotal,percentLabel:m.formatPiePercent(e.v/r.vTotal,n.separators),color:e.color,text:e.text,customdata:l.castOption(a,e.i,"customdata")}}if(i){var _=l.castOption(a,t.i,"texttemplate");if(!_){t.text=""}else{var b=x(t);var w=m.getFirstFilled(a.text,t.pts);if(y(w)||w==="")b.text=w;t.text=l.texttemplateString(_,b,e._fullLayout._d3locale,b,a._meta||{})}}}function q(e,t){var r=e.rotate*Math.PI/180;var n=Math.cos(r);var a=Math.sin(r);var i=(t.left+t.right)/2;var o=(t.top+t.bottom)/2;e.textX=i*n-o*a;e.textY=i*a+o*n;e.noCenter=true}t.exports={plot:x,formatSliceLabel:G,transformInsideText:A,determineInsideTextFont:T,positionTitleOutside:R,prerenderTitles:k,layoutAreas:j,attachFxHandlers:b,computeTransform:q}},{"../../components/color":643,"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../bar/constants":923,"../bar/uniform_text":937,"./event_data":1165,"./helpers":1166,d3:169}],1171:[function(e,t,r){"use strict";var n=e("d3");var a=e("./style_one");var i=e("../bar/uniform_text").resizeText;t.exports=function e(t){var r=t._fullLayout._pielayer.selectAll(".trace");i(t,r,"pie");r.each(function(e){var t=e[0];var r=t.trace;var i=n.select(this);i.style({opacity:r.opacity});i.selectAll("path.surface").each(function(e){n.select(this).call(a,e,r)})})}},{"../bar/uniform_text":937,"./style_one":1172,d3:169}],1172:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("./helpers").castOption;t.exports=function e(t,r,i){var o=i.marker.line;var s=a(o.color,r.pts)||n.defaultLine;var l=a(o.width,r.pts)||0;t.style("stroke-width",l).call(n.fill,r.color).call(n.stroke,s)}},{"../../components/color":643,"./helpers":1166}],1173:[function(e,t,r){"use strict";var n=e("../scatter/attributes");t.exports={x:n.x,y:n.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:n.text,marker:{color:{valType:"color",arrayOk:false,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:false,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:false,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:undefined}},{"../scatter/attributes":1187}],1174:[function(e,t,r){"use strict";var n=e("gl-pointcloud2d");var a=e("../../lib/str2rgbarray");var i=e("../../plots/cartesian/autorange").findExtremes;var o=e("../scatter/get_trace_color");function s(e,t){this.scene=e;this.uid=t;this.type="pointcloud";this.pickXData=[];this.pickYData=[];this.xData=[];this.yData=[];this.textLabels=[];this.color="rgb(0, 0, 0)";this.name="";this.hoverinfo="all";this.idToIndex=new Int32Array(0);this.bounds=[0,0,0,0];this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]};this.pointcloud=n(e.glplot,this.pointcloudOptions);this.pointcloud._trace=this}var l=s.prototype;l.handlePick=function(e){var t=this.idToIndex[e.pointId];return{trace:this,dataCoord:e.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}};l.update=function(e){this.index=e.index;this.textLabels=e.text;this.name=e.name;this.hoverinfo=e.hoverinfo;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.updateFast(e);this.color=o(e,{})};l.updateFast=function(e){var t=this.xData=this.pickXData=e.x;var r=this.yData=this.pickYData=e.y;var n=this.pickXYData=e.xy;var o=e.xbounds&&e.ybounds;var s=e.indices;var l;var u;var c;var f=this.bounds;var h,p,d;if(n){c=n;l=n.length>>>1;if(o){f[0]=e.xbounds[0];f[2]=e.xbounds[1];f[1]=e.ybounds[0];f[3]=e.ybounds[1]}else{for(d=0;d<l;d++){h=c[d*2];p=c[d*2+1];if(h<f[0])f[0]=h;if(h>f[2])f[2]=h;if(p<f[1])f[1]=p;if(p>f[3])f[3]=p}}if(s){u=s}else{u=new Int32Array(l);for(d=0;d<l;d++){u[d]=d}}}else{l=t.length;c=new Float32Array(2*l);u=new Int32Array(l);for(d=0;d<l;d++){h=t[d];p=r[d];u[d]=d;c[d*2]=h;c[d*2+1]=p;if(h<f[0])f[0]=h;if(h>f[2])f[2]=h;if(p<f[1])f[1]=p;if(p>f[3])f[3]=p}}this.idToIndex=u;this.pointcloudOptions.idToIndex=u;this.pointcloudOptions.positions=c;var v=a(e.marker.color);var m=a(e.marker.border.color);var g=e.opacity*e.marker.opacity;v[3]*=g;this.pointcloudOptions.color=v;var y=e.marker.blend;if(y===null){var x=100;y=t.length<x||r.length<x}this.pointcloudOptions.blend=y;m[3]*=g;this.pointcloudOptions.borderColor=m;var _=e.marker.sizemin;var b=Math.max(e.marker.sizemax,e.marker.sizemin);this.pointcloudOptions.sizeMin=_;this.pointcloudOptions.sizeMax=b;this.pointcloudOptions.areaRatio=e.marker.border.arearatio;this.pointcloud.update(this.pointcloudOptions);var w=this.scene.xaxis;var T=this.scene.yaxis;var k=b/2||.5;e._extremes[w._id]=i(w,[f[0],f[2]],{ppad:k});e._extremes[T._id]=i(T,[f[1],f[3]],{ppad:k})};l.dispose=function(){this.pointcloud.dispose()};function u(e,t){var r=new s(e,t.uid);r.update(t);return r}t.exports=u},{"../../lib/str2rgbarray":802,"../../plots/cartesian/autorange":827,"../scatter/get_trace_color":1197,"gl-pointcloud2d":324}],1175:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");t.exports=function e(t,r,i){function o(e,i){return n.coerce(t,r,a,e,i)}o("x");o("y");o("xbounds");o("ybounds");if(t.xy&&t.xy instanceof Float32Array){r.xy=t.xy}if(t.indices&&t.indices instanceof Int32Array){r.indices=t.indices}o("text");o("marker.color",i);o("marker.opacity");o("marker.blend");o("marker.sizemin");o("marker.sizemax");o("marker.border.color",i);o("marker.border.arearatio");r._length=null}},{"../../lib":778,"./attributes":1173}],1176:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../scatter3d/calc"),plot:e("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":868,"../scatter3d/calc":1216,"./attributes":1173,"./convert":1174,"./defaults":1175}],1177:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var a=e("../../plots/attributes");var i=e("../../components/color/attributes");var o=e("../../components/fx/attributes");var s=e("../../plots/domain").attributes;var l=e("../../plots/template_attributes").hovertemplateAttrs;var u=e("../../components/colorscale/attributes");var c=e("../../plot_api/plot_template").templatedArray;var f=e("../../lib/extend").extendFlat;var h=e("../../plot_api/edit_types").overrideAll;var p=e("../../constants/docs").FORMAT_LINK;var d=t.exports=h({hoverinfo:f({},a.hoverinfo,{flags:[],arrayOk:false}),hoverlabel:o.hoverlabel,domain:s({name:"sankey",trace:true}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:n({}),customdata:undefined,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:true,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:true},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:true},width:{valType:"number",min:0,dflt:.5,arrayOk:true}},pad:{valType:"number",arrayOk:false,min:0,dflt:20},thickness:{valType:"number",arrayOk:false,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:o.hoverlabel,hovertemplate:l({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:true},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:true},width:{valType:"number",min:0,dflt:0,arrayOk:true}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:o.hoverlabel,hovertemplate:l({},{keys:["value","label"]}),colorscales:c("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:f(u().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");d.transforms=undefined},{"../../components/color/attributes":642,"../../components/colorscale/attributes":650,"../../components/fx/attributes":674,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1178:[function(e,t,r){"use strict";var n=e("../../plot_api/edit_types").overrideAll;var a=e("../../plots/get_data").getModuleCalcData;var i=e("./plot");var o=e("../../components/fx/layout_attributes");var s=e("../../lib/setcursor");var l=e("../../components/dragelement");var u=e("../../plots/cartesian/select").prepSelect;var c=e("../../lib");var f=e("../../registry");var h="sankey";r.name=h;r.baseLayoutAttrOverrides=n({hoverlabel:o.hoverlabel},"plot","nested");r.plot=function(e){var t=a(e.calcdata,h)[0];i(e,t);r.updateFx(e)};r.clean=function(e,t,r,n){var a=n._has&&n._has(h);var i=t._has&&t._has(h);if(a&&!i){n._paperdiv.selectAll(".sankey").remove();n._paperdiv.selectAll(".bgsankey").remove()}};r.updateFx=function(e){for(var t=0;t<e._fullData.length;t++){p(e,t)}};function p(e,t){var r=e._fullData[t];var n=e._fullLayout;var a=n.dragmode;var i=n.dragmode==="pan"?"move":"crosshair";var o=r._bgRect;if(a==="pan"||a==="zoom")return;s(o,i);var h={_id:"x",c2p:c.identity,_offset:r._sankey.translateX,_length:r._sankey.width};var p={_id:"y",c2p:c.identity,_offset:r._sankey.translateY,_length:r._sankey.height};var d={gd:e,element:o.node(),plotinfo:{id:t,xaxis:h,yaxis:p,fillRangeItems:c.noop},subplot:t,xaxes:[h],yaxes:[p],doneFnCompleted:function(r){var n=e._fullData[t];var a;var i=n.node.groups.slice();var o=[];function s(e){var t=n._sankey.graph.nodes;for(var r=0;r<t.length;r++){if(t[r].pointNumber===e)return t[r]}}for(var l=0;l<r.length;l++){var u=s(r[l].pointNumber);if(!u)continue;if(u.group){for(var c=0;c<u.childrenNodes.length;c++){o.push(u.childrenNodes[c].pointNumber)}i[u.pointNumber-n.node._count]=false}else{o.push(u.pointNumber)}}a=i.filter(Boolean).concat([o]);f.call("_guiRestyle",e,{"node.groups":[a]},t)}};d.prepFn=function(e,t,r){u(e,t,r,d,a)};l.init(d)}},{"../../components/dragelement":662,"../../components/fx/layout_attributes":684,"../../lib":778,"../../lib/setcursor":799,"../../plot_api/edit_types":810,"../../plots/cartesian/select":847,"../../plots/get_data":865,"../../registry":911,"./plot":1183}],1179:[function(e,t,r){"use strict";var n=e("strongly-connected-components");var a=e("../../lib");var i=e("../../lib/gup").wrap;var o=a.isArrayOrTypedArray;var s=a.isIndex;var l=e("../../components/colorscale");function u(e){var t=e.node;var r=e.link;var n=[];var i=o(r.color);var u=o(r.customdata);var f={};var h={};var p=r.colorscales.length;var d;for(d=0;d<p;d++){var v=r.colorscales[d];var m=l.extractScale(v,{cLetter:"c"});var g=l.makeColorScaleFunc(m);h[v.label]=g}var y=0;for(d=0;d<r.value.length;d++){if(r.source[d]>y)y=r.source[d];if(r.target[d]>y)y=r.target[d]}var x=y+1;e.node._count=x;var _;var b=e.node.groups;var w={};for(d=0;d<b.length;d++){var T=b[d];for(_=0;_<T.length;_++){var k=T[_];var A=x+d;if(w.hasOwnProperty(k)){a.warn("Node "+k+" is already part of a group.")}else{w[k]=A}}}var M={source:[],target:[]};for(d=0;d<r.value.length;d++){var E=r.value[d];var S=r.source[d];var C=r.target[d];if(!(E>0&&s(S,x)&&s(C,x))){continue}if(w.hasOwnProperty(S)&&w.hasOwnProperty(C)&&w[S]===w[C]){continue}if(w.hasOwnProperty(C)){C=w[C]}if(w.hasOwnProperty(S)){S=w[S]}S=+S;C=+C;f[S]=f[C]=true;var L="";if(r.label&&r.label[d])L=r.label[d];var I=null;if(L&&h.hasOwnProperty(L))I=h[L];n.push({pointNumber:d,label:L,color:i?r.color[d]:r.color,customdata:u?r.customdata[d]:r.customdata,concentrationscale:I,source:S,target:C,value:+E});M.source.push(S);M.target.push(C)}var O=x+b.length;var P=o(t.color);var D=o(t.customdata);var R=[];for(d=0;d<O;d++){if(!f[d])continue;var z=t.label[d];R.push({group:d>x-1,childrenNodes:[],pointNumber:d,label:z,color:P?t.color[d]:t.color,customdata:D?t.customdata[d]:t.customdata})}var N=false;if(c(O,M.source,M.target)){N=true}return{circular:N,links:n,nodes:R,groups:b,groupLookup:w}}function c(e,t,r){var i=a.init2dArray(e,0);for(var o=0;o<Math.min(t.length,r.length);o++){if(a.isIndex(t[o],e)&&a.isIndex(r[o],e)){if(t[o]===r[o]){return true}i[t[o]].push(r[o])}}var s=n(i);return s.components.some(function(e){return e.length>1})}t.exports=function e(t,r){var n=u(r);return i({circular:n.circular,_nodes:n.nodes,_links:n.links,_groups:n.groups,_groupLookup:n.groupLookup})}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gup":775,"strongly-connected-components":569}],1180:[function(e,t,r){"use strict";t.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1181:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../../components/color");var o=e("tinycolor2");var s=e("../../plots/domain").defaults;var l=e("../../components/fx/hoverlabel_defaults");var u=e("../../plot_api/plot_template");var c=e("../../plots/array_container_defaults");t.exports=function e(t,r,h,p){function d(e,i){return n.coerce(t,r,a,e,i)}var v=n.extendDeep(p.hoverlabel,t.hoverlabel);var m=t.node;var g=u.newContainer(r,"node");function y(e,t){return n.coerce(m,g,a.node,e,t)}y("label");y("groups");y("x");y("y");y("pad");y("thickness");y("line.color");y("line.width");y("hoverinfo",t.hoverinfo);l(m,g,y,v);y("hovertemplate");var x=p.colorway;var _=function(e){return x[e%x.length]};y("color",g.label.map(function(e,t){return i.addOpacity(_(t),.8)}));y("customdata");var b=t.link||{};var w=u.newContainer(r,"link");function T(e,t){return n.coerce(b,w,a.link,e,t)}T("label");T("source");T("target");T("value");T("line.color");T("line.width");T("hoverinfo",t.hoverinfo);l(b,w,T,v);T("hovertemplate");var k=o(p.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";T("color",n.repeat(k,w.value.length));T("customdata");c(b,w,{name:"colorscales",handleItemDefaults:f});s(r,p,d);d("orientation");d("valueformat");d("valuesuffix");var A;if(g.x.length&&g.y.length){A="freeform"}d("arrangement",A);n.coerceFont(d,"textfont",n.extendFlat({},p.font));r._length=null};function f(e,t){function r(r,i){return n.coerce(e,t,a.link.colorscales,r,i)}r("label");r("cmin");r("cmax");r("colorscale")}},{"../../components/color":643,"../../components/fx/hoverlabel_defaults":681,"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../../plots/domain":855,"./attributes":1177,tinycolor2:576}],1182:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"sankey",basePlotModule:e("./base_plot"),selectPoints:e("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1177,"./base_plot":1178,"./calc":1179,"./defaults":1181,"./plot":1183,"./select.js":1185}],1183:[function(e,t,r){"use strict";var n=e("d3");var a=e("./render");var i=e("../../components/fx");var o=e("../../components/color");var s=e("../../lib");var l=e("./constants").cn;var u=s._;function c(e){return e!==""}function f(e,t){return e.filter(function(e){return e.key===t.traceId})}function h(e,t){n.select(e).select("path").style("fill-opacity",t);n.select(e).select("rect").style("fill-opacity",t)}function p(e){n.select(e).select("text.name").style("fill","black")}function d(e){return function(t){return e.node.sourceLinks.indexOf(t.link)!==-1||e.node.targetLinks.indexOf(t.link)!==-1}}function v(e){return function(t){return t.node.sourceLinks.indexOf(e.link)!==-1||t.node.targetLinks.indexOf(e.link)!==-1}}function m(e,t,r){if(t&&r){f(r,t).selectAll("."+l.sankeyLink).filter(d(t)).call(y.bind(0,t,r,false))}}function g(e,t,r){if(t&&r){f(r,t).selectAll("."+l.sankeyLink).filter(d(t)).call(x.bind(0,t,r,false))}}function y(e,t,r,n){var a=n.datum().link.label;n.style("fill-opacity",function(e){if(!e.link.concentrationscale){return.4}});if(a){f(t,e).selectAll("."+l.sankeyLink).filter(function(e){return e.link.label===a}).style("fill-opacity",function(e){if(!e.link.concentrationscale){return.4}})}if(r){f(t,e).selectAll("."+l.sankeyNode).filter(v(e)).call(m)}}function x(e,t,r,n){var a=n.datum().link.label;n.style("fill-opacity",function(e){return e.tinyColorAlpha});if(a){f(t,e).selectAll("."+l.sankeyLink).filter(function(e){return e.link.label===a}).style("fill-opacity",function(e){return e.tinyColorAlpha})}if(r){f(t,e).selectAll(l.sankeyNode).filter(v(e)).call(g)}}function _(e,t){var r=e.hoverlabel||{};var n=s.nestedProperty(r,t).get();return Array.isArray(n)?false:n}t.exports=function e(t,r){var s=t._fullLayout;var f=s._paper;var d=s._size;for(var v=0;v<t._fullData.length;v++){if(!t._fullData[v].visible)continue;if(t._fullData[v].type!==l.sankey)continue;if(!t._fullData[v]._viewInitial){var b=t._fullData[v].node;t._fullData[v]._viewInitial={node:{groups:b.groups.slice(),x:b.x.slice(),y:b.y.slice()}}}}var w=function(e,r){var a=r.link;a.originalEvent=n.event;t._hoverdata=[a];i.click(t,{target:true})};var T=function(e,r,a){if(t._fullLayout.hovermode===false)return;n.select(e).call(y.bind(0,r,a,true));if(r.link.trace.link.hoverinfo!=="skip"){r.link.fullData=r.link.trace;t.emit("plotly_hover",{event:n.event,points:[r.link]})}};var k=u(t,"source:")+" ";var A=u(t,"target:")+" ";var M=u(t,"concentration:")+" ";var E=u(t,"incoming flow count:")+" ";var S=u(t,"outgoing flow count:")+" ";var C=function(e,r){if(t._fullLayout.hovermode===false)return;var a=r.link.trace.link;if(a.hoverinfo==="none"||a.hoverinfo==="skip")return;var l=[];function u(e){var t,n;if(e.circular){t=(e.circularPathData.leftInnerExtent+e.circularPathData.rightInnerExtent)/2;n=e.circularPathData.verticalFullExtent}else{t=(e.source.x1+e.target.x0)/2;n=(e.y0+e.y1)/2}var a=[t,n];if(e.trace.orientation==="v")a.reverse();a[0]+=r.parent.translateX;a[1]+=r.parent.translateY;return a}var f=0;for(var d=0;d<r.flow.links.length;d++){var v=r.flow.links[d];if(t._fullLayout.hovermode==="closest"&&r.link.pointNumber!==v.pointNumber)continue;if(r.link.pointNumber===v.pointNumber)f=d;v.fullData=v.trace;a=r.link.trace.link;var m=u(v);var g={valueLabel:n.format(r.valueFormat)(v.value)+r.valueSuffix};l.push({x:m[0],y:m[1],name:g.valueLabel,text:[v.label||"",k+v.source.label,A+v.target.label,v.concentrationscale?M+n.format("%0.2f")(v.flow.labelConcentration):""].filter(c).join("<br>"),color:_(a,"bgcolor")||o.addOpacity(v.color,1),borderColor:_(a,"bordercolor"),fontFamily:_(a,"font.family"),fontSize:_(a,"font.size"),fontColor:_(a,"font.color"),nameLength:_(a,"namelength"),textAlign:_(a,"align"),idealAlign:n.event.x<m[0]?"right":"left",hovertemplate:a.hovertemplate,hovertemplateLabels:g,eventData:[v]})}var y=i.loneHover(l,{container:s._hoverlayer.node(),outerContainer:s._paper.node(),gd:t,anchorIndex:f});y.each(function(){var e=this;if(!r.link.concentrationscale){h(e,.65)}p(e)})};var L=function(e,r,a){if(t._fullLayout.hovermode===false)return;n.select(e).call(x.bind(0,r,a,true));if(r.link.trace.link.hoverinfo!=="skip"){r.link.fullData=r.link.trace;t.emit("plotly_unhover",{event:n.event,points:[r.link]})}i.loneUnhover(s._hoverlayer.node())};var I=function(e,r,a){var o=r.node;o.originalEvent=n.event;t._hoverdata=[o];n.select(e).call(g,r,a);i.click(t,{target:true})};var O=function(e,r,a){if(t._fullLayout.hovermode===false)return;n.select(e).call(m,r,a);if(r.node.trace.node.hoverinfo!=="skip"){r.node.fullData=r.node.trace;t.emit("plotly_hover",{event:n.event,points:[r.node]})}};var P=function(e,r){if(t._fullLayout.hovermode===false)return;var a=r.node.trace.node;if(a.hoverinfo==="none"||a.hoverinfo==="skip")return;var o=n.select(e).select("."+l.nodeRect);var u=t._fullLayout._paperdiv.node().getBoundingClientRect();var f=o.node().getBoundingClientRect();var d=f.left-2-u.left;var v=f.right+2-u.left;var m=f.top+f.height/4-u.top;var g={valueLabel:n.format(r.valueFormat)(r.node.value)+r.valueSuffix};r.node.fullData=r.node.trace;t._fullLayout._calcInverseTransform(t);var y=t._fullLayout._invScaleX;var x=t._fullLayout._invScaleY;var b=i.loneHover({x0:y*d,x1:y*v,y:x*m,name:n.format(r.valueFormat)(r.node.value)+r.valueSuffix,text:[r.node.label,E+r.node.targetLinks.length,S+r.node.sourceLinks.length].filter(c).join("<br>"),color:_(a,"bgcolor")||r.tinyColorHue,borderColor:_(a,"bordercolor"),fontFamily:_(a,"font.family"),fontSize:_(a,"font.size"),fontColor:_(a,"font.color"),nameLength:_(a,"namelength"),textAlign:_(a,"align"),idealAlign:"left",hovertemplate:a.hovertemplate,hovertemplateLabels:g,eventData:[r.node]},{container:s._hoverlayer.node(),outerContainer:s._paper.node(),gd:t});h(b,.85);p(b)};var D=function(e,r,a){if(t._fullLayout.hovermode===false)return;n.select(e).call(g,r,a);if(r.node.trace.node.hoverinfo!=="skip"){r.node.fullData=r.node.trace;t.emit("plotly_unhover",{event:n.event,points:[r.node]})}i.loneUnhover(s._hoverlayer.node())};a(t,f,r,{width:d.w,height:d.h,margin:{t:d.t,r:d.r,b:d.b,l:d.l}},{linkEvents:{hover:T,follow:C,unhover:L,select:w},nodeEvents:{hover:O,follow:P,unhover:D,select:I}})}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"./constants":1180,"./render":1184,d3:169}],1184:[function(e,t,r){"use strict";var n=e("./constants");var a=e("d3");var i=e("tinycolor2");var o=e("../../components/color");var s=e("../../components/drawing");var l=e("@plotly/d3-sankey");var u=e("@plotly/d3-sankey-circular");var c=e("d3-force");var f=e("../../lib");var h=f.strTranslate;var p=e("../../lib/gup");var d=p.keyFun;var v=p.repeat;var m=p.unwrap;var g=e("d3-interpolate").interpolateNumber;var y=e("../../registry");function x(e,t,r){var a=m(t);var o=a.trace;var s=o.domain;var c=o.orientation==="h";var h=o.node.pad;var p=o.node.thickness;var d=e.width*(s.x[1]-s.x[0]);var v=e.height*(s.y[1]-s.y[0]);var g=a._nodes;var y=a._links;var x=a.circular;var _;if(x){_=u.sankeyCircular().circularLinkGap(0)}else{_=l.sankey()}_.iterations(n.sankeyIterations).size(c?[d,v]:[v,d]).nodeWidth(p).nodePadding(h).nodeId(function(e){return e.pointNumber}).nodes(g).links(y);var b=_();if(_.nodePadding()<h){f.warn("node.pad was reduced to ",_.nodePadding()," to fit within the figure.")}var w,T,k;for(var A in a._groupLookup){var M=parseInt(a._groupLookup[A]);var E;for(w=0;w<b.nodes.length;w++){if(b.nodes[w].pointNumber===M){E=b.nodes[w];break}}if(!E)continue;var S={pointNumber:parseInt(A),x0:E.x0,x1:E.x1,y0:E.y0,y1:E.y1,partOfGroup:true,sourceLinks:[],targetLinks:[]};b.nodes.unshift(S);E.childrenNodes.unshift(S)}function C(){for(w=0;w<b.nodes.length;w++){var e=b.nodes[w];var t={};var r;var n;for(T=0;T<e.targetLinks.length;T++){n=e.targetLinks[T];r=n.source.pointNumber+":"+n.target.pointNumber;if(!t.hasOwnProperty(r))t[r]=[];t[r].push(n)}var a=Object.keys(t);for(T=0;T<a.length;T++){r=a[T];var o=t[r];var s=0;var l={};for(k=0;k<o.length;k++){n=o[k];if(!l[n.label])l[n.label]=0;l[n.label]+=n.value;s+=n.value}for(k=0;k<o.length;k++){n=o[k];n.flow={value:s,labelConcentration:l[n.label]/s,concentration:n.value/s,links:o};if(n.concentrationscale){n.color=i(n.concentrationscale(n.flow.labelConcentration))}}}var u=0;for(T=0;T<e.sourceLinks.length;T++){u+=e.sourceLinks[T].value}for(T=0;T<e.sourceLinks.length;T++){n=e.sourceLinks[T];n.concentrationOut=n.value/u}var c=0;for(T=0;T<e.targetLinks.length;T++){c+=e.targetLinks[T].value}for(T=0;T<e.targetLinks.length;T++){n=e.targetLinks[T];n.concenrationIn=n.value/c}}}C();function L(e){e.forEach(function(e){var t;var r;var n=0;var a=e.length;var i;e.sort(function(e,t){return e.y0-t.y0});for(i=0;i<a;++i){t=e[i];if(t.y0>=n){}else{r=n-t.y0;if(r>1e-6)t.y0+=r,t.y1+=r}n=t.y1+h}})}function I(e){var t=e.map(function(e,t){return{x0:e.x0,index:t}}).sort(function(e,t){return e.x0-t.x0});var r=[];var n=-1;var a;var i=-Infinity;var o;for(w=0;w<t.length;w++){var s=e[t[w].index];if(s.x0>i+p){n+=1;a=s.x0}i=s.x0;if(!r[n])r[n]=[];r[n].push(s);o=a-s.x0;s.x0+=o,s.x1+=o}return r}if(o.node.x.length&&o.node.y.length){for(w=0;w<Math.min(o.node.x.length,o.node.y.length,b.nodes.length);w++){if(o.node.x[w]&&o.node.y[w]){var O=[o.node.x[w]*d,o.node.y[w]*v];b.nodes[w].x0=O[0]-p/2;b.nodes[w].x1=O[0]+p/2;var P=b.nodes[w].y1-b.nodes[w].y0;b.nodes[w].y0=O[1]-P/2;b.nodes[w].y1=O[1]+P/2}}if(o.arrangement==="snap"){g=b.nodes;var D=I(g);L(D)}_.update(b)}return{circular:x,key:r,trace:o,guid:f.randstr(),horizontal:c,width:d,height:v,nodePad:o.node.pad,nodeLineColor:o.node.line.color,nodeLineWidth:o.node.line.width,linkLineColor:o.link.line.color,linkLineWidth:o.link.line.width,valueFormat:o.valueformat,valueSuffix:o.valuesuffix,textFont:o.textfont,translateX:s.x[0]*e.width+e.margin.l,translateY:e.height-s.y[1]*e.height+e.margin.t,dragParallel:c?v:d,dragPerpendicular:c?d:v,arrangement:o.arrangement,sankey:_,graph:b,forceLayouts:{},interactionState:{dragInProgress:false,hovered:false}}}function _(e,t,r){var n=i(t.color);var a=t.source.label+"|"+t.target.label;var s=a+"__"+r;t.trace=e.trace;t.curveNumber=e.trace.index;return{circular:e.circular,key:s,traceId:e.key,pointNumber:t.pointNumber,link:t,tinyColorHue:o.tinyRGB(n),tinyColorAlpha:n.getAlpha(),linkPath:w,linkLineColor:e.linkLineColor,linkLineWidth:e.linkLineWidth,valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,parent:e,interactionState:e.interactionState,flow:t.flow}}function b(e){var t="";var r=e.width/2;var n=e.circularPathData;if(e.circularLinkType==="top"){t="M "+n.targetX+" "+(n.targetY+r)+" "+"L"+n.rightInnerExtent+" "+(n.targetY+r)+"A"+(n.rightLargeArcRadius+r)+" "+(n.rightSmallArcRadius+r)+" 0 0 1 "+(n.rightFullExtent-r)+" "+(n.targetY-n.rightSmallArcRadius)+"L"+(n.rightFullExtent-r)+" "+n.verticalRightInnerExtent+"A"+(n.rightLargeArcRadius+r)+" "+(n.rightLargeArcRadius+r)+" 0 0 1 "+n.rightInnerExtent+" "+(n.verticalFullExtent-r)+"L"+n.leftInnerExtent+" "+(n.verticalFullExtent-r)+"A"+(n.leftLargeArcRadius+r)+" "+(n.leftLargeArcRadius+r)+" 0 0 1 "+(n.leftFullExtent+r)+" "+n.verticalLeftInnerExtent+"L"+(n.leftFullExtent+r)+" "+(n.sourceY-n.leftSmallArcRadius)+"A"+(n.leftLargeArcRadius+r)+" "+(n.leftSmallArcRadius+r)+" 0 0 1 "+n.leftInnerExtent+" "+(n.sourceY+r)+"L"+n.sourceX+" "+(n.sourceY+r)+"L"+n.sourceX+" "+(n.sourceY-r)+"L"+n.leftInnerExtent+" "+(n.sourceY-r)+"A"+(n.leftLargeArcRadius-r)+" "+(n.leftSmallArcRadius-r)+" 0 0 0 "+(n.leftFullExtent-r)+" "+(n.sourceY-n.leftSmallArcRadius)+"L"+(n.leftFullExtent-r)+" "+n.verticalLeftInnerExtent+"A"+(n.leftLargeArcRadius-r)+" "+(n.leftLargeArcRadius-r)+" 0 0 0 "+n.leftInnerExtent+" "+(n.verticalFullExtent+r)+"L"+n.rightInnerExtent+" "+(n.verticalFullExtent+r)+"A"+(n.rightLargeArcRadius-r)+" "+(n.rightLargeArcRadius-r)+" 0 0 0 "+(n.rightFullExtent+r)+" "+n.verticalRightInnerExtent+"L"+(n.rightFullExtent+r)+" "+(n.targetY-n.rightSmallArcRadius)+"A"+(n.rightLargeArcRadius-r)+" "+(n.rightSmallArcRadius-r)+" 0 0 0 "+n.rightInnerExtent+" "+(n.targetY-r)+"L"+n.targetX+" "+(n.targetY-r)+"Z"}else{t="M "+n.targetX+" "+(n.targetY-r)+" "+"L"+n.rightInnerExtent+" "+(n.targetY-r)+"A"+(n.rightLargeArcRadius+r)+" "+(n.rightSmallArcRadius+r)+" 0 0 0 "+(n.rightFullExtent-r)+" "+(n.targetY+n.rightSmallArcRadius)+"L"+(n.rightFullExtent-r)+" "+n.verticalRightInnerExtent+"A"+(n.rightLargeArcRadius+r)+" "+(n.rightLargeArcRadius+r)+" 0 0 0 "+n.rightInnerExtent+" "+(n.verticalFullExtent+r)+"L"+n.leftInnerExtent+" "+(n.verticalFullExtent+r)+"A"+(n.leftLargeArcRadius+r)+" "+(n.leftLargeArcRadius+r)+" 0 0 0 "+(n.leftFullExtent+r)+" "+n.verticalLeftInnerExtent+"L"+(n.leftFullExtent+r)+" "+(n.sourceY+n.leftSmallArcRadius)+"A"+(n.leftLargeArcRadius+r)+" "+(n.leftSmallArcRadius+r)+" 0 0 0 "+n.leftInnerExtent+" "+(n.sourceY-r)+"L"+n.sourceX+" "+(n.sourceY-r)+"L"+n.sourceX+" "+(n.sourceY+r)+"L"+n.leftInnerExtent+" "+(n.sourceY+r)+"A"+(n.leftLargeArcRadius-r)+" "+(n.leftSmallArcRadius-r)+" 0 0 1 "+(n.leftFullExtent-r)+" "+(n.sourceY+n.leftSmallArcRadius)+"L"+(n.leftFullExtent-r)+" "+n.verticalLeftInnerExtent+"A"+(n.leftLargeArcRadius-r)+" "+(n.leftLargeArcRadius-r)+" 0 0 1 "+n.leftInnerExtent+" "+(n.verticalFullExtent-r)+"L"+n.rightInnerExtent+" "+(n.verticalFullExtent-r)+"A"+(n.rightLargeArcRadius-r)+" "+(n.rightLargeArcRadius-r)+" 0 0 1 "+(n.rightFullExtent+r)+" "+n.verticalRightInnerExtent+"L"+(n.rightFullExtent+r)+" "+(n.targetY+n.rightSmallArcRadius)+"A"+(n.rightLargeArcRadius-r)+" "+(n.rightSmallArcRadius-r)+" 0 0 1 "+n.rightInnerExtent+" "+(n.targetY+r)+"L"+n.targetX+" "+(n.targetY+r)+"Z"}return t}function w(){var e=.5;function t(t){if(t.link.circular){return b(t.link)}else{var r=t.link.source.x1;var n=t.link.target.x0;var a=g(r,n);var i=a(e);var o=a(1-e);var s=t.link.y0-t.link.width/2;var l=t.link.y0+t.link.width/2;var u=t.link.y1-t.link.width/2;var c=t.link.y1+t.link.width/2;return"M"+r+","+s+"C"+i+","+s+" "+o+","+u+" "+n+","+u+"L"+n+","+c+"C"+o+","+c+" "+i+","+l+" "+r+","+l+"Z"}}return t}function T(e,t){var r=i(t.color);var a=n.nodePadAcross;var s=e.nodePad/2;t.dx=t.x1-t.x0;t.dy=t.y1-t.y0;var l=t.dx;var u=Math.max(.5,t.dy);var c="node_"+t.pointNumber;if(t.group){c=f.randstr()}t.trace=e.trace;t.curveNumber=e.trace.index;return{index:t.pointNumber,key:c,partOfGroup:t.partOfGroup||false,group:t.group,traceId:e.key,trace:e.trace,node:t,nodePad:e.nodePad,nodeLineColor:e.nodeLineColor,nodeLineWidth:e.nodeLineWidth,textFont:e.textFont,size:e.horizontal?e.height:e.width,visibleWidth:Math.ceil(l),visibleHeight:u,zoneX:-a,zoneY:-s,zoneWidth:l+2*a,zoneHeight:u+2*s,labelY:e.horizontal?t.dy/2+1:t.dx/2+1,left:t.originalLayer===1,sizeAcross:e.width,forceLayouts:e.forceLayouts,horizontal:e.horizontal,darkBackground:r.getBrightness()<=128,tinyColorHue:o.tinyRGB(r),tinyColorAlpha:r.getAlpha(),valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,graph:e.graph,arrangement:e.arrangement,uniqueNodeLabelPathId:[e.guid,e.key,c].join("_"),interactionState:e.interactionState,figure:e}}function k(e){e.attr("transform",function(e){return h(e.node.x0.toFixed(3),e.node.y0.toFixed(3))})}function A(e){e.call(k)}function M(e,t){e.call(A);t.attr("d",w())}function E(e){e.attr("width",function(e){return e.node.x1-e.node.x0}).attr("height",function(e){return e.visibleHeight})}function S(e){return e.link.width>1||e.linkLineWidth>0}function C(e){var t=h(e.translateX,e.translateY);return t+(e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function L(e){return h(e.horizontal?0:e.labelY,e.horizontal?e.labelY:0)}function I(e){return a.svg.line()([[e.horizontal?e.left?-e.sizeAcross:e.visibleWidth+n.nodeTextOffsetHorizontal:n.nodeTextOffsetHorizontal,0],[e.horizontal?e.left?-n.nodeTextOffsetHorizontal:e.sizeAcross:e.visibleHeight-n.nodeTextOffsetHorizontal,0]])}function O(e){return e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function P(e){return e.horizontal?"scale(1 1)":"scale(-1 1)"}function D(e){return e.darkBackground&&!e.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function R(e){return e.horizontal&&e.left?"100%":"0%"}function z(e,t,r){e.on(".basic",null).on("mouseover.basic",function(e){if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.hover(this,e,t);e.interactionState.hovered=[this,e]}}).on("mousemove.basic",function(e){if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.follow(this,e);e.interactionState.hovered=[this,e]}}).on("mouseout.basic",function(e){if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.unhover(this,e,t);e.interactionState.hovered=false}}).on("click.basic",function(e){if(e.interactionState.hovered){r.unhover(this,e,t);e.interactionState.hovered=false}if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.select(this,e,t)}})}function N(e,t,r,n){var i=a.behavior.drag().origin(function(e){return{x:e.node.x0+e.visibleWidth/2,y:e.node.y0+e.visibleHeight/2}}).on("dragstart",function(a){if(a.arrangement==="fixed")return;f.ensureSingle(n._fullLayout._infolayer,"g","dragcover",function(e){n._fullLayout._dragCover=e});f.raiseToTop(this);a.interactionState.dragInProgress=a.node;V(a.node);if(a.interactionState.hovered){r.nodeEvents.unhover.apply(0,a.interactionState.hovered);a.interactionState.hovered=false}if(a.arrangement==="snap"){var i=a.traceId+"|"+a.key;if(a.forceLayouts[i]){a.forceLayouts[i].alpha(1)}else{F(e,i,a,n)}B(e,t,a,i,n)}}).on("drag",function(r){if(r.arrangement==="fixed")return;var n=a.event.x;var i=a.event.y;if(r.arrangement==="snap"){r.node.x0=n-r.visibleWidth/2;r.node.x1=n+r.visibleWidth/2;r.node.y0=i-r.visibleHeight/2;r.node.y1=i+r.visibleHeight/2}else{if(r.arrangement==="freeform"){r.node.x0=n-r.visibleWidth/2;r.node.x1=n+r.visibleWidth/2}i=Math.max(0,Math.min(r.size-r.visibleHeight/2,i));r.node.y0=i-r.visibleHeight/2;r.node.y1=i+r.visibleHeight/2}V(r.node);if(r.arrangement!=="snap"){r.sankey.update(r.graph);M(e.filter(G(r)),t)}}).on("dragend",function(e){if(e.arrangement==="fixed")return;e.interactionState.dragInProgress=false;for(var t=0;t<e.node.childrenNodes.length;t++){e.node.childrenNodes[t].x=e.node.x;e.node.childrenNodes[t].y=e.node.y}if(e.arrangement!=="snap")U(e,n)});e.on(".drag",null).call(i)}function F(e,t,r,a){q(r.graph.nodes);var i=r.graph.nodes.filter(function(e){return e.originalX===r.node.originalX}).filter(function(e){return!e.partOfGroup});r.forceLayouts[t]=c.forceSimulation(i).alphaDecay(0).force("collide",c.forceCollide().radius(function(e){return e.dy/2+r.nodePad/2}).strength(1).iterations(n.forceIterations)).force("constrain",j(e,t,i,r,a)).stop()}function B(e,t,r,a,i){window.requestAnimationFrame(function o(){var s;for(s=0;s<n.forceTicksPerFrame;s++){r.forceLayouts[a].tick()}var l=r.graph.nodes;Y(l);r.sankey.update(r.graph);M(e.filter(G(r)),t);if(r.forceLayouts[a].alpha()>0){window.requestAnimationFrame(o)}else{var u=r.node.originalX;r.node.x0=u-r.visibleWidth/2;r.node.x1=u+r.visibleWidth/2;U(r,i)}})}function j(e,t,r,a){return function e(){var i=0;for(var o=0;o<r.length;o++){var s=r[o];if(s===a.interactionState.dragInProgress){s.x=s.lastDraggedX;s.y=s.lastDraggedY}else{s.vx=(s.originalX-s.x)/n.forceTicksPerFrame;s.y=Math.min(a.size-s.dy/2,Math.max(s.dy/2,s.y))}i=Math.max(i,Math.abs(s.vx),Math.abs(s.vy))}if(!a.interactionState.dragInProgress&&i<.1&&a.forceLayouts[t].alpha()>0){a.forceLayouts[t].alpha(0)}}}function U(e,t){var r=[];var n=[];for(var a=0;a<e.graph.nodes.length;a++){var i=(e.graph.nodes[a].x0+e.graph.nodes[a].x1)/2;var o=(e.graph.nodes[a].y0+e.graph.nodes[a].y1)/2;r.push(i/e.figure.width);n.push(o/e.figure.height)}y.call("_guiRestyle",t,{"node.x":[r],"node.y":[n]},e.trace.index).then(function(){if(t._fullLayout._dragCover)t._fullLayout._dragCover.remove()})}function H(e){var t=[];var r;for(r=0;r<e.length;r++){e[r].originalX=(e[r].x0+e[r].x1)/2;e[r].originalY=(e[r].y0+e[r].y1)/2;if(t.indexOf(e[r].originalX)===-1){t.push(e[r].originalX)}}t.sort(function(e,t){return e-t});for(r=0;r<e.length;r++){e[r].originalLayerIndex=t.indexOf(e[r].originalX);e[r].originalLayer=e[r].originalLayerIndex/(t.length-1)}}function V(e){e.lastDraggedX=e.x0+e.dx/2;e.lastDraggedY=e.y0+e.dy/2}function G(e){return function(t){return t.node.originalX===e.node.originalX}}function q(e){for(var t=0;t<e.length;t++){e[t].y=(e[t].y0+e[t].y1)/2;e[t].x=(e[t].x0+e[t].x1)/2}}function Y(e){for(var t=0;t<e.length;t++){e[t].y0=e[t].y-e[t].dy/2;e[t].y1=e[t].y0+e[t].dy;e[t].x0=e[t].x-e[t].dx/2;e[t].x1=e[t].x0+e[t].dx}}t.exports=function(e,t,r,l,u){var c=false;f.ensureSingle(e._fullLayout._infolayer,"g","first-render",function(){c=true});var h=e._fullLayout._dragCover;var p=r.filter(function(e){return m(e).trace.visible}).map(x.bind(null,l));var g=t.selectAll("."+n.cn.sankey).data(p,d);g.exit().remove();g.enter().append("g").classed(n.cn.sankey,true).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",C);g.each(function(t,r){e._fullData[r]._sankey=t;var n="bgsankey-"+t.trace.uid+"-"+r;f.ensureSingle(e._fullLayout._draggers,"rect",n);e._fullData[r]._bgRect=a.select("."+n);e._fullData[r]._bgRect.style("pointer-events","all").attr("width",t.width).attr("height",t.height).attr("x",t.translateX).attr("y",t.translateY).classed("bgsankey",true).style({fill:"transparent","stroke-width":0})});g.transition().ease(n.ease).duration(n.duration).attr("transform",C);var y=g.selectAll("."+n.cn.sankeyLinks).data(v,d);y.enter().append("g").classed(n.cn.sankeyLinks,true).style("fill","none");var b=y.selectAll("."+n.cn.sankeyLink).data(function(e){var t=e.graph.links;return t.filter(function(e){return e.value}).map(_.bind(null,e))},d);b.enter().append("path").classed(n.cn.sankeyLink,true).call(z,g,u.linkEvents);b.style("stroke",function(e){return S(e)?o.tinyRGB(i(e.linkLineColor)):e.tinyColorHue}).style("stroke-opacity",function(e){return S(e)?o.opacity(e.linkLineColor):e.tinyColorAlpha}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}).style("stroke-width",function(e){return S(e)?e.linkLineWidth:1}).attr("d",w());b.style("opacity",function(){return e._context.staticPlot||c||h?1:0}).transition().ease(n.ease).duration(n.duration).style("opacity",1);b.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var A=g.selectAll("."+n.cn.sankeyNodeSet).data(v,d);A.enter().append("g").classed(n.cn.sankeyNodeSet,true);A.style("cursor",function(e){switch(e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var M=A.selectAll("."+n.cn.sankeyNode).data(function(e){var t=e.graph.nodes;H(t);return t.map(T.bind(null,e))},d);M.enter().append("g").classed(n.cn.sankeyNode,true).call(k).style("opacity",function(t){return(e._context.staticPlot||c)&&!t.partOfGroup?1:0});M.call(z,g,u.nodeEvents).call(N,b,u,e);M.transition().ease(n.ease).duration(n.duration).call(k).style("opacity",function(e){return e.partOfGroup?0:1});M.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var F=M.selectAll("."+n.cn.nodeRect).data(v);F.enter().append("rect").classed(n.cn.nodeRect,true).call(E);F.style("stroke-width",function(e){return e.nodeLineWidth}).style("stroke",function(e){return o.tinyRGB(i(e.nodeLineColor))}).style("stroke-opacity",function(e){return o.opacity(e.nodeLineColor)}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha});F.transition().ease(n.ease).duration(n.duration).call(E);var B=M.selectAll("."+n.cn.nodeCapture).data(v);B.enter().append("rect").classed(n.cn.nodeCapture,true).style("fill-opacity",0);B.attr("x",function(e){return e.zoneX}).attr("y",function(e){return e.zoneY}).attr("width",function(e){return e.zoneWidth}).attr("height",function(e){return e.zoneHeight});var j=M.selectAll("."+n.cn.nodeCentered).data(v);j.enter().append("g").classed(n.cn.nodeCentered,true).attr("transform",L);j.transition().ease(n.ease).duration(n.duration).attr("transform",L);var U=j.selectAll("."+n.cn.nodeLabelGuide).data(v);U.enter().append("path").classed(n.cn.nodeLabelGuide,true).attr("id",function(e){return e.uniqueNodeLabelPathId}).attr("d",I).attr("transform",O);U.transition().ease(n.ease).duration(n.duration).attr("d",I).attr("transform",O);var V=j.selectAll("."+n.cn.nodeLabel).data(v);V.enter().append("text").classed(n.cn.nodeLabel,true).attr("transform",P).style("cursor","default").style("fill","black");V.style("text-shadow",function(e){return e.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(e){s.font(V,e.textFont)});V.transition().ease(n.ease).duration(n.duration).attr("transform",P);var G=V.selectAll("."+n.cn.nodeLabelTextPath).data(v);G.enter().append("textPath").classed(n.cn.nodeLabelTextPath,true).attr("alignment-baseline","middle").attr("xlink:href",function(e){return"#"+e.uniqueNodeLabelPathId}).attr("startOffset",R).style("fill",D);G.text(function(e){return e.horizontal||e.node.dy>5?e.node.label:""}).attr("text-anchor",function(e){return e.horizontal&&e.left?"end":"start"});G.transition().ease(n.ease).duration(n.duration).attr("startOffset",R).style("fill",D)}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../registry":911,"./constants":1180,"@plotly/d3-sankey":56,"@plotly/d3-sankey-circular":55,d3:169,"d3-force":160,"d3-interpolate":162,tinycolor2:576}],1185:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t.cd;var a=[];var i=n[0].trace;var o=i._sankey.graph.nodes;for(var s=0;s<o.length;s++){var l=o[s];if(l.partOfGroup)continue;var u=[(l.x0+l.x1)/2,(l.y0+l.y1)/2];if(i.orientation==="v")u.reverse();if(r&&r.contains(u,false,s,t)){a.push({pointNumber:l.pointNumber})}}return a}},{}],1186:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){for(var a=0;a<t.length;a++)t[a].i=a;n.mergeArray(r.text,t,"tx");n.mergeArray(r.texttemplate,t,"txt");n.mergeArray(r.hovertext,t,"htx");n.mergeArray(r.customdata,t,"data");n.mergeArray(r.textposition,t,"tp");if(r.textfont){n.mergeArrayCastPositive(r.textfont.size,t,"ts");n.mergeArray(r.textfont.color,t,"tc");n.mergeArray(r.textfont.family,t,"tf")}var i=r.marker;if(i){n.mergeArrayCastPositive(i.size,t,"ms");n.mergeArrayCastPositive(i.opacity,t,"mo");n.mergeArray(i.symbol,t,"mx");n.mergeArray(i.color,t,"mc");var o=i.line;if(i.line){n.mergeArray(o.color,t,"mlc");n.mergeArrayCastPositive(o.width,t,"mlw")}var s=i.gradient;if(s&&s.type!=="none"){n.mergeArray(s.type,t,"mgt");n.mergeArray(s.color,t,"mgc")}}}},{"../../lib":778}],1187:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").texttemplateAttrs;var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../components/colorscale/attributes");var o=e("../../plots/font_attributes");var s=e("../../components/drawing/attributes").dash;var l=e("../../components/drawing");var u=e("./constants");var c=e("../../lib/extend").extendFlat;function f(e){return{valType:"any",dflt:0,editType:"calc"}}function h(e){return{valType:"any",editType:"calc"}}function p(e){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:true},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:true},dx:{valType:"number",dflt:1,editType:"calc",anim:true},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:true},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:true},dy:{valType:"number",dflt:1,editType:"calc",anim:true},xperiod:f("x"),yperiod:f("y"),xperiod0:h("x0"),yperiod0:h("y0"),xperiodalignment:p("x"),yperiodalignment:p("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},texttemplate:n({},{}),hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:a({},{keys:u.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:true},width:{valType:"number",min:0,dflt:2,editType:"style",anim:true},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:c({},s,{editType:"style"}),simplify:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:false,editType:"calc"},cliponaxis:{valType:"boolean",dflt:true,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:true},marker:c({symbol:{valType:"enumerated",values:l.symbolList,dflt:"circle",arrayOk:true,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:true,editType:"style",anim:true},size:{valType:"number",min:0,dflt:6,arrayOk:true,editType:"calc",anim:true},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:c({width:{valType:"number",min:0,arrayOk:true,editType:"style",anim:true},editType:"calc"},i("marker.line",{anim:true})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:true,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:true,editType:"calc"},editType:"calc"},editType:"calc"},i("marker",{anim:true})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:true,editType:"calc"},textfont:o({editType:"calc",colorEditType:"style",arrayOk:true}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorscale/attributes":650,"../../components/drawing":665,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plots/font_attributes":856,"../../plots/template_attributes":906,"./constants":1191}],1188:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/align_period");var s=e("../../constants/numerical").BADNUM;var l=e("./subtypes");var u=e("./colorscale_calc");var c=e("./arrays_to_calcdata");var f=e("./calc_selection");function h(e,t){var r=e._fullLayout;var l=i.getFromId(e,t.xaxis||"x");var h=i.getFromId(e,t.yaxis||"y");var m=l.makeCalcdata(t,"x");var y=h.makeCalcdata(t,"y");var x=o(t,l,"x",m);var _=o(t,h,"y",y);var b=t._length;var w=new Array(b);var T=t.ids;var k=g(t,r,l,h);var A=false;var M,E,S,C,L,I;v(r,t);var O="x";var P="y";var D;if(k){a.pushUnique(k.traceIndices,t._expandedIndex);M=k.orientation==="v";if(M){P="s";D="x"}else{O="s";D="y"}L=k.stackgaps==="interpolate"}else{var R=d(t,b);p(e,t,l,h,x,_,R)}var z=!!t.xperiodalignment;var N=!!t.yperiodalignment;for(E=0;E<b;E++){var F=w[E]={};var B=n(x[E]);var j=n(_[E]);if(B&&j){F[O]=x[E];F[P]=_[E];if(z){F.orig_x=m[E]}if(N){F.orig_y=y[E]}}else if(k&&(M?B:j)){F[D]=M?x[E]:_[E];F.gap=true;if(L){F.s=s;A=true}else{F.s=0}}else{F[O]=F[P]=s}if(T){F.id=String(T[E])}}c(w,t);u(e,t);f(w,t);if(k){E=0;while(E<w.length){if(w[E][D]===s){w.splice(E,1)}else E++}a.sort(w,function(e,t){return e[D]-t[D]||e.i-t.i});if(A){E=0;while(E<w.length-1&&w[E].gap){E++}I=w[E].s;if(!I)I=w[E].s=0;for(S=0;S<E;S++){w[S].s=I}C=w.length-1;while(C>E&&w[C].gap){C--}I=w[C].s;for(S=w.length-1;S>C;S--){w[S].s=I}while(E<C){E++;if(w[E].gap){S=E+1;while(w[S].gap){S++}var U=w[E-1][D];var H=w[E-1].s;var V=(w[S].s-H)/(w[S][D]-U);while(E<S){w[E].s=H+(w[E][D]-U)*V;E++}}}}}return w}function p(e,t,r,n,a,o,s){var u=t._length;var c=e._fullLayout;var f=r._id;var h=n._id;var p=c._firstScatter[m(t)]===t.uid;var d=(g(t,c,r,n)||{}).orientation;var v=t.fill;r._minDtick=0;n._minDtick=0;var y={padded:true};var x={padded:true};if(s){y.ppad=x.ppad=s}var _=u<2||a[0]!==a[u-1]||o[0]!==o[u-1];if(_&&(v==="tozerox"||v==="tonextx"&&(p||d==="h"))){y.tozero=true}else if(!(t.error_y||{}).visible&&(v==="tonexty"||v==="tozeroy"||!l.hasMarkers(t)&&!l.hasText(t))){y.padded=false;y.ppad=0}if(_&&(v==="tozeroy"||v==="tonexty"&&(p||d==="v"))){x.tozero=true}else if(v==="tonextx"||v==="tozerox"){x.padded=false}if(f)t._extremes[f]=i.findExtremes(r,a,y);if(h)t._extremes[h]=i.findExtremes(n,o,x)}function d(e,t){if(!l.hasMarkers(e))return;var r=e.marker;var n=1.6*(e.marker.sizeref||1);var o;if(e.marker.sizemode==="area"){o=function(e){return Math.max(Math.sqrt((e||0)/n),3)}}else{o=function(e){return Math.max((e||0)/n,3)}}if(a.isArrayOrTypedArray(r.size)){var s={type:"linear"};i.setConvert(s);var u=s.makeCalcdata(e.marker,"size");var c=new Array(t);for(var f=0;f<t;f++){c[f]=o(u[f])}return c}else{return o(r.size)}}function v(e,t){var r=m(t);var n=e._firstScatter;if(!n[r])n[r]=t.uid}function m(e){var t=e.stackgroup;return e.xaxis+e.yaxis+e.type+(t?"-"+t:"")}function g(e,t,r,n){var a=e.stackgroup;if(!a)return;var i=t._scatterStackOpts[r._id+n._id][a];var o=i.orientation==="v"?n:r;if(o.type==="linear"||o.type==="log")return i}t.exports={calc:h,calcMarkerSize:d,calcAxisExpansion:p,setFirstScatter:v,getStackOpts:g}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"./arrays_to_calcdata":1186,"./calc_selection":1189,"./colorscale_calc":1190,"./subtypes":1212,"fast-isnumeric":241}],1189:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){if(n.isArrayOrTypedArray(r.selectedpoints)){n.tagSelected(t,r)}}},{"../../lib":778}],1190:[function(e,t,r){"use strict";var n=e("../../components/colorscale/helpers").hasColorscale;var a=e("../../components/colorscale/calc");var i=e("./subtypes");t.exports=function e(t,r){if(i.hasLines(r)&&n(r,"line")){a(t,r,{vals:r.line.color,containerStr:"line",cLetter:"c"})}if(i.hasMarkers(r)){if(n(r,"marker")){a(t,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"})}if(n(r,"marker.line")){a(t,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"})}}}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"./subtypes":1212}],1191:[function(e,t,r){"use strict";t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1192:[function(e,t,r){"use strict";var n=e("./calc");t.exports=function e(t,r){var i=r.xaxis;var o=r.yaxis;var s=i._id+o._id;var l=t._fullLayout._scatterStackOpts[s];if(!l)return;var u=t.calcdata;var c,f,h,p,d,v,m,g,y;var x,_,b,w,T;var k;for(var A in l){x=l[A];var M=x.traceIndices;if(!M.length)continue;_=x.stackgaps==="interpolate";b=x.groupnorm;if(x.orientation==="v"){w="x";T="y"}else{w="y";T="x"}k=new Array(M.length);for(c=0;c<k.length;c++){k[c]=false}v=u[M[0]];var E=new Array(v.length);for(c=0;c<v.length;c++){E[c]=v[c][w]}for(c=1;c<M.length;c++){d=u[M[c]];for(f=h=0;f<d.length;f++){m=d[f][w];for(;m>E[h]&&h<E.length;h++){a(d,f,E[h],c,k,_,w);f++}if(m!==E[h]){for(p=0;p<c;p++){a(u[M[p]],h,m,p,k,_,w)}E.splice(h,0,m)}h++}for(;h<E.length;h++){a(d,f,E[h],c,k,_,w);f++}}var S=E.length;for(f=0;f<v.length;f++){g=v[f][T]=v[f].s;for(c=1;c<M.length;c++){d=u[M[c]];d[0].trace._rawLength=d[0].trace._length;d[0].trace._length=S;g+=d[f].s;d[f][T]=g}if(b){y=(b==="fraction"?g:g/100)||1;for(c=0;c<M.length;c++){var C=u[M[c]][f];C[T]/=y;C.sNorm=C.s/y}}}for(c=0;c<M.length;c++){d=u[M[c]];var L=d[0].trace;var I=n.calcMarkerSize(L,L._rawLength);var O=Array.isArray(I);if(I&&k[c]||O){var P=I;I=new Array(S);for(f=0;f<S;f++){I[f]=d[f].gap?0:O?P[d[f].i]:P}}var D=new Array(S);var R=new Array(S);for(f=0;f<S;f++){D[f]=d[f].x;R[f]=d[f].y}n.calcAxisExpansion(t,L,i,o,D,R,I);d[0].t.orientation=x.orientation}}};function a(e,t,r,n,a,o,s){a[n]=true;var l={i:null,gap:true,s:0};l[s]=r;e.splice(t,0,l);if(t&&r===e[t-1][s]){var u=e[t-1];l.s=u.s;l.i=u.i;l.gap=u.gap}else if(o){l.s=i(e,t,r,s)}if(!t){e[0].t=e[1].t;e[0].trace=e[1].trace;delete e[1].t;delete e[1].trace}}function i(e,t,r,n){var a=e[t-1];var i=e[t+1];if(!i)return a.s;if(!a)return i.s;return a.s+(i.s-a.s)*(r-a[n])/(i[n]-a[n])}},{"./calc":1188}],1193:[function(e,t,r){"use strict";t.exports=function e(t){for(var r=0;r<t.length;r++){var n=t[r];if(n.type!=="scatter")continue;var a=n.fill;if(a==="none"||a==="toself")continue;n.opacity=undefined;if(a==="tonexty"||a==="tonextx"){for(var i=r-1;i>=0;i--){var o=t[i];if(o.type==="scatter"&&o.xaxis===n.xaxis&&o.yaxis===n.yaxis){o.opacity=undefined;break}}}}}},{}],1194:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");var i=e("./attributes");var o=e("./constants");var s=e("./subtypes");var l=e("./xy_defaults");var u=e("./period_defaults");var c=e("./stack_defaults");var f=e("./marker_defaults");var h=e("./line_defaults");var p=e("./line_shape_defaults");var d=e("./text_defaults");var v=e("./fillcolor_defaults");t.exports=function e(t,r,m,g){function y(e,a){return n.coerce(t,r,i,e,a)}var x=l(t,r,g,y);if(!x)r.visible=false;if(!r.visible)return;u(t,r,g,y);var _=c(t,r,g,y);var b=!_&&x<o.PTS_LINESONLY?"lines+markers":"lines";y("text");y("hovertext");y("mode",b);if(s.hasLines(r)){h(t,r,m,g,y);p(t,r,y);y("connectgaps");y("line.simplify")}if(s.hasMarkers(r)){f(t,r,m,g,y,{gradient:true})}if(s.hasText(r)){y("texttemplate");d(t,r,g,y)}var w=[];if(s.hasMarkers(r)||s.hasText(r)){y("cliponaxis");y("marker.maxdisplayed");w.push("points")}y("fill",_?_.fillDflt:"none");if(r.fill!=="none"){v(t,r,m,y);if(!s.hasLines(r))p(t,r,y)}var T=(r.line||{}).color;var k=(r.marker||{}).color;if(r.fill==="tonext"||r.fill==="toself"){w.push("fills")}y("hoveron",w.join("+")||"points");if(r.hoveron!=="fills")y("hovertemplate");var A=a.getComponentMethod("errorbars","supplyDefaults");A(t,r,T||k||m,{axis:"y"});A(t,r,T||k||m,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,y)}},{"../../lib":778,"../../registry":911,"./attributes":1187,"./constants":1191,"./fillcolor_defaults":1195,"./line_defaults":1200,"./line_shape_defaults":1202,"./marker_defaults":1206,"./period_defaults":1207,"./stack_defaults":1210,"./subtypes":1212,"./text_defaults":1213,"./xy_defaults":1214}],1195:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,i,o){var s=false;if(r.marker){var l=r.marker.color;var u=(r.marker.line||{}).color;if(l&&!a(l)){s=l}else if(u&&!a(u)){s=u}}o("fillcolor",n.addOpacity((r.line||{}).color||s||i,.5))}},{"../../components/color":643,"../../lib":778}],1196:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");t.exports=function e(t,r,a){var i={};var o={_fullLayout:a};var s=n.getFromTrace(o,r,"x");var l=n.getFromTrace(o,r,"y");i.xLabel=n.tickText(s,t.x,true).text;i.yLabel=n.tickText(l,t.y,true).text;return i}},{"../../plots/cartesian/axes":828}],1197:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("./subtypes");t.exports=function e(t,r){var i,o;if(t.mode==="lines"){i=t.line.color;return i&&n.opacity(i)?i:t.fillcolor}else if(t.mode==="none"){return t.fill?t.fillcolor:""}else{var s=r.mcc||(t.marker||{}).color;var l=r.mlcc||((t.marker||{}).line||{}).color;o=s&&n.opacity(s)?s:l&&n.opacity(l)&&(r.mlw||((t.marker||{}).line||{}).width)?l:"";if(o){if(n.opacity(o)<.3){return n.addOpacity(o,.3)}else return o}else{i=(t.line||{}).color;return i&&n.opacity(i)&&a.hasLines(t)&&t.line.width?i:t.fillcolor}}}},{"../../components/color":643,"./subtypes":1212}],1198:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/fx");var i=e("../../registry");var o=e("./get_trace_color");var s=e("../../components/color");var l=n.fillText;t.exports=function e(t,r,u,c){var f=t.cd;var h=f[0].trace;var p=t.xa;var d=t.ya;var v=p.c2p(r);var m=d.c2p(u);var g=[v,m];var y=h.hoveron||"";var x=h.mode.indexOf("markers")!==-1?3:.5;if(y.indexOf("points")!==-1){var _=function(e){var t=Math.max(3,e.mrc||0);var r=1-1/t;var n=Math.abs(p.c2p(e.x)-v);var a=n<t?r*n/t:n-t+r;return a};var b=function(e){var t=Math.max(3,e.mrc||0);var r=1-1/t;var n=Math.abs(d.c2p(e.y)-m);return n<t?r*n/t:n-t+r};var w=function(e){var t=Math.max(x,e.mrc||0);var r=p.c2p(e.x)-v;var n=d.c2p(e.y)-m;return Math.max(Math.sqrt(r*r+n*n)-t,1-x/t)};var T=a.getDistanceFunction(c,_,b,w);a.getClosest(f,T,t);if(t.index!==false){var k=f[t.index];var A=p.c2p(k.x,true);var M=d.c2p(k.y,true);var E=k.mrc||1;t.index=k.i;var S=f[0].t.orientation;var C=S&&(k.sNorm||k.s);var L=S==="h"?C:k.orig_x!==undefined?k.orig_x:k.x;var I=S==="v"?C:k.orig_y!==undefined?k.orig_y:k.y;n.extendFlat(t,{color:o(h,k),x0:A-E,x1:A+E,xLabelVal:L,y0:M-E,y1:M+E,yLabelVal:I,spikeDistance:w(k),hovertemplate:h.hovertemplate});l(k,h,t);i.getComponentMethod("errorbars","hoverInfo")(k,h,t);return[t]}}if(y.indexOf("fills")!==-1&&h._polygons){var O=h._polygons;var P=[];var D=false;var R=Infinity;var z=-Infinity;var N=Infinity;var F=-Infinity;var B,j,U,H,V,G,q,Y,W;for(B=0;B<O.length;B++){U=O[B];if(U.contains(g)){D=!D;P.push(U);N=Math.min(N,U.ymin);F=Math.max(F,U.ymax)}}if(D){N=Math.max(N,0);F=Math.min(F,d._length);var X=(N+F)/2;for(B=0;B<P.length;B++){H=P[B].pts;for(j=1;j<H.length;j++){Y=H[j-1][1];W=H[j][1];if(Y>X!==W>=X){G=H[j-1][0];q=H[j][0];if(W-Y){V=G+(q-G)*(X-Y)/(W-Y);R=Math.min(R,V);z=Math.max(z,V)}}}}R=Math.max(R,0);z=Math.min(z,p._length);var Z=s.defaultLine;if(s.opacity(h.fillcolor))Z=h.fillcolor;else if(s.opacity((h.line||{}).color)){Z=h.line.color}n.extendFlat(t,{distance:t.maxHoverDistance,x0:R,x1:z,y0:X,y1:X,color:Z,hovertemplate:false});delete t.index;if(h.text&&!Array.isArray(h.text)){t.text=String(h.text)}else t.text=h.name;return[t]}}}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"../../registry":911,"./get_trace_color":1197}],1199:[function(e,t,r){"use strict";var n=e("./subtypes");t.exports={hasLines:n.hasLines,hasMarkers:n.hasMarkers,hasText:n.hasText,isBubble:n.isBubble,attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./cross_trace_calc"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot"),colorbar:e("./marker_colorbar"),formatLabels:e("./format_labels"),style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("./select"),animatable:true,moduleType:"trace",name:"scatter",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"./arrays_to_calcdata":1186,"./attributes":1187,"./calc":1188,"./cross_trace_calc":1192,"./cross_trace_defaults":1193,"./defaults":1194,"./format_labels":1196,"./hover":1198,"./marker_colorbar":1205,"./plot":1208,"./select":1209,"./style":1211,"./subtypes":1212}],1200:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;var a=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");t.exports=function e(t,r,o,s,l,u){var c=(t.marker||{}).color;l("line.color",o);if(a(t,"line")){i(t,r,s,l,{prefix:"line.",cLetter:"c"})}else{var f=(n(c)?false:c)||o;l("line.color",f)}l("line.width");if(!(u||{}).noDash)l("line.dash")}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778}],1201:[function(e,t,r){"use strict";var n=e("../../constants/numerical");var a=n.BADNUM;var i=n.LOG_CLIP;var o=i+.5;var s=i-.5;var l=e("../../lib");var u=l.segmentsIntersect;var c=l.constrain;var f=e("./constants");t.exports=function e(t,r){var n=r.xaxis;var i=r.yaxis;var h=n.type==="log";var p=i.type==="log";var d=n._length;var v=i._length;var m=r.connectGaps;var g=r.baseTolerance;var y=r.shape;var x=y==="linear";var _=r.fill&&r.fill!=="none";var b=[];var w=f.minTolerance;var T=t.length;var k=new Array(T);var A=0;var M;var E,S,C,L;var I;var O;var P;var D;var R,z,N,F;var B,j,U;function H(e){var l=t[e];if(!l)return false;var u=r.linearized?n.l2p(l.x):n.c2p(l.x);var c=r.linearized?i.l2p(l.y):i.c2p(l.y);if(u===a){if(h)u=n.c2p(l.x,true);if(u===a)return false;if(p&&c===a){u*=Math.abs(n._m*v*(n._m>0?o:s)/(i._m*d*(i._m>0?o:s)))}u*=1e3}if(c===a){if(p)c=i.c2p(l.y,true);if(c===a)return false;c*=1e3}return[u,c]}function V(e,t,r,n){var a=r-e;var i=n-t;var o=.5-e;var s=.5-t;var l=a*a+i*i;var u=a*o+i*s;if(u>0&&u<l){var c=o*i-s*a;if(c*c<l)return true}}var G,q;function Y(e,t){var r=e[0]/d;var n=e[1]/v;var a=Math.max(0,-r,r-1,-n,n-1);if(a&&G!==undefined&&V(r,n,G,q)){a=0}if(a&&t&&V(r,n,t[0]/d,t[1]/v)){a=0}return(1+f.toleranceGrowth*a)*g}function W(e,t){var r=e[0]-t[0];var n=e[1]-t[1];return Math.sqrt(r*r+n*n)}var X=f.maxScreensAway;var Z=-d*X;var K=d*(1+X);var J=-v*X;var Q=v*(1+X);var $=[[Z,J,K,J],[K,J,K,Q],[K,Q,Z,Q],[Z,Q,Z,J]];var ee,te,re,ne,ae,ie;function oe(e,t){var r=[];var n=0;for(var a=0;a<4;a++){var i=$[a];var o=u(e[0],e[1],t[0],t[1],i[0],i[1],i[2],i[3]);if(o&&(!n||Math.abs(o.x-r[0][0])>1||Math.abs(o.y-r[0][1])>1)){o=[o.x,o.y];if(n&&W(o,e)<W(r[0],e))r.unshift(o);else r.push(o);n++}}return r}function se(e){if(e[0]<Z||e[0]>K||e[1]<J||e[1]>Q){return[c(e[0],Z,K),c(e[1],J,Q)]}}function le(e,t){if(e[0]===t[0]&&(e[0]===Z||e[0]===K))return true;if(e[1]===t[1]&&(e[1]===J||e[1]===Q))return true}function ue(e,t){var r=[];var n=se(e);var a=se(t);if(n&&a&&le(n,a))return r;if(n)r.push(n);if(a)r.push(a);return r}function ce(e,t,r){return function(n,a){var i=se(n);var o=se(a);var s=[];if(i&&o&&le(i,o))return s;if(i)s.push(i);if(o)s.push(o);var u=2*l.constrain((n[e]+a[e])/2,t,r)-((i||n)[e]+(o||a)[e]);if(u){var c;if(i&&o){c=u>0===i[e]>o[e]?i:o}else c=i||o;c[e]+=u}return s}}var fe;if(y==="linear"||y==="spline"){fe=oe}else if(y==="hv"||y==="vh"){fe=ue}else if(y==="hvh")fe=ce(0,Z,K);else if(y==="vhv")fe=ce(1,J,Q);function he(e,t){var r=t[0]-e[0];var n=(t[1]-e[1])/r;var a=(e[1]*t[0]-t[1]*e[0])/r;if(a>0)return[n>0?Z:K,Q];else return[n>0?K:Z,J]}function pe(e){var t=e[0];var r=e[1];var n=t===k[A-1][0];var a=r===k[A-1][1];if(n&&a)return;if(A>1){var i=t===k[A-2][0];var o=r===k[A-2][1];if(n&&(t===Z||t===K)&&i){if(o)A--;else k[A-1]=e}else if(a&&(r===J||r===Q)&&o){if(i)A--;else k[A-1]=e}else k[A++]=e}else k[A++]=e}function de(e){if(k[A-1][0]!==e[0]&&k[A-1][1]!==e[1]){pe([re,ne])}pe(e);ae=null;re=ne=0}function ve(e){G=e[0]/d;q=e[1]/v;ee=e[0]<Z?Z:e[0]>K?K:0;te=e[1]<J?J:e[1]>Q?Q:0;if(ee||te){if(!A){k[A++]=[ee||e[0],te||e[1]]}else if(ae){var t=fe(ae,e);if(t.length>1){de(t[0]);k[A++]=t[1]}}else{ie=fe(k[A-1],e)[0];k[A++]=ie}var r=k[A-1];if(ee&&te&&(r[0]!==ee||r[1]!==te)){if(ae){if(re!==ee&&ne!==te){if(re&&ne){pe(he(ae,e))}else{pe([re||ee,ne||te])}}else if(re&&ne){pe([re,ne])}}pe([ee,te])}else if(re-ee&&ne-te){pe([ee||re,te||ne])}ae=e;re=ee;ne=te}else{if(ae){de(fe(ae,e)[0])}k[A++]=e}}for(M=0;M<T;M++){E=H(M);if(!E)continue;A=0;ae=null;ve(E);for(M++;M<T;M++){C=H(M);if(!C){if(m)continue;else break}if(!x||!r.simplify){ve(C);continue}var me=H(M+1);R=W(C,E);if(!(_&&(A===0||A===T-1))&&R<Y(C,me)*w)continue;P=[(C[0]-E[0])/R,(C[1]-E[1])/R];L=E;z=R;N=B=j=0;O=false;S=C;for(M++;M<t.length;M++){I=me;me=H(M+1);if(!I){if(m)continue;else break}D=[I[0]-E[0],I[1]-E[1]];U=D[0]*P[1]-D[1]*P[0];B=Math.min(B,U);j=Math.max(j,U);if(j-B>Y(I,me))break;S=I;F=D[0]*P[0]+D[1]*P[1];if(F>z){z=F;C=I;O=false}else if(F<N){N=F;L=I;O=true}}if(O){ve(C);if(S!==L)ve(L)}else{if(L!==E)ve(L);if(S!==C)ve(C)}ve(S);if(M>=t.length||!I)break;ve(I);E=I}if(ae)pe([re||ae[0],ne||ae[1]]);b.push(k.slice(0,A))}return b}},{"../../constants/numerical":753,"../../lib":778,"./constants":1191}],1202:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var a=n("line.shape");if(a==="spline")n("line.smoothing")}},{}],1203:[function(e,t,r){"use strict";var n={tonextx:1,tonexty:1,tonext:1};t.exports=function e(t,r,a){var i,o,s,l,u;var c={};var f=false;var h=-1;var p=0;var d=-1;for(o=0;o<a.length;o++){i=a[o][0].trace;s=i.stackgroup||"";if(s){if(s in c){u=c[s]}else{u=c[s]=p;p++}}else if(i.fill in n&&d>=0){u=d}else{u=d=p;p++}if(u<h)f=true;i._groupIndex=h=u}var v=a.slice();if(f){v.sort(function(e,t){var r=e[0].trace;var n=t[0].trace;return r._groupIndex-n._groupIndex||r.index-n.index})}var m={};for(o=0;o<v.length;o++){i=v[o][0].trace;s=i.stackgroup||"";if(i.visible===true){i._nexttrace=null;if(i.fill in n){l=m[s];i._prevtrace=l||null;if(l){l._nexttrace=i}}i._ownfill=i.fill&&(i.fill.substr(0,6)==="tozero"||i.fill==="toself"||i.fill.substr(0,2)==="to"&&!i._prevtrace);m[s]=i}else{i._prevtrace=i._nexttrace=i._ownfill=null}}return v}},{}],1204:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports=function e(t){var r=t.marker;var a=r.sizeref||1;var i=r.sizemin||0;var o=r.sizemode==="area"?function(e){return Math.sqrt(e/a)}:function(e){return e/a};return function(e){var t=o(e/2);return n(t)&&t>0?Math.max(t,i):0}}},{"fast-isnumeric":241}],1205:[function(e,t,r){"use strict";t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1206:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("./subtypes");t.exports=function e(t,r,s,l,u,c){var f=o.isBubble(t);var h=(t.line||{}).color;var p;c=c||{};if(h)s=h;u("marker.symbol");u("marker.opacity",f?.7:1);u("marker.size");u("marker.color",s);if(a(t,"marker")){i(t,r,l,u,{prefix:"marker.",cLetter:"c"})}if(!c.noSelect){u("selected.marker.color");u("unselected.marker.color");u("selected.marker.size");u("unselected.marker.size")}if(!c.noLine){if(h&&!Array.isArray(h)&&r.marker.color!==h){p=h}else if(f)p=n.background;else p=n.defaultLine;u("marker.line.color",p);if(a(t,"marker.line")){i(t,r,l,u,{prefix:"marker.line.",cLetter:"c"})}u("marker.line.width",f?1:0)}if(f){u("marker.sizeref");u("marker.sizemin");u("marker.sizemode")}if(c.gradient){var d=u("marker.gradient.type");if(d!=="none"){u("marker.gradient.color")}}}},{"../../components/color":643,"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"./subtypes":1212}],1207:[function(e,t,r){"use strict";var n=e("../../lib").dateTick0;var a=e("../../constants/numerical");var i=a.ONEWEEK;function o(e,t){if(e%i===0){return n(t,1)}return n(t,0)}t.exports=function e(t,r,n,a,i){if(!i){i={x:true,y:true}}if(i.x){var s=a("xperiod");if(s){a("xperiod0",o(s,r.xcalendar));a("xperiodalignment")}}if(i.y){var l=a("yperiod");if(l){a("yperiod0",o(l,r.ycalendar));a("yperiodalignment")}}}},{"../../constants/numerical":753,"../../lib":778}],1208:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../lib");var o=i.ensureSingle;var s=i.identity;var l=e("../../components/drawing");var u=e("./subtypes");var c=e("./line_points");var f=e("./link_traces");var h=e("../../lib/polygon").tester;t.exports=function e(t,r,a,i,o,s){var l,u;var c=!o;var h=!!o&&o.duration>0;var v=f(t,r,a);l=i.selectAll("g.trace").data(v,function(e){return e[0].trace.uid});l.enter().append("g").attr("class",function(e){return"trace scatter trace"+e[0].trace.uid}).style("stroke-miterlimit",2);l.order();p(t,l,r);if(h){if(s){u=s()}var m=n.transition().duration(o.duration).ease(o.easing).each("end",function(){u&&u()}).each("interrupt",function(){u&&u()});m.each(function(){i.selectAll("g.trace").each(function(e,n){d(t,n,r,e,v,this,o)})})}else{l.each(function(e,n){d(t,n,r,e,v,this,o)})}if(c){l.exit().remove()}i.selectAll("path:not([d])").remove()};function p(e,t,r){t.each(function(t){var a=o(n.select(this),"g","fills");l.setClipUrl(a,r.layerClipId,e);var i=t[0].trace;var u=[];if(i._ownfill)u.push("_ownFill");if(i._nexttrace)u.push("_nextFill");var c=a.selectAll("g").data(u,s);c.enter().append("g");c.exit().each(function(e){i[e]=null}).remove();c.order().each(function(e){i[e]=o(n.select(this),"path","js-fill")})})}function d(e,t,r,f,p,d,m){var g;v(e,t,r,f,p);var y=!!m&&m.duration>0;function x(e){return y?e.transition():e}var _=r.xaxis;var b=r.yaxis;var w=f[0].trace;var T=w.line;var k=n.select(d);var A=o(k,"g","errorbars");var M=o(k,"g","lines");var E=o(k,"g","points");var S=o(k,"g","text");a.getComponentMethod("errorbars","plot")(e,A,r,m);if(w.visible!==true)return;x(k).style("opacity",w.opacity);var C,L;var I=w.fill.charAt(w.fill.length-1);if(I!=="x"&&I!=="y")I="";f[0][r.isRangePlot?"nodeRangePlot3":"node3"]=k;var O="";var P=[];var D=w._prevtrace;if(D){O=D._prevRevpath||"";L=D._nextFill;P=D._polygons}var R;var z;var N="";var F="";var B,j,U;var H,V,G,q;var Y=[];var W=i.noop;C=w._ownFill;if(u.hasLines(w)||w.fill!=="none"){if(L){L.datum(f)}if(["hv","vh","hvh","vhv"].indexOf(T.shape)!==-1){B=l.steps(T.shape);j=l.steps(T.shape.split("").reverse().join(""))}else if(T.shape==="spline"){B=j=function(e){var t=e[e.length-1];if(e.length>1&&e[0][0]===t[0]&&e[0][1]===t[1]){return l.smoothclosed(e.slice(1),T.smoothing)}else{return l.smoothopen(e,T.smoothing)}}}else{B=j=function(e){return"M"+e.join("L")}}U=function(e){return j(e.reverse())};Y=c(f,{xaxis:_,yaxis:b,connectGaps:w.connectgaps,baseTolerance:Math.max(T.width||1,3)/4,shape:T.shape,simplify:T.simplify,fill:w.fill});q=w._polygons=new Array(Y.length);for(g=0;g<Y.length;g++){w._polygons[g]=h(Y[g])}if(Y.length){H=Y[0][0];V=Y[Y.length-1];G=V[V.length-1]}W=function(e){return function(t){R=B(t);z=U(t);if(!N){N=R;F=z}else if(I){N+="L"+R.substr(1);F=z+("L"+F.substr(1))}else{N+="Z"+R;F=z+"Z"+F}if(u.hasLines(w)&&t.length>1){var r=n.select(this);r.datum(f);if(e){x(r.style("opacity",0).attr("d",R).call(l.lineGroupStyle)).style("opacity",1)}else{var a=x(r);a.attr("d",R);l.singleLineStyle(f,a)}}}}}var X=M.selectAll(".js-line").data(Y);x(X.exit()).style("opacity",0).remove();X.each(W(false));X.enter().append("path").classed("js-line",true).style("vector-effect","non-scaling-stroke").call(l.lineGroupStyle).each(W(true));l.setClipUrl(X,r.layerClipId,e);function Z(e){x(e).attr("d","M0,0Z")}if(Y.length){if(C){C.datum(f);if(H&&G){if(I){if(I==="y"){H[1]=G[1]=b.c2p(0,true)}else if(I==="x"){H[0]=G[0]=_.c2p(0,true)}x(C).attr("d","M"+G+"L"+H+"L"+N.substr(1)).call(l.singleFillStyle)}else{x(C).attr("d",N+"Z").call(l.singleFillStyle)}}}else if(L){if(w.fill.substr(0,6)==="tonext"&&N&&O){if(w.fill==="tonext"){x(L).attr("d",N+"Z"+O+"Z").call(l.singleFillStyle)}else{x(L).attr("d",N+"L"+O.substr(1)+"Z").call(l.singleFillStyle)}w._polygons=w._polygons.concat(P)}else{Z(L);w._polygons=null}}w._prevRevpath=F;w._prevPolygons=q}else{if(C)Z(C);else if(L)Z(L);w._polygons=w._prevRevpath=w._prevPolygons=null}function K(e){return e.filter(function(e){return!e.gap&&e.vis})}function J(e){return e.filter(function(e){return e.vis})}function Q(e){return e.filter(function(e){return!e.gap})}function $(e){return e.id}function ee(e){if(e.ids){return $}}function te(){return false}function re(t,a,i){var o,c,f;var h=i[0].trace;var p=u.hasMarkers(h);var d=u.hasText(h);var v=ee(h);var m=te;var g=te;if(p||d){var w=s;var T=h.stackgroup;var k=T&&e._fullLayout._scatterStackOpts[_._id+b._id][T].stackgaps==="infer zero";if(h.marker.maxdisplayed||h._needsCull){w=k?J:K}else if(T&&!k){w=Q}if(p)m=w;if(d)g=w}c=t.selectAll("path.point");o=c.data(m,v);var A=o.enter().append("path").classed("point",true);if(y){A.call(l.pointStyle,h,e).call(l.translatePoints,_,b).style("opacity",0).transition().style("opacity",1)}o.order();var M;if(p){M=l.makePointStyleFns(h)}o.each(function(t){var a=n.select(this);var i=x(a);f=l.translatePoint(t,i,_,b);if(f){l.singlePointStyle(t,i,h,M,e);if(r.layerClipId){l.hideOutsideRangePoint(t,i,_,b,h.xcalendar,h.ycalendar)}if(h.customdata){a.classed("plotly-customdata",t.data!==null&&t.data!==undefined)}}else{i.remove()}});if(y){o.exit().transition().style("opacity",0).remove()}else{o.exit().remove()}c=a.selectAll("g");o=c.data(g,v);o.enter().append("g").classed("textpoint",true).append("text");o.order();o.each(function(e){var t=n.select(this);var a=x(t.select("text"));f=l.translatePoint(e,a,_,b);if(f){if(r.layerClipId){l.hideOutsideRangePoint(e,t,_,b,h.xcalendar,h.ycalendar)}}else{t.remove()}});o.selectAll("text").call(l.textPointStyle,h,e).each(function(e){var t=_.c2p(e.x);var r=b.c2p(e.y);n.select(this).selectAll("tspan.line").each(function(){x(n.select(this)).attr({x:t,y:r})})});o.exit().remove()}E.datum(f);S.datum(f);re(E,S,f);var ne=w.cliponaxis===false;var ae=ne?null:r.layerClipId;l.setClipUrl(E,ae,e);l.setClipUrl(S,ae,e)}function v(e,t,r,a,o){var s=r.xaxis;var l=r.yaxis;var c=n.extent(i.simpleMap(s.range,s.r2c));var f=n.extent(i.simpleMap(l.range,l.r2c));var h=a[0].trace;if(!u.hasMarkers(h))return;var p=h.marker.maxdisplayed;if(p===0)return;var d=a.filter(function(e){return e.x>=c[0]&&e.x<=c[1]&&e.y>=f[0]&&e.y<=f[1]});var v=Math.ceil(d.length/p);var m=0;o.forEach(function(e,r){var n=e[0].trace;if(u.hasMarkers(n)&&n.marker.maxdisplayed>0&&r<t){m++}});var g=Math.round(m*v/3+Math.floor(m/3)*v/7.1);a.forEach(function(e){delete e.vis});d.forEach(function(e,t){if(Math.round((t+g)%v)===0)e.vis=true})}},{"../../components/drawing":665,"../../lib":778,"../../lib/polygon":790,"../../registry":911,"./line_points":1201,"./link_traces":1203,"./subtypes":1212,d3:169}],1209:[function(e,t,r){"use strict";var n=e("./subtypes");t.exports=function e(t,r){var a=t.cd;var i=t.xaxis;var o=t.yaxis;var s=[];var l=a[0].trace;var u;var c;var f;var h;var p=!n.hasMarkers(l)&&!n.hasText(l);if(p)return[];if(r===false){for(u=0;u<a.length;u++){a[u].selected=0}}else{for(u=0;u<a.length;u++){c=a[u];f=i.c2p(c.x);h=o.c2p(c.y);if(c.i!==null&&r.contains([f,h],false,u,t)){s.push({pointNumber:c.i,x:i.c2d(c.x),y:o.c2d(c.y)});c.selected=1}else{c.selected=0}}}return s}},{"./subtypes":1212}],1210:[function(e,t,r){"use strict";var n=["orientation","groupnorm","stackgaps"];t.exports=function e(t,r,a,i){var o=a._scatterStackOpts;var s=i("stackgroup");if(s){var l=r.xaxis+r.yaxis;var u=o[l];if(!u)u=o[l]={};var c=u[s];var f=false;if(c){c.traces.push(r)}else{c=u[s]={traceIndices:[],traces:[r]};f=true}var h={orientation:r.x&&!r.y?"h":"v"};for(var p=0;p<n.length;p++){var d=n[p];var v=d+"Found";if(!c[v]){var m=t[d]!==undefined;var g=d==="orientation";if(m||f){c[d]=i(d,h[d]);if(g){c.fillDflt=c[d]==="h"?"tonextx":"tonexty"}if(m){c[v]=true;if(!f){delete c.traces[0][d];if(g){for(var y=0;y<c.traces.length-1;y++){var x=c.traces[y];if(x._input.fill!==x.fill){x.fill=c.fillDflt}}}}}}}}return c}}},{}],1211:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../../registry");function o(e){var t=n.select(e).selectAll("g.trace.scatter");t.style("opacity",function(e){return e[0].trace.opacity});t.selectAll("g.points").each(function(t){var r=n.select(this);var a=t.trace||t[0].trace;s(r,a,e)});t.selectAll("g.text").each(function(t){var r=n.select(this);var a=t.trace||t[0].trace;l(r,a,e)});t.selectAll("g.trace path.js-line").call(a.lineGroupStyle);t.selectAll("g.trace path.js-fill").call(a.fillGroupStyle);i.getComponentMethod("errorbars","style")(t)}function s(e,t,r){a.pointStyle(e.selectAll("path.point"),t,r)}function l(e,t,r){a.textPointStyle(e.selectAll("text"),t,r)}function u(e,t,r){var n=t[0].trace;if(n.selectedpoints){a.selectedPointStyle(r.selectAll("path.point"),n);a.selectedTextStyle(r.selectAll("text"),n)}else{s(r,n,e);l(r,n,e)}}t.exports={style:o,stylePoints:s,styleText:l,styleOnSelect:u}},{"../../components/drawing":665,"../../registry":911,d3:169}],1212:[function(e,t,r){"use strict";var n=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&e.mode.indexOf("lines")!==-1},hasMarkers:function(e){return e.visible&&(e.mode&&e.mode.indexOf("markers")!==-1||e.type==="splom")},hasText:function(e){return e.visible&&e.mode&&e.mode.indexOf("text")!==-1},isBubble:function(e){return n.isPlainObject(e.marker)&&n.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":778}],1213:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function(e,t,r,a,i){i=i||{};a("textposition");n.coerceFont(a,"textfont",r.font);if(!i.noSelect){a("selected.textfont.color");a("unselected.textfont.color")}}},{"../../lib":778}],1214:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");t.exports=function e(t,r,i,o){var s=o("x");var l=o("y");var u;var c=a.getComponentMethod("calendars","handleTraceDefaults");c(t,r,["x","y"],i);if(s){var f=n.minRowLength(s);if(l){u=Math.min(f,n.minRowLength(l))}else{u=f;o("y0");o("dy")}}else{if(!l)return 0;u=n.minRowLength(l);o("x0");o("dx")}r._length=u;return u}},{"../../lib":778,"../../registry":911}],1215:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var a=e("../../components/colorscale/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/template_attributes").texttemplateAttrs;var s=e("../../plots/attributes");var l=e("../../constants/gl3d_dashes");var u=e("../../constants/gl3d_markers");var c=e("../../lib/extend").extendFlat;var f=e("../../plot_api/edit_types").overrideAll;var h=n.line;var p=n.marker;var d=p.line;var v=c({width:h.width,dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},a("line"));function m(e){return{show:{valType:"boolean",dflt:false},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var g=t.exports=f({x:n.x,y:n.y,z:{valType:"data_array"},text:c({},n.text,{}),texttemplate:o({},{}),hovertext:c({},n.hovertext,{}),hovertemplate:i(),mode:c({},n.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:m("x"),y:m("y"),z:m("z")},connectgaps:n.connectgaps,line:v,marker:c({symbol:{valType:"enumerated",values:Object.keys(u),dflt:"circle",arrayOk:true},size:c({},p.size,{dflt:8}),sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode,opacity:c({},p.opacity,{arrayOk:false}),colorbar:p.colorbar,line:c({width:c({},d.width,{arrayOk:false})},a("marker.line"))},a("marker")),textposition:c({},n.textposition,{dflt:"top center"}),textfont:{color:n.textfont.color,size:n.textfont.size,family:c({},n.textfont.family,{arrayOk:false})},hoverinfo:c({},s.hoverinfo)},"calc","nested");g.x.editType=g.y.editType=g.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":650,"../../constants/gl3d_dashes":750,"../../constants/gl3d_markers":751,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1216:[function(e,t,r){"use strict";var n=e("../scatter/arrays_to_calcdata");var a=e("../scatter/colorscale_calc");t.exports=function e(t,r){var i=[{x:false,y:false,trace:r,t:{}}];n(i,r);a(t,r);return i}},{"../scatter/arrays_to_calcdata":1186,"../scatter/colorscale_calc":1190}],1217:[function(e,t,r){"use strict";var n=e("../../registry");function a(e,t,r,a){if(!t||!t.visible)return null;var i=n.getComponentMethod("errorbars","makeComputeError")(t);var o=new Array(e.length);for(var s=0;s<e.length;s++){var l=i(+e[s],s);if(a.type==="log"){var u=a.c2l(e[s]);var c=e[s]-l[0];var f=e[s]+l[1];o[s]=[(a.c2l(c,true)-u)*r,(a.c2l(f,true)-u)*r];if(c>0){var h=a.c2l(c);if(!a._lowerLogErrorBound)a._lowerLogErrorBound=h;a._lowerErrorBound=Math.min(a._lowerLogErrorBound,h)}}else{o[s]=[-l[0]*r,l[1]*r]}}return o}function i(e){for(var t=0;t<e.length;t++){if(e[t])return e[t].length}return 0}function o(e,t,r){var n=[a(e.x,e.error_x,t[0],r.xaxis),a(e.y,e.error_y,t[1],r.yaxis),a(e.z,e.error_z,t[2],r.zaxis)];var o=i(n);if(o===0)return null;var s=new Array(o);for(var l=0;l<o;l++){var u=[[0,0,0],[0,0,0]];for(var c=0;c<3;c++){if(n[c]){for(var f=0;f<2;f++){u[f][c]=n[c][l][f]}}}s[l]=u}return s}t.exports=o},{"../../registry":911}],1218:[function(e,t,r){"use strict";var n=e("gl-line3d");var a=e("gl-scatter3d");var i=e("gl-error3d");var o=e("gl-mesh3d");var s=e("delaunay-triangulate");var l=e("../../lib");var u=e("../../lib/str2rgbarray");var c=e("../../lib/gl_format_color").formatColor;var f=e("../scatter/make_bubble_size_func");var h=e("../../constants/gl3d_dashes");var p=e("../../constants/gl3d_markers");var d=e("../../plots/cartesian/axes");var v=e("../../components/fx/helpers").appendArrayPointValue;var m=e("./calc_errors");function g(e,t){this.scene=e;this.uid=t;this.linePlot=null;this.scatterPlot=null;this.errorBars=null;this.textMarkers=null;this.delaunayMesh=null;this.color=null;this.mode="";this.dataPoints=[];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.textLabels=null;this.data=null}var y=g.prototype;y.handlePick=function(e){if(e.object&&(e.object===this.linePlot||e.object===this.delaunayMesh||e.object===this.textMarkers||e.object===this.scatterPlot)){var t=e.index=e.data.index;if(e.object.highlight){e.object.highlight(null)}if(this.scatterPlot){e.object=this.scatterPlot;this.scatterPlot.highlight(e.data)}e.textLabel="";if(this.textLabels){if(Array.isArray(this.textLabels)){if(this.textLabels[t]||this.textLabels[t]===0){e.textLabel=this.textLabels[t]}}else{e.textLabel=this.textLabels}}e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]];return true}};function x(e,t,r){var n=(r+1)%3;var a=(r+2)%3;var i=[];var o=[];var l;for(l=0;l<e.length;++l){var u=e[l];if(isNaN(u[n])||!isFinite(u[n])||isNaN(u[a])||!isFinite(u[a])){continue}i.push([u[n],u[a]]);o.push(l)}var c=s(i);for(l=0;l<c.length;++l){var f=c[l];for(var h=0;h<f.length;++h){f[h]=o[f[h]]}}return{positions:e,cells:c,meshColor:t}}function _(e){var t=[0,0,0];var r=[[0,0,0],[0,0,0],[0,0,0]];var n=[1,1,1];for(var a=0;a<3;a++){var i=e[a];if(i&&i.copy_zstyle!==false&&e[2].visible!==false)i=e[2];if(!i||!i.visible)continue;t[a]=i.width/2;r[a]=u(i.color);n[a]=i.thickness}return{capSize:t,color:r,lineWidth:n}}function b(e){if(e===null||e===undefined)return 0;return e.indexOf("left")>-1?-1:e.indexOf("right")>-1?1:0}function w(e){if(e===null||e===undefined)return 0;return e.indexOf("top")>-1?-1:e.indexOf("bottom")>-1?1:0}function T(e){var t=0;var r=0;var n=[t,r];if(Array.isArray(e)){for(var a=0;a<e.length;a++){n[a]=[t,r];if(e[a]){n[a][0]=b(e[a]);n[a][1]=w(e[a])}}}else{n[0]=b(e);n[1]=w(e)}return n}function k(e,t){return t(e*4)}function A(e){return p[e]}function M(e,t,r,n,a){var i=null;if(l.isArrayOrTypedArray(e)){i=[];for(var o=0;o<t;o++){if(e[o]===undefined)i[o]=n;else i[o]=r(e[o],a)}}else i=r(e,l.identity);return i}function E(e,t){var r=[];var n=e.fullSceneLayout;var a=e.dataScale;var i=n.xaxis;var o=n.yaxis;var s=n.zaxis;var h=t.marker;var p=t.line;var g=t.x||[];var y=t.y||[];var x=t.z||[];var b=g.length;var w=t.xcalendar;var E=t.ycalendar;var S=t.zcalendar;var C,L,I;var O,P;var D;for(P=0;P<b;P++){C=i.d2l(g[P],0,w)*a[0];L=o.d2l(y[P],0,E)*a[1];I=s.d2l(x[P],0,S)*a[2];r[P]=[C,L,I]}if(Array.isArray(t.text))D=t.text;else if(t.text!==undefined){D=new Array(b);for(P=0;P<b;P++)D[P]=t.text}function R(e,t){var r=n[e];return d.tickText(r,r.d2l(t),true).text}var z=t.texttemplate;if(z){var N=e.fullLayout;var F=N._d3locale;var B=Array.isArray(z);var j=B?Math.min(z.length,b):b;var U=B?function(e){return z[e]}:function(){return z};D=new Array(j);for(P=0;P<j;P++){var H={x:g[P],y:y[P],z:x[P]};var V={xLabel:R("xaxis",g[P]),yLabel:R("yaxis",y[P]),zLabel:R("zaxis",x[P])};var G={};v(G,t,P);var q=t._meta||{};D[P]=l.texttemplateString(U(P),V,F,G,H,q)}}O={position:r,mode:t.mode,text:D};if("line"in t){O.lineColor=c(p,1,b);O.lineWidth=p.width;O.lineDashes=p.dash}if("marker"in t){var Y=f(t);O.scatterColor=c(h,1,b);O.scatterSize=M(h.size,b,k,20,Y);O.scatterMarker=M(h.symbol,b,A,"●");O.scatterLineWidth=h.line.width;O.scatterLineColor=c(h.line,1,b);O.scatterAngle=0}if("textposition"in t){O.textOffset=T(t.textposition);O.textColor=c(t.textfont,1,b);O.textSize=M(t.textfont.size,b,l.identity,12);O.textFont=t.textfont.family;O.textAngle=0}var W=["x","y","z"];O.project=[false,false,false];O.projectScale=[1,1,1];O.projectOpacity=[1,1,1];for(P=0;P<3;++P){var X=t.projection[W[P]];if(O.project[P]=X.show){O.projectOpacity[P]=X.opacity;O.projectScale[P]=X.scale}}O.errorBounds=m(t,a,n);var Z=_([t.error_x,t.error_y,t.error_z]);O.errorColor=Z.color;O.errorLineWidth=Z.lineWidth;O.errorCapSize=Z.capSize;O.delaunayAxis=t.surfaceaxis;O.delaunayColor=u(t.surfacecolor);return O}function S(e){if(l.isArrayOrTypedArray(e)){var t=e[0];if(l.isArrayOrTypedArray(t))e=t;return"rgb("+e.slice(0,3).map(function(e){return Math.round(e*255)})+")"}return null}function C(e){if(!l.isArrayOrTypedArray(e)){return null}if(e.length===4&&typeof e[0]==="number"){return S(e)}return e.map(S)}y.update=function(e){var t=this.scene.glplot.gl;var r;var s;var l;var u;var c=h.solid;this.data=e;var f=E(this.scene,e);if("mode"in f){this.mode=f.mode}if("lineDashes"in f){if(f.lineDashes in h){c=h[f.lineDashes]}}this.color=C(f.scatterColor)||C(f.lineColor);this.dataPoints=f.position;r={gl:this.scene.glplot.gl,position:f.position,color:f.lineColor,lineWidth:f.lineWidth||1,dashes:c[0],dashScale:c[1],opacity:e.opacity,connectGaps:e.connectgaps};if(this.mode.indexOf("lines")!==-1){if(this.linePlot)this.linePlot.update(r);else{this.linePlot=n(r);this.linePlot._trace=this;this.scene.glplot.add(this.linePlot)}}else if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose();this.linePlot=null}var p=e.opacity;if(e.marker&&e.marker.opacity)p*=e.marker.opacity;s={gl:this.scene.glplot.gl,position:f.position,color:f.scatterColor,size:f.scatterSize,glyph:f.scatterMarker,opacity:p,orthographic:true,lineWidth:f.scatterLineWidth,lineColor:f.scatterLineColor,project:f.project,projectScale:f.projectScale,projectOpacity:f.projectOpacity};if(this.mode.indexOf("markers")!==-1){if(this.scatterPlot)this.scatterPlot.update(s);else{this.scatterPlot=a(s);this.scatterPlot._trace=this;this.scatterPlot.highlightScale=1;this.scene.glplot.add(this.scatterPlot)}}else if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose();this.scatterPlot=null}u={gl:this.scene.glplot.gl,position:f.position,glyph:f.text,color:f.textColor,size:f.textSize,angle:f.textAngle,alignment:f.textOffset,font:f.textFont,orthographic:true,lineWidth:0,project:false,opacity:e.opacity};this.textLabels=e.hovertext||e.text;if(this.mode.indexOf("text")!==-1){if(this.textMarkers)this.textMarkers.update(u);else{this.textMarkers=a(u);this.textMarkers._trace=this;this.textMarkers.highlightScale=1;this.scene.glplot.add(this.textMarkers)}}else if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose();this.textMarkers=null}l={gl:this.scene.glplot.gl,position:f.position,color:f.errorColor,error:f.errorBounds,lineWidth:f.errorLineWidth,capSize:f.errorCapSize,opacity:e.opacity};if(this.errorBars){if(f.errorBounds){this.errorBars.update(l)}else{this.scene.glplot.remove(this.errorBars);this.errorBars.dispose();this.errorBars=null}}else if(f.errorBounds){this.errorBars=i(l);this.errorBars._trace=this;this.scene.glplot.add(this.errorBars)}if(f.delaunayAxis>=0){var d=x(f.position,f.delaunayColor,f.delaunayAxis);d.opacity=e.opacity;if(this.delaunayMesh){this.delaunayMesh.update(d)}else{d.gl=t;this.delaunayMesh=o(d);this.delaunayMesh._trace=this;this.scene.glplot.add(this.delaunayMesh)}}else if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose();this.delaunayMesh=null}};y.dispose=function(){if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose()}if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose()}if(this.errorBars){this.scene.glplot.remove(this.errorBars);this.errorBars.dispose()}if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose()}if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose()}};function L(e,t){var r=new g(e,t.uid);r.update(t);return r}t.exports=L},{"../../components/fx/helpers":679,"../../constants/gl3d_dashes":750,"../../constants/gl3d_markers":751,"../../lib":778,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"../scatter/make_bubble_size_func":1204,"./calc_errors":1217,"delaunay-triangulate":171,"gl-error3d":266,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":330}],1219:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/text_defaults");var u=e("./attributes");t.exports=function e(t,r,f,h){function p(e,n){return a.coerce(t,r,u,e,n)}var d=c(t,r,p,h);if(!d){r.visible=false;return}p("text");p("hovertext");p("hovertemplate");p("mode");if(i.hasLines(r)){p("connectgaps");s(t,r,f,h,p)}if(i.hasMarkers(r)){o(t,r,f,h,p,{noSelect:true})}if(i.hasText(r)){p("texttemplate");l(t,r,h,p,{noSelect:true})}var v=(r.line||{}).color;var m=(r.marker||{}).color;if(p("surfaceaxis")>=0)p("surfacecolor",v||m);var g=["x","y","z"];for(var y=0;y<3;++y){var x="projection."+g[y];if(p(x+".show")){p(x+".opacity");p(x+".scale")}}var _=n.getComponentMethod("errorbars","supplyDefaults");_(t,r,v||m||f,{axis:"z"});_(t,r,v||m||f,{axis:"y",inherit:"z"});_(t,r,v||m||f,{axis:"x",inherit:"z"})};function c(e,t,r,a){var i=0;var o=r("x");var s=r("y");var l=r("z");var u=n.getComponentMethod("calendars","handleTraceDefaults");u(e,t,["x","y","z"],a);if(o&&s&&l){i=Math.min(o.length,s.length,l.length);t._length=t._xlength=t._ylength=t._zlength=i}return i}},{"../../lib":778,"../../registry":911,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1215}],1220:[function(e,t,r){"use strict";t.exports={plot:e("./convert"),attributes:e("./attributes"),markerSymbols:e("../../constants/gl3d_markers"),supplyDefaults:e("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:e("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":751,"../../plots/gl3d":870,"./attributes":1215,"./calc":1216,"./convert":1218,"./defaults":1219}],1221:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var a=e("../../plots/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/template_attributes").texttemplateAttrs;var s=e("../../components/colorscale/attributes");var l=e("../../lib/extend").extendFlat;var u=n.marker;var c=n.line;var f=u.line;t.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:l({},n.mode,{dflt:"markers"}),text:l({},n.text,{}),texttemplate:o({editType:"plot"},{keys:["a","b","text"]}),hovertext:l({},n.hovertext,{}),line:{color:c.color,width:c.width,dash:c.dash,shape:l({},c.shape,{values:["linear","spline"]}),smoothing:c.smoothing,editType:"calc"},connectgaps:n.connectgaps,fill:l({},n.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:n.fillcolor,marker:l({symbol:u.symbol,opacity:u.opacity,maxdisplayed:u.maxdisplayed,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,line:l({width:f.width,editType:"calc"},s("marker.line")),gradient:u.gradient,editType:"calc"},s("marker")),textfont:n.textfont,textposition:n.textposition,selected:n.selected,unselected:n.unselected,hoverinfo:l({},a.hoverinfo,{flags:["a","b","text","name"]}),hoveron:n.hoveron,hovertemplate:i()}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1222:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../scatter/colorscale_calc");var i=e("../scatter/arrays_to_calcdata");var o=e("../scatter/calc_selection");var s=e("../scatter/calc").calcMarkerSize;var l=e("../carpet/lookup_carpetid");t.exports=function e(t,r){var u=r._carpetTrace=l(t,r);if(!u||!u.visible||u.visible==="legendonly")return;var c;r.xaxis=u.xaxis;r.yaxis=u.yaxis;var f=r._length;var h=new Array(f);var p,d;var v=false;for(c=0;c<f;c++){p=r.a[c];d=r.b[c];if(n(p)&&n(d)){var m=u.ab2xy(+p,+d,true);var g=u.isVisible(+p,+d);if(!g)v=true;h[c]={x:m[0],y:m[1],a:p,b:d,vis:g}}else h[c]={x:false,y:false}}r._needsCull=v;h[0].carpet=u;h[0].trace=r;s(r,f);a(t,r);i(h,r);o(h,r);return h}},{"../carpet/lookup_carpetid":981,"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1223:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/constants");var i=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/line_shape_defaults");var u=e("../scatter/text_defaults");var c=e("../scatter/fillcolor_defaults");var f=e("./attributes");t.exports=function e(t,r,h,p){function d(e,a){return n.coerce(t,r,f,e,a)}d("carpet");r.xaxis="x";r.yaxis="y";var v=d("a");var m=d("b");var g=Math.min(v.length,m.length);if(!g){r.visible=false;return}r._length=g;d("text");d("texttemplate");d("hovertext");var y=g<a.PTS_LINESONLY?"lines+markers":"lines";d("mode",y);if(i.hasLines(r)){s(t,r,h,p,d);l(t,r,d);d("connectgaps")}if(i.hasMarkers(r)){o(t,r,h,p,d,{gradient:true})}if(i.hasText(r)){u(t,r,p,d)}var x=[];if(i.hasMarkers(r)||i.hasText(r)){d("marker.maxdisplayed");x.push("points")}d("fill");if(r.fill!=="none"){c(t,r,h,d);if(!i.hasLines(r))l(t,r,d)}if(r.fill==="tonext"||r.fill==="toself"){x.push("fills")}var _=d("hoveron",x.join("+")||"points");if(_!=="fills")d("hovertemplate");n.coerceSelectionMarkerOpacity(r,d)}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1221}],1224:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i){var o=a[i];t.a=o.a;t.b=o.b;t.y=o.y;return t}},{}],1225:[function(e,t,r){"use strict";t.exports=function e(t,r){var n={};var a=r._carpet;var i=a.ab2ij([t.a,t.b]);var o=Math.floor(i[0]);var s=i[0]-o;var l=Math.floor(i[1]);var u=i[1]-l;var c=a.evalxy([],o,l,s,u);n.yLabel=c[1].toFixed(3);return n}},{}],1226:[function(e,t,r){"use strict";var n=e("../scatter/hover");var a=e("../../lib").fillText;t.exports=function e(t,r,i,o){var s=n(t,r,i,o);if(!s||s[0].index===false)return;var l=s[0];if(l.index===undefined){var u=1-l.y0/t.ya._length;var c=t.xa._length;var f=c*u/2;var h=c-f;l.x0=Math.max(Math.min(l.x0,h),f);l.x1=Math.max(Math.min(l.x1,h),f);return s}var p=l.cd[l.index];l.a=p.a;l.b=p.b;l.xLabelVal=undefined;l.yLabelVal=undefined;var d=l.trace;var v=d._carpet;var m=d._module.formatLabels(p,d);l.yLabel=m.yLabel;delete l.text;var g=[];function y(e,t){var r;if(e.labelprefix&&e.labelprefix.length>0){r=e.labelprefix.replace(/ = $/,"")}else{r=e._hovertitle}g.push(r+": "+t.toFixed(3)+e.labelsuffix)}if(!d.hovertemplate){var x=p.hi||d.hoverinfo;var _=x.split("+");if(_.indexOf("all")!==-1)_=["a","b","text"];if(_.indexOf("a")!==-1)y(v.aaxis,p.a);if(_.indexOf("b")!==-1)y(v.baxis,p.b);g.push("y: "+l.yLabel);if(_.indexOf("text")!==-1){a(p,d,g)}l.extraText=g.join("<br>")}return s}},{"../../lib":778,"../scatter/hover":1198}],1227:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:e("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1221,"./calc":1222,"./defaults":1223,"./event_data":1224,"./format_labels":1225,"./hover":1226,"./plot":1228}],1228:[function(e,t,r){"use strict";var n=e("../scatter/plot");var a=e("../../plots/cartesian/axes");var i=e("../../components/drawing");t.exports=function e(t,r,o,s){var l,u,c;var f=o[0][0].carpet;var h={xaxis:a.getFromId(t,f.xaxis||"x"),yaxis:a.getFromId(t,f.yaxis||"y"),plot:r.plot};n(t,h,o,s);for(l=0;l<o.length;l++){u=o[l][0].trace;c=s.selectAll("g.trace"+u.uid+" .js-line");i.setClipUrl(c,o[l][0].carpet._clipPathId,t)}}},{"../../components/drawing":665,"../../plots/cartesian/axes":828,"../scatter/plot":1208}],1229:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../scatter/attributes");var o=e("../../plots/attributes");var s=e("../../components/colorscale/attributes");var l=e("../../components/drawing/attributes").dash;var u=e("../../lib/extend").extendFlat;var c=e("../../plot_api/edit_types").overrideAll;var f=i.marker;var h=i.line;var p=f.line;t.exports=c({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:u({},i.mode,{dflt:"markers"}),text:u({},i.text,{}),texttemplate:a({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:u({},i.hovertext,{}),textfont:i.textfont,textposition:i.textposition,line:{color:h.color,width:h.width,dash:l},connectgaps:i.connectgaps,marker:u({symbol:f.symbol,opacity:f.opacity,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,colorbar:f.colorbar,line:u({width:p.width},s("marker.line")),gradient:f.gradient},s("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:i.fillcolor,selected:i.selected,unselected:i.unselected,hoverinfo:u({},o.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:n()},"calc","nested")},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1230:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../constants/numerical").BADNUM;var i=e("../scatter/colorscale_calc");var o=e("../scatter/arrays_to_calcdata");var s=e("../scatter/calc_selection");var l=e("../../lib")._;function u(e){return e&&typeof e==="string"}t.exports=function e(t,r){var c=Array.isArray(r.locations);var f=c?r.locations.length:r._length;var h=new Array(f);var p;if(r.geojson){p=function(e){return u(e)||n(e)}}else{p=u}for(var d=0;d<f;d++){var v=h[d]={};if(c){var m=r.locations[d];v.loc=p(m)?m:null}else{var g=r.lon[d];var y=r.lat[d];if(n(g)&&n(y))v.lonlat=[+g,+y];else v.lonlat=[a,a]}}o(h,r);i(t,r);s(h,r);if(f){h[0].t={labels:{lat:l(t,"lat:")+" ",lon:l(t,"lon:")+" "}}}return h}},{"../../constants/numerical":753,"../../lib":778,"../scatter/arrays_to_calcdata":1186,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1231:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/subtypes");var i=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/text_defaults");var l=e("../scatter/fillcolor_defaults");var u=e("./attributes");t.exports=function e(t,r,c,f){function h(e,a){return n.coerce(t,r,u,e,a)}var p=h("locations");var d;if(p&&p.length){var v=h("geojson");var m;if(typeof v==="string"&&v!==""||n.isPlainObject(v)){m="geojson-id"}var g=h("locationmode",m);if(g==="geojson-id"){h("featureidkey")}d=p.length}else{var y=h("lon")||[];var x=h("lat")||[];d=Math.min(y.length,x.length)}if(!d){r.visible=false;return}r._length=d;h("text");h("hovertext");h("hovertemplate");h("mode");if(a.hasLines(r)){o(t,r,c,f,h);h("connectgaps")}if(a.hasMarkers(r)){i(t,r,c,f,h,{gradient:true})}if(a.hasText(r)){h("texttemplate");s(t,r,f,h)}h("fill");if(r.fill!=="none"){l(t,r,c,h)}n.coerceSelectionMarkerOpacity(r,h)}},{"../../lib":778,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1229}],1232:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i){t.lon=r.lon;t.lat=r.lat;t.location=r.loc?r.loc:null;var o=a[i];if(o.fIn&&o.fIn.properties){t.properties=o.fIn.properties}return t}},{}],1233:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");t.exports=function e(t,r,a){var i={};var o=a[r.geo]._subplot;var s=o.mockAxis;var l=t.lonlat;i.lonLabel=n.tickText(s,s.c2l(l[0]),true).text;i.latLabel=n.tickText(s,s.c2l(l[1]),true).text;return i}},{"../../plots/cartesian/axes":828}],1234:[function(e,t,r){"use strict";var n=e("../../components/fx");var a=e("../../constants/numerical").BADNUM;var i=e("../scatter/get_trace_color");var o=e("../../lib").fillText;var s=e("./attributes");t.exports=function e(t,r,o){var s=t.cd;var u=s[0].trace;var c=t.xa;var f=t.ya;var h=t.subplot;var p=h.projection.isLonLatOverEdges;var d=h.project;function v(e){var t=e.lonlat;if(t[0]===a)return Infinity;if(p(t))return Infinity;var n=d(t);var i=d([r,o]);var s=Math.abs(n[0]-i[0]);var l=Math.abs(n[1]-i[1]);var u=Math.max(3,e.mrc||0);return Math.max(Math.sqrt(s*s+l*l)-u,1-3/u)}n.getClosest(s,v,t);if(t.index===false)return;var m=s[t.index];var g=m.lonlat;var y=[c.c2p(g),f.c2p(g)];var x=m.mrc||1;t.x0=y[0]-x;t.x1=y[0]+x;t.y0=y[1]-x;t.y1=y[1]+x;t.loc=m.loc;t.lon=g[0];t.lat=g[1];var _={};_[u.geo]={_subplot:h};var b=u._module.formatLabels(m,u,_);t.lonLabel=b.lonLabel;t.latLabel=b.latLabel;t.color=i(u,m);t.extraText=l(u,m,t,s[0].t.labels);t.hovertemplate=u.hovertemplate;return[t]};function l(e,t,r,n){if(e.hovertemplate)return;var a=t.hi||e.hoverinfo;var i=a==="all"?s.hoverinfo.flags:a.split("+");var l=i.indexOf("location")!==-1&&Array.isArray(e.locations);var u=i.indexOf("lon")!==-1;var c=i.indexOf("lat")!==-1;var f=i.indexOf("text")!==-1;var h=[];function p(e){return e+"°"}if(l){h.push(t.loc)}else if(u&&c){h.push("("+p(r.lonLabel)+", "+p(r.latLabel)+")")}else if(u){h.push(n.lon+p(r.lonLabel))}else if(c){h.push(n.lat+p(r.latLabel))}if(f){o(t,e,h)}return h.join("<br>")}},{"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../scatter/get_trace_color":1197,"./attributes":1229}],1235:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),calcGeoJSON:e("./plot").calcGeoJSON,plot:e("./plot").plot,style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:e("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":860,"../scatter/marker_colorbar":1205,"../scatter/style":1211,"./attributes":1229,"./calc":1230,"./defaults":1231,"./event_data":1232,"./format_labels":1233,"./hover":1234,"./plot":1236,"./select":1237,"./style":1238}],1236:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../lib/topojson_utils").getTopojsonFeatures;var o=e("../../lib/geojson_utils");var s=e("../../lib/geo_location_utils");var l=e("../../plots/cartesian/autorange").findExtremes;var u=e("../../constants/numerical").BADNUM;var c=e("../scatter/calc").calcMarkerSize;var f=e("../scatter/subtypes");var h=e("./style");function p(e,t,r){var i=t.layers.frontplot.select(".scatterlayer");var s=a.makeTraceGroups(i,r,"trace scattergeo");function l(e,t){if(e.lonlat[0]===u){n.select(t).remove()}}s.selectAll("*").remove();s.each(function(t){var r=n.select(this);var i=t[0].trace;if(f.hasLines(i)||i.fill!=="none"){var s=o.calcTraceToLineCoords(t);var u=i.fill!=="none"?o.makePolygon(s):o.makeLine(s);r.selectAll("path.js-line").data([{geojson:u,trace:i}]).enter().append("path").classed("js-line",true).style("stroke-miterlimit",2)}if(f.hasMarkers(i)){r.selectAll("path.point").data(a.identity).enter().append("path").classed("point",true).each(function(e){l(e,this)})}if(f.hasText(i)){r.selectAll("g").data(a.identity).enter().append("g").append("text").each(function(e){l(e,this)})}h(e,t)})}function d(e,t){var r=e[0].trace;var n=t[r.geo];var a=n._subplot;var o=r._length;var f,h;if(Array.isArray(r.locations)){var p=r.locationmode;var d=p==="geojson-id"?s.extractTraceFeature(e):i(r,a.topojson);for(f=0;f<o;f++){h=e[f];var v=p==="geojson-id"?h.fOut:s.locationToFeature(p,h.loc,d);h.lonlat=v?v.properties.ct:[u,u]}}var m={padded:true};var g;var y;if(n.fitbounds==="geojson"&&r.locationmode==="geojson-id"){var x=s.computeBbox(s.getTraceGeojson(r));g=[x[0],x[2]];y=[x[1],x[3]]}else{g=new Array(o);y=new Array(o);for(f=0;f<o;f++){h=e[f];g[f]=h.lonlat[0];y[f]=h.lonlat[1]}m.ppad=c(r,o)}r._extremes.lon=l(n.lonaxis._ax,g,m);r._extremes.lat=l(n.lataxis._ax,y,m)}t.exports={calcGeoJSON:d,plot:p}},{"../../constants/numerical":753,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/geojson_utils":772,"../../lib/topojson_utils":806,"../../plots/cartesian/autorange":827,"../scatter/calc":1188,"../scatter/subtypes":1212,"./style":1238,d3:169}],1237:[function(e,t,r){"use strict";var n=e("../scatter/subtypes");var a=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var i=t.cd;var o=t.xaxis;var s=t.yaxis;var l=[];var u=i[0].trace;var c,f,h,p,d;var v=!n.hasMarkers(u)&&!n.hasText(u);if(v)return[];if(r===false){for(d=0;d<i.length;d++){i[d].selected=0}}else{for(d=0;d<i.length;d++){c=i[d];f=c.lonlat;if(f[0]===a)continue;h=o.c2p(f);p=s.c2p(f);if(r.contains([h,p],null,d,t)){l.push({pointNumber:d,lon:f[0],lat:f[1]});c.selected=1}else{c.selected=0}}}return l}},{"../../constants/numerical":753,"../scatter/subtypes":1212}],1238:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../../components/color");var o=e("../scatter/style");var s=o.stylePoints;var l=o.styleText;t.exports=function e(t,r){if(r)u(t,r)};function u(e,t){var r=t[0].trace;var o=t[0].node3;o.style("opacity",t[0].trace.opacity);s(o,r,e);l(o,r,e);o.selectAll("path.js-line").style("fill","none").each(function(e){var t=n.select(this);var r=e.trace;var o=r.line||{};t.call(i.stroke,o.color).call(a.dashLine,o.dash||"",o.width||0);if(r.fill!=="none"){t.call(i.fill,r.fillcolor)}})}},{"../../components/color":643,"../../components/drawing":665,"../scatter/style":1211,d3:169}],1239:[function(e,t,r){"use strict";var n=e("../../plots/attributes");var a=e("../scatter/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/edit_types").overrideAll;var l=e("./constants").DASHES;var u=a.line;var c=a.marker;var f=c.line;var h=t.exports=s({x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,text:a.text,hovertext:a.hovertext,textposition:a.textposition,textfont:a.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:u.color,width:u.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},marker:o({},i("marker"),{symbol:c.symbol,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:o({},i("marker.line"),{width:f.width})}),connectgaps:a.connectgaps,fill:o({},a.fill,{dflt:"none"}),fillcolor:a.fillcolor,selected:{marker:a.selected.marker,textfont:a.selected.textfont},unselected:{marker:a.unselected.marker,textfont:a.unselected.textfont},opacity:n.opacity},"calc","nested");h.x.editType=h.y.editType=h.x0.editType=h.y0.editType="calc+clearAxisTypes";h.hovertemplate=a.hovertemplate;h.texttemplate=a.texttemplate},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../scatter/attributes":1187,"./constants":1241}],1240:[function(e,t,r){"use strict";var n=e("@plotly/point-cluster");var a=e("../../lib");var i=e("../../plots/cartesian/axis_ids");var o=e("../../plots/cartesian/autorange").findExtremes;var s=e("../../plots/cartesian/align_period");var l=e("../scatter/calc");var u=l.calcMarkerSize;var c=l.calcAxisExpansion;var f=l.setFirstScatter;var h=e("../scatter/colorscale_calc");var p=e("./convert");var d=e("./scene_update");var v=e("../../constants/numerical").BADNUM;var m=e("./constants").TOO_MANY_POINTS;t.exports=function e(t,r){var a=t._fullLayout;var o=i.getFromId(t,r.xaxis);var l=i.getFromId(t,r.yaxis);var p=a._plots[r.xaxis+r.yaxis];var x=r._length;var _=x>=m;var b=x*2;var w={};var T,k,A;var M=o.makeCalcdata(r,"x");var E=l.makeCalcdata(r,"y");var S=s(r,o,"x",M);var C=s(r,l,"y",E);r._x=S;r._y=C;if(r.xperiodalignment)r._origX=M;if(r.yperiodalignment)r._origY=E;var L=new Array(b);for(T=0;T<x;T++){k=S[T];A=C[T];L[T*2]=k===v?NaN:k;L[T*2+1]=A===v?NaN:A}if(o.type==="log"){for(T=0;T<b;T+=2){L[T]=o.c2l(L[T])}}if(l.type==="log"){for(T=1;T<b;T+=2){L[T]=l.c2l(L[T])}}if(_&&(o.type!=="log"&&l.type!=="log")){w.tree=n(L)}else{var I=w.ids=new Array(x);for(T=0;T<x;T++){I[T]=T}}h(t,r);var O=y(t,p,r,L,S,C);var P=d(t,p);f(a,r);var D;if(!_){D=u(r,x)}else if(O.marker){D=2*(O.marker.sizeAvg||Math.max(O.marker.size,3))}c(t,r,o,l,S,C,D);if(O.errorX)g(r,o,O.errorX);if(O.errorY)g(r,l,O.errorY);if(O.fill&&!P.fill2d)P.fill2d=true;if(O.marker&&!P.scatter2d)P.scatter2d=true;if(O.line&&!P.line2d)P.line2d=true;if((O.errorX||O.errorY)&&!P.error2d)P.error2d=true;if(O.text&&!P.glText)P.glText=true;if(O.marker)O.marker.snap=x;P.lineOptions.push(O.line);P.errorXOptions.push(O.errorX);P.errorYOptions.push(O.errorY);P.fillOptions.push(O.fill);P.markerOptions.push(O.marker);P.markerSelectedOptions.push(O.markerSel);P.markerUnselectedOptions.push(O.markerUnsel);P.textOptions.push(O.text);P.textSelectedOptions.push(O.textSel);P.textUnselectedOptions.push(O.textUnsel);P.selectBatch.push([]);P.unselectBatch.push([]);w._scene=P;w.index=P.count;w.x=S;w.y=C;w.positions=L;P.count++;return[{x:false,y:false,t:w,trace:r}]};function g(e,t,r){var n=e._extremes[t._id];var a=o(t,r._bnds,{padded:true});n.min=n.min.concat(a.min);n.max=n.max.concat(a.max)}function y(e,t,r,n,i,o){var s=p.style(e,r);if(s.marker){s.marker.positions=n}if(s.line&&n.length>1){a.extendFlat(s.line,p.linePositions(e,r,n))}if(s.errorX||s.errorY){var l=p.errorBarPositions(e,r,n,i,o);if(s.errorX){a.extendFlat(s.errorX,l.x)}if(s.errorY){a.extendFlat(s.errorY,l.y)}}if(s.text){a.extendFlat(s.text,{positions:n},p.textPosition(e,r,s.text,s.marker));a.extendFlat(s.textSel,{positions:n},p.textPosition(e,r,s.text,s.markerSel));a.extendFlat(s.textUnsel,{positions:n},p.textPosition(e,r,s.text,s.markerUnsel))}return s}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/autorange":827,"../../plots/cartesian/axis_ids":831,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"./constants":1241,"./convert":1242,"./scene_update":1250,"@plotly/point-cluster":57}],1241:[function(e,t,r){"use strict";var n=20;t.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:n,SYMBOL_STROKE:n/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1242:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("svg-path-sdf");var i=e("color-normalize");var o=e("../../registry");var s=e("../../lib");var l=e("../../components/drawing");var u=e("../../plots/cartesian/axis_ids");var c=e("../../lib/gl_format_color").formatColor;var f=e("../scatter/subtypes");var h=e("../scatter/make_bubble_size_func");var p=e("./helpers");var d=e("./constants");var v=e("../../constants/interactions").DESELECTDIM;var m={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1};var g=e("../../components/fx/helpers").appendArrayPointValue;function y(e,t){var r;var n={marker:undefined,markerSel:undefined,markerUnsel:undefined,line:undefined,fill:undefined,errorX:undefined,errorY:undefined,text:undefined,textSel:undefined,textUnsel:undefined};if(t.visible!==true)return n;if(f.hasText(t)){n.text=x(e,t);n.textSel=w(e,t,t.selected);n.textUnsel=w(e,t,t.unselected)}if(f.hasMarkers(t)){n.marker=_(t);n.markerSel=b(t,t.selected);n.markerUnsel=b(t,t.unselected);if(!t.unselected&&s.isArrayOrTypedArray(t.marker.opacity)){var a=t.marker.opacity;n.markerUnsel.opacity=new Array(a.length);for(r=0;r<a.length;r++){n.markerUnsel.opacity[r]=v*a[r]}}}if(f.hasLines(t)){n.line={overlay:true,thickness:t.line.width,color:t.line.color,opacity:t.opacity};var i=(d.DASHES[t.line.dash]||[1]).slice();for(r=0;r<i.length;++r){i[r]*=t.line.width}n.line.dashes=i}if(t.error_x&&t.error_x.visible){n.errorX=T(t,t.error_x)}if(t.error_y&&t.error_y.visible){n.errorY=T(t,t.error_y)}if(!!t.fill&&t.fill!=="none"){n.fill={closed:true,fill:t.fillcolor,thickness:0}}return n}function x(e,t){var r=e._fullLayout;var a=t._length;var i=t.textfont;var o=t.textposition;var l=Array.isArray(o)?o:[o];var u=i.color;var c=i.size;var f=i.family;var h={};var p;var d=t.texttemplate;if(d){h.text=[];var v=r._d3locale;var m=Array.isArray(d);var y=m?Math.min(d.length,a):a;var x=m?function(e){return d[e]}:function(){return d};for(p=0;p<y;p++){var _={i:p};var b=t._module.formatLabels(_,t,r);var w={};g(w,t,p);var T=t._meta||{};h.text.push(s.texttemplateString(x(p),b,v,w,_,T))}}else{if(Array.isArray(t.text)&&t.text.length<a){h.text=t.text.slice()}else{h.text=t.text}}if(Array.isArray(h.text)){for(p=h.text.length;p<a;p++){h.text[p]=""}}h.opacity=t.opacity;h.font={};h.align=[];h.baseline=[];for(p=0;p<l.length;p++){var k=l[p].split(/\s+/);switch(k[1]){case"left":h.align.push("right");break;case"right":h.align.push("left");break;default:h.align.push(k[1])}switch(k[0]){case"top":h.baseline.push("bottom");break;case"bottom":h.baseline.push("top");break;default:h.baseline.push(k[0])}}if(Array.isArray(u)){h.color=new Array(a);for(p=0;p<a;p++){h.color[p]=u[p]}}else{h.color=u}if(s.isArrayOrTypedArray(c)||Array.isArray(f)){h.font=new Array(a);for(p=0;p<a;p++){var A=h.font[p]={};A.size=s.isTypedArray(c)?c[p]:Array.isArray(c)?n(c[p])?c[p]:0:c;A.family=Array.isArray(f)?f[p]:f}}else{h.font={size:c,family:f}}return h}function _(e){var t=e._length;var r=e.marker;var n={};var a;var o=s.isArrayOrTypedArray(r.symbol);var l=s.isArrayOrTypedArray(r.color);var u=s.isArrayOrTypedArray(r.line.color);var f=s.isArrayOrTypedArray(r.opacity);var d=s.isArrayOrTypedArray(r.size);var v=s.isArrayOrTypedArray(r.line.width);var m;if(!o)m=p.isOpenSymbol(r.symbol);if(o||l||u||f){n.colors=new Array(t);n.borderColors=new Array(t);var g=c(r,r.opacity,t);var y=c(r.line,r.opacity,t);if(!Array.isArray(y[0])){var x=y;y=Array(t);for(a=0;a<t;a++){y[a]=x}}if(!Array.isArray(g[0])){var _=g;g=Array(t);for(a=0;a<t;a++){g[a]=_}}n.colors=g;n.borderColors=y;for(a=0;a<t;a++){if(o){var b=r.symbol[a];m=p.isOpenSymbol(b)}if(m){y[a]=g[a].slice();g[a]=g[a].slice();g[a][3]=0}}n.opacity=e.opacity}else{if(m){n.color=i(r.color,"uint8");n.color[3]=0;n.borderColor=i(r.color,"uint8")}else{n.color=i(r.color,"uint8");n.borderColor=i(r.line.color,"uint8")}n.opacity=e.opacity*r.opacity}if(o){n.markers=new Array(t);for(a=0;a<t;a++){n.markers[a]=C(r.symbol[a])}}else{n.marker=C(r.symbol)}var w=h(e);var T;if(d||v){var k=n.sizes=new Array(t);var A=n.borderSizes=new Array(t);var M=0;var E;if(d){for(a=0;a<t;a++){k[a]=w(r.size[a]);M+=k[a]}E=M/t}else{T=w(r.size);for(a=0;a<t;a++){k[a]=T}}if(v){for(a=0;a<t;a++){A[a]=r.line.width[a]/2}}else{T=r.line.width/2;for(a=0;a<t;a++){A[a]=T}}n.sizeAvg=E}else{n.size=w(r&&r.size||10);n.borderSizes=w(r.line.width)}return n}function b(e,t){var r=e.marker;var n={};if(!t)return n;if(t.marker&&t.marker.symbol){n=_(s.extendFlat({},r,t.marker))}else if(t.marker){if(t.marker.size)n.size=t.marker.size/2;if(t.marker.color)n.colors=t.marker.color;if(t.marker.opacity!==undefined)n.opacity=t.marker.opacity}return n}function w(e,t,r){var n={};if(!r)return n;if(r.textfont){var a={opacity:1,text:t.text,texttemplate:t.texttemplate,textposition:t.textposition,textfont:s.extendFlat({},t.textfont)};if(r.textfont){s.extendFlat(a.textfont,r.textfont)}n=x(e,a)}return n}function T(e,t){var r={capSize:t.width*2,lineWidth:t.thickness,color:t.color};if(t.copy_ystyle){r=e.error_y}return r}var k=d.SYMBOL_SDF_SIZE;var A=d.SYMBOL_SIZE;var M=d.SYMBOL_STROKE;var E={};var S=l.symbolFuncs[0](A*.05);function C(e){if(e==="circle")return null;var t,r;var n=l.symbolNumber(e);var i=l.symbolFuncs[n%100];var o=!!l.symbolNoDot[n%100];var s=!!l.symbolNoFill[n%100];var u=p.isDotSymbol(e);if(E[e])return E[e];if(u&&!o){t=i(A*1.1)+S}else{t=i(A)}r=a(t,{w:k,h:k,viewBox:[-A,-A,A,A],stroke:s?M:-M});E[e]=r;return r||null}function L(e,t,r){var n=r.length;var a=n/2;var i;var o;if(f.hasLines(t)&&a){if(t.line.shape==="hv"){i=[];for(o=0;o<a-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])){i.push(NaN,NaN,NaN,NaN)}else{i.push(r[o*2],r[o*2+1]);if(!isNaN(r[o*2+2])&&!isNaN(r[o*2+3])){i.push(r[o*2+2],r[o*2+1])}else{i.push(NaN,NaN)}}}i.push(r[n-2],r[n-1])}else if(t.line.shape==="hvh"){i=[];for(o=0;o<a-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])||isNaN(r[o*2+2])||isNaN(r[o*2+3])){if(!isNaN(r[o*2])&&!isNaN(r[o*2+1])){i.push(r[o*2],r[o*2+1])}else{i.push(NaN,NaN)}i.push(NaN,NaN)}else{var s=(r[o*2]+r[o*2+2])/2;i.push(r[o*2],r[o*2+1],s,r[o*2+1],s,r[o*2+3])}}i.push(r[n-2],r[n-1])}else if(t.line.shape==="vhv"){i=[];for(o=0;o<a-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])||isNaN(r[o*2+2])||isNaN(r[o*2+3])){if(!isNaN(r[o*2])&&!isNaN(r[o*2+1])){i.push(r[o*2],r[o*2+1])}else{i.push(NaN,NaN)}i.push(NaN,NaN)}else{var l=(r[o*2+1]+r[o*2+3])/2;i.push(r[o*2],r[o*2+1],r[o*2],l,r[o*2+2],l)}}i.push(r[n-2],r[n-1])}else if(t.line.shape==="vh"){i=[];for(o=0;o<a-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])){i.push(NaN,NaN,NaN,NaN)}else{i.push(r[o*2],r[o*2+1]);if(!isNaN(r[o*2+2])&&!isNaN(r[o*2+3])){i.push(r[o*2],r[o*2+3])}else{i.push(NaN,NaN)}}}i.push(r[n-2],r[n-1])}else{i=r}}var u=false;for(o=0;o<i.length;o++){if(isNaN(i[o])){u=true;break}}var c=u||i.length>d.TOO_MANY_POINTS?"rect":f.hasMarkers(t)?"rect":"round";if(u&&t.connectgaps){var h=i[0];var p=i[1];for(o=0;o<i.length;o+=2){if(isNaN(i[o])||isNaN(i[o+1])){i[o]=h;i[o+1]=p}else{h=i[o];p=i[o+1]}}}return{join:c,positions:i}}function I(e,t,r,a,i){var s=o.getComponentMethod("errorbars","makeComputeError");var l=u.getFromId(e,t.xaxis);var c=u.getFromId(e,t.yaxis);var f=r.length/2;var h={};function p(e,a){var i=a._id.charAt(0);var o=t["error_"+i];if(o&&o.visible&&(a.type==="linear"||a.type==="log")){var l=s(o);var u={x:0,y:1}[i];var c={x:[0,1,2,3],y:[2,3,0,1]}[i];var p=new Float64Array(4*f);var d=Infinity;var v=-Infinity;for(var m=0,g=0;m<f;m++,g+=4){var y=e[m];if(n(y)){var x=r[m*2+u];var _=l(y,m);var b=_[0];var w=_[1];if(n(b)&&n(w)){var T=y-b;var k=y+w;p[g+c[0]]=x-a.c2l(T);p[g+c[1]]=a.c2l(k)-x;p[g+c[2]]=0;p[g+c[3]]=0;d=Math.min(d,y-b);v=Math.max(v,y+w)}}}h[i]={positions:r,errors:p,_bnds:[d,v]}}}p(a,l);p(i,c);return h}function O(e,t,r,n){var a=t._length;var i={};var o;if(f.hasMarkers(t)){var s=r.font;var l=r.align;var u=r.baseline;i.offset=new Array(a);for(o=0;o<a;o++){var c=n.sizes?n.sizes[o]:n.size;var h=Array.isArray(s)?s[o].size:s.size;var p=Array.isArray(l)?l.length>1?l[o]:l[0]:l;var d=Array.isArray(u)?u.length>1?u[o]:u[0]:u;var v=m[p];var g=m[d];var y=c?c/.8+1:0;var x=-g*y-g*.5;i.offset[o]=[v*y/h,x/h]}}return i}t.exports={style:y,markerStyle:_,markerSelection:b,linePositions:L,errorBarPositions:I,textPosition:O}},{"../../components/drawing":665,"../../components/fx/helpers":679,"../../constants/interactions":752,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/cartesian/axis_ids":831,"../../registry":911,"../scatter/make_bubble_size_func":1204,"../scatter/subtypes":1212,"./constants":1241,"./helpers":1246,"color-normalize":125,"fast-isnumeric":241,"svg-path-sdf":574}],1243:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../registry");var i=e("./helpers");var o=e("./attributes");var s=e("../scatter/constants");var l=e("../scatter/subtypes");var u=e("../scatter/xy_defaults");var c=e("../scatter/period_defaults");var f=e("../scatter/marker_defaults");var h=e("../scatter/line_defaults");var p=e("../scatter/fillcolor_defaults");var d=e("../scatter/text_defaults");t.exports=function e(t,r,v,m){function g(e,a){return n.coerce(t,r,o,e,a)}var y=t.marker?i.isOpenSymbol(t.marker.symbol):false;var x=l.isBubble(t);var _=u(t,r,m,g);if(!_){r.visible=false;return}c(t,r,m,g);var b=_<s.PTS_LINESONLY?"lines+markers":"lines";g("text");g("hovertext");g("hovertemplate");g("mode",b);if(l.hasLines(r)){g("connectgaps");h(t,r,v,m,g);g("line.shape")}if(l.hasMarkers(r)){f(t,r,v,m,g);g("marker.line.width",y||x?1:0)}if(l.hasText(r)){g("texttemplate");d(t,r,m,g)}var w=(r.line||{}).color;var T=(r.marker||{}).color;g("fill");if(r.fill!=="none"){p(t,r,v,g)}var k=a.getComponentMethod("errorbars","supplyDefaults");k(t,r,w||T||v,{axis:"y"});k(t,r,w||T||v,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,g)}},{"../../lib":778,"../../registry":911,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/period_defaults":1207,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"../scatter/xy_defaults":1214,"./attributes":1239,"./helpers":1246}],1244:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../../constants/interactions").DESELECTDIM;function o(e){var t=e[0];var r=t.trace;var o=t.t;var s=o._scene;var l=o.index;var u=s.selectBatch[l];var c=s.unselectBatch[l];var f=s.textOptions[l];var h=s.textSelectedOptions[l]||{};var p=s.textUnselectedOptions[l]||{};var d=n.extendFlat({},f);var v,m;if(u.length||c.length){var g=h.color;var y=p.color;var x=f.color;var _=Array.isArray(x);d.color=new Array(r._length);for(v=0;v<u.length;v++){m=u[v];d.color[m]=g||(_?x[m]:x)}for(v=0;v<c.length;v++){m=c[v];var b=_?x[m]:x;d.color[m]=y?y:g?b:a.addOpacity(b,i)}}s.glText[l].update(d)}t.exports={styleTextSelection:o}},{"../../components/color":643,"../../constants/interactions":752,"../../lib":778}],1245:[function(e,t,r){"use strict";var n=e("../scatter/format_labels");t.exports=function e(t,r,a){var i=t.i;if(!("x"in t))t.x=r._x[i];if(!("y"in t))t.y=r._y[i];return n(t,r,a)}},{"../scatter/format_labels":1196}],1246:[function(e,t,r){"use strict";var n=e("./constants");r.isOpenSymbol=function(e){return typeof e==="string"?n.OPEN_RE.test(e):e%200>100};r.isDotSymbol=function(e){return typeof e==="string"?n.DOT_RE.test(e):e>200}},{"./constants":1241}],1247:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../scatter/get_trace_color");function o(e,t,r,n){var a=e.cd;var i=a[0].t;var o=a[0].trace;var l=e.xa;var u=e.ya;var c=i.x;var f=i.y;var h=l.c2p(t);var p=u.c2p(r);var d=e.distance;var v;if(i.tree){var m=l.p2c(h-d);var g=l.p2c(h+d);var y=u.p2c(p-d);var x=u.p2c(p+d);if(n==="x"){v=i.tree.range(Math.min(m,g),Math.min(u._rl[0],u._rl[1]),Math.max(m,g),Math.max(u._rl[0],u._rl[1]))}else{v=i.tree.range(Math.min(m,g),Math.min(y,x),Math.max(m,g),Math.max(y,x))}}else{v=i.ids}var _,b,w,T,k,A,M,E;var S=d;if(n==="x"){for(T=0;T<v.length;T++){b=c[v[T]];k=Math.abs(l.c2p(b)-h);if(k<S){S=k;A=u.c2p(f[v[T]])-p;E=Math.sqrt(k*k+A*A);_=v[T]}}}else{for(T=v.length-1;T>-1;T--){b=c[v[T]];w=f[v[T]];k=l.c2p(b)-h;A=u.c2p(w)-p;M=Math.sqrt(k*k+A*A);if(M<S){S=E=M;_=v[T]}}}e.index=_;e.distance=S;e.dxy=E;if(_===undefined)return[e];return[s(e,c,f,o)]}function s(e,t,r,o){var s=e.xa;var l=e.ya;var u=e.distance;var c=e.dxy;var f=e.index;var h={pointNumber:f,x:t[f],y:r[f]};h.tx=Array.isArray(o.text)?o.text[f]:o.text;h.htx=Array.isArray(o.hovertext)?o.hovertext[f]:o.hovertext;h.data=Array.isArray(o.customdata)?o.customdata[f]:o.customdata;h.tp=Array.isArray(o.textposition)?o.textposition[f]:o.textposition;var p=o.textfont;if(p){h.ts=a.isArrayOrTypedArray(p.size)?p.size[f]:p.size;h.tc=Array.isArray(p.color)?p.color[f]:p.color;h.tf=Array.isArray(p.family)?p.family[f]:p.family}var d=o.marker;if(d){h.ms=a.isArrayOrTypedArray(d.size)?d.size[f]:d.size;h.mo=a.isArrayOrTypedArray(d.opacity)?d.opacity[f]:d.opacity;h.mx=a.isArrayOrTypedArray(d.symbol)?d.symbol[f]:d.symbol;h.mc=a.isArrayOrTypedArray(d.color)?d.color[f]:d.color}var v=d&&d.line;if(v){h.mlc=Array.isArray(v.color)?v.color[f]:v.color;h.mlw=a.isArrayOrTypedArray(v.width)?v.width[f]:v.width}var m=d&&d.gradient;if(m&&m.type!=="none"){h.mgt=Array.isArray(m.type)?m.type[f]:m.type;h.mgc=Array.isArray(m.color)?m.color[f]:m.color}var g=s.c2p(h.x,true);var y=l.c2p(h.y,true);var x=h.mrc||1;var _=o.hoverlabel;if(_){h.hbg=Array.isArray(_.bgcolor)?_.bgcolor[f]:_.bgcolor;h.hbc=Array.isArray(_.bordercolor)?_.bordercolor[f]:_.bordercolor;h.hts=a.isArrayOrTypedArray(_.font.size)?_.font.size[f]:_.font.size;h.htc=Array.isArray(_.font.color)?_.font.color[f]:_.font.color;h.htf=Array.isArray(_.font.family)?_.font.family[f]:_.font.family;h.hnl=a.isArrayOrTypedArray(_.namelength)?_.namelength[f]:_.namelength}var b=o.hoverinfo;if(b){h.hi=Array.isArray(b)?b[f]:b}var w=o.hovertemplate;if(w){h.ht=Array.isArray(w)?w[f]:w}var T={};T[e.index]=h;var k=o._origX;var A=o._origY;var M=a.extendFlat({},e,{color:i(o,h),x0:g-x,x1:g+x,xLabelVal:k?k[f]:h.x,y0:y-x,y1:y+x,yLabelVal:A?A[f]:h.y,cd:T,distance:u,spikeDistance:c,hovertemplate:h.ht});if(h.htx)M.text=h.htx;else if(h.tx)M.text=h.tx;else if(o.text)M.text=o.text;a.fillText(h,o,M);n.getComponentMethod("errorbars","hoverInfo")(h,o,M);return M}t.exports={hoverPoints:o,calcHover:s}},{"../../lib":778,"../../registry":911,"../scatter/get_trace_color":1197}],1248:[function(e,t,r){"use strict";var n=e("./hover");t.exports={moduleType:"trace",name:"scattergl",basePlotModule:e("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../scatter/cross_trace_defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:n.hoverPoints,selectPoints:e("./select"),meta:{}}},{"../../plots/cartesian":841,"../scatter/cross_trace_defaults":1193,"../scatter/marker_colorbar":1205,"./attributes":1239,"./calc":1240,"./defaults":1243,"./format_labels":1245,"./hover":1247,"./plot":1249,"./select":1251}],1249:[function(e,t,r){"use strict";var n=e("regl-scatter2d");var a=e("regl-line2d");var i=e("regl-error2d");var o=e("gl-text");var s=e("../../lib");var l=e("../../components/dragelement/helpers").selectMode;var u=e("../../lib/prepare_regl");var c=e("../scatter/subtypes");var f=e("../scatter/link_traces");var h=e("./edit_style").styleTextSelection;function p(e,t,r){var n=e._size;var a=e.width;var i=e.height;return[n.l+t.domain[0]*n.w,n.b+r.domain[0]*n.h,a-n.r-(1-t.domain[1])*n.w,i-n.t-(1-r.domain[1])*n.h]}t.exports=function e(t,r,d){if(!d.length)return;var v=t._fullLayout;var m=r._scene;var g=r.xaxis;var y=r.yaxis;var x,_;if(!m)return;var b=u(t,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!b){m.init();return}var w=m.count;var T=v._glcanvas.data()[0].regl;f(t,r,d);if(m.dirty){if(m.error2d===true){m.error2d=i(T)}if(m.line2d===true){m.line2d=a(T)}if(m.scatter2d===true){m.scatter2d=n(T,{constPointSize:true})}if(m.fill2d===true){m.fill2d=a(T)}if(m.glText===true){m.glText=new Array(w);for(x=0;x<w;x++){m.glText[x]=new o(T)}}if(m.glText){if(w>m.glText.length){var k=w-m.glText.length;for(x=0;x<k;x++){m.glText.push(new o(T))}}else if(w<m.glText.length){var A=m.glText.length-w;var M=m.glText.splice(w,A);M.forEach(function(e){e.destroy()})}for(x=0;x<w;x++){m.glText[x].update(m.textOptions[x])}}if(m.line2d){m.line2d.update(m.lineOptions);m.lineOptions=m.lineOptions.map(function(e){if(e&&e.positions){var t=e.positions;var r=0;while(r<t.length&&(isNaN(t[r])||isNaN(t[r+1]))){r+=2}var n=t.length-2;while(n>r&&(isNaN(t[n])||isNaN(t[n+1]))){n-=2}e.positions=t.slice(r,n+2)}return e});m.line2d.update(m.lineOptions)}if(m.error2d){var E=(m.errorXOptions||[]).concat(m.errorYOptions||[]);m.error2d.update(E)}if(m.scatter2d){m.scatter2d.update(m.markerOptions)}m.fillOrder=s.repeat(null,w);if(m.fill2d){m.fillOptions=m.fillOptions.map(function(e,t){var r=d[t];if(!e||!r||!r[0]||!r[0].trace)return;var n=r[0];var a=n.trace;var i=n.t;var o=m.lineOptions[t];var s,l;var u=[];if(a._ownfill)u.push(t);if(a._nexttrace)u.push(t+1);if(u.length)m.fillOrder[t]=u;var c=[];var f=o&&o.positions||i.positions;var h,p;if(a.fill==="tozeroy"){h=0;while(h<f.length&&isNaN(f[h+1])){h+=2}p=f.length-2;while(p>h&&isNaN(f[p+1])){p-=2}if(f[h+1]!==0){c=[f[h],0]}c=c.concat(f.slice(h,p+2));if(f[p+1]!==0){c=c.concat([f[p],0])}}else if(a.fill==="tozerox"){h=0;while(h<f.length&&isNaN(f[h])){h+=2}p=f.length-2;while(p>h&&isNaN(f[p])){p-=2}if(f[h]!==0){c=[0,f[h+1]]}c=c.concat(f.slice(h,p+2));if(f[p]!==0){c=c.concat([0,f[p+1]])}}else if(a.fill==="toself"||a.fill==="tonext"){c=[];s=0;for(l=0;l<f.length;l+=2){if(isNaN(f[l])||isNaN(f[l+1])){c=c.concat(f.slice(s,l));c.push(f[s],f[s+1]);s=l+2}}c=c.concat(f.slice(s));if(s){c.push(f[s],f[s+1])}}else{var v=a._nexttrace;if(v){var g=m.lineOptions[t+1];if(g){var y=g.positions;if(a.fill==="tonexty"){c=f.slice();for(t=Math.floor(y.length/2);t--;){var x=y[t*2];var _=y[t*2+1];if(isNaN(x)||isNaN(_))continue;c.push(x,_)}e.fill=v.fillcolor}}}}if(a._prevtrace&&a._prevtrace.fill==="tonext"){var b=m.lineOptions[t-1].positions;var w=c.length/2;s=w;var T=[s];for(l=0;l<b.length;l+=2){if(isNaN(b[l])||isNaN(b[l+1])){T.push(l/2+w+1);s=l+2}}c=c.concat(b);e.hole=T}e.fillmode=a.fill;e.opacity=a.opacity;e.positions=c;return e});m.fill2d.update(m.fillOptions)}}var S=v.dragmode;var C=l(S);var L=v.clickmode.indexOf("select")>-1;for(x=0;x<w;x++){var I=d[x][0];var O=I.trace;var P=I.t;var D=P.index;var R=O._length;var z=P.x;var N=P.y;if(O.selectedpoints||C||L){if(!C)C=true;if(O.selectedpoints){var F=m.selectBatch[D]=s.selIndices2selPoints(O);var B={};for(_=0;_<F.length;_++){B[F[_]]=1}var j=[];for(_=0;_<R;_++){if(!B[_])j.push(_)}m.unselectBatch[D]=j}var U=P.xpx=new Array(R);var H=P.ypx=new Array(R);for(_=0;_<R;_++){U[_]=g.c2p(z[_]);H[_]=y.c2p(N[_])}}else{P.xpx=P.ypx=null}}if(C){if(!m.select2d){m.select2d=n(v._glcanvas.data()[1].regl)}if(m.scatter2d){var V=new Array(w);for(x=0;x<w;x++){V[x]=m.selectBatch[x].length||m.unselectBatch[x].length?m.markerUnselectedOptions[x]:{}}m.scatter2d.update(V)}if(m.select2d){m.select2d.update(m.markerOptions);m.select2d.update(m.markerSelectedOptions)}if(m.glText){d.forEach(function(e){var t=((e||[])[0]||{}).trace||{};if(c.hasText(t)){h(e)}})}}else{if(m.scatter2d){m.scatter2d.update(m.markerOptions)}}var G={viewport:p(v,g,y),range:[(g._rl||g.range)[0],(y._rl||y.range)[0],(g._rl||g.range)[1],(y._rl||y.range)[1]]};var q=s.repeat(G,m.count);if(m.fill2d){m.fill2d.update(q)}if(m.line2d){m.line2d.update(q)}if(m.error2d){m.error2d.update(q.concat(q))}if(m.scatter2d){m.scatter2d.update(q)}if(m.select2d){m.select2d.update(q)}if(m.glText){m.glText.forEach(function(e){e.update(G)})}}},{"../../components/dragelement/helpers":661,"../../lib":778,"../../lib/prepare_regl":791,"../scatter/link_traces":1203,"../scatter/subtypes":1212,"./edit_style":1244,"gl-text":352,"regl-error2d":534,"regl-line2d":535,"regl-scatter2d":537}],1250:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){var a=r._scene;var i={count:0,dirty:true,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]};var o={fill2d:false,scatter2d:false,error2d:false,line2d:false,glText:false,select2d:false};if(!r._scene){a=r._scene={};a.init=function e(){n.extendFlat(a,o,i)};a.init();a.update=function e(t){var r=n.repeat(t,a.count);if(a.fill2d)a.fill2d.update(r);if(a.scatter2d)a.scatter2d.update(r);if(a.line2d)a.line2d.update(r);if(a.error2d)a.error2d.update(r.concat(r));if(a.select2d)a.select2d.update(r);if(a.glText){for(var i=0;i<a.count;i++){a.glText[i].update(t)}}};a.draw=function e(){var t=a.count;var r=a.fill2d;var i=a.error2d;var o=a.line2d;var s=a.scatter2d;var l=a.glText;var u=a.select2d;var c=a.selectBatch;var f=a.unselectBatch;for(var h=0;h<t;h++){if(r&&a.fillOrder[h]){r.draw(a.fillOrder[h])}if(o&&a.lineOptions[h]){o.draw(h)}if(i){if(a.errorXOptions[h])i.draw(h);if(a.errorYOptions[h])i.draw(h+t)}if(s&&a.markerOptions[h]){if(f[h].length){var p=n.repeat([],a.count);p[h]=f[h];s.draw(p)}else if(!c[h].length){s.draw(h)}}if(l[h]&&a.textOptions[h]){l[h].render()}}if(u){u.draw(c)}a.dirty=false};a.destroy=function e(){if(a.fill2d&&a.fill2d.destroy)a.fill2d.destroy();if(a.scatter2d&&a.scatter2d.destroy)a.scatter2d.destroy();if(a.error2d&&a.error2d.destroy)a.error2d.destroy();if(a.line2d&&a.line2d.destroy)a.line2d.destroy();if(a.select2d&&a.select2d.destroy)a.select2d.destroy();if(a.glText){a.glText.forEach(function(e){if(e.destroy)e.destroy()})}a.lineOptions=null;a.fillOptions=null;a.markerOptions=null;a.markerSelectedOptions=null;a.markerUnselectedOptions=null;a.errorXOptions=null;a.errorYOptions=null;a.textOptions=null;a.textSelectedOptions=null;a.textUnselectedOptions=null;a.selectBatch=null;a.unselectBatch=null;r._scene=null}}if(!a.dirty){n.extendFlat(a,i)}return a}},{"../../lib":778}],1251:[function(e,t,r){"use strict";var n=e("../scatter/subtypes");var a=e("./edit_style").styleTextSelection;t.exports=function e(t,r){var i=t.cd;var o=[];var s=i[0].trace;var l=i[0].t;var u=s._length;var c=l.x;var f=l.y;var h=l._scene;var p=l.index;if(!h)return o;var d=n.hasText(s);var v=n.hasMarkers(s);var m=!v&&!d;if(s.visible!==true||m)return o;var g=[];var y=[];if(r!==false&&!r.degenerate){for(var x=0;x<u;x++){if(r.contains([l.xpx[x],l.ypx[x]],false,x,t)){g.push(x);o.push({pointNumber:x,x:c[x],y:f[x]})}else{y.push(x)}}}if(v){var _=h.scatter2d;if(!g.length&&!y.length){var b=new Array(h.count);b[p]=h.markerOptions[p];_.update.apply(_,b)}else if(!h.selectBatch[p].length&&!h.unselectBatch[p].length){var w=new Array(h.count);w[p]=h.markerUnselectedOptions[p];_.update.apply(_,w)}}h.selectBatch[p]=g;h.unselectBatch[p]=y;if(d){a(i)}return o}},{"../scatter/subtypes":1212,"./edit_style":1244}],1252:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../scattergeo/attributes");var o=e("../scatter/attributes");var s=e("../../plots/mapbox/layout_attributes");var l=e("../../plots/attributes");var u=e("../../components/colorscale/attributes");var c=e("../../lib/extend").extendFlat;var f=e("../../plot_api/edit_types").overrideAll;var h=i.line;var p=i.marker;t.exports=f({lon:i.lon,lat:i.lat,mode:c({},o.mode,{dflt:"markers"}),text:c({},o.text,{}),texttemplate:a({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:c({},o.hovertext,{}),line:{color:h.color,width:h.width},connectgaps:o.connectgaps,marker:c({symbol:{valType:"string",dflt:"circle",arrayOk:true},angle:{valType:"number",dflt:"auto",arrayOk:true},allowoverlap:{valType:"boolean",dflt:false},opacity:p.opacity,size:p.size,sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode},u("marker")),fill:i.fill,fillcolor:o.fillcolor,textfont:s.layers.symbol.textfont,textposition:s.layers.symbol.textposition,below:{valType:"string"},selected:{marker:o.selected.marker},unselected:{marker:o.unselected.marker},hoverinfo:c({},l.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:n()},"calc","nested")},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/mapbox/layout_attributes":887,"../../plots/template_attributes":906,"../scatter/attributes":1187,"../scattergeo/attributes":1229}],1253:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../lib");var i=e("../../constants/numerical").BADNUM;var o=e("../../lib/geojson_utils");var s=e("../../components/colorscale");var l=e("../../components/drawing");var u=e("../scatter/make_bubble_size_func");var c=e("../scatter/subtypes");var f=e("../../plots/mapbox/convert_text_opts");var h=e("../../components/fx/helpers").appendArrayPointValue;var p=e("../../lib/svg_text_utils").NEWLINES;var d=e("../../lib/svg_text_utils").BR_TAG_ALL;t.exports=function e(t,r){var n=r[0].trace;var i=n.visible===true&&n._length!==0;var s=n.fill!=="none";var l=c.hasLines(n);var u=c.hasMarkers(n);var h=c.hasText(n);var p=u&&n.marker.symbol==="circle";var d=u&&n.marker.symbol!=="circle";var y=v();var x=v();var _=v();var b=v();var w={fill:y,line:x,circle:_,symbol:b};if(!i)return w;var T;if(s||l){T=o.calcTraceToLineCoords(r)}if(s){y.geojson=o.makePolygon(T);y.layout.visibility="visible";a.extendFlat(y.paint,{"fill-color":n.fillcolor})}if(l){x.geojson=o.makeLine(T);x.layout.visibility="visible";a.extendFlat(x.paint,{"line-width":n.line.width,"line-color":n.line.color,"line-opacity":n.opacity})}if(p){var k=m(r);_.geojson=k.geojson;_.layout.visibility="visible";a.extendFlat(_.paint,{"circle-color":k.mcc,"circle-radius":k.mrc,"circle-opacity":k.mo})}if(d||h){b.geojson=g(r,t);a.extendFlat(b.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"});if(d){a.extendFlat(b.layout,{"icon-size":n.marker.size/10});if("angle"in n.marker&&n.marker.angle!=="auto"){a.extendFlat(b.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"})}b.layout["icon-allow-overlap"]=n.marker.allowoverlap;a.extendFlat(b.paint,{"icon-opacity":n.opacity*n.marker.opacity,"icon-color":n.marker.color})}if(h){var A=(n.marker||{}).size;var M=f(n.textposition,A);a.extendFlat(b.layout,{"text-size":n.textfont.size,"text-anchor":M.anchor,"text-offset":M.offset});a.extendFlat(b.paint,{"text-color":n.textfont.color,"text-opacity":n.opacity})}}return w};function v(){return{geojson:o.makeBlank(),layout:{visibility:"none"},paint:{}}}function m(e){var t=e[0].trace;var r=t.marker;var i=t.selectedpoints;var o=a.isArrayOrTypedArray(r.color);var c=a.isArrayOrTypedArray(r.size);var f=a.isArrayOrTypedArray(r.opacity);var h;function p(e){return t.opacity*e}function d(e){return e/2}var v;if(o){if(s.hasColorscale(t,"marker")){v=s.makeColorScaleFuncFromTrace(r)}else{v=a.identity}}var m;if(c){m=u(t)}var g;if(f){g=function(e){var t=n(e)?+a.constrain(e,0,1):0;return p(t)}}var y=[];for(h=0;h<e.length;h++){var x=e[h];var b=x.lonlat;if(_(b))continue;var w={};if(v)w.mcc=x.mcc=v(x.mc);if(m)w.mrc=x.mrc=m(x.ms);if(g)w.mo=g(x.mo);if(i)w.selected=x.selected||0;y.push({type:"Feature",geometry:{type:"Point",coordinates:b},properties:w})}var T;if(i){T=l.makeSelectedPointStyleFns(t);for(h=0;h<y.length;h++){var k=y[h].properties;if(T.selectedOpacityFn){k.mo=p(T.selectedOpacityFn(k))}if(T.selectedColorFn){k.mcc=T.selectedColorFn(k)}if(T.selectedSizeFn){k.mrc=T.selectedSizeFn(k)}}}return{geojson:{type:"FeatureCollection",features:y},mcc:o||T&&T.selectedColorFn?{type:"identity",property:"mcc"}:r.color,mrc:c||T&&T.selectedSizeFn?{type:"identity",property:"mrc"}:d(r.size),mo:f||T&&T.selectedOpacityFn?{type:"identity",property:"mo"}:p(r.opacity)}}function g(e,t){var r=t._fullLayout;var n=e[0].trace;var i=n.marker||{};var o=i.symbol;var s=i.angle;var l=o!=="circle"?y(o):x;var u=s!=="auto"?y(s,true):x;var f=c.hasText(n)?y(n.text):x;var v=[];for(var m=0;m<e.length;m++){var g=e[m];if(_(g.lonlat))continue;var b=n.texttemplate;var w;if(b){var T=Array.isArray(b)?b[m]||"":b;var k=n._module.formatLabels(g,n,r);var A={};h(A,n,g.i);var M=n._meta||{};w=a.texttemplateString(T,k,r._d3locale,A,g,M)}else{w=f(m)}if(w){w=w.replace(p,"").replace(d,"\n")}v.push({type:"Feature",geometry:{type:"Point",coordinates:g.lonlat},properties:{symbol:l(m),angle:u(m),text:w}})}return{type:"FeatureCollection",features:v}}function y(e,t){if(a.isArrayOrTypedArray(e)){if(t){return function(t){return n(e[t])?+e[t]:0}}return function(t){return e[t]}}else if(e){return function(){return e}}else{return x}}function x(){return""}function _(e){return e[0]===i}},{"../../components/colorscale":655,"../../components/drawing":665,"../../components/fx/helpers":679,"../../constants/numerical":753,"../../lib":778,"../../lib/geojson_utils":772,"../../lib/svg_text_utils":803,"../../plots/mapbox/convert_text_opts":884,"../scatter/make_bubble_size_func":1204,"../scatter/subtypes":1212,"fast-isnumeric":241}],1254:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/subtypes");var i=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/text_defaults");var l=e("../scatter/fillcolor_defaults");var u=e("./attributes");t.exports=function e(t,r,f,h){function p(e,a){return n.coerce(t,r,u,e,a)}var d=c(t,r,p);if(!d){r.visible=false;return}p("text");p("texttemplate");p("hovertext");p("hovertemplate");p("mode");p("below");if(a.hasLines(r)){o(t,r,f,h,p,{noDash:true});p("connectgaps")}if(a.hasMarkers(r)){i(t,r,f,h,p,{noLine:true});p("marker.allowoverlap");p("marker.angle");var v=r.marker;if(v.symbol!=="circle"){if(n.isArrayOrTypedArray(v.size))v.size=v.size[0];if(n.isArrayOrTypedArray(v.color))v.color=v.color[0]}}if(a.hasText(r)){s(t,r,h,p,{noSelect:true})}p("fill");if(r.fill!=="none"){l(t,r,f,p)}n.coerceSelectionMarkerOpacity(r,p)};function c(e,t,r){var n=r("lon")||[];var a=r("lat")||[];var i=Math.min(n.length,a.length);t._length=i;return i}},{"../../lib":778,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1252}],1255:[function(e,t,r){"use strict";t.exports=function e(t,r){t.lon=r.lon;t.lat=r.lat;return t}},{}],1256:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");t.exports=function e(t,r,a){var i={};var o=a[r.subplot]._subplot;var s=o.mockAxis;var l=t.lonlat;i.lonLabel=n.tickText(s,s.c2l(l[0]),true).text;i.latLabel=n.tickText(s,s.c2l(l[1]),true).text;return i}},{"../../plots/cartesian/axes":828}],1257:[function(e,t,r){"use strict";var n=e("../../components/fx");var a=e("../../lib");var i=e("../scatter/get_trace_color");var o=a.fillText;var s=e("../../constants/numerical").BADNUM;t.exports=function e(t,r,o){var u=t.cd;var c=u[0].trace;var f=t.xa;var h=t.ya;var p=t.subplot;var d=r>=0?Math.floor((r+180)/360):Math.ceil((r-180)/360);var v=d*360;var m=r-v;function g(e){var t=e.lonlat;if(t[0]===s)return Infinity;var r=a.modHalf(t[0],360);var n=t[1];var i=p.project([r,n]);var l=i.x-f.c2p([m,n]);var u=i.y-h.c2p([r,o]);var c=Math.max(3,e.mrc||0);return Math.max(Math.sqrt(l*l+u*u)-c,1-3/c)}n.getClosest(u,g,t);if(t.index===false)return;var y=u[t.index];var x=y.lonlat;var _=[a.modHalf(x[0],360)+v,x[1]];var b=f.c2p(_);var w=h.c2p(_);var T=y.mrc||1;t.x0=b-T;t.x1=b+T;t.y0=w-T;t.y1=w+T;var k={};k[c.subplot]={_subplot:p};var A=c._module.formatLabels(y,c,k);t.lonLabel=A.lonLabel;t.latLabel=A.latLabel;t.color=i(c,y);t.extraText=l(c,y,u[0].t.labels);t.hovertemplate=c.hovertemplate;return[t]};function l(e,t,r){if(e.hovertemplate)return;var n=t.hi||e.hoverinfo;var a=n.split("+");var i=a.indexOf("all")!==-1;var s=a.indexOf("lon")!==-1;var l=a.indexOf("lat")!==-1;var u=t.lonlat;var c=[];function f(e){return e+"°"}if(i||s&&l){c.push("("+f(u[0])+", "+f(u[1])+")")}else if(s){c.push(r.lon+f(u[0]))}else if(l){c.push(r.lat+f(u[1]))}if(i||a.indexOf("text")!==-1){o(t,e,c)}return c.join("<br>")}},{"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../scatter/get_trace_color":1197}],1258:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("../scattergeo/calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),styleOnSelect:function(e,t){if(t){var r=t[0].trace;r._glTrace.update(t)}},moduleType:"trace",name:"scattermapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":885,"../scatter/marker_colorbar":1205,"../scattergeo/calc":1230,"./attributes":1252,"./defaults":1254,"./event_data":1255,"./format_labels":1256,"./hover":1257,"./plot":1259,"./select":1260}],1259:[function(e,t,r){"use strict";var n=e("./convert");var a=e("../../plots/mapbox/constants").traceLayerPrefix;var i=["fill","line","circle","symbol"];function o(e,t){this.type="scattermapbox";this.subplot=e;this.uid=t;this.sourceIds={fill:"source-"+t+"-fill",line:"source-"+t+"-line",circle:"source-"+t+"-circle",symbol:"source-"+t+"-symbol"};this.layerIds={fill:a+t+"-fill",line:a+t+"-line",circle:a+t+"-circle",symbol:a+t+"-symbol"};this.below=null}var s=o.prototype;s.addSource=function(e,t){this.subplot.map.addSource(this.sourceIds[e],{type:"geojson",data:t.geojson})};s.setSourceData=function(e,t){this.subplot.map.getSource(this.sourceIds[e]).setData(t.geojson)};s.addLayer=function(e,t,r){this.subplot.addLayer({type:e,id:this.layerIds[e],source:this.sourceIds[e],layout:t.layout,paint:t.paint},r)};s.update=function e(t){var r=this.subplot;var a=r.map;var o=n(r.gd,t);var s=r.belowLookup["trace-"+this.uid];var l,u,c;if(s!==this.below){for(l=i.length-1;l>=0;l--){u=i[l];a.removeLayer(this.layerIds[u])}for(l=0;l<i.length;l++){u=i[l];c=o[u];this.addLayer(u,c,s)}this.below=s}for(l=0;l<i.length;l++){u=i[l];c=o[u];r.setOptions(this.layerIds[u],"setLayoutProperty",c.layout);if(c.layout.visibility==="visible"){this.setSourceData(u,c);r.setOptions(this.layerIds[u],"setPaintProperty",c.paint)}}t[0].trace._glTrace=this};s.dispose=function e(){var t=this.subplot.map;for(var r=i.length-1;r>=0;r--){var n=i[r];t.removeLayer(this.layerIds[n]);t.removeSource(this.sourceIds[n])}};t.exports=function e(t,r){var a=r[0].trace;var s=new o(t,a.uid);var l=n(t.gd,r);var u=s.below=t.belowLookup["trace-"+a.uid];for(var c=0;c<i.length;c++){var f=i[c];var h=l[f];s.addSource(f,h);s.addLayer(f,h,u)}r[0].trace._glTrace=s;return s}},{"../../plots/mapbox/constants":883,"./convert":1253}],1260:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/subtypes");var i=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var o=t.cd;var s=t.xaxis;var l=t.yaxis;var u=[];var c=o[0].trace;var f;if(!a.hasMarkers(c))return[];if(r===false){for(f=0;f<o.length;f++){o[f].selected=0}}else{for(f=0;f<o.length;f++){var h=o[f];var p=h.lonlat;if(p[0]!==i){var d=[n.modHalf(p[0],360),p[1]];var v=[s.c2p(d),l.c2p(d)];if(r.contains(v,null,f,t)){u.push({pointNumber:f,lon:p[0],lat:p[1]});h.selected=1}else{h.selected=0}}}}return u}},{"../../constants/numerical":753,"../../lib":778,"../scatter/subtypes":1212}],1261:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../../lib/extend").extendFlat;var o=e("../scatter/attributes");var s=e("../../plots/attributes");var l=o.line;t.exports={mode:o.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:o.text,texttemplate:a({editType:"plot"},{keys:["r","theta","text"]}),hovertext:o.hovertext,line:{color:l.color,width:l.width,dash:l.dash,shape:i({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:o.connectgaps,marker:o.marker,cliponaxis:i({},o.cliponaxis,{dflt:false}),textposition:o.textposition,textfont:o.textfont,fill:i({},o.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:o.fillcolor,hoverinfo:i({},s.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:o.hoveron,hovertemplate:n(),selected:o.selected,unselected:o.unselected}},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1262:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../../constants/numerical").BADNUM;var i=e("../../plots/cartesian/axes");var o=e("../scatter/colorscale_calc");var s=e("../scatter/arrays_to_calcdata");var l=e("../scatter/calc_selection");var u=e("../scatter/calc").calcMarkerSize;t.exports=function e(t,r){var c=t._fullLayout;var f=r.subplot;var h=c[f].radialaxis;var p=c[f].angularaxis;var d=h.makeCalcdata(r,"r");var v=p.makeCalcdata(r,"theta");var m=r._length;var g=new Array(m);for(var y=0;y<m;y++){var x=d[y];var _=v[y];var b=g[y]={};if(n(x)&&n(_)){b.r=x;b.theta=_}else{b.r=a}}var w=u(r,m);r._extremes.x=i.findExtremes(h,d,{ppad:w});o(t,r);s(g,r);l(g,r);return g}},{"../../constants/numerical":753,"../../plots/cartesian/axes":828,"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1263:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/subtypes");var i=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/line_shape_defaults");var l=e("../scatter/text_defaults");var u=e("../scatter/fillcolor_defaults");var c=e("../scatter/constants").PTS_LINESONLY;var f=e("./attributes");function h(e,t,r,h){function d(r,a){return n.coerce(e,t,f,r,a)}var v=p(e,t,h,d);if(!v){t.visible=false;return}d("thetaunit");d("mode",v<c?"lines+markers":"lines");d("text");d("hovertext");if(t.hoveron!=="fills")d("hovertemplate");if(a.hasLines(t)){o(e,t,r,h,d);s(e,t,d);d("connectgaps")}if(a.hasMarkers(t)){i(e,t,r,h,d,{gradient:true})}if(a.hasText(t)){d("texttemplate");l(e,t,h,d)}var m=[];if(a.hasMarkers(t)||a.hasText(t)){d("cliponaxis");d("marker.maxdisplayed");m.push("points")}d("fill");if(t.fill!=="none"){u(e,t,r,d);if(!a.hasLines(t))s(e,t,d)}if(t.fill==="tonext"||t.fill==="toself"){m.push("fills")}d("hoveron",m.join("+")||"points");n.coerceSelectionMarkerOpacity(t,d)}function p(e,t,r,n){var a=n("r");var i=n("theta");var o;if(a){if(i){o=Math.min(a.length,i.length)}else{o=a.length;n("theta0");n("dtheta")}}else{if(!i)return 0;o=t.theta.length;n("r0");n("dr")}t._length=o;return o}t.exports={handleRThetaDefaults:p,supplyDefaults:h}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1261}],1264:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");t.exports=function e(t,r,i){var o={};var s=i[r.subplot]._subplot;var l;var u;if(!s){s=i[r.subplot];l=s.radialaxis;u=s.angularaxis}else{l=s.radialAxis;u=s.angularAxis}var c=l.c2l(t.r);o.rLabel=a.tickText(l,c,true).text;var f=u.thetaunit==="degrees"?n.rad2deg(t.theta):t.theta;o.thetaLabel=a.tickText(u,f,true).text;return o}},{"../../lib":778,"../../plots/cartesian/axes":828}],1265:[function(e,t,r){"use strict";var n=e("../scatter/hover");function a(e,t,r,a){var o=n(e,t,r,a);if(!o||o[0].index===false)return;var s=o[0];if(s.index===undefined){return o}var l=e.subplot;var u=s.cd[s.index];var c=s.trace;if(!l.isPtInside(u))return;s.xLabelVal=undefined;s.yLabelVal=undefined;i(u,c,l,s);s.hovertemplate=c.hovertemplate;return o}function i(e,t,r,n){var a=r.radialAxis;var i=r.angularAxis;a._hovertitle="r";i._hovertitle="θ";var o={};o[t.subplot]={_subplot:r};var s=t._module.formatLabels(e,t,o);n.rLabel=s.rLabel;n.thetaLabel=s.thetaLabel;var l=e.hi||t.hoverinfo;var u=[];function c(e,t){u.push(e._hovertitle+": "+t)}if(!t.hovertemplate){var f=l.split("+");if(f.indexOf("all")!==-1)f=["r","theta","text"];if(f.indexOf("r")!==-1)c(a,n.rLabel);if(f.indexOf("theta")!==-1)c(i,n.thetaLabel);if(f.indexOf("text")!==-1&&n.text){u.push(n.text);delete n.text}n.extraText=u.join("<br>")}}t.exports={hoverPoints:a,makeHoverPointText:i}},{"../scatter/hover":1198}],1266:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:e("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scatter/select"),meta:{}}},{"../../plots/polar":894,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1261,"./calc":1262,"./defaults":1263,"./format_labels":1264,"./hover":1265,"./plot":1267}],1267:[function(e,t,r){"use strict";var n=e("../scatter/plot");var a=e("../../constants/numerical").BADNUM;t.exports=function e(t,r,i){var o=r.layers.frontplot.select("g.scatterlayer");var s={xaxis:r.xaxis,yaxis:r.yaxis,plot:r.framework,layerClipId:r._hasClipOnAxisFalse?r.clipIds.forTraces:null};var l=r.radialAxis;var u=r.angularAxis;for(var c=0;c<i.length;c++){var f=i[c];for(var h=0;h<f.length;h++){var p=f[h];var d=p.r;if(d===a){p.x=p.y=a}else{var v=l.c2g(d);var m=u.c2g(p.theta);p.x=v*Math.cos(m);p.y=v*Math.sin(m)}}}n(t,s,i,o)}},{"../../constants/numerical":753,"../scatter/plot":1208}],1268:[function(e,t,r){"use strict";var n=e("../scatterpolar/attributes");var a=e("../scattergl/attributes");var i=e("../../plots/template_attributes").texttemplateAttrs;t.exports={mode:n.mode,r:n.r,theta:n.theta,r0:n.r0,dr:n.dr,theta0:n.theta0,dtheta:n.dtheta,thetaunit:n.thetaunit,text:n.text,texttemplate:i({editType:"plot"},{keys:["r","theta","text"]}),hovertext:n.hovertext,hovertemplate:n.hovertemplate,line:a.line,connectgaps:a.connectgaps,marker:a.marker,fill:a.fill,fillcolor:a.fillcolor,textposition:a.textposition,textfont:a.textfont,hoverinfo:n.hoverinfo,selected:n.selected,unselected:n.unselected}},{"../../plots/template_attributes":906,"../scattergl/attributes":1239,"../scatterpolar/attributes":1261}],1269:[function(e,t,r){"use strict";var n=e("../scatter/colorscale_calc");var a=e("../scatter/calc").calcMarkerSize;var i=e("../scattergl/convert");var o=e("../../plots/cartesian/axes");var s=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function e(t,r){var l=t._fullLayout;var u=r.subplot;var c=l[u].radialaxis;var f=l[u].angularaxis;var h=r._r=c.makeCalcdata(r,"r");var p=r._theta=f.makeCalcdata(r,"theta");var d=r._length;var v={};if(d<h.length)h=h.slice(0,d);if(d<p.length)p=p.slice(0,d);v.r=h;v.theta=p;n(t,r);var m=v.opts=i.style(t,r);var g;if(d<s){g=a(r,d)}else if(m.marker){g=2*(m.marker.sizeAvg||Math.max(m.marker.size,3))}r._extremes.x=o.findExtremes(c,h,{ppad:g});return[{x:false,y:false,t:v,trace:r}]}},{"../../plots/cartesian/axes":828,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"../scattergl/constants":1241,"../scattergl/convert":1242}],1270:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/subtypes");var i=e("../scatterpolar/defaults").handleRThetaDefaults;var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/text_defaults");var u=e("../scatter/fillcolor_defaults");var c=e("../scatter/constants").PTS_LINESONLY;var f=e("./attributes");t.exports=function e(t,r,h,p){function d(e,a){return n.coerce(t,r,f,e,a)}var v=i(t,r,p,d);if(!v){r.visible=false;return}d("thetaunit");d("mode",v<c?"lines+markers":"lines");d("text");d("hovertext");if(r.hoveron!=="fills")d("hovertemplate");if(a.hasLines(r)){s(t,r,h,p,d);d("connectgaps")}if(a.hasMarkers(r)){o(t,r,h,p,d)}if(a.hasText(r)){d("texttemplate");l(t,r,p,d)}d("fill");if(r.fill!=="none"){u(t,r,h,d)}n.coerceSelectionMarkerOpacity(r,d)}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"../scatterpolar/defaults":1263,"./attributes":1268}],1271:[function(e,t,r){"use strict";var n=e("../scatterpolar/format_labels");t.exports=function e(t,r,a){var i=t.i;if(!("r"in t))t.r=r._r[i];if(!("theta"in t))t.theta=r._theta[i];return n(t,r,a)}},{"../scatterpolar/format_labels":1264}],1272:[function(e,t,r){"use strict";var n=e("../scattergl/hover");var a=e("../scatterpolar/hover").makeHoverPointText;function i(e,t,r,i){var o=e.cd;var s=o[0].t;var l=s.r;var u=s.theta;var c=n.hoverPoints(e,t,r,i);if(!c||c[0].index===false)return;var f=c[0];if(f.index===undefined){return c}var h=e.subplot;var p=f.cd[f.index];var d=f.trace;p.r=l[f.index];p.theta=u[f.index];if(!h.isPtInside(p))return;f.xLabelVal=undefined;f.yLabelVal=undefined;a(p,d,h,f);return c}t.exports={hoverPoints:i}},{"../scattergl/hover":1247,"../scatterpolar/hover":1265}],1273:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:e("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scattergl/select"),meta:{}}},{"../../plots/polar":894,"../scatter/marker_colorbar":1205,"../scattergl/select":1251,"./attributes":1268,"./calc":1269,"./defaults":1270,"./format_labels":1271,"./hover":1272,"./plot":1274}],1274:[function(e,t,r){"use strict";var n=e("@plotly/point-cluster");var a=e("fast-isnumeric");var i=e("../scattergl/plot");var o=e("../scattergl/scene_update");var s=e("../scattergl/convert");var l=e("../../lib");var u=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function e(t,r,c){if(!c.length)return;var f=r.radialAxis;var h=r.angularAxis;var p=o(t,r);c.forEach(function(e){if(!e||!e[0]||!e[0].trace)return;var i=e[0];var o=i.trace;var c=i.t;var d=o._length;var v=c.r;var m=c.theta;var g=c.opts;var y;var x=v.slice();var _=m.slice();for(y=0;y<v.length;y++){if(!r.isPtInside({r:v[y],theta:m[y]})){x[y]=NaN;_[y]=NaN}}var b=new Array(d*2);var w=Array(d);var T=Array(d);for(y=0;y<d;y++){var k=x[y];var A,M;if(a(k)){var E=f.c2g(k);var S=h.c2g(_[y],o.thetaunit);A=E*Math.cos(S);M=E*Math.sin(S)}else{A=M=NaN}w[y]=b[y*2]=A;T[y]=b[y*2+1]=M}c.tree=n(b);if(g.marker&&d>=u){g.marker.cluster=c.tree}if(g.marker){g.markerSel.positions=g.markerUnsel.positions=g.marker.positions=b}if(g.line&&b.length>1){l.extendFlat(g.line,s.linePositions(t,o,b))}if(g.text){l.extendFlat(g.text,{positions:b},s.textPosition(t,o,g.text,g.marker));l.extendFlat(g.textSel,{positions:b},s.textPosition(t,o,g.text,g.markerSel));l.extendFlat(g.textUnsel,{positions:b},s.textPosition(t,o,g.text,g.markerUnsel))}if(g.fill&&!p.fill2d)p.fill2d=true;if(g.marker&&!p.scatter2d)p.scatter2d=true;if(g.line&&!p.line2d)p.line2d=true;if(g.text&&!p.glText)p.glText=true;p.lineOptions.push(g.line);p.fillOptions.push(g.fill);p.markerOptions.push(g.marker);p.markerSelectedOptions.push(g.markerSel);p.markerUnselectedOptions.push(g.markerUnsel);p.textOptions.push(g.text);p.textSelectedOptions.push(g.textSel);p.textUnselectedOptions.push(g.textUnsel);p.selectBatch.push([]);p.unselectBatch.push([]);c.x=w;c.y=T;c.rawx=w;c.rawy=T;c.r=v;c.theta=m;c.positions=b;c._scene=p;c.index=p.count;p.count++});return i(t,r,c)}},{"../../lib":778,"../scattergl/constants":1241,"../scattergl/convert":1242,"../scattergl/plot":1249,"../scattergl/scene_update":1250,"@plotly/point-cluster":57,"fast-isnumeric":241}],1275:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../scatter/attributes");var o=e("../../plots/attributes");var s=e("../../components/colorscale/attributes");var l=e("../../components/drawing/attributes").dash;var u=e("../../lib/extend").extendFlat;var c=i.marker;var f=i.line;var h=c.line;t.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:u({},i.mode,{dflt:"markers"}),text:u({},i.text,{}),texttemplate:a({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:u({},i.hovertext,{}),line:{color:f.color,width:f.width,dash:l,shape:u({},f.shape,{values:["linear","spline"]}),smoothing:f.smoothing,editType:"calc"},connectgaps:i.connectgaps,cliponaxis:i.cliponaxis,fill:u({},i.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:i.fillcolor,marker:u({symbol:c.symbol,opacity:c.opacity,maxdisplayed:c.maxdisplayed,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,line:u({width:h.width,editType:"calc"},s("marker.line")),gradient:c.gradient,editType:"calc"},s("marker")),textfont:i.textfont,textposition:i.textposition,selected:i.selected,unselected:i.unselected,hoverinfo:u({},o.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:i.hoveron,hovertemplate:n()}},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1276:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var a=e("../scatter/colorscale_calc");var i=e("../scatter/arrays_to_calcdata");var o=e("../scatter/calc_selection");var s=e("../scatter/calc").calcMarkerSize;var l=["a","b","c"];var u={a:["b","c"],b:["a","c"],c:["a","b"]};t.exports=function e(t,r){var c=t._fullLayout[r.subplot];var f=c.sum;var h=r.sum||f;var p={a:r.a,b:r.b,c:r.c};var d,v,m,g,y,x;for(d=0;d<l.length;d++){m=l[d];if(p[m])continue;y=p[u[m][0]];x=p[u[m][1]];g=new Array(y.length);for(v=0;v<y.length;v++){g[v]=h-y[v]-x[v]}p[m]=g}var _=r._length;var b=new Array(_);var w,T,k,A,M,E;for(d=0;d<_;d++){w=p.a[d];T=p.b[d];k=p.c[d];if(n(w)&&n(T)&&n(k)){w=+w;T=+T;k=+k;A=f/(w+T+k);if(A!==1){w*=A;T*=A;k*=A}E=w;M=k-T;b[d]={x:M,y:E,a:w,b:T,c:k}}else b[d]={x:false,y:false}}s(r,_);a(t,r);i(b,r);o(b,r);return b}},{"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1277:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/constants");var i=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/line_shape_defaults");var u=e("../scatter/text_defaults");var c=e("../scatter/fillcolor_defaults");var f=e("./attributes");t.exports=function e(t,r,h,p){function d(e,a){return n.coerce(t,r,f,e,a)}var v=d("a");var m=d("b");var g=d("c");var y;if(v){y=v.length;if(m){y=Math.min(y,m.length);if(g)y=Math.min(y,g.length)}else if(g)y=Math.min(y,g.length);else y=0}else if(m&&g){y=Math.min(m.length,g.length)}if(!y){r.visible=false;return}r._length=y;d("sum");d("text");d("hovertext");if(r.hoveron!=="fills")d("hovertemplate");var x=y<a.PTS_LINESONLY?"lines+markers":"lines";d("mode",x);if(i.hasLines(r)){s(t,r,h,p,d);l(t,r,d);d("connectgaps")}if(i.hasMarkers(r)){o(t,r,h,p,d,{gradient:true})}if(i.hasText(r)){d("texttemplate");u(t,r,p,d)}var _=[];if(i.hasMarkers(r)||i.hasText(r)){d("cliponaxis");d("marker.maxdisplayed");_.push("points")}d("fill");if(r.fill!=="none"){c(t,r,h,d);if(!i.hasLines(r))l(t,r,d)}if(r.fill==="tonext"||r.fill==="toself"){_.push("fills")}d("hoveron",_.join("+")||"points");n.coerceSelectionMarkerOpacity(r,d)}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1275}],1278:[function(e,t,r){"use strict";t.exports=function e(t,r,n,a,i){if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;if(a[i]){var o=a[i];t.a=o.a;t.b=o.b;t.c=o.c}else{t.a=r.a;t.b=r.b;t.c=r.c}return t}},{}],1279:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");t.exports=function e(t,r,a){var i={};var o=a[r.subplot]._subplot;i.aLabel=n.tickText(o.aaxis,t.a,true).text;i.bLabel=n.tickText(o.baxis,t.b,true).text;i.cLabel=n.tickText(o.caxis,t.c,true).text;return i}},{"../../plots/cartesian/axes":828}],1280:[function(e,t,r){"use strict";var n=e("../scatter/hover");t.exports=function e(t,r,a,i){var o=n(t,r,a,i);if(!o||o[0].index===false)return;var s=o[0];if(s.index===undefined){var l=1-s.y0/t.ya._length;var u=t.xa._length;var c=u*l/2;var f=u-c;s.x0=Math.max(Math.min(s.x0,f),c);s.x1=Math.max(Math.min(s.x1,f),c);return o}var h=s.cd[s.index];var p=s.trace;var d=s.subplot;s.a=h.a;s.b=h.b;s.c=h.c;s.xLabelVal=undefined;s.yLabelVal=undefined;var v={};v[p.subplot]={_subplot:d};var m=p._module.formatLabels(h,p,v);s.aLabel=m.aLabel;s.bLabel=m.bLabel;s.cLabel=m.cLabel;var g=h.hi||p.hoverinfo;var y=[];function x(e,t){y.push(e._hovertitle+": "+t)}if(!p.hovertemplate){var _=g.split("+");if(_.indexOf("all")!==-1)_=["a","b","c"];if(_.indexOf("a")!==-1)x(d.aaxis,s.aLabel);if(_.indexOf("b")!==-1)x(d.baxis,s.bLabel);if(_.indexOf("c")!==-1)x(d.caxis,s.cLabel)}s.extraText=y.join("<br>");s.hovertemplate=p.hovertemplate;return o}},{"../scatter/hover":1198}],1281:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:e("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":907,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1275,"./calc":1276,"./defaults":1277,"./event_data":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(e,t,r){"use strict";var n=e("../scatter/plot");t.exports=function e(t,r,a){var i=r.plotContainer;i.select(".scatterlayer").selectAll("*").remove();var o={xaxis:r.xaxis,yaxis:r.yaxis,plot:i,layerClipId:r._hasClipOnAxisFalse?r.clipIdRelative:null};var s=r.layers.frontplot.select("g.scatterlayer");n(t,o,a,s)}},{"../scatter/plot":1208}],1283:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var a=e("../../components/colorscale/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../scattergl/attributes");var s=e("../../plots/cartesian/constants").idRegex;var l=e("../../plot_api/plot_template").templatedArray;var u=e("../../lib/extend").extendFlat;var c=n.marker;var f=c.line;var h=u(a("marker.line",{editTypeOverride:"calc"}),{width:u({},f.width,{editType:"calc"}),editType:"calc"});var p=u(a("marker"),{symbol:c.symbol,size:u({},c.size,{editType:"markerSize"}),sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:h,editType:"calc"});p.color.editType=p.cmin.editType=p.cmax.editType="style";function d(e){return{valType:"info_array",freeLength:true,editType:"calc",items:{valType:"subplotid",regex:s[e],editType:"plot"}}}t.exports={dimensions:l("dimension",{visible:{valType:"boolean",dflt:true,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:false,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:u({},o.text,{}),hovertext:u({},o.hovertext,{}),hovertemplate:i(),marker:p,xaxes:d("x"),yaxes:d("y"),diagonal:{visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:true,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:true,editType:"calc"},selected:{marker:o.selected.marker,editType:"calc"},unselected:{marker:o.unselected.marker,editType:"calc"},opacity:o.opacity}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/template_attributes":906,"../scatter/attributes":1187,"../scattergl/attributes":1239}],1284:[function(e,t,r){"use strict";var n=e("regl-line2d");var a=e("../../registry");var i=e("../../lib/prepare_regl");var o=e("../../plots/get_data").getModuleCalcData;var s=e("../../plots/cartesian");var l=e("../../plots/cartesian/axis_ids").getFromId;var u=e("../../plots/cartesian/axes").shouldShowZeroLine;var c="splom";function f(e){var t=e._fullLayout;var r=a.getModule(c);var n=o(e.calcdata,r)[0];var s=i(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!s)return;if(t._hasOnlyLargeSploms){d(e)}r.plot(e,{},n)}function h(e){var t=e.calcdata;var r=e._fullLayout;if(r._hasOnlyLargeSploms){d(e)}for(var n=0;n<t.length;n++){var a=t[n][0];var i=a.trace;var o=r._splomScenes[i.uid];if(i.type==="splom"&&o&&o.matrix){p(e,i,o)}}}function p(e,t,r){var n=r.matrixOptions.data.length;var a=t._visibleDims;var i=r.viewOpts.ranges=new Array(n);for(var o=0;o<a.length;o++){var s=a[o];var u=i[o]=new Array(4);var c=l(e,t._diag[s][0]);if(c){u[0]=c.r2l(c.range[0]);u[2]=c.r2l(c.range[1])}var f=l(e,t._diag[s][1]);if(f){u[1]=f.r2l(f.range[0]);u[3]=f.r2l(f.range[1])}}if(r.selectBatch.length||r.unselectBatch.length){r.matrix.update({ranges:i},{ranges:i})}else{r.matrix.update({ranges:i})}}function d(e){var t=e._fullLayout;var r=t._glcanvas.data()[0].regl;var a=t._splomGrid;if(!a){a=t._splomGrid=n(r)}a.update(v(e))}function v(e){var t=e._fullLayout;var r=t._size;var n=[0,0,t.width,t.height];var a={};var i;function o(e,t,r,i,o,s){var l=t[e+"color"];var u=t[e+"width"];var c=String(l+u);if(c in a){a[c].data.push(NaN,NaN,r,i,o,s)}else{a[c]={data:[r,i,o,s],join:"rect",thickness:u,color:l,viewport:n,range:n,overlay:false}}}for(i in t._splomSubplots){var s=t._plots[i];var l=s.xaxis;var c=s.yaxis;var f=l._gridVals;var h=c._gridVals;var p=r.b+c.domain[0]*r.h;var d=-c._m;var v=-d*c.r2l(c.range[0],c.calendar);var m,g;if(l.showgrid){for(i=0;i<f.length;i++){m=l._offset+l.l2p(f[i].x);o("grid",l,m,p,m,p+c._length)}}if(c.showgrid){for(i=0;i<h.length;i++){g=p+v+d*h[i].x;o("grid",c,l._offset,g,l._offset+l._length,g)}}if(u(e,l,c)){m=l._offset+l.l2p(0);o("zeroline",l,m,p,m,p+c._length)}if(u(e,c,l)){g=p+v+0;o("zeroline",c,l._offset,g,l._offset+l._length,g)}}var y=[];for(i in a){y.push(a[i])}return y}function m(e,t,r,n){var a={};var i;if(n._splomScenes){for(i=0;i<e.length;i++){var o=e[i];if(o.type==="splom"){a[o.uid]=1}}for(i=0;i<r.length;i++){var l=r[i];if(!a[l.uid]){var u=n._splomScenes[l.uid];if(u&&u.destroy)u.destroy();n._splomScenes[l.uid]=null;delete n._splomScenes[l.uid]}}}if(Object.keys(n._splomScenes||{}).length===0){delete n._splomScenes}if(n._splomGrid&&(!t._hasOnlyLargeSploms&&n._hasOnlyLargeSploms)){n._splomGrid.destroy();n._splomGrid=null;delete n._splomGrid}s.clean(e,t,r,n)}t.exports={name:c,attr:s.attr,attrRegex:s.attrRegex,layoutAttributes:s.layoutAttributes,supplyLayoutDefaults:s.supplyLayoutDefaults,drawFramework:s.drawFramework,plot:f,drag:h,updateGrid:d,clean:m,updateFx:s.updateFx,toSVG:s.toSVG}},{"../../lib/prepare_regl":791,"../../plots/cartesian":841,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_ids":831,"../../plots/get_data":865,"../../registry":911,"regl-line2d":535}],1285:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axis_ids");var i=e("../scatter/calc").calcMarkerSize;var o=e("../scatter/calc").calcAxisExpansion;var s=e("../scatter/colorscale_calc");var l=e("../scattergl/convert").markerSelection;var u=e("../scattergl/convert").markerStyle;var c=e("./scene_update");var f=e("../../constants/numerical").BADNUM;var h=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function e(t,r){var p=r.dimensions;var d=r._length;var v={};var m=v.cdata=[];var g=v.data=[];var y=r._visibleDims=[];var x,_,b,w,T;function k(e,t){var a=e.makeCalcdata({v:t.values,vcalendar:r.calendar},"v");for(var i=0;i<a.length;i++){a[i]=a[i]===f?NaN:a[i]}m.push(a);g.push(e.type==="log"?n.simpleMap(a,e.c2l):a)}for(x=0;x<p.length;x++){b=p[x];if(b.visible){w=a.getFromId(t,r._diag[x][0]);T=a.getFromId(t,r._diag[x][1]);if(w&&T&&w.type!==T.type){n.log("Skipping splom dimension "+x+" with conflicting axis types");continue}if(w){k(w,b);if(T&&T.type==="category"){T._categories=w._categories.slice()}}else{k(T,b)}y.push(x)}}s(t,r);n.extendFlat(v,u(r));var A=m.length;var M=A*d>h;var E;if(M){E=2*(v.sizeAvg||Math.max(v.size,3))}else{E=i(r,d)}for(_=0;_<y.length;_++){x=y[_];b=p[x];w=a.getFromId(t,r._diag[x][0])||{};T=a.getFromId(t,r._diag[x][1])||{};o(t,r,w,T,m[_],m[_],E)}var S=c(t,r);if(!S.matrix)S.matrix=true;S.matrixOptions=v;S.selectedOptions=l(r,r.selected);S.unselectedOptions=l(r,r.unselected);return[{x:false,y:false,t:{},trace:r}]}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axis_ids":831,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"../scattergl/constants":1241,"../scattergl/convert":1242,"./scene_update":1292}],1286:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/array_container_defaults");var i=e("./attributes");var o=e("../scatter/subtypes");var s=e("../scatter/marker_defaults");var l=e("../parcoords/merge_length");var u=e("../scattergl/helpers").isOpenSymbol;t.exports=function e(t,r,h,p){function d(e,a){return n.coerce(t,r,i,e,a)}var v=a(t,r,{name:"dimensions",handleItemDefaults:c});var m=d("diagonal.visible");var g=d("showupperhalf");var y=d("showlowerhalf");var x=l(r,v,"values");if(!x||!m&&!g&&!y){r.visible=false;return}d("text");d("hovertext");d("hovertemplate");s(t,r,h,p,d);var _=u(r.marker.symbol);var b=o.isBubble(r);d("marker.line.width",_||b?1:0);f(t,r,p,d);n.coerceSelectionMarkerOpacity(r,d)};function c(e,t){function r(r,a){return n.coerce(e,t,i.dimensions,r,a)}r("label");var a=r("values");if(!(a&&a.length))t.visible=false;else r("visible");r("axis.type");r("axis.matches")}function f(e,t,r,n){var a=t.dimensions;var i=a.length;var o=t.showupperhalf;var s=t.showlowerhalf;var l=t.diagonal.visible;var u,c;var f=new Array(i);var h=new Array(i);for(u=0;u<i;u++){var p=u?u+1:"";f[u]="x"+p;h[u]="y"+p}var d=n("xaxes",f);var v=n("yaxes",h);var m=t._diag=new Array(i);t._xaxes={};t._yaxes={};var g=[];var y=[];function x(e,n,a,i){if(!e)return;var o=e.charAt(0);var s=r._splomAxes[o];t["_"+o+"axes"][e]=1;i.push(e);if(!(e in s)){var l=s[e]={};if(a){l.label=a.label||"";if(a.visible&&a.axis){if(a.axis.type)l.type=a.axis.type;if(a.axis.matches)l.matches=n}}}}var _=!l&&!s;var b=!l&&!o;t._axesDim={};for(u=0;u<i;u++){var w=a[u];var T=u===0;var k=u===i-1;var A=T&&_||k&&b?undefined:d[u];var M=T&&b||k&&_?undefined:v[u];x(A,M,w,g);x(M,A,w,y);m[u]=[A,M];t._axesDim[A]=u;t._axesDim[M]=u}for(u=0;u<g.length;u++){for(c=0;c<y.length;c++){var E=g[u]+y[c];if(u>c&&o){r._splomSubplots[E]=1}else if(u<c&&s){r._splomSubplots[E]=1}else if(u===c&&(l||!s||!o)){r._splomSubplots[E]=1}}}if(!s||!l&&o&&s){r._splomGridDflt.xside="bottom";r._splomGridDflt.yside="left"}}},{"../../lib":778,"../../plots/array_container_defaults":823,"../parcoords/merge_length":1158,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scattergl/helpers":1246,"./attributes":1283}],1287:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/colorscale_calc");var i=e("../scattergl/convert").markerStyle;t.exports=function e(t,r){var o=r.trace;var s=t._fullLayout._splomScenes[o.uid];if(s){a(t,o);n.extendFlat(s.matrixOptions,i(o));var l=n.extendFlat({},s.matrixOptions,s.viewOpts);s.matrix.update(l,null)}}},{"../../lib":778,"../scatter/colorscale_calc":1190,"../scattergl/convert":1242}],1288:[function(e,t,r){"use strict";r.getDimIndex=function e(t,r){var n=r._id;var a=n.charAt(0);var i={x:0,y:1}[a];var o=t._visibleDims;for(var s=0;s<o.length;s++){var l=o[s];if(t._diag[l][i]===n)return s}return false}},{}],1289:[function(e,t,r){"use strict";var n=e("./helpers");var a=e("../scattergl/hover").calcHover;function i(e,t,r){var i=e.cd;var o=i[0].trace;var s=e.scene;var l=s.matrixOptions.cdata;var u=e.xa;var c=e.ya;var f=u.c2p(t);var h=c.c2p(r);var p=e.distance;var d=n.getDimIndex(o,u);var v=n.getDimIndex(o,c);if(d===false||v===false)return[e];var m=l[d];var g=l[v];var y,x;var _=p;for(var b=0;b<m.length;b++){var w=m[b];var T=g[b];var k=u.c2p(w)-f;var A=c.c2p(T)-h;var M=Math.sqrt(k*k+A*A);if(M<_){_=x=M;y=b}}e.index=y;e.distance=_;e.dxy=x;if(y===undefined)return[e];return[a(e,m,g,o)]}t.exports={hoverPoints:i}},{"../scattergl/hover":1247,"./helpers":1288}],1290:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../components/grid");t.exports={moduleType:"trace",name:"splom",basePlotModule:e("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select"),editStyle:e("./edit_style"),meta:{}};n.register(a)},{"../../components/grid":687,"../../registry":911,"../scatter/marker_colorbar":1205,"./attributes":1283,"./base_plot":1284,"./calc":1285,"./defaults":1286,"./edit_style":1287,"./hover":1289,"./plot":1291,"./select":1293}],1291:[function(e,t,r){"use strict";var n=e("regl-splom");var a=e("../../lib");var i=e("../../plots/cartesian/axis_ids");var o=e("../../components/dragelement/helpers").selectMode;t.exports=function e(t,r,n){if(!n.length)return;for(var a=0;a<n.length;a++){s(t,n[a][0])}};function s(e,t){var r=e._fullLayout;var s=r._size;var l=t.trace;var u=t.t;var c=r._splomScenes[l.uid];var f=c.matrixOptions;var h=f.cdata;var p=r._glcanvas.data()[0].regl;var d=r.dragmode;var v,m;var g,y,x;if(h.length===0)return;f.lower=l.showupperhalf;f.upper=l.showlowerhalf;f.diagonal=l.diagonal.visible;var _=l._visibleDims;var b=h.length;var w=c.viewOpts={};w.ranges=new Array(b);w.domains=new Array(b);for(x=0;x<_.length;x++){g=_[x];var T=w.ranges[x]=new Array(4);var k=w.domains[x]=new Array(4);v=i.getFromId(e,l._diag[g][0]);if(v){T[0]=v._rl[0];T[2]=v._rl[1];k[0]=v.domain[0];k[2]=v.domain[1]}m=i.getFromId(e,l._diag[g][1]);if(m){T[1]=m._rl[0];T[3]=m._rl[1];k[1]=m.domain[0];k[3]=m.domain[1]}}w.viewport=[s.l,s.b,s.w+s.l,s.h+s.b];if(c.matrix===true){c.matrix=n(p)}var A=r.clickmode.indexOf("select")>-1;var M=o(d)||!!l.selectedpoints||A;var E=true;if(M){var S=l._length;if(l.selectedpoints){c.selectBatch=l.selectedpoints;var C=l.selectedpoints;var L={};for(g=0;g<C.length;g++){L[C[g]]=true}var I=[];for(g=0;g<S;g++){if(!L[g])I.push(g)}c.unselectBatch=I}var O=u.xpx=new Array(b);var P=u.ypx=new Array(b);for(x=0;x<_.length;x++){g=_[x];v=i.getFromId(e,l._diag[g][0]);if(v){O[x]=new Array(S);for(y=0;y<S;y++){O[x][y]=v.c2p(h[x][y])}}m=i.getFromId(e,l._diag[g][1]);if(m){P[x]=new Array(S);for(y=0;y<S;y++){P[x][y]=m.c2p(h[x][y])}}}if(c.selectBatch.length||c.unselectBatch.length){var D=a.extendFlat({},f,c.unselectedOptions,w);var R=a.extendFlat({},f,c.selectedOptions,w);c.matrix.update(D,R);E=false}}else{u.xpx=u.ypx=null}if(E){var z=a.extendFlat({},f,w);c.matrix.update(z,null)}}},{"../../components/dragelement/helpers":661,"../../lib":778,"../../plots/cartesian/axis_ids":831,"regl-splom":539}],1292:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){var a=t._fullLayout;var i=r.uid;var o=a._splomScenes;if(!o)o=a._splomScenes={};var s={dirty:true,selectBatch:[],unselectBatch:[]};var l={matrix:false,selectBatch:[],unselectBatch:[]};var u=o[r.uid];if(!u){u=o[i]=n.extendFlat({},s,l);u.draw=function e(){if(u.matrix&&u.matrix.draw){if(u.selectBatch.length||u.unselectBatch.length){u.matrix.draw(u.unselectBatch,u.selectBatch)}else{u.matrix.draw()}}u.dirty=false};u.destroy=function e(){if(u.matrix&&u.matrix.destroy){u.matrix.destroy()}u.matrixOptions=null;u.selectBatch=null;u.unselectBatch=null;u=null}}if(!u.dirty){n.extendFlat(u,s)}return u}},{"../../lib":778}],1293:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../scatter/subtypes");var i=e("./helpers");t.exports=function e(t,r){var o=t.cd;var s=o[0].trace;var l=o[0].t;var u=t.scene;var c=u.matrixOptions.cdata;var f=t.xaxis;var h=t.yaxis;var p=[];if(!u)return p;var d=!a.hasMarkers(s)&&!a.hasText(s);if(s.visible!==true||d)return p;var v=i.getDimIndex(s,f);var m=i.getDimIndex(s,h);if(v===false||m===false)return p;var g=l.xpx[v];var y=l.ypx[m];var x=c[v];var _=c[m];var b=[];var w=[];if(r!==false&&!r.degenerate){for(var T=0;T<x.length;T++){if(r.contains([g[T],y[T]],null,T,t)){b.push(T);p.push({pointNumber:T,x:x[T],y:_[T]})}else{w.push(T)}}}var k=u.matrixOptions;if(!b.length&&!w.length){u.matrix.update(k,null)}else if(!u.selectBatch.length&&!u.unselectBatch.length){u.matrix.update(u.unselectedOptions,n.extendFlat({},k,u.selectedOptions,u.viewOpts))}u.selectBatch=b;u.unselectBatch=w;return p}},{"../../lib":778,"../scatter/subtypes":1212,"./helpers":1288}],1294:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../mesh3d/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:a({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),showlegend:s({},o.showlegend,{dflt:false})};s(l,n("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}));var u=["opacity","lightposition","lighting"];u.forEach(function(e){l[e]=i[e]});l.hoverinfo=s({},o.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"});l.transforms=undefined;t.exports=l},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1295:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/calc");function i(e,t){t._len=Math.min(t.u.length,t.v.length,t.w.length,t.x.length,t.y.length,t.z.length);t._u=l(t.u,t._len);t._v=l(t.v,t._len);t._w=l(t.w,t._len);t._x=l(t.x,t._len);t._y=l(t.y,t._len);t._z=l(t.z,t._len);var r=o(t);t._gridFill=r.fill;t._Xs=r.Xs;t._Ys=r.Ys;t._Zs=r.Zs;t._len=r.len;var n=0;var i,s,u;if(t.starts){i=l(t.starts.x||[]);s=l(t.starts.y||[]);u=l(t.starts.z||[]);n=Math.min(i.length,s.length,u.length)}t._startsX=i||[];t._startsY=s||[];t._startsZ=u||[];var c=0;var f=Infinity;var h;for(h=0;h<t._len;h++){var p=t._u[h];var d=t._v[h];var v=t._w[h];var m=Math.sqrt(p*p+d*d+v*v);c=Math.max(c,m);f=Math.min(f,m)}a(e,t,{vals:[f,c],containerStr:"",cLetter:"c"});for(h=0;h<n;h++){var g=i[h];r.xMax=Math.max(r.xMax,g);r.xMin=Math.min(r.xMin,g);var y=s[h];r.yMax=Math.max(r.yMax,y);r.yMin=Math.min(r.yMin,y);var x=u[h];r.zMax=Math.max(r.zMax,x);r.zMin=Math.min(r.zMin,x)}t._slen=n;t._normMax=c;t._xbnds=[r.xMin,r.xMax];t._ybnds=[r.yMin,r.yMax];t._zbnds=[r.zMin,r.zMax]}function o(e){var t=e._x;var r=e._y;var a=e._z;var i=e._len;var o,l,u;var c=-Infinity;var f=Infinity;var h=-Infinity;var p=Infinity;var d=-Infinity;var v=Infinity;var m="";var g;var y;var x;var _,b;var w,T;var k,A;if(i){_=t[0];w=r[0];k=a[0]}if(i>1){b=t[i-1];T=r[i-1];A=a[i-1]}for(o=0;o<i;o++){c=Math.max(c,t[o]);f=Math.min(f,t[o]);h=Math.max(h,r[o]);p=Math.min(p,r[o]);d=Math.max(d,a[o]);v=Math.min(v,a[o]);if(!g&&t[o]!==_){g=true;m+="x"}if(!y&&r[o]!==w){y=true;m+="y"}if(!x&&a[o]!==k){x=true;m+="z"}}if(!g)m+="x";if(!y)m+="y";if(!x)m+="z";var M=s(e._x);var E=s(e._y);var S=s(e._z);m=m.replace("x",(_>b?"-":"+")+"x");m=m.replace("y",(w>T?"-":"+")+"y");m=m.replace("z",(k>A?"-":"+")+"z");var C=function(){i=0;M=[];E=[];S=[]};if(!i||i<M.length*E.length*S.length)C();var L=function(e){return e==="x"?t:e==="y"?r:a};var I=function(e){return e==="x"?M:e==="y"?E:S};var O=function(e){return e[i-1]<e[0]?-1:1};var P=L(m[1]);var D=L(m[3]);var R=L(m[5]);var z=I(m[1]).length;var N=I(m[3]).length;var F=I(m[5]).length;var B=false;var j=function(e,t,r){return z*(N*e+t)+r};var U=O(L(m[1]));var H=O(L(m[3]));var V=O(L(m[5]));for(o=0;o<F-1;o++){for(l=0;l<N-1;l++){for(u=0;u<z-1;u++){var G=j(o,l,u);var q=j(o,l,u+1);var Y=j(o,l+1,u);var W=j(o+1,l,u);if(!(P[G]*U<P[q]*U)||!(D[G]*H<D[Y]*H)||!(R[G]*V<R[W]*V)){B=true}if(B)break}if(B)break}if(B)break}if(B){n.warn("Encountered arbitrary coordinates! Unable to input data grid.");C()}return{xMin:f,yMin:p,zMin:v,xMax:c,yMax:h,zMax:d,Xs:M,Ys:E,Zs:S,len:i,fill:m}}function s(e){return n.distinctVals(e).vals}function l(e,t){if(t===undefined)t=e.length;if(n.isTypedArray(e))return e.subarray(0,t);var r=[];for(var a=0;a<t;a++){r[a]=+e[a]}return r}t.exports={calc:i,filter:l,processGrid:o}},{"../../components/colorscale/calc":651,"../../lib":778}],1296:[function(e,t,r){"use strict";var n=e("gl-streamtube3d");var a=n.createTubeMesh;var i=e("../../lib");var o=e("../../lib/gl_format_color").parseColorScale;var s=e("../../components/colorscale").extractOpts;var l=e("../../plots/gl3d/zip3");var u={xaxis:0,yaxis:1,zaxis:2};function c(e,t){this.scene=e;this.uid=t;this.mesh=null;this.data=null}var f=c.prototype;f.handlePick=function(e){var t=this.scene.fullSceneLayout;var r=this.scene.dataScale;function n(e,n){var a=t[n];var i=r[u[n]];return a.l2c(e)/i}if(e.object===this.mesh){var a=e.data.position;var i=e.data.velocity;e.traceCoordinate=[n(a[0],"xaxis"),n(a[1],"yaxis"),n(a[2],"zaxis"),n(i[0],"xaxis"),n(i[1],"yaxis"),n(i[2],"zaxis"),e.data.intensity*this.data._normMax,e.data.divergence];e.textLabel=this.data.hovertext||this.data.text;return true}};function h(e){var t=e.length;var r;if(t>2){r=e.slice(1,t-1)}else if(t===2){r=[(e[0]+e[1])/2]}else{r=e}return r}function p(e){var t=e.length;if(t===1){return[.5,.5]}else{return[e[1]-e[0],e[t-1]-e[t-2]]}}function d(e,t){var r=e.fullSceneLayout;var a=e.dataScale;var c=t._len;var f={};function d(e,t){var n=r[t];var o=a[u[t]];return i.simpleMap(e,function(e){return n.d2l(e)*o})}f.vectors=l(d(t._u,"xaxis"),d(t._v,"yaxis"),d(t._w,"zaxis"),c);if(!c){return{positions:[],cells:[]}}var v=d(t._Xs,"xaxis");var m=d(t._Ys,"yaxis");var g=d(t._Zs,"zaxis");f.meshgrid=[v,m,g];f.gridFill=t._gridFill;var y=t._slen;if(y){f.startingPositions=l(d(t._startsX,"xaxis"),d(t._startsY,"yaxis"),d(t._startsZ,"zaxis"))}else{var x=m[0];var _=h(v);var b=h(g);var w=new Array(_.length*b.length);var T=0;for(var k=0;k<_.length;k++){for(var A=0;A<b.length;A++){w[T++]=[_[k],x,b[A]]}}f.startingPositions=w}f.colormap=o(t);f.tubeSize=t.sizeref;f.maxLength=t.maxdisplayed;var M=d(t._xbnds,"xaxis");var E=d(t._ybnds,"yaxis");var S=d(t._zbnds,"zaxis");var C=p(v);var L=p(m);var I=p(g);var O=[[M[0]-C[0],E[0]-L[0],S[0]-I[0]],[M[1]+C[1],E[1]+L[1],S[1]+I[1]]];var P=n(f,O);var D=s(t);P.vertexIntensityBounds=[D.min/t._normMax,D.max/t._normMax];var R=t.lightposition;P.lightPosition=[R.x,R.y,R.z];P.ambient=t.lighting.ambient;P.diffuse=t.lighting.diffuse;P.specular=t.lighting.specular;P.roughness=t.lighting.roughness;P.fresnel=t.lighting.fresnel;P.opacity=t.opacity;t._pad=P.tubeScale*t.sizeref*2;return P}f.update=function(e){this.data=e;var t=d(this.scene,e);this.mesh.update(t)};f.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function v(e,t){var r=e.glplot.gl;var n=d(e,t);var i=a(r,n);var o=new c(e,t.uid);o.mesh=i;o.data=t;i._trace=o;e.glplot.add(i);return o}t.exports=v},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/gl3d/zip3":881,"gl-streamtube3d":348}],1297:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}var u=l("u");var c=l("v");var f=l("w");var h=l("x");var p=l("y");var d=l("z");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length||!p||!p.length||!d||!d.length){r.visible=false;return}l("starts.x");l("starts.y");l("starts.z");l("maxdisplayed");l("sizeref");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");a(t,r,s,l,{prefix:"",cLetter:"c"});l("text");l("hovertext");l("hovertemplate");r._length=null}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1294}],1298:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"streamtube",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc").calc,plot:e("./convert"),eventData:function(e,t){e.tubex=e.x;e.tubey=e.y;e.tubez=e.z;e.tubeu=t.traceCoordinate[3];e.tubev=t.traceCoordinate[4];e.tubew=t.traceCoordinate[5];e.norm=t.traceCoordinate[6];e.divergence=t.traceCoordinate[7];delete e.x;delete e.y;delete e.z;return e},meta:{}}},{"../../plots/gl3d":870,"./attributes":1294,"./calc":1295,"./convert":1296,"./defaults":1297}],1299:[function(e,t,r){"use strict";var n=e("../../plots/attributes");var a=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../plots/template_attributes").texttemplateAttrs;var o=e("../../components/colorscale/attributes");var s=e("../../plots/domain").attributes;var l=e("../pie/attributes");var u=e("./constants");var c=e("../../lib/extend").extendFlat;t.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:true},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:c({colors:{valType:"data_array",editType:"calc"},line:{color:c({},l.marker.line.color,{dflt:null}),width:c({},l.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},o("marker",{colorAttr:"colors",anim:false})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:l.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:i({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:l.hovertext,hoverinfo:c({},n.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:a({},{keys:u.eventDataKeys}),textfont:l.textfont,insidetextorientation:l.insidetextorientation,insidetextfont:l.insidetextfont,outsidetextfont:c({},l.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:l.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:s({name:"sunburst",trace:true,editType:"calc"})}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161,"./constants":1302}],1300:[function(e,t,r){"use strict";var n=e("../../plots/plots");r.name="sunburst";r.plot=function(e,t,a,i){n.plotBasePlot(r.name,e,t,a,i)};r.clean=function(e,t,a,i){n.cleanBasePlot(r.name,e,t,a,i)}},{"../../plots/plots":891}],1301:[function(e,t,r){"use strict";var n=e("d3-hierarchy");var a=e("fast-isnumeric");var i=e("../../lib");var o=e("../../components/colorscale").makeColorScaleFuncFromTrace;var s=e("../pie/calc").makePullColorFn;var l=e("../pie/calc").generateExtendedColors;var u=e("../../components/colorscale").calc;var c=e("../../constants/numerical").ALMOST_EQUAL;var f={};var h={};r.calc=function(e,t){var r=e._fullLayout;var l=t.ids;var f=i.isArrayOrTypedArray(l);var h=t.labels;var d=t.parents;var v=t.values;var m=i.isArrayOrTypedArray(v);var g=[];var y={};var x={};var _=function(e,t){if(y[e])y[e].push(t);else y[e]=[t];x[t]=1};var b=function(e){return e||typeof e==="number"};var w=function(e){return!m||a(v[e])&&v[e]>=0};var T;var k;var A;if(f){T=Math.min(l.length,d.length);k=function(e){return b(l[e])&&w(e)};A=function(e){return String(l[e])}}else{T=Math.min(h.length,d.length);k=function(e){return b(h[e])&&w(e)};A=function(e){return String(h[e])}}if(m)T=Math.min(T,v.length);for(var M=0;M<T;M++){if(k(M)){var E=A(M);var S=b(d[M])?String(d[M]):"";var C={i:M,id:E,pid:S,label:b(h[M])?String(h[M]):""};if(m)C.v=+v[M];g.push(C);_(S,E)}}if(!y[""]){var L=[];var I;for(I in y){if(!x[I]){L.push(I)}}if(L.length===1){I=L[0];g.unshift({hasImpliedRoot:true,id:I,pid:"",label:I})}else{return i.warn(["Multiple implied roots, cannot build",t.type,"hierarchy of",t.name+".","These roots include:",L.join(", ")].join(" "))}}else if(y[""].length>1){var O=i.randstr();for(var P=0;P<g.length;P++){if(g[P].pid===""){g[P].pid=O}}g.unshift({hasMultipleRoots:true,id:O,pid:"",label:""})}var D;try{D=n.stratify().id(function(e){return e.id}).parentId(function(e){return e.pid})(g)}catch(e){return i.warn(["Failed to build",t.type,"hierarchy of",t.name+".","Error:",e.message].join(" "))}var R=n.hierarchy(D);var z=false;if(m){switch(t.branchvalues){case"remainder":R.sum(function(e){return e.data.v});break;case"total":R.each(function(e){var r=e.data.data;var n=r.v;if(e.children){var a=e.children.reduce(function(e,t){return e+t.data.data.v},0);if(r.hasImpliedRoot||r.hasMultipleRoots){n=a}if(n<a*c){z=true;return i.warn(["Total value for node",e.data.data.id,"of",t.name,"is smaller than the sum of its children.","\nparent value =",n,"\nchildren sum =",a].join(" "))}}e.value=n});break}}else{p(R,t,{branches:t.count.indexOf("branches")!==-1,leaves:t.count.indexOf("leaves")!==-1})}if(z)return;if(t.sort){R.sort(function(e,t){return t.value-e.value})}var N;var F;var B=t.marker.colors||[];var j=!!B.length;if(t._hasColorscale){if(!j){B=m?t.values:t._values}u(e,t,{vals:B,containerStr:"marker",cLetter:"c"});F=o(t.marker)}else{N=s(r["_"+t.type+"colormap"])}R.each(function(e){var r=e.data.data;r.color=t._hasColorscale?F(B[r.i]):N(B[r.i],r.id)});g[0].hierarchy=R;return g};r._runCrossTraceCalc=function(e,t){var r=t._fullLayout;var n=t.calcdata;var a=r[e+"colorway"];var i=r["_"+e+"colormap"];if(r["extend"+e+"colors"]){a=l(a,e==="treemap"?h:f)}var o=0;var s;function u(e){var t=e.data.data;var r=t.id;if(t.color===false){if(i[r]){t.color=i[r]}else if(e.parent){if(e.parent.parent){t.color=e.parent.data.data.color}else{i[r]=t.color=a[o%a.length];o++}}else{t.color=s}}}for(var c=0;c<n.length;c++){var p=n[c];var d=p[0];if(d.trace.type===e&&d.hierarchy){s=d.trace.root.color;d.hierarchy.each(u)}}};r.crossTraceCalc=function(e){return r._runCrossTraceCalc("sunburst",e)};function p(e,t,r){var n=0;var a=e.children;if(a){var i=a.length;for(var o=0;o<i;o++){n+=p(a[o],t,r)}if(r.branches)n++}else{if(r.leaves)n++}e.value=e.data.data.value=n;if(!t._values)t._values=[];t._values[e.data.data.i]=n;return n}},{"../../components/colorscale":655,"../../constants/numerical":753,"../../lib":778,"../pie/calc":1163,"d3-hierarchy":161,"fast-isnumeric":241}],1302:[function(e,t,r){"use strict";t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1303:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../../plots/domain").defaults;var o=e("../bar/defaults").handleText;var s=e("../../components/colorscale");var l=s.hasColorscale;var u=s.handleDefaults;t.exports=function e(t,r,s,c){function f(e,i){return n.coerce(t,r,a,e,i)}var h=f("labels");var p=f("parents");if(!h||!h.length||!p||!p.length){r.visible=false;return}var d=f("values");if(d&&d.length){f("branchvalues")}else{f("count")}f("level");f("maxdepth");var v=f("marker.line.width");if(v)f("marker.line.color",c.paper_bgcolor);f("marker.colors");var m=r._hasColorscale=l(t,"marker","colors")||(t.marker||{}).coloraxis;if(m){u(t,r,c,f,{prefix:"marker.",cLetter:"c"})}f("leaf.opacity",m?1:.7);var g=f("text");f("texttemplate");if(!r.texttemplate)f("textinfo",Array.isArray(g)?"text+label":"label");f("hovertext");f("hovertemplate");var y="auto";o(t,r,c,f,y,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});f("insidetextorientation");f("sort");f("rotation");f("root.color");i(r,c,f);r._length=null}},{"../../components/colorscale":655,"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"./attributes":1299}],1304:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../registry");var i=e("../../components/fx/helpers").appendArrayPointValue;var o=e("../../components/fx");var s=e("../../lib");var l=e("../../lib/events");var u=e("./helpers");var c=e("../pie/helpers");var f=c.formatPieValue;t.exports=function e(t,r,i,c,p){var d=c[0];var v=d.trace;var m=d.hierarchy;var g=v.type==="sunburst";var y=v.type==="treemap";if(!("_hasHoverLabel"in v))v._hasHoverLabel=false;if(!("_hasHoverEvent"in v))v._hasHoverEvent=false;var x=function(e){var a=i._fullLayout;if(i._dragging||a.hovermode===false)return;var l=i._fullData[v.index];var c=e.data.data;var x=c.i;var _=u.isHierarchyRoot(e);var b=u.getParent(m,e);var w=u.getValue(e);var T=function(e){return s.castOption(l,x,e)};var k=T("hovertemplate");var A=o.castHoverinfo(l,a,x);var M=a.separators;if(k||A&&A!=="none"&&A!=="skip"){var E;var S;if(g){E=d.cx+e.pxmid[0]*(1-e.rInscribed);S=d.cy+e.pxmid[1]*(1-e.rInscribed)}if(y){E=e._hoverX;S=e._hoverY}var C={};var L=[];var I=[];var O=function(e){return L.indexOf(e)!==-1};if(A){L=A==="all"?l._module.attributes.hoverinfo.flags:A.split("+")}C.label=c.label;if(O("label")&&C.label)I.push(C.label);if(c.hasOwnProperty("v")){C.value=c.v;C.valueLabel=f(C.value,M);if(O("value"))I.push(C.valueLabel)}C.currentPath=e.currentPath=u.getPath(e.data);if(O("current path")&&!_){I.push(C.currentPath)}var P;var D=[];var R=function(){if(D.indexOf(P)===-1){I.push(P);D.push(P)}};C.percentParent=e.percentParent=w/u.getValue(b);C.parent=e.parentString=u.getPtLabel(b);if(O("percent parent")){P=u.formatPercent(C.percentParent,M)+" of "+C.parent;R()}C.percentEntry=e.percentEntry=w/u.getValue(r);C.entry=e.entry=u.getPtLabel(r);if(O("percent entry")&&!_&&!e.onPathbar){P=u.formatPercent(C.percentEntry,M)+" of "+C.entry;R()}C.percentRoot=e.percentRoot=w/u.getValue(m);C.root=e.root=u.getPtLabel(m);if(O("percent root")&&!_){P=u.formatPercent(C.percentRoot,M)+" of "+C.root;R()}C.text=T("hovertext")||T("text");if(O("text")){P=C.text;if(s.isValidTextValue(P))I.push(P)}var z={trace:l,y:S,text:I.join("<br>"),name:k||O("name")?l.name:undefined,color:T("hoverlabel.bgcolor")||c.color,borderColor:T("hoverlabel.bordercolor"),fontFamily:T("hoverlabel.font.family"),fontSize:T("hoverlabel.font.size"),fontColor:T("hoverlabel.font.color"),nameLength:T("hoverlabel.namelength"),textAlign:T("hoverlabel.align"),hovertemplate:k,hovertemplateLabels:C,eventData:[h(e,l,p.eventDataKeys)]};if(g){z.x0=E-e.rInscribed*e.rpx1;z.x1=E+e.rInscribed*e.rpx1;z.idealAlign=e.pxmid[0]<0?"left":"right"}if(y){z.x=E;z.idealAlign=E<0?"left":"right"}o.loneHover(z,{container:a._hoverlayer.node(),outerContainer:a._paper.node(),gd:i});v._hasHoverLabel=true}if(y){var N=t.select("path.surface");p.styleOne(N,e,l,{hovered:true})}v._hasHoverEvent=true;i.emit("plotly_hover",{points:[h(e,l,p.eventDataKeys)],event:n.event})};var _=function(e){var r=i._fullLayout;var a=i._fullData[v.index];var s=n.select(this).datum();if(v._hasHoverEvent){e.originalEvent=n.event;i.emit("plotly_unhover",{points:[h(s,a,p.eventDataKeys)],event:n.event});v._hasHoverEvent=false}if(v._hasHoverLabel){o.loneUnhover(r._hoverlayer.node());v._hasHoverLabel=false}if(y){var l=t.select("path.surface");p.styleOne(l,s,a,{hovered:false})}};var b=function(e){var t=i._fullLayout;var r=i._fullData[v.index];var s=g&&(u.isHierarchyRoot(e)||u.isLeaf(e));var c=u.getPtId(e);var f=u.isEntry(e)?u.findEntryWithChild(m,c):u.findEntryWithLevel(m,c);var d=u.getPtId(f);var y={points:[h(e,r,p.eventDataKeys)],event:n.event};if(!s)y.nextLevel=d;var x=l.triggerHandler(i,"plotly_"+v.type+"click",y);if(x!==false&&t.hovermode){i._hoverdata=[h(e,r,p.eventDataKeys)];o.click(i,n.event)}if(s)return;if(x===false)return;if(i._dragging)return;if(i._transitioning)return;a.call("_storeDirectGUIEdit",r,t._tracePreGUI[r.uid],{level:r.level});var _={data:[{level:d}],traces:[v.index]};var b={frame:{redraw:false,duration:p.transitionTime},transition:{duration:p.transitionTime,easing:p.transitionEasing},mode:"immediate",fromcurrent:true};o.loneUnhover(t._hoverlayer.node());a.call("animate",i,_,b)};t.on("mouseover",x);t.on("mouseout",_);t.on("click",b)};function h(e,t,r){var n=e.data.data;var a={curveNumber:t.index,pointNumber:n.i,data:t._input,fullData:t};for(var o=0;o<r.length;o++){var s=r[o];if(s in e)a[s]=e[s]}if("parentString"in e&&!u.isHierarchyRoot(e))a.parent=e.parentString;i(a,t,n.i);return a}},{"../../components/fx":683,"../../components/fx/helpers":679,"../../lib":778,"../../lib/events":767,"../../registry":911,"../pie/helpers":1166,"./helpers":1305,d3:169}],1305:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../../lib/setcursor");var o=e("../pie/helpers");r.findEntryWithLevel=function(e,t){var n;if(t){e.eachAfter(function(e){if(r.getPtId(e)===t){return n=e.copy()}})}return n||e};r.findEntryWithChild=function(e,t){var n;e.eachAfter(function(e){var a=e.children||[];for(var i=0;i<a.length;i++){var o=a[i];if(r.getPtId(o)===t){return n=e.copy()}}});return n||e};r.isEntry=function(e){return!e.parent};r.isLeaf=function(e){return!e.children};r.getPtId=function(e){return e.data.data.id};r.getPtLabel=function(e){return e.data.data.label};r.getValue=function(e){return e.value};r.isHierarchyRoot=function(e){return u(e)===""};r.setSliceCursor=function(e,t,n){var a=n.isTransitioning;if(!a){var o=e.datum();a=n.hideOnRoot&&r.isHierarchyRoot(o)||n.hideOnLeaves&&r.isLeaf(o)}i(e,a?null:"pointer")};function s(e,t,n){return{color:r.getOutsideTextFontKey("color",e,t,n),family:r.getOutsideTextFontKey("family",e,t,n),size:r.getOutsideTextFontKey("size",e,t,n)}}function l(e,t,i,o){var s=(o||{}).onPathbar;var l=t.data.data;var u=l.i;var c=n.castOption(e,u,(s?"pathbar.textfont":"insidetextfont")+".color");if(!c&&e._input.textfont){c=n.castOption(e._input,u,"textfont.color")}return{color:c||a.contrast(l.color),family:r.getInsideTextFontKey("family",e,t,i,o),size:r.getInsideTextFontKey("size",e,t,i,o)}}r.getInsideTextFontKey=function(e,t,r,a,i){var o=(i||{}).onPathbar;var s=o?"pathbar.textfont":"insidetextfont";var l=r.data.data.i;return n.castOption(t,l,s+"."+e)||n.castOption(t,l,"textfont."+e)||a.size};r.getOutsideTextFontKey=function(e,t,r,a){var i=r.data.data.i;return n.castOption(t,i,"outsidetextfont."+e)||n.castOption(t,i,"textfont."+e)||a.size};r.isOutsideText=function(e,t){return!e._hasColorscale&&r.isHierarchyRoot(t)};r.determineTextFont=function(e,t,n,a){return r.isOutsideText(e,t)?s(e,t,n):l(e,t,n,a)};r.hasTransition=function(e){return!!(e&&e.duration>0)};r.getMaxDepth=function(e){return e.maxdepth>=0?e.maxdepth:Infinity};r.isHeader=function(e,t){return!(r.isLeaf(e)||e.depth===t._maxDepth-1)};function u(e){return e.data.data.pid}r.getParent=function(e,t){return r.findEntryWithLevel(e,u(t))};r.listPath=function(e,t){var n=e.parent;if(!n)return[];var a=t?[n.data[t]]:[n];return r.listPath(n,t).concat(a)};r.getPath=function(e){return r.listPath(e,"label").join("/")+"/"};r.formatValue=o.formatPieValue;r.formatPercent=function(e,t){var r=n.formatPercent(e,0);if(r==="0%")r=o.formatPiePercent(e,t);return r}},{"../../components/color":643,"../../lib":778,"../../lib/setcursor":799,"../pie/helpers":1166}],1306:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"sunburst",basePlotModule:e("./base_plot"),categories:[],animatable:true,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1205,"./attributes":1299,"./base_plot":1300,"./calc":1301,"./defaults":1303,"./layout_attributes":1307,"./layout_defaults":1308,"./plot":1309,"./style":1310}],1307:[function(e,t,r){"use strict";t.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1308:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return n.coerce(t,r,a,e,i)}i("sunburstcolorway",r.colorway);i("extendsunburstcolors")}},{"../../lib":778,"./layout_attributes":1307}],1309:[function(e,t,r){"use strict";var n=e("d3");var a=e("d3-hierarchy");var i=e("../../components/drawing");var o=e("../../lib");var s=e("../../lib/svg_text_utils");var l=e("../bar/uniform_text");var u=l.recordMinTextSize;var c=l.clearMinTextSize;var f=e("../pie/plot");var h=e("../pie/helpers").getRotationAngle;var p=f.computeTransform;var d=f.transformInsideText;var v=e("./style").styleOne;var m=e("../bar/style").resizeText;var g=e("./fx");var y=e("./constants");var x=e("./helpers");r.plot=function(e,t,r,a){var i=e._fullLayout;var o=i._sunburstlayer;var s,l;var u=!r;var f=!i.uniformtext.mode&&x.hasTransition(r);c("sunburst",i);s=o.selectAll("g.trace.sunburst").data(t,function(e){return e[0].trace.uid});s.enter().append("g").classed("trace",true).classed("sunburst",true).attr("stroke-linejoin","round");s.order();if(f){if(a){l=a()}var h=n.transition().duration(r.duration).ease(r.easing).each("end",function(){l&&l()}).each("interrupt",function(){l&&l()});h.each(function(){o.selectAll("g.trace").each(function(t){_(e,t,this,r)})})}else{s.each(function(t){_(e,t,this,r)});if(i.uniformtext.mode){m(e,i._sunburstlayer.selectAll(".trace"),"sunburst")}}if(u){s.exit().remove()}};function _(e,t,a,l){var c=e._fullLayout;var f=!c.uniformtext.mode&&x.hasTransition(l);var m=n.select(a);var _=m.selectAll("g.slice");var k=t[0];var A=k.trace;var M=k.hierarchy;var E=x.findEntryWithLevel(M,A.level);var S=x.getMaxDepth(A);var C=c._size;var L=A.domain;var I=C.w*(L.x[1]-L.x[0]);var O=C.h*(L.y[1]-L.y[0]);var P=.5*Math.min(I,O);var D=k.cx=C.l+C.w*(L.x[1]+L.x[0])/2;var R=k.cy=C.t+C.h*(1-L.y[0])-O/2;if(!E){return _.remove()}var z=null;var N={};if(f){_.each(function(e){N[x.getPtId(e)]={rpx0:e.rpx0,rpx1:e.rpx1,x0:e.x0,x1:e.x1,transform:e.transform};if(!z&&x.isEntry(e)){z=e}})}var F=b(E).descendants();var B=E.height+1;var j=0;var U=S;if(k.hasMultipleRoots&&x.isHierarchyRoot(E)){F=F.slice(1);B-=1;j=1;U+=1}F=F.filter(function(e){return e.y1<=U});var H=h(A.rotation);if(H){F.forEach(function(e){e.x0+=H;e.x1+=H})}var V=Math.min(B,S);var G=function(e){return(e-j)/V*P};var q=function(e,t){return[e*Math.cos(t),-e*Math.sin(t)]};var Y=function(e){return o.pathAnnulus(e.rpx0,e.rpx1,e.x0,e.x1,D,R)};var W=function(e){return D+T(e)[0]*(e.transform.rCenter||0)+(e.transform.x||0)};var X=function(e){return R+T(e)[1]*(e.transform.rCenter||0)+(e.transform.y||0)};_=_.data(F,x.getPtId);_.enter().append("g").classed("slice",true);if(f){_.exit().transition().each(function(){var e=n.select(this);var t=e.select("path.surface");t.transition().attrTween("d",function(e){var t=Q(e);return function(e){return Y(t(e))}});var r=e.select("g.slicetext");r.attr("opacity",0)}).remove()}else{_.exit().remove()}_.order();var Z=null;if(f&&z){var K=x.getPtId(z);_.each(function(e){if(Z===null&&x.getPtId(e)===K){Z=e.x1}})}var J=_;if(f){J=J.transition().each("end",function(){var t=n.select(this);x.setSliceCursor(t,e,{hideOnRoot:true,hideOnLeaves:true,isTransitioning:false})})}J.each(function(a){var l=n.select(this);var h=o.ensureSingle(l,"path","surface",function(e){e.style("pointer-events","all")});a.rpx0=G(a.y0);a.rpx1=G(a.y1);a.xmid=(a.x0+a.x1)/2;a.pxmid=q(a.rpx1,a.xmid);a.midangle=-(a.xmid-Math.PI/2);a.startangle=-(a.x0-Math.PI/2);a.stopangle=-(a.x1-Math.PI/2);a.halfangle=.5*Math.min(o.angleDelta(a.x0,a.x1)||Math.PI,Math.PI);a.ring=1-a.rpx0/a.rpx1;a.rInscribed=w(a,A);if(f){h.transition().attrTween("d",function(e){var t=$(e);return function(e){return Y(t(e))}})}else{h.attr("d",Y)}l.call(g,E,e,t,{eventDataKeys:y.eventDataKeys,transitionTime:y.CLICK_TRANSITION_TIME,transitionEasing:y.CLICK_TRANSITION_EASING}).call(x.setSliceCursor,e,{hideOnRoot:true,hideOnLeaves:true,isTransitioning:e._transitioning});h.call(v,a,A);var m=o.ensureSingle(l,"g","slicetext");var _=o.ensureSingle(m,"text","",function(e){e.attr("data-notex",1)});var b=o.ensureUniformFontSize(e,x.determineTextFont(A,a,c.font));_.text(r.formatSliceLabel(a,E,A,t,c)).classed("slicetext",true).attr("text-anchor","middle").call(i.font,b).call(s.convertToTspans,e);var T=i.bBox(_.node());a.transform=d(T,a,k);a.transform.targetX=W(a);a.transform.targetY=X(a);var M=function(e,t){var r=e.transform;p(r,t);r.fontSize=b.size;u(A.type,r,c);return o.getTextTransform(r)};if(f){_.transition().attrTween("transform",function(e){var t=ee(e);return function(e){return M(t(e),T)}})}else{_.attr("transform",M(a,T))}});function Q(e){var t=x.getPtId(e);var r=N[t];var a=N[x.getPtId(E)];var i;if(a){var o=(e.x1>a.x1?2*Math.PI:0)+H;i=e.rpx1<a.rpx1?{rpx0:0,rpx1:0}:{x0:o,x1:o}}else{var s;var l=x.getPtId(e.parent);_.each(function(e){if(x.getPtId(e)===l){return s=e}});var u=s.children;var c;u.forEach(function(e,r){if(x.getPtId(e)===t){return c=r}});var f=u.length;var h=n.interpolate(s.x0,s.x1);i={rpx0:P,rpx1:P,x0:h(c/f),x1:h((c+1)/f)}}return n.interpolate(r,i)}function $(e){var t=N[x.getPtId(e)];var r;var a={x0:e.x0,x1:e.x1,rpx0:e.rpx0,rpx1:e.rpx1};if(t){r=t}else{if(z){if(e.parent){if(Z){var i=(e.x1>Z?2*Math.PI:0)+H;r={x0:i,x1:i}}else{r={rpx0:P,rpx1:P};o.extendFlat(r,te(e))}}else{r={rpx0:0,rpx1:0}}}else{r={x0:H,x1:H}}}return n.interpolate(r,a)}function ee(e){var t=N[x.getPtId(e)];var r;var a=e.transform;if(t){r=t}else{r={rpx1:e.rpx1,transform:{textPosAngle:a.textPosAngle,scale:0,rotate:a.rotate,rCenter:a.rCenter,x:a.x,y:a.y}};if(z){if(e.parent){if(Z){var i=e.x1>Z?2*Math.PI:0;r.x0=r.x1=i}else{o.extendFlat(r,te(e))}}else{r.x0=r.x1=H}}else{r.x0=r.x1=H}}var s=n.interpolate(r.transform.textPosAngle,e.transform.textPosAngle);var l=n.interpolate(r.rpx1,e.rpx1);var f=n.interpolate(r.x0,e.x0);var h=n.interpolate(r.x1,e.x1);var p=n.interpolate(r.transform.scale,a.scale);var d=n.interpolate(r.transform.rotate,a.rotate);var v=a.rCenter===0?3:r.transform.rCenter===0?1/3:1;var m=n.interpolate(r.transform.rCenter,a.rCenter);var g=function(e){return m(Math.pow(e,v))};return function(e){var t=l(e);var r=f(e);var n=h(e);var i=g(e);var o=q(t,(r+n)/2);var v=s(e);var m={pxmid:o,rpx1:t,transform:{textPosAngle:v,rCenter:i,x:a.x,y:a.y}};u(A.type,a,c);return{transform:{targetX:W(m),targetY:X(m),scale:p(e),rotate:d(e),rCenter:i}}}}function te(e){var t=e.parent;var r=N[x.getPtId(t)];var a={};if(r){var i=t.children;var o=i.indexOf(e);var s=i.length;var l=n.interpolate(r.x0,r.x1);a.x0=l(o/s);a.x1=l(o/s)}else{a.x0=a.x1=0}return a}}function b(e){return a.partition().size([2*Math.PI,e.height+1])(e)}r.formatSliceLabel=function(e,t,r,n,a){var i=r.texttemplate;var s=r.textinfo;if(!i&&(!s||s==="none")){return""}var l=a.separators;var u=n[0];var c=e.data.data;var f=u.hierarchy;var h=x.isHierarchyRoot(e);var p=x.getParent(f,e);var d=x.getValue(e);if(!i){var v=s.split("+");var m=function(e){return v.indexOf(e)!==-1};var g=[];var y;if(m("label")&&c.label){g.push(c.label)}if(c.hasOwnProperty("v")&&m("value")){g.push(x.formatValue(c.v,l))}if(!h){if(m("current path")){g.push(x.getPath(e.data))}var _=0;if(m("percent parent"))_++;if(m("percent entry"))_++;if(m("percent root"))_++;var b=_>1;if(_){var w;var T=function(e){y=x.formatPercent(w,l);if(b)y+=" of "+e;g.push(y)};if(m("percent parent")&&!h){w=d/x.getValue(p);T("parent")}if(m("percent entry")){w=d/x.getValue(t);T("entry")}if(m("percent root")){w=d/x.getValue(f);T("root")}}}if(m("text")){y=o.castOption(r,c.i,"text");if(o.isValidTextValue(y))g.push(y)}return g.join("<br>")}var k=o.castOption(r,c.i,"texttemplate");if(!k)return"";var A={};if(c.label)A.label=c.label;if(c.hasOwnProperty("v")){A.value=c.v;A.valueLabel=x.formatValue(c.v,l)}A.currentPath=x.getPath(e.data);if(!h){A.percentParent=d/x.getValue(p);A.percentParentLabel=x.formatPercent(A.percentParent,l);A.parent=x.getPtLabel(p)}A.percentEntry=d/x.getValue(t);A.percentEntryLabel=x.formatPercent(A.percentEntry,l);A.entry=x.getPtLabel(t);A.percentRoot=d/x.getValue(f);A.percentRootLabel=x.formatPercent(A.percentRoot,l);A.root=x.getPtLabel(f);if(c.hasOwnProperty("color")){A.color=c.color}var M=o.castOption(r,c.i,"text");if(o.isValidTextValue(M)||M==="")A.text=M;A.customdata=o.castOption(r,c.i,"customdata");return o.texttemplateString(k,A,a._d3locale,A,r._meta||{})};function w(e){if(e.rpx0===0&&o.isFullCircle([e.x0,e.x1])){return 1}else{return Math.max(0,Math.min(1/(1+1/Math.sin(e.halfangle)),e.ring/2))}}function T(e){return k(e.rpx1,e.transform.textPosAngle)}function k(e,t){return[e*Math.sin(t),-e*Math.cos(t)]}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../bar/style":935,"../bar/uniform_text":937,"../pie/helpers":1166,"../pie/plot":1170,"./constants":1302,"./fx":1304,"./helpers":1305,"./style":1310,d3:169,"d3-hierarchy":161}],1310:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/color");var i=e("../../lib");var o=e("../bar/uniform_text").resizeText;function s(e){var t=e._fullLayout._sunburstlayer.selectAll(".trace");o(e,t,"sunburst");t.each(function(e){var t=n.select(this);var r=e[0];var a=r.trace;t.style("opacity",a.opacity);t.selectAll("path.surface").each(function(e){n.select(this).call(l,e,a)})})}function l(e,t,r){var n=t.data.data;var o=!t.children;var s=n.i;var l=i.castOption(r,s,"marker.line.color")||a.defaultLine;var u=i.castOption(r,s,"marker.line.width")||0;e.style("stroke-width",u).call(a.fill,n.color).call(a.stroke,l).style("opacity",o?r.leaf.opacity:null)}t.exports={style:s,styleOne:l}},{"../../components/color":643,"../../lib":778,"../bar/uniform_text":937,d3:169}],1311:[function(e,t,r){"use strict";var n=e("../../components/color");var a=e("../../components/colorscale/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/edit_types").overrideAll;function u(e){return{valType:"boolean",dflt:false}}function c(e){return{show:{valType:"boolean",dflt:false},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:u("x"),y:u("y"),z:u("z")},color:{valType:"color",dflt:n.defaultLine},usecolormap:{valType:"boolean",dflt:false},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:true},highlightcolor:{valType:"color",dflt:n.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var f=t.exports=l(s({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:true},hovertext:{valType:"string",dflt:"",arrayOk:true},hovertemplate:i(),connectgaps:{valType:"boolean",dflt:false,editType:"calc"},surfacecolor:{valType:"data_array"}},a("",{colorAttr:"z or surfacecolor",showScaleDflt:true,autoColorDflt:false,editTypeOverride:"calc"}),{contours:{x:c("x"),y:c("y"),z:c("z")},hidesurface:{valType:"boolean",dflt:false},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:s({},a.zauto,{}),zmin:s({},a.zmin,{}),zmax:s({},a.zmax,{})},hoverinfo:s({},o.hoverinfo),showlegend:s({},o.showlegend,{dflt:false})}),"calc","nested");f.x.editType=f.y.editType=f.z.editType="calc+clearAxisTypes";f.transforms=undefined},{"../../components/color":643,"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906}],1312:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){if(r.surfacecolor){n(t,r,{vals:r.surfacecolor,containerStr:"",cLetter:"c"})}else{n(t,r,{vals:r.z,containerStr:"",cLetter:"c"})}}},{"../../components/colorscale/calc":651}],1313:[function(e,t,r){"use strict";var n=e("gl-surface3d");var a=e("ndarray");var i=e("ndarray-linear-interpolate").d2;var o=e("../heatmap/interp2d");var s=e("../heatmap/find_empties");var l=e("../../lib").isArrayOrTypedArray;var u=e("../../lib/gl_format_color").parseColorScale;var c=e("../../lib/str2rgbarray");var f=e("../../components/colorscale").extractOpts;function h(e,t,r){this.scene=e;this.uid=r;this.surface=t;this.data=null;this.showContour=[false,false,false];this.contourStart=[null,null,null];this.contourEnd=[null,null,null];this.contourSize=[0,0,0];this.minValues=[Infinity,Infinity,Infinity];this.maxValues=[-Infinity,-Infinity,-Infinity];this.dataScaleX=1;this.dataScaleY=1;this.refineData=true;this.objectOffset=[0,0,0]}var p=h.prototype;p.getXat=function(e,t,r,n){var a=!l(this.data.x)?e:l(this.data.x[0])?this.data.x[t][e]:this.data.x[e];return r===undefined?a:n.d2l(a,0,r)};p.getYat=function(e,t,r,n){var a=!l(this.data.y)?t:l(this.data.y[0])?this.data.y[t][e]:this.data.y[t];return r===undefined?a:n.d2l(a,0,r)};p.getZat=function(e,t,r,n){var a=this.data.z[t][e];if(a===null&&this.data.connectgaps&&this.data._interpolatedZ){a=this.data._interpolatedZ[t][e]}return r===undefined?a:n.d2l(a,0,r)};p.handlePick=function(e){if(e.object===this.surface){var t=(e.data.index[0]-1)/this.dataScaleX-1;var r=(e.data.index[1]-1)/this.dataScaleY-1;var n=Math.max(Math.min(Math.round(t),this.data.z[0].length-1),0);var a=Math.max(Math.min(Math.round(r),this.data._ylength-1),0);e.index=[n,a];e.traceCoordinate=[this.getXat(n,a),this.getYat(n,a),this.getZat(n,a)];e.dataCoordinate=[this.getXat(n,a,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(n,a,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(n,a,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var i=0;i<3;i++){var o=e.dataCoordinate[i];if(o!==null&&o!==undefined){e.dataCoordinate[i]*=this.scene.dataScale[i]}}var s=this.data.hovertext||this.data.text;if(Array.isArray(s)&&s[a]&&s[a][n]!==undefined){e.textLabel=s[a][n]}else if(s){e.textLabel=s}else{e.textLabel=""}e.data.dataCoordinate=e.dataCoordinate.slice();this.surface.highlight(e.data);this.scene.glplot.spikes.position=e.dataCoordinate;return true}};function d(e){var t=e[0].rgb;var r=e[e.length-1].rgb;return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}var v=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function m(e,t){if(e<t)return 0;var r=0;while(Math.floor(e%t)===0){e/=t;r++}return r}function g(e){var t=[];for(var r=0;r<v.length;r++){var n=v[r];t.push(m(e,n))}return t}function y(e){var t=g(e);var r=e;for(var n=0;n<v.length;n++){if(t[n]>0){r=v[n];break}}return r}function x(e,t){if(e<1||t<1)return undefined;var r=g(e);var n=g(t);var a=1;for(var i=0;i<v.length;i++){a*=Math.pow(v[i],Math.max(r[i],n[i]))}return a}function _(e){if(e.length===0)return undefined;var t=1;for(var r=0;r<e.length;r++){t=x(t,e[r])}return t}p.calcXnums=function(e){var t;var r=[];for(t=1;t<e;t++){var n=this.getXat(t-1,0);var a=this.getXat(t,0);if(a!==n&&n!==undefined&&n!==null&&a!==undefined&&a!==null){r[t-1]=Math.abs(a-n)}else{r[t-1]=0}}var i=0;for(t=1;t<e;t++){i+=r[t-1]}for(t=1;t<e;t++){if(r[t-1]===0){r[t-1]=1}else{r[t-1]=Math.round(i/r[t-1])}}return r};p.calcYnums=function(e){var t;var r=[];for(t=1;t<e;t++){var n=this.getYat(0,t-1);var a=this.getYat(0,t);if(a!==n&&n!==undefined&&n!==null&&a!==undefined&&a!==null){r[t-1]=Math.abs(a-n)}else{r[t-1]=0}}var i=0;for(t=1;t<e;t++){i+=r[t-1]}for(t=1;t<e;t++){if(r[t-1]===0){r[t-1]=1}else{r[t-1]=Math.round(i/r[t-1])}}return r};var b=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260];var w=b[9];var T=b[13];p.estimateScale=function(e,t){var r=t===0?this.calcXnums(e):this.calcYnums(e);var n=1+_(r);while(n<w){n*=2}while(n>T){n--;n/=y(n);n++;if(n<w){n=T}}var a=Math.round(n/e);return a>1?a:1};function k(e,t,r){var n=r[8]+r[2]*t[0]+r[5]*t[1];e[0]=(r[6]+r[0]*t[0]+r[3]*t[1])/n;e[1]=(r[7]+r[1]*t[0]+r[4]*t[1])/n;return e}function A(e,t,r){M(e,t,k,r);return e}function M(e,t,r,n){var a=[0,0];var o=e.shape[0];var s=e.shape[1];for(var l=0;l<o;l++){for(var u=0;u<s;u++){r(a,[l,u],n);e.set(l,u,i(t,a[0],a[1]))}}return e}p.refineCoords=function(e){var t=this.dataScaleX;var r=this.dataScaleY;var n=e[0].shape[0];var i=e[0].shape[1];var o=Math.floor(e[0].shape[0]*t+1)|0;var s=Math.floor(e[0].shape[1]*r+1)|0;var l=1+n+1;var u=1+i+1;var c=a(new Float32Array(l*u),[l,u]);var f=[1/t,0,0,0,1/r,0,0,0,1];for(var h=0;h<e.length;++h){this.surface.padField(c,e[h]);var p=a(new Float32Array(o*s),[o,s]);A(p,c,f);e[h]=p}};function E(e,t){var r=false;for(var n=0;n<e.length;n++){if(t===e[n]){r=true;break}}if(r===false)e.push(t)}p.setContourLevels=function(){var e=[[],[],[]];var t=[false,false,false];var r=false;var n,a,i;for(n=0;n<3;++n){if(this.showContour[n]){r=true;if(this.contourSize[n]>0&&this.contourStart[n]!==null&&this.contourEnd[n]!==null&&this.contourEnd[n]>this.contourStart[n]){t[n]=true;for(a=this.contourStart[n];a<this.contourEnd[n];a+=this.contourSize[n]){i=a*this.scene.dataScale[n];E(e[n],i)}}}}if(r){var o=[[],[],[]];for(n=0;n<3;++n){if(this.showContour[n]){o[n]=t[n]?e[n]:this.scene.contourLevels[n]}}this.surface.update({levels:o})}};p.update=function(e){var t=this.scene;var r=t.fullSceneLayout;var n=this.surface;var i=u(e);var l=t.dataScale;var h=e.z[0].length;var p=e._ylength;var v=t.contourLevels;this.data=e;var m,g,y,x;var _=[];for(m=0;m<3;m++){_[m]=[];for(g=0;g<h;g++){_[m][g]=[]}}for(g=0;g<h;g++){for(y=0;y<p;y++){_[0][g][y]=this.getXat(g,y,e.xcalendar,r.xaxis);_[1][g][y]=this.getYat(g,y,e.ycalendar,r.yaxis);_[2][g][y]=this.getZat(g,y,e.zcalendar,r.zaxis)}}if(e.connectgaps){e._emptypoints=s(_[2]);o(_[2],e._emptypoints);e._interpolatedZ=[];for(g=0;g<h;g++){e._interpolatedZ[g]=[];for(y=0;y<p;y++){e._interpolatedZ[g][y]=_[2][g][y]}}}for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){x=_[m][g][y];if(x===null||x===undefined){_[m][g][y]=NaN}else{x=_[m][g][y]*=l[m]}}}}for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){x=_[m][g][y];if(x!==null&&x!==undefined){if(this.minValues[m]>x){this.minValues[m]=x}if(this.maxValues[m]<x){this.maxValues[m]=x}}}}}for(m=0;m<3;m++){this.objectOffset[m]=.5*(this.minValues[m]+this.maxValues[m])}for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){x=_[m][g][y];if(x!==null&&x!==undefined){_[m][g][y]-=this.objectOffset[m]}}}}var b=[a(new Float32Array(h*p),[h,p]),a(new Float32Array(h*p),[h,p]),a(new Float32Array(h*p),[h,p])];for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){b[m].set(g,y,_[m][g][y])}}}_=[];var w={colormap:i,levels:[[],[],[]],showContour:[true,true,true],showSurface:!e.hidesurface,contourProject:[[false,false,false],[false,false,false],[false,false,false]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:e.opacityscale,opacity:e.opacity};var k=f(e);w.intensityBounds=[k.min,k.max];if(e.surfacecolor){var A=a(new Float32Array(h*p),[h,p]);for(g=0;g<h;g++){for(y=0;y<p;y++){A.set(g,y,e.surfacecolor[y][g])}}b.push(A)}else{w.intensityBounds[0]*=l[2];w.intensityBounds[1]*=l[2]}if(T<b[0].shape[0]||T<b[0].shape[1]){this.refineData=false}if(this.refineData===true){this.dataScaleX=this.estimateScale(b[0].shape[0],0);this.dataScaleY=this.estimateScale(b[0].shape[1],1);if(this.dataScaleX!==1||this.dataScaleY!==1){this.refineCoords(b)}}if(e.surfacecolor){w.intensity=b.pop()}var M=[true,true,true];var E=["x","y","z"];for(m=0;m<3;++m){var S=e.contours[E[m]];M[m]=S.highlight;w.showContour[m]=S.show||S.highlight;if(!w.showContour[m])continue;w.contourProject[m]=[S.project.x,S.project.y,S.project.z];if(S.show){this.showContour[m]=true;w.levels[m]=v[m];n.highlightColor[m]=w.contourColor[m]=c(S.color);if(S.usecolormap){n.highlightTint[m]=w.contourTint[m]=0}else{n.highlightTint[m]=w.contourTint[m]=1}w.contourWidth[m]=S.width;this.contourStart[m]=S.start;this.contourEnd[m]=S.end;this.contourSize[m]=S.size}else{this.showContour[m]=false;this.contourStart[m]=null;this.contourEnd[m]=null;this.contourSize[m]=0}if(S.highlight){w.dynamicColor[m]=c(S.highlightcolor);w.dynamicWidth[m]=S.highlightwidth}}if(d(i)){w.vertexColor=true}w.objectOffset=this.objectOffset;w.coords=b;n.update(w);n.visible=e.visible;n.enableDynamic=M;n.enableHighlight=M;n.snapToData=true;if("lighting"in e){n.ambientLight=e.lighting.ambient;n.diffuseLight=e.lighting.diffuse;n.specularLight=e.lighting.specular;n.roughness=e.lighting.roughness;n.fresnel=e.lighting.fresnel}if("lightposition"in e){n.lightPosition=[e.lightposition.x,e.lightposition.y,e.lightposition.z]}};p.dispose=function(){this.scene.glplot.remove(this.surface);this.surface.dispose()};function S(e,t){var r=e.glplot.gl;var a=n({gl:r});var i=new h(e,a,t.uid);a._trace=i;i.update(t);e.glplot.add(a);return i}t.exports=S},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../heatmap/find_empties":1071,"../heatmap/interp2d":1074,"gl-surface3d":351,ndarray:495,"ndarray-linear-interpolate":489}],1314:[function(e,t,r){"use strict";var n=e("../../registry");var a=e("../../lib");var i=e("../../components/colorscale/defaults");var o=e("./attributes");var s=.1;function l(e,t){var r=[];var n=32;for(var a=0;a<n;a++){var i=a/(n-1);var o=t+(1-t)*(1-Math.pow(Math.sin(e*i*Math.PI),2));r.push([i,Math.max(0,Math.min(1,o))])}return r}function u(e){var t=0;if(!Array.isArray(e)||e.length<2)return false;if(!e[0]||!e[e.length-1])return false;if(+e[0][0]!==0||+e[e.length-1][0]!==1)return false;for(var r=0;r<e.length;r++){var n=e[r];if(n.length!==2||+n[0]<t){return false}t=+n[0]}return true}function c(e,t,r,s){var l,u;function c(r,n){return a.coerce(e,t,o,r,n)}var p=c("x");var d=c("y");var v=c("z");if(!v||!v.length||(p?p.length<1:false)||(d?d.length<1:false)){t.visible=false;return}t._xlength=Array.isArray(p)&&a.isArrayOrTypedArray(p[0])?v.length:v[0].length;t._ylength=v.length;var m=n.getComponentMethod("calendars","handleTraceDefaults");m(e,t,["x","y","z"],s);c("text");c("hovertext");c("hovertemplate");["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(e){c(e)});var g=c("surfacecolor");var y=["x","y","z"];for(l=0;l<3;++l){var x="contours."+y[l];var _=c(x+".show");var b=c(x+".highlight");if(_||b){for(u=0;u<3;++u){c(x+".project."+y[u])}}if(_){c(x+".color");c(x+".width");c(x+".usecolormap")}if(b){c(x+".highlightcolor");c(x+".highlightwidth")}c(x+".start");c(x+".end");c(x+".size")}if(!g){h(e,"zmin","cmin");h(e,"zmax","cmax");h(e,"zauto","cauto")}i(e,t,s,c,{prefix:"",cLetter:"c"});f(e,t,s,c);t._length=null}function f(e,t,r,n){var a=n("opacityscale");if(a==="max"){t.opacityscale=[[0,s],[1,1]]}else if(a==="min"){t.opacityscale=[[0,1],[1,s]]}else if(a==="extremes"){t.opacityscale=l(1,s)}else if(!u(a)){t.opacityscale=undefined}}function h(e,t,r){if(t in e&&!(r in e)){e[r]=e[t]}}t.exports={supplyDefaults:c,opacityscaleDefaults:f}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1311}],1315:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),moduleType:"trace",name:"surface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1311,"./calc":1312,"./convert":1313,"./defaults":1314}],1316:[function(e,t,r){"use strict";var n=e("../../components/annotations/attributes");var a=e("../../lib/extend").extendFlat;var i=e("../../plot_api/edit_types").overrideAll;var o=e("../../plots/font_attributes");var s=e("../../plots/domain").attributes;var l=e("../../constants/docs").FORMAT_LINK;var u=t.exports=i({domain:s({name:"table",trace:true}),columnwidth:{valType:"number",arrayOk:true,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:true,dflt:null},suffix:{valType:"string",arrayOk:true,dflt:null},height:{valType:"number",dflt:28},align:a({},n.align,{arrayOk:true}),line:{width:{valType:"number",arrayOk:true,dflt:1},color:{valType:"color",arrayOk:true,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:true,dflt:"white"}},font:a({},o({arrayOk:true}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:true,dflt:null},suffix:{valType:"string",arrayOk:true,dflt:null},height:{valType:"number",dflt:20},align:a({},n.align,{arrayOk:true}),line:{width:{valType:"number",arrayOk:true,dflt:1},color:{valType:"color",arrayOk:true,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:true,dflt:"white"}},font:a({},o({arrayOk:true}))}},"calc","from-root");u.transforms=undefined},{"../../components/annotations/attributes":626,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/domain":855,"../../plots/font_attributes":856}],1317:[function(e,t,r){"use strict";var n=e("../../plots/get_data").getModuleCalcData;var a=e("./plot");var i="table";r.name=i;r.plot=function(e){var t=n(e.calcdata,i)[0];if(t.length)a(e,t)};r.clean=function(e,t,r,n){var a=n._has&&n._has(i);var o=t._has&&t._has(i);if(a&&!o){n._paperdiv.selectAll(".table").remove()}}},{"../../plots/get_data":865,"./plot":1324}],1318:[function(e,t,r){"use strict";var n=e("../../lib/gup").wrap;t.exports=function e(){return n({})}},{"../../lib/gup":775}],1319:[function(e,t,r){"use strict";t.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1320:[function(e,t,r){"use strict";var n=e("./constants");var a=e("../../lib/extend").extendFlat;var i=e("fast-isnumeric");t.exports=function e(t,r){var p=l(r.cells.values);var d=function(e){return e.slice(r.header.values.length,e.length)};var v=l(r.header.values);if(v.length&&!v[0].length){v[0]=[""];v=l(v)}var m=v.concat(d(p).map(function(){return u((v[0]||[""]).length)}));var g=r.domain;var y=Math.floor(t._fullLayout._size.w*(g.x[1]-g.x[0]));var x=Math.floor(t._fullLayout._size.h*(g.y[1]-g.y[0]));var _=r.header.values.length?m[0].map(function(){return r.header.height}):[n.emptyHeaderHeight];var b=p.length?p[0].map(function(){return r.cells.height}):[];var w=_.reduce(s,0);var T=x-w;var k=T+n.uplift;var A=h(b,k);var M=h(_,w);var E=f(M,[]);var S=f(A,E);var C={};var L=r._fullInput.columnorder.concat(d(p.map(function(e,t){return t})));var I=m.map(function(e,t){var n=Array.isArray(r.columnwidth)?r.columnwidth[Math.min(t,r.columnwidth.length-1)]:r.columnwidth;return i(n)?Number(n):1});var O=I.reduce(s,0);I=I.map(function(e){return e/O*y});var P=Math.max(o(r.header.line.width),o(r.cells.line.width));var D={key:r.uid+t._context.staticPlot,translateX:g.x[0]*t._fullLayout._size.w,translateY:t._fullLayout._size.h*(1-g.y[1]),size:t._fullLayout._size,width:y,maxLineWidth:P,height:x,columnOrder:L,groupHeight:x,rowBlocks:S,headerRowBlocks:E,scrollY:0,cells:a({},r.cells,{values:p}),headerCells:a({},r.header,{values:m}),gdColumns:m.map(function(e){return e[0]}),gdColumnsOriginalOrder:m.map(function(e){return e[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:false},columns:m.map(function(e,t){var r=C[e];C[e]=(r||0)+1;var n=e+"__"+C[e];return{key:n,label:e,specIndex:t,xIndex:L[t],xScale:c,x:undefined,calcdata:undefined,columnWidth:I[t]}})};D.columns.forEach(function(e){e.calcdata=D;e.x=c(e)});return D};function o(e){if(Array.isArray(e)){var t=0;for(var r=0;r<e.length;r++){t=Math.max(t,o(e[r]))}return t}return e}function s(e,t){return e+t}function l(e){var t=e.slice();var r=Infinity;var n=0;var a;for(a=0;a<t.length;a++){if(!Array.isArray(t[a]))t[a]=[t[a]];r=Math.min(r,t[a].length);n=Math.max(n,t[a].length)}if(r!==n){for(a=0;a<t.length;a++){var i=n-t[a].length;if(i)t[a]=t[a].concat(u(i))}}return t}function u(e){var t=new Array(e);for(var r=0;r<e;r++)t[r]="";return t}function c(e){return e.calcdata.columns.reduce(function(t,r){return r.xIndex<e.xIndex?t+r.columnWidth:t},0)}function f(e,t){var r=Object.keys(e);return r.map(function(r){return a({},e[r],{auxiliaryBlocks:t})})}function h(e,t){var r={};var n;var a=0;var i=0;var o=p();var s=0;var l=0;for(var u=0;u<e.length;u++){n=e[u];o.rows.push({rowIndex:u,rowHeight:n});i+=n;if(i>=t||u===e.length-1){r[a]=o;o.key=l++;o.firstRowIndex=s;o.lastRowIndex=u;o=p();a+=i;s=u+1;i=0}}return r}function p(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":768,"./constants":1319,"fast-isnumeric":241}],1321:[function(e,t,r){"use strict";var n=e("../../lib/extend").extendFlat;r.splitToPanels=function(e){var t=[0,0];var r=n({},e,{key:"header",type:"header",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:true,values:e.calcdata.headerCells.values[e.specIndex],rowBlocks:e.calcdata.headerRowBlocks,calcdata:n({},e.calcdata,{cells:e.calcdata.headerCells})});var a=n({},e,{key:"cells1",type:"cells",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:false,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});var i=n({},e,{key:"cells2",type:"cells",page:1,prevPages:t,currentRepaint:[null,null],dragHandle:false,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});return[a,i,r]};r.splitToCells=function(e){var t=a(e);return(e.values||[]).slice(t[0],t[1]).map(function(r,n){var a=typeof r==="string"&&r.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:n+a,key:t[0]+n,column:e,calcdata:e.calcdata,page:e.page,rowBlocks:e.rowBlocks,value:r}})};function a(e){var t=e.rowBlocks[e.page];var r=t?t.rows[0].rowIndex:0;var n=t?r+t.rows.length:0;return[r,n]}},{"../../lib/extend":768}],1322:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../../plots/domain").defaults;function o(e,t){var r=e.columnorder||[];var n=e.header.values.length;var a=r.slice(0,n);var i=a.slice().sort(function(e,t){return e-t});var o=a.map(function(e){return i.indexOf(e)});for(var s=o.length;s<n;s++){o.push(s)}t("columnorder",o)}t.exports=function e(t,r,s,l){function u(e,i){return n.coerce(t,r,a,e,i)}i(r,l,u);u("columnwidth");u("header.values");u("header.format");u("header.align");u("header.prefix");u("header.suffix");u("header.height");u("header.line.width");u("header.line.color");u("header.fill.color");n.coerceFont(u,"header.font",n.extendFlat({},l.font));o(r,u);u("cells.values");u("cells.format");u("cells.align");u("cells.prefix");u("cells.suffix");u("cells.height");u("cells.line.width");u("cells.line.color");u("cells.fill.color");n.coerceFont(u,"cells.font",n.extendFlat({},l.font));r._length=null}},{"../../lib":778,"../../plots/domain":855,"./attributes":1316}],1323:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"table",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1316,"./base_plot":1317,"./calc":1318,"./defaults":1322,"./plot":1324}],1324:[function(e,t,r){"use strict";var n=e("./constants");var a=e("d3");var i=e("../../lib/gup");var o=e("../../components/drawing");var s=e("../../lib/svg_text_utils");var l=e("../../lib").raiseToTop;var u=e("../../lib").strTranslate;var c=e("../../lib").cancelTransition;var f=e("./data_preparation_helper");var h=e("./data_split_helpers");var p=e("../../components/color");t.exports=function e(t,r){var s=!t._context.staticPlot;var p=t._fullLayout._paper.selectAll("."+n.cn.table).data(r.map(function(e){var r=i.unwrap(e);var n=r.trace;return f(t,n)}),i.keyFun);p.exit().remove();p.enter().append("g").classed(n.cn.table,true).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all");p.attr("width",function(e){return e.width+e.size.l+e.size.r}).attr("height",function(e){return e.height+e.size.t+e.size.b}).attr("transform",function(e){return u(e.translateX,e.translateY)});var _=p.selectAll("."+n.cn.tableControlView).data(i.repeat,i.keyFun);var b=_.enter().append("g").classed(n.cn.tableControlView,true).style("box-sizing","content-box");if(s){var w="onwheel"in document?"wheel":"mousewheel";b.on("mousemove",function(e){_.filter(function(t){return e===t}).call(y,t)}).on(w,function(e){if(e.scrollbarState.wheeling)return;e.scrollbarState.wheeling=true;var r=e.scrollY+a.event.deltaY;var n=B(t,_,null,r)(e);if(!n){a.event.stopPropagation();a.event.preventDefault()}e.scrollbarState.wheeling=false}).call(y,t,true)}_.attr("transform",function(e){return u(e.size.l,e.size.t)});var T=_.selectAll("."+n.cn.scrollBackground).data(i.repeat,i.keyFun);T.enter().append("rect").classed(n.cn.scrollBackground,true).attr("fill","none");T.attr("width",function(e){return e.width}).attr("height",function(e){return e.height});_.each(function(e){o.setClipUrl(a.select(this),v(t,e),t)});var k=_.selectAll("."+n.cn.yColumn).data(function(e){return e.columns},i.keyFun);k.enter().append("g").classed(n.cn.yColumn,true);k.exit().remove();k.attr("transform",function(e){return u(e.x,0)});if(s){k.call(a.behavior.drag().origin(function(e){var r=a.select(this);P(r,e,-n.uplift);l(this);e.calcdata.columnDragInProgress=true;y(_.filter(function(t){return e.calcdata.key===t.key}),t);return e}).on("drag",function(e){var t=a.select(this);var r=function(t){return(e===t?a.event.x:t.x)+t.columnWidth/2};e.x=Math.max(-n.overdrag,Math.min(e.calcdata.width+n.overdrag-e.columnWidth,a.event.x));var i=g(k).filter(function(t){return t.calcdata.key===e.calcdata.key});var o=i.sort(function(e,t){return r(e)-r(t)});o.forEach(function(t,r){t.xIndex=r;t.x=e===t?t.x:t.xScale(t)});k.filter(function(t){return e!==t}).transition().ease(n.transitionEase).duration(n.transitionDuration).attr("transform",function(e){return u(e.x,0)});t.call(c).attr("transform",u(e.x,-n.uplift))}).on("dragend",function(e){var r=a.select(this);var n=e.calcdata;e.x=e.xScale(e);e.calcdata.columnDragInProgress=false;P(r,e,0);I(t,n,n.columns.map(function(e){return e.xIndex}))}))}k.each(function(e){o.setClipUrl(a.select(this),m(t,e),t)});var A=k.selectAll("."+n.cn.columnBlock).data(h.splitToPanels,i.keyFun);A.enter().append("g").classed(n.cn.columnBlock,true).attr("id",function(e){return e.key});A.style("cursor",function(e){return e.dragHandle?"ew-resize":e.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var M=A.filter(R);var E=A.filter(D);if(s){E.call(a.behavior.drag().origin(function(e){a.event.stopPropagation();return e}).on("drag",B(t,_,-1)).on("dragend",function(){}))}x(t,_,M,A);x(t,_,E,A);var S=_.selectAll("."+n.cn.scrollAreaClip).data(i.repeat,i.keyFun);S.enter().append("clipPath").classed(n.cn.scrollAreaClip,true).attr("id",function(e){return v(t,e)});var C=S.selectAll("."+n.cn.scrollAreaClipRect).data(i.repeat,i.keyFun);C.enter().append("rect").classed(n.cn.scrollAreaClipRect,true).attr("x",-n.overdrag).attr("y",-n.uplift).attr("fill","none");C.attr("width",function(e){return e.width+2*n.overdrag}).attr("height",function(e){return e.height+n.uplift});var L=k.selectAll("."+n.cn.columnBoundary).data(i.repeat,i.keyFun);L.enter().append("g").classed(n.cn.columnBoundary,true);var O=k.selectAll("."+n.cn.columnBoundaryClippath).data(i.repeat,i.keyFun);O.enter().append("clipPath").classed(n.cn.columnBoundaryClippath,true);O.attr("id",function(e){return m(t,e)});var z=O.selectAll("."+n.cn.columnBoundaryRect).data(i.repeat,i.keyFun);z.enter().append("rect").classed(n.cn.columnBoundaryRect,true).attr("fill","none");z.attr("width",function(e){return e.columnWidth+2*d(e)}).attr("height",function(e){return e.calcdata.height+2*d(e)+n.uplift}).attr("x",function(e){return-d(e)}).attr("y",function(e){return-d(e)});F(null,E,_)};function d(e){return Math.ceil(e.calcdata.maxLineWidth/2)}function v(e,t){return"clip"+e._fullLayout._uid+"_scrollAreaBottomClip_"+t.key}function m(e,t){return"clip"+e._fullLayout._uid+"_columnBoundaryClippath_"+t.calcdata.key+"_"+t.specIndex}function g(e){return[].concat.apply([],e.map(function(e){return e})).map(function(e){return e.__data__})}function y(e,t,r){function o(e){var t=e.rowBlocks;return q(t,t.length-1)+(t.length?Y(t[t.length-1],Infinity):1)}var s=e.selectAll("."+n.cn.scrollbarKit).data(i.repeat,i.keyFun);s.enter().append("g").classed(n.cn.scrollbarKit,true).style("shape-rendering","geometricPrecision");s.each(function(e){var t=e.scrollbarState;t.totalHeight=o(e);t.scrollableAreaHeight=e.groupHeight-z(e);t.currentlyVisibleHeight=Math.min(t.totalHeight,t.scrollableAreaHeight);t.ratio=t.currentlyVisibleHeight/t.totalHeight;t.barLength=Math.max(t.ratio*t.currentlyVisibleHeight,n.goldenRatio*n.scrollbarWidth);t.barWiggleRoom=t.currentlyVisibleHeight-t.barLength;t.wiggleRoom=Math.max(0,t.totalHeight-t.scrollableAreaHeight);t.topY=t.barWiggleRoom===0?0:e.scrollY/t.wiggleRoom*t.barWiggleRoom;t.bottomY=t.topY+t.barLength;t.dragMultiplier=t.wiggleRoom/t.barWiggleRoom}).attr("transform",function(e){var t=e.width+n.scrollbarWidth/2+n.scrollbarOffset;return u(t,z(e))});var l=s.selectAll("."+n.cn.scrollbar).data(i.repeat,i.keyFun);l.enter().append("g").classed(n.cn.scrollbar,true);var c=l.selectAll("."+n.cn.scrollbarSlider).data(i.repeat,i.keyFun);c.enter().append("g").classed(n.cn.scrollbarSlider,true);c.attr("transform",function(e){return u(0,e.scrollbarState.topY||0)});var f=c.selectAll("."+n.cn.scrollbarGlyph).data(i.repeat,i.keyFun);f.enter().append("line").classed(n.cn.scrollbarGlyph,true).attr("stroke","black").attr("stroke-width",n.scrollbarWidth).attr("stroke-linecap","round").attr("y1",n.scrollbarWidth/2);f.attr("y2",function(e){return e.scrollbarState.barLength-n.scrollbarWidth/2}).attr("stroke-opacity",function(e){return e.columnDragInProgress||!e.scrollbarState.barWiggleRoom||r?0:.4});f.transition().delay(0).duration(0);f.transition().delay(n.scrollbarHideDelay).duration(n.scrollbarHideDuration).attr("stroke-opacity",0);var h=l.selectAll("."+n.cn.scrollbarCaptureZone).data(i.repeat,i.keyFun);h.enter().append("line").classed(n.cn.scrollbarCaptureZone,true).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",n.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(r){var n=a.event.y;var i=this.getBoundingClientRect();var o=r.scrollbarState;var s=n-i.top;var l=a.scale.linear().domain([0,o.scrollableAreaHeight]).range([0,o.totalHeight]).clamp(true);if(!(o.topY<=s&&s<=o.bottomY)){B(t,e,null,l(s-o.barLength/2))(r)}}).call(a.behavior.drag().origin(function(e){a.event.stopPropagation();e.scrollbarState.scrollbarScrollInProgress=true;return e}).on("drag",B(t,e)).on("dragend",function(){}));h.attr("y2",function(e){return e.scrollbarState.scrollableAreaHeight});if(t._context.staticPlot){f.remove();h.remove()}}function x(e,t,r,n){var a=_(r);var i=b(a);A(i);var o=w(i);E(o);var s=k(i);var l=T(s);M(l);S(l,t,n,e);G(i)}function _(e){var t=e.selectAll("."+n.cn.columnCells).data(i.repeat,i.keyFun);t.enter().append("g").classed(n.cn.columnCells,true);t.exit().remove();return t}function b(e){var t=e.selectAll("."+n.cn.columnCell).data(h.splitToCells,function(e){return e.keyWithinBlock});t.enter().append("g").classed(n.cn.columnCell,true);t.exit().remove();return t}function w(e){var t=e.selectAll("."+n.cn.cellRect).data(i.repeat,function(e){return e.keyWithinBlock});t.enter().append("rect").classed(n.cn.cellRect,true);return t}function T(e){var t=e.selectAll("."+n.cn.cellText).data(i.repeat,function(e){return e.keyWithinBlock});t.enter().append("text").classed(n.cn.cellText,true).style("cursor",function(){return"auto"}).on("mousedown",function(){a.event.stopPropagation()});return t}function k(e){var t=e.selectAll("."+n.cn.cellTextHolder).data(i.repeat,function(e){return e.keyWithinBlock});t.enter().append("g").classed(n.cn.cellTextHolder,true).style("shape-rendering","geometricPrecision");return t}function A(e){e.each(function(e,t){var r=e.calcdata.cells.font;var n=e.column.specIndex;var a={size:O(r.size,n,t),color:O(r.color,n,t),family:O(r.family,n,t)};e.rowNumber=e.key;e.align=O(e.calcdata.cells.align,n,t);e.cellBorderWidth=O(e.calcdata.cells.line.width,n,t);e.font=a})}function M(e){e.each(function(e){o.font(a.select(this),e.font)})}function E(e){e.attr("width",function(e){return e.column.columnWidth}).attr("stroke-width",function(e){return e.cellBorderWidth}).each(function(e){var t=a.select(this);p.stroke(t,O(e.calcdata.cells.line.color,e.column.specIndex,e.rowNumber));p.fill(t,O(e.calcdata.cells.fill.color,e.column.specIndex,e.rowNumber))})}function S(e,t,r,i){e.text(function(e){var t=e.column.specIndex;var r=e.rowNumber;var i=e.value;var o=typeof i==="string";var s=o&&i.match(/<br>/i);var l=!o||s;e.mayHaveMarkup=o&&i.match(/[<&>]/);var u=C(i);e.latex=u;var c=u?"":O(e.calcdata.cells.prefix,t,r)||"";var f=u?"":O(e.calcdata.cells.suffix,t,r)||"";var h=u?null:O(e.calcdata.cells.format,t,r)||null;var p=c+(h?a.format(h)(e.value):e.value)+f;var d;e.wrappingNeeded=!e.wrapped&&!l&&!u&&(d=L(p));e.cellHeightMayIncrease=s||u||e.mayHaveMarkup||(d===void 0?L(p):d);e.needsConvertToTspans=e.mayHaveMarkup||e.wrappingNeeded||e.latex;var v;if(e.wrappingNeeded){var m=n.wrapSplitCharacter===" "?p.replace(/<a href=/gi,"<a_href="):p;var g=m.split(n.wrapSplitCharacter);var y=n.wrapSplitCharacter===" "?g.map(function(e){return e.replace(/<a_href=/gi,"<a href=")}):g;e.fragments=y.map(function(e){return{text:e,width:null}});e.fragments.push({fragment:n.wrapSpacer,width:null});v=y.join(n.lineBreaker)+n.lineBreaker+n.wrapSpacer}else{delete e.fragments;v=p}return v}).attr("dy",function(e){return e.needsConvertToTspans?0:"0.75em"}).each(function(e){var o=this;var l=a.select(o);var c=e.wrappingNeeded?U:H;if(e.needsConvertToTspans){s.convertToTspans(l,i,c(r,o,t,i,e))}else{a.select(o.parentNode).attr("transform",function(e){return u(V(e),n.cellPad)}).attr("text-anchor",function(e){return{left:"start",center:"middle",right:"end"}[e.align]})}})}function C(e){return typeof e==="string"&&e.match(n.latexCheck)}function L(e){return e.indexOf(n.wrapSplitCharacter)!==-1}function I(e,t,r){var n=t.gdColumnsOriginalOrder;t.gdColumns.sort(function(e,t){return r[n.indexOf(e)]-r[n.indexOf(t)]});t.columnorder=r;e.emit("plotly_restyle")}function O(e,t,r){if(Array.isArray(e)){var n=e[Math.min(t,e.length-1)];if(Array.isArray(n)){return n[Math.min(r,n.length-1)]}else{return n}}else{return e}}function P(e,t,r){e.transition().ease(n.releaseTransitionEase).duration(n.releaseTransitionDuration).attr("transform",u(t.x,r))}function D(e){return e.type==="cells"}function R(e){return e.type==="header"}function z(e){var t=e.rowBlocks.length?e.rowBlocks[0].auxiliaryBlocks:[];return t.reduce(function(e,t){return e+Y(t,Infinity)},0)}function N(e,t,r){var n=[];var a=0;for(var i=0;i<e.length;i++){var o=e[i];var s=o.rows;var l=0;for(var u=0;u<s.length;u++){l+=s[u].rowHeight}o.allRowsHeight=l;var c=a+l;var f=t;var h=f+r;if(f<c&&h>a){n.push(i)}a+=l}return n}function F(e,t,r){var n=g(t)[0];if(n===undefined)return;var a=n.rowBlocks;var i=n.calcdata;var o=q(a,a.length);var s=n.calcdata.groupHeight-z(n);var l=i.scrollY=Math.max(0,Math.min(o-s,i.scrollY));var c=N(a,l,s);if(c.length===1){if(c[0]===a.length-1){c.unshift(c[0]-1)}else{c.push(c[0]+1)}}if(c[0]%2){c.reverse()}t.each(function(e,t){e.page=c[t];e.scrollY=l});t.attr("transform",function(e){var t=q(e.rowBlocks,e.page)-e.scrollY;return u(0,t)});if(e){j(e,r,t,c,n.prevPages,n,0);j(e,r,t,c,n.prevPages,n,1);y(r,e)}}function B(e,t,r,i){return function o(s){var l=s.calcdata?s.calcdata:s;var u=t.filter(function(e){return l.key===e.key});var c=r||l.scrollbarState.dragMultiplier;var f=l.scrollY;l.scrollY=i===void 0?l.scrollY+c*a.event.dy:i;var h=u.selectAll("."+n.cn.yColumn).selectAll("."+n.cn.columnBlock).filter(D);F(e,h,u);return l.scrollY===f}}function j(e,t,r,n,a,i,o){var s=n[o]!==a[o];if(s){clearTimeout(i.currentRepaint[o]);i.currentRepaint[o]=setTimeout(function(){var i=r.filter(function(e,t){return t===o&&n[t]!==a[t]});x(e,t,i,r);a[o]=n[o]})}}function U(e,t,r,i){return function o(){var s=a.select(t.parentNode);s.each(function(e){var t=e.fragments;s.selectAll("tspan.line").each(function(e,r){t[r].width=this.getComputedTextLength()});var r=t[t.length-1].width;var a=t.slice(0,-1);var i=[];var o,l;var u=0;var c=e.column.columnWidth-2*n.cellPad;e.value="";while(a.length){o=a.shift();l=o.width+r;if(u+l>c){e.value+=i.join(n.wrapSpacer)+n.lineBreaker;i=[];u=0}i.push(o.text);u+=l}if(u){e.value+=i.join(n.wrapSpacer)}e.wrapped=true});s.selectAll("tspan.line").remove();S(s.select("."+n.cn.cellText),r,e,i);a.select(t.parentNode.parentNode).call(G)}}function H(e,t,r,i,o){return function s(){if(o.settledY)return;var l=a.select(t.parentNode);var c=X(o);var f=o.key-c.firstRowIndex;var h=c.rows[f].rowHeight;var p=o.cellHeightMayIncrease?t.parentNode.getBoundingClientRect().height+2*n.cellPad:h;var d=Math.max(p,h);var v=d-c.rows[f].rowHeight;if(v){c.rows[f].rowHeight=d;e.selectAll("."+n.cn.columnCell).call(G);F(null,e.filter(D),0);y(r,i,true)}l.attr("transform",function(){var e=this;var t=e.parentNode;var r=t.getBoundingClientRect();var i=a.select(e.parentNode).select("."+n.cn.cellRect).node().getBoundingClientRect();var s=e.transform.baseVal.consolidate();var l=i.top-r.top+(s?s.matrix.f:n.cellPad);return u(V(o,a.select(e.parentNode).select("."+n.cn.cellTextHolder).node().getBoundingClientRect().width),l)});o.settledY=true}}function V(e,t){switch(e.align){case"left":return n.cellPad;case"right":return e.column.columnWidth-(t||0)-n.cellPad;case"center":return(e.column.columnWidth-(t||0))/2;default:return n.cellPad}}function G(e){e.attr("transform",function(e){var t=e.rowBlocks[0].auxiliaryBlocks.reduce(function(e,t){return e+Y(t,Infinity)},0);var r=X(e);var n=Y(r,e.key);var a=n+t;return u(0,a)}).selectAll("."+n.cn.cellRect).attr("height",function(e){return Z(X(e),e.key).rowHeight})}function q(e,t){var r=0;for(var n=t-1;n>=0;n--){r+=W(e[n])}return r}function Y(e,t){var r=0;for(var n=0;n<e.rows.length&&e.rows[n].rowIndex<t;n++){r+=e.rows[n].rowHeight}return r}function W(e){var t=e.allRowsHeight;if(t!==void 0){return t}var r=0;for(var n=0;n<e.rows.length;n++){r+=e.rows[n].rowHeight}e.allRowsHeight=r;return r}function X(e){return e.rowBlocks[e.page]}function Z(e,t){return e.rows[t-e.firstRowIndex]}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../lib/svg_text_utils":803,"./constants":1319,"./data_preparation_helper":1320,"./data_split_helpers":1321,d3:169}],1325:[function(e,t,r){"use strict";var n=e("../../plots/template_attributes").hovertemplateAttrs;var a=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../../components/colorscale/attributes");var o=e("../../plots/domain").attributes;var s=e("../pie/attributes");var l=e("../sunburst/attributes");var u=e("./constants");var c=e("../../lib/extend").extendFlat;t.exports={labels:l.labels,parents:l.parents,values:l.values,branchvalues:l.branchvalues,count:l.count,level:l.level,maxdepth:l.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:c({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:l.marker.colors,depthfade:{valType:"enumerated",values:[true,false,"reversed"],editType:"style"},line:l.marker.line,editType:"calc"},i("marker",{colorAttr:"colors",anim:false})),pathbar:{visible:{valType:"boolean",dflt:true,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:c({},s.textfont,{}),editType:"calc"},text:s.text,textinfo:l.textinfo,texttemplate:a({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:s.hovertext,hoverinfo:l.hoverinfo,hovertemplate:n({},{keys:u.eventDataKeys}),textfont:s.textfont,insidetextfont:s.insidetextfont,outsidetextfont:c({},s.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:s.sort,root:l.root,domain:o({name:"treemap",trace:true,editType:"calc"})}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161,"../sunburst/attributes":1299,"./constants":1328}],1326:[function(e,t,r){"use strict";var n=e("../../plots/plots");r.name="treemap";r.plot=function(e,t,a,i){n.plotBasePlot(r.name,e,t,a,i)};r.clean=function(e,t,a,i){n.cleanBasePlot(r.name,e,t,a,i)}},{"../../plots/plots":891}],1327:[function(e,t,r){"use strict";var n=e("../sunburst/calc");r.calc=function(e,t){return n.calc(e,t)};r.crossTraceCalc=function(e){return n._runCrossTraceCalc("treemap",e)}},{"../sunburst/calc":1301}],1328:[function(e,t,r){"use strict";t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1329:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../../components/color");var o=e("../../plots/domain").defaults;var s=e("../bar/defaults").handleText;var l=e("../bar/constants").TEXTPAD;var u=e("../../components/colorscale");var c=u.hasColorscale;var f=u.handleDefaults;t.exports=function e(t,r,u,h){function p(e,i){return n.coerce(t,r,a,e,i)}var d=p("labels");var v=p("parents");if(!d||!d.length||!v||!v.length){r.visible=false;return}var m=p("values");if(m&&m.length){p("branchvalues")}else{p("count")}p("level");p("maxdepth");var g=p("tiling.packing");if(g==="squarify"){p("tiling.squarifyratio")}p("tiling.flip");p("tiling.pad");var y=p("text");p("texttemplate");if(!r.texttemplate)p("textinfo",Array.isArray(y)?"text+label":"label");p("hovertext");p("hovertemplate");var x=p("pathbar.visible");var _="auto";s(t,r,h,p,_,{hasPathbar:x,moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});p("textposition");var b=r.textposition.indexOf("bottom")!==-1;var w=p("marker.line.width");if(w)p("marker.line.color",h.paper_bgcolor);var T=p("marker.colors");var k=r._hasColorscale=c(t,"marker","colors")||(t.marker||{}).coloraxis;if(k){f(t,r,h,p,{prefix:"marker.",cLetter:"c"})}else{p("marker.depthfade",!(T||[]).length)}var A=r.textfont.size*2;p("marker.pad.t",b?A/4:A);p("marker.pad.l",A/4);p("marker.pad.r",A/4);p("marker.pad.b",b?A:A/4);if(k){f(t,r,h,p,{prefix:"marker.",cLetter:"c"})}r._hovered={marker:{line:{width:2,color:i.contrast(h.paper_bgcolor)}}};if(x){p("pathbar.thickness",r.pathbar.textfont.size+2*l);p("pathbar.side");p("pathbar.edgeshape")}p("sort");p("root.color");o(r,h,p);r._length=null}},{"../../components/color":643,"../../components/colorscale":655,"../../lib":778,"../../plots/domain":855,"../bar/constants":923,"../bar/defaults":925,"./attributes":1325}],1330:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=e("../../lib/svg_text_utils");var s=e("./partition");var l=e("./style").styleOne;var u=e("./constants");var c=e("../sunburst/helpers");var f=e("../sunburst/fx");var h=true;t.exports=function e(t,r,p,d,v){var m=v.barDifY;var g=v.width;var y=v.height;var x=v.viewX;var _=v.viewY;var b=v.pathSlice;var w=v.toMoveInsideSlice;var T=v.strTransform;var k=v.hasTransition;var A=v.handleSlicesExit;var M=v.makeUpdateSliceInterpolator;var E=v.makeUpdateTextInterpolator;var S={};var C=t._fullLayout;var L=r[0];var I=L.trace;var O=L.hierarchy;var P=g/I._entryDepth;var D=c.listPath(p.data,"id");var R=s(O.copy(),[g,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();R=R.filter(function(e){var t=D.indexOf(e.data.id);if(t===-1)return false;e.x0=P*t;e.x1=P*(t+1);e.y0=m;e.y1=m+y;e.onPathbar=true;return true});R.reverse();d=d.data(R,c.getPtId);d.enter().append("g").classed("pathbar",true);A(d,h,S,[g,y],b);d.order();var z=d;if(k){z=z.transition().each("end",function(){var e=n.select(this);c.setSliceCursor(e,t,{hideOnRoot:false,hideOnLeaves:false,isTransitioning:false})})}z.each(function(e){e._hoverX=x(e.x1-Math.min(g,y)/2);e._hoverY=_(e.y1-y/2);var s=n.select(this);var d=a.ensureSingle(s,"path","surface",function(e){e.style("pointer-events","all")});if(k){d.transition().attrTween("d",function(e){var t=M(e,h,S,[g,y]);return function(e){return b(t(e))}})}else{d.attr("d",b)}s.call(f,p,t,r,{styleOne:l,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,t,{hideOnRoot:false,hideOnLeaves:false,isTransitioning:t._transitioning});d.call(l,e,I,{hovered:false});e._text=(c.getPtLabel(e)||"").split("<br>").join(" ")||"";var v=a.ensureSingle(s,"g","slicetext");var m=a.ensureSingle(v,"text","",function(e){e.attr("data-notex",1)});var A=a.ensureUniformFontSize(t,c.determineTextFont(I,e,C.font,{onPathbar:true}));m.text(e._text||" ").classed("slicetext",true).attr("text-anchor","start").call(i.font,A).call(o.convertToTspans,t);e.textBB=i.bBox(m.node());e.transform=w(e,{fontSize:A.size,onPathbar:true});e.transform.fontSize=A.size;if(k){m.transition().attrTween("transform",function(e){var t=E(e,h,S,[g,y]);return function(e){return T(t(e))}})}else{m.attr("transform",T(e))}})}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../sunburst/fx":1304,"../sunburst/helpers":1305,"./constants":1328,"./partition":1335,"./style":1337,d3:169}],1331:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=e("../../lib/svg_text_utils");var s=e("./partition");var l=e("./style").styleOne;var u=e("./constants");var c=e("../sunburst/helpers");var f=e("../sunburst/fx");var h=e("../sunburst/plot").formatSliceLabel;var p=false;t.exports=function e(t,r,d,v,m){var g=m.width;var y=m.height;var x=m.viewX;var _=m.viewY;var b=m.pathSlice;var w=m.toMoveInsideSlice;var T=m.strTransform;var k=m.hasTransition;var A=m.handleSlicesExit;var M=m.makeUpdateSliceInterpolator;var E=m.makeUpdateTextInterpolator;var S=m.prevEntry;var C={};var L=t._fullLayout;var I=r[0];var O=I.trace;var P=O.textposition.indexOf("left")!==-1;var D=O.textposition.indexOf("right")!==-1;var R=O.textposition.indexOf("bottom")!==-1;var z=!R&&!O.marker.pad.t||R&&!O.marker.pad.b;var N=s(d,[g,y],{packing:O.tiling.packing,squarifyratio:O.tiling.squarifyratio,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,pad:{inner:O.tiling.pad,top:O.marker.pad.t,left:O.marker.pad.l,right:O.marker.pad.r,bottom:O.marker.pad.b}});var F=N.descendants();var B=Infinity;var j=-Infinity;F.forEach(function(e){var t=e.depth;if(t>=O._maxDepth){e.x0=e.x1=(e.x0+e.x1)/2;e.y0=e.y1=(e.y0+e.y1)/2}else{B=Math.min(B,t);j=Math.max(j,t)}});v=v.data(F,c.getPtId);O._maxVisibleLayers=isFinite(j)?j-B+1:0;v.enter().append("g").classed("slice",true);A(v,p,C,[g,y],b);v.order();var U=null;if(k&&S){var H=c.getPtId(S);v.each(function(e){if(U===null&&c.getPtId(e)===H){U={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}}})}var V=function(){return U||{x0:0,x1:g,y0:0,y1:y}};var G=v;if(k){G=G.transition().each("end",function(){var e=n.select(this);c.setSliceCursor(e,t,{hideOnRoot:true,hideOnLeaves:false,isTransitioning:false})})}G.each(function(e){var s=c.isHeader(e,O);e._hoverX=x(e.x1-O.marker.pad.r),e._hoverY=R?_(e.y1-O.marker.pad.b/2):_(e.y0+O.marker.pad.t/2);var v=n.select(this);var m=a.ensureSingle(v,"path","surface",function(e){e.style("pointer-events","all")});if(k){m.transition().attrTween("d",function(e){var t=M(e,p,V(),[g,y]);return function(e){return b(t(e))}})}else{m.attr("d",b)}v.call(f,d,t,r,{styleOne:l,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,t,{isTransitioning:t._transitioning});m.call(l,e,O,{hovered:false});if(e.x0===e.x1||e.y0===e.y1){e._text=""}else{if(s){e._text=z?"":c.getPtLabel(e)||""}else{e._text=h(e,d,O,r,L)||""}}var A=a.ensureSingle(v,"g","slicetext");var S=a.ensureSingle(A,"text","",function(e){e.attr("data-notex",1)});var C=a.ensureUniformFontSize(t,c.determineTextFont(O,e,L.font));S.text(e._text||" ").classed("slicetext",true).attr("text-anchor",D?"end":P||s?"start":"middle").call(i.font,C).call(o.convertToTspans,t);e.textBB=i.bBox(S.node());e.transform=w(e,{fontSize:C.size,isHeader:s});e.transform.fontSize=C.size;if(k){S.transition().attrTween("transform",function(e){var t=E(e,p,V(),[g,y]);return function(e){return T(t(e))}})}else{S.attr("transform",T(e))}});return U}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../sunburst/fx":1304,"../sunburst/helpers":1305,"../sunburst/plot":1309,"./constants":1328,"./partition":1335,"./style":1337,d3:169}],1332:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"treemap",basePlotModule:e("./base_plot"),categories:[],animatable:true,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1205,"./attributes":1325,"./base_plot":1326,"./calc":1327,"./defaults":1329,"./layout_attributes":1333,"./layout_defaults":1334,"./plot":1336,"./style":1337}],1333:[function(e,t,r){"use strict";t.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1334:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return n.coerce(t,r,a,e,i)}i("treemapcolorway",r.colorway);i("extendtreemapcolors")}},{"../../lib":778,"./layout_attributes":1333}],1335:[function(e,t,r){"use strict";var n=e("d3-hierarchy");t.exports=function e(t,r,o){var s=o.flipX;var l=o.flipY;var u=o.packing==="dice-slice";var c=o.pad[l?"bottom":"top"];var f=o.pad[s?"right":"left"];var h=o.pad[s?"left":"right"];var p=o.pad[l?"top":"bottom"];var d;if(u){d=f;f=c;c=d;d=h;h=p;p=d}var v=n.treemap().tile(a(o.packing,o.squarifyratio)).paddingInner(o.pad.inner).paddingLeft(f).paddingRight(h).paddingTop(c).paddingBottom(p).size(u?[r[1],r[0]]:r)(t);if(u||s||l){i(v,r,{swapXY:u,flipX:s,flipY:l})}return v};function a(e,t){switch(e){case"squarify":return n.treemapSquarify.ratio(t);case"binary":return n.treemapBinary;case"dice":return n.treemapDice;case"slice":return n.treemapSlice;default:return n.treemapSliceDice}}function i(e,t,r){var n;if(r.swapXY){n=e.x0;e.x0=e.y0;e.y0=n;n=e.x1;e.x1=e.y1;e.y1=n}if(r.flipX){n=e.x0;e.x0=t[0]-e.x1;e.x1=t[0]-n}if(r.flipY){n=e.y0;e.y0=t[1]-e.y1;e.y1=t[1]-n}var a=e.children;if(a){for(var o=0;o<a.length;o++){i(a[o],t,r)}}}},{"d3-hierarchy":161}],1336:[function(e,t,r){"use strict";var n=e("d3");var a=e("../sunburst/helpers");var i=e("../../lib");var o=e("../bar/constants").TEXTPAD;var s=e("../bar/plot");var l=s.toMoveInsideBar;var u=e("../bar/uniform_text");var c=u.recordMinTextSize;var f=u.clearMinTextSize;var h=e("../bar/style").resizeText;var p=e("./constants");var d=e("./draw_descendants");var v=e("./draw_ancestors");t.exports=function(e,t,r,i){var o=e._fullLayout;var s=o._treemaplayer;var l,u;var c=!r;f("treemap",o);l=s.selectAll("g.trace.treemap").data(t,function(e){return e[0].trace.uid});l.enter().append("g").classed("trace",true).classed("treemap",true);l.order();if(!o.uniformtext.mode&&a.hasTransition(r)){if(i){u=i()}var p=n.transition().duration(r.duration).ease(r.easing).each("end",function(){u&&u()}).each("interrupt",function(){u&&u()});p.each(function(){s.selectAll("g.trace").each(function(t){g(e,t,this,r)})})}else{l.each(function(t){g(e,t,this,r)});if(o.uniformtext.mode){h(e,o._treemaplayer.selectAll(".trace"),"treemap")}}if(c){l.exit().remove()}};function m(e){return a.isHierarchyRoot(e)?"":a.getPtId(e)}function g(e,t,r,s){var u=e._fullLayout;var f=t[0];var h=f.trace;var g=f.hierarchy;var y=a.findEntryWithLevel(g,h.level);var x=n.select(r);var _=x.selectAll("g.pathbar");var b=x.selectAll("g.slice");if(!y){_.remove();b.remove();return}var w=a.isHierarchyRoot(y);var T=!u.uniformtext.mode&&a.hasTransition(s);var k=a.getMaxDepth(h);var A=function(e){return e.data.depth-y.data.depth<k};var M=u._size;var E=h.domain;var S=M.w*(E.x[1]-E.x[0]);var C=M.h*(E.y[1]-E.y[0]);var L=S;var I=h.pathbar.thickness;var O=h.marker.line.width+p.gapWithPathbar;var P=!h.pathbar.visible?0:h.pathbar.side.indexOf("bottom")>-1?C+O:-(I+O);var D={x0:L,x1:L,y0:P,y1:P+I};var R=function(e,t,r){var n=h.tiling.pad;var a=function(e){return e-n<=t.x0};var i=function(e){return e+n>=t.x1};var o=function(e){return e-n<=t.y0};var s=function(e){return e+n>=t.y1};return{x0:a(e.x0-n)?0:i(e.x0-n)?r[0]:e.x0,x1:a(e.x1+n)?0:i(e.x1+n)?r[0]:e.x1,y0:o(e.y0-n)?0:s(e.y0-n)?r[1]:e.y0,y1:o(e.y1+n)?0:s(e.y1+n)?r[1]:e.y1}};var z=null;var N={};var F={};var B=null;var j=function(e,t){return t?N[m(e)]:F[m(e)]};var U=function(e,t,r,n){if(t){return N[m(g)]||D}else{var a=F[h.level]||r;if(A(e)){return R(e,a,n)}}return{}};if(f.hasMultipleRoots&&w){k++}h._maxDepth=k;h._backgroundColor=u.paper_bgcolor;h._entryDepth=y.data.depth;h._atRootLevel=w;var H=-S/2+M.l+M.w*(E.x[1]+E.x[0])/2;var V=-C/2+M.t+M.h*(1-(E.y[1]+E.y[0])/2);var G=function(e){return H+e};var q=function(e){return V+e};var Y=q(0);var W=G(0);var X=function(e){return W+e};var Z=function(e){return Y+e};function K(e,t){return e+","+t}var J=X(0);var Q=function(e){e.x=Math.max(J,e.x)};var $=h.pathbar.edgeshape;var ee=function(e){var t=X(Math.max(Math.min(e.x0,e.x0),0));var r=X(Math.min(Math.max(e.x1,e.x1),L));var n=Z(e.y0);var a=Z(e.y1);var i=I/2;var o={};var s={};o.x=t;s.x=r;o.y=s.y=(n+a)/2;var l={x:t,y:n};var u={x:r,y:n};var c={x:r,y:a};var f={x:t,y:a};if($===">"){l.x-=i;u.x-=i;c.x-=i;f.x-=i}else if($==="/"){c.x-=i;f.x-=i;o.x-=i/2;s.x-=i/2}else if($==="\\"){l.x-=i;u.x-=i;o.x-=i/2;s.x-=i/2}else if($==="<"){o.x-=i;s.x-=i}Q(l);Q(f);Q(o);Q(u);Q(c);Q(s);return"M"+K(l.x,l.y)+"L"+K(u.x,u.y)+"L"+K(s.x,s.y)+"L"+K(c.x,c.y)+"L"+K(f.x,f.y)+"L"+K(o.x,o.y)+"Z"};var te=function(e){var t=G(e.x0);var r=G(e.x1);var n=q(e.y0);var a=q(e.y1);var i=r-t;var o=a-n;if(!i||!o)return"";var s=0;var l=i>2*s&&o>2*s?s:0;var u=function(e,t){return l?"a"+K(l,l)+" 0 0 1 "+K(e,t):""};return"M"+K(t,n+l)+u(l,-l)+"L"+K(r-l,n)+u(l,l)+"L"+K(r,a-l)+u(-l,l)+"L"+K(t+l,a)+u(-l,-l)+"Z"};var re=function(e,t){var r=e.x0;var n=e.x1;var a=e.y0;var i=e.y1;var s=e.textBB;var f=function(e){return h.textposition.indexOf(e)!==-1};var p=f("bottom");var d=f("top")||t.isHeader&&!p;var v=d?"start":p?"end":"middle";var m=f("right");var g=f("left")||t.onPathbar;var y=g?-1:m?1:0;var x=h.marker.pad;if(t.isHeader){r+=x.l-o;n-=x.r-o;if(r>=n){var _=(r+n)/2;r=_;n=_}var b;if(p){b=i-x.b;if(a<b&&b<i)a=b}else{b=a+x.t;if(a<b&&b<i)i=b}}var w=l(r,n,a,i,s,{isHorizontal:false,constrained:true,angle:0,anchor:v,leftToRight:y});w.fontSize=t.fontSize;w.targetX=G(w.targetX);w.targetY=q(w.targetY);if(isNaN(w.targetX)||isNaN(w.targetY)){return{}}if(r!==n&&a!==i){c(h.type,w,u)}return{scale:w.scale,rotate:w.rotate,textX:w.textX,textY:w.textY,anchorX:w.anchorX,anchorY:w.anchorY,targetX:w.targetX,targetY:w.targetY}};var ne=function(e,t){var r;var n=0;var a=e;while(!r&&n<k){n++;a=a.parent;if(a){r=j(a,t)}else n=k}return r||{}};var ae=function(e,t,r,a){var i=j(e,t);var o;if(t){o=D}else{var s=j(y,t);if(s){o=R(e,s,a)}else{o={}}}return n.interpolate(i,o)};var ie=function(e,t,r,a){var o=j(e,t);var s;if(o){s=o}else{if(t){s=D}else{if(z){if(e.parent){var l=B||r;if(l&&!t){s=R(e,l,a)}else{s={};i.extendFlat(s,ne(e,t))}}else{s=e}}else{s={}}}}return n.interpolate(s,{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1})};var oe=function(e,t,r,o){var s=j(e,t);var l={};var f=U(e,t,r,o);i.extendFlat(l,{transform:re({x0:f.x0,x1:f.x1,y0:f.y0,y1:f.y1,textBB:e.textBB,_text:e._text},{isHeader:a.isHeader(e,h)})});if(s){l=s}else{if(e.parent){i.extendFlat(l,ne(e,t))}}var p=e.transform;if(e.x0!==e.x1&&e.y0!==e.y1){c(h.type,p,u)}return n.interpolate(l,{transform:{scale:p.scale,rotate:p.rotate,textX:p.textX,textY:p.textY,anchorX:p.anchorX,anchorY:p.anchorY,targetX:p.targetX,targetY:p.targetY}})};var se=function(e,t,r,a,i){var o=a[0];var s=a[1];if(T){e.exit().transition().each(function(){var e=n.select(this);var a=e.select("path.surface");a.transition().attrTween("d",function(e){var n=ae(e,t,r,[o,s]);return function(e){return i(n(e))}});var l=e.select("g.slicetext");l.attr("opacity",0)}).remove()}else{e.exit().remove()}};var le=function(e){var t=e.transform;if(e.x0!==e.x1&&e.y0!==e.y1){c(h.type,t,u)}return i.getTextTransform({textX:t.textX,textY:t.textY,anchorX:t.anchorX,anchorY:t.anchorY,targetX:t.targetX,targetY:t.targetY,scale:t.scale,rotate:t.rotate})};if(T){_.each(function(e){N[m(e)]={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1};if(e.transform){N[m(e)].transform={textX:e.transform.textX,textY:e.transform.textY,anchorX:e.transform.anchorX,anchorY:e.transform.anchorY,targetX:e.transform.targetX,targetY:e.transform.targetY,scale:e.transform.scale,rotate:e.transform.rotate}}});b.each(function(e){F[m(e)]={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1};if(e.transform){F[m(e)].transform={textX:e.transform.textX,textY:e.transform.textY,anchorX:e.transform.anchorX,anchorY:e.transform.anchorY,targetX:e.transform.targetX,targetY:e.transform.targetY,scale:e.transform.scale,rotate:e.transform.rotate}}if(!z&&a.isEntry(e)){z=e}})}B=d(e,t,y,b,{width:S,height:C,viewX:G,viewY:q,pathSlice:te,toMoveInsideSlice:re,prevEntry:z,makeUpdateSliceInterpolator:ie,makeUpdateTextInterpolator:oe,handleSlicesExit:se,hasTransition:T,strTransform:le});if(h.pathbar.visible){v(e,t,y,_,{barDifY:P,width:L,height:I,viewX:X,viewY:Z,pathSlice:ee,toMoveInsideSlice:re,makeUpdateSliceInterpolator:ie,makeUpdateTextInterpolator:oe,handleSlicesExit:se,hasTransition:T,strTransform:le})}else{_.remove()}}},{"../../lib":778,"../bar/constants":923,"../bar/plot":932,"../bar/style":935,"../bar/uniform_text":937,"../sunburst/helpers":1305,"./constants":1328,"./draw_ancestors":1330,"./draw_descendants":1331,d3:169}],1337:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/color");var i=e("../../lib");var o=e("../sunburst/helpers");var s=e("../bar/uniform_text").resizeText;function l(e){var t=e._fullLayout._treemaplayer.selectAll(".trace");s(e,t,"treemap");t.each(function(e){var t=n.select(this);var r=e[0];var a=r.trace;t.style("opacity",a.opacity);t.selectAll("path.surface").each(function(e){n.select(this).call(u,e,a,{hovered:false})})})}function u(e,t,r,n){var s=(n||{}).hovered;var l=t.data.data;var u=l.i;var c;var f;var h=l.color;var p=o.isHierarchyRoot(t);var d=1;if(s){c=r._hovered.marker.line.color;f=r._hovered.marker.line.width}else{if(p&&h===r.root.color){d=100;c="rgba(0,0,0,0)";f=0}else{c=i.castOption(r,u,"marker.line.color")||a.defaultLine;f=i.castOption(r,u,"marker.line.width")||0;if(!r._hasColorscale&&!t.onPathbar){var v=r.marker.depthfade;if(v){var m=a.combine(a.addOpacity(r._backgroundColor,.75),h);var g;if(v===true){var y=o.getMaxDepth(r);if(isFinite(y)){if(o.isLeaf(t)){g=0}else{g=r._maxVisibleLayers-(t.data.depth-r._entryDepth)}}else{g=t.data.height+1}}else{g=t.data.depth-r._entryDepth;if(!r._atRootLevel)g++}if(g>0){for(var x=0;x<g;x++){var _=.5*x/g;h=a.combine(a.addOpacity(m,_),h)}}}}}}e.style("stroke-width",f).call(a.fill,h).call(a.stroke,c).style("opacity",d)}t.exports={style:l,styleOne:u}},{"../../components/color":643,"../../lib":778,"../bar/uniform_text":937,"../sunburst/helpers":1305,d3:169}],1338:[function(e,t,r){"use strict";var n=e("../box/attributes");var a=e("../../lib/extend").extendFlat;t.exports={y:n.y,x:n.x,x0:n.x0,y0:n.y0,name:a({},n.name,{}),orientation:a({},n.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:n.fillcolor,points:a({},n.boxpoints,{}),jitter:a({},n.jitter,{}),pointpos:a({},n.pointpos,{}),width:a({},n.width,{}),marker:n.marker,text:n.text,hovertext:n.hovertext,hovertemplate:n.hovertemplate,box:{visible:{valType:"boolean",dflt:false,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:false,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:n.offsetgroup,alignmentgroup:n.alignmentgroup,selected:n.selected,unselected:n.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":768,"../box/attributes":946}],1339:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../box/calc");var o=e("./helpers");var s=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var s=i(t,r);if(s[0].t.empty)return s;var l=t._fullLayout;var f=a.getFromId(t,r[r.orientation==="h"?"xaxis":"yaxis"]);var h=Infinity;var p=-Infinity;var d=0;var v=0;for(var m=0;m<s.length;m++){var g=s[m];var y=g.pts.map(o.extractVal);var x=g.bandwidth=u(r,g,y);var _=g.span=c(r,g,f,x);if(g.min===g.max&&x===0){_=g.span=[g.min,g.max];g.density=[{v:1,t:_[0]}];g.bandwidth=x;d=Math.max(d,1)}else{var b=_[1]-_[0];var w=Math.ceil(b/(x/3));var T=b/w;if(!isFinite(T)||!isFinite(w)){n.error("Something went wrong with computing the violin span");s[0].t.empty=true;return s}var k=o.makeKDE(g,r,y);g.density=new Array(w);for(var A=0,M=_[0];M<_[1]+T/2;A++,M+=T){var E=k(M);g.density[A]={v:E,t:M};d=Math.max(d,E)}}v=Math.max(v,y.length);h=Math.min(h,_[0]);p=Math.max(p,_[1])}var S=a.findExtremes(f,[h,p],{padded:true});r._extremes[f._id]=S;if(r.width){s[0].t.maxKDE=d}else{var C=l._violinScaleGroupStats;var L=r.scalegroup;var I=C[L];if(I){I.maxKDE=Math.max(I.maxKDE,d);I.maxCount=Math.max(I.maxCount,v)}else{C[L]={maxKDE:d,maxCount:v}}}s[0].t.labels.kde=n._(t,"kde:");return s};function l(e,t,r){var n=Math.min(t,r/1.349);return 1.059*n*Math.pow(e,-.2)}function u(e,t,r){var a=t.max-t.min;if(!a){if(e.bandwidth){return e.bandwidth}else{return 0}}if(e.bandwidth){return Math.max(e.bandwidth,a/1e4)}else{var i=r.length;var o=n.stdev(r,i-1,t.mean);return Math.max(l(i,o,t.q3-t.q1),a/100)}}function c(e,t,r,n){var i=e.spanmode;var o=e.span||[];var l=[t.min,t.max];var u=[t.min-2*n,t.max+2*n];var c;function f(n){var a=o[n];var i=r.type==="multicategory"?r.r2c(a):r.d2c(a,0,e[t.valLetter+"calendar"]);return i===s?u[n]:i}if(i==="soft"){c=u}else if(i==="hard"){c=l}else{c=[f(0),f(1)]}var h={type:"linear",range:c};a.setConvert(h);h.cleanRange();return c}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../box/calc":947,"./helpers":1342}],1340:[function(e,t,r){"use strict";var n=e("../box/cross_trace_calc").setPositionOffset;var a=["v","h"];t.exports=function e(t,r){var i=t.calcdata;var o=r.xaxis;var s=r.yaxis;for(var l=0;l<a.length;l++){var u=a[l];var c=u==="h"?s:o;var f=[];for(var h=0;h<i.length;h++){var p=i[h];var d=p[0].t;var v=p[0].trace;if(v.visible===true&&v.type==="violin"&&!d.empty&&v.orientation===u&&v.xaxis===o._id&&v.yaxis===s._id){f.push(h)}}n("violin",t,f,c)}}},{"../box/cross_trace_calc":948}],1341:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../components/color");var i=e("../box/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,a){return n.coerce(t,r,o,e,a)}function c(e,a){return n.coerce2(t,r,o,e,a)}i.handleSampleDefaults(t,r,u,l);if(r.visible===false)return;u("bandwidth");u("side");var f=u("width");if(!f){u("scalegroup",r.name);u("scalemode")}var h=u("span");var p;if(Array.isArray(h))p="manual";u("spanmode",p);var d=u("line.color",(t.marker||{}).color||s);var v=u("line.width");var m=u("fillcolor",a.addOpacity(r.line.color,.5));i.handlePointsDefaults(t,r,u,{prefix:""});var g=c("box.width");var y=c("box.fillcolor",m);var x=c("box.line.color",d);var _=c("box.line.width",v);var b=u("box.visible",Boolean(g||y||x||_));if(!b)r.box={visible:false};var w=c("meanline.color",d);var T=c("meanline.width",v);var k=u("meanline.visible",Boolean(w||T));if(!k)r.meanline={visible:false}}},{"../../components/color":643,"../../lib":778,"../box/defaults":949,"./attributes":1338}],1342:[function(e,t,r){"use strict";var n=e("../../lib");var a={gaussian:function(e){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*e*e)}};r.makeKDE=function(e,t,r){var n=r.length;var i=a.gaussian;var o=e.bandwidth;var s=1/(n*o);return function(e){var t=0;for(var a=0;a<n;a++){t+=i((e-r[a])/o)}return s*t}};r.getPositionOnKdePath=function(e,t,r){var a,i;if(t.orientation==="h"){a="y";i="x"}else{a="x";i="y"}var o=n.findPointOnPath(e.path,r,i,{pathLength:e.pathLength});var s=e.posCenterPx;var l=o[a];var u=t.side==="both"?2*s-l:s;return[l,u]};r.getKdeValue=function(e,t,n){var a=e.pts.map(r.extractVal);var i=r.makeKDE(e,t,a);return i(n)/e.posDensityScale};r.extractVal=function(e){return e.v}},{"../../lib":778}],1343:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../../plots/cartesian/axes");var i=e("../box/hover");var o=e("./helpers");t.exports=function e(t,r,s,l,u){var c=t.cd;var f=c[0].trace;var h=f.hoveron;var p=h.indexOf("violins")!==-1;var d=h.indexOf("kde")!==-1;var v=[];var m;var g;if(p||d){var y=i.hoverOnBoxes(t,r,s,l);if(d&&y.length>0){var x=t.xa;var _=t.ya;var b,w,T,k,A;if(f.orientation==="h"){A=r;b="y";T=_;w="x";k=x}else{A=s;b="x";T=x;w="y";k=_}var M=c[t.index];if(A>=M.span[0]&&A<=M.span[1]){var E=n.extendFlat({},t);var S=k.c2p(A,true);var C=o.getKdeValue(M,f,A);var L=o.getPositionOnKdePath(M,f,S);var I=T._offset;var O=T._length;E[b+"0"]=L[0];E[b+"1"]=L[1];E[w+"0"]=E[w+"1"]=S;E[w+"Label"]=w+": "+a.hoverLabelText(k,A)+", "+c[0].t.labels.kde+" "+C.toFixed(3);E.spikeDistance=y[0].spikeDistance;var P=b+"Spike";E[P]=y[0][P];y[0].spikeDistance=undefined;y[0][P]=undefined;E.hovertemplate=false;v.push(E);g={stroke:t.color};g[b+"1"]=n.constrain(I+L[0],I,I+O);g[b+"2"]=n.constrain(I+L[1],I,I+O);g[w+"1"]=g[w+"2"]=k._offset+S}}if(p){v=v.concat(y)}}if(h.indexOf("points")!==-1){m=i.hoverOnPoints(t,r,s)}var D=u.selectAll(".violinline-"+f.uid).data(g?[0]:[]);D.enter().append("line").classed("violinline-"+f.uid,true).attr("stroke-width",1.5);D.exit().remove();D.attr(g);if(l==="closest"){if(m)return[m];return v}if(m){v.push(m);return v}return v}},{"../../lib":778,"../../plots/cartesian/axes":828,"../box/hover":951,"./helpers":1342}],1344:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../box/select"),moduleType:"trace",name:"violin",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../box/defaults":949,"../box/select":956,"../scatter/style":1211,"./attributes":1338,"./calc":1339,"./cross_trace_calc":1340,"./defaults":1341,"./hover":1343,"./layout_attributes":1345,"./layout_defaults":1346,"./plot":1347,"./style":1348}],1345:[function(e,t,r){"use strict";var n=e("../box/layout_attributes");var a=e("../../lib").extendFlat;t.exports={violinmode:a({},n.boxmode,{}),violingap:a({},n.boxgap,{}),violingroupgap:a({},n.boxgroupgap,{})}},{"../../lib":778,"../box/layout_attributes":953}],1346:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");var i=e("../box/layout_defaults");t.exports=function e(t,r,o){function s(e,i){return n.coerce(t,r,a,e,i)}i._supply(t,r,o,s,"violin")}},{"../../lib":778,"../box/layout_defaults":954,"./layout_attributes":1345}],1347:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=e("../box/plot");var s=e("../scatter/line_points");var l=e("./helpers");t.exports=function e(t,r,u,c){var f=t._fullLayout;var h=r.xaxis;var p=r.yaxis;function d(e){var t=s(e,{xaxis:h,yaxis:p,connectGaps:true,baseTolerance:.75,shape:"spline",simplify:true,linearized:true});return i.smoothopen(t[0],1)}a.makeTraceGroups(c,u,"trace violins").each(function(e){var t=n.select(this);var i=e[0];var s=i.t;var u=i.trace;if(u.visible!==true||s.empty){t.remove();return}var c=s.bPos;var v=s.bdPos;var m=r[s.valLetter+"axis"];var g=r[s.posLetter+"axis"];var y=u.side==="both";var x=y||u.side==="positive";var _=y||u.side==="negative";var b=t.selectAll("path.violin").data(a.identity);b.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin");b.exit().remove();b.each(function(e){var t=n.select(this);var r=e.density;var a=r.length;var i=g.c2l(e.pos+c,true);var o=g.l2p(i);var l;if(u.width){l=s.maxKDE/v}else{var h=f._violinScaleGroupStats[u.scalegroup];l=u.scalemode==="count"?h.maxKDE/v*(h.maxCount/e.pts.length):h.maxKDE/v}var p,b,w;var T,k,A,M;if(x){A=new Array(a);for(T=0;T<a;T++){M=A[T]={};M[s.posLetter]=i+r[T].v/l;M[s.valLetter]=m.c2l(r[T].t,true)}p=d(A)}if(_){A=new Array(a);for(k=0,T=a-1;k<a;k++,T--){M=A[k]={};M[s.posLetter]=i-r[T].v/l;M[s.valLetter]=m.c2l(r[T].t,true)}b=d(A)}if(y){w=p+"L"+b.substr(1)+"Z"}else{var E=[o,m.c2p(r[0].t)];var S=[o,m.c2p(r[a-1].t)];if(u.orientation==="h"){E.reverse();S.reverse()}if(x){w="M"+E+"L"+p.substr(1)+"L"+S}else{w="M"+S+"L"+b.substr(1)+"L"+E}}t.attr("d",w);e.posCenterPx=o;e.posDensityScale=l*v;e.path=t.node();e.pathLength=e.path.getTotalLength()/(y?2:1)});var w=u.box;var T=w.width;var k=(w.line||{}).width;var A;var M;if(y){A=v*T;M=0}else if(x){A=[0,v*T/2];M=k*{x:1,y:-1}[s.posLetter]}else{A=[v*T/2,0];M=k*{x:-1,y:1}[s.posLetter]}o.plotBoxAndWhiskers(t,{pos:g,val:m},u,{bPos:c,bdPos:A,bPosPxOffset:M});o.plotBoxMean(t,{pos:g,val:m},u,{bPos:c,bdPos:A,bPosPxOffset:M});var E;if(!u.box.visible&&u.meanline.visible){E=a.identity}var S=t.selectAll("path.meanline").data(E||[]);S.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke");S.exit().remove();S.each(function(e){var t=m.c2p(e.mean,true);var r=l.getPositionOnKdePath(e,u,t);n.select(this).attr("d",u.orientation==="h"?"M"+t+","+r[0]+"V"+r[1]:"M"+r[0]+","+t+"H"+r[1])});o.plotPoints(t,{x:h,y:p},u,s)})}},{"../../components/drawing":665,"../../lib":778,"../box/plot":955,"../scatter/line_points":1201,"./helpers":1342,d3:169}],1348:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/color");var i=e("../scatter/style").stylePoints;t.exports=function e(t){var r=n.select(t).selectAll("g.trace.violins");r.style("opacity",function(e){return e[0].trace.opacity});r.each(function(e){var r=e[0].trace;var o=n.select(this);var s=r.box||{};var l=s.line||{};var u=r.meanline||{};var c=u.width;o.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(a.stroke,r.line.color).call(a.fill,r.fillcolor);o.selectAll("path.box").style("stroke-width",l.width+"px").call(a.stroke,l.color).call(a.fill,s.fillcolor);var f={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};o.selectAll("path.mean").style(f).call(a.stroke,u.color);o.selectAll("path.meanline").style(f).call(a.stroke,u.color);i(o,r,t)})}},{"../../components/color":643,"../scatter/style":1211,d3:169}],1349:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var a=e("../isosurface/attributes");var i=e("../surface/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/edit_types").overrideAll;var u=t.exports=l(s({x:a.x,y:a.y,z:a.z,value:a.value,isomin:a.isomin,isomax:a.isomax,surface:a.surface,spaceframe:{show:{valType:"boolean",dflt:false},fill:{valType:"number",min:0,max:1,dflt:1}},slices:a.slices,caps:a.caps,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate},n("",{colorAttr:"`value`",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:a.colorbar,opacity:a.opacity,opacityscale:i.opacityscale,lightposition:a.lightposition,lighting:a.lighting,flatshading:a.flatshading,contour:a.contour,hoverinfo:s({},o.hoverinfo),showlegend:s({},o.showlegend,{dflt:false})}),"calc","nested");u.x.editType=u.y.editType=u.z.editType=u.value.editType="calc+clearAxisTypes";u.transforms=undefined},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../isosurface/attributes":1123,"../surface/attributes":1311}],1350:[function(e,t,r){"use strict";var n=e("gl-mesh3d");var a=e("../../lib/gl_format_color").parseColorScale;var i=e("../../lib/str2rgbarray");var o=e("../../components/colorscale").extractOpts;var s=e("../../plots/gl3d/zip3");var l=e("../isosurface/convert").findNearestOnAxis;var u=e("../isosurface/convert").generateIsoMeshes;function c(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.data=null;this.showContour=false}var f=c.prototype;f.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index;var r=this.data._meshX[t];var n=this.data._meshY[t];var a=this.data._meshZ[t];var i=this.data._Ys.length;var o=this.data._Zs.length;var s=l(r,this.data._Xs).id;var u=l(n,this.data._Ys).id;var c=l(a,this.data._Zs).id;var f=e.index=c+o*u+o*i*s;e.traceCoordinate=[this.data._meshX[f],this.data._meshY[f],this.data._meshZ[f],this.data._value[f]];var h=this.data.hovertext||this.data.text;if(Array.isArray(h)&&h[f]!==undefined){e.textLabel=h[f]}else if(h){e.textLabel=h}return true}};f.update=function(e){var t=this.scene;var r=t.fullSceneLayout;this.data=u(e);function n(e,t,r,n){return t.map(function(t){return e.d2l(t,0,n)*r})}var l=s(n(r.xaxis,e._meshX,t.dataScale[0],e.xcalendar),n(r.yaxis,e._meshY,t.dataScale[1],e.ycalendar),n(r.zaxis,e._meshZ,t.dataScale[2],e.zcalendar));var c=s(e._meshI,e._meshJ,e._meshK);var f={positions:l,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,opacityscale:e.opacityscale,contourEnable:e.contour.show,contourColor:i(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};var h=o(e);f.vertexIntensity=e._meshIntensity;f.vertexIntensityBounds=[h.min,h.max];f.colormap=a(e);this.mesh.update(f)};f.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function h(e,t){var r=e.glplot.gl;var a=n({gl:r});var i=new c(e,a,t.uid);a._trace=i;i.update(t);e.glplot.add(a);return i}t.exports=h},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"../isosurface/convert":1125,"gl-mesh3d":309}],1351:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./attributes");var i=e("../isosurface/defaults").supplyIsoDefaults;var o=e("../surface/defaults").opacityscaleDefaults;t.exports=function e(t,r,s,l){function u(e,i){return n.coerce(t,r,a,e,i)}i(t,r,s,l,u);o(t,r,l,u)}},{"../../lib":778,"../isosurface/defaults":1126,"../surface/defaults":1314,"./attributes":1349}],1352:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"volume",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"../isosurface/calc":1124,"./attributes":1349,"./convert":1350,"./defaults":1351}],1353:[function(e,t,r){"use strict";var n=e("../bar/attributes");var a=e("../scatter/attributes").line;var i=e("../../plots/attributes");var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../plots/template_attributes").texttemplateAttrs;var l=e("./constants");var u=e("../../lib/extend").extendFlat;var c=e("../../components/color");function f(e){return{marker:{color:u({},n.marker.color,{arrayOk:false,editType:"style"}),line:{color:u({},n.marker.line.color,{arrayOk:false,editType:"style"}),width:u({},n.marker.line.width,{arrayOk:false,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}t.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:false,editType:"calc"},x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,hovertext:n.hovertext,hovertemplate:o({},{keys:l.eventDataKeys}),hoverinfo:u({},i.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:false},texttemplate:s({editType:"plot"},{keys:l.eventDataKeys.concat(["label"])}),text:n.text,textposition:n.textposition,insidetextanchor:n.insidetextanchor,textangle:n.textangle,textfont:n.textfont,insidetextfont:n.insidetextfont,outsidetextfont:n.outsidetextfont,constraintext:n.constraintext,cliponaxis:n.cliponaxis,orientation:n.orientation,offset:n.offset,width:n.width,increasing:f("increasing"),decreasing:f("decreasing"),totals:f("intermediate sums and total"),connector:{line:{color:u({},a.color,{dflt:c.defaultLine}),width:u({},a.width,{editType:"plot"}),dash:a.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},offsetgroup:n.offsetgroup,alignmentgroup:n.alignmentgroup}},{"../../components/color":643,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187,"./constants":1355}],1354:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes");var a=e("../../plots/cartesian/align_period");var i=e("../../lib").mergeArray;var o=e("../scatter/calc_selection");var s=e("../../constants/numerical").BADNUM;function l(e){return e==="a"||e==="absolute"}function u(e){return e==="t"||e==="total"}t.exports=function e(t,r){var c=n.getFromId(t,r.xaxis||"x");var f=n.getFromId(t,r.yaxis||"y");var h,p,d;var v;if(r.orientation==="h"){h=c.makeCalcdata(r,"x");d=f.makeCalcdata(r,"y");p=a(r,f,"y",d);v=!!r.yperiodalignment}else{h=f.makeCalcdata(r,"y");d=c.makeCalcdata(r,"x");p=a(r,c,"x",d);v=!!r.xperiodalignment}var m=Math.min(p.length,h.length);var g=new Array(m);var y=0;var x;var _=false;for(var b=0;b<m;b++){var w=h[b]||0;var T=false;if(h[b]!==s||u(r.measure[b])||l(r.measure[b])){if(b+1<m&&(h[b+1]!==s||u(r.measure[b+1])||l(r.measure[b+1]))){T=true}}var k=g[b]={i:b,p:p[b],s:w,rawS:w,cNext:T};if(l(r.measure[b])){y=k.s;k.isSum=true;k.dir="totals";k.s=y}else if(u(r.measure[b])){k.isSum=true;k.dir="totals";k.s=y}else{k.isSum=false;k.dir=k.rawS<0?"decreasing":"increasing";x=k.s;k.s=y+x;y+=x}if(k.dir==="totals"){_=true}if(v){g[b].orig_p=d[b]}if(r.ids){k.id=String(r.ids[b])}k.v=(r.base||0)+y}if(g.length)g[0].hasTotals=_;i(r.text,g,"tx");i(r.hovertext,g,"htx");o(g,r);return g}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189}],1355:[function(e,t,r){"use strict";t.exports={eventDataKeys:["initial","delta","final"]}},{}],1356:[function(e,t,r){"use strict";var n=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function e(t,r){var a=t._fullLayout;var i=t._fullData;var o=t.calcdata;var s=r.xaxis;var l=r.yaxis;var u=[];var c=[];var f=[];var h,p;for(p=0;p<i.length;p++){var d=i[p];if(d.visible===true&&d.xaxis===s._id&&d.yaxis===l._id&&d.type==="waterfall"){h=o[p];if(d.orientation==="h"){f.push(h)}else{c.push(h)}u.push(h)}}var v={mode:a.waterfallmode,norm:a.waterfallnorm,gap:a.waterfallgap,groupgap:a.waterfallgroupgap};n(t,s,l,c,v);n(t,l,s,f,v);for(p=0;p<u.length;p++){h=u[p];for(var m=0;m<h.length;m++){var g=h[m];if(g.isSum===false){g.s0+=m===0?0:h[m-1].s}if(m+1<h.length){h[m].nextP0=h[m+1].p0;h[m].nextS0=h[m+1].s0}}}}},{"../bar/cross_trace_calc":924}],1357:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("../bar/defaults").handleGroupingDefaults;var i=e("../bar/defaults").handleText;var o=e("../scatter/xy_defaults");var s=e("../scatter/period_defaults");var l=e("./attributes");var u=e("../../components/color");var c=e("../../constants/delta.js");var f=c.INCREASING.COLOR;var h=c.DECREASING.COLOR;var p="#4499FF";function d(e,t,r){e(t+".marker.color",r);e(t+".marker.line.color",u.defaultLine);e(t+".marker.line.width")}function v(e,t,r,a){function u(r,a){return n.coerce(e,t,l,r,a)}var c=o(e,t,a,u);if(!c){t.visible=false;return}s(e,t,a,u);u("measure");u("orientation",t.x&&!t.y?"h":"v");u("base");u("offset");u("width");u("text");u("hovertext");u("hovertemplate");var v=u("textposition");i(e,t,a,u,v,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:true,moduleHasCliponaxis:true,moduleHasTextangle:true,moduleHasInsideanchor:true});if(t.textposition!=="none"){u("texttemplate");if(!t.texttemplate)u("textinfo")}d(u,"increasing",f);d(u,"decreasing",h);d(u,"totals",p);var m=u("connector.visible");if(m){u("connector.mode");var g=u("connector.line.width");if(g){u("connector.line.color");u("connector.line.dash")}}}function m(e,t){var r,i;function o(e){return n.coerce(i._input,i,l,e)}if(t.waterfallmode==="group"){for(var s=0;s<e.length;s++){i=e[s];r=i._input;a(r,i,t,o)}}}t.exports={supplyDefaults:v,crossTraceDefaults:m}},{"../../components/color":643,"../../constants/delta.js":747,"../../lib":778,"../bar/defaults":925,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":1353}],1358:[function(e,t,r){"use strict";t.exports=function e(t,r){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if("initial"in r)t.initial=r.initial;if("delta"in r)t.delta=r.delta;if("final"in r)t.final=r.final;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;return t}},{}],1359:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axes").hoverLabelText;var a=e("../../components/color").opacity;var i=e("../bar/hover").hoverOnBars;var o=e("../../constants/delta.js");var s={increasing:o.INCREASING.SYMBOL,decreasing:o.DECREASING.SYMBOL};t.exports=function e(t,r,a,o){var u=i(t,r,a,o);if(!u)return;var c=u.cd;var f=c[0].trace;var h=f.orientation==="h";var p=h?t.xa:t.ya;function d(e){return n(p,e)}var v=u.index;var m=c[v];var g=m.isSum?m.b+m.s:m.rawS;if(!m.isSum){u.initial=m.b+m.s-g;u.delta=g;u.final=u.initial+u.delta;var y=d(Math.abs(u.delta));u.deltaLabel=g<0?"("+y+")":y;u.finalLabel=d(u.final);u.initialLabel=d(u.initial)}var x=m.hi||f.hoverinfo;var _=[];if(x&&x!=="none"&&x!=="skip"){var b=x==="all";var w=x.split("+");var T=function(e){return b||w.indexOf(e)!==-1};if(!m.isSum){if(T("final")&&(h?!T("x"):!T("y"))){_.push(u.finalLabel)}if(T("delta")){if(g<0){_.push(u.deltaLabel+" "+s.decreasing)}else{_.push(u.deltaLabel+" "+s.increasing)}}if(T("initial")){_.push("Initial: "+u.initialLabel)}}}if(_.length)u.extraText=_.join("<br>");u.color=l(f,m);return[u]};function l(e,t){var r=e[t.dir].marker;var n=r.color;var i=r.line.color;var o=r.line.width;if(a(n))return n;else if(a(i)&&o)return i}},{"../../components/color":643,"../../constants/delta.js":747,"../../plots/cartesian/axes":828,"../bar/hover":928}],1360:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../bar/select":933,"./attributes":1353,"./calc":1354,"./cross_trace_calc":1356,"./defaults":1357,"./event_data":1358,"./hover":1359,"./layout_attributes":1361,"./layout_defaults":1362,"./plot":1363,"./style":1364}],1361:[function(e,t,r){"use strict";t.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1362:[function(e,t,r){"use strict";var n=e("../../lib");var a=e("./layout_attributes");t.exports=function(e,t,r){var i=false;function o(r,i){return n.coerce(e,t,a,r,i)}for(var s=0;s<r.length;s++){var l=r[s];if(l.visible&&l.type==="waterfall"){i=true;break}}if(i){o("waterfallmode");o("waterfallgap",.2);o("waterfallgroupgap")}}},{"../../lib":778,"./layout_attributes":1361}],1363:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../lib");var i=e("../../components/drawing");var o=e("../../constants/numerical").BADNUM;var s=e("../bar/plot");var l=e("../bar/uniform_text").clearMinTextSize;t.exports=function e(t,r,n,a){var i=t._fullLayout;l("waterfall",i);s.plot(t,r,n,a,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap});u(t,r,n,a)};function u(e,t,r,s){var l=t.xaxis;var u=t.yaxis;a.makeTraceGroups(s,r,"trace bars").each(function(r){var s=n.select(this);var f=r[0].trace;var h=a.ensureSingle(s,"g","lines");if(!f.connector||!f.connector.visible){h.remove();return}var p=f.orientation==="h";var d=f.connector.mode;var v=h.selectAll("g.line").data(a.identity);v.enter().append("g").classed("line",true);v.exit().remove();var m=v.size();v.each(function(r,s){if(s!==m-1&&!r.cNext)return;var f=c(r,l,u,p);var h=f[0];var v=f[1];var g="";if(h[0]!==o&&v[0]!==o&&h[1]!==o&&v[1]!==o){if(d==="spanning"){if(!r.isSum&&s>0){if(p){g+="M"+h[0]+","+v[1]+"V"+v[0]}else{g+="M"+h[1]+","+v[0]+"H"+h[0]}}}if(d!=="between"){if(r.isSum||s<m-1){if(p){g+="M"+h[1]+","+v[0]+"V"+v[1]}else{g+="M"+h[0]+","+v[1]+"H"+h[1]}}}if(h[2]!==o&&v[2]!==o){if(p){g+="M"+h[1]+","+v[1]+"V"+v[2]}else{g+="M"+h[1]+","+v[1]+"H"+h[2]}}}if(g==="")g="M0,0Z";a.ensureSingle(n.select(this),"path").attr("d",g).call(i.setClipUrl,t.layerClipId,e)})})}function c(e,t,r,n){var a=[];var i=[];var o=n?t:r;var s=n?r:t;a[0]=o.c2p(e.s0,true);i[0]=s.c2p(e.p0,true);a[1]=o.c2p(e.s1,true);i[1]=s.c2p(e.p1,true);a[2]=o.c2p(e.nextS0,true);i[2]=s.c2p(e.nextP0,true);return n?[a,i]:[i,a]}},{"../../components/drawing":665,"../../constants/numerical":753,"../../lib":778,"../bar/plot":932,"../bar/uniform_text":937,d3:169}],1364:[function(e,t,r){"use strict";var n=e("d3");var a=e("../../components/drawing");var i=e("../../components/color");var o=e("../../constants/interactions").DESELECTDIM;var s=e("../bar/style");var l=e("../bar/uniform_text").resizeText;var u=s.styleTextPoints;function c(e,t,r){var s=r?r:n.select(e).selectAll("g.waterfalllayer").selectAll("g.trace");l(e,s,"waterfall");s.style("opacity",function(e){return e[0].trace.opacity});s.each(function(t){var r=n.select(this);var s=t[0].trace;r.selectAll(".point > path").each(function(e){if(!e.isBlank){var t=s[e.dir].marker;n.select(this).call(i.fill,t.color).call(i.stroke,t.line.color).call(a.dashLine,t.line.dash,t.line.width).style("opacity",s.selectedpoints&&!e.selected?o:1)}});u(r,s,e);r.selectAll(".lines").each(function(){var e=s.connector.line;a.lineGroupStyle(n.select(this).selectAll("path"),e.width,e.color,e.dash)})})}t.exports={style:c}},{"../../components/color":643,"../../components/drawing":665,"../../constants/interactions":752,"../bar/style":935,"../bar/uniform_text":937,d3:169}],1365:[function(e,t,r){"use strict";var n=e("../plots/cartesian/axes");var a=e("../lib");var i=e("../plot_api/plot_schema");var o=e("./helpers").pointsAccessorFunction;var s=e("../constants/numerical").BADNUM;r.moduleType="transform";r.name="aggregate";var l=r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},groups:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"},editType:"calc"};var u=l.aggregations;r.supplyDefaults=function(e,t){var r={};var n;function o(t,n){return a.coerce(e,r,l,t,n)}var s=o("enabled");if(!s)return r;var c=i.findArrayAttributes(t);var f={};for(n=0;n<c.length;n++)f[c[n]]=1;var h=o("groups");if(!Array.isArray(h)){if(!f[h]){r.enabled=false;return r}f[h]=0}var p=e.aggregations||[];var d=r.aggregations=new Array(p.length);var v;function m(e,t){return a.coerce(p[n],v,u,e,t)}for(n=0;n<p.length;n++){v={_index:n};var g=m("target");var y=m("func");var x=m("enabled");if(x&&g&&(f[g]||y==="count"&&f[g]===undefined)){if(y==="stddev")m("funcmode");f[g]=0;d[n]=v}else d[n]={enabled:false,_index:n}}for(n=0;n<c.length;n++){if(f[c[n]]){d.push({target:c[n],func:u.func.dflt,enabled:true,_index:-1})}}return r};r.calcTransform=function(e,t,r){if(!r.enabled)return;var n=r.groups;var i=a.getTargetArray(t,{target:n});if(!i)return;var s,l,u,f;var h={};var p={};var d=[];var v=o(t.transforms,r);var m=i.length;if(t._length)m=Math.min(m,t._length);for(s=0;s<m;s++){l=i[s];u=h[l];if(u===undefined){h[l]=d.length;f=[s];d.push(f);p[h[l]]=v(s)}else{d[u].push(s);p[h[l]]=(p[h[l]]||[]).concat(v(s))}}r._indexToPoints=p;var g=r.aggregations;for(s=0;s<g.length;s++){c(e,t,d,g[s])}if(typeof n==="string"){c(e,t,d,{target:n,func:"first",enabled:true})}t._length=d.length};function c(e,t,r,i){if(!i.enabled)return;var o=i.target;var s=a.nestedProperty(t,o);var l=s.get();var u=n.getDataConversions(e,t,o,l);var c=f(i,u);var h=new Array(r.length);for(var p=0;p<r.length;p++){h[p]=c(l,r[p])}s.set(h);if(i.func==="count"){a.pushUnique(t._arrayAttrs,o)}}function f(e,t){var r=e.func;var n=t.d2c;var i=t.c2d;switch(r){case"count":return h;case"first":return p;case"last":return d;case"sum":return function(e,t){var r=0;for(var a=0;a<t.length;a++){var o=n(e[t[a]]);if(o!==s)r+=o}return i(r)};case"avg":return function(e,t){var r=0;var a=0;for(var o=0;o<t.length;o++){var l=n(e[t[o]]);if(l!==s){r+=l;a++}}return a?i(r/a):s};case"min":return function(e,t){var r=Infinity;for(var a=0;a<t.length;a++){var o=n(e[t[a]]);if(o!==s)r=Math.min(r,o)}return r===Infinity?s:i(r)};case"max":return function(e,t){var r=-Infinity;for(var a=0;a<t.length;a++){var o=n(e[t[a]]);if(o!==s)r=Math.max(r,o)}return r===-Infinity?s:i(r)};case"range":return function(e,t){var r=Infinity;var a=-Infinity;for(var o=0;o<t.length;o++){var l=n(e[t[o]]);if(l!==s){r=Math.min(r,l);a=Math.max(a,l)}}return a===-Infinity||r===Infinity?s:i(a-r)};case"change":return function(e,t){var r=n(e[t[0]]);var a=n(e[t[t.length-1]]);return r===s||a===s?s:i(a-r)};case"median":return function(e,t){var r=[];for(var o=0;o<t.length;o++){var l=n(e[t[o]]);if(l!==s)r.push(l)}if(!r.length)return s;r.sort(a.sorterAsc);var u=(r.length-1)/2;return i((r[Math.floor(u)]+r[Math.ceil(u)])/2)};case"mode":return function(e,t){var r={};var a=0;var o=s;for(var l=0;l<t.length;l++){var u=n(e[t[l]]);if(u!==s){var c=r[u]=(r[u]||0)+1;if(c>a){a=c;o=u}}}return a?i(o):s};case"rms":return function(e,t){var r=0;var a=0;for(var o=0;o<t.length;o++){var l=n(e[t[o]]);if(l!==s){r+=l*l;a++}}return a?i(Math.sqrt(r/a)):s};case"stddev":return function(t,r){var a=0;var i=0;var o=1;var l=s;var u;for(u=0;u<r.length&&l===s;u++){l=n(t[r[u]])}if(l===s)return s;for(;u<r.length;u++){var c=n(t[r[u]]);if(c!==s){var f=c-l;a+=f;i+=f*f;o++}}var h=e.funcmode==="sample"?o-1:o;if(!h)return 0;return Math.sqrt((i-a*a/o)/h)}}}function h(e,t){return t.length}function p(e,t){return e[t[0]]}function d(e,t){return e[t[t.length-1]]}},{"../constants/numerical":753,"../lib":778,"../plot_api/plot_schema":816,"../plots/cartesian/axes":828,"./helpers":1368}],1366:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../registry");var i=e("../plots/cartesian/axes");var o=e("./helpers").pointsAccessorFunction;var s=e("../constants/filter_ops");var l=s.COMPARISON_OPS;var u=s.INTERVAL_OPS;var c=s.SET_OPS;r.moduleType="transform";r.name="filter";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},target:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(l).concat(u).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:false,editType:"calc"},editType:"calc"};r.supplyDefaults=function(e){var t={};function i(a,i){return n.coerce(e,t,r.attributes,a,i)}var o=i("enabled");if(o){var s=i("target");if(n.isArrayOrTypedArray(s)&&s.length===0){t.enabled=false;return t}i("preservegaps");i("operation");i("value");var l=a.getComponentMethod("calendars","handleDefaults");l(e,t,"valuecalendar",null);l(e,t,"targetcalendar",null)}return t};r.calcTransform=function(e,t,r){if(!r.enabled)return;var a=n.getTargetArray(t,r);if(!a)return;var s=r.target;var l=a.length;if(t._length)l=Math.min(l,t._length);var u=r.targetcalendar;var c=t._arrayAttrs;var h=r.preservegaps;if(typeof s==="string"){var p=n.nestedProperty(t,s+"calendar").get();if(p)u=p}var d=i.getDataToCoordFunc(e,t,s,a);var v=f(r,d,u);var m={};var g={};var y=0;function x(e,r){for(var a=0;a<c.length;a++){var i=n.nestedProperty(t,c[a]);e(i,r)}}var _;var b;if(h){_=function(e){m[e.astr]=n.extendDeep([],e.get());e.set(new Array(l))};b=function(e,t){var r=m[e.astr][t];e.get()[t]=r}}else{_=function(e){m[e.astr]=n.extendDeep([],e.get());e.set([])};b=function(e,t){var r=m[e.astr][t];e.get().push(r)}}x(_);var w=o(t.transforms,r);for(var T=0;T<l;T++){var k=v(a[T]);if(k){x(b,T);g[y++]=w(T)}else if(h)y++}r._indexToPoints=g;t._length=y};function f(e,t,r){var n=e.operation;var a=e.value;var i=Array.isArray(a);function o(e){return e.indexOf(n)!==-1}var s=function(r){return t(r,0,e.valuecalendar)};var f=function(e){return t(e,0,r)};var h;if(o(l)){h=i?s(a[0]):s(a)}else if(o(u)){h=i?[s(a[0]),s(a[1])]:[s(a),s(a)]}else if(o(c)){h=i?a.map(s):[s(a)]}switch(n){case"=":return function(e){return f(e)===h};case"!=":return function(e){return f(e)!==h};case"<":return function(e){return f(e)<h};case"<=":return function(e){return f(e)<=h};case">":return function(e){return f(e)>h};case">=":return function(e){return f(e)>=h};case"[]":return function(e){var t=f(e);return t>=h[0]&&t<=h[1]};case"()":return function(e){var t=f(e);return t>h[0]&&t<h[1]};case"[)":return function(e){var t=f(e);return t>=h[0]&&t<h[1]};case"(]":return function(e){var t=f(e);return t>h[0]&&t<=h[1]};case"][":return function(e){var t=f(e);return t<=h[0]||t>=h[1]};case")(":return function(e){var t=f(e);return t<h[0]||t>h[1]};case"](":return function(e){var t=f(e);return t<=h[0]||t>h[1]};case")[":return function(e){var t=f(e);return t<h[0]||t>=h[1]};case"{}":return function(e){return h.indexOf(f(e))!==-1};case"}{":return function(e){return h.indexOf(f(e))===-1}}}},{"../constants/filter_ops":749,"../lib":778,"../plots/cartesian/axes":828,"../registry":911,"./helpers":1368}],1367:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plot_api/plot_schema");var i=e("../plots/plots");var o=e("./helpers").pointsAccessorFunction;r.moduleType="transform";r.name="groupby";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:true},editType:"calc"},editType:"calc"};r.supplyDefaults=function(e,t,a){var i;var o={};function s(t,a){return n.coerce(e,o,r.attributes,t,a)}var l=s("enabled");if(!l)return o;s("groups");s("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var u=e.styles;var c=o.styles=[];if(u){for(i=0;i<u.length;i++){var f=c[i]={};n.coerce(u[i],c[i],r.attributes.styles,"target");var h=n.coerce(u[i],c[i],r.attributes.styles,"value");if(n.isPlainObject(h))f.value=n.extendDeep({},h);else if(h)delete f.value}}return o};r.transform=function(e,t){var r,n,a;var i=[];for(n=0;n<e.length;n++){r=s(e[n],t);for(a=0;a<r.length;a++){i.push(r[a])}}return i};function s(e,t){var r,s,l,u,c,f,h,p,d;var v;var m=t.transform;var g=t.transformIndex;var y=e.transforms[g].groups;var x=o(e.transforms,m);if(!n.isArrayOrTypedArray(y)||y.length===0){return[e]}var _=n.filterUnique(y);var b=new Array(_.length);var w=y.length;var T=a.findArrayAttributes(e);var k=m.styles||[];var A={};for(r=0;r<k.length;r++){A[k[r].target]=k[r].value}if(m.styles){v=n.keyedContainer(m,"styles","target","value.name")}var M={};var E={};for(r=0;r<_.length;r++){f=_[r];M[f]=r;E[f]=0;h=b[r]=n.extendDeepNoArrays({},e);h._group=f;h.transforms[g]._indexToPoints={};var S=null;if(v){S=v.get(f)}if(S||S===""){h.name=S}else{h.name=n.templateString(m.nameformat,{trace:e.name,group:f})}p=h.transforms;h.transforms=[];for(s=0;s<p.length;s++){h.transforms[s]=n.extendDeepNoArrays({},p[s])}for(s=0;s<T.length;s++){n.nestedProperty(h,T[s]).set([])}}for(l=0;l<T.length;l++){u=T[l];for(s=0,d=[];s<_.length;s++){d[s]=n.nestedProperty(b[s],u).get()}c=n.nestedProperty(e,u).get();for(s=0;s<w;s++){d[M[y[s]]].push(c[s])}}for(s=0;s<w;s++){h=b[M[y[s]]];var C=h.transforms[g]._indexToPoints;C[E[y[s]]]=x(s);E[y[s]]++}for(r=0;r<_.length;r++){f=_[r];h=b[r];i.clearExpandedTraceDefaultColors(h);h=n.extendDeepNoArrays(h,A[f]||{})}return b}},{"../lib":778,"../plot_api/plot_schema":816,"../plots/plots":891,"./helpers":1368}],1368:[function(e,t,r){"use strict";r.pointsAccessorFunction=function(e,t){var r;var n;for(var a=0;a<e.length;a++){r=e[a];if(r===t)break;if(!r._indexToPoints||r.enabled===false)continue;n=r._indexToPoints}var i=n?function(e){return n[e]}:function(e){return[e]};return i}},{}],1369:[function(e,t,r){"use strict";var n=e("../lib");var a=e("../plots/cartesian/axes");var i=e("./helpers").pointsAccessorFunction;var o=e("../constants/numerical").BADNUM;r.moduleType="transform";r.name="sort";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},target:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"};r.supplyDefaults=function(e){var t={};function a(a,i){return n.coerce(e,t,r.attributes,a,i)}var i=a("enabled");if(i){a("target");a("order")}return t};r.calcTransform=function(e,t,r){if(!r.enabled)return;var o=n.getTargetArray(t,r);if(!o)return;var l=r.target;var u=o.length;if(t._length)u=Math.min(u,t._length);var c=t._arrayAttrs;var f=a.getDataToCoordFunc(e,t,l,o);var h=s(r,o,f,u);var p=i(t.transforms,r);var d={};var v,m;for(v=0;v<c.length;v++){var g=n.nestedProperty(t,c[v]);var y=g.get();var x=new Array(u);for(m=0;m<u;m++){x[m]=y[h[m]]}g.set(x)}for(m=0;m<u;m++){d[m]=p(h[m])}r._indexToPoints=d;t._length=u};function s(e,t,r,n){var a=new Array(n);var i=new Array(n);var o;for(o=0;o<n;o++){a[o]={v:t[o],i:o}}a.sort(l(e,r));for(o=0;o<n;o++){i[o]=a[o].i}return i}function l(e,t){switch(e.order){case"ascending":return function(e,r){var n=t(e.v);var a=t(r.v);if(n===o){return 1}if(a===o){return-1}return n-a};case"descending":return function(e,r){var n=t(e.v);var a=t(r.v);if(n===o){return 1}if(a===o){return-1}return a-n}}}},{"../constants/numerical":753,"../lib":778,"../plots/cartesian/axes":828,"./helpers":1368}],1370:[function(e,t,r){"use strict";r.version="1.58.4"},{}]},{},[26])(26)})}).call(this,r(14))},56:function(e,t,r){"use strict";var n=r(66);var a=r.n(n);t["a"]={offscreenMode:undefined,notebook:undefined,trusted:undefined,jsApi:{initialSettings:undefined,onMessageFromKernel:e=>{n["instance"].messageArrived(typeof e==="string"?JSON.parse(e):e);return true},updateNotebookByEvent:function(e){},settingsChanged:function(e){this.initialSettings=e},scrollToCell:function(e,t){}},javaApi:{log:function(e,t){},openUrl:function e(t){},focusChanged:function e(t,r){},sendCommMessageToKernel(e,t,r,n){},reportSize(e){},reportCellTopHeight(e){}}}},58:function(e,t,r){t=e.exports=r(84);t.Stream=t;t.Readable=t;t.Writable=r(59);t.Duplex=r(28);t.Transform=r(88);t.PassThrough=r(142)},59:function(e,t,r){"use strict";(function(t,n,a){var i=r(43);e.exports=b;function o(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function s(e){var t=this;this.next=null;this.entry=null;this.finish=function(){F(t,e)}}var l=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:i.nextTick;var u;b.WritableState=x;var c=Object.create(r(35));c.inherits=r(10);var f={deprecate:r(141)};var h=r(86);var p=r(12).Buffer;var d=a.Uint8Array||function(){};function v(e){return p.from(e)}function m(e){return p.isBuffer(e)||e instanceof d}var g=r(87);c.inherits(b,h);function y(){}function x(e,t){u=u||r(28);e=e||{};var n=t instanceof u;this.objectMode=!!e.objectMode;if(n)this.objectMode=this.objectMode||!!e.writableObjectMode;var a=e.highWaterMark;var i=e.writableHighWaterMark;var o=this.objectMode?16:16*1024;if(a||a===0)this.highWaterMark=a;else if(n&&(i||i===0))this.highWaterMark=i;else this.highWaterMark=o;this.highWaterMark=Math.floor(this.highWaterMark);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var l=e.decodeStrings===false;this.decodeStrings=!l;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){C(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new s(this)}x.prototype.getBuffer=function e(){var t=this.bufferedRequest;var r=[];while(t){r.push(t);t=t.next}return r};(function(){try{Object.defineProperty(x.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var _;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){_=Function.prototype[Symbol.hasInstance];Object.defineProperty(b,Symbol.hasInstance,{value:function(e){if(_.call(this,e))return true;if(this!==b)return false;return e&&e._writableState instanceof x}})}else{_=function(e){return e instanceof this}}function b(e){u=u||r(28);if(!_.call(b,this)&&!(this instanceof u)){return new b(e)}this._writableState=new x(e,this);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final}h.call(this)}b.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function w(e,t){var r=new Error("write after end");e.emit("error",r);i.nextTick(t,r)}function T(e,t,r,n){var a=true;var o=false;if(r===null){o=new TypeError("May not write null values to stream")}else if(typeof r!=="string"&&r!==undefined&&!t.objectMode){o=new TypeError("Invalid non-string/buffer chunk")}if(o){e.emit("error",o);i.nextTick(n,o);a=false}return a}b.prototype.write=function(e,t,r){var n=this._writableState;var a=false;var i=!n.objectMode&&m(e);if(i&&!p.isBuffer(e)){e=v(e)}if(typeof t==="function"){r=t;t=null}if(i)t="buffer";else if(!t)t=n.defaultEncoding;if(typeof r!=="function")r=y;if(n.ended)w(this,r);else if(i||T(this,n,e,r)){n.pendingcb++;a=A(this,n,i,e,t,r)}return a};b.prototype.cork=function(){var e=this._writableState;e.corked++};b.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.finished&&!e.bufferProcessing&&e.bufferedRequest)O(this,e)}};b.prototype.setDefaultEncoding=function e(t){if(typeof t==="string")t=t.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);this._writableState.defaultEncoding=t;return this};function k(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=p.from(t,r)}return t}Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:false,get:function(){return this._writableState.highWaterMark}});function A(e,t,r,n,a,i){if(!r){var o=k(t,n,a);if(n!==o){r=true;a="buffer";n=o}}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;if(!l)t.needDrain=true;if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:a,isBuf:r,callback:i,next:null};if(u){u.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{M(e,t,false,s,n,a,i)}return l}function M(e,t,r,n,a,i,o){t.writelen=n;t.writecb=o;t.writing=true;t.sync=true;if(r)e._writev(a,t.onwrite);else e._write(a,i,t.onwrite);t.sync=false}function E(e,t,r,n,a){--t.pendingcb;if(r){i.nextTick(a,n);i.nextTick(z,e,t);e._writableState.errorEmitted=true;e.emit("error",n)}else{a(n);e._writableState.errorEmitted=true;e.emit("error",n);z(e,t)}}function S(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function C(e,t){var r=e._writableState;var n=r.sync;var a=r.writecb;S(r);if(t)E(e,r,n,t,a);else{var i=P(r);if(!i&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest){O(e,r)}if(n){l(L,e,r,i,a)}else{L(e,r,i,a)}}}function L(e,t,r,n){if(!r)I(e,t);t.pendingcb--;n();z(e,t)}function I(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function O(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount;var a=new Array(n);var i=t.corkedRequestsFree;i.entry=r;var o=0;var l=true;while(r){a[o]=r;if(!r.isBuf)l=false;r=r.next;o+=1}a.allBuffers=l;M(e,t,true,t.length,a,"",i.finish);t.pendingcb++;t.lastBufferedRequest=null;if(i.next){t.corkedRequestsFree=i.next;i.next=null}else{t.corkedRequestsFree=new s(t)}t.bufferedRequestCount=0}else{while(r){var u=r.chunk;var c=r.encoding;var f=r.callback;var h=t.objectMode?1:u.length;M(e,t,false,h,u,c,f);r=r.next;t.bufferedRequestCount--;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequest=r;t.bufferProcessing=false}b.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))};b.prototype._writev=null;b.prototype.end=function(e,t,r){var n=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(n.corked){n.corked=1;this.uncork()}if(!n.ending&&!n.finished)N(this,n,r)};function P(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function D(e,t){e._final(function(r){t.pendingcb--;if(r){e.emit("error",r)}t.prefinished=true;e.emit("prefinish");z(e,t)})}function R(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"){t.pendingcb++;t.finalCalled=true;i.nextTick(D,e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function z(e,t){var r=P(t);if(r){R(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish")}}return r}function N(e,t,r){t.ending=true;z(e,t);if(r){if(t.finished)i.nextTick(r);else e.once("finish",r)}t.ended=true;e.writable=false}function F(e,t,r){var n=e.entry;e.entry=null;while(n){var a=n.callback;t.pendingcb--;a(r);n=n.next}if(t.corkedRequestsFree){t.corkedRequestsFree.next=e}else{t.corkedRequestsFree=e}}Object.defineProperty(b.prototype,"destroyed",{get:function(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function(e){if(!this._writableState){return}this._writableState.destroyed=e}});b.prototype.destroy=g.destroy;b.prototype._undestroy=g.undestroy;b.prototype._destroy=function(e,t){this.end();t(e)}}).call(this,r(17),r(20).setImmediate,r(14))},60:function(e,t,r){"use strict";var n=r(12).Buffer;var a=n.isEncoding||function(e){e=""+e;switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function i(e){if(!e)return"utf8";var t;while(true){switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase();t=true}}}function o(e){var t=i(e);if(typeof t!=="string"&&(n.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return t||e}t.StringDecoder=s;function s(e){this.encoding=o(e);var t;switch(this.encoding){case"utf16le":this.text=d;this.end=v;t=4;break;case"utf8":this.fillLast=f;t=4;break;case"base64":this.text=m;this.end=g;t=3;break;default:this.write=y;this.end=x;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=n.allocUnsafe(t)}s.prototype.write=function(e){if(e.length===0)return"";var t;var r;if(this.lastNeed){t=this.fillLast(e);if(t===undefined)return"";r=this.lastNeed;this.lastNeed=0}else{r=0}if(r<e.length)return t?t+this.text(e,r):this.text(e,r);return t||""};s.prototype.end=p;s.prototype.text=h;s.prototype.fillLast=function(e){if(this.lastNeed<=e.length){e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length);this.lastNeed-=e.length};function l(e){if(e<=127)return 0;else if(e>>5===6)return 2;else if(e>>4===14)return 3;else if(e>>3===30)return 4;return e>>6===2?-1:-2}function u(e,t,r){var n=t.length-1;if(n<r)return 0;var a=l(t[n]);if(a>=0){if(a>0)e.lastNeed=a-1;return a}if(--n<r||a===-2)return 0;a=l(t[n]);if(a>=0){if(a>0)e.lastNeed=a-2;return a}if(--n<r||a===-2)return 0;a=l(t[n]);if(a>=0){if(a>0){if(a===2)a=0;else e.lastNeed=a-3}return a}return 0}function c(e,t,r){if((t[0]&192)!==128){e.lastNeed=0;return"�"}if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128){e.lastNeed=1;return"�"}if(e.lastNeed>2&&t.length>2){if((t[2]&192)!==128){e.lastNeed=2;return"�"}}}}function f(e){var t=this.lastTotal-this.lastNeed;var r=c(this,e,t);if(r!==undefined)return r;if(this.lastNeed<=e.length){e.copy(this.lastChar,t,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,t,0,e.length);this.lastNeed-=e.length}function h(e,t){var r=u(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);e.copy(this.lastChar,0,n);return e.toString("utf8",t,n)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+"�";return t}function d(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=e[e.length-1];return e.toString("utf16le",t,e.length-1)}function v(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function m(e,t){var r=(e.length-t)%3;if(r===0)return e.toString("base64",t);this.lastNeed=3-r;this.lastTotal=3;if(r===1){this.lastChar[0]=e[e.length-1]}else{this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1]}return e.toString("base64",t,e.length-r)}function g(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+this.lastChar.toString("base64",0,3-this.lastNeed);return t}function y(e){return e.toString(this.encoding)}function x(e){return e&&e.length?this.write(e):""}},65:function(e,t,r){(function(t){(function(t,r){true?e.exports=r():undefined})(this,function(){"use strict";var e=function(){if(typeof Map!=="undefined"){return Map}function e(e,t){var r=-1;e.some(function(e,n){if(e[0]===t){r=n;return true}return false});return r}return function(){function t(){this.__entries__=[]}Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:true,configurable:true});t.prototype.get=function(t){var r=e(this.__entries__,t);var n=this.__entries__[r];return n&&n[1]};t.prototype.set=function(t,r){var n=e(this.__entries__,t);if(~n){this.__entries__[n][1]=r}else{this.__entries__.push([t,r])}};t.prototype.delete=function(t){var r=this.__entries__;var n=e(r,t);if(~n){r.splice(n,1)}};t.prototype.has=function(t){return!!~e(this.__entries__,t)};t.prototype.clear=function(){this.__entries__.splice(0)};t.prototype.forEach=function(e,t){if(t===void 0){t=null}for(var r=0,n=this.__entries__;r<n.length;r++){var a=n[r];e.call(t,a[1],a[0])}};return t}()}();var r=typeof window!=="undefined"&&typeof document!=="undefined"&&window.document===document;var n=function(){if(typeof t!=="undefined"&&t.Math===Math){return t}if(typeof self!=="undefined"&&self.Math===Math){return self}if(typeof window!=="undefined"&&window.Math===Math){return window}return Function("return this")()}();var a=function(){if(typeof requestAnimationFrame==="function"){return requestAnimationFrame.bind(n)}return function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}();var i=2;function o(e,t){var r=false,n=false,o=0;function s(){if(r){r=false;e()}if(n){u()}}function l(){a(s)}function u(){var e=Date.now();if(r){if(e-o<i){return}n=true}else{r=true;n=false;setTimeout(l,t)}o=e}return u}var s=20;var l=["top","right","bottom","left","width","height","size","weight"];var u=typeof MutationObserver!=="undefined";var c=function(){function e(){this.connected_=false;this.mutationEventsAdded_=false;this.mutationsObserver_=null;this.observers_=[];this.onTransitionEnd_=this.onTransitionEnd_.bind(this);this.refresh=o(this.refresh.bind(this),s)}e.prototype.addObserver=function(e){if(!~this.observers_.indexOf(e)){this.observers_.push(e)}if(!this.connected_){this.connect_()}};e.prototype.removeObserver=function(e){var t=this.observers_;var r=t.indexOf(e);if(~r){t.splice(r,1)}if(!t.length&&this.connected_){this.disconnect_()}};e.prototype.refresh=function(){var e=this.updateObservers_();if(e){this.refresh()}};e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});e.forEach(function(e){return e.broadcastActive()});return e.length>0};e.prototype.connect_=function(){if(!r||this.connected_){return}document.addEventListener("transitionend",this.onTransitionEnd_);window.addEventListener("resize",this.refresh);if(u){this.mutationsObserver_=new MutationObserver(this.refresh);this.mutationsObserver_.observe(document,{attributes:true,childList:true,characterData:true,subtree:true})}else{document.addEventListener("DOMSubtreeModified",this.refresh);this.mutationEventsAdded_=true}this.connected_=true};e.prototype.disconnect_=function(){if(!r||!this.connected_){return}document.removeEventListener("transitionend",this.onTransitionEnd_);window.removeEventListener("resize",this.refresh);if(this.mutationsObserver_){this.mutationsObserver_.disconnect()}if(this.mutationEventsAdded_){document.removeEventListener("DOMSubtreeModified",this.refresh)}this.mutationsObserver_=null;this.mutationEventsAdded_=false;this.connected_=false};e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=t===void 0?"":t;var n=l.some(function(e){return!!~r.indexOf(e)});if(n){this.refresh()}};e.getInstance=function(){if(!this.instance_){this.instance_=new e}return this.instance_};e.instance_=null;return e}();var f=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];Object.defineProperty(e,a,{value:t[a],enumerable:false,writable:false,configurable:true})}return e};var h=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||n};var p=T(0,0,0,0);function d(e){return parseFloat(e)||0}function v(e){var t=[];for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}return t.reduce(function(t,r){var n=e["border-"+r+"-width"];return t+d(n)},0)}function m(e){var t=["top","right","bottom","left"];var r={};for(var n=0,a=t;n<a.length;n++){var i=a[n];var o=e["padding-"+i];r[i]=d(o)}return r}function g(e){var t=e.getBBox();return T(0,0,t.width,t.height)}function y(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r){return p}var n=h(e).getComputedStyle(e);var a=m(n);var i=a.left+a.right;var o=a.top+a.bottom;var s=d(n.width),l=d(n.height);if(n.boxSizing==="border-box"){if(Math.round(s+i)!==t){s-=v(n,"left","right")+i}if(Math.round(l+o)!==r){l-=v(n,"top","bottom")+o}}if(!_(e)){var u=Math.round(s+i)-t;var c=Math.round(l+o)-r;if(Math.abs(u)!==1){s-=u}if(Math.abs(c)!==1){l-=c}}return T(a.left,a.top,s,l)}var x=function(){if(typeof SVGGraphicsElement!=="undefined"){return function(e){return e instanceof h(e).SVGGraphicsElement}}return function(e){return e instanceof h(e).SVGElement&&typeof e.getBBox==="function"}}();function _(e){return e===h(e).document.documentElement}function b(e){if(!r){return p}if(x(e)){return g(e)}return y(e)}function w(e){var t=e.x,r=e.y,n=e.width,a=e.height;var i=typeof DOMRectReadOnly!=="undefined"?DOMRectReadOnly:Object;var o=Object.create(i.prototype);f(o,{x:t,y:r,width:n,height:a,top:r,right:t+n,bottom:a+r,left:t});return o}function T(e,t,r,n){return{x:e,y:t,width:r,height:n}}var k=function(){function e(e){this.broadcastWidth=0;this.broadcastHeight=0;this.contentRect_=T(0,0,0,0);this.target=e}e.prototype.isActive=function(){var e=b(this.target);this.contentRect_=e;return e.width!==this.broadcastWidth||e.height!==this.broadcastHeight};e.prototype.broadcastRect=function(){var e=this.contentRect_;this.broadcastWidth=e.width;this.broadcastHeight=e.height;return e};return e}();var A=function(){function e(e,t){var r=w(t);f(this,{target:e,contentRect:r})}return e}();var M=function(){function t(t,r,n){this.activeObservations_=[];this.observations_=new e;if(typeof t!=="function"){throw new TypeError("The callback provided as parameter 1 is not a function.")}this.callback_=t;this.controller_=r;this.callbackCtx_=n}t.prototype.observe=function(e){if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}if(typeof Element==="undefined"||!(Element instanceof Object)){return}if(!(e instanceof h(e).Element)){throw new TypeError('parameter 1 is not of type "Element".')}var t=this.observations_;if(t.has(e)){return}t.set(e,new k(e));this.controller_.addObserver(this);this.controller_.refresh()};t.prototype.unobserve=function(e){if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}if(typeof Element==="undefined"||!(Element instanceof Object)){return}if(!(e instanceof h(e).Element)){throw new TypeError('parameter 1 is not of type "Element".')}var t=this.observations_;if(!t.has(e)){return}t.delete(e);if(!t.size){this.controller_.removeObserver(this)}};t.prototype.disconnect=function(){this.clearActive();this.observations_.clear();this.controller_.removeObserver(this)};t.prototype.gatherActive=function(){var e=this;this.clearActive();this.observations_.forEach(function(t){if(t.isActive()){e.activeObservations_.push(t)}})};t.prototype.broadcastActive=function(){if(!this.hasActive()){return}var e=this.callbackCtx_;var t=this.activeObservations_.map(function(e){return new A(e.target,e.broadcastRect())});this.callback_.call(e,t,e);this.clearActive()};t.prototype.clearActive=function(){this.activeObservations_.splice(0)};t.prototype.hasActive=function(){return this.activeObservations_.length>0};return t}();var E=typeof WeakMap!=="undefined"?new WeakMap:new e;var S=function(){function e(t){if(!(this instanceof e)){throw new TypeError("Cannot call a class as a function.")}if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}var r=c.getInstance();var n=new M(t,r,this);E.set(this,n)}return e}();["observe","unobserve","disconnect"].forEach(function(e){S.prototype[e]=function(){var t;return(t=E.get(this))[e].apply(t,arguments)}});var C=function(){if(typeof n.ResizeObserver!=="undefined"){return n.ResizeObserver}return S}();return C})}).call(this,r(14))},66:function(e,t,r){"use strict";class n{constructor(){this.messageCallbacks={};this.globalListeners=[];this.autoUnsubscribing=[]}subscribe(e,t,r){if(!(e in this.messageCallbacks)){this.messageCallbacks[e]=[]}this.messageCallbacks[e].push(t);if(r){this.autoUnsubscribing.push(t)}}addGlobalListener(e){this.globalListeners.push(e)}unsubscribe(e,t){if(!(e in this.messageCallbacks)){return}this.messageCallbacks[e]=this.messageCallbacks[e].filter(e=>e!==t);this.autoUnsubscribing=this.autoUnsubscribing.filter(e=>e!==t);if(this.messageCallbacks[e].length===0){delete this.messageCallbacks[e]}}messageArrived(e){this.globalListeners.forEach(t=>t(e));const t=e.parent_header;if(!t||!t.msg_id){return}const r=t.msg_id;let n=this.messageCallbacks[r];if(n===undefined){return}this.messageCallbacks[r].forEach(t=>a(this,t,e))}}function a(e,t,r){const n=r.channel;if(n==="shell"){if(t.shell&&t.shell.reply){t.shell.reply(r)}}if(n==="input"){if(t.input){t.input(r)}}if(n==="iopub"){if(t.iopub){if(t.iopub.status&&r.header.msg_type==="status"){t.iopub.status(r);if(r.content.execution_state==="idle"){if(e.autoUnsubscribing.find(e=>e===t)){e.unsubscribe(r.parent_header.msg_id,t)}}}else if(t.iopub.clear_output&&r.header.msg_type==="clear_output"){t.iopub.clear_output(r)}else if(t.iopub.output){switch(r.header.msg_type){case"display_data":case"execute_result":t.iopub.output(r);break;default:break}}}}}const i=new n;e.exports={instance:i}},68:function(e,t,r){"use strict";var n=t.NAMESPACES={HTML:"http://www.w3.org/1999/xhtml",MATHML:"http://www.w3.org/1998/Math/MathML",SVG:"http://www.w3.org/2000/svg",XLINK:"http://www.w3.org/1999/xlink",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"};t.ATTRS={TYPE:"type",ACTION:"action",ENCODING:"encoding",PROMPT:"prompt",NAME:"name",COLOR:"color",FACE:"face",SIZE:"size"};var a=t.TAG_NAMES={A:"a",ADDRESS:"address",ANNOTATION_XML:"annotation-xml",APPLET:"applet",AREA:"area",ARTICLE:"article",ASIDE:"aside",B:"b",BASE:"base",BASEFONT:"basefont",BGSOUND:"bgsound",BIG:"big",BLOCKQUOTE:"blockquote",BODY:"body",BR:"br",BUTTON:"button",CAPTION:"caption",CENTER:"center",CODE:"code",COL:"col",COLGROUP:"colgroup",DD:"dd",DESC:"desc",DETAILS:"details",DIALOG:"dialog",DIR:"dir",DIV:"div",DL:"dl",DT:"dt",EM:"em",EMBED:"embed",FIELDSET:"fieldset",FIGCAPTION:"figcaption",FIGURE:"figure",FONT:"font",FOOTER:"footer",FOREIGN_OBJECT:"foreignObject",FORM:"form",FRAME:"frame",FRAMESET:"frameset",H1:"h1",H2:"h2",H3:"h3",H4:"h4",H5:"h5",H6:"h6",HEAD:"head",HEADER:"header",HGROUP:"hgroup",HR:"hr",HTML:"html",I:"i",IMG:"img",IMAGE:"image",INPUT:"input",IFRAME:"iframe",KEYGEN:"keygen",LABEL:"label",LI:"li",LINK:"link",LISTING:"listing",MAIN:"main",MALIGNMARK:"malignmark",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUITEM:"menuitem",META:"meta",MGLYPH:"mglyph",MI:"mi",MO:"mo",MN:"mn",MS:"ms",MTEXT:"mtext",NAV:"nav",NOBR:"nobr",NOFRAMES:"noframes",NOEMBED:"noembed",NOSCRIPT:"noscript",OBJECT:"object",OL:"ol",OPTGROUP:"optgroup",OPTION:"option",P:"p",PARAM:"param",PLAINTEXT:"plaintext",PRE:"pre",RB:"rb",RP:"rp",RT:"rt",RTC:"rtc",RUBY:"ruby",S:"s",SCRIPT:"script",SECTION:"section",SELECT:"select",SOURCE:"source",SMALL:"small",SPAN:"span",STRIKE:"strike",STRONG:"strong",STYLE:"style",SUB:"sub",SUMMARY:"summary",SUP:"sup",TABLE:"table",TBODY:"tbody",TEMPLATE:"template",TEXTAREA:"textarea",TFOOT:"tfoot",TD:"td",TH:"th",THEAD:"thead",TITLE:"title",TR:"tr",TRACK:"track",TT:"tt",U:"u",UL:"ul",SVG:"svg",VAR:"var",WBR:"wbr",XMP:"xmp"};var i=t.SPECIAL_ELEMENTS={};i[n.HTML]={};i[n.HTML][a.ADDRESS]=true;i[n.HTML][a.APPLET]=true;i[n.HTML][a.AREA]=true;i[n.HTML][a.ARTICLE]=true;i[n.HTML][a.ASIDE]=true;i[n.HTML][a.BASE]=true;i[n.HTML][a.BASEFONT]=true;i[n.HTML][a.BGSOUND]=true;i[n.HTML][a.BLOCKQUOTE]=true;i[n.HTML][a.BODY]=true;i[n.HTML][a.BR]=true;i[n.HTML][a.BUTTON]=true;i[n.HTML][a.CAPTION]=true;i[n.HTML][a.CENTER]=true;i[n.HTML][a.COL]=true;i[n.HTML][a.COLGROUP]=true;i[n.HTML][a.DD]=true;i[n.HTML][a.DETAILS]=true;i[n.HTML][a.DIR]=true;i[n.HTML][a.DIV]=true;i[n.HTML][a.DL]=true;i[n.HTML][a.DT]=true;i[n.HTML][a.EMBED]=true;i[n.HTML][a.FIELDSET]=true;i[n.HTML][a.FIGCAPTION]=true;i[n.HTML][a.FIGURE]=true;i[n.HTML][a.FOOTER]=true;i[n.HTML][a.FORM]=true;i[n.HTML][a.FRAME]=true;i[n.HTML][a.FRAMESET]=true;i[n.HTML][a.H1]=true;i[n.HTML][a.H2]=true;i[n.HTML][a.H3]=true;i[n.HTML][a.H4]=true;i[n.HTML][a.H5]=true;i[n.HTML][a.H6]=true;i[n.HTML][a.HEAD]=true;i[n.HTML][a.HEADER]=true;i[n.HTML][a.HGROUP]=true;i[n.HTML][a.HR]=true;i[n.HTML][a.HTML]=true;i[n.HTML][a.IFRAME]=true;i[n.HTML][a.IMG]=true;i[n.HTML][a.INPUT]=true;i[n.HTML][a.LI]=true;i[n.HTML][a.LINK]=true;i[n.HTML][a.LISTING]=true;i[n.HTML][a.MAIN]=true;i[n.HTML][a.MARQUEE]=true;i[n.HTML][a.MENU]=true;i[n.HTML][a.META]=true;i[n.HTML][a.NAV]=true;i[n.HTML][a.NOEMBED]=true;i[n.HTML][a.NOFRAMES]=true;i[n.HTML][a.NOSCRIPT]=true;i[n.HTML][a.OBJECT]=true;i[n.HTML][a.OL]=true;i[n.HTML][a.P]=true;i[n.HTML][a.PARAM]=true;i[n.HTML][a.PLAINTEXT]=true;i[n.HTML][a.PRE]=true;i[n.HTML][a.SCRIPT]=true;i[n.HTML][a.SECTION]=true;i[n.HTML][a.SELECT]=true;i[n.HTML][a.SOURCE]=true;i[n.HTML][a.STYLE]=true;i[n.HTML][a.SUMMARY]=true;i[n.HTML][a.TABLE]=true;i[n.HTML][a.TBODY]=true;i[n.HTML][a.TD]=true;i[n.HTML][a.TEMPLATE]=true;i[n.HTML][a.TEXTAREA]=true;i[n.HTML][a.TFOOT]=true;i[n.HTML][a.TH]=true;i[n.HTML][a.THEAD]=true;i[n.HTML][a.TITLE]=true;i[n.HTML][a.TR]=true;i[n.HTML][a.TRACK]=true;i[n.HTML][a.UL]=true;i[n.HTML][a.WBR]=true;i[n.HTML][a.XMP]=true;i[n.MATHML]={};i[n.MATHML][a.MI]=true;i[n.MATHML][a.MO]=true;i[n.MATHML][a.MN]=true;i[n.MATHML][a.MS]=true;i[n.MATHML][a.MTEXT]=true;i[n.MATHML][a.ANNOTATION_XML]=true;i[n.SVG]={};i[n.SVG][a.TITLE]=true;i[n.SVG][a.FOREIGN_OBJECT]=true;i[n.SVG][a.DESC]=true},69:function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function e(t){var r=Object.keys(t);var n={};for(var a=0;a<r.length;a++){n[r[a]]=Object.getOwnPropertyDescriptor(t,r[a])}return n};var a=/%[sdj%]/g;t.format=function(e){if(!w(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(s(arguments[r]))}return t.join(" ")}var r=1;var n=arguments;var i=n.length;var o=String(e).replace(a,function(e){if(e==="%%")return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}});for(var l=n[r];r<i;l=n[++r]){if(x(l)||!M(l)){o+=" "+l}else{o+=" "+s(l)}}return o};t.deprecate=function(r,n){if(typeof e!=="undefined"&&e.noDeprecation===true){return r}if(typeof e==="undefined"){return function(){return t.deprecate(r,n).apply(this,arguments)}}var a=false;function i(){if(!a){if(e.throwDeprecation){throw new Error(n)}else if(e.traceDeprecation){console.trace(n)}else{console.error(n)}a=true}return r.apply(this,arguments)}return i};var i={};var o;t.debuglog=function(r){if(k(o))o=e.env.NODE_DEBUG||"";r=r.toUpperCase();if(!i[r]){if(new RegExp("\\b"+r+"\\b","i").test(o)){var n=e.pid;i[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else{i[r]=function(){}}}return i[r]};function s(e,r){var n={seen:[],stylize:u};if(arguments.length>=3)n.depth=arguments[2];if(arguments.length>=4)n.colors=arguments[3];if(y(r)){n.showHidden=r}else if(r){t._extend(n,r)}if(k(n.showHidden))n.showHidden=false;if(k(n.depth))n.depth=2;if(k(n.colors))n.colors=false;if(k(n.customInspect))n.customInspect=true;if(n.colors)n.stylize=l;return f(n,e,n.depth)}t.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=s.styles[t];if(r){return"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m"}else{return e}}function u(e,t){return e}function c(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function f(e,r,n){if(e.customInspect&&r&&C(r.inspect)&&r.inspect!==t.inspect&&!(r.constructor&&r.constructor.prototype===r)){var a=r.inspect(n,e);if(!w(a)){a=f(e,a,n)}return a}var i=h(e,r);if(i){return i}var o=Object.keys(r);var s=c(o);if(e.showHidden){o=Object.getOwnPropertyNames(r)}if(S(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0)){return p(r)}if(o.length===0){if(C(r)){var l=r.name?": "+r.name:"";return e.stylize("[Function"+l+"]","special")}if(A(r)){return e.stylize(RegExp.prototype.toString.call(r),"regexp")}if(E(r)){return e.stylize(Date.prototype.toString.call(r),"date")}if(S(r)){return p(r)}}var u="",y=false,x=["{","}"];if(g(r)){y=true;x=["[","]"]}if(C(r)){var _=r.name?": "+r.name:"";u=" [Function"+_+"]"}if(A(r)){u=" "+RegExp.prototype.toString.call(r)}if(E(r)){u=" "+Date.prototype.toUTCString.call(r)}if(S(r)){u=" "+p(r)}if(o.length===0&&(!y||r.length==0)){return x[0]+u+x[1]}if(n<0){if(A(r)){return e.stylize(RegExp.prototype.toString.call(r),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(r);var b;if(y){b=d(e,r,n,s,o)}else{b=o.map(function(t){return v(e,r,n,s,t,y)})}e.seen.pop();return m(b,u,x)}function h(e,t){if(k(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(b(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(x(t))return e.stylize("null","null")}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,a){var i=[];for(var o=0,s=t.length;o<s;++o){if(R(t,String(o))){i.push(v(e,t,r,n,String(o),true))}else{i.push("")}}a.forEach(function(a){if(!a.match(/^\d+$/)){i.push(v(e,t,r,n,a,true))}});return i}function v(e,t,r,n,a,i){var o,s,l;l=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]};if(l.get){if(l.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(l.set){s=e.stylize("[Setter]","special")}}if(!R(n,a)){o="["+a+"]"}if(!s){if(e.seen.indexOf(l.value)<0){if(x(r)){s=f(e,l.value,null)}else{s=f(e,l.value,r-1)}if(s.indexOf("\n")>-1){if(i){s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(k(o)){if(i&&a.match(/^\d+$/)){return s}o=JSON.stringify(""+a);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=e.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=e.stylize(o,"string")}}return o+": "+s}function m(e,t,r){var n=0;var a=e.reduce(function(e,t){n++;if(t.indexOf("\n")>=0)n++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(a>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function g(e){return Array.isArray(e)}t.isArray=g;function y(e){return typeof e==="boolean"}t.isBoolean=y;function x(e){return e===null}t.isNull=x;function _(e){return e==null}t.isNullOrUndefined=_;function b(e){return typeof e==="number"}t.isNumber=b;function w(e){return typeof e==="string"}t.isString=w;function T(e){return typeof e==="symbol"}t.isSymbol=T;function k(e){return e===void 0}t.isUndefined=k;function A(e){return M(e)&&I(e)==="[object RegExp]"}t.isRegExp=A;function M(e){return typeof e==="object"&&e!==null}t.isObject=M;function E(e){return M(e)&&I(e)==="[object Date]"}t.isDate=E;function S(e){return M(e)&&(I(e)==="[object Error]"||e instanceof Error)}t.isError=S;function C(e){return typeof e==="function"}t.isFunction=C;function L(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}t.isPrimitive=L;t.isBuffer=r(147);function I(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(){var e=new Date;var t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}t.log=function(){console.log("%s - %s",D(),t.format.apply(t,arguments))};t.inherits=r(148);t._extend=function(e,t){if(!t||!M(t))return e;var r=Object.keys(t);var n=r.length;while(n--){e[r[n]]=t[r[n]]}return e};function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var z=typeof Symbol!=="undefined"?Symbol("util.promisify.custom"):undefined;t.promisify=function e(t){if(typeof t!=="function")throw new TypeError('The "original" argument must be of type Function');if(z&&t[z]){var r=t[z];if(typeof r!=="function"){throw new TypeError('The "util.promisify.custom" argument must be of type Function')}Object.defineProperty(r,z,{value:r,enumerable:false,writable:false,configurable:true});return r}function r(){var e,r;var n=new Promise(function(t,n){e=t;r=n});var a=[];for(var i=0;i<arguments.length;i++){a.push(arguments[i])}a.push(function(t,n){if(t){r(t)}else{e(n)}});try{t.apply(this,a)}catch(e){r(e)}return n}Object.setPrototypeOf(r,Object.getPrototypeOf(t));if(z)Object.defineProperty(r,z,{value:r,enumerable:false,writable:false,configurable:true});return Object.defineProperties(r,n(t))};t.promisify.custom=z;function N(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e;e=r}return t(e)}function F(t){if(typeof t!=="function"){throw new TypeError('The "original" argument must be of type Function')}function r(){var r=[];for(var n=0;n<arguments.length;n++){r.push(arguments[n])}var a=r.pop();if(typeof a!=="function"){throw new TypeError("The last argument must be of type Function")}var i=this;var o=function(){return a.apply(i,arguments)};t.apply(this,r).then(function(t){e.nextTick(o,null,t)},function(t){e.nextTick(N,t,o)})}Object.setPrototypeOf(r,Object.getPrototypeOf(t));Object.defineProperties(r,n(t));return r}t.callbackify=F}).call(this,r(17))},79:function(e,t,r){"use strict";t.byteLength=c;t.toByteArray=h;t.fromByteArray=v;var n=[];var a=[];var i=typeof Uint8Array!=="undefined"?Uint8Array:Array;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,l=o.length;s<l;++s){n[s]=o[s];a[o.charCodeAt(s)]=s}a["-".charCodeAt(0)]=62;a["_".charCodeAt(0)]=63;function u(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var r=e.indexOf("=");if(r===-1)r=t;var n=r===t?0:4-r%4;return[r,n]}function c(e){var t=u(e);var r=t[0];var n=t[1];return(r+n)*3/4-n}function f(e,t,r){return(t+r)*3/4-r}function h(e){var t;var r=u(e);var n=r[0];var o=r[1];var s=new i(f(e,n,o));var l=0;var c=o>0?n-4:n;for(var h=0;h<c;h+=4){t=a[e.charCodeAt(h)]<<18|a[e.charCodeAt(h+1)]<<12|a[e.charCodeAt(h+2)]<<6|a[e.charCodeAt(h+3)];s[l++]=t>>16&255;s[l++]=t>>8&255;s[l++]=t&255}if(o===2){t=a[e.charCodeAt(h)]<<2|a[e.charCodeAt(h+1)]>>4;s[l++]=t&255}if(o===1){t=a[e.charCodeAt(h)]<<10|a[e.charCodeAt(h+1)]<<4|a[e.charCodeAt(h+2)]>>2;s[l++]=t>>8&255;s[l++]=t&255}return s}function p(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function d(e,t,r){var n;var a=[];for(var i=t;i<r;i+=3){n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255);a.push(p(n))}return a.join("")}function v(e){var t;var r=e.length;var a=r%3;var i=[];var o=16383;for(var s=0,l=r-a;s<l;s+=o){i.push(d(e,s,s+o>l?l:s+o))}if(a===1){t=e[r-1];i.push(n[t>>2]+n[t<<4&63]+"==")}else if(a===2){t=(e[r-2]<<8)+e[r-1];i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")}return i.join("")}},8:function(e,t,r){"use strict";if(true){e.exports=r(132)}else{}},80:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(65);function a(e,t){let r;const a=new n(e=>{if(r){clearTimeout(r)}r=setTimeout(t,500)});for(const t of e){a.observe(t)}}function i(e){const t=document.body;const r=document.documentElement;a([t,r],()=>{const n=Math.max(t.scrollHeight,t.offsetHeight,r.scrollHeight,r.offsetHeight);e(n)})}},82:function(e,t,r){"use strict";var n=r(536),a=r(537),i=r(83),o=r(538);var s=i.CODE_POINTS,l=i.CODE_POINT_SEQUENCES;var u={0:65533,13:13,128:8364,129:129,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,141:141,142:381,143:143,144:144,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,157:157,158:382,159:376};var c="DATA_STATE",f="CHARACTER_REFERENCE_IN_DATA_STATE",h="RCDATA_STATE",p="CHARACTER_REFERENCE_IN_RCDATA_STATE",d="RAWTEXT_STATE",v="SCRIPT_DATA_STATE",m="PLAINTEXT_STATE",g="TAG_OPEN_STATE",y="END_TAG_OPEN_STATE",x="TAG_NAME_STATE",_="RCDATA_LESS_THAN_SIGN_STATE",b="RCDATA_END_TAG_OPEN_STATE",w="RCDATA_END_TAG_NAME_STATE",T="RAWTEXT_LESS_THAN_SIGN_STATE",k="RAWTEXT_END_TAG_OPEN_STATE",A="RAWTEXT_END_TAG_NAME_STATE",M="SCRIPT_DATA_LESS_THAN_SIGN_STATE",E="SCRIPT_DATA_END_TAG_OPEN_STATE",S="SCRIPT_DATA_END_TAG_NAME_STATE",C="SCRIPT_DATA_ESCAPE_START_STATE",L="SCRIPT_DATA_ESCAPE_START_DASH_STATE",I="SCRIPT_DATA_ESCAPED_STATE",O="SCRIPT_DATA_ESCAPED_DASH_STATE",P="SCRIPT_DATA_ESCAPED_DASH_DASH_STATE",D="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN_STATE",R="SCRIPT_DATA_ESCAPED_END_TAG_OPEN_STATE",z="SCRIPT_DATA_ESCAPED_END_TAG_NAME_STATE",N="SCRIPT_DATA_DOUBLE_ESCAPE_START_STATE",F="SCRIPT_DATA_DOUBLE_ESCAPED_STATE",B="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_STATE",j="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH_STATE",U="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN_STATE",H="SCRIPT_DATA_DOUBLE_ESCAPE_END_STATE",V="BEFORE_ATTRIBUTE_NAME_STATE",G="ATTRIBUTE_NAME_STATE",q="AFTER_ATTRIBUTE_NAME_STATE",Y="BEFORE_ATTRIBUTE_VALUE_STATE",W="ATTRIBUTE_VALUE_DOUBLE_QUOTED_STATE",X="ATTRIBUTE_VALUE_SINGLE_QUOTED_STATE",Z="ATTRIBUTE_VALUE_UNQUOTED_STATE",K="CHARACTER_REFERENCE_IN_ATTRIBUTE_VALUE_STATE",J="AFTER_ATTRIBUTE_VALUE_QUOTED_STATE",Q="SELF_CLOSING_START_TAG_STATE",$="BOGUS_COMMENT_STATE",ee="BOGUS_COMMENT_STATE_CONTINUATION",te="MARKUP_DECLARATION_OPEN_STATE",re="COMMENT_START_STATE",ne="COMMENT_START_DASH_STATE",ae="COMMENT_STATE",ie="COMMENT_END_DASH_STATE",oe="COMMENT_END_STATE",se="COMMENT_END_BANG_STATE",le="DOCTYPE_STATE",ue="DOCTYPE_NAME_STATE",ce="AFTER_DOCTYPE_NAME_STATE",fe="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER_STATE",he="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED_STATE",pe="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED_STATE",de="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS_STATE",ve="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER_STATE",me="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED_STATE",ge="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED_STATE",ye="AFTER_DOCTYPE_SYSTEM_IDENTIFIER_STATE",xe="BOGUS_DOCTYPE_STATE",_e="CDATA_SECTION_STATE";function be(e){return e===s.SPACE||e===s.LINE_FEED||e===s.TABULATION||e===s.FORM_FEED}function we(e){return e>=s.DIGIT_0&&e<=s.DIGIT_9}function Te(e){return e>=s.LATIN_CAPITAL_A&&e<=s.LATIN_CAPITAL_Z}function ke(e){return e>=s.LATIN_SMALL_A&&e<=s.LATIN_SMALL_Z}function Ae(e){return ke(e)||Te(e)}function Me(e){return Ae(e)||we(e)}function Ee(e,t){return we(e)||t&&(e>=s.LATIN_CAPITAL_A&&e<=s.LATIN_CAPITAL_F||e>=s.LATIN_SMALL_A&&e<=s.LATIN_SMALL_F)}function Se(e){return e>=55296&&e<=57343||e>1114111}function Ce(e){return e+32}function Le(e){if(e<=65535)return String.fromCharCode(e);e-=65536;return String.fromCharCode(e>>>10&1023|55296)+String.fromCharCode(56320|e&1023)}function Ie(e){return String.fromCharCode(Ce(e))}var Oe=e.exports=function(e){this.preprocessor=new n;this.tokenQueue=[];this.allowCDATA=false;this.state=c;this.returnState="";this.tempBuff=[];this.additionalAllowedCp=void 0;this.lastStartTagName="";this.consumedAfterSnapshot=-1;this.active=false;this.currentCharacterToken=null;this.currentToken=null;this.currentAttr=null;if(e&&e.locationInfo)a.assign(this)};Oe.CHARACTER_TOKEN="CHARACTER_TOKEN";Oe.NULL_CHARACTER_TOKEN="NULL_CHARACTER_TOKEN";Oe.WHITESPACE_CHARACTER_TOKEN="WHITESPACE_CHARACTER_TOKEN";Oe.START_TAG_TOKEN="START_TAG_TOKEN";Oe.END_TAG_TOKEN="END_TAG_TOKEN";Oe.COMMENT_TOKEN="COMMENT_TOKEN";Oe.DOCTYPE_TOKEN="DOCTYPE_TOKEN";Oe.EOF_TOKEN="EOF_TOKEN";Oe.HIBERNATION_TOKEN="HIBERNATION_TOKEN";Oe.MODE=Oe.prototype.MODE={DATA:c,RCDATA:h,RAWTEXT:d,SCRIPT_DATA:v,PLAINTEXT:m};Oe.getTokenAttr=function(e,t){for(var r=e.attrs.length-1;r>=0;r--){if(e.attrs[r].name===t)return e.attrs[r].value}return null};Oe.prototype.getNextToken=function(){while(!this.tokenQueue.length&&this.active){this._hibernationSnapshot();var e=this._consume();if(!this._ensureHibernation())this[this.state](e)}return this.tokenQueue.shift()};Oe.prototype.write=function(e,t){this.active=true;this.preprocessor.write(e,t)};Oe.prototype.insertHtmlAtCurrentPos=function(e){this.active=true;this.preprocessor.insertHtmlAtCurrentPos(e)};Oe.prototype._hibernationSnapshot=function(){this.consumedAfterSnapshot=0};Oe.prototype._ensureHibernation=function(){if(this.preprocessor.endOfChunkHit){for(;this.consumedAfterSnapshot>0;this.consumedAfterSnapshot--)this.preprocessor.retreat();this.active=false;this.tokenQueue.push({type:Oe.HIBERNATION_TOKEN});return true}return false};Oe.prototype._consume=function(){this.consumedAfterSnapshot++;return this.preprocessor.advance()};Oe.prototype._unconsume=function(){this.consumedAfterSnapshot--;this.preprocessor.retreat()};Oe.prototype._unconsumeSeveral=function(e){while(e--)this._unconsume()};Oe.prototype._reconsumeInState=function(e){this.state=e;this._unconsume()};Oe.prototype._consumeSubsequentIfMatch=function(e,t,r){var n=0,a=true,i=e.length,o=0,l=t,u=void 0;for(;o<i;o++){if(o>0){l=this._consume();n++}if(l===s.EOF){a=false;break}u=e[o];if(l!==u&&(r||l!==Ce(u))){a=false;break}}if(!a)this._unconsumeSeveral(n);return a};Oe.prototype._lookahead=function(){var e=this._consume();this._unconsume();return e};Oe.prototype.isTempBufferEqualToScriptString=function(){if(this.tempBuff.length!==l.SCRIPT_STRING.length)return false;for(var e=0;e<this.tempBuff.length;e++){if(this.tempBuff[e]!==l.SCRIPT_STRING[e])return false}return true};Oe.prototype._createStartTagToken=function(){this.currentToken={type:Oe.START_TAG_TOKEN,tagName:"",selfClosing:false,attrs:[]}};Oe.prototype._createEndTagToken=function(){this.currentToken={type:Oe.END_TAG_TOKEN,tagName:"",attrs:[]}};Oe.prototype._createCommentToken=function(){this.currentToken={type:Oe.COMMENT_TOKEN,data:""}};Oe.prototype._createDoctypeToken=function(e){this.currentToken={type:Oe.DOCTYPE_TOKEN,name:e,forceQuirks:false,publicId:null,systemId:null}};Oe.prototype._createCharacterToken=function(e,t){this.currentCharacterToken={type:e,chars:t}};Oe.prototype._createAttr=function(e){this.currentAttr={name:e,value:""}};Oe.prototype._isDuplicateAttr=function(){return Oe.getTokenAttr(this.currentToken,this.currentAttr.name)!==null};Oe.prototype._leaveAttrName=function(e){this.state=e;if(!this._isDuplicateAttr())this.currentToken.attrs.push(this.currentAttr)};Oe.prototype._leaveAttrValue=function(e){this.state=e};Oe.prototype._isAppropriateEndTagToken=function(){return this.lastStartTagName===this.currentToken.tagName};Oe.prototype._emitCurrentToken=function(){this._emitCurrentCharacterToken();if(this.currentToken.type===Oe.START_TAG_TOKEN)this.lastStartTagName=this.currentToken.tagName;this.tokenQueue.push(this.currentToken);this.currentToken=null};Oe.prototype._emitCurrentCharacterToken=function(){if(this.currentCharacterToken){this.tokenQueue.push(this.currentCharacterToken);this.currentCharacterToken=null}};Oe.prototype._emitEOFToken=function(){this._emitCurrentCharacterToken();this.tokenQueue.push({type:Oe.EOF_TOKEN})};Oe.prototype._appendCharToCurrentCharacterToken=function(e,t){if(this.currentCharacterToken&&this.currentCharacterToken.type!==e)this._emitCurrentCharacterToken();if(this.currentCharacterToken)this.currentCharacterToken.chars+=t;else this._createCharacterToken(e,t)};Oe.prototype._emitCodePoint=function(e){var t=Oe.CHARACTER_TOKEN;if(be(e))t=Oe.WHITESPACE_CHARACTER_TOKEN;else if(e===s.NULL)t=Oe.NULL_CHARACTER_TOKEN;this._appendCharToCurrentCharacterToken(t,Le(e))};Oe.prototype._emitSeveralCodePoints=function(e){for(var t=0;t<e.length;t++)this._emitCodePoint(e[t])};Oe.prototype._emitChar=function(e){this._appendCharToCurrentCharacterToken(Oe.CHARACTER_TOKEN,e)};Oe.prototype._consumeNumericEntity=function(e){var t="",r=void 0;do{t+=Le(this._consume());r=this._lookahead()}while(r!==s.EOF&&Ee(r,e));if(this._lookahead()===s.SEMICOLON)this._consume();var n=parseInt(t,e?16:10),a=u[n];if(a)return a;if(Se(n))return s.REPLACEMENT_CHARACTER;return n};Oe.prototype._consumeNamedEntity=function(e,t){var r=null,n=0,a=e,i=o[a],l=1,u=false;for(;i&&a!==s.EOF;a=this._consume(),l++,i=i.l&&i.l[a]){if(i.c){r=i.c;n=l;if(a===s.SEMICOLON){u=true;break}}}if(r){if(!u){this._unconsumeSeveral(l-n);if(t){var c=this._lookahead();if(c===s.EQUALS_SIGN||Me(c)){this._unconsumeSeveral(n);return null}}}return r}this._unconsumeSeveral(l);return null};Oe.prototype._consumeCharacterReference=function(e,t){if(be(e)||e===s.GREATER_THAN_SIGN||e===s.AMPERSAND||e===this.additionalAllowedCp||e===s.EOF){this._unconsume();return null}if(e===s.NUMBER_SIGN){var r=false,n=this._lookahead();if(n===s.LATIN_SMALL_X||n===s.LATIN_CAPITAL_X){this._consume();r=true}n=this._lookahead();if(n!==s.EOF&&Ee(n,r))return[this._consumeNumericEntity(r)];this._unconsumeSeveral(r?2:1);return null}return this._consumeNamedEntity(e,t)};var Pe=Oe.prototype;Pe[c]=function e(t){this.preprocessor.dropParsedChunk();if(t===s.AMPERSAND)this.state=f;else if(t===s.LESS_THAN_SIGN)this.state=g;else if(t===s.NULL)this._emitCodePoint(t);else if(t===s.EOF)this._emitEOFToken();else this._emitCodePoint(t)};Pe[f]=function e(t){this.additionalAllowedCp=void 0;var r=this._consumeCharacterReference(t,false);if(!this._ensureHibernation()){if(r)this._emitSeveralCodePoints(r);else this._emitChar("&");this.state=c}};Pe[h]=function e(t){this.preprocessor.dropParsedChunk();if(t===s.AMPERSAND)this.state=p;else if(t===s.LESS_THAN_SIGN)this.state=_;else if(t===s.NULL)this._emitChar(i.REPLACEMENT_CHARACTER);else if(t===s.EOF)this._emitEOFToken();else this._emitCodePoint(t)};Pe[p]=function e(t){this.additionalAllowedCp=void 0;var r=this._consumeCharacterReference(t,false);if(!this._ensureHibernation()){if(r)this._emitSeveralCodePoints(r);else this._emitChar("&");this.state=h}};Pe[d]=function e(t){this.preprocessor.dropParsedChunk();if(t===s.LESS_THAN_SIGN)this.state=T;else if(t===s.NULL)this._emitChar(i.REPLACEMENT_CHARACTER);else if(t===s.EOF)this._emitEOFToken();else this._emitCodePoint(t)};Pe[v]=function e(t){this.preprocessor.dropParsedChunk();if(t===s.LESS_THAN_SIGN)this.state=M;else if(t===s.NULL)this._emitChar(i.REPLACEMENT_CHARACTER);else if(t===s.EOF)this._emitEOFToken();else this._emitCodePoint(t)};Pe[m]=function e(t){this.preprocessor.dropParsedChunk();if(t===s.NULL)this._emitChar(i.REPLACEMENT_CHARACTER);else if(t===s.EOF)this._emitEOFToken();else this._emitCodePoint(t)};Pe[g]=function e(t){if(t===s.EXCLAMATION_MARK)this.state=te;else if(t===s.SOLIDUS)this.state=y;else if(Ae(t)){this._createStartTagToken();this._reconsumeInState(x)}else if(t===s.QUESTION_MARK)this._reconsumeInState($);else{this._emitChar("<");this._reconsumeInState(c)}};Pe[y]=function e(t){if(Ae(t)){this._createEndTagToken();this._reconsumeInState(x)}else if(t===s.GREATER_THAN_SIGN)this.state=c;else if(t===s.EOF){this._reconsumeInState(c);this._emitChar("<");this._emitChar("/")}else this._reconsumeInState($)};Pe[x]=function e(t){if(be(t))this.state=V;else if(t===s.SOLIDUS)this.state=Q;else if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else if(Te(t))this.currentToken.tagName+=Ie(t);else if(t===s.NULL)this.currentToken.tagName+=i.REPLACEMENT_CHARACTER;else if(t===s.EOF)this._reconsumeInState(c);else this.currentToken.tagName+=Le(t)};Pe[_]=function e(t){if(t===s.SOLIDUS){this.tempBuff=[];this.state=b}else{this._emitChar("<");this._reconsumeInState(h)}};Pe[b]=function e(t){if(Ae(t)){this._createEndTagToken();this._reconsumeInState(w)}else{this._emitChar("<");this._emitChar("/");this._reconsumeInState(h)}};Pe[w]=function e(t){if(Te(t)){this.currentToken.tagName+=Ie(t);this.tempBuff.push(t)}else if(ke(t)){this.currentToken.tagName+=Le(t);this.tempBuff.push(t)}else{if(this._isAppropriateEndTagToken()){if(be(t)){this.state=V;return}if(t===s.SOLIDUS){this.state=Q;return}if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken();return}}this._emitChar("<");this._emitChar("/");this._emitSeveralCodePoints(this.tempBuff);this._reconsumeInState(h)}};Pe[T]=function e(t){if(t===s.SOLIDUS){this.tempBuff=[];this.state=k}else{this._emitChar("<");this._reconsumeInState(d)}};Pe[k]=function e(t){if(Ae(t)){this._createEndTagToken();this._reconsumeInState(A)}else{this._emitChar("<");this._emitChar("/");this._reconsumeInState(d)}};Pe[A]=function e(t){if(Te(t)){this.currentToken.tagName+=Ie(t);this.tempBuff.push(t)}else if(ke(t)){this.currentToken.tagName+=Le(t);this.tempBuff.push(t)}else{if(this._isAppropriateEndTagToken()){if(be(t)){this.state=V;return}if(t===s.SOLIDUS){this.state=Q;return}if(t===s.GREATER_THAN_SIGN){this._emitCurrentToken();this.state=c;return}}this._emitChar("<");this._emitChar("/");this._emitSeveralCodePoints(this.tempBuff);this._reconsumeInState(d)}};Pe[M]=function e(t){if(t===s.SOLIDUS){this.tempBuff=[];this.state=E}else if(t===s.EXCLAMATION_MARK){this.state=C;this._emitChar("<");this._emitChar("!")}else{this._emitChar("<");this._reconsumeInState(v)}};Pe[E]=function e(t){if(Ae(t)){this._createEndTagToken();this._reconsumeInState(S)}else{this._emitChar("<");this._emitChar("/");this._reconsumeInState(v)}};Pe[S]=function e(t){if(Te(t)){this.currentToken.tagName+=Ie(t);this.tempBuff.push(t)}else if(ke(t)){this.currentToken.tagName+=Le(t);this.tempBuff.push(t)}else{if(this._isAppropriateEndTagToken()){if(be(t)){this.state=V;return}else if(t===s.SOLIDUS){this.state=Q;return}else if(t===s.GREATER_THAN_SIGN){this._emitCurrentToken();this.state=c;return}}this._emitChar("<");this._emitChar("/");this._emitSeveralCodePoints(this.tempBuff);this._reconsumeInState(v)}};Pe[C]=function e(t){if(t===s.HYPHEN_MINUS){this.state=L;this._emitChar("-")}else this._reconsumeInState(v)};Pe[L]=function e(t){if(t===s.HYPHEN_MINUS){this.state=P;this._emitChar("-")}else this._reconsumeInState(v)};Pe[I]=function e(t){if(t===s.HYPHEN_MINUS){this.state=O;this._emitChar("-")}else if(t===s.LESS_THAN_SIGN)this.state=D;else if(t===s.NULL)this._emitChar(i.REPLACEMENT_CHARACTER);else if(t===s.EOF)this._reconsumeInState(c);else this._emitCodePoint(t)};Pe[O]=function e(t){if(t===s.HYPHEN_MINUS){this.state=P;this._emitChar("-")}else if(t===s.LESS_THAN_SIGN)this.state=D;else if(t===s.NULL){this.state=I;this._emitChar(i.REPLACEMENT_CHARACTER)}else if(t===s.EOF)this._reconsumeInState(c);else{this.state=I;this._emitCodePoint(t)}};Pe[P]=function e(t){if(t===s.HYPHEN_MINUS)this._emitChar("-");else if(t===s.LESS_THAN_SIGN)this.state=D;else if(t===s.GREATER_THAN_SIGN){this.state=v;this._emitChar(">")}else if(t===s.NULL){this.state=I;this._emitChar(i.REPLACEMENT_CHARACTER)}else if(t===s.EOF)this._reconsumeInState(c);else{this.state=I;this._emitCodePoint(t)}};Pe[D]=function e(t){if(t===s.SOLIDUS){this.tempBuff=[];this.state=R}else if(Ae(t)){this.tempBuff=[];this._emitChar("<");this._reconsumeInState(N)}else{this._emitChar("<");this._reconsumeInState(I)}};Pe[R]=function e(t){if(Ae(t)){this._createEndTagToken();this._reconsumeInState(z)}else{this._emitChar("<");this._emitChar("/");this._reconsumeInState(I)}};Pe[z]=function e(t){if(Te(t)){this.currentToken.tagName+=Ie(t);this.tempBuff.push(t)}else if(ke(t)){this.currentToken.tagName+=Le(t);this.tempBuff.push(t)}else{if(this._isAppropriateEndTagToken()){if(be(t)){this.state=V;return}if(t===s.SOLIDUS){this.state=Q;return}if(t===s.GREATER_THAN_SIGN){this._emitCurrentToken();this.state=c;return}}this._emitChar("<");this._emitChar("/");this._emitSeveralCodePoints(this.tempBuff);this._reconsumeInState(I)}};Pe[N]=function e(t){if(be(t)||t===s.SOLIDUS||t===s.GREATER_THAN_SIGN){this.state=this.isTempBufferEqualToScriptString()?F:I;this._emitCodePoint(t)}else if(Te(t)){this.tempBuff.push(Ce(t));this._emitCodePoint(t)}else if(ke(t)){this.tempBuff.push(t);this._emitCodePoint(t)}else this._reconsumeInState(I)};Pe[F]=function e(t){if(t===s.HYPHEN_MINUS){this.state=B;this._emitChar("-")}else if(t===s.LESS_THAN_SIGN){this.state=U;this._emitChar("<")}else if(t===s.NULL)this._emitChar(i.REPLACEMENT_CHARACTER);else if(t===s.EOF)this._reconsumeInState(c);else this._emitCodePoint(t)};Pe[B]=function e(t){if(t===s.HYPHEN_MINUS){this.state=j;this._emitChar("-")}else if(t===s.LESS_THAN_SIGN){this.state=U;this._emitChar("<")}else if(t===s.NULL){this.state=F;this._emitChar(i.REPLACEMENT_CHARACTER)}else if(t===s.EOF)this._reconsumeInState(c);else{this.state=F;this._emitCodePoint(t)}};Pe[j]=function e(t){if(t===s.HYPHEN_MINUS)this._emitChar("-");else if(t===s.LESS_THAN_SIGN){this.state=U;this._emitChar("<")}else if(t===s.GREATER_THAN_SIGN){this.state=v;this._emitChar(">")}else if(t===s.NULL){this.state=F;this._emitChar(i.REPLACEMENT_CHARACTER)}else if(t===s.EOF)this._reconsumeInState(c);else{this.state=F;this._emitCodePoint(t)}};Pe[U]=function e(t){if(t===s.SOLIDUS){this.tempBuff=[];this.state=H;this._emitChar("/")}else this._reconsumeInState(F)};Pe[H]=function e(t){if(be(t)||t===s.SOLIDUS||t===s.GREATER_THAN_SIGN){this.state=this.isTempBufferEqualToScriptString()?I:F;this._emitCodePoint(t)}else if(Te(t)){this.tempBuff.push(Ce(t));this._emitCodePoint(t)}else if(ke(t)){this.tempBuff.push(t);this._emitCodePoint(t)}else this._reconsumeInState(F)};Pe[V]=function e(t){if(be(t))return;if(t===s.SOLIDUS||t===s.GREATER_THAN_SIGN||t===s.EOF)this._reconsumeInState(q);else if(t===s.EQUALS_SIGN){this._createAttr("=");this.state=G}else{this._createAttr("");this._reconsumeInState(G)}};Pe[G]=function e(t){if(be(t)||t===s.SOLIDUS||t===s.GREATER_THAN_SIGN||t===s.EOF){this._leaveAttrName(q);this._unconsume()}else if(t===s.EQUALS_SIGN)this._leaveAttrName(Y);else if(Te(t))this.currentAttr.name+=Ie(t);else if(t===s.QUOTATION_MARK||t===s.APOSTROPHE||t===s.LESS_THAN_SIGN)this.currentAttr.name+=Le(t);else if(t===s.NULL)this.currentAttr.name+=i.REPLACEMENT_CHARACTER;else this.currentAttr.name+=Le(t)};Pe[q]=function e(t){if(be(t))return;if(t===s.SOLIDUS)this.state=Q;else if(t===s.EQUALS_SIGN)this.state=Y;else if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else if(t===s.EOF)this._reconsumeInState(c);else{this._createAttr("");this._reconsumeInState(G)}};Pe[Y]=function e(t){if(be(t))return;if(t===s.QUOTATION_MARK)this.state=W;else if(t===s.APOSTROPHE)this.state=X;else this._reconsumeInState(Z)};Pe[W]=function e(t){if(t===s.QUOTATION_MARK)this.state=J;else if(t===s.AMPERSAND){this.additionalAllowedCp=s.QUOTATION_MARK;this.returnState=this.state;this.state=K}else if(t===s.NULL)this.currentAttr.value+=i.REPLACEMENT_CHARACTER;else if(t===s.EOF)this._reconsumeInState(c);else this.currentAttr.value+=Le(t)};Pe[X]=function e(t){if(t===s.APOSTROPHE)this.state=J;else if(t===s.AMPERSAND){this.additionalAllowedCp=s.APOSTROPHE;this.returnState=this.state;this.state=K}else if(t===s.NULL)this.currentAttr.value+=i.REPLACEMENT_CHARACTER;else if(t===s.EOF)this._reconsumeInState(c);else this.currentAttr.value+=Le(t)};Pe[Z]=function e(t){if(be(t))this._leaveAttrValue(V);else if(t===s.AMPERSAND){this.additionalAllowedCp=s.GREATER_THAN_SIGN;this.returnState=this.state;this.state=K}else if(t===s.GREATER_THAN_SIGN){this._leaveAttrValue(c);this._emitCurrentToken()}else if(t===s.NULL)this.currentAttr.value+=i.REPLACEMENT_CHARACTER;else if(t===s.QUOTATION_MARK||t===s.APOSTROPHE||t===s.LESS_THAN_SIGN||t===s.EQUALS_SIGN||t===s.GRAVE_ACCENT)this.currentAttr.value+=Le(t);else if(t===s.EOF)this._reconsumeInState(c);else this.currentAttr.value+=Le(t)};Pe[K]=function e(t){var r=this._consumeCharacterReference(t,true);if(!this._ensureHibernation()){if(r){for(var n=0;n<r.length;n++)this.currentAttr.value+=Le(r[n])}else this.currentAttr.value+="&";this.state=this.returnState}};Pe[J]=function e(t){if(be(t))this._leaveAttrValue(V);else if(t===s.SOLIDUS)this._leaveAttrValue(Q);else if(t===s.GREATER_THAN_SIGN){this._leaveAttrValue(c);this._emitCurrentToken()}else if(t===s.EOF)this._reconsumeInState(c);else this._reconsumeInState(V)};Pe[Q]=function e(t){if(t===s.GREATER_THAN_SIGN){this.currentToken.selfClosing=true;this.state=c;this._emitCurrentToken()}else if(t===s.EOF)this._reconsumeInState(c);else this._reconsumeInState(V)};Pe[$]=function e(){this._createCommentToken();this._reconsumeInState(ee)};Pe[ee]=function e(t){while(true){if(t===s.GREATER_THAN_SIGN){this.state=c;break}else if(t===s.EOF){this._reconsumeInState(c);break}else{this.currentToken.data+=t===s.NULL?i.REPLACEMENT_CHARACTER:Le(t);this._hibernationSnapshot();t=this._consume();if(this._ensureHibernation())return}}this._emitCurrentToken()};Pe[te]=function e(t){var r=this._consumeSubsequentIfMatch(l.DASH_DASH_STRING,t,true),n=!r&&this._consumeSubsequentIfMatch(l.DOCTYPE_STRING,t,false),a=!r&&!n&&this.allowCDATA&&this._consumeSubsequentIfMatch(l.CDATA_START_STRING,t,true);if(!this._ensureHibernation()){if(r){this._createCommentToken();this.state=re}else if(n)this.state=le;else if(a)this.state=_e;else this._reconsumeInState($)}};Pe[re]=function e(t){if(t===s.HYPHEN_MINUS)this.state=ne;else if(t===s.NULL){this.currentToken.data+=i.REPLACEMENT_CHARACTER;this.state=ae}else if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else if(t===s.EOF){this._emitCurrentToken();this._reconsumeInState(c)}else{this.currentToken.data+=Le(t);this.state=ae}};Pe[ne]=function e(t){if(t===s.HYPHEN_MINUS)this.state=oe;else if(t===s.NULL){this.currentToken.data+="-";this.currentToken.data+=i.REPLACEMENT_CHARACTER;this.state=ae}else if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else if(t===s.EOF){this._emitCurrentToken();this._reconsumeInState(c)}else{this.currentToken.data+="-";this.currentToken.data+=Le(t);this.state=ae}};Pe[ae]=function e(t){if(t===s.HYPHEN_MINUS)this.state=ie;else if(t===s.NULL)this.currentToken.data+=i.REPLACEMENT_CHARACTER;else if(t===s.EOF){this._emitCurrentToken();this._reconsumeInState(c)}else this.currentToken.data+=Le(t)};Pe[ie]=function e(t){if(t===s.HYPHEN_MINUS)this.state=oe;else if(t===s.NULL){this.currentToken.data+="-";this.currentToken.data+=i.REPLACEMENT_CHARACTER;this.state=ae}else if(t===s.EOF){this._emitCurrentToken();this._reconsumeInState(c)}else{this.currentToken.data+="-";this.currentToken.data+=Le(t);this.state=ae}};Pe[oe]=function e(t){if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else if(t===s.EXCLAMATION_MARK)this.state=se;else if(t===s.HYPHEN_MINUS)this.currentToken.data+="-";else if(t===s.NULL){this.currentToken.data+="--";this.currentToken.data+=i.REPLACEMENT_CHARACTER;this.state=ae}else if(t===s.EOF){this._reconsumeInState(c);this._emitCurrentToken()}else{this.currentToken.data+="--";this.currentToken.data+=Le(t);this.state=ae}};Pe[se]=function e(t){if(t===s.HYPHEN_MINUS){this.currentToken.data+="--!";this.state=ie}else if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else if(t===s.NULL){this.currentToken.data+="--!";this.currentToken.data+=i.REPLACEMENT_CHARACTER;this.state=ae}else if(t===s.EOF){this._emitCurrentToken();this._reconsumeInState(c)}else{this.currentToken.data+="--!";this.currentToken.data+=Le(t);this.state=ae}};Pe[le]=function e(t){if(be(t))return;else if(t===s.GREATER_THAN_SIGN){this._createDoctypeToken(null);this.currentToken.forceQuirks=true;this._emitCurrentToken();this.state=c}else if(t===s.EOF){this._createDoctypeToken(null);this.currentToken.forceQuirks=true;this._emitCurrentToken();this._reconsumeInState(c)}else{this._createDoctypeToken("");this._reconsumeInState(ue)}};Pe[ue]=function e(t){if(be(t)||t===s.GREATER_THAN_SIGN||t===s.EOF)this._reconsumeInState(ce);else if(Te(t))this.currentToken.name+=Ie(t);else if(t===s.NULL)this.currentToken.name+=i.REPLACEMENT_CHARACTER;else this.currentToken.name+=Le(t)};Pe[ce]=function e(t){if(be(t))return;if(t===s.GREATER_THAN_SIGN){this.state=c;this._emitCurrentToken()}else{var r=this._consumeSubsequentIfMatch(l.PUBLIC_STRING,t,false),n=!r&&this._consumeSubsequentIfMatch(l.SYSTEM_STRING,t,false);if(!this._ensureHibernation()){if(r)this.state=fe;else if(n)this.state=ve;else{this.currentToken.forceQuirks=true;this.state=xe}}}};Pe[fe]=function e(t){if(be(t))return;if(t===s.QUOTATION_MARK){this.currentToken.publicId="";this.state=he}else if(t===s.APOSTROPHE){this.currentToken.publicId="";this.state=pe}else{this.currentToken.forceQuirks=true;this._reconsumeInState(xe)}};Pe[he]=function e(t){if(t===s.QUOTATION_MARK)this.state=de;else if(t===s.NULL)this.currentToken.publicId+=i.REPLACEMENT_CHARACTER;else if(t===s.GREATER_THAN_SIGN){this.currentToken.forceQuirks=true;this._emitCurrentToken();this.state=c}else if(t===s.EOF){this.currentToken.forceQuirks=true;this._emitCurrentToken();this._reconsumeInState(c)}else this.currentToken.publicId+=Le(t)};Pe[pe]=function e(t){if(t===s.APOSTROPHE)this.state=de;else if(t===s.NULL)this.currentToken.publicId+=i.REPLACEMENT_CHARACTER;else if(t===s.GREATER_THAN_SIGN){this.currentToken.forceQuirks=true;this._emitCurrentToken();this.state=c}else if(t===s.EOF){this.currentToken.forceQuirks=true;this._emitCurrentToken();this._reconsumeInState(c)}else this.currentToken.publicId+=Le(t)};Pe[de]=function e(t){if(be(t))return;if(t===s.GREATER_THAN_SIGN){this._emitCurrentToken();this.state=c}else if(t===s.QUOTATION_MARK){this.currentToken.systemId="";this.state=me}else if(t===s.APOSTROPHE){this.currentToken.systemId="";this.state=ge}else{this.currentToken.forceQuirks=true;this._reconsumeInState(xe)}};Pe[ve]=function e(t){if(be(t))return;if(t===s.QUOTATION_MARK){this.currentToken.systemId="";this.state=me}else if(t===s.APOSTROPHE){this.currentToken.systemId="";this.state=ge}else{this.currentToken.forceQuirks=true;this._reconsumeInState(xe)}};Pe[me]=function e(t){if(t===s.QUOTATION_MARK)this.state=ye;else if(t===s.GREATER_THAN_SIGN){this.currentToken.forceQuirks=true;this._emitCurrentToken();this.state=c}else if(t===s.NULL)this.currentToken.systemId+=i.REPLACEMENT_CHARACTER;else if(t===s.EOF){this.currentToken.forceQuirks=true;this._emitCurrentToken();this._reconsumeInState(c)}else this.currentToken.systemId+=Le(t)};Pe[ge]=function e(t){if(t===s.APOSTROPHE)this.state=ye;else if(t===s.GREATER_THAN_SIGN){this.currentToken.forceQuirks=true;this._emitCurrentToken();this.state=c}else if(t===s.NULL)this.currentToken.systemId+=i.REPLACEMENT_CHARACTER;else if(t===s.EOF){this.currentToken.forceQuirks=true;this._emitCurrentToken();this._reconsumeInState(c)}else this.currentToken.systemId+=Le(t)};Pe[ye]=function e(t){if(be(t))return;if(t===s.GREATER_THAN_SIGN){this._emitCurrentToken();this.state=c}else if(t===s.EOF){this.currentToken.forceQuirks=true;this._emitCurrentToken();this._reconsumeInState(c)}else this.state=xe};Pe[xe]=function e(t){if(t===s.GREATER_THAN_SIGN){this._emitCurrentToken();this.state=c}else if(t===s.EOF){this._emitCurrentToken();this._reconsumeInState(c)}};Pe[_e]=function e(t){while(true){if(t===s.EOF){this._reconsumeInState(c);break}else{var r=this._consumeSubsequentIfMatch(l.CDATA_END_STRING,t,true);if(this._ensureHibernation())break;if(r){this.state=c;break}this._emitCodePoint(t);this._hibernationSnapshot();t=this._consume();if(this._ensureHibernation())break}}}},83:function(e,t,r){"use strict";t.REPLACEMENT_CHARACTER="�";t.CODE_POINTS={EOF:-1,NULL:0,TABULATION:9,CARRIAGE_RETURN:13,LINE_FEED:10,FORM_FEED:12,SPACE:32,EXCLAMATION_MARK:33,QUOTATION_MARK:34,NUMBER_SIGN:35,AMPERSAND:38,APOSTROPHE:39,HYPHEN_MINUS:45,SOLIDUS:47,DIGIT_0:48,DIGIT_9:57,SEMICOLON:59,LESS_THAN_SIGN:60,EQUALS_SIGN:61,GREATER_THAN_SIGN:62,QUESTION_MARK:63,LATIN_CAPITAL_A:65,LATIN_CAPITAL_F:70,LATIN_CAPITAL_X:88,LATIN_CAPITAL_Z:90,GRAVE_ACCENT:96,LATIN_SMALL_A:97,LATIN_SMALL_F:102,LATIN_SMALL_X:120,LATIN_SMALL_Z:122,REPLACEMENT_CHARACTER:65533};t.CODE_POINT_SEQUENCES={DASH_DASH_STRING:[45,45],DOCTYPE_STRING:[68,79,67,84,89,80,69],CDATA_START_STRING:[91,67,68,65,84,65,91],CDATA_END_STRING:[93,93,62],SCRIPT_STRING:[115,99,114,105,112,116],PUBLIC_STRING:[80,85,66,76,73,67],SYSTEM_STRING:[83,89,83,84,69,77]}},84:function(e,t,r){"use strict";(function(t,n){var a=r(43);e.exports=T;var i=r(85);var o;T.ReadableState=w;var s=r(53).EventEmitter;var l=function(e,t){return e.listeners(t).length};var u=r(86);var c=r(12).Buffer;var f=t.Uint8Array||function(){};function h(e){return c.from(e)}function p(e){return c.isBuffer(e)||e instanceof f}var d=Object.create(r(35));d.inherits=r(10);var v=r(137);var m=void 0;if(v&&v.debuglog){m=v.debuglog("stream")}else{m=function(){}}var g=r(138);var y=r(87);var x;d.inherits(T,u);var _=["error","close","destroy","pause","resume"];function b(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(i(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}function w(e,t){o=o||r(28);e=e||{};var n=t instanceof o;this.objectMode=!!e.objectMode;if(n)this.objectMode=this.objectMode||!!e.readableObjectMode;var a=e.highWaterMark;var i=e.readableHighWaterMark;var s=this.objectMode?16:16*1024;if(a||a===0)this.highWaterMark=a;else if(n&&(i||i===0))this.highWaterMark=i;else this.highWaterMark=s;this.highWaterMark=Math.floor(this.highWaterMark);this.buffer=new g;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.destroyed=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!x)x=r(60).StringDecoder;this.decoder=new x(e.encoding);this.encoding=e.encoding}}function T(e){o=o||r(28);if(!(this instanceof T))return new T(e);this._readableState=new w(e,this);this.readable=true;if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy}u.call(this)}Object.defineProperty(T.prototype,"destroyed",{get:function(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function(e){if(!this._readableState){return}this._readableState.destroyed=e}});T.prototype.destroy=y.destroy;T.prototype._undestroy=y.undestroy;T.prototype._destroy=function(e,t){this.push(null);t(e)};T.prototype.push=function(e,t){var r=this._readableState;var n;if(!r.objectMode){if(typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=c.from(e,t);t=""}n=true}}else{n=true}return k(this,e,t,false,n)};T.prototype.unshift=function(e){return k(this,e,null,true,false)};function k(e,t,r,n,a){var i=e._readableState;if(t===null){i.reading=false;I(e,i)}else{var o;if(!a)o=M(i,t);if(o){e.emit("error",o)}else if(i.objectMode||t&&t.length>0){if(typeof t!=="string"&&!i.objectMode&&Object.getPrototypeOf(t)!==c.prototype){t=h(t)}if(n){if(i.endEmitted)e.emit("error",new Error("stream.unshift() after end event"));else A(e,i,t,true)}else if(i.ended){e.emit("error",new Error("stream.push() after EOF"))}else{i.reading=false;if(i.decoder&&!r){t=i.decoder.write(t);if(i.objectMode||t.length!==0)A(e,i,t,false);else D(e,i)}else{A(e,i,t,false)}}}else if(!n){i.reading=false}}return E(i)}function A(e,t,r,n){if(t.flowing&&t.length===0&&!t.sync){e.emit("data",r);e.read(0)}else{t.length+=t.objectMode?1:r.length;if(n)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)O(e)}D(e,t)}function M(e,t){var r;if(!p(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){r=new TypeError("Invalid non-string/buffer chunk")}return r}function E(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}T.prototype.isPaused=function(){return this._readableState.flowing===false};T.prototype.setEncoding=function(e){if(!x)x=r(60).StringDecoder;this._readableState.decoder=new x(e);this._readableState.encoding=e;return this};var S=8388608;function C(e){if(e>=S){e=S}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function L(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=C(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}T.prototype.read=function(e){m("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended)){m("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)q(this);else O(this);return null}e=L(e,t);if(e===0&&t.ended){if(t.length===0)q(this);return null}var n=t.needReadable;m("need readable",n);if(t.length===0||t.length-e<t.highWaterMark){n=true;m("length less than watermark",n)}if(t.ended||t.reading){n=false;m("reading or ended",n)}else if(n){m("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=L(r,t)}var a;if(e>0)a=U(e,t);else a=null;if(a===null){t.needReadable=true;e=0}else{t.length-=e}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)q(this)}if(a!==null)this.emit("data",a);return a};function I(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;O(e)}function O(e){var t=e._readableState;t.needReadable=false;if(!t.emittedReadable){m("emitReadable",t.flowing);t.emittedReadable=true;if(t.sync)a.nextTick(P,e);else P(e)}}function P(e){m("emit readable");e.emit("readable");j(e)}function D(e,t){if(!t.readingMore){t.readingMore=true;a.nextTick(R,e,t)}}function R(e,t){var r=t.length;while(!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark){m("maybeReadMore read 0");e.read(0);if(r===t.length)break;else r=t.length}t.readingMore=false}T.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))};T.prototype.pipe=function(e,t){var r=this;var i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e);break}i.pipesCount+=1;m("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||t.end!==false)&&e!==n.stdout&&e!==n.stderr;var s=o?c:_;if(i.endEmitted)a.nextTick(s);else r.once("end",s);e.on("unpipe",u);function u(e,t){m("onunpipe");if(e===r){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;p()}}}function c(){m("onend");e.end()}var f=z(r);e.on("drain",f);var h=false;function p(){m("cleanup");e.removeListener("close",y);e.removeListener("finish",x);e.removeListener("drain",f);e.removeListener("error",g);e.removeListener("unpipe",u);r.removeListener("end",c);r.removeListener("end",_);r.removeListener("data",v);h=true;if(i.awaitDrain&&(!e._writableState||e._writableState.needDrain))f()}var d=false;r.on("data",v);function v(t){m("ondata");d=false;var n=e.write(t);if(false===n&&!d){if((i.pipesCount===1&&i.pipes===e||i.pipesCount>1&&W(i.pipes,e)!==-1)&&!h){m("false write response, pause",r._readableState.awaitDrain);r._readableState.awaitDrain++;d=true}r.pause()}}function g(t){m("onerror",t);_();e.removeListener("error",g);if(l(e,"error")===0)e.emit("error",t)}b(e,"error",g);function y(){e.removeListener("finish",x);_()}e.once("close",y);function x(){m("onfinish");e.removeListener("close",y);_()}e.once("finish",x);function _(){m("unpipe");r.unpipe(e)}e.emit("pipe",r);if(!i.flowing){m("pipe resume");r.resume()}return e};function z(e){return function(){var t=e._readableState;m("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&l(e,"data")){t.flowing=true;j(e)}}}T.prototype.unpipe=function(e){var t=this._readableState;var r={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,r);return this}if(!e){var n=t.pipes;var a=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var i=0;i<a;i++){n[i].emit("unpipe",this,r)}return this}var o=W(t.pipes,e);if(o===-1)return this;t.pipes.splice(o,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,r);return this};T.prototype.on=function(e,t){var r=u.prototype.on.call(this,e,t);if(e==="data"){if(this._readableState.flowing!==false)this.resume()}else if(e==="readable"){var n=this._readableState;if(!n.endEmitted&&!n.readableListening){n.readableListening=n.needReadable=true;n.emittedReadable=false;if(!n.reading){a.nextTick(N,this)}else if(n.length){O(this)}}}return r};T.prototype.addListener=T.prototype.on;function N(e){m("readable nexttick read 0");e.read(0)}T.prototype.resume=function(){var e=this._readableState;if(!e.flowing){m("resume");e.flowing=true;F(this,e)}return this};function F(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;a.nextTick(B,e,t)}}function B(e,t){if(!t.reading){m("resume read 0");e.read(0)}t.resumeScheduled=false;t.awaitDrain=0;e.emit("resume");j(e);if(t.flowing&&!t.reading)e.read(0)}T.prototype.pause=function(){m("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){m("pause");this._readableState.flowing=false;this.emit("pause")}return this};function j(e){var t=e._readableState;m("flow",t.flowing);while(t.flowing&&e.read()!==null){}}T.prototype.wrap=function(e){var t=this;var r=this._readableState;var n=false;e.on("end",function(){m("wrapped end");if(r.decoder&&!r.ended){var e=r.decoder.end();if(e&&e.length)t.push(e)}t.push(null)});e.on("data",function(a){m("wrapped data");if(r.decoder)a=r.decoder.write(a);if(r.objectMode&&(a===null||a===undefined))return;else if(!r.objectMode&&(!a||!a.length))return;var i=t.push(a);if(!i){n=true;e.pause()}});for(var a in e){if(this[a]===undefined&&typeof e[a]==="function"){this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a)}}for(var i=0;i<_.length;i++){e.on(_[i],this.emit.bind(this,_[i]))}this._read=function(t){m("wrapped _read",t);if(n){n=false;e.resume()}};return this};Object.defineProperty(T.prototype,"readableHighWaterMark",{enumerable:false,get:function(){return this._readableState.highWaterMark}});T._fromList=U;function U(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.head.data;else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=H(e,t.buffer,t.decoder)}return r}function H(e,t,r){var n;if(e<t.head.data.length){n=t.head.data.slice(0,e);t.head.data=t.head.data.slice(e)}else if(e===t.head.data.length){n=t.shift()}else{n=r?V(e,t):G(e,t)}return n}function V(e,t){var r=t.head;var n=1;var a=r.data;e-=a.length;while(r=r.next){var i=r.data;var o=e>i.length?i.length:e;if(o===i.length)a+=i;else a+=i.slice(0,e);e-=o;if(e===0){if(o===i.length){++n;if(r.next)t.head=r.next;else t.head=t.tail=null}else{t.head=r;r.data=i.slice(o)}break}++n}t.length-=n;return a}function G(e,t){var r=c.allocUnsafe(e);var n=t.head;var a=1;n.data.copy(r);e-=n.data.length;while(n=n.next){var i=n.data;var o=e>i.length?i.length:e;i.copy(r,r.length-e,0,o);e-=o;if(e===0){if(o===i.length){++a;if(n.next)t.head=n.next;else t.head=t.tail=null}else{t.head=n;n.data=i.slice(o)}break}++a}t.length-=a;return r}function q(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');if(!t.endEmitted){t.ended=true;a.nextTick(Y,t,e)}}function Y(e,t){if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end")}}function W(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r]===t)return r}return-1}}).call(this,r(14),r(17))},85:function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return r.call(e)=="[object Array]"}},86:function(e,t,r){e.exports=r(53).EventEmitter},87:function(e,t,r){"use strict";var n=r(43);function a(e,t){var r=this;var a=this._readableState&&this._readableState.destroyed;var i=this._writableState&&this._writableState.destroyed;if(a||i){if(t){t(e)}else if(e&&(!this._writableState||!this._writableState.errorEmitted)){n.nextTick(o,this,e)}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(e||null,function(e){if(!t&&e){n.nextTick(o,r,e);if(r._writableState){r._writableState.errorEmitted=true}}else if(t){t(e)}});return this}function i(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function o(e,t){e.emit("error",t)}e.exports={destroy:a,undestroy:i}},88:function(e,t,r){"use strict";e.exports=o;var n=r(28);var a=Object.create(r(35));a.inherits=r(10);a.inherits(o,n);function i(e,t){var r=this._transformState;r.transforming=false;var n=r.writecb;if(!n){return this.emit("error",new Error("write callback called multiple times"))}r.writechunk=null;r.writecb=null;if(t!=null)this.push(t);n(e);var a=this._readableState;a.reading=false;if(a.needReadable||a.length<a.highWaterMark){this._read(a.highWaterMark)}}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e);this._transformState={afterTransform:i.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",s)}function s(){var e=this;if(typeof this._flush==="function"){this._flush(function(t,r){l(e,t,r)})}else{l(this,null,null)}}o.prototype.push=function(e,t){this._transformState.needTransform=false;return n.prototype.push.call(this,e,t)};o.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")};o.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r;n.writechunk=e;n.writeencoding=t;if(!n.transforming){var a=this._readableState;if(n.needTransform||a.needReadable||a.length<a.highWaterMark)this._read(a.highWaterMark)}};o.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&t.writecb&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};o.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e);r.emit("close")})};function l(e,t,r){if(t)return e.emit("error",t);if(r!=null)e.push(r);if(e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}}});